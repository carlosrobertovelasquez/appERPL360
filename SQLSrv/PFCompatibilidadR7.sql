INSERT INTO $$Compania$$.TIENDA_OFFLINE
(TIENDA_OFF, DESCRIPCION, ACTIVO, DESCONECTADO, CENTRAL_PADRE, FECHA_ULT_ENVIO, FECHA_ULT_RECEPCION)
SELECT SITIO,
			 DESCRIPCION,
			 'N',
			 'N',
			 (CASE 
						WHEN (SELECT COUNT(0) FROM ERPADMIN.CONFIG_PAR_SITIO WHERE SUSCRIPTOR = S.SITIO) = 1 
							THEN (SELECT PUBLICADOR FROM ERPADMIN.CONFIG_PAR_SITIO WHERE SUSCRIPTOR = S.SITIO)
						ELSE NULL
							
			 END),
			 GETDATE(),
			 GETDATE()
FROM ERPADMIN.SITIO S
WHERE ESTADO = 'A'
AND CONJUNTO = '$$Compania$$';

INSERT INTO $$Compania$$.TIENDA_OFF_GRUPO 
(GRUPO, TIENDA_OFF)
SELECT TIENDA, SITIO
FROM $$Compania$$.SITIO_TIENDA
WHERE SITIO IN (SELECT TIENDA_OFF FROM $$Compania$$.TIENDA_OFFLINE);


UPDATE $$Compania$$.GLOBALES_POS
SET TIENDA_OFF_LOCAL = SITIO_LOCAL,
		TIPO_TIENDA = TIPO_SITIO_LOCAL;

DROP VIEW $$COMPANIA$$.V_SITIO_BODEGA;

DROP TABLE $$Compania$$.TEMP_CONFIG_PAR_SITIO;

DROP TABLE $$Compania$$.TEMP_SITIO;

CREATE VIEW $$COMPANIA$$.V_SITIO_BODEGA
	AS 
		SELECT	DISTINCT ST.SITIO,
			C.BODEGA,
			NULL AS NoteExistsFlag,
			NULL AS RecordDate,
			NULL AS RowPointer,
			NULL AS CreatedBy,
			NULL AS UpdatedBy, 
			NULL AS CreateDate
		FROM	$$Compania$$.SITIO_TIENDA ST,
				$$Compania$$.CAJA_POS C
		WHERE	C.SUCURSAL = ST.TIENDA
		UNION
		SELECT SITIO_LOCAL, 
			BODEGA_CENTRAL,
			NULL AS NoteExistsFlag,
			NULL AS RecordDate,
			NULL AS RowPointer,
			NULL AS CreatedBy,
			NULL AS UpdatedBy, 
			NULL AS CreateDate
		FROM $$Compania$$.GLOBALES_POS
;


ALTER VIEW $$Compania$$.V_SITIO AS
	SELECT * FROM ERPADMIN.SITIO
;

ALTER VIEW $$Compania$$.V_DET_MOV_ARTICULOS_POS
AS
SELECT	DOCUMENTO_POS.DOCUMENTO,
	(
		CASE
			WHEN	DOCUMENTO_POS.ESTADO_COBRO = 'P'
				THEN	DOCUMENTO_POS.FCH_HORA_CREACION
			WHEN	DOCUMENTO_POS.ESTADO_COBRO = 'C' AND
				DOCUMENTO_POS.TIPO = 'F'
				THEN	DOCUMENTO_POS.FCH_HORA_COBRO
			WHEN    DOCUMENTO_POS.ESTADO_COBRO = 'C' AND
				DOCUMENTO_POS.TIPO = 'T'
				THEN DOCUMENTO_POS.FCH_HORA_COBRO
			WHEN 	DOCUMENTO_POS.ESTADO_COBRO = 'C' AND
				DOCUMENTO_POS.TIPO IN ('P','D')
				THEN	DOCUMENTO_POS.FCH_HORA_CREACION
			ELSE	DOCUMENTO_POS.FCH_HORA_ANULA
		END
	) AS FECHA,
	DOC_POS_LINEA.ARTICULO,
	DOC_POS_LINEA.CANTIDAD,
	GRUPO_CAJA.GRUPO,
	DOCUMENTO_POS.ESTADO_COBRO AS ESTADO,
	DOCUMENTO_POS.TIPO,
	'' AS BODEGA_ORIGEN,
	'' AS BODEGA_DESTINO,
	(
		SELECT	CASE
				WHEN	COUNT(*) >= 1
					THEN 'S'
				WHEN	COUNT(*) = 0
					THEN 'N'
			END
		FROM 	$$Compania$$.AUXILIAR_POS AX
		WHERE	DOCUMENTO_POS.DOCUMENTO = AX.DOCUMENTO AND
			DOCUMENTO_POS.CAJA = AX.CAJA AND
			DOCUMENTO_POS.TIPO = AX.TIPO AND
			AX.TIPO_APLICA = 'P'
	) AS APARTADO_ASOCIADO, '' AS TIPO_MOVIMIENTO
FROM	$$Compania$$.DOCUMENTO_POS DOCUMENTO_POS,
	$$Compania$$.DOC_POS_LINEA DOC_POS_LINEA,
	$$Compania$$.GRUPO_CAJA GRUPO_CAJA
WHERE	DOCUMENTO_POS.DOCUMENTO = DOC_POS_LINEA.DOCUMENTO AND
	DOCUMENTO_POS.CAJA = DOC_POS_LINEA.CAJA AND
	DOCUMENTO_POS.TIPO = DOC_POS_LINEA.TIPO AND
	(
		(
			DOCUMENTO_POS.ESTADO_COBRO IN ('P','C','A') AND
			DOCUMENTO_POS.TIPO IN ('P', 'D')
		) OR
		(
			DOCUMENTO_POS.ESTADO_COBRO IN ('C','A') AND
			DOCUMENTO_POS.TIPO IN ('F','T')
		)
	) AND
	DOCUMENTO_POS.CAJA = GRUPO_CAJA.CAJA
UNION
SELECT  AINV.APLICACION, TINV.FECHA, TINV.ARTICULO, ABS(TINV.CANTIDAD), G.GRUPO, 'A',
	TINV.NATURALEZA, (SELECT BODEGA 
		FROM $$Compania$$.TRANSACCION_INV 
		WHERE AUDIT_TRANS_INV = AINV.AUDIT_TRANS_INV AND 
		ARTICULO = TINV.ARTICULO AND 
		NATURALEZA = 'S' AND
		TIPO = 'T' AND 
		CONSECUTIVO = TINV.CONSECUTIVO -1)  AS BODEGA_ORIGEN,
	TINV.BODEGA AS BODEGA_DESTINO, 'N', TINV.TIPO AS TIPO_MOVIMIENTO
FROM    $$Compania$$.GLOBALES_POS GP, $$Compania$$.V_SITIO_BODEGA VSB, $$Compania$$.SITIO_TIENDA ST, $$Compania$$.GRUPO G, $$Compania$$.TRANSACCION_INV TINV, 
	$$Compania$$.AUDIT_TRANS_INV AINV
WHERE   GP.SITIO_LOCAL = ST.SITIO 
	AND ST.SITIO = VSB.SITIO 
	AND G.GRUPO = ST.TIENDA
	AND TINV.BODEGA = VSB.BODEGA
	AND TINV.AUDIT_TRANS_INV = AINV.AUDIT_TRANS_INV
	AND TINV.SUBTIPO = 'D'
	AND TINV.TIPO = 'T'
	AND TINV.NATURALEZA = 'E'

UNION
SELECT	TRASPASO_POS.DOCUMENTO,
	(
		CASE
			WHEN	TRASPASO_POS.ESTADO = 'A'
				THEN	TRASPASO_POS.FECHA
			ELSE	TRASPASO_POS.RecordDate
		END
	) AS FECHA,
	TRASPASO_POS_DET.ARTICULO,
	TRASPASO_POS_DET.CANTIDAD,
	GRUPO.GRUPO,
	TRASPASO_POS.ESTADO,
	'S' AS TIPO,
	TRASPASO_POS.BODEGA_ORIGEN,
	TRASPASO_POS.BODEGA_DESTINO,
	'N', 'T' AS TIPO_MOVIMIENTO
FROM	$$Compania$$.TRASPASO_POS TRASPASO_POS,
	$$Compania$$.TRASPASO_POS_DET TRASPASO_POS_DET,
	$$Compania$$.V_SUCURSAL_BODEGA V_SUCURSAL_BODEGA,
	$$Compania$$.GRUPO GRUPO,
	$$Compania$$.GLOBALES_POS GLOBALES_POS
WHERE	TRASPASO_POS.CONSECUTIVO_CI = TRASPASO_POS_DET.CONSECUTIVO_CI AND
	TRASPASO_POS.DOCUMENTO = TRASPASO_POS_DET.DOCUMENTO AND
	TRASPASO_POS.BODEGA_ORIGEN = V_SUCURSAL_BODEGA.BODEGA AND
	V_SUCURSAL_BODEGA.GRUPO = GRUPO.GRUPO AND
	TRASPASO_POS.ESTADO IN ('A', 'U')  AND
	GLOBALES_POS.TRASPASO_TIENDA = 'T'

UNION
SELECT  AINV.APLICACION, TINV.FECHA, TINV.ARTICULO, ABS(TINV.CANTIDAD), G.GRUPO, 'A',
	TINV.NATURALEZA, TINV.BODEGA AS BODEGA_ORIGEN,
	(SELECT BODEGA 
		FROM $$Compania$$.TRANSACCION_INV 
		WHERE AUDIT_TRANS_INV = AINV.AUDIT_TRANS_INV AND 
		ARTICULO = TINV.ARTICULO AND 
		NATURALEZA = 'E' AND
		TIPO = 'T' AND 
		CONSECUTIVO = TINV.CONSECUTIVO +1) AS BODEGA_DESTINO, 'N', TINV.TIPO AS TIPO_MOVIMIENTO
FROM    $$Compania$$.GLOBALES_POS GP, $$Compania$$.V_SITIO_BODEGA VSB, $$Compania$$.SITIO_TIENDA ST, $$Compania$$.GRUPO G, $$Compania$$.TRANSACCION_INV TINV, 
	$$Compania$$.AUDIT_TRANS_INV AINV
WHERE   GP.SITIO_LOCAL = ST.SITIO 
	AND ST.SITIO = VSB.SITIO 
	AND G.GRUPO = ST.TIENDA
	AND TINV.BODEGA = VSB.BODEGA
	AND TINV.AUDIT_TRANS_INV = AINV.AUDIT_TRANS_INV
	AND AINV.CONSECUTIVO = G.CONSECUTIVO_CI
	AND TINV.SUBTIPO = 'D'
	AND TINV.TIPO = 'T'
	AND TINV.NATURALEZA = 'S' AND
	GP.TRASPASO_TIENDA = 'C'
UNION
SELECT  AINV.APLICACION, TINV.FECHA, TINV.ARTICULO, ABS(TINV.CANTIDAD), G.GRUPO, 'A',
	TINV.NATURALEZA, TINV.BODEGA AS BODEGA_ORIGEN,
	(SELECT BODEGA 
		FROM $$Compania$$.TRANSACCION_INV 
		WHERE AUDIT_TRANS_INV = AINV.AUDIT_TRANS_INV AND 
		ARTICULO = TINV.ARTICULO AND 
		NATURALEZA = 'E' AND
		TIPO = 'T' AND 
		CONSECUTIVO = TINV.CONSECUTIVO +1) AS BODEGA_DESTINO, 'N', TINV.TIPO AS TIPO_MOVIMIENTO
FROM    $$Compania$$.GLOBALES_POS GP, $$Compania$$.V_SITIO_BODEGA VSB, $$Compania$$.SITIO_TIENDA ST, $$Compania$$.GRUPO G, $$Compania$$.TRANSACCION_INV TINV, 
	$$Compania$$.AUDIT_TRANS_INV AINV
WHERE   GP.SITIO_LOCAL = ST.SITIO 
	AND ST.SITIO = VSB.SITIO 
	AND G.GRUPO = ST.TIENDA
	AND TINV.BODEGA = VSB.BODEGA
	AND TINV.AUDIT_TRANS_INV = AINV.AUDIT_TRANS_INV
	AND AINV.CONSECUTIVO <> G.CONSECUTIVO_CI
	AND TINV.SUBTIPO = 'D'
	AND TINV.TIPO = 'T'
	AND TINV.NATURALEZA = 'S'

UNION
SELECT AINV.APLICACION, TINV.FECHA, TINV.ARTICULO, ABS(TINV.CANTIDAD), G.GRUPO, 'A',
	TINV.NATURALEZA, TINV.BODEGA AS BODEGA_ORIGEN,
	'' AS BODEGA_DESTINO, 'N', TINV.TIPO AS TIPO_MOVIMIENTO
FROM    $$Compania$$.GLOBALES_POS GP, $$Compania$$.V_SITIO_BODEGA VSB, $$Compania$$.SITIO_TIENDA ST, $$Compania$$.GRUPO G, $$Compania$$.TRANSACCION_INV TINV, 
	$$Compania$$.AUDIT_TRANS_INV AINV
WHERE   GP.SITIO_LOCAL = ST.SITIO 
	AND ST.SITIO = VSB.SITIO 
	AND G.GRUPO = ST.TIENDA
	AND TINV.BODEGA = VSB.BODEGA
	AND TINV.AUDIT_TRANS_INV = AINV.AUDIT_TRANS_INV
	AND TINV.SUBTIPO = 'D'
	AND TINV.TIPO NOT IN ('T', 'V','R')

UNION
SELECT  AINV.APLICACION, TINV.FECHA, TINV.ARTICULO, ABS(TINV.CANTIDAD), G.GRUPO, 'A',
	TINV.NATURALEZA, TINV.BODEGA AS BODEGA_ORIGEN,
	'' AS BODEGA_DESTINO, 'N', TINV.TIPO AS TIPO_MOVIMIENTO
FROM    $$Compania$$.GLOBALES_POS GP, $$Compania$$.V_SITIO_BODEGA VSB, $$Compania$$.SITIO_TIENDA ST, $$Compania$$.GRUPO G, $$Compania$$.TRANSACCION_INV TINV, 
	$$Compania$$.AUDIT_TRANS_INV AINV
WHERE   GP.SITIO_LOCAL = ST.SITIO 
	AND ST.SITIO = VSB.SITIO 
	AND G.GRUPO = ST.TIENDA
	AND TINV.BODEGA = VSB.BODEGA
	AND TINV.AUDIT_TRANS_INV = AINV.AUDIT_TRANS_INV
	AND ((TINV.SUBTIPO = 'D' AND TINV.TIPO ='V')
	OR (TINV.TIPO = 'R'))
	AND AINV.CONSECUTIVO NOT IN (SELECT G.CONSECUTIVO_CI
			 	     FROM (SELECT B.SUSCRIPTOR
				  	   FROM $$Compania$$.GLOBALES_POS A, ERPADMIN.CONFIG_PAR_SITIO B
				           WHERE B.PUBLICADOR = A.SITIO_LOCAL) AS SITIO_CENTRAL, 
				     $$Compania$$.SITIO_TIENDA ST, $$Compania$$.GRUPO G
			             WHERE SITIO_CENTRAL.SUSCRIPTOR = ST.SITIO  AND
				     ST.TIENDA = G.GRUPO)
;





CREATE PROCEDURE $$Compania$$.INFORMACION_DOCUMENTOS
	 @DOCUMENTO VARCHAR(20),
	 @CAJA VARCHAR(6),
	 @TIPO VARCHAR(1),
	 @INSERTA VARCHAR(1)
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PUBLICADOR VARCHAR(30)
	DECLARE	@NUM_CIERRE VARCHAR(20)
	DECLARE @NUM_CIERRE_PROCESADO VARCHAR(20)
	DECLARE	@CAJERO VARCHAR(25)
	
	DECLARE C_INSERTED CURSOR LOCAL FOR
	SELECT DOCUMENTO, CAJA, TIPO, NUM_CIERRE, CAJERO
	FROM $$Compania$$.DOCUMENTO_POS
	WHERE DOCUMENTO = @DOCUMENTO AND CAJA = @CAJA AND TIPO = @TIPO

	SELECT @PUBLICADOR = SITIO_LOCAL
	FROM $$Compania$$.GLOBALES_POS
		
	OPEN C_INSERTED	
	FETCH NEXT FROM C_INSERTED INTO
	@DOCUMENTO, @CAJA, @TIPO, @NUM_CIERRE, @CAJERO
	SET @ERROR = 0
	WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
	BEGIN		
	
		IF ISNULL(@NUM_CIERRE,'') <> ISNULL(@NUM_CIERRE_PROCESADO,'')
		BEGIN
			BEGIN TRAN
				EXECUTE $$Compania$$.REGENERA_CIERRE_POS @PUBLICADOR, @INSERTA, @CAJA, @NUM_CIERRE, @CAJERO
			COMMIT

			SET @NUM_CIERRE_PROCESADO = @NUM_CIERRE
		END

		BEGIN TRAN
		
			EXECUTE $$Compania$$.REGENERA_DOCUMENTO_POS @DOCUMENTO, @CAJA, @TIPO, @PUBLICADOR, @INSERTA 
			EXECUTE $$Compania$$.REGENERA_DOC_POS_LINEA @DOCUMENTO, @CAJA, @TIPO, @PUBLICADOR, @INSERTA 			
			EXECUTE $$Compania$$.REGENERA_DOC_POS_RETENCION @DOCUMENTO, @CAJA, @TIPO, @PUBLICADOR, @INSERTA 
			EXECUTE $$Compania$$.REGENERA_ARTICULO_SERIE_POS @DOCUMENTO, @CAJA, @TIPO, @PUBLICADOR, @INSERTA 			
			EXECUTE $$Compania$$.REGENERA_PAGO_POS @DOCUMENTO, @CAJA, @TIPO, @PUBLICADOR, @INSERTA 
			EXECUTE $$Compania$$.REGENERA_INFO_DOC_SEGURO @DOCUMENTO, @CAJA, @TIPO, @PUBLICADOR, @INSERTA 	
			
		COMMIT
		
		BEGIN TRAN
		
			EXECUTE $$Compania$$.REGENERA_AUXILIAR_POS @DOCUMENTO, @CAJA, @TIPO, @PUBLICADOR, @INSERTA
			
		COMMIT
		
		FETCH NEXT FROM C_INSERTED INTO
		@DOCUMENTO, @CAJA, @TIPO, @NUM_CIERRE, @CAJERO
	END
	CLOSE C_INSERTED
	DEALLOCATE C_INSERTED

	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para regenerar solicitudes Offline.',16,1 )
	END
END;






CREATE PROCEDURE ERPADMIN.POS_InsertarSolicitud
(
	@PUBLICADOR		VARCHAR(20),
	@SERVICIO		VARCHAR(30),
	@SUBSERVICIO		VARCHAR(20),
	@PARAMETROS		TEXT,
	@VERIF_ACTUALIZACION	BIT,
	@ROWPOINTER		VARCHAR(36)
)
AS
BEGIN
	DECLARE	
		@ERROR INT,
		@INSERTAR BIT,
		@ACTUALIZAR INT,
		@GENERAR_SOLICITUD INT,
		@MULTI_PUBLICADOR VARCHAR(20),
		@USUARIO_POS_WSQM VARCHAR(20),
		@ACCION_MODULO_OFFLINE INT
	SET	NOCOUNT ON
	SET	@ACTUALIZAR = 0
	SET @ACCION_MODULO_OFFLINE = 3159
	
	IF @PUBLICADOR <> '*'
		BEGIN
			SELECT	@GENERAR_SOLICITUD = COUNT(*)
			FROM	ERPADMIN.PUBLICACION
			WHERE	SERVICIO = @SERVICIO AND
			PUBLICADOR = @PUBLICADOR AND 
			SUBSERVICIO = @SUBSERVICIO AND
			ESTADO = 'A'
			AND 0 < (SELECT COUNT(*) 
				FROM ERPADMIN.SITIO 
				WHERE SITIO = @PUBLICADOR
				AND ESTADO = 'A' )
			AND 0 < (SELECT COUNT(*) 
				FROM ERPADMIN.SUBSERVICIO 
				WHERE SERVICIO = @SERVICIO
				AND SUBSERVICIO = @SUBSERVICIO
				AND ESTADO = 'A' )

			IF @GENERAR_SOLICITUD > 0
				BEGIN
					SET @ERROR = 0
					SET @INSERTAR = 1

					IF	@VERIF_ACTUALIZACION = 1
					BEGIN
						SELECT	@ACTUALIZAR = COUNT(*)
						FROM	ERPADMIN.SOLICITUD_SERVICIO A  WITH (NOLOCK)
						WHERE	ISNULL(A.ESTADO,'N') = 'N'
						AND	A.PUBLICADOR = @PUBLICADOR
						AND	A.SERVICIO = @SERVICIO
						AND	A.SUBSERVICIO = @SUBSERVICIO
						AND	A.LLAVE_SOLICITUD = @ROWPOINTER
						
						IF	@ACTUALIZAR > 0
							BEGIN
								UPDATE	ERPADMIN.SOLICITUD_SERVICIO
								SET	PARAMETROS = @PARAMETROS
								WHERE	PUBLICADOR = @PUBLICADOR
								AND	SERVICIO = @SERVICIO
								AND	SUBSERVICIO = @SUBSERVICIO
								AND	LLAVE_SOLICITUD = @ROWPOINTER
								
								SET	@INSERTAR = 0
							END
					END

					IF	@INSERTAR = 1
						BEGIN
							INSERT INTO ERPADMIN.SOLICITUD_SERVICIO
							(
								FECHA,
								PUBLICADOR,
								SERVICIO,
								SUBSERVICIO,
								PARAMETROS,
								LLAVE_SOLICITUD
							) VALUES (
								GETDATE(),
								@PUBLICADOR,
								@SERVICIO,
								@SUBSERVICIO,
								@PARAMETROS,
								@ROWPOINTER
							)
						END
				END
		END
	ELSE
	  BEGIN
			IF (@SERVICIO = 'SITIOPOS600' OR @SERVICIO = 'CONFIGPARSITIOPOS600' OR 
			    @SERVICIO = 'SERVICIOPOS600' OR @SERVICIO = 'SUBSERVICIOPOS600' OR 
			    @SERVICIO = 'PUBLICACIONPOS600' OR @SERVICIO = 'SUSCRIPCIONPOS600' OR
			    @SERVICIO = 'GLOBALESWSQMPOS600')
			  BEGIN
				SET @GENERAR_SOLICITUD = 1
			  END
			ELSE
			  BEGIN
				SET @GENERAR_SOLICITUD = 0
			  END	  
	  
			DECLARE C_PUBLICADORES CURSOR LOCAL FOR
				SELECT	CONJUNTO
				FROM	ERPADMIN.MODULO_INSTALADO
				WHERE ACCION = @ACCION_MODULO_OFFLINE
			
			OPEN C_PUBLICADORES
			
			FETCH NEXT FROM C_PUBLICADORES
			   INTO @MULTI_PUBLICADOR
			CREATE TABLE #FOO (PUBLICADOR VARCHAR(20), USUARIO_WSQM VARCHAR(20))
			WHILE @@FETCH_STATUS = 0
				BEGIN
					SET @PUBLICADOR = ''					
	
					INSERT INTO #foo					
					EXEC('SELECT SITIO_LOCAL, USUARIO_WSQM FROM ' + @MULTI_PUBLICADOR + '.GLOBALES_POS')
					SELECT @PUBLICADOR = PUBLICADOR,
								 @USUARIO_POS_WSQM = USUARIO_WSQM
					FROM #foo
					DELETE #foo
	
					IF (NOT (CURRENT_USER = @USUARIO_POS_WSQM) OR @GENERAR_SOLICITUD = 1) AND @PUBLICADOR <> ''
						BEGIN
							EXEC ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, @SERVICIO, @SUBSERVICIO, @PARAMETROS, @VERIF_ACTUALIZACION, @ROWPOINTER
						END
				  FETCH NEXT FROM C_PUBLICADORES
				  INTO @MULTI_PUBLICADOR
				END
			CLOSE C_PUBLICADORES
			DEALLOCATE C_PUBLICADORES
			
			IF (@@ERROR <> 0)
			BEGIN
			   RAISERROR( 'Error leyendo los publicadores habilitados para los módulos offline. Procedure POS_InsertarSolicitud.',16,1 )
			END
	  END

	SET	@ERROR = @@ERROR
	IF	@ERROR > 0
		BEGIN
			RAISERROR ( 'Error insertando solicitud de servicio.', 13, 3 )
			IF	@@TRANCOUNT > 0
				ROLLBACK TRANSACTION
		END
	RETURN @Error
END
;



CREATE PROCEDURE $$Compania$$.REGENERA_DOC_POS_LINEA
	 @DOCUMENTOS VARCHAR(20),
	 @CAJAS VARCHAR(6),
	 @TIPOS VARCHAR(1),
	 @PUBLICADOR VARCHAR(20),
	 @INSERTA VARCHAR(1)	
AS
BEGIN
	DECLARE @ERROR INT	
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @OPERACION VARCHAR(8)	
	DECLARE @LINEA VARCHAR(4)
	DECLARE @DOCUMENTO VARCHAR(20)
	DECLARE @CAJA VARCHAR(6)
	DECLARE @TIPO VARCHAR(1)
	DECLARE @ARTICULO VARCHAR(20)
	DECLARE @LOTE VARCHAR(15)
	DECLARE @CANTIDAD DECIMAL(28,8)
	DECLARE @PRECIO_VENTA DECIMAL(28,8)
	DECLARE @DESCUENTO_LINEA DECIMAL(28,8)
	DECLARE @DESCUENTO_GENERAL DECIMAL(28,8)
	DECLARE @TOTAL_IMPUESTO1 DECIMAL(28,8)
	DECLARE @TOTAL_IMPUESTO2 DECIMAL(28,8)
	DECLARE @LEYENDA VARCHAR(256)
	DECLARE @CANT_RESERVADA_PED DECIMAL(28,8)
  DECLARE @BODEGA VARCHAR(4)
  DECLARE @PEDIDO VARCHAR(55)
	DECLARE @LOCALIZACION 	VARCHAR(8)
	DECLARE @BASE_IMPUESTO1	DECIMAL(28,8)
	DECLARE @BASE_IMPUESTO2	DECIMAL(28,8) 				
	DECLARE @NOTAS VARCHAR(4000)
	DECLARE @MONTO_RETENCION DECIMAL(28,8)
	

	IF @INSERTA = 'I'	
	BEGIN
	SET @OPERACION = 'INSERTA'
	END
	ELSE
	BEGIN
	SET @OPERACION = 'MODIFICA'
	END

	DECLARE C_INSERTED CURSOR LOCAL FOR
	SELECT LINEA, DOCUMENTO, CAJA, TIPO, ARTICULO, LOTE, CANTIDAD, PRECIO_VENTA, DESCUENTO_LINEA, DESCUENTO_GENERAL, TOTAL_IMPUESTO1, TOTAL_IMPUESTO2, LEYENDA, CANT_RESERVADA_PED, BODEGA, PEDIDO, LOCALIZACION, BASE_IMPUESTO1, BASE_IMPUESTO2, NOTAS, MONTO_RETENCION
	FROM $$Compania$$.DOC_POS_LINEA
	WHERE DOCUMENTO = @DOCUMENTOS AND CAJA = @CAJAS AND TIPO = @TIPOS
		
	OPEN C_INSERTED	
	FETCH NEXT FROM C_INSERTED INTO
	@LINEA, @DOCUMENTO, @CAJA, @TIPO, @ARTICULO, @LOTE, @CANTIDAD, @PRECIO_VENTA, @DESCUENTO_LINEA, @DESCUENTO_GENERAL, @TOTAL_IMPUESTO1, @TOTAL_IMPUESTO2, @LEYENDA, @CANT_RESERVADA_PED, @BODEGA, @PEDIDO, @LOCALIZACION, @BASE_IMPUESTO1, @BASE_IMPUESTO2, @NOTAS, @MONTO_RETENCION
	SET @ERROR = 0
	WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
	BEGIN
		SET @PARAMETROS =
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<DOC_POS_LINEA>' + 
				'<LINEA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@LINEA) + '</LINEA>' + 
				'<DOCUMENTO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@DOCUMENTO) + '</DOCUMENTO>' + 
				'<CAJA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CAJA) + '</CAJA>' + 
				'<TIPO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO) + '</TIPO>' + 
				'<ARTICULO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ARTICULO) + '</ARTICULO>' + 
				'<LOTE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@LOTE) + '</LOTE>' + 
				'<CANTIDAD Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@CANTIDAD) + '</CANTIDAD>' + 
				'<PRECIO_VENTA Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@PRECIO_VENTA) + '</PRECIO_VENTA>' + 
				'<DESCUENTO_LINEA Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@DESCUENTO_LINEA) + '</DESCUENTO_LINEA>' + 
				'<DESCUENTO_GENERAL Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@DESCUENTO_GENERAL) + '</DESCUENTO_GENERAL>' + 
				'<TOTAL_IMPUESTO1 Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@TOTAL_IMPUESTO1) + '</TOTAL_IMPUESTO1>' + 
				'<TOTAL_IMPUESTO2 Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@TOTAL_IMPUESTO2) + '</TOTAL_IMPUESTO2>' + 
				'<LEYENDA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@LEYENDA) + '</LEYENDA>' + 
				'<CANT_RESERVADA_PED Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@CANT_RESERVADA_PED) + '</CANT_RESERVADA_PED>' + 
				'<BODEGA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@BODEGA) + '</BODEGA>' + 
				'<PEDIDO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@PEDIDO) + '</PEDIDO>' + 
				'<LOCALIZACION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@LOCALIZACION) + '</LOCALIZACION>' + 
				'<BASE_IMPUESTO1 Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@BASE_IMPUESTO1) + '</BASE_IMPUESTO1>' + 
				'<BASE_IMPUESTO2 Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@BASE_IMPUESTO2) + '</BASE_IMPUESTO2>' + 
				'<NOTAS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOTAS) + '</NOTAS>' + 
				'<MONTO_RETENCION Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@MONTO_RETENCION) + '</MONTO_RETENCION>' + 
				'</DOC_POS_LINEA>'

		EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'DOCPOSLINEAPOS600', @OPERACION, @PARAMETROS, 0, ''
		
		FETCH NEXT FROM C_INSERTED INTO
		@LINEA, @DOCUMENTO, @CAJA, @TIPO, @ARTICULO, @LOTE, @CANTIDAD, @PRECIO_VENTA, @DESCUENTO_LINEA, @DESCUENTO_GENERAL, @TOTAL_IMPUESTO1, @TOTAL_IMPUESTO2, @LEYENDA, @CANT_RESERVADA_PED, @BODEGA, @PEDIDO, @LOCALIZACION, @BASE_IMPUESTO1, @BASE_IMPUESTO2, @NOTAS, @MONTO_RETENCION
	END
	CLOSE C_INSERTED
	DEALLOCATE C_INSERTED

	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para regenerar solicitudes Offline.',16,1 )
	END
END;




CREATE PROCEDURE $$Compania$$.REGENERA_DOC_POS_RETENCION
	 @DOCUMENTOS VARCHAR(20),
	 @CAJAS VARCHAR(6),
	 @TIPOS VARCHAR(1),
	 @PUBLICADOR VARCHAR(20),
	 @INSERTA VARCHAR(1)	
AS
BEGIN
	DECLARE @ERROR INT	
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @OPERACION VARCHAR(8)	
	DECLARE @DOCUMENTO VARCHAR(50)
	DECLARE @TIPO VARCHAR(1)
	DECLARE @CAJA VARCHAR(6)
	DECLARE @CODIGO_RETENCION VARCHAR(4)
	DECLARE @AUTORETENEDORA VARCHAR(1)
	DECLARE @MONTO DECIMAL(28,8)
	DECLARE @BASE DECIMAL(28,8)
	DECLARE @DOC_REFERENCIA VARCHAR(50)
	DECLARE @DOC_CXC_RETENCION 	VARCHAR(50)
	DECLARE @TIPO_DOC_RETENCION 	VARCHAR(3)


	IF @INSERTA = 'I'	
		BEGIN
			SET @OPERACION = 'INSERTA'
		END
	ELSE
		BEGIN
			SET @OPERACION = 'MODIFICA'
		END

	DECLARE C_INSERTED CURSOR LOCAL FOR
	SELECT DOCUMENTO, TIPO, CAJA, CODIGO_RETENCION, AUTORETENEDORA, MONTO, BASE, DOC_REFERENCIA, DOC_CXC_RETENCION, TIPO_DOC_RETENCION 
	FROM $$Compania$$.DOC_POS_RETENCION
	WHERE DOCUMENTO = @DOCUMENTOS AND CAJA = @CAJAS AND TIPO = @TIPOS
		
	OPEN C_INSERTED	
	FETCH NEXT FROM C_INSERTED INTO
	@DOCUMENTO, @TIPO, @CAJA, @CODIGO_RETENCION, @AUTORETENEDORA, @MONTO, @BASE, @DOC_REFERENCIA, @DOC_CXC_RETENCION, @TIPO_DOC_RETENCION
	SET @ERROR = 0
	WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
	BEGIN
		SET @PARAMETROS =
			'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<DOC_POS_RETENCION>' + 
				'<DOCUMENTO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@DOCUMENTO) + '</DOCUMENTO>' + 
				'<TIPO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO) + '</TIPO>' + 
				'<CAJA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CAJA) + '</CAJA>' + 
				'<CODIGO_RETENCION Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CODIGO_RETENCION) + '</CODIGO_RETENCION>' + 
				'<AUTORETENEDORA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@AUTORETENEDORA) + '</AUTORETENEDORA>' + 
				'<MONTO Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@MONTO) + '</MONTO>' + 
				'<BASE Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@BASE) + '</BASE>' + 
				'<DOC_REFERENCIA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DOC_REFERENCIA) + '</DOC_REFERENCIA>' + 
				'<DOC_CXC_RETENCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DOC_CXC_RETENCION) + '</DOC_CXC_RETENCION>' + 
				'<TIPO_DOC_RETENCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_DOC_RETENCION) + '</TIPO_DOC_RETENCION>' + 								
				'</DOC_POS_RETENCION>'

				EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'DOCPOSRETENCIONPOS600', @OPERACION, @PARAMETROS, 0, ''
		
		FETCH NEXT FROM C_INSERTED INTO
		@DOCUMENTO, @TIPO, @CAJA, @CODIGO_RETENCION, @AUTORETENEDORA, @MONTO, @BASE, @DOC_REFERENCIA, @DOC_CXC_RETENCION, @TIPO_DOC_RETENCION
	END
	CLOSE C_INSERTED
	DEALLOCATE C_INSERTED

	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para regenerar solicitudes Offline.',16,1 )
	END
END;




CREATE FUNCTION ERPADMIN.POS_FormatoFecha
(
	@FECHA DATETIME
)
RETURNS	VARCHAR(8000)
AS
BEGIN
	DECLARE	@VALOR VARCHAR(100)
	IF	@FECHA IS NOT NULL
	BEGIN
	SET 	@VALOR =CONVERT( VARCHAR, DAY(@FECHA) ) + '-' +
		CONVERT( VARCHAR, MONTH(@FECHA) ) + '-' +
		CONVERT( VARCHAR, YEAR(@FECHA) ) + ' ' +
		CONVERT( VARCHAR, DATEPART(HOUR, @FECHA) ) + ':' +
		CONVERT( VARCHAR, DATEPART(MINUTE, @FECHA) ) + ':' +
		CONVERT( VARCHAR, DATEPART(SECOND, @FECHA) ) + '.' +
		CONVERT( VARCHAR, DATEPART(MILLISECOND, @FECHA))
	END
	ELSE
	BEGIN
		SET @VALOR = '@$NULL$@'
	END
	RETURN @VALOR
END;




CREATE FUNCTION ERPADMIN.POS_NumberToVarchar
(
	@NUMERO DECIMAL(28,8)
)
RETURNS	VARCHAR(8000)
AS
BEGIN
	DECLARE	@VALOR VARCHAR(100)
	IF	@NUMERO IS NOT NULL
	BEGIN
		SET	@VALOR =CONVERT(VARCHAR(36),@NUMERO)
	END
	ELSE
	BEGIN
		SET	@VALOR = '@$NULL$@'
	END
	RETURN @VALOR
END;




CREATE FUNCTION ERPADMIN.POS_ReemplazarCaracter
(
	@XMLTEXT VARCHAR(8000)
)
RETURNS VARCHAR(8000)
AS
BEGIN
	IF	@XMLTEXT IS NOT NULL
	BEGIN
		SET @XMLTEXT = REPLACE(@XMLTEXT,'&','&amp;')
		SET @XMLTEXT = REPLACE(@XMLTEXT,'<','&lt;')
		SET @XMLTEXT = REPLACE(@XMLTEXT,'>','&gt;')
		SET @XMLTEXT = REPLACE(@XMLTEXT,'"','&quot;')
		SET @XMLTEXT = REPLACE(@XMLTEXT,'''','&apos;')
	END
	ELSE
	BEGIN
		SET @XMLTEXT  = '@$NULL$@'
	END
	RETURN @XMLTEXT
END;

CREATE TRIGGER $$Compania$$.AFILIADO_POS_INS
ON $$Compania$$.AFILIADO
FOR INSERT
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @TIPO_SITIO_LOCAL VARCHAR(1)
	DECLARE @ASEGURADORA VARCHAR(20)
	DECLARE @AFILIADO VARCHAR(20)
	DECLARE @NOMBRE VARCHAR(80)
	DECLARE @CEDULA VARCHAR(6)
	DECLARE @TELEFONO VARCHAR(15)
	
	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM,
	       @TIPO_SITIO_LOCAL = TIPO_SITIO_LOCAL
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (SYSTEM_USER = @USUARIO_POS_WSQM AND @TIPO_SITIO_LOCAL = 'T')
	BEGIN
		DECLARE C_INSERTED CURSOR LOCAL FOR
		SELECT ASEGURADORA, AFILIADO, NOMBRE, CEDULA, TELEFONO
		FROM INSERTED i
			
		OPEN C_INSERTED	
		FETCH NEXT FROM C_INSERTED INTO
		@ASEGURADORA, @AFILIADO, @NOMBRE, @CEDULA, @TELEFONO

		SET @ERROR = 0
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS = 
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<AFILIADO>' + 
				'<ASEGURADORA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@ASEGURADORA) + '</ASEGURADORA>' + 
				'<AFILIADO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@AFILIADO) + '</AFILIADO>' + 
				'<NOMBRE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOMBRE) + '</NOMBRE>' + 
				'<CEDULA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CEDULA) + '</CEDULA>' + 
				'<TELEFONO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TELEFONO) + '</TELEFONO>' + 
				'</AFILIADO>'


			-- Inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'AFILIADOPOS600', 'INSERTA', @PARAMETROS, 0, ''

			FETCH NEXT FROM C_INSERTED INTO
			@ASEGURADORA, @AFILIADO, @NOMBRE, @CEDULA, @TELEFONO
		END

		CLOSE C_INSERTED
    		DEALLOCATE C_INSERTED
	END

	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla AFILIADO.',16,1 )
	END
END;







CREATE TRIGGER $$Compania$$.AFILIADO_POS_MOD
ON $$Compania$$.AFILIADO
FOR UPDATE
AS 
BEGIN   	
	DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @COL_ROWPOINTER VARCHAR(36)
	DECLARE @HAY_CAMPOS_PARA_POS BIT
	DECLARE @TIPO_SITIO_LOCAL VARCHAR(1)
	DECLARE @ACTUALIZAR_SOLICITUD BIT
	DECLARE @ASEGURADORA VARCHAR(20)
	DECLARE @AFILIADO VARCHAR(20)
	DECLARE @NOMBRE VARCHAR(80)
	DECLARE @CEDULA VARCHAR(6)
	DECLARE @TELEFONO VARCHAR(15)
	 -- Declaraciones

	SET @ERROR = 0

	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM,
	       @TIPO_SITIO_LOCAL = TIPO_SITIO_LOCAL
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (SYSTEM_USER = @USUARIO_POS_WSQM AND @TIPO_SITIO_LOCAL = 'T')
	BEGIN
		DECLARE C_MODIFIED CURSOR LOCAL FOR
			SELECT ASEGURADORA, AFILIADO, NOMBRE, CEDULA, TELEFONO -- Columnas
			FROM INSERTED I

		SET @ACTUALIZAR_SOLICITUD = 1

		OPEN C_MODIFIED

		FETCH NEXT FROM C_MODIFIED
		INTO @ASEGURADORA, @AFILIADO, @NOMBRE, @CEDULA, @TELEFONO

		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			IF ( NOT UPDATE(RECORDDATE) AND ( UPDATE(ASEGURADORA) OR UPDATE(AFILIADO) OR UPDATE(NOMBRE) OR UPDATE(CEDULA) OR UPDATE(TELEFONO) ) )
			BEGIN

				SELECT @COL_ROWPOINTER = ROWPOINTER 
				FROM $$Compania$$.AFILIADO
				WHERE ASEGURADORA = @ASEGURADORA AND AFILIADO = @AFILIADO 

				SET @PARAMETROS =
					'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<AFILIADO>' + 
				'<ASEGURADORA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@ASEGURADORA) + '</ASEGURADORA>' + 
				'<AFILIADO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@AFILIADO) + '</AFILIADO>' + 
				'<NOMBRE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOMBRE) + '</NOMBRE>' + 
				'<CEDULA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CEDULA) + '</CEDULA>' + 
				'<TELEFONO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TELEFONO) + '</TELEFONO>' + 
				'</AFILIADO>'


				-- inserta la solicitud correspondiente
				EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'AFILIADOPOS600', 'MODIFICA', @PARAMETROS, @ACTUALIZAR_SOLICITUD, @COL_ROWPOINTER
			END

			FETCH NEXT FROM C_MODIFIED
			INTO @ASEGURADORA, @AFILIADO, @NOMBRE, @CEDULA, @TELEFONO
		END

		CLOSE C_MODIFIED
		DEALLOCATE C_MODIFIED
	END

	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para modificar la tabla AFILIADO.',16,1 )
	END
END;






CREATE TRIGGER $$Compania$$.AFILIADO_POS_DEL
ON $$Compania$$.AFILIADO
FOR DELETE  
AS 
BEGIN   	
        DECLARE @ERROR  int
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @TIPO_SITIO_LOCAL VARCHAR(1)
	DECLARE @ASEGURADORA VARCHAR(20)
	DECLARE @AFILIADO VARCHAR(20)
	 -- Declaraciones	

	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM,
	       @TIPO_SITIO_LOCAL = TIPO_SITIO_LOCAL
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (SYSTEM_USER = @USUARIO_POS_WSQM AND @TIPO_SITIO_LOCAL = 'T')
	BEGIN
		DECLARE C_DELETED CURSOR LOCAL FOR
			SELECT ASEGURADORA, AFILIADO
			FROM DELETED d

		OPEN C_DELETED
		FETCH NEXT FROM C_DELETED INTO 
		@ASEGURADORA, @AFILIADO
		
		SET @ERROR = 0
		
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS = 
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<AFILIADO>' + 
				'<ASEGURADORA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@ASEGURADORA) + '</ASEGURADORA>' + 
				'<AFILIADO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@AFILIADO) + '</AFILIADO>' + 
				'</AFILIADO>'
 
			
			-- inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'AFILIADOPOS600', 'ELIMINA', @PARAMETROS, 0, ''
			
			FETCH NEXT FROM C_DELETED INTO 
			@ASEGURADORA, @AFILIADO
		END

		CLOSE C_DELETED
		DEALLOCATE C_DELETED
	END
	
	IF (@@ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para eliminar de la tabla AFILIADO.',16,1 )
	END
END;



CREATE TRIGGER ERPADMIN.CONFIG_PAR_SITIO_POS_INS
ON ERPADMIN.CONFIG_PAR_SITIO
FOR INSERT
AS
BEGIN
	DECLARE @ERROR INT
	
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @SUSCRIPTOR VARCHAR(20)
	DECLARE @CONSECUTIVO DECIMAL(28,8)
	DECLARE @RUTA VARCHAR(250)
	DECLARE @TIPO VARCHAR(1)
	DECLARE @TIPO_CONEXION VARCHAR(1)
	DECLARE @MAX_SIZEKB INT
	DECLARE @ESTADO VARCHAR(1)
	
	DECLARE C_INSERTED CURSOR LOCAL FOR
	SELECT PUBLICADOR, SUSCRIPTOR, CONSECUTIVO, RUTA, TIPO, TIPO_CONEXION, MAX_SIZEKB, ESTADO
	FROM INSERTED i
	WHERE 0 = (
			SELECT COUNT('n')
			FROM DELETED d
			WHERE i.PUBLICADOR = d.PUBLICADOR AND i.SUSCRIPTOR = d.SUSCRIPTOR
			 )
	OPEN C_INSERTED	
	FETCH NEXT FROM C_INSERTED INTO
	@PUBLICADOR, @SUSCRIPTOR, @CONSECUTIVO, @RUTA, @TIPO, @TIPO_CONEXION, @MAX_SIZEKB, @ESTADO
	SET @ERROR = 0
	WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
	BEGIN
		SET @PARAMETROS =
			'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
			'<CONFIG_PAR_SITIO>' +
			'<PUBLICADOR Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@PUBLICADOR) + '</PUBLICADOR>' +
			'<SUSCRIPTOR Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@SUSCRIPTOR) + '</SUSCRIPTOR>' +
			'<CONSECUTIVO Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@CONSECUTIVO) + '</CONSECUTIVO>' +
			'<RUTA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@RUTA) + '</RUTA>' +
			'<TIPO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO) + '</TIPO>' +
			'<TIPO_CONEXION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_CONEXION) + '</TIPO_CONEXION>' +
			'<MAX_SIZEKB Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@MAX_SIZEKB) + '</MAX_SIZEKB>' +
			'<ESTADO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ESTADO) + '</ESTADO>' +
			'</CONFIG_PAR_SITIO>'
		-- Inserta la solicitud correspondiente
		EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud '*', 'CONFIGPARSITIOPOS600', 'INSERTA', @PARAMETROS, 0, ''
		FETCH NEXT FROM C_INSERTED INTO
		@PUBLICADOR, @SUSCRIPTOR, @CONSECUTIVO, @RUTA, @TIPO, @TIPO_CONEXION, @MAX_SIZEKB, @ESTADO
	END
	CLOSE C_INSERTED
	DEALLOCATE C_INSERTED
	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla CONFIG_PAR_SITIO.',16,1 )
	END
END
;




CREATE TRIGGER ERPADMIN.CONFIG_PAR_SITIO_POS_DEL
ON ERPADMIN.CONFIG_PAR_SITIO
FOR DELETE
AS
BEGIN   	
                DECLARE @ERROR  int
	
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @SUSCRIPTOR VARCHAR(20)
	 -- Declaraciones	
	DECLARE C_DELETED CURSOR LOCAL FOR
		SELECT PUBLICADOR, SUSCRIPTOR
		FROM DELETED d
		WHERE 0 = (
			SELECT COUNT('n')
			FROM INSERTED i
			WHERE d.PUBLICADOR = i.PUBLICADOR AND d.SUSCRIPTOR = i.SUSCRIPTOR
			 )
	OPEN C_DELETED
	FETCH NEXT FROM C_DELETED INTO
	@PUBLICADOR, @SUSCRIPTOR
	SET @ERROR = 0
	WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
	BEGIN
		SET @PARAMETROS =
							'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
			'<CONFIG_PAR_SITIO>' +
			'<PUBLICADOR Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@PUBLICADOR) + '</PUBLICADOR>' +
			'<SUSCRIPTOR Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@SUSCRIPTOR) + '</SUSCRIPTOR>' +
			'</CONFIG_PAR_SITIO>'
-- XML
		-- inserta la solicitud correspondiente
		EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud '*', 'CONFIGPARSITIOPOS600', 'ELIMINA', @PARAMETROS, 0, ''
		FETCH NEXT FROM C_DELETED INTO
		@PUBLICADOR, @SUSCRIPTOR
	END
	CLOSE C_DELETED
	DEALLOCATE C_DELETED
	
	IF (@@ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para eliminar de la tabla CONFIG_PAR_SITIO.',16,1 )
	END
END
;




CREATE TRIGGER ERPADMIN.CONFIG_PAR_SITIO_POS_MOD
ON ERPADMIN.CONFIG_PAR_SITIO
FOR UPDATE
AS
BEGIN   	
	DECLARE @ERROR  INT
	
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @COL_ROWPOINTER VARCHAR(36)
	DECLARE @HAY_CAMPOS_PARA_POS BIT
	DECLARE @ACTUALIZAR_SOLICITUD BIT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @SUSCRIPTOR VARCHAR(20)
	DECLARE @CONSECUTIVO DECIMAL(28,8)
	DECLARE @RUTA VARCHAR(250)
	DECLARE @TIPO VARCHAR(1)
	DECLARE @TIPO_CONEXION VARCHAR(1)
	DECLARE @MAX_SIZEKB INT
	DECLARE @ESTADO VARCHAR(1)
	 -- Declaraciones
	SET @ERROR = 0
	DECLARE C_MODIFIED CURSOR LOCAL FOR
		SELECT PUBLICADOR, SUSCRIPTOR, CONSECUTIVO, RUTA, TIPO, TIPO_CONEXION, MAX_SIZEKB, ESTADO -- Columnas
		FROM INSERTED I
	SET @ACTUALIZAR_SOLICITUD = 1
	OPEN C_MODIFIED
	FETCH NEXT FROM C_MODIFIED
	INTO @PUBLICADOR, @SUSCRIPTOR, @CONSECUTIVO, @RUTA, @TIPO, @TIPO_CONEXION, @MAX_SIZEKB, @ESTADO
	WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
	BEGIN
		IF ( NOT UPDATE(RECORDDATE) AND ( UPDATE(PUBLICADOR) OR UPDATE(SUSCRIPTOR) OR UPDATE(CONSECUTIVO) OR UPDATE(RUTA) OR UPDATE(TIPO) OR UPDATE(TIPO_CONEXION) OR UPDATE(MAX_SIZEKB) OR UPDATE(ESTADO) ) )
		BEGIN
			SELECT @COL_ROWPOINTER = ROWPOINTER
			FROM ERPADMIN.CONFIG_PAR_SITIO
			WHERE PUBLICADOR = @PUBLICADOR AND SUSCRIPTOR = @SUSCRIPTOR
			SET @PARAMETROS =
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
			'<CONFIG_PAR_SITIO>' +
			'<PUBLICADOR Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@PUBLICADOR) + '</PUBLICADOR>' +
			'<SUSCRIPTOR Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@SUSCRIPTOR) + '</SUSCRIPTOR>' +
			'<CONSECUTIVO Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@CONSECUTIVO) + '</CONSECUTIVO>' +
			'<RUTA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@RUTA) + '</RUTA>' +
			'<TIPO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO) + '</TIPO>' +
			'<TIPO_CONEXION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_CONEXION) + '</TIPO_CONEXION>' +
			'<MAX_SIZEKB Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@MAX_SIZEKB) + '</MAX_SIZEKB>' +
			'<ESTADO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ESTADO) + '</ESTADO>' +
			'</CONFIG_PAR_SITIO>'
			-- inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud '*', 'CONFIGPARSITIOPOS600', 'MODIFICA', @PARAMETROS, @ACTUALIZAR_SOLICITUD, @COL_ROWPOINTER
		END
		FETCH NEXT FROM C_MODIFIED
		INTO @PUBLICADOR, @SUSCRIPTOR, @CONSECUTIVO, @RUTA, @TIPO, @TIPO_CONEXION, @MAX_SIZEKB, @ESTADO
	END
	CLOSE C_MODIFIED
	DEALLOCATE C_MODIFIED
	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para modificar la tabla CONFIG_PAR_SITIO.',16,1 )
	END
END
;




CREATE TRIGGER ERPADMIN.GLOBALES_WSQM_POS_INS
ON ERPADMIN.GLOBALES_WSQM
FOR INSERT
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @NOTIFICACION VARCHAR(1)
	DECLARE @EMAIL VARCHAR(50)
	DECLARE @EMAIL_SERVER VARCHAR(250)
	DECLARE @REPLICA VARCHAR(1)
	DECLARE @ELIM_SOL_PROC VARCHAR(1)
	DECLARE @CANT_DIAS_REINTENTO_ERROR INT
	DECLARE @CANT_DIAS_BORRADO_ERROR INT
	DECLARE @NOMBRE_MAQUINA VARCHAR(15)
	DECLARE @VALIDA_MAQUINA VARCHAR(1)

	
	DECLARE C_INSERTED CURSOR LOCAL FOR
	SELECT NOTIFICACION, EMAIL, EMAIL_SERVER, REPLICA, ELIM_SOL_PROC, CANT_DIAS_REINTENTO_ERROR, CANT_DIAS_BORRADO_ERROR, NOMBRE_MAQUINA, VALIDA_MAQUINA
	FROM INSERTED i

	OPEN C_INSERTED	
	FETCH NEXT FROM C_INSERTED INTO
	@NOTIFICACION, @EMAIL, @EMAIL_SERVER, @REPLICA, @ELIM_SOL_PROC, @CANT_DIAS_REINTENTO_ERROR, @CANT_DIAS_BORRADO_ERROR, @NOMBRE_MAQUINA, @VALIDA_MAQUINA

	SET @ERROR = 0
	WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
	BEGIN
		SET @PARAMETROS = 
			'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
			'<GLOBALES_WSQM>' + 
			'<NOTIFICACION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOTIFICACION) + '</NOTIFICACION>' + 
			'<EMAIL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@EMAIL) + '</EMAIL>' + 
			'<EMAIL_SERVER Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@EMAIL_SERVER) + '</EMAIL_SERVER>' + 
			'<REPLICA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@REPLICA) + '</REPLICA>' + 
			'<ELIM_SOL_PROC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ELIM_SOL_PROC) + '</ELIM_SOL_PROC>' +
 			'<CANT_DIAS_REINTENTO_ERROR Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@CANT_DIAS_REINTENTO_ERROR) + '</CANT_DIAS_REINTENTO_ERROR>' + 
			'<CANT_DIAS_BORRADO_ERROR Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@CANT_DIAS_BORRADO_ERROR) + '</CANT_DIAS_BORRADO_ERROR>' + 
			'<NOMBRE_MAQUINA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOMBRE_MAQUINA) + '</NOMBRE_MAQUINA>' + 
			'<VALIDA_MAQUINA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@VALIDA_MAQUINA) + '</VALIDA_MAQUINA>' + 
			'</GLOBALES_WSQM>'
		-- Inserta la solicitud correspondiente
		EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud '*', 'GLOBALESWSQMPOS600', 'INSERTA', @PARAMETROS, 0, ''
		FETCH NEXT FROM C_INSERTED INTO
		@NOTIFICACION, @EMAIL, @EMAIL_SERVER, @REPLICA, @ELIM_SOL_PROC, @CANT_DIAS_REINTENTO_ERROR, @CANT_DIAS_BORRADO_ERROR, @NOMBRE_MAQUINA, @VALIDA_MAQUINA
	END
	CLOSE C_INSERTED
	DEALLOCATE C_INSERTED

	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla GLOBALES_WSQM.',16,1 )
	END
END
;




CREATE TRIGGER ERPADMIN.GLOBALES_WSQM_POS_DEL
ON ERPADMIN.GLOBALES_WSQM
FOR DELETE  
AS 
BEGIN   	
        DECLARE @ERROR  int
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @NOTIFICACION VARCHAR(1)
	DECLARE @EMAIL VARCHAR(50)
	DECLARE @EMAIL_SERVER VARCHAR(250)
	DECLARE @REPLICA VARCHAR(1)
	DECLARE @ELIM_SOL_PROC VARCHAR(1) 
	DECLARE @CANT_DIAS_REINTENTO_ERROR INT
	DECLARE @CANT_DIAS_BORRADO_ERROR INT
	DECLARE @NOMBRE_MAQUINA VARCHAR(15)
	DECLARE @VALIDA_MAQUINA VARCHAR(1)

	 -- Declaraciones	
	DECLARE C_DELETED CURSOR LOCAL FOR
		SELECT NOTIFICACION, EMAIL, EMAIL_SERVER, REPLICA, ELIM_SOL_PROC, CANT_DIAS_REINTENTO_ERROR, CANT_DIAS_BORRADO_ERROR, NOMBRE_MAQUINA, VALIDA_MAQUINA
		FROM DELETED d
	OPEN C_DELETED
	FETCH NEXT FROM C_DELETED INTO 
	@NOTIFICACION, @EMAIL, @EMAIL_SERVER, @REPLICA, @ELIM_SOL_PROC, @CANT_DIAS_REINTENTO_ERROR, @CANT_DIAS_BORRADO_ERROR, @NOMBRE_MAQUINA, @VALIDA_MAQUINA -- VARIABLES

	SET @ERROR = 0

	WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
	BEGIN
		SET @PARAMETROS = 
			'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
			'<GLOBALES_WSQM>' + 
			'<NOTIFICACION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOTIFICACION) + '</NOTIFICACION>' + 
			'<EMAIL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@EMAIL) + '</EMAIL>' + 
			'<EMAIL_SERVER Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@EMAIL_SERVER) + '</EMAIL_SERVER>' + 
			'<REPLICA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@REPLICA) + '</REPLICA>' + 
			'<ELIM_SOL_PROC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ELIM_SOL_PROC) + '</ELIM_SOL_PROC>' + 
			'<CANT_DIAS_REINTENTO_ERROR Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@CANT_DIAS_REINTENTO_ERROR) + '</CANT_DIAS_REINTENTO_ERROR>' + 
			'<CANT_DIAS_BORRADO_ERROR Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@CANT_DIAS_BORRADO_ERROR) + '</CANT_DIAS_BORRADO_ERROR>' + 
			'<NOMBRE_MAQUINA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOMBRE_MAQUINA) + '</NOMBRE_MAQUINA>' + 
			'<VALIDA_MAQUINA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@VALIDA_MAQUINA) + '</VALIDA_MAQUINA>' + 
			'</GLOBALES_WSQM>'
-- XML
		-- inserta la solicitud correspondiente
		EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud '*', 'GLOBALESWSQMPOS600', 'ELIMINA', @PARAMETROS, 0, ''

		FETCH NEXT FROM C_DELETED INTO 
		@NOTIFICACION, @EMAIL, @EMAIL_SERVER, @REPLICA, @ELIM_SOL_PROC, @CANT_DIAS_REINTENTO_ERROR, @CANT_DIAS_BORRADO_ERROR, @NOMBRE_MAQUINA, @VALIDA_MAQUINA -- VARIABLES
	END
	CLOSE C_DELETED
	DEALLOCATE C_DELETED
	
	IF (@@ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para eliminar de la tabla GLOBALES_WSQM.',16,1 )
	END
END
;




CREATE TRIGGER ERPADMIN.GLOBALES_WSQM_POS_MOD
ON ERPADMIN.GLOBALES_WSQM
FOR UPDATE
AS 
BEGIN   	
	DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @COL_ROWPOINTER VARCHAR(36)
	DECLARE @HAY_CAMPOS_PARA_POS BIT
	DECLARE @ACTUALIZAR_SOLICITUD BIT
	DECLARE @NOTIFICACION VARCHAR(1)
	DECLARE @EMAIL VARCHAR(50)
	DECLARE @EMAIL_SERVER VARCHAR(250)
	DECLARE @REPLICA VARCHAR(1)
	DECLARE @ELIM_SOL_PROC VARCHAR(1)
	DECLARE @CANT_DIAS_REINTENTO_ERROR INT
	DECLARE @CANT_DIAS_BORRADO_ERROR INT
	DECLARE @NOMBRE_MAQUINA VARCHAR(15)
	DECLARE @VALIDA_MAQUINA VARCHAR(1)

	 -- Declaraciones
	SET @ERROR = 0

	DECLARE C_MODIFIED CURSOR LOCAL FOR
		SELECT NOTIFICACION, EMAIL, EMAIL_SERVER, REPLICA, ELIM_SOL_PROC, CANT_DIAS_REINTENTO_ERROR, CANT_DIAS_BORRADO_ERROR, NOMBRE_MAQUINA, VALIDA_MAQUINA, RowPointer -- Columnas
		FROM INSERTED I
	SET @ACTUALIZAR_SOLICITUD = 1
	OPEN C_MODIFIED
	FETCH NEXT FROM C_MODIFIED
	INTO @NOTIFICACION, @EMAIL, @EMAIL_SERVER, @REPLICA, @ELIM_SOL_PROC, @CANT_DIAS_REINTENTO_ERROR, @CANT_DIAS_BORRADO_ERROR, @NOMBRE_MAQUINA, @VALIDA_MAQUINA, @COL_ROWPOINTER
	WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
	BEGIN
		IF ( NOT UPDATE(RECORDDATE) AND ( UPDATE(NOTIFICACION) OR UPDATE(EMAIL) OR UPDATE(EMAIL_SERVER) OR UPDATE(REPLICA) OR UPDATE(ELIM_SOL_PROC) OR UPDATE(CANT_DIAS_REINTENTO_ERROR) OR UPDATE(CANT_DIAS_BORRADO_ERROR) OR UPDATE(NOMBRE_MAQUINA) OR UPDATE(VALIDA_MAQUINA)) )
		BEGIN
			SET @COL_ROWPOINTER = ''
			SET @ACTUALIZAR_SOLICITUD = 0
			SET @PARAMETROS =
			'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
			'<GLOBALES_WSQM>' + 
			'<NOTIFICACION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOTIFICACION) + '</NOTIFICACION>' + 
			'<EMAIL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@EMAIL) + '</EMAIL>' + 
			'<EMAIL_SERVER Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@EMAIL_SERVER) + '</EMAIL_SERVER>' + 
			'<REPLICA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@REPLICA) + '</REPLICA>' + 
			'<ELIM_SOL_PROC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ELIM_SOL_PROC) + '</ELIM_SOL_PROC>' + 
			'<CANT_DIAS_REINTENTO_ERROR Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@CANT_DIAS_REINTENTO_ERROR) + '</CANT_DIAS_REINTENTO_ERROR>' + 
			'<CANT_DIAS_BORRADO_ERROR Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@CANT_DIAS_BORRADO_ERROR) + '</CANT_DIAS_BORRADO_ERROR>' + 
			'<NOMBRE_MAQUINA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOMBRE_MAQUINA) + '</NOMBRE_MAQUINA>' + 
			'<VALIDA_MAQUINA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@VALIDA_MAQUINA) + '</VALIDA_MAQUINA>' + 
			'</GLOBALES_WSQM>'
			-- inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud '*', 'GLOBALESWSQMPOS600', 'MODIFICA', @PARAMETROS, @ACTUALIZAR_SOLICITUD, @COL_ROWPOINTER
		END
		FETCH NEXT FROM C_MODIFIED
		INTO @NOTIFICACION, @EMAIL, @EMAIL_SERVER, @REPLICA, @ELIM_SOL_PROC, @CANT_DIAS_REINTENTO_ERROR, @CANT_DIAS_BORRADO_ERROR, @NOMBRE_MAQUINA, @VALIDA_MAQUINA, @COL_ROWPOINTER
	END
	CLOSE C_MODIFIED
	DEALLOCATE C_MODIFIED

	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para modificar la tabla GLOBALES_WSQM.',16,1 )
	END
END
;




CREATE TRIGGER ERPADMIN.MEMBRESIA_POS_INS
ON ERPADMIN.MEMBRESIA
FOR INSERT
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @GRUPO VARCHAR(25)
	DECLARE @USUARIO VARCHAR(25)
	
	DECLARE C_INSERTED CURSOR LOCAL FOR
	SELECT GRUPO, USUARIO
	FROM INSERTED i
	WHERE 0 = (
			SELECT COUNT('n')
			FROM DELETED d
			WHERE i.GRUPO = d.GRUPO AND i.USUARIO = d.USUARIO
			 )
	OPEN C_INSERTED	
	FETCH NEXT FROM C_INSERTED INTO
	@GRUPO, @USUARIO
	SET @ERROR = 0
	WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
	BEGIN
		SET @PARAMETROS =
			'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
			'<MEMBRESIA>' +
			'<GRUPO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@GRUPO) + '</GRUPO>' +
			'<USUARIO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@USUARIO) + '</USUARIO>' +
			'</MEMBRESIA>'
		-- Inserta la solicitud correspondiente
		EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud '*', 'MEMBRESIAPOS600', 'INSERTA', @PARAMETROS, 0, ''
		FETCH NEXT FROM C_INSERTED INTO
		@GRUPO, @USUARIO
	END
	CLOSE C_INSERTED
	DEALLOCATE C_INSERTED
	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla MEMBRESIA.',16,1 )
	END
END
;




CREATE TRIGGER ERPADMIN.MEMBRESIA_POS_DEL
ON ERPADMIN.MEMBRESIA
FOR DELETE
AS
BEGIN   	
                DECLARE @ERROR  int
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @GRUPO VARCHAR(25)
	DECLARE @USUARIO VARCHAR(25)
	 -- Declaraciones	
	DECLARE C_DELETED CURSOR LOCAL FOR
		SELECT GRUPO, USUARIO
		FROM DELETED d
		WHERE 0 = (
			SELECT COUNT('n')
			FROM INSERTED i
			WHERE d.GRUPO = i.GRUPO AND d.USUARIO = i.USUARIO
			 )
	OPEN C_DELETED
	FETCH NEXT FROM C_DELETED INTO
	@GRUPO, @USUARIO -- VARIABLES
	SET @ERROR = 0
	WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
	BEGIN
		SET @PARAMETROS =
							'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
			'<MEMBRESIA>' +
			'<GRUPO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@GRUPO) + '</GRUPO>' +
			'<USUARIO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@USUARIO) + '</USUARIO>' +
			'</MEMBRESIA>'
-- XML
		-- inserta la solicitud correspondiente
		EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud '*', 'MEMBRESIAPOS600', 'ELIMINA', @PARAMETROS, 0, ''
		FETCH NEXT FROM C_DELETED INTO
		@GRUPO, @USUARIO -- VARIABLES
	END
	CLOSE C_DELETED
	DEALLOCATE C_DELETED
	IF (@@ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para eliminar de la tabla MEMBRESIA.',16,1 )
	END
END
;




CREATE TRIGGER ERPADMIN.MEMBRESIA_POS_MOD
ON ERPADMIN.MEMBRESIA
FOR UPDATE
AS
BEGIN   	
	DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @COL_ROWPOINTER VARCHAR(36)
	DECLARE @HAY_CAMPOS_PARA_POS BIT
	DECLARE @ACTUALIZAR_SOLICITUD BIT
	DECLARE @GRUPO VARCHAR(25)
	DECLARE @USUARIO VARCHAR(25)
	 -- Declaraciones
	SET @ERROR = 0
	DECLARE C_MODIFIED CURSOR LOCAL FOR
		SELECT GRUPO, USUARIO -- Columnas
		FROM INSERTED I
	SET @ACTUALIZAR_SOLICITUD = 1
	OPEN C_MODIFIED
	FETCH NEXT FROM C_MODIFIED
	INTO @GRUPO, @USUARIO
	WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
	BEGIN
		IF ( NOT UPDATE(RECORDDATE) AND ( UPDATE(GRUPO) OR UPDATE(USUARIO) ) )
		BEGIN
			SELECT @COL_ROWPOINTER = ROWPOINTER
			FROM ERPADMIN.MEMBRESIA
			WHERE GRUPO = @GRUPO AND USUARIO = @USUARIO
			SET @PARAMETROS =
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
			'<MEMBRESIA>' +
			'<GRUPO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@GRUPO) + '</GRUPO>' +
			'<USUARIO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@USUARIO) + '</USUARIO>' +
			'</MEMBRESIA>'
			-- inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud '*', 'MEMBRESIAPOS600', 'MODIFICA', @PARAMETROS, @ACTUALIZAR_SOLICITUD, @COL_ROWPOINTER
		END
		FETCH NEXT FROM C_MODIFIED
		INTO @GRUPO, @USUARIO
	END
	CLOSE C_MODIFIED
	DEALLOCATE C_MODIFIED
	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para modificar la tabla MEMBRESIA.',16,1 )
	END
END
;





CREATE TRIGGER ERPADMIN.PRIVILEGIO_EX_POS_INS
ON ERPADMIN.PRIVILEGIO_EX
FOR INSERT
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @USUARIO VARCHAR(25)
	DECLARE @CONJUNTO VARCHAR(10)
	DECLARE @ACCION INT
	
	DECLARE C_INSERTED CURSOR LOCAL FOR
	SELECT USUARIO, CONJUNTO, ACCION
	FROM INSERTED i
	WHERE 0 = (
			SELECT COUNT('n')
			FROM DELETED d
			WHERE i.USUARIO = d.USUARIO AND i.CONJUNTO = d.CONJUNTO AND i.ACCION = d.ACCION
			 )
	OPEN C_INSERTED	
	FETCH NEXT FROM C_INSERTED INTO
	@USUARIO, @CONJUNTO, @ACCION
	SET @ERROR = 0
	WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
	BEGIN
		SET @PARAMETROS =
			'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
			'<PRIVILEGIO_EX>' +
			'<USUARIO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@USUARIO) + '</USUARIO>' +
			'<CONJUNTO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CONJUNTO) + '</CONJUNTO>' +
			'<ACCION Type="INT" PrimaryKey="True">' + ERPADMIN.POS_NumberToVarchar(@ACCION) + '</ACCION>' +
			'</PRIVILEGIO_EX>'
		-- Inserta la solicitud correspondiente
		EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud '*', 'PRIVILEGIOEXPOS600', 'INSERTA', @PARAMETROS, 0, ''
		FETCH NEXT FROM C_INSERTED INTO
		@USUARIO, @CONJUNTO, @ACCION
	END
	CLOSE C_INSERTED
	DEALLOCATE C_INSERTED
	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla PRIVILEGIO_EX.',16,1 )
	END
END
;




CREATE TRIGGER ERPADMIN.PRIVILEGIO_EX_POS_DEL
ON ERPADMIN.PRIVILEGIO_EX
FOR DELETE
AS
BEGIN   	
                DECLARE @ERROR  int
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @USUARIO VARCHAR(25)
	DECLARE @CONJUNTO VARCHAR(10)
	DECLARE @ACCION INT
	 -- Declaraciones	
	DECLARE C_DELETED CURSOR LOCAL FOR
		SELECT USUARIO, CONJUNTO, ACCION
		FROM DELETED d
		WHERE 0 = (
			SELECT COUNT('n')
			FROM INSERTED i
			WHERE d.USUARIO = i.USUARIO AND d.CONJUNTO = i.CONJUNTO AND d.ACCION = i.ACCION
			 )
	OPEN C_DELETED
	FETCH NEXT FROM C_DELETED INTO
	@USUARIO, @CONJUNTO, @ACCION -- VARIABLES
	SET @ERROR = 0
	WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
	BEGIN
		SET @PARAMETROS =
							'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
			'<PRIVILEGIO_EX>' +
			'<USUARIO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@USUARIO) + '</USUARIO>' +
			'<CONJUNTO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CONJUNTO) + '</CONJUNTO>' +
			'<ACCION Type="INT" PrimaryKey="True">' + ERPADMIN.POS_NumberToVarchar(@ACCION) + '</ACCION>' +
			'</PRIVILEGIO_EX>'
-- XML
		-- inserta la solicitud correspondiente
		EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud '*', 'PRIVILEGIOEXPOS600', 'ELIMINA', @PARAMETROS, 0, ''
		FETCH NEXT FROM C_DELETED INTO
		@USUARIO, @CONJUNTO, @ACCION -- VARIABLES
	END
	CLOSE C_DELETED
	DEALLOCATE C_DELETED
	
	IF (@@ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para eliminar de la tabla PRIVILEGIO_EX.',16,1 )
	END
END
;




CREATE TRIGGER ERPADMIN.PRIVILEGIO_EX_POS_MOD
ON ERPADMIN.PRIVILEGIO_EX
FOR UPDATE
AS
BEGIN   	
	DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @COL_ROWPOINTER VARCHAR(36)
	DECLARE @HAY_CAMPOS_PARA_POS BIT
	DECLARE @ACTUALIZAR_SOLICITUD BIT
	DECLARE @USUARIO VARCHAR(25)
	DECLARE @CONJUNTO VARCHAR(10)
	DECLARE @ACCION INT
	 -- Declaraciones
	SET @ERROR = 0
	DECLARE C_MODIFIED CURSOR LOCAL FOR
		SELECT USUARIO, CONJUNTO, ACCION -- Columnas
		FROM INSERTED I
	SET @ACTUALIZAR_SOLICITUD = 1
	OPEN C_MODIFIED
	FETCH NEXT FROM C_MODIFIED
	INTO @USUARIO, @CONJUNTO, @ACCION
	WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
	BEGIN
		IF ( NOT UPDATE(RECORDDATE) AND ( UPDATE(USUARIO) OR UPDATE(CONJUNTO) OR UPDATE(ACCION) ) )
		BEGIN
			SELECT @COL_ROWPOINTER = ROWPOINTER
			FROM ERPADMIN.PRIVILEGIO_EX
			WHERE USUARIO = @USUARIO AND CONJUNTO = @CONJUNTO AND ACCION = @ACCION
			SET @PARAMETROS =
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
			'<PRIVILEGIO_EX>' +
			'<USUARIO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@USUARIO) + '</USUARIO>' +
			'<CONJUNTO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CONJUNTO) + '</CONJUNTO>' +
			'<ACCION Type="INT" PrimaryKey="True">' + ERPADMIN.POS_NumberToVarchar(@ACCION) + '</ACCION>' +
			'</PRIVILEGIO_EX>'
			-- inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud '*', 'PRIVILEGIOEXPOS600', 'MODIFICA', @PARAMETROS, @ACTUALIZAR_SOLICITUD, @COL_ROWPOINTER
		END
		FETCH NEXT FROM C_MODIFIED
		INTO @USUARIO, @CONJUNTO, @ACCION
	END
	CLOSE C_MODIFIED
	DEALLOCATE C_MODIFIED
	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para modificar la tabla PRIVILEGIO_EX.',16,1 )
	END
END
;




CREATE TRIGGER ERPADMIN.PUBLICACION_POS_INS
ON ERPADMIN.PUBLICACION
FOR INSERT
AS
BEGIN
	DECLARE @ERROR INT
	
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @SERVICIO VARCHAR(30)
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @SUBSERVICIO VARCHAR(20)
	DECLARE @ESTADO VARCHAR(1)
	
	DECLARE C_INSERTED CURSOR LOCAL FOR
	SELECT SERVICIO, PUBLICADOR, SUBSERVICIO, ESTADO
	FROM INSERTED i
	WHERE 0 = (
			SELECT COUNT('n')
			FROM DELETED d
			WHERE i.SERVICIO = d.SERVICIO AND i.PUBLICADOR = d.PUBLICADOR AND i.SUBSERVICIO = d.SUBSERVICIO
			 )
	OPEN C_INSERTED	
	FETCH NEXT FROM C_INSERTED INTO
	@SERVICIO, @PUBLICADOR, @SUBSERVICIO, @ESTADO
	SET @ERROR = 0
	WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
	BEGIN
		SET @PARAMETROS =
			'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
			'<PUBLICACION>' +
			'<SERVICIO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@SERVICIO) + '</SERVICIO>' +
			'<PUBLICADOR Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@PUBLICADOR) + '</PUBLICADOR>' +
			'<SUBSERVICIO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@SUBSERVICIO) + '</SUBSERVICIO>' +
			'<ESTADO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ESTADO) + '</ESTADO>' +
			'</PUBLICACION>'
		-- Inserta la solicitud correspondiente
		EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud '*', 'PUBLICACIONPOS600', 'INSERTA', @PARAMETROS, 0, ''
		FETCH NEXT FROM C_INSERTED INTO
		@SERVICIO, @PUBLICADOR, @SUBSERVICIO, @ESTADO
	END
	CLOSE C_INSERTED
	DEALLOCATE C_INSERTED
	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla PUBLICACION.',16,1 )
	END
END
;




CREATE TRIGGER ERPADMIN.PUBLICACION_POS_DEL
ON ERPADMIN.PUBLICACION
FOR DELETE
AS
BEGIN   	
                DECLARE @ERROR  int
	
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @SERVICIO VARCHAR(30)
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @SUBSERVICIO VARCHAR(20)
	 -- Declaraciones	
	DECLARE C_DELETED CURSOR LOCAL FOR
		SELECT SERVICIO, PUBLICADOR, SUBSERVICIO
		FROM DELETED d
		WHERE 0 = (
			SELECT COUNT('n')
			FROM INSERTED i
			WHERE d.SERVICIO = i.SERVICIO AND d.PUBLICADOR = i.PUBLICADOR AND d.SUBSERVICIO = i.SUBSERVICIO
			 )
	OPEN C_DELETED
	FETCH NEXT FROM C_DELETED INTO
	@SERVICIO, @PUBLICADOR, @SUBSERVICIO
	SET @ERROR = 0
	WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
	BEGIN
		SET @PARAMETROS =
							'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
			'<PUBLICACION>' +
			'<SERVICIO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@SERVICIO) + '</SERVICIO>' +
			'<PUBLICADOR Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@PUBLICADOR) + '</PUBLICADOR>' +
			'<SUBSERVICIO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@SUBSERVICIO) + '</SUBSERVICIO>' +
			'</PUBLICACION>'
-- XML
		-- inserta la solicitud correspondiente
		EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud '*', 'PUBLICACIONPOS600', 'ELIMINA', @PARAMETROS, 0, ''
		FETCH NEXT FROM C_DELETED INTO
		@SERVICIO, @PUBLICADOR, @SUBSERVICIO
	END
	CLOSE C_DELETED
	DEALLOCATE C_DELETED
	IF (@@ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para eliminar de la tabla PUBLICACION.',16,1 )
	END
END
;




CREATE TRIGGER ERPADMIN.PUBLICACION_POS_MOD
ON ERPADMIN.PUBLICACION
FOR UPDATE
AS
BEGIN   	
	DECLARE @ERROR  INT
	
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @COL_ROWPOINTER VARCHAR(36)
	DECLARE @HAY_CAMPOS_PARA_POS BIT
	DECLARE @ACTUALIZAR_SOLICITUD BIT
	DECLARE @SERVICIO VARCHAR(30)
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @SUBSERVICIO VARCHAR(20)
	DECLARE @ESTADO VARCHAR(1)
	 -- Declaraciones
	SET @ERROR = 0
	DECLARE C_MODIFIED CURSOR LOCAL FOR
		SELECT SERVICIO, PUBLICADOR, SUBSERVICIO, ESTADO -- Columnas
		FROM INSERTED I
	SET @ACTUALIZAR_SOLICITUD = 1
	OPEN C_MODIFIED
	FETCH NEXT FROM C_MODIFIED
	INTO @SERVICIO, @PUBLICADOR, @SUBSERVICIO, @ESTADO
	WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
	BEGIN
		IF ( NOT UPDATE(RECORDDATE) AND ( UPDATE(SERVICIO) OR UPDATE(PUBLICADOR) OR UPDATE(SUBSERVICIO) OR UPDATE(ESTADO) ) )
		BEGIN
			SELECT @COL_ROWPOINTER = ROWPOINTER
			FROM ERPADMIN.PUBLICACION
			WHERE SERVICIO = @SERVICIO AND PUBLICADOR = @PUBLICADOR AND SUBSERVICIO = @SUBSERVICIO
			SET @PARAMETROS =
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
			'<PUBLICACION>' +
			'<SERVICIO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@SERVICIO) + '</SERVICIO>' +
			'<PUBLICADOR Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@PUBLICADOR) + '</PUBLICADOR>' +
			'<SUBSERVICIO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@SUBSERVICIO) + '</SUBSERVICIO>' +
			'<ESTADO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ESTADO) + '</ESTADO>' +
			'</PUBLICACION>'
			-- inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud '*', 'PUBLICACIONPOS600', 'MODIFICA', @PARAMETROS, @ACTUALIZAR_SOLICITUD, @COL_ROWPOINTER
		END
		FETCH NEXT FROM C_MODIFIED
		INTO @SERVICIO, @PUBLICADOR, @SUBSERVICIO, @ESTADO
	END
	CLOSE C_MODIFIED
	DEALLOCATE C_MODIFIED
	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para modificar la tabla PUBLICACION.',16,1 )
	END
END
;




CREATE TRIGGER ERPADMIN.SERVICIO_POS_INS
ON ERPADMIN.SERVICIO
FOR INSERT
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @SERVICIO VARCHAR(30)
	DECLARE @DESCRIPCION VARCHAR(40)
	DECLARE @REFERENCIA_WS VARCHAR(40)
	DECLARE @ASSEMBLY VARCHAR(250)
	
	DECLARE C_INSERTED CURSOR LOCAL FOR
	SELECT SERVICIO, DESCRIPCION, REFERENCIA_WS, ASSEMBLY
	FROM INSERTED i
	WHERE 0 = (
			SELECT COUNT('n')
			FROM DELETED d
			WHERE i.SERVICIO = d.SERVICIO
			 )
	OPEN C_INSERTED	
	FETCH NEXT FROM C_INSERTED INTO
	@SERVICIO, @DESCRIPCION, @REFERENCIA_WS, @ASSEMBLY
	SET @ERROR = 0
	WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
	BEGIN
		SET @PARAMETROS =
			'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
			'<SERVICIO>' +
			'<SERVICIO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@SERVICIO) + '</SERVICIO>' +
			'<DESCRIPCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DESCRIPCION) + '</DESCRIPCION>' +
			'<REFERENCIA_WS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@REFERENCIA_WS) + '</REFERENCIA_WS>' +
			'<ASSEMBLY Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ASSEMBLY) + '</ASSEMBLY>' +
			'</SERVICIO>'
		-- Inserta la solicitud correspondiente
		EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud '*', 'SERVICIOPOS600', 'INSERTA', @PARAMETROS, 0, ''
		FETCH NEXT FROM C_INSERTED INTO
		@SERVICIO, @DESCRIPCION, @REFERENCIA_WS, @ASSEMBLY
	END
	CLOSE C_INSERTED
	DEALLOCATE C_INSERTED
	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla SERVICIO.',16,1 )
	END
END
;




CREATE TRIGGER ERPADMIN.SERVICIO_POS_DEL
ON ERPADMIN.SERVICIO
FOR DELETE
AS
BEGIN   	
                DECLARE @ERROR  int
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @SERVICIO VARCHAR(30)
	 -- Declaraciones	
	DECLARE C_DELETED CURSOR LOCAL FOR
		SELECT SERVICIO
		FROM DELETED d
		WHERE 0 = (
			SELECT COUNT('n')
			FROM INSERTED i
			WHERE d.SERVICIO = i.SERVICIO
			 )
	OPEN C_DELETED
	FETCH NEXT FROM C_DELETED INTO
	@SERVICIO
	SET @ERROR = 0
	WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
	BEGIN
		SET @PARAMETROS =
							'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
			'<SERVICIO>' +
			'<SERVICIO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@SERVICIO) + '</SERVICIO>' +
			'</SERVICIO>'
-- XML
		-- inserta la solicitud correspondiente
		EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud '*', 'SERVICIOPOS600', 'ELIMINA', @PARAMETROS, 0, ''
		FETCH NEXT FROM C_DELETED INTO
		@SERVICIO
	END
	CLOSE C_DELETED
	DEALLOCATE C_DELETED
	IF (@@ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para eliminar de la tabla SERVICIO.',16,1 )
	END
END
;




CREATE TRIGGER ERPADMIN.SERVICIO_POS_MOD
ON ERPADMIN.SERVICIO
FOR UPDATE
AS
BEGIN   	
	DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @COL_ROWPOINTER VARCHAR(36)
	DECLARE @HAY_CAMPOS_PARA_POS BIT
	DECLARE @ACTUALIZAR_SOLICITUD BIT
	DECLARE @SERVICIO VARCHAR(30)
	DECLARE @DESCRIPCION VARCHAR(40)
	DECLARE @REFERENCIA_WS VARCHAR(40)
	DECLARE @ASSEMBLY VARCHAR(250)
	 -- Declaraciones
	SET @ERROR = 0
	DECLARE C_MODIFIED CURSOR LOCAL FOR
		SELECT SERVICIO, DESCRIPCION, REFERENCIA_WS, ASSEMBLY -- Columnas
		FROM INSERTED I
	SET @ACTUALIZAR_SOLICITUD = 1
	OPEN C_MODIFIED
	FETCH NEXT FROM C_MODIFIED
	INTO @SERVICIO, @DESCRIPCION, @REFERENCIA_WS, @ASSEMBLY
	WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
	BEGIN
		IF ( NOT UPDATE(RECORDDATE) AND ( UPDATE(SERVICIO) OR UPDATE(DESCRIPCION) OR UPDATE(REFERENCIA_WS) OR UPDATE(ASSEMBLY) ) )
		BEGIN
			SELECT @COL_ROWPOINTER = ROWPOINTER
			FROM ERPADMIN.SERVICIO
			WHERE SERVICIO = @SERVICIO
			SET @PARAMETROS =
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
			'<SERVICIO>' +
			'<SERVICIO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@SERVICIO) + '</SERVICIO>' +
			'<DESCRIPCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DESCRIPCION) + '</DESCRIPCION>' +
			'<REFERENCIA_WS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@REFERENCIA_WS) + '</REFERENCIA_WS>' +
			'<ASSEMBLY Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ASSEMBLY) + '</ASSEMBLY>' +
			'</SERVICIO>'
			-- inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud '*', 'SERVICIOPOS600', 'MODIFICA', @PARAMETROS, @ACTUALIZAR_SOLICITUD, @COL_ROWPOINTER
		END
		FETCH NEXT FROM C_MODIFIED
		INTO @SERVICIO, @DESCRIPCION, @REFERENCIA_WS, @ASSEMBLY
	END
	CLOSE C_MODIFIED
	DEALLOCATE C_MODIFIED
	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para modificar la tabla SERVICIO.',16,1 )
	END
END
;




CREATE TRIGGER ERPADMIN.SITIO_POS_INS
ON ERPADMIN.SITIO
FOR INSERT
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @SITIO VARCHAR(20)
	DECLARE @DESCRIPCION VARCHAR(40)
	DECLARE @SERVIDOR VARCHAR(20)
	DECLARE @SERVIDOR_BD VARCHAR(40)
	DECLARE @BASE_DATOS VARCHAR(20)
	DECLARE @SERVIDOR_WS_URL VARCHAR(250)
	DECLARE @CONJUNTO VARCHAR(10)
	DECLARE @ESTADO VARCHAR(1)
	DECLARE @CONFIG_EDNA VARCHAR(20)
	DECLARE @PARAMETROS2 VARCHAR(250)
	
	DECLARE C_INSERTED CURSOR LOCAL FOR
	SELECT SITIO, DESCRIPCION, SERVIDOR, SERVIDOR_BD, BASE_DATOS, SERVIDOR_WS_URL, CONJUNTO, ESTADO, CONFIG_EDNA, PARAMETROS
	FROM INSERTED i
	WHERE 0 = (
			SELECT COUNT('n')
			FROM DELETED d
			WHERE i.SITIO = d.SITIO
			 )
	OPEN C_INSERTED	
	FETCH NEXT FROM C_INSERTED INTO
	@SITIO, @DESCRIPCION, @SERVIDOR, @SERVIDOR_BD, @BASE_DATOS, @SERVIDOR_WS_URL, @CONJUNTO, @ESTADO, @CONFIG_EDNA, @PARAMETROS2
	SET @ERROR = 0
	WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
	BEGIN
		SET @PARAMETROS =
			'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
			'<SITIO>' +
			'<SITIO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@SITIO) + '</SITIO>' +
			'<DESCRIPCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DESCRIPCION) + '</DESCRIPCION>' +
			'<SERVIDOR Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@SERVIDOR) + '</SERVIDOR>' +
			'<SERVIDOR_BD Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@SERVIDOR_BD) + '</SERVIDOR_BD>' +
			'<BASE_DATOS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@BASE_DATOS) + '</BASE_DATOS>' +
			'<SERVIDOR_WS_URL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@SERVIDOR_WS_URL) + '</SERVIDOR_WS_URL>' +
			'<CONJUNTO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CONJUNTO) + '</CONJUNTO>' +
			'<ESTADO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ESTADO) + '</ESTADO>' +
			'<CONFIG_EDNA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CONFIG_EDNA) + '</CONFIG_EDNA>' +
			'<PARAMETROS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@PARAMETROS2) + '</PARAMETROS>' +
			'</SITIO>'
		-- Inserta la solicitud correspondiente
		EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud '*', 'SITIOPOS600', 'INSERTA', @PARAMETROS, 0, ''
		FETCH NEXT FROM C_INSERTED INTO
		@SITIO, @DESCRIPCION, @SERVIDOR, @SERVIDOR_BD, @BASE_DATOS, @SERVIDOR_WS_URL, @CONJUNTO, @ESTADO, @CONFIG_EDNA, @PARAMETROS2
	END
	CLOSE C_INSERTED
	DEALLOCATE C_INSERTED
	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla SITIO.',16,1 )
	END
END
;




CREATE TRIGGER ERPADMIN.SITIO_POS_DEL
ON ERPADMIN.SITIO
FOR DELETE
AS
BEGIN   	
                DECLARE @ERROR  int
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @SITIO VARCHAR(20)
	 -- Declaraciones	
	DECLARE C_DELETED CURSOR LOCAL FOR
		SELECT SITIO
		FROM DELETED d
		WHERE 0 = (
			SELECT COUNT('n')
			FROM INSERTED i
			WHERE d.SITIO = i.SITIO
			 )
	OPEN C_DELETED
	FETCH NEXT FROM C_DELETED INTO
	@SITIO
	SET @ERROR = 0
	WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
	BEGIN
		SET @PARAMETROS =
							'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
			'<SITIO>' +
			'<SITIO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@SITIO) + '</SITIO>' +
			'</SITIO>'
-- XML
		-- inserta la solicitud correspondiente
		EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud '*', 'SITIOPOS600', 'ELIMINA', @PARAMETROS, 0, ''
		FETCH NEXT FROM C_DELETED INTO
		@SITIO
	END
	CLOSE C_DELETED
	DEALLOCATE C_DELETED
	
	IF (@@ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para eliminar de la tabla SITIO.',16,1 )
	END
END
;




CREATE TRIGGER ERPADMIN.SITIO_POS_MOD
ON ERPADMIN.SITIO
FOR UPDATE
AS
BEGIN   	
	DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @COL_ROWPOINTER VARCHAR(36)
	DECLARE @HAY_CAMPOS_PARA_POS BIT
	DECLARE @ACTUALIZAR_SOLICITUD BIT
	DECLARE @SITIO VARCHAR(20)
	DECLARE @DESCRIPCION VARCHAR(40)
	DECLARE @SERVIDOR VARCHAR(20)
	DECLARE @SERVIDOR_BD VARCHAR(40)
	DECLARE @BASE_DATOS VARCHAR(20)
	DECLARE @SERVIDOR_WS_URL VARCHAR(250)
	DECLARE @CONJUNTO VARCHAR(10)
	DECLARE @ESTADO VARCHAR(1)
	DECLARE @CONFIG_EDNA VARCHAR(20)
	DECLARE @PARAMETROS2 VARCHAR(250)
	 -- Declaraciones
	SET @ERROR = 0
	DECLARE C_MODIFIED CURSOR LOCAL FOR
		SELECT SITIO, DESCRIPCION, SERVIDOR, SERVIDOR_BD, BASE_DATOS, SERVIDOR_WS_URL, CONJUNTO, ESTADO, CONFIG_EDNA, PARAMETROS -- Columnas
		FROM INSERTED I
	SET @ACTUALIZAR_SOLICITUD = 1
	OPEN C_MODIFIED
	FETCH NEXT FROM C_MODIFIED
	INTO @SITIO, @DESCRIPCION, @SERVIDOR, @SERVIDOR_BD, @BASE_DATOS, @SERVIDOR_WS_URL, @CONJUNTO, @ESTADO, @CONFIG_EDNA, @PARAMETROS2
	WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
	BEGIN
		IF ( NOT UPDATE(RECORDDATE) AND ( UPDATE(SITIO) OR UPDATE(DESCRIPCION) OR UPDATE(SERVIDOR) OR UPDATE(SERVIDOR_BD) OR UPDATE(BASE_DATOS) OR UPDATE(SERVIDOR_WS_URL) OR UPDATE(CONJUNTO) OR UPDATE(ESTADO) OR UPDATE(CONFIG_EDNA) OR UPDATE(PARAMETROS) ) )
		BEGIN
			SELECT @COL_ROWPOINTER = ROWPOINTER
			FROM ERPADMIN.SITIO
			WHERE SITIO = @SITIO
			SET @PARAMETROS =
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
			'<SITIO>' +
			'<SITIO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@SITIO) + '</SITIO>' +
			'<DESCRIPCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DESCRIPCION) + '</DESCRIPCION>' +
			'<SERVIDOR Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@SERVIDOR) + '</SERVIDOR>' +
			'<SERVIDOR_BD Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@SERVIDOR_BD) + '</SERVIDOR_BD>' +
			'<BASE_DATOS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@BASE_DATOS) + '</BASE_DATOS>' +
			'<SERVIDOR_WS_URL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@SERVIDOR_WS_URL) + '</SERVIDOR_WS_URL>' +
			'<CONJUNTO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CONJUNTO) + '</CONJUNTO>' +
			'<ESTADO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ESTADO) + '</ESTADO>' +
			'<CONFIG_EDNA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CONFIG_EDNA) + '</CONFIG_EDNA>' +
			'<PARAMETROS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@PARAMETROS2) + '</PARAMETROS>' +
			'</SITIO>'
			-- inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud '*', 'SITIOPOS600', 'MODIFICA', @PARAMETROS, @ACTUALIZAR_SOLICITUD, @COL_ROWPOINTER
		END
		FETCH NEXT FROM C_MODIFIED
		INTO @SITIO, @DESCRIPCION, @SERVIDOR, @SERVIDOR_BD, @BASE_DATOS, @SERVIDOR_WS_URL, @CONJUNTO, @ESTADO, @CONFIG_EDNA, @PARAMETROS2
	END
	CLOSE C_MODIFIED
	DEALLOCATE C_MODIFIED
	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para modificar la tabla SITIO.',16,1 )
	END
END
;




CREATE TRIGGER ERPADMIN.SUBSERVICIO_POS_INS
ON ERPADMIN.SUBSERVICIO
FOR INSERT
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @SERVICIO VARCHAR(30)
	DECLARE @SUBSERVICIO VARCHAR(20)
	DECLARE @DESCRIPCION VARCHAR(40)
	DECLARE @ESTADO VARCHAR(1)
	DECLARE @CON_FILTRO VARCHAR(1)
	
	DECLARE C_INSERTED CURSOR LOCAL FOR
	SELECT SERVICIO, SUBSERVICIO, DESCRIPCION, ESTADO, CON_FILTRO
	FROM INSERTED i
	WHERE 0 = (
			SELECT COUNT('n')
			FROM DELETED d
			WHERE i.SERVICIO = d.SERVICIO AND i.SUBSERVICIO = d.SUBSERVICIO
			 )
	OPEN C_INSERTED	
	FETCH NEXT FROM C_INSERTED INTO
	@SERVICIO, @SUBSERVICIO, @DESCRIPCION, @ESTADO,@CON_FILTRO
	SET @ERROR = 0
	WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
	BEGIN
		SET @PARAMETROS =
			'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
			'<SUBSERVICIO>' +
			'<SERVICIO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@SERVICIO) + '</SERVICIO>' +
			'<SUBSERVICIO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@SUBSERVICIO) + '</SUBSERVICIO>' +
			'<DESCRIPCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DESCRIPCION) + '</DESCRIPCION>' +
			'<ESTADO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ESTADO) + '</ESTADO>' +
			'<CON_FILTRO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CON_FILTRO) + '</CON_FILTRO>' +
			'</SUBSERVICIO>'
		-- Inserta la solicitud correspondiente
		EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud '*', 'SUBSERVICIOPOS600', 'INSERTA', @PARAMETROS, 0, ''
		FETCH NEXT FROM C_INSERTED INTO
		@SERVICIO, @SUBSERVICIO, @DESCRIPCION, @ESTADO, @CON_FILTRO
	END
	CLOSE C_INSERTED
	DEALLOCATE C_INSERTED
	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla SUBSERVICIO.',16,1 )
	END
END
;




CREATE TRIGGER ERPADMIN.SUBSERVICIO_POS_DEL
ON ERPADMIN.SUBSERVICIO
FOR DELETE
AS
BEGIN   	
                DECLARE @ERROR  int
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @SERVICIO VARCHAR(30)
	DECLARE @SUBSERVICIO VARCHAR(20)
	 -- Declaraciones	
	DECLARE C_DELETED CURSOR LOCAL FOR
		SELECT SERVICIO, SUBSERVICIO
		FROM DELETED d
		WHERE 0 = (
			SELECT COUNT('n')
			FROM INSERTED i
			WHERE d.SERVICIO = i.SERVICIO AND d.SUBSERVICIO = i.SUBSERVICIO
			 )
	OPEN C_DELETED
	FETCH NEXT FROM C_DELETED INTO
	@SERVICIO, @SUBSERVICIO
	SET @ERROR = 0
	WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
	BEGIN
		SET @PARAMETROS =
							'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
			'<SUBSERVICIO>' +
			'<SERVICIO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@SERVICIO) + '</SERVICIO>' +
			'<SUBSERVICIO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@SUBSERVICIO) + '</SUBSERVICIO>' +
			'</SUBSERVICIO>'
-- XML
		-- inserta la solicitud correspondiente
		EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud '*', 'SUBSERVICIOPOS600', 'ELIMINA', @PARAMETROS, 0, ''
		FETCH NEXT FROM C_DELETED INTO
		@SERVICIO, @SUBSERVICIO
	END
	CLOSE C_DELETED
	DEALLOCATE C_DELETED
	
	IF (@@ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para eliminar de la tabla SUBSERVICIO.',16,1 )
	END
END
;




CREATE TRIGGER ERPADMIN.SUBSERVICIO_POS_MOD
ON ERPADMIN.SUBSERVICIO
FOR UPDATE
AS
BEGIN   	
	DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @COL_ROWPOINTER VARCHAR(36)
	DECLARE @HAY_CAMPOS_PARA_POS BIT
	DECLARE @ACTUALIZAR_SOLICITUD BIT
	DECLARE @SERVICIO VARCHAR(30)
	DECLARE @SUBSERVICIO VARCHAR(20)
	DECLARE @DESCRIPCION VARCHAR(40)
	DECLARE @ESTADO VARCHAR(1)
	DECLARE @CON_FILTRO VARCHAR(1)
	 -- Declaraciones
	SET @ERROR = 0
	DECLARE C_MODIFIED CURSOR LOCAL FOR
		SELECT SERVICIO, SUBSERVICIO, DESCRIPCION, ESTADO, CON_FILTRO -- Columnas
		FROM INSERTED I
	SET @ACTUALIZAR_SOLICITUD = 1
	OPEN C_MODIFIED
	FETCH NEXT FROM C_MODIFIED
	INTO @SERVICIO, @SUBSERVICIO, @DESCRIPCION, @ESTADO, @CON_FILTRO
	WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
	BEGIN
		IF ( NOT UPDATE(RECORDDATE) AND ( UPDATE(SERVICIO) OR UPDATE(SUBSERVICIO) OR UPDATE(DESCRIPCION) OR UPDATE(ESTADO) ) )
		BEGIN
			SELECT @COL_ROWPOINTER = ROWPOINTER
			FROM ERPADMIN.SUBSERVICIO
			WHERE SERVICIO = @SERVICIO AND SUBSERVICIO = @SUBSERVICIO
			SET @PARAMETROS =
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
			'<SUBSERVICIO>' +
			'<SERVICIO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@SERVICIO) + '</SERVICIO>' +
			'<SUBSERVICIO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@SUBSERVICIO) + '</SUBSERVICIO>' +
			'<DESCRIPCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DESCRIPCION) + '</DESCRIPCION>' +
			'<ESTADO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ESTADO) + '</ESTADO>' +
			'<CON_FILTRO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CON_FILTRO) + '</CON_FILTRO>' +
			'</SUBSERVICIO>'
			-- inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud '*', 'SUBSERVICIOPOS600', 'MODIFICA', @PARAMETROS, @ACTUALIZAR_SOLICITUD, @COL_ROWPOINTER
		END
		FETCH NEXT FROM C_MODIFIED
		INTO @SERVICIO, @SUBSERVICIO, @DESCRIPCION, @ESTADO, @CON_FILTRO
	END
	CLOSE C_MODIFIED
	DEALLOCATE C_MODIFIED
	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para modificar la tabla SUBSERVICIO.',16,1 )
	END
END
;




CREATE TRIGGER ERPADMIN.SUSCRIPCION_POS_INS
ON ERPADMIN.SUSCRIPCION
FOR INSERT
AS
BEGIN
	DECLARE @ERROR INT
	
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @SERVICIO VARCHAR(30)
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @SUSCRIPTOR VARCHAR(20)
	DECLARE @SUBSERVICIO VARCHAR(20)
	DECLARE @ESTADO VARCHAR(1)
	DECLARE @ESTADO_GLOBAL VARCHAR(1)
	
	DECLARE C_INSERTED CURSOR LOCAL FOR
	SELECT SERVICIO, PUBLICADOR, SUSCRIPTOR, SUBSERVICIO, ESTADO, ESTADO_GLOBAL
	FROM INSERTED i
	WHERE 0 = (
			SELECT COUNT('n')
			FROM DELETED d
			WHERE i.SERVICIO = d.SERVICIO AND i.PUBLICADOR = d.PUBLICADOR AND i.SUSCRIPTOR = d.SUSCRIPTOR AND i.SUBSERVICIO = d.SUBSERVICIO
			 )
	OPEN C_INSERTED	
	FETCH NEXT FROM C_INSERTED INTO
	@SERVICIO, @PUBLICADOR, @SUSCRIPTOR, @SUBSERVICIO, @ESTADO, @ESTADO_GLOBAL
	SET @ERROR = 0
	WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
	BEGIN
		SET @PARAMETROS =
			'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
			'<SUSCRIPCION>' +
			'<SERVICIO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@SERVICIO) + '</SERVICIO>' +
			'<PUBLICADOR Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@PUBLICADOR) + '</PUBLICADOR>' +
			'<SUSCRIPTOR Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@SUSCRIPTOR) + '</SUSCRIPTOR>' +
			'<SUBSERVICIO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@SUBSERVICIO) + '</SUBSERVICIO>' +
			'<ESTADO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ESTADO) + '</ESTADO>' +
			'<ESTADO_GLOBAL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ESTADO_GLOBAL) + '</ESTADO_GLOBAL>' +
			'</SUSCRIPCION>'
		-- Inserta la solicitud correspondiente
		EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud '*', 'SUSCRIPCIONPOS600', 'INSERTA', @PARAMETROS, 0, ''
		FETCH NEXT FROM C_INSERTED INTO
		@SERVICIO, @PUBLICADOR, @SUSCRIPTOR, @SUBSERVICIO, @ESTADO, @ESTADO_GLOBAL
	END
	CLOSE C_INSERTED
	DEALLOCATE C_INSERTED
	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla SUSCRIPCION.',16,1 )
	END
END
;




CREATE TRIGGER ERPADMIN.SUSCRIPCION_POS_DEL
ON ERPADMIN.SUSCRIPCION
FOR DELETE
AS
BEGIN   	
                DECLARE @ERROR  int
	
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @SERVICIO VARCHAR(30)
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @SUSCRIPTOR VARCHAR(20)
	DECLARE @SUBSERVICIO VARCHAR(20)
	 -- Declaraciones	
	DECLARE C_DELETED CURSOR LOCAL FOR
		SELECT SERVICIO, PUBLICADOR, SUSCRIPTOR, SUBSERVICIO
		FROM DELETED d
		WHERE 0 = (
			SELECT COUNT('n')
			FROM INSERTED i
			WHERE d.SERVICIO = i.SERVICIO AND d.PUBLICADOR = i.PUBLICADOR AND d.SUSCRIPTOR = i.SUSCRIPTOR AND d.SUBSERVICIO = i.SUBSERVICIO
			 )
	OPEN C_DELETED
	FETCH NEXT FROM C_DELETED INTO
	@SERVICIO, @PUBLICADOR, @SUSCRIPTOR, @SUBSERVICIO
	SET @ERROR = 0
	WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
	BEGIN
		SET @PARAMETROS =
							'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
			'<SUSCRIPCION>' +
			'<SERVICIO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@SERVICIO) + '</SERVICIO>' +
			'<PUBLICADOR Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@PUBLICADOR) + '</PUBLICADOR>' +
			'<SUSCRIPTOR Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@SUSCRIPTOR) + '</SUSCRIPTOR>' +
			'<SUBSERVICIO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@SUBSERVICIO) + '</SUBSERVICIO>' +
			'</SUSCRIPCION>'
-- XML
		-- inserta la solicitud correspondiente
		EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud '*', 'SUSCRIPCIONPOS600', 'ELIMINA', @PARAMETROS, 0, ''
		FETCH NEXT FROM C_DELETED INTO
		@SERVICIO, @PUBLICADOR, @SUSCRIPTOR, @SUBSERVICIO
	END
	CLOSE C_DELETED
	DEALLOCATE C_DELETED
	
	IF (@@ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para eliminar de la tabla SUSCRIPCION.',16,1 )
	END
END
;




CREATE TRIGGER ERPADMIN.SUSCRIPCION_POS_MOD
ON ERPADMIN.SUSCRIPCION
FOR UPDATE
AS
BEGIN   	
	DECLARE @ERROR  INT
	
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @COL_ROWPOINTER VARCHAR(36)
	DECLARE @HAY_CAMPOS_PARA_POS BIT
	DECLARE @ACTUALIZAR_SOLICITUD BIT
	DECLARE @SERVICIO VARCHAR(30)
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @SUSCRIPTOR VARCHAR(20)
	DECLARE @SUBSERVICIO VARCHAR(20)
	DECLARE @ESTADO VARCHAR(1)
	DECLARE @ESTADO_GLOBAL VARCHAR(1)
	 -- Declaraciones
	SET @ERROR = 0
	DECLARE C_MODIFIED CURSOR LOCAL FOR
		SELECT SERVICIO, PUBLICADOR, SUSCRIPTOR, SUBSERVICIO, ESTADO, ESTADO_GLOBAL -- Columnas
		FROM INSERTED I
	SET @ACTUALIZAR_SOLICITUD = 1
	OPEN C_MODIFIED
	FETCH NEXT FROM C_MODIFIED
	INTO @SERVICIO, @PUBLICADOR, @SUSCRIPTOR, @SUBSERVICIO, @ESTADO, @ESTADO_GLOBAL
	WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
	BEGIN
		IF ( NOT UPDATE(RECORDDATE) AND ( UPDATE(SERVICIO) OR UPDATE(PUBLICADOR) OR UPDATE(SUSCRIPTOR) OR UPDATE(SUBSERVICIO) OR UPDATE(ESTADO) OR UPDATE(ESTADO_GLOBAL) ) )
		BEGIN
			SELECT @COL_ROWPOINTER = ROWPOINTER
			FROM ERPADMIN.SUSCRIPCION
			WHERE SERVICIO = @SERVICIO AND PUBLICADOR = @PUBLICADOR AND SUSCRIPTOR = @SUSCRIPTOR AND SUBSERVICIO = @SUBSERVICIO
			SET @PARAMETROS =
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
			'<SUSCRIPCION>' +
			'<SERVICIO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@SERVICIO) + '</SERVICIO>' +
			'<PUBLICADOR Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@PUBLICADOR) + '</PUBLICADOR>' +
			'<SUSCRIPTOR Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@SUSCRIPTOR) + '</SUSCRIPTOR>' +
			'<SUBSERVICIO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@SUBSERVICIO) + '</SUBSERVICIO>' +
			'<ESTADO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ESTADO) + '</ESTADO>' +
			'<ESTADO_GLOBAL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ESTADO_GLOBAL) + '</ESTADO_GLOBAL>' +
			'</SUSCRIPCION>'
			-- inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud '*', 'SUSCRIPCIONPOS600', 'MODIFICA', @PARAMETROS, @ACTUALIZAR_SOLICITUD, @COL_ROWPOINTER
		END
		FETCH NEXT FROM C_MODIFIED
		INTO @SERVICIO, @PUBLICADOR, @SUSCRIPTOR, @SUBSERVICIO, @ESTADO, @ESTADO_GLOBAL
	END
	CLOSE C_MODIFIED
	DEALLOCATE C_MODIFIED
	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para modificar la tabla SUSCRIPCION.',16,1 )
	END
END
;




CREATE TRIGGER ERPADMIN.USUARIO_POS_INS
ON ERPADMIN.USUARIO
FOR INSERT
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @USUARIO VARCHAR(25)
	DECLARE @NOMBRE VARCHAR(100)
	DECLARE @TIPO VARCHAR(1)
	DECLARE @ACTIVO VARCHAR(1)
	DECLARE @REQ_CAMBIO_CLAVE VARCHAR(1)
	DECLARE @FRECUENCIA_CLAVE INT
	DECLARE @FECHA_ULT_CLAVE DATETIME
	DECLARE @MAX_INTENTOS_CONEX INT
	DECLARE @CLAVE VARCHAR(68)
	
	DECLARE C_INSERTED CURSOR LOCAL FOR
	SELECT USUARIO, NOMBRE, TIPO, ACTIVO, REQ_CAMBIO_CLAVE, FRECUENCIA_CLAVE, FECHA_ULT_CLAVE, MAX_INTENTOS_CONEX, CLAVE
	FROM INSERTED i
	WHERE 0 = (
			SELECT COUNT('n')
			FROM DELETED d
			WHERE i.USUARIO = d.USUARIO
			 )
	OPEN C_INSERTED	
	FETCH NEXT FROM C_INSERTED INTO
	@USUARIO, @NOMBRE, @TIPO, @ACTIVO, @REQ_CAMBIO_CLAVE, @FRECUENCIA_CLAVE, @FECHA_ULT_CLAVE, @MAX_INTENTOS_CONEX, @CLAVE
	SET @ERROR = 0
	WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
	BEGIN
		SET @PARAMETROS =
			'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
			'<USUARIO>' +
			'<USUARIO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@USUARIO) + '</USUARIO>' +
			'<NOMBRE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOMBRE) + '</NOMBRE>' +
			'<TIPO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO) + '</TIPO>' +
			'<ACTIVO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ACTIVO) + '</ACTIVO>' +
			'<REQ_CAMBIO_CLAVE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@REQ_CAMBIO_CLAVE) + '</REQ_CAMBIO_CLAVE>' +
			'<FRECUENCIA_CLAVE Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@FRECUENCIA_CLAVE) + '</FRECUENCIA_CLAVE>' +
			'<FECHA_ULT_CLAVE Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_ULT_CLAVE) + '</FECHA_ULT_CLAVE>' +
			'<MAX_INTENTOS_CONEX Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@MAX_INTENTOS_CONEX) + '</MAX_INTENTOS_CONEX>' +
			'<CLAVE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CLAVE) + '</CLAVE>' +
			'</USUARIO>'
		-- Inserta la solicitud correspondiente
		EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud '*', 'USUARIOPOS600', 'INSERTA', @PARAMETROS, 0, ''
		FETCH NEXT FROM C_INSERTED INTO
		@USUARIO, @NOMBRE, @TIPO, @ACTIVO, @REQ_CAMBIO_CLAVE, @FRECUENCIA_CLAVE, @FECHA_ULT_CLAVE, @MAX_INTENTOS_CONEX, @CLAVE
	END
	CLOSE C_INSERTED
	DEALLOCATE C_INSERTED
	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla USUARIO.',16,1 )
	END
END
;




CREATE TRIGGER ERPADMIN.USUARIO_POS_DEL
ON ERPADMIN.USUARIO
FOR DELETE
AS
BEGIN   	
                DECLARE @ERROR  int
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @USUARIO VARCHAR(25)
	 -- Declaraciones	
	DECLARE C_DELETED CURSOR LOCAL FOR
		SELECT USUARIO
		FROM DELETED d
		WHERE 0 = (
			SELECT COUNT('n')
			FROM INSERTED i
			WHERE d.USUARIO = i.USUARIO
			 )
	OPEN C_DELETED
	FETCH NEXT FROM C_DELETED INTO
	@USUARIO
	SET @ERROR = 0
	WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
	BEGIN
		SET @PARAMETROS =
							'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
			'<USUARIO>' +
			'<USUARIO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@USUARIO) + '</USUARIO>' +
			'</USUARIO>'
-- XML
		-- inserta la solicitud correspondiente
		EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud '*', 'USUARIOPOS600', 'ELIMINA', @PARAMETROS, 0, ''
		FETCH NEXT FROM C_DELETED INTO
		@USUARIO
	END
	CLOSE C_DELETED
	DEALLOCATE C_DELETED
	
	IF (@@ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para eliminar de la tabla USUARIO.',16,1 )
	END
END
;




CREATE TRIGGER ERPADMIN.USUARIO_POS_MOD
ON ERPADMIN.USUARIO
FOR UPDATE
AS
BEGIN   	
	DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @COL_ROWPOINTER VARCHAR(36)
	DECLARE @HAY_CAMPOS_PARA_POS BIT
	DECLARE @ACTUALIZAR_SOLICITUD BIT
	DECLARE @USUARIO VARCHAR(25)
	DECLARE @NOMBRE VARCHAR(100)
	DECLARE @TIPO VARCHAR(1)
	DECLARE @ACTIVO VARCHAR(1)
	DECLARE @REQ_CAMBIO_CLAVE VARCHAR(1)
	DECLARE @FRECUENCIA_CLAVE INT
	DECLARE @FECHA_ULT_CLAVE DATETIME
	DECLARE @MAX_INTENTOS_CONEX INT
	DECLARE @CLAVE VARCHAR(68)
	 -- Declaraciones
	SET @ERROR = 0
	DECLARE C_MODIFIED CURSOR LOCAL FOR
		SELECT USUARIO, NOMBRE, TIPO, ACTIVO, REQ_CAMBIO_CLAVE, FRECUENCIA_CLAVE, FECHA_ULT_CLAVE, MAX_INTENTOS_CONEX, CLAVE -- Columnas
		FROM INSERTED I
	SET @ACTUALIZAR_SOLICITUD = 1
	OPEN C_MODIFIED
	FETCH NEXT FROM C_MODIFIED
	INTO @USUARIO, @NOMBRE, @TIPO, @ACTIVO, @REQ_CAMBIO_CLAVE, @FRECUENCIA_CLAVE, @FECHA_ULT_CLAVE, @MAX_INTENTOS_CONEX, @CLAVE
	WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
	BEGIN
		IF ( NOT UPDATE(RECORDDATE) AND ( UPDATE(USUARIO) OR UPDATE(NOMBRE) OR UPDATE(TIPO) OR UPDATE(ACTIVO) OR UPDATE(REQ_CAMBIO_CLAVE) OR UPDATE(FRECUENCIA_CLAVE) OR UPDATE(FECHA_ULT_CLAVE) OR UPDATE(MAX_INTENTOS_CONEX) OR UPDATE(CLAVE) ) )
		BEGIN
			SELECT @COL_ROWPOINTER = ROWPOINTER
			FROM ERPADMIN.USUARIO
			WHERE USUARIO = @USUARIO
			SET @PARAMETROS =
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
			'<USUARIO>' +
			'<USUARIO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@USUARIO) + '</USUARIO>' +
			'<NOMBRE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOMBRE) + '</NOMBRE>' +
			'<TIPO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO) + '</TIPO>' +
			'<ACTIVO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ACTIVO) + '</ACTIVO>' +
			'<REQ_CAMBIO_CLAVE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@REQ_CAMBIO_CLAVE) + '</REQ_CAMBIO_CLAVE>' +
			'<FRECUENCIA_CLAVE Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@FRECUENCIA_CLAVE) + '</FRECUENCIA_CLAVE>' +
			'<FECHA_ULT_CLAVE Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_ULT_CLAVE) + '</FECHA_ULT_CLAVE>' +
			'<MAX_INTENTOS_CONEX Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@MAX_INTENTOS_CONEX) + '</MAX_INTENTOS_CONEX>' +
			'<CLAVE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CLAVE) + '</CLAVE>' +
			'</USUARIO>'
			-- inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud '*', 'USUARIOPOS600', 'MODIFICA', @PARAMETROS, @ACTUALIZAR_SOLICITUD, @COL_ROWPOINTER
		END
		FETCH NEXT FROM C_MODIFIED
		INTO @USUARIO, @NOMBRE, @TIPO, @ACTIVO, @REQ_CAMBIO_CLAVE, @FRECUENCIA_CLAVE, @FECHA_ULT_CLAVE, @MAX_INTENTOS_CONEX, @CLAVE
	END
	CLOSE C_MODIFIED
	DEALLOCATE C_MODIFIED
	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para modificar la tabla USUARIO.',16,1 )
	END
END
;



CREATE FUNCTION $$Compania$$.MANEJA_EXISTENCIAS
(
	@ARTICULO VARCHAR(20)
)
RETURNS BIT
AS
BEGIN
	DECLARE @Tipo VARCHAR(1)
	DECLARE @ValidaExistencia BIT
	SET @ValidaExistencia = 1	
	DECLARE ARTICULOS CURSOR FOR
		SELECT TIPO
		FROM $$Compania$$.ARTICULO
		WHERE ARTICULO = @ARTICULO
	OPEN ARTICULOS
	FETCH NEXT FROM ARTICULOS INTO @Tipo
	IF  @@FETCH_STATUS = 0
	BEGIN
		IF (	@Tipo = 'P'
			OR @Tipo = 'L'
			OR @Tipo = 'V'
			OR @Tipo = 'F'
			OR @Tipo = 'S'
			OR @Tipo = 'O'
			OR @Tipo = 'K'
		)
		BEGIN
			SET @ValidaExistencia = 0
		END
	END
	CLOSE ARTICULOS
	DEALLOCATE ARTICULOS
	RETURN @ValidaExistencia
END
;





CREATE FUNCTION $$Compania$$.SINCTRANSACINVPOS
(
	@psTipo			VARCHAR(1),
	@psSubtipo		VARCHAR(1)
)
RETURNS BIT
AS
BEGIN
	DECLARE @ValidaSinc BIT
	SET @ValidaSinc = 0
	IF	@psTipo IN ('A', 'R')
	BEGIN
		SET @ValidaSinc = 1
	END
	ELSE IF @psTipo  IN ('C', 'I', 'M', 'N', 'T', 'V')  AND @psSubtipo IN ('D', 'R')
	BEGIN
		SET @ValidaSinc = 1
	END
	ELSE IF	@psTipo IN ('F', 'O', 'P')  AND @psSubtipo IN ('D')
	BEGIN
		SET @ValidaSinc = 1
	END
	RETURN @ValidaSinc
END
;





CREATE PROCEDURE $$Compania$$.APLICAINVENTARIOPOS_BODEGA
(
	@psTipo			VARCHAR(1),
	@psArticulo		VARCHAR(20),
	@psBodega		VARCHAR(4),
	@psSubtipo		VARCHAR(1),
	@pnCantidad		DECIMAL(28,8),
	@pnCantDisp 	DECIMAL(28,8) OUTPUT,
    @pnCantRes 		DECIMAL(28,8) OUTPUT
)
AS
BEGIN

DECLARE @CantRows DECIMAL(28,8)

	SELECT @CantRows = COUNT(0)
		FROM $$Compania$$.EXISTENCIA_BODEGA
		WHERE ARTICULO = @psArticulo AND BODEGA = @psBodega
		
		IF @CantRows = 0
		BEGIN
			INSERT INTO $$Compania$$.EXISTENCIA_BODEGA (
				ARTICULO, BODEGA, EXISTENCIA_MINIMA, EXISTENCIA_MAXIMA, PUNTO_DE_REORDEN,
				CANT_DISPONIBLE, CANT_RESERVADA, CANT_NO_APROBADA, CANT_VENCIDA,
				CANT_TRANSITO, CANT_PRODUCCION, CANT_PEDIDA, CANT_REMITIDA, CONGELADO,
				FECHA_CONG, BLOQUEA_TRANS, FECHA_DESCONG
			)
			VALUES
			(
				@psArticulo, @psBodega, 0, 0, 0,
				0, 0, 0, 0,
				0, 0, 0, 0, 'N',
				NULL, 'N', NULL
			)		
		END

		IF	@psTipo = 'A'
		BEGIN
			UPDATE	$$Compania$$.EXISTENCIA_BODEGA
			SET	CANT_DISPONIBLE = CANT_DISPONIBLE + @pnCantidad
			WHERE	ARTICULO = @psArticulo AND BODEGA = @psBodega

			SET @pnCantDisp = @pnCantidad
			SET @pnCantRes = 0

		END
		ELSE IF	@psTipo IN ('C', 'I', 'N', 'V')
		BEGIN
			IF	@psSubtipo = 'D'
			BEGIN
				UPDATE	$$Compania$$.EXISTENCIA_BODEGA
				SET	CANT_DISPONIBLE = CANT_DISPONIBLE - @pnCantidad
				WHERE	ARTICULO = @psArticulo AND BODEGA = @psBodega

				SET @pnCantDisp = - @pnCantidad
				SET @pnCantRes = 0

			END
			ELSE IF	@psSubtipo = 'R'
			BEGIN
				UPDATE	$$Compania$$.EXISTENCIA_BODEGA
				SET	CANT_RESERVADA = CANT_RESERVADA - @pnCantidad
				WHERE	ARTICULO = @psArticulo AND BODEGA = @psBodega

				SET @pnCantDisp = 0
				SET @pnCantRes = -@pnCantidad
			END
		END
		ELSE IF	@psTipo IN ('M', 'T')
		BEGIN
			IF	@psSubtipo = 'D'
			BEGIN
				UPDATE	$$Compania$$.EXISTENCIA_BODEGA
				SET	CANT_DISPONIBLE = CANT_DISPONIBLE + @pnCantidad
				WHERE	ARTICULO = @psArticulo AND BODEGA = @psBodega

				SET @pnCantDisp = @pnCantidad
				SET @pnCantRes = 0
			END
			ELSE IF @psSubtipo = 'R'
			BEGIN
				UPDATE	$$Compania$$.EXISTENCIA_BODEGA
				SET	CANT_RESERVADA = CANT_RESERVADA + @pnCantidad
				WHERE	ARTICULO = @psArticulo AND BODEGA = @psBodega

				SET @pnCantDisp = 0
				SET @pnCantRes = @pnCantidad
			END
		END
		ELSE IF @psTipo IN ('F', 'O', 'P')
		BEGIN
			IF	@psSubtipo = 'D'
			BEGIN
				UPDATE	$$Compania$$.EXISTENCIA_BODEGA
				SET	CANT_DISPONIBLE = CANT_DISPONIBLE + @pnCantidad
				WHERE	ARTICULO = @psArticulo AND BODEGA = @psBodega

				SET @pnCantDisp = @pnCantidad
				SET @pnCantRes = 0
			END
		END
		ELSE IF	@psTipo  IN('R')
		BEGIN
			UPDATE	$$Compania$$.EXISTENCIA_BODEGA
			SET	CANT_DISPONIBLE = CANT_DISPONIBLE - @pnCantidad,
				CANT_RESERVADA = CANT_RESERVADA + @pnCantidad
			WHERE	ARTICULO = @psArticulo AND BODEGA = @psBodega

			SET @pnCantDisp = -@pnCantidad
			SET @pnCantRes = @pnCantidad
		END
END
;


CREATE PROCEDURE $$Compania$$.APLICAINVENTARIOPOS_LOTE
(
	@psTipo				VARCHAR(1),
	@psArticulo			VARCHAR(20),
	@psBodega			VARCHAR(4),
	@psSubtipo			VARCHAR(1),
	@pnCantidad			DECIMAL(28,8),
	@pnCantDisp 		DECIMAL(28,8),
    @pnCantRes 			DECIMAL(28,8),
	@psLocalizacion		VARCHAR(8),
	@psLote				VARCHAR(15)
)
AS
BEGIN

DECLARE @CantRows DECIMAL(28,8)

	IF @psLocalizacion IS NULL
		SET @psLocalizacion = 'ND'
		
		
	SELECT @CantRows = COUNT(0)
		FROM $$Compania$$.EXISTENCIA_LOTE
		WHERE ARTICULO = @psArticulo AND BODEGA = @psBodega AND LOCALIZACION = @psLocalizacion AND LOTE = @psLote
		
		IF @CantRows = 0
		BEGIN
			INSERT INTO $$Compania$$.EXISTENCIA_LOTE (
				BODEGA, ARTICULO, LOCALIZACION, LOTE, CANT_DISPONIBLE, CANT_RESERVADA, 
				CANT_NO_APROBADA, CANT_VENCIDA, CANT_REMITIDA
			)
			VALUES
			(
				@psBodega, @psArticulo, @psLocalizacion, @psLote, 0, 0, 
				0, 0, 0
			)		
		END

		IF	@psTipo = 'A'
		BEGIN
			UPDATE	$$Compania$$.EXISTENCIA_LOTE
			SET	CANT_DISPONIBLE = CANT_DISPONIBLE + @pnCantidad
			WHERE	ARTICULO = @psArticulo AND BODEGA = @psBodega AND LOCALIZACION = @psLocalizacion AND LOTE = @psLote

			SET @pnCantDisp = @pnCantidad
			SET @pnCantRes = 0

		END
		ELSE IF	@psTipo IN ('C', 'I', 'N', 'V')
		BEGIN
			IF	@psSubtipo = 'D'
			BEGIN
				UPDATE	$$Compania$$.EXISTENCIA_LOTE
				SET	CANT_DISPONIBLE = CANT_DISPONIBLE - @pnCantidad
				WHERE	ARTICULO = @psArticulo AND BODEGA = @psBodega AND LOCALIZACION = @psLocalizacion AND LOTE = @psLote

				SET @pnCantDisp = - @pnCantidad
				SET @pnCantRes = 0

			END
			ELSE IF	@psSubtipo = 'R'
			BEGIN
				UPDATE	$$Compania$$.EXISTENCIA_LOTE
				SET	CANT_RESERVADA = CANT_RESERVADA - @pnCantidad
				WHERE	ARTICULO = @psArticulo AND BODEGA = @psBodega AND LOCALIZACION = @psLocalizacion AND LOTE = @psLote

				SET @pnCantDisp = 0
				SET @pnCantRes = -@pnCantidad
			END
		END
		ELSE IF	@psTipo IN ('M', 'T')
		BEGIN
			IF	@psSubtipo = 'D'
			BEGIN
				UPDATE	$$Compania$$.EXISTENCIA_LOTE
				SET	CANT_DISPONIBLE = CANT_DISPONIBLE + @pnCantidad
				WHERE	ARTICULO = @psArticulo AND BODEGA = @psBodega AND LOCALIZACION = @psLocalizacion AND LOTE = @psLote

				SET @pnCantDisp = @pnCantidad
				SET @pnCantRes = 0
			END
			ELSE IF @psSubtipo = 'R'
			BEGIN
				UPDATE	$$Compania$$.EXISTENCIA_LOTE
				SET	CANT_RESERVADA = CANT_RESERVADA + @pnCantidad
				WHERE	ARTICULO = @psArticulo AND BODEGA = @psBodega AND LOCALIZACION = @psLocalizacion AND LOTE = @psLote

				SET @pnCantDisp = 0
				SET @pnCantRes = @pnCantidad
			END
		END
		ELSE IF @psTipo IN ('F', 'O', 'P')
		BEGIN
			IF	@psSubtipo = 'D'
			BEGIN
				UPDATE	$$Compania$$.EXISTENCIA_LOTE
				SET	CANT_DISPONIBLE = CANT_DISPONIBLE + @pnCantidad
				WHERE	ARTICULO = @psArticulo AND BODEGA = @psBodega AND LOCALIZACION = @psLocalizacion AND LOTE = @psLote

				SET @pnCantDisp = @pnCantidad
				SET @pnCantRes = 0
			END
		END
		ELSE IF	@psTipo  IN('R')
		BEGIN
			UPDATE	$$Compania$$.EXISTENCIA_LOTE
			SET	CANT_DISPONIBLE = CANT_DISPONIBLE - @pnCantidad,
				CANT_RESERVADA = CANT_RESERVADA + @pnCantidad
			WHERE	ARTICULO = @psArticulo AND BODEGA = @psBodega AND LOCALIZACION = @psLocalizacion AND LOTE = @psLote

			SET @pnCantDisp = -@pnCantidad
			SET @pnCantRes = @pnCantidad
		END
END
;





CREATE PROCEDURE $$Compania$$.APLICAINVENTARIOPOS 
(
	@psTipo				VARCHAR(1),
	@psArticulo			VARCHAR(20),
	@psBodega			VARCHAR(4),
	@psSubtipo			VARCHAR(1),
	@pnCantidad			DECIMAL(28,8),
	@psObservaciones	VARCHAR(100),
	@psLocalizacion		VARCHAR(8),
	@psLote				VARCHAR(15)
)
AS
BEGIN

DECLARE @CantDisp DECIMAL(28,8)
DECLARE @CantRes DECIMAL(28,8)
DECLARE @CantRowsConj DECIMAL(28,8)
DECLARE @CantRowsArt DECIMAL(28,8)

	IF	$$Compania$$.MANEJA_EXISTENCIAS(@psArticulo) = 1
	BEGIN
		
		EXEC $$Compania$$.APLICAINVENTARIOPOS_BODEGA @psTipo,@psArticulo,@psBodega,@psSubtipo,@pnCantidad,@CantDisp output,@CantRes output
		
		INSERT INTO $$Compania$$.AUDIT_EXISTENCIA (
			CAJA, DOCUMENTO, TIPO, LINEA, BODEGA, ARTICULO,
			CANT_DISPONIBLE, CANT_RESERVADA, TEXTO
		)
		VALUES
		(
			'MOV', 'TRANSACCION_INV', 'I', null, @psBodega, @psArticulo,
			@CantDisp, @CantRes, @psObservaciones
		)

		SELECT @CantRowsConj = COUNT(0)
			FROM ERPADMIN.CONJUNTO
			WHERE CONJUNTO = '$$Compania$$' AND USA_LOTES = 'S'
			
		SELECT @CantRowsArt = COUNT(0)
			FROM $$Compania$$.ARTICULO
			WHERE ARTICULO = @psArticulo AND USA_LOTES = 'S'
		
		IF @CantRowsConj = 1 AND @CantRowsArt = 1
		BEGIN
			EXEC $$Compania$$.APLICAINVENTARIOPOS_LOTE @psTipo,@psArticulo,@psBodega,@psSubtipo,@pnCantidad,@CantDisp,@CantRes,@psLocalizacion,@psLote
		END
				
	END
END
;


CREATE TRIGGER $$Compania$$.TRASPASO_POS_POS_MOD
ON $$Compania$$.TRASPASO_POS
FOR UPDATE
AS
BEGIN   	
	DECLARE @ERROR INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @TIPO_SITIO_LOCAL VARCHAR(1)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @CONSECUTIVO_CI VARCHAR(10)
	DECLARE @DOCUMENTO VARCHAR(20)
	DECLARE @FECHA DATETIME
	DECLARE @BODEGA_ORIGEN VARCHAR(4)
	DECLARE @BODEGA_DESTINO VARCHAR(4)
	DECLARE @ESTADO VARCHAR(1)
	DECLARE @EXPORTADO VARCHAR(1)
	DECLARE @LINEA INT
	DECLARE @EXPORTADO_TIENDA VARCHAR(1)
	DECLARE @LOCAL VARCHAR(1)
	DECLARE @OBSERVACIONES VARCHAR(254)
	DECLARE @TPPD_CONSECUTIVO_CI VARCHAR(10)
	DECLARE @TPPD_DOCUMENTO VARCHAR(20)
	DECLARE @TPPD_ARTICULO VARCHAR(20)
	DECLARE @TPPD_CANTIDAD DECIMAL(28,8)
	DECLARE @TPPD_LOTE VARCHAR(15)
	DECLARE @TPPD_LINEA INT
	DECLARE @PAQUETE_INV VARCHAR(4)
	SET @ERROR = 0
	SELECT @PUBLICADOR = SITIO_LOCAL, @USUARIO_POS_WSQM = USUARIO_WSQM, @TIPO_SITIO_LOCAL = TIPO_SITIO_LOCAL
	FROM $$Compania$$.GLOBALES_POS
	-- Aqu se hace la validacin del usuario de conexin para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM) AND @TIPO_SITIO_LOCAL = 'T'
	BEGIN
		DECLARE C_MODIFIED CURSOR LOCAL FOR
			SELECT CONSECUTIVO_CI, DOCUMENTO, FECHA, BODEGA_ORIGEN, BODEGA_DESTINO, ESTADO, EXPORTADO, EXPORTADO_TIENDA, LOCAL, OBSERVACIONES -- Columnas
			FROM INSERTED I
		OPEN C_MODIFIED
		FETCH NEXT FROM C_MODIFIED
		INTO @CONSECUTIVO_CI, @DOCUMENTO, @FECHA, @BODEGA_ORIGEN, @BODEGA_DESTINO, @ESTADO, @EXPORTADO, @EXPORTADO_TIENDA, @LOCAL, @OBSERVACIONES
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			IF ( NOT UPDATE(RECORDDATE) AND UPDATE (ESTADO) AND @ESTADO = 'A' )
			BEGIN
				SET @PARAMETROS =
					'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
					'<TRASPASO_POS>' +
					'<CONSECUTIVO_CI Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CONSECUTIVO_CI) + '</CONSECUTIVO_CI>' +
					'<DOCUMENTO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@DOCUMENTO) + '</DOCUMENTO>' +
					'<FECHA Type="DATETIME">' + ERPADMIN.POS_FormatoFecha(@FECHA) + '</FECHA>' +
					'<BODEGA_ORIGEN Type="VARCHAR">' + ERPADMIN.POS_ReemplazarCaracter(@BODEGA_ORIGEN) + '</BODEGA_ORIGEN>' +
					'<BODEGA_DESTINO Type="VARCHAR">' + ERPADMIN.POS_ReemplazarCaracter(@BODEGA_DESTINO) + '</BODEGA_DESTINO>' +
					'<ESTADO Type="VARCHAR">' + ERPADMIN.POS_ReemplazarCaracter(@ESTADO) + '</ESTADO>' +
					'<EXPORTADO Type="VARCHAR">' + ERPADMIN.POS_ReemplazarCaracter(@EXPORTADO) + '</EXPORTADO>' +
					'<EXPORTADO_TIENDA Type="VARCHAR">' + ERPADMIN.POS_ReemplazarCaracter(@EXPORTADO_TIENDA) + '</EXPORTADO_TIENDA>' +
					'<LOCAL Type="VARCHAR">' + ERPADMIN.POS_ReemplazarCaracter(@LOCAL) + '</LOCAL>' +
					'<OBSERVACIONES Type="VARCHAR">' + ERPADMIN.POS_ReemplazarCaracter(@OBSERVACIONES) + '</OBSERVACIONES>' +
					'<PAQUETE_INV Type="VARCHAR">' + ERPADMIN.POS_ReemplazarCaracter(@PAQUETE_INV) + '</PAQUETE_INV>' +
					'</TRASPASO_POS>'

				-- inserta la solicitud correspondiente
				EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'TRASPASOPOSPOS600', 'INSERTA', @PARAMETROS, 0, ''	
				DECLARE DETALLE_TRASPASO CURSOR LOCAL FOR
					SELECT  CONSECUTIVO_CI, DOCUMENTO, ARTICULO, CANTIDAD, LOTE, LINEA
					FROM $$Compania$$.TRASPASO_POS_DET
					WHERE CONSECUTIVO_CI = @CONSECUTIVO_CI AND DOCUMENTO = @DOCUMENTO AND LINEA = @LINEA
							
				OPEN DETALLE_TRASPASO
				
				FETCH NEXT FROM DETALLE_TRASPASO
				INTO @TPPD_CONSECUTIVO_CI, @TPPD_DOCUMENTO, @TPPD_ARTICULO, @TPPD_CANTIDAD, @TPPD_LOTE, @TPPD_LINEA
							
				WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
				BEGIN
					SET @PARAMETROS =
							'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
							'<TRASPASO_POS_DET>' +
							'<CONSECUTIVO_CI Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@TPPD_CONSECUTIVO_CI) + '</CONSECUTIVO_CI>'+
							'<DOCUMENTO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@TPPD_DOCUMENTO) + '</DOCUMENTO>'+
							'<ARTICULO Type="VARCHAR">' + ERPADMIN.POS_ReemplazarCaracter(@TPPD_ARTICULO) + '</ARTICULO>'+
							'<CANTIDAD Type="DECIMAL">' + ERPADMIN.POS_NumberToVarchar(@TPPD_CANTIDAD) + '</CANTIDAD>'+
							'<LOTE Type="VARCHAR">' + ERPADMIN.POS_ReemplazarCaracter(@TPPD_LOTE) + '</LOTE>' +
							'<LINEA Type="INT" PrimaryKey="True">' + ERPADMIN.POS_NumberToVarchar(@TPPD_LINEA) + '</LINEA>' +
							'</TRASPASO_POS_DET>'
					
					-- inserta la solicitud correspondiente
					EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'TRASPASOPOSDETPOS600', 'INSERTA', @PARAMETROS, 0, ''
					
					FETCH NEXT FROM DETALLE_TRASPASO
					INTO @TPPD_CONSECUTIVO_CI, @TPPD_DOCUMENTO, @TPPD_ARTICULO, @TPPD_CANTIDAD, @TPPD_LOTE, @TPPD_LINEA
				END
								
				CLOSE DETALLE_TRASPASO
				DEALLOCATE DETALLE_TRASPASO
			END
			FETCH NEXT FROM C_MODIFIED
			INTO @CONSECUTIVO_CI, @DOCUMENTO, @FECHA, @BODEGA_ORIGEN, @BODEGA_DESTINO, @ESTADO, @EXPORTADO, @EXPORTADO_TIENDA, @LOCAL, @OBSERVACIONES
		END
		CLOSE C_MODIFIED
		DEALLOCATE C_MODIFIED
	END
	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para modificar la tabla TRASPASO_POS.',16,1 )
	END
END
;







CREATE TRIGGER $$Compania$$.AUDIT_TRANS_INV_POS_INS
ON $$Compania$$.AUDIT_TRANS_INV
FOR INSERT
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @TIPO_SITIO_LOCAL VARCHAR(1)
	DECLARE @AUDIT_TRANS_INV INT
	DECLARE @CONSECUTIVO VARCHAR(10)
	DECLARE @USUARIO VARCHAR(25)
	DECLARE @FECHA_HORA DATETIME
	DECLARE @MODULO_ORIGEN VARCHAR(4)
	DECLARE @APLICACION VARCHAR(249)
	DECLARE @REFERENCIA VARCHAR(200)
	DECLARE @ASIENTO VARCHAR(10)
	DECLARE @USUARIO_APRO VARCHAR(25)
	DECLARE @FECHA_HORA_APROB DATETIME

	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM,
	       @TIPO_SITIO_LOCAL = TIPO_SITIO_LOCAL
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (SYSTEM_USER = @USUARIO_POS_WSQM) AND @TIPO_SITIO_LOCAL = 'C' 
	BEGIN
				
		DECLARE C_INSERTED CURSOR LOCAL FOR
		SELECT AUDIT_TRANS_INV, CONSECUTIVO, USUARIO, FECHA_HORA, MODULO_ORIGEN, APLICACION, REFERENCIA, ASIENTO, USUARIO_APRO, FECHA_HORA_APROB
		FROM INSERTED i
			
		OPEN C_INSERTED	
		FETCH NEXT FROM C_INSERTED INTO
		@AUDIT_TRANS_INV, @CONSECUTIVO, @USUARIO, @FECHA_HORA, @MODULO_ORIGEN, @APLICACION, @REFERENCIA, @ASIENTO, @USUARIO_APRO, @FECHA_HORA_APROB

		SET @ERROR = 0
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS = 
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<AUDIT_TRANS_INV>' + 
				'<AUDIT_TRANS_INV Type="INT" PrimaryKey="True">' + ERPADMIN.POS_NumberToVarchar(@AUDIT_TRANS_INV) + '</AUDIT_TRANS_INV>' + 
				'<CONSECUTIVO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CONSECUTIVO) + '</CONSECUTIVO>' + 
				'<USUARIO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USUARIO) + '</USUARIO>' + 
				'<FECHA_HORA Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_HORA) + '</FECHA_HORA>' + 
				'<MODULO_ORIGEN Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@MODULO_ORIGEN) + '</MODULO_ORIGEN>' + 
				'<APLICACION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@APLICACION) + '</APLICACION>' + 
				'<REFERENCIA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@REFERENCIA) + '</REFERENCIA>' + 
				'<ASIENTO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ASIENTO) + '</ASIENTO>' + 
				'<USUARIO_APRO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USUARIO_APRO) + '</USUARIO_APRO>' + 
				'<FECHA_HORA_APROB Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_HORA_APROB) + '</FECHA_HORA_APROB>' + 
				'</AUDIT_TRANS_INV>'


			-- Inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'AUDITTRANSINVPOS600', 'INSERTA', @PARAMETROS, 0, ''

			FETCH NEXT FROM C_INSERTED INTO
			@AUDIT_TRANS_INV, @CONSECUTIVO, @USUARIO, @FECHA_HORA, @MODULO_ORIGEN, @APLICACION, @REFERENCIA, @ASIENTO, @USUARIO_APRO, @FECHA_HORA_APROB
		END

		CLOSE C_INSERTED
    		DEALLOCATE C_INSERTED
	END

	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla AUDIT_TRANS_INV.',16,1 )
	END
END;



CREATE TRIGGER $$Compania$$.AUDIT_TRANS_INV_POS_DEL
ON $$Compania$$.AUDIT_TRANS_INV
FOR DELETE  
AS 
BEGIN   	
                DECLARE @ERROR  int
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @TIPO_SITIO_LOCAL VARCHAR(1)
	DECLARE @AUDIT_TRANS_INV INT
	DECLARE @CONSECUTIVO VARCHAR(10)
	DECLARE @USUARIO VARCHAR(25)
	DECLARE @FECHA_HORA DATETIME
	DECLARE @MODULO_ORIGEN VARCHAR(4)
	DECLARE @APLICACION VARCHAR(40)
	DECLARE @REFERENCIA VARCHAR(200)
	DECLARE @ASIENTO VARCHAR(10)
	DECLARE @USUARIO_APRO VARCHAR(25)
	DECLARE @FECHA_HORA_APROB DATETIME
	
	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM,
	       @TIPO_SITIO_LOCAL = TIPO_SITIO_LOCAL
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM) AND @TIPO_SITIO_LOCAL = 'C' 
	BEGIN
		DECLARE C_DELETED CURSOR LOCAL FOR
			SELECT AUDIT_TRANS_INV
			FROM DELETED d
			WHERE 0 = (
				SELECT COUNT('n')
				FROM INSERTED i
				WHERE d.AUDIT_TRANS_INV = i.AUDIT_TRANS_INV
			   )

		OPEN C_DELETED
		FETCH NEXT FROM C_DELETED INTO 
		@AUDIT_TRANS_INV -- VARIABLES
		
		SET @ERROR = 0
		
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS = 
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<AUDIT_TRANS_INV>' + 
				'<AUDIT_TRANS_INV Type="INT" PrimaryKey="True">' + ERPADMIN.POS_NumberToVarchar(@AUDIT_TRANS_INV) + '</AUDIT_TRANS_INV>' + 
				'</AUDIT_TRANS_INV>'
 
			
			-- inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'AUDITTRANSINVPOS600', 'ELIMINA', @PARAMETROS, 0, ''
			
			FETCH NEXT FROM C_DELETED INTO 
			@AUDIT_TRANS_INV -- VARIABLES
		END

		CLOSE C_DELETED
		DEALLOCATE C_DELETED
	END
	
	IF (@@ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para eliminar de la tabla AUDIT_TRANS_INV.',16,1 )
	END
END;




CREATE TRIGGER $$Compania$$.AUDIT_TRANS_INV_POS_MOD
ON $$Compania$$.AUDIT_TRANS_INV
FOR UPDATE
AS 
BEGIN   	
	DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @TIPO_SITIO_LOCAL VARCHAR(1)
	DECLARE @COL_ROWPOINTER VARCHAR(36)
	DECLARE @HAY_CAMPOS_PARA_POS BIT
	DECLARE @ACTUALIZAR_SOLICITUD BIT
	DECLARE @AUDIT_TRANS_INV INT
	DECLARE @CONSECUTIVO VARCHAR(10)
	DECLARE @USUARIO VARCHAR(25)
	DECLARE @FECHA_HORA DATETIME
	DECLARE @MODULO_ORIGEN VARCHAR(4)
	DECLARE @APLICACION VARCHAR(249)
	DECLARE @REFERENCIA VARCHAR(200)
	DECLARE @ASIENTO VARCHAR(10)
	DECLARE @USUARIO_APRO VARCHAR(25)
	DECLARE @FECHA_HORA_APROB DATETIME
	DECLARE @USUARIO_ACTUAL VARCHAR(30)

	SET @ERROR = 0

	--Manda a leer el usuario actual. Si el trigger se está disparando durante la conexión que realiza el CargaPOS para la carga
	--de documentos, entonces el usuario que leerá dicho trigger es CargaPOS y con esto se podrá verificar que, si se hace una
	--transacción de tipo venta o reservación, la misma es producto de la carga de documentos del POS o es un movimiento desde el
	--ERP 
	EXEC ERPADMIN.LeerUsuarioActual @USUARIO_ACTUAL OUTPUT
	
	SET @USUARIO_ACTUAL = ISNULL(@USUARIO_ACTUAL,'')
	
	SELECT @PUBLICADOR = SITIO_LOCAL,
		@USUARIO_POS_WSQM = USUARIO_WSQM,
	       @TIPO_SITIO_LOCAL = TIPO_SITIO_LOCAL
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (SYSTEM_USER = @USUARIO_POS_WSQM) AND @TIPO_SITIO_LOCAL = 'C' AND (@USUARIO_ACTUAL <> 'CargaPOS' AND @USUARIO_ACTUAL <> 'CargaCCCG')
	BEGIN   
		DECLARE C_MODIFIED CURSOR LOCAL FOR
			SELECT AUDIT_TRANS_INV, CONSECUTIVO, USUARIO, FECHA_HORA, MODULO_ORIGEN, APLICACION, REFERENCIA, ASIENTO, USUARIO_APRO, FECHA_HORA_APROB -- Columnas
			FROM INSERTED I

		SET @ACTUALIZAR_SOLICITUD = 1

		OPEN C_MODIFIED

		FETCH NEXT FROM C_MODIFIED
		INTO @AUDIT_TRANS_INV, @CONSECUTIVO, @USUARIO, @FECHA_HORA, @MODULO_ORIGEN, @APLICACION, @REFERENCIA, @ASIENTO, @USUARIO_APRO, @FECHA_HORA_APROB

		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			IF ( NOT UPDATE(RECORDDATE) AND ( UPDATE(AUDIT_TRANS_INV) OR UPDATE(CONSECUTIVO) OR UPDATE(USUARIO) OR UPDATE(FECHA_HORA) OR UPDATE(MODULO_ORIGEN) OR UPDATE(APLICACION) OR UPDATE(REFERENCIA) OR UPDATE(ASIENTO) OR UPDATE(USUARIO_APRO) OR UPDATE(FECHA_HORA_APROB) ) )
			BEGIN

				SELECT @COL_ROWPOINTER = ROWPOINTER 
				FROM $$Compania$$.AUDIT_TRANS_INV
				WHERE AUDIT_TRANS_INV = @AUDIT_TRANS_INV 

				SET @PARAMETROS =
					'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<AUDIT_TRANS_INV>' + 
				'<AUDIT_TRANS_INV Type="INT" PrimaryKey="True">' + ERPADMIN.POS_NumberToVarchar(@AUDIT_TRANS_INV) + '</AUDIT_TRANS_INV>' + 
				'<CONSECUTIVO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CONSECUTIVO) + '</CONSECUTIVO>' + 
				'<USUARIO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USUARIO) + '</USUARIO>' + 
				'<FECHA_HORA Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_HORA) + '</FECHA_HORA>' + 
				'<MODULO_ORIGEN Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@MODULO_ORIGEN) + '</MODULO_ORIGEN>' + 
				'<APLICACION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@APLICACION) + '</APLICACION>' + 
				'<REFERENCIA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@REFERENCIA) + '</REFERENCIA>' + 
				'<ASIENTO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ASIENTO) + '</ASIENTO>' + 
				'<USUARIO_APRO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USUARIO_APRO) + '</USUARIO_APRO>' + 
				'<FECHA_HORA_APROB Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_HORA_APROB) + '</FECHA_HORA_APROB>' + 
				'</AUDIT_TRANS_INV>'


				-- inserta la solicitud correspondiente
				EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'AUDITTRANSINVPOS600', 'MODIFICA', @PARAMETROS, @ACTUALIZAR_SOLICITUD, @COL_ROWPOINTER
			END

			FETCH NEXT FROM C_MODIFIED
			INTO @AUDIT_TRANS_INV, @CONSECUTIVO, @USUARIO, @FECHA_HORA, @MODULO_ORIGEN, @APLICACION, @REFERENCIA, @ASIENTO, @USUARIO_APRO, @FECHA_HORA_APROB
		END

		CLOSE C_MODIFIED
		DEALLOCATE C_MODIFIED
	END

	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para modificar la tabla AUDIT_TRANS_INV.',16,1 )
	END
END;




CREATE TRIGGER $$Compania$$.TRANSACCION_INV_POS_INS
ON $$Compania$$.TRANSACCION_INV
FOR INSERT
AS
BEGIN
	DECLARE @TEXTO_ERROR VARCHAR(80)
	DECLARE @ERROR INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @TIPO_SITIO_LOCAL VARCHAR(1)
	DECLARE @TRANSACCION_VALIDA INT
	DECLARE @DOCUMENTO_VALIDA INT
	DECLARE @AUDIT_TRANS_INV INT
	DECLARE @CONSECUTIVO INT
	DECLARE @FECHA_HORA_TRANSAC DATETIME
	DECLARE @NIT VARCHAR(20)
	DECLARE @SERIE_CADENA INT
	DECLARE @AJUSTE_CONFIG VARCHAR(4)
	DECLARE @ARTICULO VARCHAR(20)
	DECLARE @BODEGA VARCHAR(4)
	DECLARE @LOCALIZACION VARCHAR(8)
	DECLARE @LOTE VARCHAR(15)
	DECLARE @TIPO VARCHAR(1)
	DECLARE @SUBTIPO VARCHAR(1)
	DECLARE @SUBSUBTIPO VARCHAR(1)
	DECLARE @NATURALEZA VARCHAR(1)
	DECLARE @CANTIDAD DECIMAL(28,8)
	DECLARE @COSTO_TOT_FISC_LOC DECIMAL(28,8)
	DECLARE @COSTO_TOT_FISC_DOL DECIMAL(28,8)
	DECLARE @COSTO_TOT_COMP_LOC DECIMAL(28,8)
	DECLARE @COSTO_TOT_COMP_DOL DECIMAL(28,8)
	DECLARE @PRECIO_TOTAL_LOCAL DECIMAL(28,8)
	DECLARE @PRECIO_TOTAL_DOLAR DECIMAL(28,8)
	DECLARE @CONTABILIZADA VARCHAR(1)
	DECLARE @FECHA DATETIME
	DECLARE @CENTRO_COSTO VARCHAR(25)
	DECLARE @UNIDAD_DISTRIBUCIO VARCHAR(6)
	DECLARE @CUENTA_CONTABLE VARCHAR(25)
	DECLARE @TRASPASO_TIENDA VARCHAR(1)
	DECLARE @USUARIO_ACTUAL VARCHAR(30)
	DECLARE @CONSECUTIVO_CARGA VARCHAR(30)
	DECLARE @CONSECUTIVO_TRANSAC VARCHAR(30)
	DECLARE @APLICACION_TRANSAC VARCHAR(20)
	DECLARE @APLICARMOVIMIENTO INT
	DECLARE @OBSERV VARCHAR(100)	

	--Manda a leer el usuario actual. Si el trigger se está disparando durante la conexión que realiza el CargaPOS para la carga
	--de documentos, entonces el usuario que leerá dicho trigger es CargaPOS y con esto se podrá verificar que, si se hace una
	--transacción de tipo venta o reservación, la misma es producto de la carga de documentos del POS o es un movimiento desde el
	--ERP 
	EXEC ERPADMIN.LeerUsuarioActual @USUARIO_ACTUAL OUTPUT

	SET @USUARIO_ACTUAL = ISNULL(@USUARIO_ACTUAL,'')

	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM,
	       @TIPO_SITIO_LOCAL = TIPO_SITIO_LOCAL,
	       @TRASPASO_TIENDA = TRASPASO_TIENDA
	FROM $$Compania$$.GLOBALES_POS
	
	SELECT @CONSECUTIVO_CARGA = G.CONSECUTIVO_CI
	FROM 	$$Compania$$.GLOBALES_POS GP, 
		$$Compania$$.GRUPO G, 
		$$Compania$$.SITIO_TIENDA ST
	WHERE GP.SITIO_LOCAL = ST.SITIO AND 
	ST.TIENDA = G.GRUPO 	

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	DECLARE C_INSERTED CURSOR LOCAL FOR
	SELECT AUDIT_TRANS_INV, CONSECUTIVO, FECHA_HORA_TRANSAC, NIT, SERIE_CADENA, AJUSTE_CONFIG, ARTICULO, BODEGA, LOCALIZACION, LOTE, TIPO, SUBTIPO, SUBSUBTIPO, NATURALEZA, CANTIDAD, COSTO_TOT_FISC_LOC, COSTO_TOT_FISC_DOL, COSTO_TOT_COMP_LOC, COSTO_TOT_COMP_DOL, PRECIO_TOTAL_LOCAL, PRECIO_TOTAL_DOLAR, CONTABILIZADA, FECHA, CENTRO_COSTO, UNIDAD_DISTRIBUCIO, CUENTA_CONTABLE
	FROM INSERTED i
	WHERE 0 = (
			SELECT COUNT('n')
			FROM DELETED d
			WHERE i.AUDIT_TRANS_INV = d.AUDIT_TRANS_INV AND i.CONSECUTIVO = d.CONSECUTIVO
		   )

	OPEN C_INSERTED	
	FETCH NEXT FROM C_INSERTED INTO
	@AUDIT_TRANS_INV, @CONSECUTIVO, @FECHA_HORA_TRANSAC, @NIT, @SERIE_CADENA, @AJUSTE_CONFIG, @ARTICULO, @BODEGA, @LOCALIZACION, @LOTE, @TIPO, @SUBTIPO, @SUBSUBTIPO, @NATURALEZA, @CANTIDAD, @COSTO_TOT_FISC_LOC, @COSTO_TOT_FISC_DOL, @COSTO_TOT_COMP_LOC, @COSTO_TOT_COMP_DOL, @PRECIO_TOTAL_LOCAL, @PRECIO_TOTAL_DOLAR, @CONTABILIZADA, @FECHA, @CENTRO_COSTO, @UNIDAD_DISTRIBUCIO, @CUENTA_CONTABLE


	SELECT @APLICARMOVIMIENTO = COUNT(*)
	FROM $$Compania$$.V_SITIO_BODEGA
	WHERE BODEGA = @BODEGA

	IF (@USUARIO_ACTUAL <> 'CargaPOS' OR @TIPO = 'M') AND @APLICARMOVIMIENTO > 0
	BEGIN	
		SET @ERROR = 0
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			IF @TIPO_SITIO_LOCAL = 'C' AND NOT (SYSTEM_USER = @USUARIO_POS_WSQM) AND ($$Compania$$.SINCTRANSACINVPOS(@TIPO, @SUBTIPO) = 1)
			BEGIN
			
				SELECT @CONSECUTIVO_TRANSAC = CONSECUTIVO
				FROM $$Compania$$.AUDIT_TRANS_INV
				WHERE	AUDIT_TRANS_INV = @AUDIT_TRANS_INV

				IF @TRASPASO_TIENDA = 'T' AND @TIPO = 'T' AND @CONSECUTIVO_CARGA = @CONSECUTIVO_TRANSAC AND @NATURALEZA = 'S'
				BEGIN	
				  CLOSE C_INSERTED
				  DEALLOCATE C_INSERTED
				  RAISERROR( 'El POS está configurado para hacer traspasos desde las tiendas. El uso de este consecutivo no es permitido.',16,1 )
				END


				IF @CONSECUTIVO_CARGA = @CONSECUTIVO_TRANSAC AND (@TIPO = 'V' OR @TIPO = 'R')
				BEGIN	
				  CLOSE C_INSERTED
				  DEALLOCATE C_INSERTED
				  RAISERROR( 'Se intenta realizar una venta o reservación con el consecutivo de central para el POS, lo cual no es permitido.',16,1 )
				END

				SET @SERIE_CADENA = NULL

				SET @PARAMETROS = 
					'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
					'<TRANSACCION_INV>' + 
					'<AUDIT_TRANS_INV Type="INT" PrimaryKey="True">' + ERPADMIN.POS_NumberToVarchar(@AUDIT_TRANS_INV) + '</AUDIT_TRANS_INV>' + 
					'<CONSECUTIVO Type="INT" PrimaryKey="True">' + ERPADMIN.POS_NumberToVarchar(@CONSECUTIVO) + '</CONSECUTIVO>' + 
					'<FECHA_HORA_TRANSAC Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_HORA_TRANSAC) + '</FECHA_HORA_TRANSAC>' + 
					'<NIT Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NIT) + '</NIT>' + 
					'<SERIE_CADENA Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@SERIE_CADENA) + '</SERIE_CADENA>' + 
					'<AJUSTE_CONFIG Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@AJUSTE_CONFIG) + '</AJUSTE_CONFIG>' + 
					'<ARTICULO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ARTICULO) + '</ARTICULO>' + 
					'<BODEGA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@BODEGA) + '</BODEGA>' + 
					'<LOCALIZACION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@LOCALIZACION) + '</LOCALIZACION>' + 
					'<LOTE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@LOTE) + '</LOTE>' + 
					'<TIPO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO) + '</TIPO>' + 
					'<SUBTIPO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@SUBTIPO) + '</SUBTIPO>' + 
					'<SUBSUBTIPO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@SUBSUBTIPO) + '</SUBSUBTIPO>' + 
					'<NATURALEZA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NATURALEZA) + '</NATURALEZA>' + 
					'<CANTIDAD Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@CANTIDAD) + '</CANTIDAD>' + 
					'<COSTO_TOT_FISC_LOC Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@COSTO_TOT_FISC_LOC) + '</COSTO_TOT_FISC_LOC>' + 
					'<COSTO_TOT_FISC_DOL Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@COSTO_TOT_FISC_DOL) + '</COSTO_TOT_FISC_DOL>' + 
					'<COSTO_TOT_COMP_LOC Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@COSTO_TOT_COMP_LOC) + '</COSTO_TOT_COMP_LOC>' + 
					'<COSTO_TOT_COMP_DOL Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@COSTO_TOT_COMP_DOL) + '</COSTO_TOT_COMP_DOL>' + 
					'<PRECIO_TOTAL_LOCAL Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@PRECIO_TOTAL_LOCAL) + '</PRECIO_TOTAL_LOCAL>' + 
					'<PRECIO_TOTAL_DOLAR Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@PRECIO_TOTAL_DOLAR) + '</PRECIO_TOTAL_DOLAR>' + 
					'<CONTABILIZADA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CONTABILIZADA) + '</CONTABILIZADA>' + 
					'<FECHA Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA) + '</FECHA>' + 
					'<CENTRO_COSTO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CENTRO_COSTO) + '</CENTRO_COSTO>' + 
					'<UNIDAD_DISTRIBUCIO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@UNIDAD_DISTRIBUCIO) + '</UNIDAD_DISTRIBUCIO>' + 
					'<CUENTA_CONTABLE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CUENTA_CONTABLE) + '</CUENTA_CONTABLE>' + 
					'</TRANSACCION_INV>'

				-- Inserta la solicitud correspondiente
				EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'TRANSACCIONINVPOS600', 'INSERTA', @PARAMETROS, 0, ''
			END
			ELSE IF @TIPO_SITIO_LOCAL = 'T'
			BEGIN			
				IF SYSTEM_USER = @USUARIO_POS_WSQM
				BEGIN
			
					IF 	(@TIPO = 'T' AND 
							(
								( 0 = (
									SELECT COUNT(*)							
									FROM  $$Compania$$.GRUPO G, $$Compania$$.SITIO_TIENDA ST, $$Compania$$.GLOBALES_POS GP, $$Compania$$.AUDIT_TRANS_INV ATI,							
									$$Compania$$.TRANSACCION_INV TI,$$Compania$$.V_SITIO_BODEGA VSB							
									WHERE       gp.SITIO_LOCAL = vsb.SITIO and							
										    vsb.SITIO = st.SITIO and 							
										    g.GRUPO = st.TIENDA AND							
										    g.CONSECUTIVO_CI = ati.CONSECUTIVO AND							
										    ti.AUDIT_TRANS_INV = ati.AUDIT_TRANS_INV AND							
										    ati.AUDIT_TRANS_INV =  @AUDIT_TRANS_INV AND 							
										    ti.Naturaleza = 'S' AND 							
										    vsb.BODEGA = @BODEGA

								      )
								  OR
								  @TRASPASO_TIENDA = 'C'
								)
							)
						) OR
						(@TIPO IN ('V', 'R') AND 					
								0 = (
									SELECT COUNT(*)
									FROM $$Compania$$.GRUPO G, 
									$$Compania$$.SITIO_TIENDA ST,
									(SELECT B.SUSCRIPTOR
										  FROM $$Compania$$.GLOBALES_POS A, ERPADMIN.CONFIG_PAR_SITIO B
										  WHERE B.PUBLICADOR = A.SITIO_LOCAL) AS SITIO_CENTRAL,
										$$Compania$$.AUDIT_TRANS_INV ATI, $$Compania$$.TRANSACCION_INV TI
									WHERE SITIO_CENTRAL.SUSCRIPTOR = ST.SITIO  AND
										ST.TIENDA = G.GRUPO AND 
										G.CONSECUTIVO_CI = ATI.CONSECUTIVO AND 
										ATI.AUDIT_TRANS_INV = TI.AUDIT_TRANS_INV AND
										TI.AUDIT_TRANS_INV = @AUDIT_TRANS_INV AND 
										TI.BODEGA = @BODEGA
									      )					
						   ) OR
						(@TIPO IN ('A', 'C', 'F', 'I', 'M', 'N', 'O', 'P'))
					BEGIN
						SELECT @APLICARMOVIMIENTO = COUNT(*)
						FROM $$Compania$$.V_SITIO_BODEGA
						WHERE SITIO IN (SELECT SITIO_LOCAL FROM $$Compania$$.GLOBALES_POS)
						AND BODEGA = @BODEGA

						IF @APLICARMOVIMIENTO > 0
						BEGIN
							SELECT @CONSECUTIVO_TRANSAC = ISNULL(CONSECUTIVO,'ND'), @APLICACION_TRANSAC = APLICACION
							FROM $$Compania$$.AUDIT_TRANS_INV
							WHERE	AUDIT_TRANS_INV = @AUDIT_TRANS_INV

							SET @OBSERV = 'Mov. Inv. Consecutivo: ' + @CONSECUTIVO_TRANSAC + ', Documento: ' + @APLICACION_TRANSAC

							EXEC $$Compania$$.APLICAINVENTARIOPOS  @TIPO, @ARTICULO, @BODEGA, @SUBTIPO, @CANTIDAD, @OBSERV, @LOCALIZACION, @LOTE
						END
					END
				END
				ELSE 
				BEGIN
					SET @TEXTO_ERROR = 'El usuario ' + SYSTEM_USER + ' no corresponde al usuario de sincronización configurado en las globales del POS.'
					RAISERROR(@TEXTO_ERROR ,16,1 )
				END
			END

			FETCH NEXT FROM C_INSERTED INTO
			@AUDIT_TRANS_INV, @CONSECUTIVO, @FECHA_HORA_TRANSAC, @NIT, @SERIE_CADENA, @AJUSTE_CONFIG, @ARTICULO, @BODEGA, @LOCALIZACION, @LOTE, @TIPO, @SUBTIPO, @SUBSUBTIPO, @NATURALEZA, @CANTIDAD, @COSTO_TOT_FISC_LOC, @COSTO_TOT_FISC_DOL, @COSTO_TOT_COMP_LOC, @COSTO_TOT_COMP_DOL, @PRECIO_TOTAL_LOCAL, @PRECIO_TOTAL_DOLAR, @CONTABILIZADA, @FECHA, @CENTRO_COSTO, @UNIDAD_DISTRIBUCIO, @CUENTA_CONTABLE
		END

		CLOSE C_INSERTED
		DEALLOCATE C_INSERTED
	END

	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla TRANSACCION_INV.',16,1 )
	END
END
;



CREATE TRIGGER $$Compania$$.ARTICULO_POS_INS
ON $$Compania$$.ARTICULO
FOR INSERT
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @ARTICULO VARCHAR(20)
	DECLARE @PLANTILLA_SERIE VARCHAR(4)
	DECLARE @DESCRIPCION VARCHAR(254)
	DECLARE @CLASIFICACION_1 VARCHAR(12)
	DECLARE @CLASIFICACION_2 VARCHAR(12)
	DECLARE @CLASIFICACION_3 VARCHAR(12)
	DECLARE @CLASIFICACION_4 VARCHAR(12)
	DECLARE @CLASIFICACION_5 VARCHAR(12)
	DECLARE @CLASIFICACION_6 VARCHAR(12)
	DECLARE @FACTOR_CONVER_1 DECIMAL(28,8)
	DECLARE @FACTOR_CONVER_2 DECIMAL(28,8)
	DECLARE @FACTOR_CONVER_3 DECIMAL(28,8)
	DECLARE @FACTOR_CONVER_4 DECIMAL(28,8)
	DECLARE @FACTOR_CONVER_5 DECIMAL(28,8)
	DECLARE @FACTOR_CONVER_6 DECIMAL(28,8)
	DECLARE @TIPO VARCHAR(1)
	DECLARE @ORIGEN_CORP VARCHAR(1)
	DECLARE @PESO_NETO DECIMAL(28,8)
	DECLARE @PESO_BRUTO DECIMAL(28,8)
	DECLARE @VOLUMEN DECIMAL(28,8)
	DECLARE @BULTOS INT
	DECLARE @ARTICULO_CUENTA VARCHAR(4)
	DECLARE @IMPUESTO VARCHAR(4)
	DECLARE @FACTOR_EMPAQUE DECIMAL(28,8)
	DECLARE @FACTOR_VENTA DECIMAL(28,8)
	DECLARE @EXISTENCIA_MINIMA DECIMAL(28,8)
	DECLARE @EXISTENCIA_MAXIMA DECIMAL(28,8)
	DECLARE @PUNTO_DE_REORDEN DECIMAL(28,8)
	DECLARE @COSTO_FISCAL VARCHAR(1)
	DECLARE @COSTO_COMPARATIVO VARCHAR(1)
	DECLARE @COSTO_PROM_LOC DECIMAL(28,8)
	DECLARE @COSTO_PROM_DOL DECIMAL(28,8)
	DECLARE @COSTO_STD_LOC DECIMAL(28,8)
	DECLARE @COSTO_STD_DOL DECIMAL(28,8)
	DECLARE @COSTO_ULT_LOC DECIMAL(28,8)
	DECLARE @COSTO_ULT_DOL DECIMAL(28,8)
	DECLARE @PRECIO_BASE_LOCAL DECIMAL(28,8)
	DECLARE @PRECIO_BASE_DOLAR DECIMAL(28,8)
	DECLARE @ULTIMA_SALIDA DATETIME
	DECLARE @ULTIMO_MOVIMIENTO DATETIME
	DECLARE @ULTIMO_INGRESO DATETIME
	DECLARE @ULTIMO_INVENTARIO DATETIME
	DECLARE @CLASE_ABC VARCHAR(1)
	DECLARE @FRECUENCIA_CONTEO INT
	DECLARE @CODIGO_BARRAS_VENT VARCHAR(20)
	DECLARE @CODIGO_BARRAS_INVT VARCHAR(20)
	DECLARE @ACTIVO VARCHAR(1)
	DECLARE @USA_LOTES VARCHAR(1)
	DECLARE @OBLIGA_CUARENTENA VARCHAR(1)
	DECLARE @MIN_VIDA_COMPRA INT
	DECLARE @MIN_VIDA_CONSUMO INT
	DECLARE @MIN_VIDA_VENTA INT
	DECLARE @VIDA_UTIL_PROM INT
	DECLARE @DIAS_CUARENTENA INT
	DECLARE @PROVEEDOR VARCHAR(20)
	DECLARE @ARTICULO_DEL_PROV VARCHAR(20)
	DECLARE @ORDEN_MINIMA DECIMAL(28,8)
	DECLARE @PLAZO_REABAST INT
	DECLARE @LOTE_MULTIPLO DECIMAL(28,8)
	DECLARE @UTILIZADO_MANUFACT VARCHAR(1)
	DECLARE @USUARIO_CREACION VARCHAR(25)
	DECLARE @FCH_HORA_CREACION DATETIME
	DECLARE @USUARIO_ULT_MODIF VARCHAR(25)
	DECLARE @FCH_HORA_ULT_MODIF DATETIME
	DECLARE @USA_NUMEROS_SERIE VARCHAR(1)
	DECLARE @MODALIDAD_INV_FIS VARCHAR(1)
	DECLARE @TIPO_COD_BARRA_DET VARCHAR(1)
	DECLARE @TIPO_COD_BARRA_ALM VARCHAR(1)
	DECLARE @USA_REGLAS_LOCALES VARCHAR(1)
	DECLARE @UNIDAD_ALMACEN VARCHAR(6)
	DECLARE @UNIDAD_EMPAQUE VARCHAR(6)
	DECLARE @UNIDAD_VENTA VARCHAR(6)
	DECLARE @PERECEDERO VARCHAR(1)
	DECLARE @GTIN VARCHAR(13)
	DECLARE @MANUFACTURADOR VARCHAR(35)
	DECLARE @CODIGO_RETENCION VARCHAR(4)
	DECLARE @RETENCION_VENTA VARCHAR(4)
	DECLARE @RETENCION_COMPRA VARCHAR(4)
	DECLARE @MODELO_RETENCION VARCHAR(4)

	
	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS
	
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (SYSTEM_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_INSERTED CURSOR LOCAL FOR
		SELECT ARTICULO, PLANTILLA_SERIE, DESCRIPCION, CLASIFICACION_1, CLASIFICACION_2, CLASIFICACION_3, CLASIFICACION_4, CLASIFICACION_5, CLASIFICACION_6, FACTOR_CONVER_1, FACTOR_CONVER_2, FACTOR_CONVER_3, FACTOR_CONVER_4, FACTOR_CONVER_5, FACTOR_CONVER_6, TIPO, ORIGEN_CORP, PESO_NETO, PESO_BRUTO, VOLUMEN, BULTOS, ARTICULO_CUENTA, IMPUESTO, FACTOR_EMPAQUE, FACTOR_VENTA, EXISTENCIA_MINIMA, EXISTENCIA_MAXIMA, PUNTO_DE_REORDEN, COSTO_FISCAL, COSTO_COMPARATIVO, COSTO_PROM_LOC, COSTO_PROM_DOL, COSTO_STD_LOC, COSTO_STD_DOL, COSTO_ULT_LOC, COSTO_ULT_DOL, PRECIO_BASE_LOCAL, PRECIO_BASE_DOLAR, ULTIMA_SALIDA, ULTIMO_MOVIMIENTO, ULTIMO_INGRESO, ULTIMO_INVENTARIO, CLASE_ABC, FRECUENCIA_CONTEO, CODIGO_BARRAS_VENT, CODIGO_BARRAS_INVT, ACTIVO, USA_LOTES, OBLIGA_CUARENTENA, MIN_VIDA_COMPRA, MIN_VIDA_CONSUMO, MIN_VIDA_VENTA, VIDA_UTIL_PROM, DIAS_CUARENTENA, PROVEEDOR, ARTICULO_DEL_PROV, ORDEN_MINIMA, PLAZO_REABAST, LOTE_MULTIPLO, UTILIZADO_MANUFACT, USUARIO_CREACION, FCH_HORA_CREACION, USUARIO_ULT_MODIF, FCH_HORA_ULT_MODIF, USA_NUMEROS_SERIE, MODALIDAD_INV_FIS, TIPO_COD_BARRA_DET, TIPO_COD_BARRA_ALM, USA_REGLAS_LOCALES, UNIDAD_ALMACEN, UNIDAD_EMPAQUE, UNIDAD_VENTA, PERECEDERO, GTIN, MANUFACTURADOR, CODIGO_RETENCION, RETENCION_VENTA, RETENCION_COMPRA, MODELO_RETENCION
		FROM INSERTED i
			
		OPEN C_INSERTED	
		FETCH NEXT FROM C_INSERTED INTO
		@ARTICULO, @PLANTILLA_SERIE, @DESCRIPCION, @CLASIFICACION_1, @CLASIFICACION_2, @CLASIFICACION_3, @CLASIFICACION_4, @CLASIFICACION_5, @CLASIFICACION_6, @FACTOR_CONVER_1, @FACTOR_CONVER_2, @FACTOR_CONVER_3, @FACTOR_CONVER_4, @FACTOR_CONVER_5, @FACTOR_CONVER_6, @TIPO, @ORIGEN_CORP, @PESO_NETO, @PESO_BRUTO, @VOLUMEN, @BULTOS, @ARTICULO_CUENTA, @IMPUESTO, @FACTOR_EMPAQUE, @FACTOR_VENTA, @EXISTENCIA_MINIMA, @EXISTENCIA_MAXIMA, @PUNTO_DE_REORDEN, @COSTO_FISCAL, @COSTO_COMPARATIVO, @COSTO_PROM_LOC, @COSTO_PROM_DOL, @COSTO_STD_LOC, @COSTO_STD_DOL, @COSTO_ULT_LOC, @COSTO_ULT_DOL, @PRECIO_BASE_LOCAL, @PRECIO_BASE_DOLAR, @ULTIMA_SALIDA, @ULTIMO_MOVIMIENTO, @ULTIMO_INGRESO, @ULTIMO_INVENTARIO, @CLASE_ABC, @FRECUENCIA_CONTEO, @CODIGO_BARRAS_VENT, @CODIGO_BARRAS_INVT, @ACTIVO, @USA_LOTES, @OBLIGA_CUARENTENA, @MIN_VIDA_COMPRA, @MIN_VIDA_CONSUMO, @MIN_VIDA_VENTA, @VIDA_UTIL_PROM, @DIAS_CUARENTENA, @PROVEEDOR, @ARTICULO_DEL_PROV, @ORDEN_MINIMA, @PLAZO_REABAST, @LOTE_MULTIPLO, @UTILIZADO_MANUFACT, @USUARIO_CREACION, @FCH_HORA_CREACION, @USUARIO_ULT_MODIF, @FCH_HORA_ULT_MODIF, @USA_NUMEROS_SERIE, @MODALIDAD_INV_FIS, @TIPO_COD_BARRA_DET, @TIPO_COD_BARRA_ALM, @USA_REGLAS_LOCALES, @UNIDAD_ALMACEN, @UNIDAD_EMPAQUE, @UNIDAD_VENTA, @PERECEDERO, @GTIN, @MANUFACTURADOR, @CODIGO_RETENCION, @RETENCION_VENTA, @RETENCION_COMPRA, @MODELO_RETENCION
		SET @ERROR = 0
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS =
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<ARTICULO>' +
				'<ARTICULO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@ARTICULO) + '</ARTICULO>' +
				'<PLANTILLA_SERIE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@PLANTILLA_SERIE) + '</PLANTILLA_SERIE>' +
				'<DESCRIPCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DESCRIPCION) + '</DESCRIPCION>' +
				'<CLASIFICACION_1 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CLASIFICACION_1) + '</CLASIFICACION_1>' +
				'<CLASIFICACION_2 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CLASIFICACION_2) + '</CLASIFICACION_2>' +
				'<CLASIFICACION_3 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CLASIFICACION_3) + '</CLASIFICACION_3>' +
				'<CLASIFICACION_4 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CLASIFICACION_4) + '</CLASIFICACION_4>' +
				'<CLASIFICACION_5 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CLASIFICACION_5) + '</CLASIFICACION_5>' +
				'<CLASIFICACION_6 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CLASIFICACION_6) + '</CLASIFICACION_6>' +
				'<FACTOR_CONVER_1 Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@FACTOR_CONVER_1) + '</FACTOR_CONVER_1>' +
				'<FACTOR_CONVER_2 Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@FACTOR_CONVER_2) + '</FACTOR_CONVER_2>' +
				'<FACTOR_CONVER_3 Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@FACTOR_CONVER_3) + '</FACTOR_CONVER_3>' +
				'<FACTOR_CONVER_4 Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@FACTOR_CONVER_4) + '</FACTOR_CONVER_4>' +
				'<FACTOR_CONVER_5 Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@FACTOR_CONVER_5) + '</FACTOR_CONVER_5>' +
				'<FACTOR_CONVER_6 Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@FACTOR_CONVER_6) + '</FACTOR_CONVER_6>' +
				'<TIPO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO) + '</TIPO>' +
				'<ORIGEN_CORP Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ORIGEN_CORP) + '</ORIGEN_CORP>' +
				'<PESO_NETO Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@PESO_NETO) + '</PESO_NETO>' +
				'<PESO_BRUTO Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@PESO_BRUTO) + '</PESO_BRUTO>' +
				'<VOLUMEN Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@VOLUMEN) + '</VOLUMEN>' +
				'<BULTOS Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@BULTOS) + '</BULTOS>' +
				'<ARTICULO_CUENTA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ARTICULO_CUENTA) + '</ARTICULO_CUENTA>' +
				'<IMPUESTO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@IMPUESTO) + '</IMPUESTO>' +
				'<FACTOR_EMPAQUE Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@FACTOR_EMPAQUE) + '</FACTOR_EMPAQUE>' +
				'<FACTOR_VENTA Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@FACTOR_VENTA) + '</FACTOR_VENTA>' +
				'<EXISTENCIA_MINIMA Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@EXISTENCIA_MINIMA) + '</EXISTENCIA_MINIMA>' +
				'<EXISTENCIA_MAXIMA Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@EXISTENCIA_MAXIMA) + '</EXISTENCIA_MAXIMA>' +
				'<PUNTO_DE_REORDEN Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@PUNTO_DE_REORDEN) + '</PUNTO_DE_REORDEN>' +
				'<COSTO_FISCAL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@COSTO_FISCAL) + '</COSTO_FISCAL>' +
				'<COSTO_COMPARATIVO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@COSTO_COMPARATIVO) + '</COSTO_COMPARATIVO>' +
				'<COSTO_PROM_LOC Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@COSTO_PROM_LOC) + '</COSTO_PROM_LOC>' +
				'<COSTO_PROM_DOL Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@COSTO_PROM_DOL) + '</COSTO_PROM_DOL>' +
				'<COSTO_STD_LOC Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@COSTO_STD_LOC) + '</COSTO_STD_LOC>' +
				'<COSTO_STD_DOL Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@COSTO_STD_DOL) + '</COSTO_STD_DOL>' +
				'<COSTO_ULT_LOC Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@COSTO_ULT_LOC) + '</COSTO_ULT_LOC>' +
				'<COSTO_ULT_DOL Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@COSTO_ULT_DOL) + '</COSTO_ULT_DOL>' +
				'<PRECIO_BASE_LOCAL Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@PRECIO_BASE_LOCAL) + '</PRECIO_BASE_LOCAL>' +
				'<PRECIO_BASE_DOLAR Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@PRECIO_BASE_DOLAR) + '</PRECIO_BASE_DOLAR>' +
				'<ULTIMA_SALIDA Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@ULTIMA_SALIDA) + '</ULTIMA_SALIDA>' +
				'<ULTIMO_MOVIMIENTO Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@ULTIMO_MOVIMIENTO) + '</ULTIMO_MOVIMIENTO>' +
				'<ULTIMO_INGRESO Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@ULTIMO_INGRESO) + '</ULTIMO_INGRESO>' +
				'<ULTIMO_INVENTARIO Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@ULTIMO_INVENTARIO) + '</ULTIMO_INVENTARIO>' +
				'<CLASE_ABC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CLASE_ABC) + '</CLASE_ABC>' +
				'<FRECUENCIA_CONTEO Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@FRECUENCIA_CONTEO) + '</FRECUENCIA_CONTEO>' +
				'<CODIGO_BARRAS_VENT Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CODIGO_BARRAS_VENT) + '</CODIGO_BARRAS_VENT>' +
				'<CODIGO_BARRAS_INVT Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CODIGO_BARRAS_INVT) + '</CODIGO_BARRAS_INVT>' +
				'<ACTIVO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ACTIVO) + '</ACTIVO>' +
				'<USA_LOTES Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USA_LOTES) + '</USA_LOTES>' +
				'<OBLIGA_CUARENTENA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@OBLIGA_CUARENTENA) + '</OBLIGA_CUARENTENA>' +
				'<MIN_VIDA_COMPRA Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@MIN_VIDA_COMPRA) + '</MIN_VIDA_COMPRA>' +
				'<MIN_VIDA_CONSUMO Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@MIN_VIDA_CONSUMO) + '</MIN_VIDA_CONSUMO>' +
				'<MIN_VIDA_VENTA Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@MIN_VIDA_VENTA) + '</MIN_VIDA_VENTA>' +
				'<VIDA_UTIL_PROM Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@VIDA_UTIL_PROM) + '</VIDA_UTIL_PROM>' +
				'<DIAS_CUARENTENA Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@DIAS_CUARENTENA) + '</DIAS_CUARENTENA>' +
				'<PROVEEDOR Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@PROVEEDOR) + '</PROVEEDOR>' +
				'<ARTICULO_DEL_PROV Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ARTICULO_DEL_PROV) + '</ARTICULO_DEL_PROV>' +
				'<ORDEN_MINIMA Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@ORDEN_MINIMA) + '</ORDEN_MINIMA>' +
				'<PLAZO_REABAST Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@PLAZO_REABAST) + '</PLAZO_REABAST>' +
				'<LOTE_MULTIPLO Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@LOTE_MULTIPLO) + '</LOTE_MULTIPLO>' +
				'<UTILIZADO_MANUFACT Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@UTILIZADO_MANUFACT) + '</UTILIZADO_MANUFACT>' +
				'<USUARIO_CREACION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USUARIO_CREACION) + '</USUARIO_CREACION>' +
				'<FCH_HORA_CREACION Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FCH_HORA_CREACION) + '</FCH_HORA_CREACION>' +
				'<USUARIO_ULT_MODIF Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USUARIO_ULT_MODIF) + '</USUARIO_ULT_MODIF>' +
				'<FCH_HORA_ULT_MODIF Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FCH_HORA_ULT_MODIF) + '</FCH_HORA_ULT_MODIF>' +
				'<USA_NUMEROS_SERIE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USA_NUMEROS_SERIE) + '</USA_NUMEROS_SERIE>' +
				'<MODALIDAD_INV_FIS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@MODALIDAD_INV_FIS) + '</MODALIDAD_INV_FIS>' +
				'<TIPO_COD_BARRA_DET Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_COD_BARRA_DET) + '</TIPO_COD_BARRA_DET>' +
				'<TIPO_COD_BARRA_ALM Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_COD_BARRA_ALM) + '</TIPO_COD_BARRA_ALM>' +
				'<USA_REGLAS_LOCALES Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USA_REGLAS_LOCALES) + '</USA_REGLAS_LOCALES>' +
				'<UNIDAD_ALMACEN Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@UNIDAD_ALMACEN) + '</UNIDAD_ALMACEN>' +
				'<UNIDAD_EMPAQUE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@UNIDAD_EMPAQUE) + '</UNIDAD_EMPAQUE>' +
				'<UNIDAD_VENTA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@UNIDAD_VENTA) + '</UNIDAD_VENTA>' +
				'<PERECEDERO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@PERECEDERO) + '</PERECEDERO>' +
				'<GTIN Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@GTIN) + '</GTIN>' +
				'<MANUFACTURADOR Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@MANUFACTURADOR) + '</MANUFACTURADOR>' +
				'<CODIGO_RETENCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CODIGO_RETENCION) + '</CODIGO_RETENCION>' + 				
				'<RETENCION_VENTA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@RETENCION_VENTA) + '</RETENCION_VENTA>' + 
				'<RETENCION_COMPRA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@RETENCION_COMPRA) + '</RETENCION_COMPRA>' + 
				'<MODELO_RETENCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@MODELO_RETENCION) + '</MODELO_RETENCION>' + 				
				'</ARTICULO>'
			-- Inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'DIVISIONGEOGRAFICA1POS600', 'INSERTA', @PARAMETROS, 0, ''
			FETCH NEXT FROM C_INSERTED INTO
			@ARTICULO, @PLANTILLA_SERIE, @DESCRIPCION, @CLASIFICACION_1, @CLASIFICACION_2, @CLASIFICACION_3, @CLASIFICACION_4, @CLASIFICACION_5, @CLASIFICACION_6, @FACTOR_CONVER_1, @FACTOR_CONVER_2, @FACTOR_CONVER_3, @FACTOR_CONVER_4, @FACTOR_CONVER_5, @FACTOR_CONVER_6, @TIPO, @ORIGEN_CORP, @PESO_NETO, @PESO_BRUTO, @VOLUMEN, @BULTOS, @ARTICULO_CUENTA, @IMPUESTO, @FACTOR_EMPAQUE, @FACTOR_VENTA, @EXISTENCIA_MINIMA, @EXISTENCIA_MAXIMA, @PUNTO_DE_REORDEN, @COSTO_FISCAL, @COSTO_COMPARATIVO, @COSTO_PROM_LOC, @COSTO_PROM_DOL, @COSTO_STD_LOC, @COSTO_STD_DOL, @COSTO_ULT_LOC, @COSTO_ULT_DOL, @PRECIO_BASE_LOCAL, @PRECIO_BASE_DOLAR, @ULTIMA_SALIDA, @ULTIMO_MOVIMIENTO, @ULTIMO_INGRESO, @ULTIMO_INVENTARIO, @CLASE_ABC, @FRECUENCIA_CONTEO, @CODIGO_BARRAS_VENT, @CODIGO_BARRAS_INVT, @ACTIVO, @USA_LOTES, @OBLIGA_CUARENTENA, @MIN_VIDA_COMPRA, @MIN_VIDA_CONSUMO, @MIN_VIDA_VENTA, @VIDA_UTIL_PROM, @DIAS_CUARENTENA, @PROVEEDOR, @ARTICULO_DEL_PROV, @ORDEN_MINIMA, @PLAZO_REABAST, @LOTE_MULTIPLO, @UTILIZADO_MANUFACT, @USUARIO_CREACION, @FCH_HORA_CREACION, @USUARIO_ULT_MODIF, @FCH_HORA_ULT_MODIF, @USA_NUMEROS_SERIE, @MODALIDAD_INV_FIS, @TIPO_COD_BARRA_DET, @TIPO_COD_BARRA_ALM, @USA_REGLAS_LOCALES, @UNIDAD_ALMACEN, @UNIDAD_EMPAQUE, @UNIDAD_VENTA, @PERECEDERO, @GTIN, @MANUFACTURADOR, @CODIGO_RETENCION, @RETENCION_VENTA, @RETENCION_COMPRA, @MODELO_RETENCION
		END
		CLOSE C_INSERTED
    		DEALLOCATE C_INSERTED
	END
	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla ARTICULO.',16,1 )
	END
END;




CREATE TRIGGER $$Compania$$.ARTICULO_POS_DEL
ON $$Compania$$.ARTICULO
FOR DELETE
AS
BEGIN   	
                DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @ARTICULO VARCHAR(20)
	 -- Declaraciones	
	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_DELETED CURSOR LOCAL FOR
			SELECT ARTICULO
			FROM DELETED d
			WHERE 0 = (
				SELECT COUNT('n')
				FROM INSERTED i
				WHERE d.ARTICULO = i.ARTICULO
			   )
		OPEN C_DELETED
		FETCH NEXT FROM C_DELETED INTO
		@ARTICULO
		
		SET @ERROR = 0
		
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS =
								'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<ARTICULO>' +
				'<ARTICULO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@ARTICULO) + '</ARTICULO>' +
				'</ARTICULO>'
 -- XML
			
			-- inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'ARTICULOPOS600', 'ELIMINA', @PARAMETROS, 0, ''
			
			FETCH NEXT FROM C_DELETED INTO
			@ARTICULO
		END
		CLOSE C_DELETED
		DEALLOCATE C_DELETED
	END
	
	IF (@@ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para eliminar de la tabla ARTICULO.',16,1 )
	END
END
;




CREATE TRIGGER $$Compania$$.ARTICULO_POS_MOD 
ON $$Compania$$.ARTICULO
FOR UPDATE
AS
BEGIN   	
	DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @COL_ROWPOINTER VARCHAR(36)
	DECLARE @HAY_CAMPOS_PARA_POS BIT
	DECLARE @ACTUALIZAR_SOLICITUD BIT
	DECLARE @ARTICULO VARCHAR(20)
	DECLARE @PLANTILLA_SERIE VARCHAR(4)
	DECLARE @DESCRIPCION VARCHAR(254)
	DECLARE @CLASIFICACION_1 VARCHAR(12)
	DECLARE @CLASIFICACION_2 VARCHAR(12)
	DECLARE @CLASIFICACION_3 VARCHAR(12)
	DECLARE @CLASIFICACION_4 VARCHAR(12)
	DECLARE @CLASIFICACION_5 VARCHAR(12)
	DECLARE @CLASIFICACION_6 VARCHAR(12)
	DECLARE @ARTICULO_CUENTA VARCHAR(4)
	DECLARE @TIPO VARCHAR(1)
	DECLARE @IMPUESTO VARCHAR(4)
	DECLARE @FACTOR_EMPAQUE DECIMAL(28,8)
	DECLARE @CODIGO_BARRAS_VENT VARCHAR(20)
	DECLARE @CODIGO_BARRAS_INVT VARCHAR(20)
	DECLARE @ACTIVO VARCHAR(1)
	DECLARE @USA_LOTES VARCHAR(1)
	DECLARE @PROVEEDOR VARCHAR(20)
	DECLARE @ARTICULO_DEL_PROV VARCHAR(20)
	DECLARE @UNIDAD_ALMACEN VARCHAR(6)
	DECLARE @UNIDAD_EMPAQUE VARCHAR(6)
	DECLARE @UNIDAD_VENTA VARCHAR(6)
	DECLARE @USA_NUMEROS_SERIE VARCHAR(1)
	DECLARE @CODIGO_RETENCION VARCHAR(4)
	DECLARE @VENDER_POR_DEBAJO_COSTO VARCHAR(1)
	DECLARE @COSTO_FISCAL VARCHAR(1)
	DECLARE @COSTO_COMPARATIVO VARCHAR(1)
	DECLARE @COSTO_PROM_LOC DECIMAL(28,8)
	DECLARE @COSTO_PROM_DOL DECIMAL(28,8)
	DECLARE @COSTO_STD_LOC DECIMAL(28,8)
	DECLARE @COSTO_STD_DOL DECIMAL(28,8)
	DECLARE @COSTO_ULT_LOC DECIMAL(28,8)
	DECLARE @COSTO_ULT_DOL DECIMAL(28,8)
	DECLARE @RETENCION_VENTA VARCHAR(4)
	DECLARE @RETENCION_COMPRA VARCHAR(4)
	DECLARE @MODELO_RETENCION VARCHAR(4)	

	 -- Declaraciones
	SET @ERROR = 0
	SELECT @PUBLICADOR = SITIO_LOCAL, @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS

	 --Se obtiene el valor que indica si se debe actualizar los costos del artículo
	SELECT @VENDER_POR_DEBAJO_COSTO = VALOR 
	FROM $$Compania$$.GLOBALES
	WHERE MODULO = 'PO'
	AND NOMBRE = 'VENDER_POR_DEBAJO_COSTO'
	
	SET @VENDER_POR_DEBAJO_COSTO = ISNULL(@VENDER_POR_DEBAJO_COSTO, 'S')

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (SYSTEM_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_MODIFIED CURSOR LOCAL FOR
			SELECT ARTICULO, PLANTILLA_SERIE, DESCRIPCION, CLASIFICACION_1, CLASIFICACION_2, CLASIFICACION_3, CLASIFICACION_4, CLASIFICACION_5, CLASIFICACION_6, TIPO, ARTICULO_CUENTA, IMPUESTO, FACTOR_EMPAQUE, CODIGO_BARRAS_VENT, CODIGO_BARRAS_INVT, ACTIVO, USA_LOTES, PROVEEDOR, ARTICULO_DEL_PROV, UNIDAD_ALMACEN, UNIDAD_EMPAQUE, UNIDAD_VENTA, USA_NUMEROS_SERIE, CODIGO_RETENCION, COSTO_FISCAL, COSTO_COMPARATIVO, COSTO_PROM_LOC, COSTO_PROM_DOL, COSTO_STD_LOC, COSTO_STD_DOL, COSTO_ULT_LOC, COSTO_ULT_DOL, RETENCION_VENTA, RETENCION_COMPRA, MODELO_RETENCION -- Columnas
			FROM INSERTED I
			
		SET @ACTUALIZAR_SOLICITUD = 1
		OPEN C_MODIFIED
		
		FETCH NEXT FROM C_MODIFIED
		INTO @ARTICULO, @PLANTILLA_SERIE, @DESCRIPCION, @CLASIFICACION_1, @CLASIFICACION_2, @CLASIFICACION_3, @CLASIFICACION_4, @CLASIFICACION_5, @CLASIFICACION_6, @TIPO, @ARTICULO_CUENTA, @IMPUESTO, @FACTOR_EMPAQUE, @CODIGO_BARRAS_VENT, @CODIGO_BARRAS_INVT, @ACTIVO, @USA_LOTES, @PROVEEDOR, @ARTICULO_DEL_PROV, @UNIDAD_ALMACEN, @UNIDAD_EMPAQUE, @UNIDAD_VENTA, @USA_NUMEROS_SERIE, @CODIGO_RETENCION, @COSTO_FISCAL, @COSTO_COMPARATIVO, @COSTO_PROM_LOC, @COSTO_PROM_DOL, @COSTO_STD_LOC, @COSTO_STD_DOL, @COSTO_ULT_LOC, @COSTO_ULT_DOL, @RETENCION_VENTA, @RETENCION_COMPRA, @MODELO_RETENCION
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			IF (NOT UPDATE(RECORDDATE)  AND
      			(UPDATE(ARTICULO)
				OR UPDATE(PLANTILLA_SERIE)
      			OR UPDATE(DESCRIPCION)
      			OR UPDATE(CLASIFICACION_1)
      			OR UPDATE(CLASIFICACION_2)
      			OR UPDATE(CLASIFICACION_3)
      			OR UPDATE(CLASIFICACION_4)
      			OR UPDATE(CLASIFICACION_5)
      			OR UPDATE(CLASIFICACION_6)
      			OR UPDATE(ARTICULO_CUENTA)
      			OR UPDATE(TIPO)
      			OR UPDATE(IMPUESTO)
      			OR UPDATE(FACTOR_EMPAQUE)
      			OR UPDATE(CODIGO_BARRAS_VENT)
      			OR UPDATE(CODIGO_BARRAS_INVT)
      			OR UPDATE(ACTIVO)
      			OR UPDATE(USA_LOTES)
      			OR UPDATE(PROVEEDOR)
      			OR UPDATE(ARTICULO_DEL_PROV)
      			OR UPDATE(UNIDAD_ALMACEN)
      			OR UPDATE(UNIDAD_EMPAQUE)
      			OR UPDATE(UNIDAD_VENTA) 
			OR UPDATE (USA_NUMEROS_SERIE)
			OR UPDATE (CODIGO_RETENCION)
			OR (UPDATE (COSTO_FISCAL) AND @VENDER_POR_DEBAJO_COSTO = 'N') 
			OR (UPDATE (COSTO_COMPARATIVO) AND @VENDER_POR_DEBAJO_COSTO = 'N') 
			OR (UPDATE (COSTO_PROM_LOC) AND @VENDER_POR_DEBAJO_COSTO = 'N') 
			OR (UPDATE (COSTO_PROM_DOL) AND @VENDER_POR_DEBAJO_COSTO = 'N') 
			OR (UPDATE (COSTO_STD_LOC) AND @VENDER_POR_DEBAJO_COSTO = 'N') 
			OR (UPDATE (COSTO_STD_DOL) AND @VENDER_POR_DEBAJO_COSTO = 'N') 
			OR (UPDATE (COSTO_ULT_LOC) AND @VENDER_POR_DEBAJO_COSTO = 'N') 
			OR (UPDATE (COSTO_ULT_DOL) AND @VENDER_POR_DEBAJO_COSTO = 'N')
			OR UPDATE(RETENCION_VENTA) 
			OR UPDATE(RETENCION_COMPRA) 
			OR UPDATE(MODELO_RETENCION)  ))
      			BEGIN
				SELECT @COL_ROWPOINTER = ROWPOINTER
				FROM $$Compania$$.ARTICULO WITH (NOLOCK)
				WHERE ARTICULO = @ARTICULO
				
				SET @PARAMETROS =
					'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<ARTICULO>' +
				'<ARTICULO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@ARTICULO) + '</ARTICULO>' +
				'<PLANTILLA_SERIE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@PLANTILLA_SERIE) + '</PLANTILLA_SERIE>' +
				'<DESCRIPCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DESCRIPCION) + '</DESCRIPCION>' +
				'<CLASIFICACION_1 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CLASIFICACION_1) + '</CLASIFICACION_1>' +
				'<CLASIFICACION_2 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CLASIFICACION_2) + '</CLASIFICACION_2>' +
				'<CLASIFICACION_3 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CLASIFICACION_3) + '</CLASIFICACION_3>' +
				'<CLASIFICACION_4 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CLASIFICACION_4) + '</CLASIFICACION_4>' +
				'<CLASIFICACION_5 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CLASIFICACION_5) + '</CLASIFICACION_5>' +
				'<CLASIFICACION_6 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CLASIFICACION_6) + '</CLASIFICACION_6>' +
				'<TIPO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO) + '</TIPO>' +
				'<ARTICULO_CUENTA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ARTICULO_CUENTA) + '</ARTICULO_CUENTA>' +
				'<IMPUESTO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@IMPUESTO) + '</IMPUESTO>' +
				'<FACTOR_EMPAQUE Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@FACTOR_EMPAQUE) + '</FACTOR_EMPAQUE>' +
				'<CODIGO_BARRAS_VENT Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CODIGO_BARRAS_VENT) + '</CODIGO_BARRAS_VENT>' +
				'<CODIGO_BARRAS_INVT Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CODIGO_BARRAS_INVT) + '</CODIGO_BARRAS_INVT>' +
				'<ACTIVO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ACTIVO) + '</ACTIVO>' +
				'<USA_LOTES Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USA_LOTES) + '</USA_LOTES>' +
				'<PROVEEDOR Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@PROVEEDOR) + '</PROVEEDOR>' +
				'<ARTICULO_DEL_PROV Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ARTICULO_DEL_PROV) + '</ARTICULO_DEL_PROV>' +
				'<UNIDAD_ALMACEN Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@UNIDAD_ALMACEN) + '</UNIDAD_ALMACEN>' +
				'<UNIDAD_EMPAQUE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@UNIDAD_EMPAQUE) + '</UNIDAD_EMPAQUE>' +
				'<UNIDAD_VENTA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@UNIDAD_VENTA) + '</UNIDAD_VENTA>' +
				'<USA_NUMEROS_SERIE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USA_NUMEROS_SERIE) + '</USA_NUMEROS_SERIE>' +
				'<CODIGO_RETENCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CODIGO_RETENCION) + '</CODIGO_RETENCION>' + 
				'<COSTO_FISCAL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@COSTO_FISCAL) + '</COSTO_FISCAL>' +
				'<COSTO_COMPARATIVO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@COSTO_COMPARATIVO) + '</COSTO_COMPARATIVO>' +
				'<COSTO_PROM_LOC Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@COSTO_PROM_LOC) + '</COSTO_PROM_LOC>' +
				'<COSTO_PROM_DOL Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@COSTO_PROM_DOL) + '</COSTO_PROM_DOL>' +
				'<COSTO_STD_LOC Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@COSTO_STD_LOC) + '</COSTO_STD_LOC>' +
				'<COSTO_STD_DOL Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@COSTO_STD_DOL) + '</COSTO_STD_DOL>' +
				'<COSTO_ULT_LOC Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@COSTO_ULT_LOC) + '</COSTO_ULT_LOC>' +
				'<COSTO_ULT_DOL Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@COSTO_ULT_DOL) + '</COSTO_ULT_DOL>' +
				'<RETENCION_VENTA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@RETENCION_VENTA) + '</RETENCION_VENTA>' + 
				'<RETENCION_COMPRA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@RETENCION_COMPRA) + '</RETENCION_COMPRA>' + 
				'<MODELO_RETENCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@MODELO_RETENCION) + '</MODELO_RETENCION>' + 				
				'</ARTICULO>'
				-- inserta la solicitud correspondiente
				EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'DIVISIONGEOGRAFICA1POS600', 'MODIFICA', @PARAMETROS, @ACTUALIZAR_SOLICITUD, @COL_ROWPOINTER
			END
			FETCH NEXT FROM C_MODIFIED
			INTO @ARTICULO, @PLANTILLA_SERIE, @DESCRIPCION, @CLASIFICACION_1, @CLASIFICACION_2, @CLASIFICACION_3, @CLASIFICACION_4, @CLASIFICACION_5, @CLASIFICACION_6, @TIPO, @ARTICULO_CUENTA, @IMPUESTO, @FACTOR_EMPAQUE, @CODIGO_BARRAS_VENT, @CODIGO_BARRAS_INVT, @ACTIVO, @USA_LOTES, @PROVEEDOR, @ARTICULO_DEL_PROV, @UNIDAD_ALMACEN, @UNIDAD_EMPAQUE, @UNIDAD_VENTA, @USA_NUMEROS_SERIE, @CODIGO_RETENCION, @COSTO_FISCAL, @COSTO_COMPARATIVO, @COSTO_PROM_LOC, @COSTO_PROM_DOL, @COSTO_STD_LOC, @COSTO_STD_DOL, @COSTO_ULT_LOC, @COSTO_ULT_DOL, @RETENCION_VENTA, @RETENCION_COMPRA, @MODELO_RETENCION
		END
		CLOSE C_MODIFIED
		DEALLOCATE C_MODIFIED
	END
	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para modificar la tabla ARTICULO.',16,1 )
	END
END;





CREATE TRIGGER $$Compania$$.ARTICULO_CUENTA_POS_INS
ON $$Compania$$.ARTICULO_CUENTA
FOR INSERT
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @ARTICULO_CUENTA VARCHAR(4)
	DECLARE @DESCRIPCION VARCHAR(40)
	DECLARE @CTR_INVENTARIO VARCHAR(25)
	DECLARE @CTA_INVENTARIO VARCHAR(25)
	DECLARE @CTR_VENTAS_LOC VARCHAR(25)
	DECLARE @CTA_VENTAS_LOC VARCHAR(25)
	DECLARE @CTR_VENTAS_EXP VARCHAR(25)
	DECLARE @CTA_VENTAS_EXP VARCHAR(25)
	DECLARE @CTR_COMPRA_LOC VARCHAR(25)
	DECLARE @CTA_COMPRA_LOC VARCHAR(25)
	DECLARE @CTR_COMPRA_IMP VARCHAR(25)
	DECLARE @CTA_COMPRA_IMP VARCHAR(25)
	DECLARE @CTR_DESC_VENTA_LOC VARCHAR(25)
	DECLARE @CTA_DESC_VENTA_LOC VARCHAR(25)
	DECLARE @CTR_DESC_VENTA_EXP VARCHAR(25)
	DECLARE @CTA_DESC_VENTA_EXP VARCHAR(25)
	DECLARE @CTR_COST_VENTA_LOC VARCHAR(25)
	DECLARE @CTA_COST_VENTA_LOC VARCHAR(25)
	DECLARE @CTR_COST_VENTA_EXP VARCHAR(25)
	DECLARE @CTA_COST_VENTA_EXP VARCHAR(25)
	DECLARE @CTR_COMS_VENTA_LOC VARCHAR(25)
	DECLARE @CTA_COMS_VENTA_LOC VARCHAR(25)
	DECLARE @CTR_COMS_VENTA_EXP VARCHAR(25)
	DECLARE @CTA_COMS_VENTA_EXP VARCHAR(25)
	DECLARE @CTR_COMS_COBRO_LOC VARCHAR(25)
	DECLARE @CTA_COMS_COBRO_LOC VARCHAR(25)
	DECLARE @CTR_COMS_COBRO_EXP VARCHAR(25)
	DECLARE @CTA_COMS_COBRO_EXP VARCHAR(25)
	DECLARE @CTR_DESC_LINEA_LOC VARCHAR(25)
	DECLARE @CTA_DESC_LINEA_LOC VARCHAR(25)
	DECLARE @CTR_DESC_LINEA_EXP VARCHAR(25)
	DECLARE @CTA_DESC_LINEA_EXP VARCHAR(25)
	DECLARE @CTR_COST_DESC_LOC VARCHAR(25)
	DECLARE @CTA_COST_DESC_LOC VARCHAR(25)
	DECLARE @CTR_COST_DESC_EXP VARCHAR(25)
	DECLARE @CTA_COST_DESC_EXP VARCHAR(25)
	DECLARE @CTR_SOBR_INVENTFIS VARCHAR(25)
	DECLARE @CTA_SOBR_INVENTFIS VARCHAR(25)
	DECLARE @CTR_FALT_INVENTFIS VARCHAR(25)
	DECLARE @CTA_FALT_INVENTFIS VARCHAR(25)
	DECLARE @CTR_VARIA_COSTO VARCHAR(25)
	DECLARE @CTA_VARIA_COSTO VARCHAR(25)
	DECLARE @CTR_VENCIMIENTO VARCHAR(25)
	DECLARE @CTA_VENCIMIENTO VARCHAR(25)
	DECLARE @CTR_SOBRANTE_REMIS VARCHAR(25)
	DECLARE @CTA_SOBRANTE_REMIS VARCHAR(25)
	DECLARE @CTR_FALTANTE_REMIS VARCHAR(25)
	DECLARE @CTA_FALTANTE_REMIS VARCHAR(25)
	DECLARE @CTR_INV_REMITIDO VARCHAR(25)
	DECLARE @CTA_INV_REMITIDO VARCHAR(25)
	DECLARE @CTR_MAT_PROCESO VARCHAR(25)
	DECLARE @CTA_MAT_PROCESO VARCHAR(25)
	DECLARE @CTR_CONS_NORMAL VARCHAR(25)
	DECLARE @CTA_CONS_NORMAL VARCHAR(25)
	DECLARE @CTR_CONS_RETRABAJO VARCHAR(25)
	DECLARE @CTA_CONS_RETRABAJO VARCHAR(25)
	DECLARE @CTR_CONS_GASTO VARCHAR(25)
	DECLARE @CTA_CONS_GASTO VARCHAR(25)
	DECLARE @CTR_CONS_DESPERDIC VARCHAR(25)
	DECLARE @CTA_CONS_DESPERDIC VARCHAR(25)
	DECLARE @CTR_DESC_BONIF_LOC VARCHAR(25)
	DECLARE @CTA_DESC_BONIF_LOC VARCHAR(25)
	DECLARE @CTR_DESC_BONIF_EXP VARCHAR(25)
	DECLARE @CTA_DESC_BONIF_EXP VARCHAR(25)
	DECLARE @CTR_DEV_VENTAS_LOC VARCHAR(25)
	DECLARE @CTA_DEV_VENTAS_LOC VARCHAR(25)
	DECLARE @CTR_DEV_VENTAS_EXP VARCHAR(25)
	DECLARE @CTA_DEV_VENTAS_EXP VARCHAR(25)
	
	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_INSERTED CURSOR LOCAL FOR
		SELECT ARTICULO_CUENTA, DESCRIPCION, CTR_INVENTARIO, CTA_INVENTARIO, CTR_VENTAS_LOC, CTA_VENTAS_LOC, CTR_VENTAS_EXP, CTA_VENTAS_EXP, CTR_COMPRA_LOC, CTA_COMPRA_LOC, CTR_COMPRA_IMP, CTA_COMPRA_IMP, CTR_DESC_VENTA_LOC, CTA_DESC_VENTA_LOC, CTR_DESC_VENTA_EXP, CTA_DESC_VENTA_EXP, CTR_COST_VENTA_LOC, CTA_COST_VENTA_LOC, CTR_COST_VENTA_EXP, CTA_COST_VENTA_EXP, CTR_COMS_VENTA_LOC, CTA_COMS_VENTA_LOC, CTR_COMS_VENTA_EXP, CTA_COMS_VENTA_EXP, CTR_COMS_COBRO_LOC, CTA_COMS_COBRO_LOC, CTR_COMS_COBRO_EXP, CTA_COMS_COBRO_EXP, CTR_DESC_LINEA_LOC, CTA_DESC_LINEA_LOC, CTR_DESC_LINEA_EXP, CTA_DESC_LINEA_EXP, CTR_COST_DESC_LOC, CTA_COST_DESC_LOC, CTR_COST_DESC_EXP, CTA_COST_DESC_EXP, CTR_SOBR_INVENTFIS, CTA_SOBR_INVENTFIS, CTR_FALT_INVENTFIS, CTA_FALT_INVENTFIS, CTR_VARIA_COSTO, CTA_VARIA_COSTO, CTR_VENCIMIENTO, CTA_VENCIMIENTO, CTR_SOBRANTE_REMIS, CTA_SOBRANTE_REMIS, CTR_FALTANTE_REMIS, CTA_FALTANTE_REMIS, CTR_INV_REMITIDO, CTA_INV_REMITIDO, CTR_MAT_PROCESO, CTA_MAT_PROCESO, CTR_CONS_NORMAL, CTA_CONS_NORMAL, CTR_CONS_RETRABAJO, CTA_CONS_RETRABAJO, CTR_CONS_GASTO, CTA_CONS_GASTO, CTR_CONS_DESPERDIC, CTA_CONS_DESPERDIC, CTR_DESC_BONIF_LOC, CTA_DESC_BONIF_LOC, CTR_DESC_BONIF_EXP, CTA_DESC_BONIF_EXP, CTR_DEV_VENTAS_LOC, CTA_DEV_VENTAS_LOC, CTR_DEV_VENTAS_EXP, CTA_DEV_VENTAS_EXP
		FROM INSERTED i
		WHERE 0 = (
				SELECT COUNT('n')
				FROM DELETED d
				WHERE i.ARTICULO_CUENTA = d.ARTICULO_CUENTA
			   )
			
		OPEN C_INSERTED	
		FETCH NEXT FROM C_INSERTED INTO
		@ARTICULO_CUENTA, @DESCRIPCION, @CTR_INVENTARIO, @CTA_INVENTARIO, @CTR_VENTAS_LOC, @CTA_VENTAS_LOC, @CTR_VENTAS_EXP, @CTA_VENTAS_EXP, @CTR_COMPRA_LOC, @CTA_COMPRA_LOC, @CTR_COMPRA_IMP, @CTA_COMPRA_IMP, @CTR_DESC_VENTA_LOC, @CTA_DESC_VENTA_LOC, @CTR_DESC_VENTA_EXP, @CTA_DESC_VENTA_EXP, @CTR_COST_VENTA_LOC, @CTA_COST_VENTA_LOC, @CTR_COST_VENTA_EXP, @CTA_COST_VENTA_EXP, @CTR_COMS_VENTA_LOC, @CTA_COMS_VENTA_LOC, @CTR_COMS_VENTA_EXP, @CTA_COMS_VENTA_EXP, @CTR_COMS_COBRO_LOC, @CTA_COMS_COBRO_LOC, @CTR_COMS_COBRO_EXP, @CTA_COMS_COBRO_EXP, @CTR_DESC_LINEA_LOC, @CTA_DESC_LINEA_LOC, @CTR_DESC_LINEA_EXP, @CTA_DESC_LINEA_EXP, @CTR_COST_DESC_LOC, @CTA_COST_DESC_LOC, @CTR_COST_DESC_EXP, @CTA_COST_DESC_EXP, @CTR_SOBR_INVENTFIS, @CTA_SOBR_INVENTFIS, @CTR_FALT_INVENTFIS, @CTA_FALT_INVENTFIS, @CTR_VARIA_COSTO, @CTA_VARIA_COSTO, @CTR_VENCIMIENTO, @CTA_VENCIMIENTO, @CTR_SOBRANTE_REMIS, @CTA_SOBRANTE_REMIS, @CTR_FALTANTE_REMIS, @CTA_FALTANTE_REMIS, @CTR_INV_REMITIDO, @CTA_INV_REMITIDO, @CTR_MAT_PROCESO, @CTA_MAT_PROCESO, @CTR_CONS_NORMAL, @CTA_CONS_NORMAL, @CTR_CONS_RETRABAJO, @CTA_CONS_RETRABAJO, @CTR_CONS_GASTO, @CTA_CONS_GASTO, @CTR_CONS_DESPERDIC, @CTA_CONS_DESPERDIC, @CTR_DESC_BONIF_LOC, @CTA_DESC_BONIF_LOC, @CTR_DESC_BONIF_EXP, @CTA_DESC_BONIF_EXP, @CTR_DEV_VENTAS_LOC, @CTA_DEV_VENTAS_LOC, @CTR_DEV_VENTAS_EXP, @CTA_DEV_VENTAS_EXP
		SET @ERROR = 0
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS =
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<ARTICULO_CUENTA>' +
				'<ARTICULO_CUENTA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@ARTICULO_CUENTA) + '</ARTICULO_CUENTA>' +
				'<DESCRIPCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DESCRIPCION) + '</DESCRIPCION>' +
				'<CTR_INVENTARIO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_INVENTARIO) + '</CTR_INVENTARIO>' +
				'<CTA_INVENTARIO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_INVENTARIO) + '</CTA_INVENTARIO>' +
				'<CTR_VENTAS_LOC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_VENTAS_LOC) + '</CTR_VENTAS_LOC>' +
				'<CTA_VENTAS_LOC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_VENTAS_LOC) + '</CTA_VENTAS_LOC>' +
				'<CTR_VENTAS_EXP Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_VENTAS_EXP) + '</CTR_VENTAS_EXP>' +
				'<CTA_VENTAS_EXP Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_VENTAS_EXP) + '</CTA_VENTAS_EXP>' +
				'<CTR_COMPRA_LOC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_COMPRA_LOC) + '</CTR_COMPRA_LOC>' +
				'<CTA_COMPRA_LOC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_COMPRA_LOC) + '</CTA_COMPRA_LOC>' +
				'<CTR_COMPRA_IMP Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_COMPRA_IMP) + '</CTR_COMPRA_IMP>' +
				'<CTA_COMPRA_IMP Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_COMPRA_IMP) + '</CTA_COMPRA_IMP>' +
				'<CTR_DESC_VENTA_LOC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_DESC_VENTA_LOC) + '</CTR_DESC_VENTA_LOC>' +
				'<CTA_DESC_VENTA_LOC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_DESC_VENTA_LOC) + '</CTA_DESC_VENTA_LOC>' +
				'<CTR_DESC_VENTA_EXP Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_DESC_VENTA_EXP) + '</CTR_DESC_VENTA_EXP>' +
				'<CTA_DESC_VENTA_EXP Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_DESC_VENTA_EXP) + '</CTA_DESC_VENTA_EXP>' +
				'<CTR_COST_VENTA_LOC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_COST_VENTA_LOC) + '</CTR_COST_VENTA_LOC>' +
				'<CTA_COST_VENTA_LOC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_COST_VENTA_LOC) + '</CTA_COST_VENTA_LOC>' +
				'<CTR_COST_VENTA_EXP Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_COST_VENTA_EXP) + '</CTR_COST_VENTA_EXP>' +
				'<CTA_COST_VENTA_EXP Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_COST_VENTA_EXP) + '</CTA_COST_VENTA_EXP>' +
				'<CTR_COMS_VENTA_LOC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_COMS_VENTA_LOC) + '</CTR_COMS_VENTA_LOC>' +
				'<CTA_COMS_VENTA_LOC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_COMS_VENTA_LOC) + '</CTA_COMS_VENTA_LOC>' +
				'<CTR_COMS_VENTA_EXP Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_COMS_VENTA_EXP) + '</CTR_COMS_VENTA_EXP>' +
				'<CTA_COMS_VENTA_EXP Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_COMS_VENTA_EXP) + '</CTA_COMS_VENTA_EXP>' +
				'<CTR_COMS_COBRO_LOC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_COMS_COBRO_LOC) + '</CTR_COMS_COBRO_LOC>' +
				'<CTA_COMS_COBRO_LOC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_COMS_COBRO_LOC) + '</CTA_COMS_COBRO_LOC>' +
				'<CTR_COMS_COBRO_EXP Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_COMS_COBRO_EXP) + '</CTR_COMS_COBRO_EXP>' +
				'<CTA_COMS_COBRO_EXP Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_COMS_COBRO_EXP) + '</CTA_COMS_COBRO_EXP>' +
				'<CTR_DESC_LINEA_LOC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_DESC_LINEA_LOC) + '</CTR_DESC_LINEA_LOC>' +
				'<CTA_DESC_LINEA_LOC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_DESC_LINEA_LOC) + '</CTA_DESC_LINEA_LOC>' +
				'<CTR_DESC_LINEA_EXP Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_DESC_LINEA_EXP) + '</CTR_DESC_LINEA_EXP>' +
				'<CTA_DESC_LINEA_EXP Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_DESC_LINEA_EXP) + '</CTA_DESC_LINEA_EXP>' +
				'<CTR_COST_DESC_LOC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_COST_DESC_LOC) + '</CTR_COST_DESC_LOC>' +
				'<CTA_COST_DESC_LOC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_COST_DESC_LOC) + '</CTA_COST_DESC_LOC>' +
				'<CTR_COST_DESC_EXP Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_COST_DESC_EXP) + '</CTR_COST_DESC_EXP>' +
				'<CTA_COST_DESC_EXP Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_COST_DESC_EXP) + '</CTA_COST_DESC_EXP>' +
				'<CTR_SOBR_INVENTFIS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_SOBR_INVENTFIS) + '</CTR_SOBR_INVENTFIS>' +
				'<CTA_SOBR_INVENTFIS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_SOBR_INVENTFIS) + '</CTA_SOBR_INVENTFIS>' +
				'<CTR_FALT_INVENTFIS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_FALT_INVENTFIS) + '</CTR_FALT_INVENTFIS>' +
				'<CTA_FALT_INVENTFIS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_FALT_INVENTFIS) + '</CTA_FALT_INVENTFIS>' +
				'<CTR_VARIA_COSTO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_VARIA_COSTO) + '</CTR_VARIA_COSTO>' +
				'<CTA_VARIA_COSTO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_VARIA_COSTO) + '</CTA_VARIA_COSTO>' +
				'<CTR_VENCIMIENTO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_VENCIMIENTO) + '</CTR_VENCIMIENTO>' +
				'<CTA_VENCIMIENTO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_VENCIMIENTO) + '</CTA_VENCIMIENTO>' +
				'<CTR_SOBRANTE_REMIS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_SOBRANTE_REMIS) + '</CTR_SOBRANTE_REMIS>' +
				'<CTA_SOBRANTE_REMIS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_SOBRANTE_REMIS) + '</CTA_SOBRANTE_REMIS>' +
				'<CTR_FALTANTE_REMIS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_FALTANTE_REMIS) + '</CTR_FALTANTE_REMIS>' +
				'<CTA_FALTANTE_REMIS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_FALTANTE_REMIS) + '</CTA_FALTANTE_REMIS>' +
				'<CTR_INV_REMITIDO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_INV_REMITIDO) + '</CTR_INV_REMITIDO>' +
				'<CTA_INV_REMITIDO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_INV_REMITIDO) + '</CTA_INV_REMITIDO>' +
				'<CTR_MAT_PROCESO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_MAT_PROCESO) + '</CTR_MAT_PROCESO>' +
				'<CTA_MAT_PROCESO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_MAT_PROCESO) + '</CTA_MAT_PROCESO>' +
				'<CTR_CONS_NORMAL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_CONS_NORMAL) + '</CTR_CONS_NORMAL>' +
				'<CTA_CONS_NORMAL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_CONS_NORMAL) + '</CTA_CONS_NORMAL>' +
				'<CTR_CONS_RETRABAJO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_CONS_RETRABAJO) + '</CTR_CONS_RETRABAJO>' +
				'<CTA_CONS_RETRABAJO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_CONS_RETRABAJO) + '</CTA_CONS_RETRABAJO>' +
				'<CTR_CONS_GASTO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_CONS_GASTO) + '</CTR_CONS_GASTO>' +
				'<CTA_CONS_GASTO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_CONS_GASTO) + '</CTA_CONS_GASTO>' +
				'<CTR_CONS_DESPERDIC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_CONS_DESPERDIC) + '</CTR_CONS_DESPERDIC>' +
				'<CTA_CONS_DESPERDIC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_CONS_DESPERDIC) + '</CTA_CONS_DESPERDIC>' +
				'<CTR_DESC_BONIF_LOC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_DESC_BONIF_LOC) + '</CTR_DESC_BONIF_LOC>' +
				'<CTA_DESC_BONIF_LOC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_DESC_BONIF_LOC) + '</CTA_DESC_BONIF_LOC>' +
				'<CTR_DESC_BONIF_EXP Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_DESC_BONIF_EXP) + '</CTR_DESC_BONIF_EXP>' +
				'<CTA_DESC_BONIF_EXP Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_DESC_BONIF_EXP) + '</CTA_DESC_BONIF_EXP>' +
				'<CTR_DEV_VENTAS_LOC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_DEV_VENTAS_LOC) + '</CTR_DEV_VENTAS_LOC>' +
				'<CTA_DEV_VENTAS_LOC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_DEV_VENTAS_LOC) + '</CTA_DEV_VENTAS_LOC>' +
				'<CTR_DEV_VENTAS_EXP Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_DEV_VENTAS_EXP) + '</CTR_DEV_VENTAS_EXP>' +
				'<CTA_DEV_VENTAS_EXP Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_DEV_VENTAS_EXP) + '</CTA_DEV_VENTAS_EXP>' +
				'</ARTICULO_CUENTA>'
			-- Inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'ARTICULOCUENTAPOS600', 'INSERTA', @PARAMETROS, 0, ''
			FETCH NEXT FROM C_INSERTED INTO
			@ARTICULO_CUENTA, @DESCRIPCION, @CTR_INVENTARIO, @CTA_INVENTARIO, @CTR_VENTAS_LOC, @CTA_VENTAS_LOC, @CTR_VENTAS_EXP, @CTA_VENTAS_EXP, @CTR_COMPRA_LOC, @CTA_COMPRA_LOC, @CTR_COMPRA_IMP, @CTA_COMPRA_IMP, @CTR_DESC_VENTA_LOC, @CTA_DESC_VENTA_LOC, @CTR_DESC_VENTA_EXP, @CTA_DESC_VENTA_EXP, @CTR_COST_VENTA_LOC, @CTA_COST_VENTA_LOC, @CTR_COST_VENTA_EXP, @CTA_COST_VENTA_EXP, @CTR_COMS_VENTA_LOC, @CTA_COMS_VENTA_LOC, @CTR_COMS_VENTA_EXP, @CTA_COMS_VENTA_EXP, @CTR_COMS_COBRO_LOC, @CTA_COMS_COBRO_LOC, @CTR_COMS_COBRO_EXP, @CTA_COMS_COBRO_EXP, @CTR_DESC_LINEA_LOC, @CTA_DESC_LINEA_LOC, @CTR_DESC_LINEA_EXP, @CTA_DESC_LINEA_EXP, @CTR_COST_DESC_LOC, @CTA_COST_DESC_LOC, @CTR_COST_DESC_EXP, @CTA_COST_DESC_EXP, @CTR_SOBR_INVENTFIS, @CTA_SOBR_INVENTFIS, @CTR_FALT_INVENTFIS, @CTA_FALT_INVENTFIS, @CTR_VARIA_COSTO, @CTA_VARIA_COSTO, @CTR_VENCIMIENTO, @CTA_VENCIMIENTO, @CTR_SOBRANTE_REMIS, @CTA_SOBRANTE_REMIS, @CTR_FALTANTE_REMIS, @CTA_FALTANTE_REMIS, @CTR_INV_REMITIDO, @CTA_INV_REMITIDO, @CTR_MAT_PROCESO, @CTA_MAT_PROCESO, @CTR_CONS_NORMAL, @CTA_CONS_NORMAL, @CTR_CONS_RETRABAJO, @CTA_CONS_RETRABAJO, @CTR_CONS_GASTO, @CTA_CONS_GASTO, @CTR_CONS_DESPERDIC, @CTA_CONS_DESPERDIC, @CTR_DESC_BONIF_LOC, @CTA_DESC_BONIF_LOC, @CTR_DESC_BONIF_EXP, @CTA_DESC_BONIF_EXP, @CTR_DEV_VENTAS_LOC, @CTA_DEV_VENTAS_LOC, @CTR_DEV_VENTAS_EXP, @CTA_DEV_VENTAS_EXP
		END
		CLOSE C_INSERTED
    		DEALLOCATE C_INSERTED
	END
	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla ARTICULO_CUENTA.',16,1 )
	END
END
;




CREATE TRIGGER $$Compania$$.ARTICULO_CUENTA_POS_DEL
ON $$Compania$$.ARTICULO_CUENTA
FOR DELETE
AS
BEGIN   	
                DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @ARTICULO_CUENTA VARCHAR(4)
	 -- Declaraciones	
	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_DELETED CURSOR LOCAL FOR
			SELECT ARTICULO_CUENTA
			FROM DELETED d
			WHERE 0 = (
				SELECT COUNT('n')
				FROM INSERTED i
				WHERE d.ARTICULO_CUENTA = i.ARTICULO_CUENTA
			   )
		OPEN C_DELETED
		FETCH NEXT FROM C_DELETED INTO
		@ARTICULO_CUENTA
		
		SET @ERROR = 0
		
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS =
								'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<ARTICULO_CUENTA>' +
				'<ARTICULO_CUENTA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@ARTICULO_CUENTA) + '</ARTICULO_CUENTA>' +
				'</ARTICULO_CUENTA>'
 -- XML
			
			-- inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'ARTICULOCUENTAPOS600', 'ELIMINA', @PARAMETROS, 0, ''
			
			FETCH NEXT FROM C_DELETED INTO
			@ARTICULO_CUENTA
		END
		CLOSE C_DELETED
		DEALLOCATE C_DELETED
	END
	
	IF (@@ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para eliminar de la tabla ARTICULO_CUENTA.',16,1 )
	END
END
;




CREATE TRIGGER $$Compania$$.ARTICULO_CUENTA_POS_MOD
ON $$Compania$$.ARTICULO_CUENTA
FOR UPDATE
AS
BEGIN   	
	DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @COL_ROWPOINTER VARCHAR(36)
	DECLARE @HAY_CAMPOS_PARA_POS BIT
	DECLARE @ACTUALIZAR_SOLICITUD BIT
	DECLARE @ARTICULO_CUENTA VARCHAR(4)
	DECLARE @DESCRIPCION VARCHAR(40)
	 -- Declaraciones
	SET @ERROR = 0
	SELECT @PUBLICADOR = SITIO_LOCAL, @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_MODIFIED CURSOR LOCAL FOR
			SELECT ARTICULO_CUENTA, DESCRIPCION
			FROM INSERTED I
		SET @ACTUALIZAR_SOLICITUD = 1
		OPEN C_MODIFIED
		FETCH NEXT FROM C_MODIFIED
		INTO @ARTICULO_CUENTA, @DESCRIPCION
		
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			IF ( NOT UPDATE(RECORDDATE) AND ( UPDATE(ARTICULO_CUENTA) OR UPDATE(DESCRIPCION)))
			BEGIN
				SELECT @COL_ROWPOINTER = ROWPOINTER
				FROM $$Compania$$.ARTICULO_CUENTA
				WHERE ARTICULO_CUENTA = @ARTICULO_CUENTA
				SET @PARAMETROS =
					'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<ARTICULO_CUENTA>' +
				'<ARTICULO_CUENTA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@ARTICULO_CUENTA) + '</ARTICULO_CUENTA>' +
				'<DESCRIPCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DESCRIPCION) + '</DESCRIPCION>' +
				'</ARTICULO_CUENTA>'
				-- inserta la solicitud correspondiente
				EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'ARTICULOCUENTAPOS600', 'MODIFICA', @PARAMETROS, @ACTUALIZAR_SOLICITUD, @COL_ROWPOINTER
			END
			FETCH NEXT FROM C_MODIFIED
			INTO @ARTICULO_CUENTA, @DESCRIPCION
		END
		CLOSE C_MODIFIED
		DEALLOCATE C_MODIFIED
	END
	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para modificar la tabla ARTICULO_CUENTA.',16,1 )
	END
END
;




CREATE TRIGGER $$Compania$$.ARTICULO_ENSAMBLE_POS_INS
ON $$Compania$$.ARTICULO_ENSAMBLE
FOR INSERT
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @ARTICULO_PADRE VARCHAR(20)
	DECLARE @ARTICULO_HIJO VARCHAR(20)
	DECLARE @CANTIDAD DECIMAL(28,8)
	
	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_INSERTED CURSOR LOCAL FOR
		SELECT ARTICULO_PADRE, ARTICULO_HIJO, CANTIDAD
		FROM INSERTED i
		WHERE 0 = (
				SELECT COUNT('n')
				FROM DELETED d
				WHERE i.ARTICULO_PADRE = d.ARTICULO_PADRE AND i.ARTICULO_HIJO = d.ARTICULO_HIJO
			   )
			
		OPEN C_INSERTED	
		FETCH NEXT FROM C_INSERTED INTO
		@ARTICULO_PADRE, @ARTICULO_HIJO, @CANTIDAD
		SET @ERROR = 0
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS =
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<ARTICULO_ENSAMBLE>' +
				'<ARTICULO_PADRE Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@ARTICULO_PADRE) + '</ARTICULO_PADRE>' +
				'<ARTICULO_HIJO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@ARTICULO_HIJO) + '</ARTICULO_HIJO>' +
				'<CANTIDAD Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@CANTIDAD) + '</CANTIDAD>' +
				'</ARTICULO_ENSAMBLE>'
			-- Inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'ARTICULOENSAMBLEPOS600', 'INSERTA', @PARAMETROS, 0, ''
			FETCH NEXT FROM C_INSERTED INTO
			@ARTICULO_PADRE, @ARTICULO_HIJO, @CANTIDAD
		END
		CLOSE C_INSERTED
    		DEALLOCATE C_INSERTED
	END
	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla ARTICULO_ENSAMBLE.',16,1 )
	END
END
;




CREATE TRIGGER $$Compania$$.ARTICULO_ENSAMBLE_POS_DEL
ON $$Compania$$.ARTICULO_ENSAMBLE
FOR DELETE
AS
BEGIN   	
                DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @ARTICULO_PADRE VARCHAR(20)
	DECLARE @ARTICULO_HIJO VARCHAR(20)
	 -- Declaraciones	
	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_DELETED CURSOR LOCAL FOR
			SELECT ARTICULO_PADRE, ARTICULO_HIJO
			FROM DELETED d
			WHERE 0 = (
				SELECT COUNT('n')
				FROM INSERTED i
				WHERE d.ARTICULO_PADRE = i.ARTICULO_PADRE AND d.ARTICULO_HIJO = i.ARTICULO_HIJO
			   )
		OPEN C_DELETED
		FETCH NEXT FROM C_DELETED INTO
		@ARTICULO_PADRE, @ARTICULO_HIJO
		
		SET @ERROR = 0
		
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS =
								'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<ARTICULO_ENSAMBLE>' +
				'<ARTICULO_PADRE Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@ARTICULO_PADRE) + '</ARTICULO_PADRE>' +
				'<ARTICULO_HIJO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@ARTICULO_HIJO) + '</ARTICULO_HIJO>' +
				'</ARTICULO_ENSAMBLE>'
 -- XML
			
			-- inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'ARTICULOENSAMBLEPOS600', 'ELIMINA', @PARAMETROS, 0, ''
			
			FETCH NEXT FROM C_DELETED INTO
			@ARTICULO_PADRE, @ARTICULO_HIJO
		END
		CLOSE C_DELETED
		DEALLOCATE C_DELETED
	END
	
	IF (@@ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para eliminar de la tabla ARTICULO_ENSAMBLE.',16,1 )
	END
END
;




CREATE TRIGGER $$Compania$$.ARTICULO_ENSAMBLE_POS_MOD
ON $$Compania$$.ARTICULO_ENSAMBLE
FOR UPDATE
AS
BEGIN   	
	DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @COL_ROWPOINTER VARCHAR(36)
	DECLARE @HAY_CAMPOS_PARA_POS BIT
	DECLARE @ACTUALIZAR_SOLICITUD BIT
	DECLARE @ARTICULO_PADRE VARCHAR(20)
	DECLARE @ARTICULO_HIJO VARCHAR(20)
	DECLARE @CANTIDAD DECIMAL(28,8)
	 -- Declaraciones
	SET @ERROR = 0
	SELECT @PUBLICADOR = SITIO_LOCAL, @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_MODIFIED CURSOR LOCAL FOR
			SELECT ARTICULO_PADRE, ARTICULO_HIJO, CANTIDAD -- Columnas
			FROM INSERTED I
		SET @ACTUALIZAR_SOLICITUD = 1
		OPEN C_MODIFIED
		FETCH NEXT FROM C_MODIFIED
		INTO @ARTICULO_PADRE, @ARTICULO_HIJO, @CANTIDAD
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			IF ( NOT UPDATE(RECORDDATE) AND ( UPDATE(ARTICULO_PADRE) OR UPDATE(ARTICULO_HIJO) OR UPDATE(CANTIDAD) ) )
			BEGIN
				SELECT @COL_ROWPOINTER = ROWPOINTER
				FROM $$Compania$$.ARTICULO_ENSAMBLE
				WHERE ARTICULO_PADRE = @ARTICULO_PADRE AND ARTICULO_HIJO = @ARTICULO_HIJO
				SET @PARAMETROS =
					'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<ARTICULO_ENSAMBLE>' +
				'<ARTICULO_PADRE Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@ARTICULO_PADRE) + '</ARTICULO_PADRE>' +
				'<ARTICULO_HIJO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@ARTICULO_HIJO) + '</ARTICULO_HIJO>' +
				'<CANTIDAD Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@CANTIDAD) + '</CANTIDAD>' +
				'</ARTICULO_ENSAMBLE>'
				-- inserta la solicitud correspondiente
				EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'ARTICULOENSAMBLEPOS600', 'MODIFICA', @PARAMETROS, @ACTUALIZAR_SOLICITUD, @COL_ROWPOINTER
			END
			FETCH NEXT FROM C_MODIFIED
			INTO @ARTICULO_PADRE, @ARTICULO_HIJO, @CANTIDAD
		END
		CLOSE C_MODIFIED
		DEALLOCATE C_MODIFIED
	END
	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para modificar la tabla ARTICULO_ENSAMBLE.',16,1 )
	END
END
;




CREATE TRIGGER $$Compania$$.ARTICULO_ESPE_POS_INS
ON $$Compania$$.ARTICULO_ESPE
FOR INSERT
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @ATRIBUTO VARCHAR(20)
	DECLARE @ARTICULO VARCHAR(25)
	DECLARE @MAXIMA DECIMAL(28,8)
	DECLARE @MINIMA DECIMAL(28,8)
	DECLARE @NORMAL DECIMAL(28,8)
	DECLARE @UNIDAD VARCHAR(6)
	DECLARE @VALOR VARCHAR(20)
	DECLARE @CHEQUEAR_INGRESO VARCHAR(1)
	DECLARE @HEREDAR_LOTES VARCHAR(1)
	
	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_INSERTED CURSOR LOCAL FOR
		SELECT ATRIBUTO, ARTICULO, MAXIMA, MINIMA, NORMAL, UNIDAD, VALOR, CHEQUEAR_INGRESO, HEREDAR_LOTES
		FROM INSERTED i
		WHERE 0 = (
				SELECT COUNT('n')
				FROM DELETED d
				WHERE i.ATRIBUTO = d.ATRIBUTO AND i.ARTICULO = d.ARTICULO
			   )
			
		OPEN C_INSERTED	
		FETCH NEXT FROM C_INSERTED INTO
		@ATRIBUTO, @ARTICULO, @MAXIMA, @MINIMA, @NORMAL, @UNIDAD, @VALOR, @CHEQUEAR_INGRESO, @HEREDAR_LOTES
		SET @ERROR = 0
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS =
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<ARTICULO_ESPE>' +
				'<ATRIBUTO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@ATRIBUTO) + '</ATRIBUTO>' +
				'<ARTICULO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@ARTICULO) + '</ARTICULO>' +
				'<MAXIMA Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@MAXIMA) + '</MAXIMA>' +
				'<MINIMA Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@MINIMA) + '</MINIMA>' +
				'<NORMAL Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@NORMAL) + '</NORMAL>' +
				'<UNIDAD Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@UNIDAD) + '</UNIDAD>' +
				'<VALOR Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@VALOR) + '</VALOR>' +
				'<CHEQUEAR_INGRESO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CHEQUEAR_INGRESO) + '</CHEQUEAR_INGRESO>' +
				'<HEREDAR_LOTES Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@HEREDAR_LOTES) + '</HEREDAR_LOTES>' +
				'</ARTICULO_ESPE>'
			-- Inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'ARTICULOESPEPOS600', 'INSERTA', @PARAMETROS, 0, ''
			FETCH NEXT FROM C_INSERTED INTO
			@ATRIBUTO, @ARTICULO, @MAXIMA, @MINIMA, @NORMAL, @UNIDAD, @VALOR, @CHEQUEAR_INGRESO, @HEREDAR_LOTES
		END
		CLOSE C_INSERTED
    		DEALLOCATE C_INSERTED
	END
	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla ARTICULO_ESPE.',16,1 )
	END
END
;




CREATE TRIGGER $$Compania$$.ARTICULO_ESPE_POS_DEL
ON $$Compania$$.ARTICULO_ESPE
FOR DELETE
AS
BEGIN   	
                DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @ATRIBUTO VARCHAR(20)
	DECLARE @ARTICULO VARCHAR(25)
	-- Declaraciones	
	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_DELETED CURSOR LOCAL FOR
			SELECT ATRIBUTO, ARTICULO
			FROM DELETED d
			WHERE 0 = (
				SELECT COUNT('n')
				FROM INSERTED i
				WHERE d.ATRIBUTO = i.ATRIBUTO AND d.ARTICULO = i.ARTICULO
			   )
		OPEN C_DELETED
		FETCH NEXT FROM C_DELETED INTO
		@ATRIBUTO, @ARTICULO
		
		SET @ERROR = 0
		
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS =
								'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<ARTICULO_ESPE>' +
				'<ATRIBUTO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@ATRIBUTO) + '</ATRIBUTO>' +
				'<ARTICULO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@ARTICULO) + '</ARTICULO>' +
				'</ARTICULO_ESPE>'
 -- XML
			
			-- inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'ARTICULOESPEPOS600', 'ELIMINA', @PARAMETROS, 0, ''
			
			FETCH NEXT FROM C_DELETED INTO
			@ATRIBUTO, @ARTICULO
		END
		CLOSE C_DELETED
		DEALLOCATE C_DELETED
	END
	
	IF (@@ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para eliminar de la tabla ARTICULO_ESPE.',16,1 )
	END
END
;




CREATE TRIGGER $$Compania$$.ARTICULO_ESPE_POS_MOD
ON $$Compania$$.ARTICULO_ESPE
FOR UPDATE
AS
BEGIN   	
	DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @COL_ROWPOINTER VARCHAR(36)
	DECLARE @HAY_CAMPOS_PARA_POS BIT
	DECLARE @ACTUALIZAR_SOLICITUD BIT
	DECLARE @ATRIBUTO VARCHAR(20)
	DECLARE @ARTICULO VARCHAR(25)
	DECLARE @VALOR VARCHAR(20)
	 -- Declaraciones
	SET @ERROR = 0
	SELECT @PUBLICADOR = SITIO_LOCAL, @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_MODIFIED CURSOR LOCAL FOR
			SELECT ATRIBUTO, ARTICULO, VALOR
			FROM INSERTED I
		SET @ACTUALIZAR_SOLICITUD = 1
		OPEN C_MODIFIED
		FETCH NEXT FROM C_MODIFIED
		INTO @ATRIBUTO, @ARTICULO, @VALOR
		
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			IF ( NOT UPDATE(RECORDDATE) AND ( UPDATE(ATRIBUTO) OR UPDATE(ARTICULO)OR UPDATE(VALOR)) )
			BEGIN
				SELECT @COL_ROWPOINTER = ROWPOINTER
				FROM $$Compania$$.ARTICULO_ESPE
				WHERE ATRIBUTO = @ATRIBUTO AND ARTICULO = @ARTICULO
				SET @PARAMETROS =
					'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<ARTICULO_ESPE>' +
				'<ATRIBUTO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@ATRIBUTO) + '</ATRIBUTO>' +
				'<ARTICULO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@ARTICULO) + '</ARTICULO>' +
				'<VALOR Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@VALOR) + '</VALOR>' +
				'</ARTICULO_ESPE>'
				-- inserta la solicitud correspondiente
				EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'ARTICULOESPEPOS600', 'MODIFICA', @PARAMETROS, @ACTUALIZAR_SOLICITUD, @COL_ROWPOINTER
			END
			FETCH NEXT FROM C_MODIFIED
			INTO @ATRIBUTO, @ARTICULO, @VALOR
		END
		CLOSE C_MODIFIED
		DEALLOCATE C_MODIFIED
	END
	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para modificar la tabla ARTICULO_ESPE.',16,1 )
	END
END;




CREATE TRIGGER $$Compania$$.ARTICULO_PRECIO_POS_INS
ON $$Compania$$.ARTICULO_PRECIO
FOR INSERT
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @MODULO_OFFLINE INT
	DECLARE @NIVEL_PRECIO VARCHAR(12)
	DECLARE @MONEDA VARCHAR(1)
	DECLARE @VERSION INT
	DECLARE @ARTICULO VARCHAR(20)
	DECLARE @VERSION_ARTICULO INT
	DECLARE @PRECIO DECIMAL(28,8)
	DECLARE @ESQUEMA_TRABAJO VARCHAR(1)
	DECLARE @MARGEN_MULR DECIMAL(28,8)
	DECLARE @MARGEN_UTILIDAD DECIMAL(28,8)
	DECLARE @FECHA_INICIO DATETIME
	DECLARE @FECHA_FIN DATETIME
	DECLARE @FECHA_ULT_MODIF DATETIME
	DECLARE @USUARIO_ULT_MODIF VARCHAR(25)
	DECLARE @MARGEN_UTILIDAD_MIN DECIMAL(28,8)
	
	
	SELECT @MODULO_OFFLINE = COUNT(0)
	FROM ERPADMIN.MODULO_INSTALADO
	WHERE CONJUNTO = '$$Compania$$'
	AND ACCION = 3159

	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM 
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF @MODULO_OFFLINE  = 1 AND NOT (SYSTEM_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_INSERTED CURSOR LOCAL FOR
		SELECT NIVEL_PRECIO, MONEDA, VERSION, ARTICULO, VERSION_ARTICULO, PRECIO, ESQUEMA_TRABAJO, MARGEN_MULR, MARGEN_UTILIDAD, FECHA_INICIO, FECHA_FIN, FECHA_ULT_MODIF, USUARIO_ULT_MODIF, MARGEN_UTILIDAD_MIN
		FROM INSERTED
				
		OPEN C_INSERTED	
		FETCH NEXT FROM C_INSERTED INTO
		@NIVEL_PRECIO, @MONEDA, @VERSION, @ARTICULO, @VERSION_ARTICULO, @PRECIO, @ESQUEMA_TRABAJO, @MARGEN_MULR, @MARGEN_UTILIDAD, @FECHA_INICIO, @FECHA_FIN, @FECHA_ULT_MODIF, @USUARIO_ULT_MODIF, @MARGEN_UTILIDAD_MIN

		SET @ERROR = 0
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS = 
			'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<ARTICULO_PRECIO>' + 
				'<NIVEL_PRECIO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@NIVEL_PRECIO) + '</NIVEL_PRECIO>' + 
				'<MONEDA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@MONEDA) + '</MONEDA>' + 
				'<VERSION Type="INT" PrimaryKey="True">' + ERPADMIN.POS_NumberToVarchar(@VERSION) + '</VERSION>' + 
				'<ARTICULO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@ARTICULO) + '</ARTICULO>' + 
				'<VERSION_ARTICULO Type="INT" PrimaryKey="True">' + ERPADMIN.POS_NumberToVarchar(@VERSION_ARTICULO) + '</VERSION_ARTICULO>' + 
				'<PRECIO Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@PRECIO) + '</PRECIO>' + 
				'<ESQUEMA_TRABAJO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ESQUEMA_TRABAJO) + '</ESQUEMA_TRABAJO>' + 
				'<MARGEN_MULR Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@MARGEN_MULR) + '</MARGEN_MULR>' + 
				'<MARGEN_UTILIDAD Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@MARGEN_UTILIDAD) + '</MARGEN_UTILIDAD>' + 
				'<FECHA_INICIO Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_INICIO) + '</FECHA_INICIO>' + 
				'<FECHA_FIN Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_FIN) + '</FECHA_FIN>' + 
				'<FECHA_ULT_MODIF Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_ULT_MODIF) + '</FECHA_ULT_MODIF>' + 
				'<USUARIO_ULT_MODIF Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USUARIO_ULT_MODIF) + '</USUARIO_ULT_MODIF>' + 
				'<MARGEN_UTILIDAD_MIN Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@MARGEN_UTILIDAD_MIN) + '</MARGEN_UTILIDAD_MIN>' + 
				'</ARTICULO_PRECIO>'


			-- Inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'ARTICULOPRECIOPOS600', 'INSERTA', @PARAMETROS, 0, ''

			FETCH NEXT FROM C_INSERTED INTO
			@NIVEL_PRECIO, @MONEDA, @VERSION, @ARTICULO, @VERSION_ARTICULO, @PRECIO, @ESQUEMA_TRABAJO, @MARGEN_MULR, @MARGEN_UTILIDAD, @FECHA_INICIO, @FECHA_FIN, @FECHA_ULT_MODIF, @USUARIO_ULT_MODIF, @MARGEN_UTILIDAD_MIN
		END

		CLOSE C_INSERTED
    		DEALLOCATE C_INSERTED
	END

	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla ARTICULO_PRECIO.',16,1 )
	END
END;





CREATE TRIGGER $$Compania$$.ARTICULO_PRECIO_POS_DEL
ON $$Compania$$.ARTICULO_PRECIO
FOR DELETE
AS
BEGIN   	
                DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @NIVEL_PRECIO VARCHAR(12)
	DECLARE @MONEDA VARCHAR(1)
	DECLARE @VERSION INT
	DECLARE @ARTICULO VARCHAR(20)
	DECLARE @VERSION_ARTICULO INT
	-- Declaraciones	
	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_DELETED CURSOR LOCAL FOR
			SELECT NIVEL_PRECIO, MONEDA, VERSION, ARTICULO, VERSION_ARTICULO
			FROM DELETED d
			WHERE 0 = (
				SELECT COUNT('n')
				FROM INSERTED i
				WHERE d.NIVEL_PRECIO = i.NIVEL_PRECIO AND d.MONEDA = i.MONEDA AND d.VERSION = i.VERSION AND d.ARTICULO = i.ARTICULO AND d.VERSION_ARTICULO = i.VERSION_ARTICULO
			   )
		OPEN C_DELETED
		FETCH NEXT FROM C_DELETED INTO
		@NIVEL_PRECIO, @MONEDA, @VERSION, @ARTICULO, @VERSION_ARTICULO
		
		SET @ERROR = 0
		
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS =
								'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<ARTICULO_PRECIO>' +
				'<NIVEL_PRECIO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@NIVEL_PRECIO) + '</NIVEL_PRECIO>' +
				'<MONEDA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@MONEDA) + '</MONEDA>' +
				'<VERSION Type="INT" PrimaryKey="True">' + ERPADMIN.POS_NumberToVarchar(@VERSION) + '</VERSION>' +
				'<ARTICULO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@ARTICULO) + '</ARTICULO>' +
				'<VERSION_ARTICULO Type="INT" PrimaryKey="True">' + ERPADMIN.POS_NumberToVarchar(@VERSION_ARTICULO) + '</VERSION_ARTICULO>' +
				'</ARTICULO_PRECIO>'
 -- XML
			
			-- inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'ARTICULOPRECIOPOS600', 'ELIMINA', @PARAMETROS, 0, ''
			
			FETCH NEXT FROM C_DELETED INTO
			@NIVEL_PRECIO, @MONEDA, @VERSION, @ARTICULO, @VERSION_ARTICULO
		END
		CLOSE C_DELETED
		DEALLOCATE C_DELETED
	END
	
	IF (@@ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para eliminar de la tabla ARTICULO_PRECIO.',16,1 )
	END
END;




CREATE TRIGGER $$Compania$$.ARTICULO_PRECIO_POS_MOD
ON $$Compania$$.ARTICULO_PRECIO
FOR UPDATE
AS 
BEGIN   	
	DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @COL_ROWPOINTER VARCHAR(36)
	DECLARE @HAY_CAMPOS_PARA_POS BIT
	DECLARE @ACTUALIZAR_SOLICITUD BIT
	DECLARE @MODULO_OFFLINE INT
	DECLARE @NIVEL_PRECIO VARCHAR(12)
	DECLARE @MONEDA VARCHAR(1)
	DECLARE @VERSION INT
	DECLARE @ARTICULO VARCHAR(20)
	DECLARE @VERSION_ARTICULO INT
	DECLARE @PRECIO DECIMAL(28,8)
	DECLARE @ESQUEMA_TRABAJO VARCHAR(1)
	DECLARE @MARGEN_MULR DECIMAL(28,8)
	DECLARE @MARGEN_UTILIDAD DECIMAL(28,8)
	DECLARE @FECHA_INICIO DATETIME
	DECLARE @FECHA_FIN DATETIME
	DECLARE @FECHA_ULT_MODIF DATETIME
	DECLARE @USUARIO_ULT_MODIF VARCHAR(25)
	DECLARE @MARGEN_UTILIDAD_MIN DECIMAL(28,8)
	 -- Declaraciones

	SET @ERROR = 0
	
	SELECT @MODULO_OFFLINE = COUNT(0)
	FROM ERPADMIN.MODULO_INSTALADO
	WHERE CONJUNTO = '$$Compania$$'
	AND ACCION = 3159

	SELECT @PUBLICADOR = SITIO_LOCAL, @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF @MODULO_OFFLINE  = 1 AND NOT (SYSTEM_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_MODIFIED CURSOR LOCAL FOR
			SELECT NIVEL_PRECIO, MONEDA, VERSION, ARTICULO, VERSION_ARTICULO, PRECIO, ESQUEMA_TRABAJO, MARGEN_MULR, MARGEN_UTILIDAD, FECHA_INICIO, FECHA_FIN, FECHA_ULT_MODIF, USUARIO_ULT_MODIF, MARGEN_UTILIDAD_MIN -- Columnas
			FROM INSERTED I

		SET @ACTUALIZAR_SOLICITUD = 1

		OPEN C_MODIFIED

		FETCH NEXT FROM C_MODIFIED
		INTO @NIVEL_PRECIO, @MONEDA, @VERSION, @ARTICULO, @VERSION_ARTICULO, @PRECIO, @ESQUEMA_TRABAJO, @MARGEN_MULR, @MARGEN_UTILIDAD, @FECHA_INICIO, @FECHA_FIN, @FECHA_ULT_MODIF, @USUARIO_ULT_MODIF, @MARGEN_UTILIDAD_MIN

		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			IF ( NOT UPDATE(RECORDDATE) AND ( UPDATE(NIVEL_PRECIO) OR UPDATE(MONEDA) OR UPDATE(VERSION) OR UPDATE(ARTICULO) OR UPDATE(VERSION_ARTICULO) OR UPDATE(PRECIO) OR UPDATE(ESQUEMA_TRABAJO) OR UPDATE(MARGEN_MULR) OR UPDATE(MARGEN_UTILIDAD) OR UPDATE(FECHA_INICIO) OR UPDATE(FECHA_FIN) OR UPDATE(FECHA_ULT_MODIF) OR UPDATE(USUARIO_ULT_MODIF) OR UPDATE(MARGEN_UTILIDAD_MIN) ) )
			BEGIN

				SELECT @COL_ROWPOINTER = ROWPOINTER 
				FROM $$Compania$$.ARTICULO_PRECIO
				WHERE NIVEL_PRECIO = @NIVEL_PRECIO AND MONEDA = @MONEDA AND VERSION = @VERSION AND ARTICULO = @ARTICULO AND VERSION_ARTICULO = @VERSION_ARTICULO 

				SET @PARAMETROS =
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<ARTICULO_PRECIO>' + 
				'<NIVEL_PRECIO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@NIVEL_PRECIO) + '</NIVEL_PRECIO>' + 
				'<MONEDA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@MONEDA) + '</MONEDA>' + 
				'<VERSION Type="INT" PrimaryKey="True">' + ERPADMIN.POS_NumberToVarchar(@VERSION) + '</VERSION>' + 
				'<ARTICULO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@ARTICULO) + '</ARTICULO>' + 
				'<VERSION_ARTICULO Type="INT" PrimaryKey="True">' + ERPADMIN.POS_NumberToVarchar(@VERSION_ARTICULO) + '</VERSION_ARTICULO>' + 
				'<PRECIO Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@PRECIO) + '</PRECIO>' + 
				'<ESQUEMA_TRABAJO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ESQUEMA_TRABAJO) + '</ESQUEMA_TRABAJO>' + 
				'<MARGEN_MULR Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@MARGEN_MULR) + '</MARGEN_MULR>' + 
				'<MARGEN_UTILIDAD Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@MARGEN_UTILIDAD) + '</MARGEN_UTILIDAD>' + 
				'<FECHA_INICIO Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_INICIO) + '</FECHA_INICIO>' + 
				'<FECHA_FIN Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_FIN) + '</FECHA_FIN>' + 
				'<FECHA_ULT_MODIF Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_ULT_MODIF) + '</FECHA_ULT_MODIF>' + 
				'<USUARIO_ULT_MODIF Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USUARIO_ULT_MODIF) + '</USUARIO_ULT_MODIF>' + 
				'<MARGEN_UTILIDAD_MIN Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@MARGEN_UTILIDAD_MIN) + '</MARGEN_UTILIDAD_MIN>' + 
				'</ARTICULO_PRECIO>'


				-- inserta la solicitud correspondiente
				EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'ARTICULOPRECIOPOS600', 'MODIFICA', @PARAMETROS, @ACTUALIZAR_SOLICITUD, @COL_ROWPOINTER
			END

			FETCH NEXT FROM C_MODIFIED
			INTO @NIVEL_PRECIO, @MONEDA, @VERSION, @ARTICULO, @VERSION_ARTICULO, @PRECIO, @ESQUEMA_TRABAJO, @MARGEN_MULR, @MARGEN_UTILIDAD, @FECHA_INICIO, @FECHA_FIN, @FECHA_ULT_MODIF, @USUARIO_ULT_MODIF, @MARGEN_UTILIDAD_MIN
		END

		CLOSE C_MODIFIED
		DEALLOCATE C_MODIFIED
	END

	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para modificar la tabla ARTICULO_PRECIO.',16,1 )
	END
END;




CREATE TRIGGER $$Compania$$.ARTICULO_SERIE_POS_POS_INS
ON $$Compania$$.ARTICULO_SERIE_POS
FOR INSERT
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @LINEA VARCHAR(4)
	DECLARE @DOCUMENTO VARCHAR(20)
	DECLARE @CAJA VARCHAR(6)
	DECLARE @TIPO VARCHAR(1)
	DECLARE @LINEA_SERIE INT
	DECLARE @ARTICULO VARCHAR(20)
	DECLARE @SERIE_INICIAL VARCHAR(20)
	DECLARE @SERIE_FINAL VARCHAR(20)
	DECLARE @CANTIDAD DECIMAL(28,8)
	DECLARE @CANT_RESERVADA_PED 	DECIMAL(28,8)	
	DECLARE @BODEGA 				VARCHAR(4) 		
	DECLARE @PEDIDO 				VARCHAR(20) 	
	
	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_INSERTED CURSOR LOCAL FOR
		SELECT LINEA, DOCUMENTO, CAJA, TIPO, LINEA_SERIE, ARTICULO, SERIE_INICIAL, SERIE_FINAL, CANTIDAD, CANT_RESERVADA_PED, BODEGA, PEDIDO 
		FROM INSERTED i
		WHERE 0 = (
				SELECT COUNT('n')
				FROM DELETED d
				WHERE i.LINEA = d.LINEA AND i.DOCUMENTO = d.DOCUMENTO AND i.CAJA = d.CAJA AND i.TIPO = d.TIPO AND i.LINEA_SERIE = d.LINEA_SERIE
			   )
			
		OPEN C_INSERTED	
		FETCH NEXT FROM C_INSERTED INTO
		@LINEA, @DOCUMENTO, @CAJA, @TIPO, @LINEA_SERIE, @ARTICULO, @SERIE_INICIAL, @SERIE_FINAL, @CANTIDAD, @CANT_RESERVADA_PED, @BODEGA, @PEDIDO
		SET @ERROR = 0
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS =
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<ARTICULO_SERIE_POS>' +
				'<LINEA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@LINEA) + '</LINEA>' +
				'<DOCUMENTO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@DOCUMENTO) + '</DOCUMENTO>' +
				'<CAJA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CAJA) + '</CAJA>' +
				'<TIPO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO) + '</TIPO>' +
				'<LINEA_SERIE Type="INT" PrimaryKey="True">' + ERPADMIN.POS_NumberToVarchar(@LINEA_SERIE) + '</LINEA_SERIE>' +
				'<ARTICULO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ARTICULO) + '</ARTICULO>' +
				'<SERIE_INICIAL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@SERIE_INICIAL) + '</SERIE_INICIAL>' +
				'<SERIE_FINAL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@SERIE_FINAL) + '</SERIE_FINAL>' +
				'<CANTIDAD Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@CANTIDAD) + '</CANTIDAD>' +
				'<CANT_RESERVADA_PED Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@CANT_RESERVADA_PED) + '</CANT_RESERVADA_PED>' +
				'<BODEGA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@BODEGA) + '</BODEGA>' +
				'<PEDIDO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@PEDIDO) + '</PEDIDO>' +
				'</ARTICULO_SERIE_POS>'
			-- Inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'ARTICULOSERIEPOSPOS600', 'INSERTA', @PARAMETROS, 0, ''
			FETCH NEXT FROM C_INSERTED INTO
			@LINEA, @DOCUMENTO, @CAJA, @TIPO, @LINEA_SERIE, @ARTICULO, @SERIE_INICIAL, @SERIE_FINAL, @CANTIDAD, @CANT_RESERVADA_PED, @BODEGA, @PEDIDO
		END
		CLOSE C_INSERTED
    		DEALLOCATE C_INSERTED
	END
	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla ARTICULO_SERIE_POS.',16,1 )
	END
END
;




CREATE TRIGGER $$Compania$$.ARTICULO_SERIE_POS_POS_DEL
ON $$Compania$$.ARTICULO_SERIE_POS
FOR DELETE
AS
BEGIN   	
                DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @LINEA VARCHAR(4)
	DECLARE @DOCUMENTO VARCHAR(20)
	DECLARE @CAJA VARCHAR(6)
	DECLARE @TIPO VARCHAR(1)
	DECLARE @LINEA_SERIE INT
	-- Declaraciones	
	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_DELETED CURSOR LOCAL FOR
			SELECT LINEA, DOCUMENTO, CAJA, TIPO, LINEA_SERIE
			FROM DELETED d
			WHERE 0 = (
				SELECT COUNT('n')
				FROM INSERTED i
				WHERE d.LINEA = i.LINEA AND d.DOCUMENTO = i.DOCUMENTO AND d.CAJA = i.CAJA AND d.TIPO = i.TIPO AND d.LINEA_SERIE = i.LINEA_SERIE
			   )
		OPEN C_DELETED
		FETCH NEXT FROM C_DELETED INTO
		@LINEA, @DOCUMENTO, @CAJA, @TIPO, @LINEA_SERIE -- VARIABLES
		
		SET @ERROR = 0
		
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS =
								'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<ARTICULO_SERIE_POS>' +
				'<LINEA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@LINEA) + '</LINEA>' +
				'<DOCUMENTO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@DOCUMENTO) + '</DOCUMENTO>' +
				'<CAJA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CAJA) + '</CAJA>' +
				'<TIPO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO) + '</TIPO>' +
				'<LINEA_SERIE Type="INT" PrimaryKey="True">' + ERPADMIN.POS_NumberToVarchar(@LINEA_SERIE) + '</LINEA_SERIE>' +
				'</ARTICULO_SERIE_POS>'

			
			-- inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'ARTICULOSERIEPOSPOS600', 'ELIMINA', @PARAMETROS, 0, ''
			
			FETCH NEXT FROM C_DELETED INTO
			@LINEA, @DOCUMENTO, @CAJA, @TIPO, @LINEA_SERIE -- VARIABLES
		END
		CLOSE C_DELETED
		DEALLOCATE C_DELETED
	END
	
	IF (@@ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para eliminar de la tabla ARTICULO_SERIE_POS.',16,1 )
	END
END
;




CREATE TRIGGER $$Compania$$.ARTICULO_SERIE_POS_POS_MOD
ON $$Compania$$.ARTICULO_SERIE_POS
FOR UPDATE
AS
BEGIN   	
	DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @COL_ROWPOINTER VARCHAR(36)
	DECLARE @HAY_CAMPOS_PARA_POS BIT
	DECLARE @ACTUALIZAR_SOLICITUD BIT
	DECLARE @LINEA VARCHAR(4)
	DECLARE @DOCUMENTO VARCHAR(20)
	DECLARE @CAJA VARCHAR(6)
	DECLARE @TIPO VARCHAR(1)
	DECLARE @LINEA_SERIE INT
	DECLARE @ARTICULO VARCHAR(20)
	DECLARE @SERIE_INICIAL VARCHAR(20)
	DECLARE @SERIE_FINAL VARCHAR(20)
	DECLARE @CANTIDAD DECIMAL(28, 8)
	DECLARE @CANT_RESERVADA_PED 	DECIMAL(28,8)	
	DECLARE @BODEGA 				VARCHAR(4) 		
	DECLARE @PEDIDO 				VARCHAR(20) 
	 -- Declaraciones
	SET @ERROR = 0
	SELECT @PUBLICADOR = SITIO_LOCAL, @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_MODIFIED CURSOR LOCAL FOR
			SELECT LINEA, DOCUMENTO, CAJA, TIPO, LINEA_SERIE, ARTICULO, SERIE_INICIAL, SERIE_FINAL, CANTIDAD, CANT_RESERVADA_PED, BODEGA, PEDIDO -- Columnas
			FROM INSERTED I
		SET @ACTUALIZAR_SOLICITUD = 1
		OPEN C_MODIFIED
		FETCH NEXT FROM C_MODIFIED
		INTO @LINEA, @DOCUMENTO, @CAJA, @TIPO, @LINEA_SERIE, @ARTICULO, @SERIE_INICIAL, @SERIE_FINAL, @CANTIDAD, @CANT_RESERVADA_PED, @BODEGA, @PEDIDO
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			IF ( NOT UPDATE(RECORDDATE) AND ( UPDATE(LINEA) OR UPDATE(DOCUMENTO) OR UPDATE(CAJA) OR UPDATE(TIPO) OR UPDATE(LINEA_SERIE) OR UPDATE(ARTICULO) OR UPDATE(SERIE_INICIAL) OR UPDATE(SERIE_FINAL) OR UPDATE(CANTIDAD) OR UPDATE(CANT_RESERVADA_PED) OR UPDATE(BODEGA) OR UPDATE(PEDIDO)) )
			BEGIN
				SELECT @COL_ROWPOINTER = ROWPOINTER
				FROM $$Compania$$.ARTICULO_SERIE_POS
				WHERE LINEA = @LINEA AND DOCUMENTO = @DOCUMENTO AND CAJA = @CAJA AND TIPO = @TIPO AND LINEA_SERIE = @LINEA_SERIE
				SET @PARAMETROS =
					'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<ARTICULO_SERIE_POS>' +
				'<LINEA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@LINEA) + '</LINEA>' +
				'<DOCUMENTO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@DOCUMENTO) + '</DOCUMENTO>' +
				'<CAJA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CAJA) + '</CAJA>' +
				'<TIPO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO) + '</TIPO>' +
				'<LINEA_SERIE Type="INT" PrimaryKey="True">' + ERPADMIN.POS_NumberToVarchar(@LINEA_SERIE) + '</LINEA_SERIE>' +
				'<ARTICULO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ARTICULO) + '</ARTICULO>' +
				'<SERIE_INICIAL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@SERIE_INICIAL) + '</SERIE_INICIAL>' +
				'<SERIE_FINAL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@SERIE_FINAL) + '</SERIE_FINAL>' +
				'<CANTIDAD Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@CANTIDAD) + '</CANTIDAD>' +
				'<CANT_RESERVADA_PED Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@CANT_RESERVADA_PED) + '</CANT_RESERVADA_PED>' +
				'<BODEGA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@BODEGA) + '</BODEGA>' +
				'<PEDIDO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@PEDIDO) + '</PEDIDO>' +
				'</ARTICULO_SERIE_POS>'
				-- inserta la solicitud correspondiente
				EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'ARTICULOSERIEPOSPOS600', 'MODIFICA', @PARAMETROS, @ACTUALIZAR_SOLICITUD, @COL_ROWPOINTER
			END
			FETCH NEXT FROM C_MODIFIED
			INTO @LINEA, @DOCUMENTO, @CAJA, @TIPO, @LINEA_SERIE, @ARTICULO, @SERIE_INICIAL, @SERIE_FINAL, @CANTIDAD, @CANT_RESERVADA_PED, @BODEGA, @PEDIDO
		END
		CLOSE C_MODIFIED
		DEALLOCATE C_MODIFIED
	END
	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para modificar la tabla ARTICULO_SERIE_POS.',16,1 )
	END
END
;



CREATE TRIGGER $$Compania$$.AUXILIAR_POS_POS_INS
ON $$Compania$$.AUXILIAR_POS
FOR INSERT
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @TIPO_SITIO_LOCAL VARCHAR(1)
	DECLARE @DOCUMENTO VARCHAR(50)
	DECLARE @CAJA VARCHAR(6)
	DECLARE @TIPO VARCHAR(1)
	DECLARE @DOCUM_APLICA VARCHAR(50)
	DECLARE @CAJA_DOCUM_APLICA VARCHAR(6)
	DECLARE @TIPO_APLICA VARCHAR(1)
	DECLARE @MONTO_APLICADO DECIMAL(28,8)
	DECLARE @CARGADO VARCHAR(1)
	DECLARE @FECHA_APLICACION DATETIME
	DECLARE @DOC_CC_APLICADO VARCHAR(50)
	DECLARE @TIPO_DOC_CC_APLICADO 	VARCHAR(3)
	DECLARE @CARGADO_CG VARCHAR(1)
	DECLARE @ASIENTO_APLICACION VARCHAR(10)

	SELECT 	@PUBLICADOR = SITIO_LOCAL,
		@USUARIO_POS_WSQM = USUARIO_WSQM,
		@TIPO_SITIO_LOCAL = TIPO_SITIO_LOCAL
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM) AND @TIPO_SITIO_LOCAL = 'T'
	BEGIN
		DECLARE C_INSERTED CURSOR LOCAL FOR
		SELECT DOCUMENTO, CAJA, TIPO, DOCUM_APLICA, CAJA_DOCUM_APLICA, TIPO_APLICA, MONTO_APLICADO, CARGADO, FECHA_APLICACION, DOC_CC_APLICADO, TIPO_DOC_CC_APLICADO, CARGADO_CG, ASIENTO_APLICACION
		FROM INSERTED i
		WHERE 0 = (
				SELECT COUNT('n')
				FROM DELETED d
				WHERE i.DOCUM_APLICA = d.DOCUM_APLICA AND i.CAJA_DOCUM_APLICA = d.CAJA_DOCUM_APLICA AND i.TIPO_APLICA = d.TIPO_APLICA
			   )
			
		OPEN C_INSERTED	
		FETCH NEXT FROM C_INSERTED INTO
		@DOCUMENTO, @CAJA, @TIPO, @DOCUM_APLICA, @CAJA_DOCUM_APLICA, @TIPO_APLICA,  @MONTO_APLICADO, @CARGADO, @FECHA_APLICACION, @DOC_CC_APLICADO, @TIPO_DOC_CC_APLICADO, @CARGADO_CG, @ASIENTO_APLICACION 
		SET @ERROR = 0
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS =
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<AUXILIAR_POS>' +
				'<DOCUMENTO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@DOCUMENTO) + '</DOCUMENTO>' +
				'<CAJA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CAJA) + '</CAJA>' +
				'<TIPO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO) + '</TIPO>' +
				'<DOCUM_APLICA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@DOCUM_APLICA) + '</DOCUM_APLICA>' +
				'<CAJA_DOCUM_APLICA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CAJA_DOCUM_APLICA) + '</CAJA_DOCUM_APLICA>' +
				'<TIPO_APLICA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_APLICA) + '</TIPO_APLICA>' +
				'<MONTO_APLICADO Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@MONTO_APLICADO) + '</MONTO_APLICADO>' +
				'<CARGADO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CARGADO) + '</CARGADO>' +
				'<FECHA_APLICACION Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_APLICACION) + '</FECHA_APLICACION>' + 
				'<DOC_CC_APLICADO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DOC_CC_APLICADO) + '</DOC_CC_APLICADO>' +
				'<TIPO_DOC_CC_APLICADO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_DOC_CC_APLICADO) + '</TIPO_DOC_CC_APLICADO>' +				
				'<CARGADO_CG Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CARGADO_CG) + '</CARGADO_CG>' +
				'<ASIENTO_APLICACION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ASIENTO_APLICACION) + '</ASIENTO_APLICACION>' +				
				'</AUXILIAR_POS>'
			-- Inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'AUXILIARPOSPOS600', 'INSERTA', @PARAMETROS, 0, ''
			FETCH NEXT FROM C_INSERTED INTO
			@DOCUMENTO, @CAJA, @TIPO, @DOCUM_APLICA, @CAJA_DOCUM_APLICA, @TIPO_APLICA,  @MONTO_APLICADO, @CARGADO, @FECHA_APLICACION, @DOC_CC_APLICADO, @TIPO_DOC_CC_APLICADO, @CARGADO_CG, @ASIENTO_APLICACION 
		END
		CLOSE C_INSERTED
    		DEALLOCATE C_INSERTED
	END
	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla AUXILIAR_POS.',16,1 )
	END
END;






CREATE TRIGGER $$Compania$$.AUXILIAR_POS_POS_DEL
ON $$Compania$$.AUXILIAR_POS
FOR DELETE
AS
BEGIN   	
    DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @TIPO_SITIO_LOCAL VARCHAR(1)
	DECLARE @DOCUM_APLICA VARCHAR(50)
	DECLARE @CAJA_DOCUM_APLICA VARCHAR(6)
	DECLARE @TIPO_APLICA VARCHAR(1)
    DECLARE @DOCUMENTO VARCHAR(50)
    DECLARE @CAJA VARCHAR(6)
	DECLARE @TIPO VARCHAR(1)
	 -- Declaraciones	
	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM ,
		@TIPO_SITIO_LOCAL = TIPO_SITIO_LOCAL
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM) AND @TIPO_SITIO_LOCAL = 'T'
	BEGIN
		DECLARE C_DELETED CURSOR LOCAL FOR
			SELECT DOCUMENTO, CAJA, TIPO, DOCUM_APLICA, CAJA_DOCUM_APLICA, TIPO_APLICA
			FROM DELETED d
			WHERE 0 = (
				SELECT COUNT('n')
				FROM INSERTED i
				WHERE d.DOCUMENTO = i.DOCUMENTO AND 
                      d.CAJA = i.CAJA AND 
                      d.TIPO = i.TIPO AND
                      d.DOCUM_APLICA = i.DOCUM_APLICA AND 
                      d.CAJA_DOCUM_APLICA = i.CAJA_DOCUM_APLICA AND 
                      d.TIPO_APLICA = i.TIPO_APLICA
			   )
		OPEN C_DELETED
		FETCH NEXT FROM C_DELETED INTO
		@DOCUMENTO, @CAJA, @TIPO, @DOCUM_APLICA, @CAJA_DOCUM_APLICA, @TIPO_APLICA -- VARIABLES
		
		SET @ERROR = 0
		
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS =
								'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<AUXILIAR_POS>' +
				'<DOCUMENTO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@DOCUMENTO) + '</DOCUMENTO>' +
				'<CAJA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CAJA) + '</CAJA>' +
				'<TIPO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO) + '</TIPO>' +
				'<DOCUM_APLICA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@DOCUM_APLICA) + '</DOCUM_APLICA>' +
				'<CAJA_DOCUM_APLICA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CAJA_DOCUM_APLICA) + '</CAJA_DOCUM_APLICA>' +
				'<TIPO_APLICA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_APLICA) + '</TIPO_APLICA>' +
				'</AUXILIAR_POS>'
 -- XML
			
			-- inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'AUXILIARPOSPOS600', 'ELIMINA', @PARAMETROS, 0, ''
			
			FETCH NEXT FROM C_DELETED INTO
			@DOCUMENTO, @CAJA, @TIPO, @DOCUM_APLICA, @CAJA_DOCUM_APLICA, @TIPO_APLICA -- VARIABLES
		END
		CLOSE C_DELETED
		DEALLOCATE C_DELETED
	END
	
	IF (@@ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para eliminar de la tabla AUXILIAR_POS.',16,1 )
	END
END;


CREATE TRIGGER $$Compania$$.AUXILIAR_POS_POS_MOD
ON $$Compania$$.AUXILIAR_POS
FOR UPDATE
AS
BEGIN                  
	DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @TIPO_SITIO_LOCAL VARCHAR(1)
	DECLARE @COL_ROWPOINTER VARCHAR(36)
	DECLARE @HAY_CAMPOS_PARA_POS BIT
	DECLARE @ACTUALIZAR_SOLICITUD BIT
	DECLARE @DOCUMENTO VARCHAR(50)
	DECLARE @CAJA VARCHAR(6)
	DECLARE @TIPO VARCHAR(1)
	DECLARE @DOCUM_APLICA VARCHAR(50)
	DECLARE @CAJA_DOCUM_APLICA VARCHAR(6)
	DECLARE @TIPO_APLICA VARCHAR(1)
	DECLARE @MONTO_APLICADO DECIMAL(28,8)
	DECLARE @CARGADO VARCHAR(1)
	DECLARE @FECHA_APLICACION DATETIME
	DECLARE @DOC_CC_APLICADO VARCHAR(50)
	DECLARE @TIPO_DOC_CC_APLICADO VARCHAR(3)
	DECLARE @CARGADO_CG VARCHAR(1)
	DECLARE @ASIENTO_APLICACION VARCHAR(10)

	-- Declaraciones

	SET @ERROR = 0
	SELECT @PUBLICADOR = SITIO_LOCAL, @USUARIO_POS_WSQM = USUARIO_WSQM,
	       @TIPO_SITIO_LOCAL = TIPO_SITIO_LOCAL
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM) AND @TIPO_SITIO_LOCAL = 'T'
	BEGIN
	       DECLARE C_MODIFIED CURSOR LOCAL FOR
			       SELECT DOCUMENTO, CAJA, TIPO, DOCUM_APLICA, CAJA_DOCUM_APLICA, TIPO_APLICA, MONTO_APLICADO, CARGADO, FECHA_APLICACION, DOC_CC_APLICADO, TIPO_DOC_CC_APLICADO, CARGADO_CG, ASIENTO_APLICACION
			       FROM INSERTED I
	       SET @ACTUALIZAR_SOLICITUD = 1
	       OPEN C_MODIFIED
	       FETCH NEXT FROM C_MODIFIED
	       INTO @DOCUMENTO, @CAJA, @TIPO, @DOCUM_APLICA, @CAJA_DOCUM_APLICA, @TIPO_APLICA, @MONTO_APLICADO, @CARGADO, @FECHA_APLICACION, @DOC_CC_APLICADO, @TIPO_DOC_CC_APLICADO, @CARGADO_CG, @ASIENTO_APLICACION
	       WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
	       BEGIN
			       IF ( NOT UPDATE(RECORDDATE) AND ( UPDATE(DOCUMENTO) OR UPDATE(CAJA) OR UPDATE(TIPO) OR UPDATE(DOCUM_APLICA) OR UPDATE(CAJA_DOCUM_APLICA) OR UPDATE(TIPO_APLICA) OR UPDATE(MONTO_APLICADO) OR UPDATE(CARGADO) OR UPDATE(FECHA_APLICACION) OR UPDATE(DOC_CC_APLICADO) OR UPDATE(TIPO_DOC_CC_APLICADO) OR UPDATE(CARGADO_CG) OR UPDATE(ASIENTO_APLICACION)) )
			       BEGIN
					       SELECT @COL_ROWPOINTER = ROWPOINTER
					       FROM $$Compania$$.AUXILIAR_POS
					       WHERE DOCUM_APLICA = @DOCUM_APLICA AND CAJA_DOCUM_APLICA = @CAJA_DOCUM_APLICA AND TIPO_APLICA = @TIPO_APLICA
					       SET @PARAMETROS =
					       '<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
					       '<AUXILIAR_POS>' +
					       '<DOCUMENTO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@DOCUMENTO) + '</DOCUMENTO>' +
					      '<CAJA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CAJA) + '</CAJA>' +
					       '<TIPO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO) + '</TIPO>' +
					       '<DOCUM_APLICA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@DOCUM_APLICA) + '</DOCUM_APLICA>' +
					       '<CAJA_DOCUM_APLICA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CAJA_DOCUM_APLICA) + '</CAJA_DOCUM_APLICA>' +
					       '<TIPO_APLICA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_APLICA) + '</TIPO_APLICA>' +
					       '<MONTO_APLICADO Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@MONTO_APLICADO) + '</MONTO_APLICADO>' +
					       '<CARGADO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CARGADO) + '</CARGADO>' +
					       '<FECHA_APLICACION Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_APLICACION) + '</FECHA_APLICACION>'

					       IF @TIPO_SITIO_LOCAL = 'C' 
							      SET @PARAMETROS = @PARAMETROS +
							      '<DOC_CC_APLICADO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DOC_CC_APLICADO) + '</DOC_CC_APLICADO>' +
							      '<TIPO_DOC_CC_APLICADO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_DOC_CC_APLICADO) + '</TIPO_DOC_CC_APLICADO>' +
							      '<CARGADO_CG Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CARGADO_CG) + '</CARGADO_CG>' +
							      '<ASIENTO_APLICACION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ASIENTO_APLICACION) + '</ASIENTO_APLICACION>'

					       SET @PARAMETROS = @PARAMETROS + '</AUXILIAR_POS>'

					       -- inserta la solicitud correspondiente
					       EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'AUXILIARPOSPOS600', 'MODIFICA', @PARAMETROS, @ACTUALIZAR_SOLICITUD, @COL_ROWPOINTER
			       END
			       FETCH NEXT FROM C_MODIFIED
			       INTO @DOCUMENTO, @CAJA, @TIPO, @DOCUM_APLICA, @CAJA_DOCUM_APLICA, @TIPO_APLICA, @MONTO_APLICADO, @CARGADO, @FECHA_APLICACION, @DOC_CC_APLICADO, @TIPO_DOC_CC_APLICADO, @CARGADO_CG, @ASIENTO_APLICACION
	       END
	       CLOSE C_MODIFIED
	       DEALLOCATE C_MODIFIED
	END
	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
	       RAISERROR( 'Error generando la solicitud de servicio para modificar la tabla AUXILIAR_POS.',16,1 )
	END
END;





CREATE TRIGGER $$Compania$$.BITACORA_POS_INS
ON $$Compania$$.BITACORA
FOR INSERT
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @TIPO_SITIO_LOCAL VARCHAR(1)
	DECLARE @FECHA DATETIME
	DECLARE @CAJERO VARCHAR(25)
	DECLARE @CAJA VARCHAR(6)
	DECLARE @CAJA_DOC VARCHAR(6)
	DECLARE @DOCUMENTO VARCHAR(50)
	DECLARE @TIPO VARCHAR(1)
	DECLARE @SUPERVISOR VARCHAR(25)
	DECLARE @EVENTO VARCHAR(4)
	DECLARE @CANTIDAD DECIMAL(28,8)
	DECLARE @TIPO_REG VARCHAR(1)
	DECLARE @OBSERVACIONES VARCHAR(4000)
	
	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM ,
		@TIPO_SITIO_LOCAL = TIPO_SITIO_LOCAL
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM) AND @TIPO_SITIO_LOCAL = 'T'
	BEGIN
		DECLARE C_INSERTED CURSOR LOCAL FOR
		SELECT FECHA, CAJERO, CAJA, CAJA_DOC, DOCUMENTO, TIPO, SUPERVISOR, EVENTO, CANTIDAD, TIPO_REG, OBSERVACIONES
		FROM INSERTED i
		WHERE 0 = (
				SELECT COUNT('n')
				FROM DELETED d
				WHERE i.RowPointer = d.RowPointer
			   )
			
		OPEN C_INSERTED	
		FETCH NEXT FROM C_INSERTED INTO
		@FECHA, @CAJERO, @CAJA, @CAJA_DOC, @DOCUMENTO, @TIPO, @SUPERVISOR, @EVENTO, @CANTIDAD, @TIPO_REG, @OBSERVACIONES
		SET @ERROR = 0
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS =
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<BITACORA>' +
				'<FECHA Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA) + '</FECHA>' +
				'<CAJERO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CAJERO) + '</CAJERO>' +
				'<CAJA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CAJA) + '</CAJA>' +
				'<CAJA_DOC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CAJA_DOC) + '</CAJA_DOC>' +
				'<DOCUMENTO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DOCUMENTO) + '</DOCUMENTO>' +
				'<TIPO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO) + '</TIPO>' +
				'<SUPERVISOR Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@SUPERVISOR) + '</SUPERVISOR>' +
				'<EVENTO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@EVENTO) + '</EVENTO>' +
				'<CANTIDAD Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@CANTIDAD) + '</CANTIDAD>' +
				'<TIPO_REG Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_REG) + '</TIPO_REG>' +
				'<OBSERVACIONES Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@OBSERVACIONES) + '</OBSERVACIONES>' +
				'</BITACORA>'
			-- Inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'BITACORAPOS600', 'INSERTA', @PARAMETROS, 0, ''
			FETCH NEXT FROM C_INSERTED INTO
			@FECHA, @CAJERO, @CAJA, @CAJA_DOC, @DOCUMENTO, @TIPO, @SUPERVISOR, @EVENTO, @CANTIDAD, @TIPO_REG, @OBSERVACIONES
		END
		CLOSE C_INSERTED
    		DEALLOCATE C_INSERTED
	END
	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla BITACORA.',16,1 )
	END
END;





CREATE TRIGGER $$Compania$$.BITACORA_POS_DEL
ON $$Compania$$.BITACORA
FOR DELETE
AS
BEGIN   	
        DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @TIPO_SITIO_LOCAL VARCHAR(1)
	DECLARE @FECHA DATETIME
	DECLARE @CAJERO VARCHAR(25)
	DECLARE @CAJA VARCHAR(6)
	DECLARE @CAJA_DOC VARCHAR(6)
	DECLARE @DOCUMENTO VARCHAR(50)
	DECLARE @TIPO VARCHAR(1)
	DECLARE @SUPERVISOR VARCHAR(25)
	DECLARE @EVENTO VARCHAR(4)
	DECLARE @CANTIDAD DECIMAL(28,8)
	DECLARE @TIPO_REG VARCHAR(1)
	DECLARE @OBSERVACIONES VARCHAR(4000)
	 -- Declaraciones	
	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM ,
		@TIPO_SITIO_LOCAL = TIPO_SITIO_LOCAL
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)  AND @TIPO_SITIO_LOCAL = 'T'
	BEGIN
		DECLARE C_DELETED CURSOR LOCAL FOR
			SELECT FECHA, CAJERO, CAJA, CAJA_DOC, DOCUMENTO, TIPO, SUPERVISOR, EVENTO, CANTIDAD, TIPO_REG, OBSERVACIONES
			FROM DELETED d
			WHERE 0 = (
				SELECT COUNT('n')
				FROM INSERTED i
				WHERE d.RowPointer = i.RowPointer
			   )
		OPEN C_DELETED
		FETCH NEXT FROM C_DELETED INTO
		@FECHA, @CAJERO, @CAJA, @CAJA_DOC, @DOCUMENTO, @TIPO, @SUPERVISOR, @EVENTO, @CANTIDAD, @TIPO_REG, @OBSERVACIONES -- VARIABLES
		
		SET @ERROR = 0
		
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS =
								'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<BITACORA>' +
				'<FECHA Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA) + '</FECHA>' +
				'<CAJERO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CAJERO) + '</CAJERO>' +
				'<CAJA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CAJA) + '</CAJA>' +
				'<CAJA_DOC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CAJA_DOC) + '</CAJA_DOC>' +
				'<DOCUMENTO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DOCUMENTO) + '</DOCUMENTO>' +
				'<TIPO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO) + '</TIPO>' +
				'<SUPERVISOR Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@SUPERVISOR) + '</SUPERVISOR>' +
				'<EVENTO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@EVENTO) + '</EVENTO>' +
				'<CANTIDAD Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@CANTIDAD) + '</CANTIDAD>' +
				'<TIPO_REG Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_REG) + '</TIPO_REG>' +
				'<OBSERVACIONES Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@OBSERVACIONES) + '</OBSERVACIONES>' +
				'</BITACORA>'
 -- XML
			
			-- inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'BITACORAPOS600', 'ELIMINA', @PARAMETROS, 0, ''
			
			FETCH NEXT FROM C_DELETED INTO
			@FECHA, @CAJERO, @CAJA, @CAJA_DOC, @DOCUMENTO, @TIPO, @SUPERVISOR, @EVENTO, @CANTIDAD, @TIPO_REG, @OBSERVACIONES -- VARIABLES
		END
		CLOSE C_DELETED
		DEALLOCATE C_DELETED
	END
	
	IF (@@ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para eliminar de la tabla BITACORA.',16,1 )
	END
END;




CREATE TRIGGER $$Compania$$.BITACORA_POS_MOD
ON $$Compania$$.BITACORA
FOR UPDATE
AS
BEGIN   	
	DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @TIPO_SITIO_LOCAL VARCHAR(1)
	DECLARE @HAY_CAMPOS_PARA_POS BIT
	DECLARE @ACTUALIZAR_SOLICITUD BIT
	DECLARE @FECHA DATETIME
	DECLARE @CAJERO VARCHAR(25)
	DECLARE @CAJA VARCHAR(6)
	DECLARE @CAJA_DOC VARCHAR(6)
	DECLARE @DOCUMENTO VARCHAR(50)
	DECLARE @TIPO VARCHAR(1)
	DECLARE @SUPERVISOR VARCHAR(25)
	DECLARE @EVENTO VARCHAR(4)
	DECLARE @CANTIDAD DECIMAL(28,8)
	DECLARE @TIPO_REG VARCHAR(1)
	DECLARE @OBSERVACIONES VARCHAR(4000)
	 -- Declaraciones
	SET @ERROR = 0
	SELECT @PUBLICADOR = SITIO_LOCAL, @USUARIO_POS_WSQM = USUARIO_WSQM,
		@TIPO_SITIO_LOCAL = TIPO_SITIO_LOCAL
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)  AND @TIPO_SITIO_LOCAL = 'T'
	BEGIN
		DECLARE C_MODIFIED CURSOR LOCAL FOR
			SELECT FECHA, CAJERO, CAJA, CAJA_DOC, DOCUMENTO, TIPO, SUPERVISOR, EVENTO, CANTIDAD, TIPO_REG, OBSERVACIONES -- Columnas
			FROM INSERTED I
		SET @ACTUALIZAR_SOLICITUD = 0
		OPEN C_MODIFIED
		FETCH NEXT FROM C_MODIFIED
		INTO @FECHA, @CAJERO, @CAJA, @CAJA_DOC, @DOCUMENTO, @TIPO, @SUPERVISOR, @EVENTO, @CANTIDAD, @TIPO_REG, @OBSERVACIONES
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			IF ( NOT UPDATE(RECORDDATE) AND ( UPDATE(FECHA) OR UPDATE(CAJERO) OR UPDATE(CAJA) OR UPDATE(CAJA_DOC) OR UPDATE(DOCUMENTO) OR UPDATE(TIPO) OR UPDATE(SUPERVISOR) OR UPDATE(EVENTO) OR UPDATE(CANTIDAD) OR UPDATE(TIPO_REG) OR UPDATE(OBSERVACIONES) ) )
			BEGIN
				SET @PARAMETROS =
					'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<BITACORA>' +
				'<FECHA Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA) + '</FECHA>' +
				'<CAJERO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CAJERO) + '</CAJERO>' +
				'<CAJA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CAJA) + '</CAJA>' +
				'<CAJA_DOC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CAJA_DOC) + '</CAJA_DOC>' +
				'<DOCUMENTO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DOCUMENTO) + '</DOCUMENTO>' +
				'<TIPO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO) + '</TIPO>' +
				'<SUPERVISOR Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@SUPERVISOR) + '</SUPERVISOR>' +
				'<EVENTO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@EVENTO) + '</EVENTO>' +
				'<CANTIDAD Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@CANTIDAD) + '</CANTIDAD>' +
				'<TIPO_REG Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_REG) + '</TIPO_REG>' +
				'<OBSERVACIONES Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@OBSERVACIONES) + '</OBSERVACIONES>' +
				'</BITACORA>'
				-- inserta la solicitud correspondiente
				EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'BITACORAPOS600', 'MODIFICA', @PARAMETROS, @ACTUALIZAR_SOLICITUD, NULL
			END
			FETCH NEXT FROM C_MODIFIED
			INTO @FECHA, @CAJERO, @CAJA, @CAJA_DOC, @DOCUMENTO, @TIPO, @SUPERVISOR, @EVENTO, @CANTIDAD, @TIPO_REG, @OBSERVACIONES
		END
		CLOSE C_MODIFIED
		DEALLOCATE C_MODIFIED
	END
	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para modificar la tabla BITACORA.',16,1 )
	END
END;





CREATE TRIGGER $$Compania$$.BODEGA_POS_INS
ON $$Compania$$.BODEGA
FOR INSERT
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @BODEGA VARCHAR(4)
	DECLARE @NOMBRE VARCHAR(40)
	DECLARE @TIPO VARCHAR(1)
	DECLARE @TELEFONO VARCHAR(15)
	DECLARE @DIRECCION VARCHAR(120)
	
	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_INSERTED CURSOR LOCAL FOR
		SELECT BODEGA, NOMBRE, TIPO, TELEFONO, DIRECCION
		FROM INSERTED i
		WHERE 0 = (
				SELECT COUNT('n')
				FROM DELETED d
				WHERE i.BODEGA = d.BODEGA
			   )
			
		OPEN C_INSERTED	
		FETCH NEXT FROM C_INSERTED INTO
		@BODEGA, @NOMBRE, @TIPO, @TELEFONO, @DIRECCION
		SET @ERROR = 0
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS =
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<BODEGA>' +
				'<BODEGA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@BODEGA) + '</BODEGA>' +
				'<NOMBRE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOMBRE) + '</NOMBRE>' +
				'<TIPO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO) + '</TIPO>' +
				'<TELEFONO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TELEFONO) + '</TELEFONO>' +
				'<DIRECCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DIRECCION) + '</DIRECCION>' +
				'</BODEGA>'
			-- Inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'BODEGAPOS600', 'INSERTA', @PARAMETROS, 0, ''
			FETCH NEXT FROM C_INSERTED INTO
			@BODEGA, @NOMBRE, @TIPO, @TELEFONO, @DIRECCION
		END
		CLOSE C_INSERTED
    		DEALLOCATE C_INSERTED
	END
	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla BODEGA.',16,1 )
	END
END
;




CREATE TRIGGER $$Compania$$.BODEGA_POS_DEL
ON $$Compania$$.BODEGA
FOR DELETE
AS
BEGIN   	
                DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @BODEGA VARCHAR(4)
	-- Declaraciones	
	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_DELETED CURSOR LOCAL FOR
			SELECT BODEGA
			FROM DELETED d
			WHERE 0 = (
				SELECT COUNT('n')
				FROM INSERTED i
				WHERE d.BODEGA = i.BODEGA
			   )
		OPEN C_DELETED
		FETCH NEXT FROM C_DELETED INTO
		@BODEGA
		
		SET @ERROR = 0
		
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS =
								'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<BODEGA>' +
				'<BODEGA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@BODEGA) + '</BODEGA>' +
				'</BODEGA>'
 -- XML
			
			-- inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'BODEGAPOS600', 'ELIMINA', @PARAMETROS, 0, ''
			
			FETCH NEXT FROM C_DELETED INTO
			@BODEGA
		END
		CLOSE C_DELETED
		DEALLOCATE C_DELETED
	END
	
	IF (@@ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para eliminar de la tabla BODEGA.',16,1 )
	END
END
;




CREATE TRIGGER $$Compania$$.BODEGA_POS_MOD
ON $$Compania$$.BODEGA
FOR UPDATE
AS
BEGIN   	
	DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @COL_ROWPOINTER VARCHAR(36)
	DECLARE @HAY_CAMPOS_PARA_POS BIT
	DECLARE @ACTUALIZAR_SOLICITUD BIT
	DECLARE @BODEGA VARCHAR(4)
	DECLARE @NOMBRE VARCHAR(40)
	DECLARE @TIPO VARCHAR(1)
	 -- Declaraciones
	SET @ERROR = 0
	SELECT @PUBLICADOR = SITIO_LOCAL, @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_MODIFIED CURSOR LOCAL FOR
			SELECT BODEGA, NOMBRE, TIPO -- Columnas
			FROM INSERTED I
		SET @ACTUALIZAR_SOLICITUD = 1
		OPEN C_MODIFIED
		FETCH NEXT FROM C_MODIFIED
		INTO @BODEGA, @NOMBRE, @TIPO
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			IF ( NOT UPDATE(RECORDDATE) AND ( UPDATE(BODEGA) OR UPDATE(NOMBRE) OR UPDATE(TIPO) ) )
			BEGIN
				SELECT @COL_ROWPOINTER = ROWPOINTER
				FROM $$Compania$$.BODEGA
				WHERE BODEGA = @BODEGA
				SET @PARAMETROS =
					'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<BODEGA>' +
				'<BODEGA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@BODEGA) + '</BODEGA>' +
				'<NOMBRE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOMBRE) + '</NOMBRE>' +
				'<TIPO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO) + '</TIPO>' +
				'</BODEGA>'
				-- inserta la solicitud correspondiente
				EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'BODEGAPOS600', 'MODIFICA', @PARAMETROS, @ACTUALIZAR_SOLICITUD, @COL_ROWPOINTER
			END
			FETCH NEXT FROM C_MODIFIED
			INTO @BODEGA, @NOMBRE, @TIPO
		END
		CLOSE C_MODIFIED
		DEALLOCATE C_MODIFIED
	END
	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para modificar la tabla BODEGA.',16,1 )
	END
END
;




CREATE TRIGGER $$Compania$$.CADENA_POS_INS
ON $$Compania$$.CADENA
FOR INSERT
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @TIPO_SITIO_LOCAL VARCHAR(1)
	DECLARE @CADENA VARCHAR(20)
	DECLARE @DESCRIPCION VARCHAR(254)
	
	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM,
		@TIPO_SITIO_LOCAL = TIPO_SITIO_LOCAL
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM) AND @TIPO_SITIO_LOCAL = 'C'
	BEGIN
		DECLARE C_INSERTED CURSOR LOCAL FOR
		SELECT CADENA, DESCRIPCION
		FROM INSERTED i
		WHERE 0 = (
				SELECT COUNT('n')
				FROM DELETED d
				WHERE i.CADENA = d.CADENA
			   )
			
		OPEN C_INSERTED	
		FETCH NEXT FROM C_INSERTED INTO
		@CADENA, @DESCRIPCION
		SET @ERROR = 0
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS =
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<CADENA>' +
				'<CADENA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CADENA) + '</CADENA>' +
				'<DESCRIPCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DESCRIPCION) + '</DESCRIPCION>' +
				'</CADENA>'
			-- Inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'CADENAPOS600', 'INSERTA', @PARAMETROS, 0, ''
			FETCH NEXT FROM C_INSERTED INTO
			@CADENA, @DESCRIPCION
		END
		CLOSE C_INSERTED
    		DEALLOCATE C_INSERTED
	END
	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla CADENA.',16,1 )
	END
END
;




CREATE TRIGGER $$Compania$$.CADENA_POS_DEL
ON $$Compania$$.CADENA
FOR DELETE
AS
BEGIN   	
                DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @TIPO_SITIO_LOCAL VARCHAR(1)
	DECLARE @CADENA VARCHAR(20)
	 -- Declaraciones	
	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM ,
		@TIPO_SITIO_LOCAL = TIPO_SITIO_LOCAL
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM) AND @TIPO_SITIO_LOCAL = 'C'
	BEGIN
		DECLARE C_DELETED CURSOR LOCAL FOR
			SELECT CADENA
			FROM DELETED d
			WHERE 0 = (
				SELECT COUNT('n')
				FROM INSERTED i
				WHERE d.CADENA = i.CADENA
			   )
		OPEN C_DELETED
		FETCH NEXT FROM C_DELETED INTO
		@CADENA
		
		SET @ERROR = 0
		
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS =
								'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<CADENA>' +
				'<CADENA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CADENA) + '</CADENA>' +
				'</CADENA>'
 -- XML
			
			-- inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'CADENAPOS600', 'ELIMINA', @PARAMETROS, 0, ''
			
			FETCH NEXT FROM C_DELETED INTO
			@CADENA
		END
		CLOSE C_DELETED
		DEALLOCATE C_DELETED
	END
	
	IF (@@ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para eliminar de la tabla CADENA.',16,1 )
	END
END
;




CREATE TRIGGER $$Compania$$.CADENA_POS_MOD
ON $$Compania$$.CADENA
FOR UPDATE
AS
BEGIN   	
	DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @TIPO_SITIO_LOCAL VARCHAR(1)
	DECLARE @COL_ROWPOINTER VARCHAR(36)
	DECLARE @HAY_CAMPOS_PARA_POS BIT
	DECLARE @ACTUALIZAR_SOLICITUD BIT
	DECLARE @CADENA VARCHAR(20)
	DECLARE @DESCRIPCION VARCHAR(254)
	 -- Declaraciones
	SET @ERROR = 0
	SELECT @PUBLICADOR = SITIO_LOCAL, @USUARIO_POS_WSQM = USUARIO_WSQM,
		@TIPO_SITIO_LOCAL = TIPO_SITIO_LOCAL
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM) AND @TIPO_SITIO_LOCAL = 'C'
	BEGIN
		DECLARE C_MODIFIED CURSOR LOCAL FOR
			SELECT CADENA, DESCRIPCION -- Columnas
			FROM INSERTED I
		SET @ACTUALIZAR_SOLICITUD = 1
		OPEN C_MODIFIED
		FETCH NEXT FROM C_MODIFIED
		INTO @CADENA, @DESCRIPCION
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			IF ( NOT UPDATE(RECORDDATE) AND ( UPDATE(CADENA) OR UPDATE(DESCRIPCION) ) )
			BEGIN
				SELECT @COL_ROWPOINTER = ROWPOINTER
				FROM $$Compania$$.CADENA
				WHERE CADENA = @CADENA
				SET @PARAMETROS =
					'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<CADENA>' +
				'<CADENA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CADENA) + '</CADENA>' +
				'<DESCRIPCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DESCRIPCION) + '</DESCRIPCION>' +
				'</CADENA>'
				-- inserta la solicitud correspondiente
				EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'CADENAPOS600', 'MODIFICA', @PARAMETROS, @ACTUALIZAR_SOLICITUD, @COL_ROWPOINTER
			END
			FETCH NEXT FROM C_MODIFIED
			INTO @CADENA, @DESCRIPCION
		END
		CLOSE C_MODIFIED
		DEALLOCATE C_MODIFIED
	END
	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para modificar la tabla CADENA.',16,1 )
	END
END
;




CREATE TRIGGER $$Compania$$.CAJA_POS_POS_INS
ON $$Compania$$.CAJA_POS
FOR INSERT
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @TIPO_SITIO_LOCAL VARCHAR(1)
	DECLARE @CAJA VARCHAR(6)
	DECLARE @CODIGO_CORTO VARCHAR(2)
	DECLARE @SUCURSAL VARCHAR(6)
	DECLARE @BODEGA VARCHAR(4)
	DECLARE @UBICACION VARCHAR(40)
	DECLARE @ASIGNADO VARCHAR(1)
	DECLARE @IDENTIFICADOR VARCHAR(20)	
	DECLARE @CENTRO_COSTO VARCHAR(25)
	DECLARE @CONS_CIERRE_CAJA VARCHAR(20)
	DECLARE @CONSEC_DOC_ESPERA VARCHAR(20)
	
	SELECT @PUBLICADOR = SITIO_LOCAL,
		@USUARIO_POS_WSQM = USUARIO_WSQM,
		@TIPO_SITIO_LOCAL = TIPO_SITIO_LOCAL
  	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM) AND @TIPO_SITIO_LOCAL = 'C'
	BEGIN
		DECLARE C_INSERTED CURSOR LOCAL FOR
		SELECT CAJA, CODIGO_CORTO, SUCURSAL, BODEGA, UBICACION, ASIGNADO, IDENTIFICADOR, CENTRO_COSTO, CONS_CIERRE_CAJA, CONSEC_DOC_ESPERA
		FROM INSERTED i
		WHERE 0 = (
				SELECT COUNT('n')
				FROM DELETED d
				WHERE i.CAJA = d.CAJA
			   )
			
		OPEN C_INSERTED	
		FETCH NEXT FROM C_INSERTED INTO
		@CAJA, @CODIGO_CORTO, @SUCURSAL, @BODEGA, @UBICACION, @ASIGNADO, @IDENTIFICADOR, @CENTRO_COSTO, @CONS_CIERRE_CAJA, @CONSEC_DOC_ESPERA
		SET @ERROR = 0
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS =
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<CAJA_POS>' +
				'<CAJA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CAJA) + '</CAJA>' +
				'<CODIGO_CORTO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CODIGO_CORTO) + '</CODIGO_CORTO>' +
				'<SUCURSAL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@SUCURSAL) + '</SUCURSAL>' +
				'<BODEGA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@BODEGA) + '</BODEGA>' +
				'<UBICACION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@UBICACION) + '</UBICACION>' +
				'<ASIGNADO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ASIGNADO) + '</ASIGNADO>' +
				'<IDENTIFICADOR Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@IDENTIFICADOR) + '</IDENTIFICADOR>' +
				'<CENTRO_COSTO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CENTRO_COSTO) + '</CENTRO_COSTO>'+
				'<CONS_CIERRE_CAJA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CONS_CIERRE_CAJA) + '</CONS_CIERRE_CAJA>'+
				'<CONSEC_DOC_ESPERA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CONSEC_DOC_ESPERA) + '</CONSEC_DOC_ESPERA>'+
				'</CAJA_POS>'
			-- Inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'CAJAPOSPOS600', 'INSERTA', @PARAMETROS, 0, ''
			FETCH NEXT FROM C_INSERTED INTO
			@CAJA, @CODIGO_CORTO, @SUCURSAL, @BODEGA, @UBICACION, @ASIGNADO, @IDENTIFICADOR, @CENTRO_COSTO, @CONS_CIERRE_CAJA, @CONSEC_DOC_ESPERA
		END
		CLOSE C_INSERTED
    		DEALLOCATE C_INSERTED
	END
	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla CAJA_POS.',16,1 )
	END
END
;




CREATE TRIGGER $$Compania$$.CAJA_POS_POS_DEL
ON $$Compania$$.CAJA_POS
FOR DELETE
AS
BEGIN   	
                DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @TIPO_SITIO_LOCAL VARCHAR(1)
	DECLARE @CAJA VARCHAR(6)
	
	SELECT @PUBLICADOR = SITIO_LOCAL,
		@USUARIO_POS_WSQM = USUARIO_WSQM,
		@TIPO_SITIO_LOCAL = TIPO_SITIO_LOCAL
  	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM) AND @TIPO_SITIO_LOCAL = 'C'
	BEGIN
		DECLARE C_DELETED CURSOR LOCAL FOR
			SELECT CAJA
			FROM DELETED d
			WHERE 0 = (
				SELECT COUNT('n')
				FROM INSERTED i
				WHERE d.CAJA = i.CAJA
			   )
		OPEN C_DELETED
		FETCH NEXT FROM C_DELETED INTO
		@CAJA
		
		SET @ERROR = 0
		
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS =
								'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<CAJA_POS>' +
				'<CAJA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CAJA) + '</CAJA>' +
				'</CAJA_POS>'
 -- XML
			
			-- inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'CAJAPOSPOS600', 'ELIMINA', @PARAMETROS, 0, ''
			
			FETCH NEXT FROM C_DELETED INTO
			@CAJA
		END
		CLOSE C_DELETED
		DEALLOCATE C_DELETED
	END
	
	IF (@@ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para eliminar de la tabla CAJA_POS.',16,1 )
	END
END
;




CREATE TRIGGER $$Compania$$.CAJA_POS_POS_MOD
ON $$Compania$$.CAJA_POS
FOR UPDATE
AS
BEGIN   	
-- ESTE TRIGGER ASUME QUE LA TABLA A LA CUAL PERTENECE SE ENCUENTRA PREPARADA CON LOS CAMPOS DE EDNA, PRINCIPALMENTE, CON EL CAMPO <<ROWPOINTER>>
-- SI LA TABLA NO TIENE LLAVE PRIMARIA (EJ. GLOBALES_POS) SIEMPRE INSERTARÁ UNA SOLICITUD DE SERVICIO MODIFICA.
-- ACTUALIZAR_SOLICITUD: 0 no hace actualización, 1 si intenta hacer actualización
DECLARE @ERROR  INT,
	@PUBLICADOR VARCHAR(20),
	@USUARIO_POS_WSQM VARCHAR(100),
	@HAY_DATOS VARCHAR(1),
	@CAJA VARCHAR(6),
	@CODIGO_CORTO VARCHAR(2),
	@SUCURSAL VARCHAR(6),
	@BODEGA VARCHAR(4),
	@UBICACION VARCHAR(40),
	@ASIGNADO VARCHAR(1),
	@IDENTIFICADOR VARCHAR(20),	
	@CENTRO_COSTO VARCHAR(25),
	@CONS_CIERRE_CAJA VARCHAR(20),	
	@CONSEC_DOC_ESPERA VARCHAR(20),
	@OLD_CAJA VARCHAR(6),
	@OLD_CODIGO_CORTO VARCHAR(2),
	@OLD_SUCURSAL VARCHAR(6),
	@OLD_BODEGA VARCHAR(4),
	@OLD_UBICACION VARCHAR(40),
	@OLD_ASIGNADO VARCHAR(1),
	@OLD_IDENTIFICADOR VARCHAR(20),	
	@OLD_CENTRO_COSTO VARCHAR(25),
	@OLD_CONS_CIERRE_CAJA VARCHAR(20),	
	@OLD_CONSEC_DOC_ESPERA VARCHAR(20),
	@PARAMETROS VARCHAR(8000),
	@DATOS_POR_CAMBIAR VARCHAR(8000),
	@TIPO_SITIO_LOCAL VARCHAR(1)
	--Dejar sólo los campos que le interesen al POS
  SET @ERROR = 0
  SET @HAY_DATOS = 'N'

  SELECT @PUBLICADOR = SITIO_LOCAL,
	@USUARIO_POS_WSQM = USUARIO_WSQM,
	@TIPO_SITIO_LOCAL = TIPO_SITIO_LOCAL
  FROM $$Compania$$.GLOBALES_POS
  -- Aquí se hace la validación del usuario de conexión para evitar ping-pong
  IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
  BEGIN
    IF NOT(UPDATE(CAJA) )
      BEGIN
        DECLARE C_MODIFIED CURSOR LOCAL FOR
        SELECT
          I.CAJA,
          I.CODIGO_CORTO,
          I.SUCURSAL,
          I.BODEGA,
          I.UBICACION,
          I.ASIGNADO,
          I.IDENTIFICADOR,          
          I.CENTRO_COSTO,          
	  I.CONS_CIERRE_CAJA,
		  I.CONSEC_DOC_ESPERA,
          D.CAJA,
          D.CODIGO_CORTO,
          D.SUCURSAL,
          D.BODEGA,
          D.UBICACION,
          D.ASIGNADO,
          D.IDENTIFICADOR,         
          D.CENTRO_COSTO,
		  D.CONS_CIERRE_CAJA,
		  D.CONSEC_DOC_ESPERA,
          ''
          FROM INSERTED I, DELETED D
          WHERE
            I.CAJA = D.CAJA
      END
    ELSE
      BEGIN
        DECLARE C_MODIFIED CURSOR LOCAL FOR
        SELECT
          I.CAJA,
          I.CODIGO_CORTO,
          I.SUCURSAL,
          I.BODEGA,
          I.UBICACION,
          I.ASIGNADO,
          I.IDENTIFICADOR,          
          I.CENTRO_COSTO,
		  I.CONS_CIERRE_CAJA,  
		  I.CONSEC_DOC_ESPERA,
          D.CAJA,
          D.CODIGO_CORTO,
          D.SUCURSAL,
          D.BODEGA,
          D.UBICACION,
          D.ASIGNADO,
          D.IDENTIFICADOR,         
          D.CENTRO_COSTO,
		  D.CONS_CIERRE_CAJA,
		  D.CONSEC_DOC_ESPERA,
          ''
          FROM INSERTED I, DELETED D
          WHERE
		I.ROWPOINTER = D.ROWPOINTER
        SET @HAY_DATOS = 'S'
      END
    OPEN C_MODIFIED
    FETCH NEXT FROM C_MODIFIED
     INTO @CAJA,
     @CODIGO_CORTO,
     @SUCURSAL,
     @BODEGA,
     @UBICACION,
     @ASIGNADO,
     @IDENTIFICADOR,     
     @CENTRO_COSTO,
	 @CONS_CIERRE_CAJA,
	 @CONSEC_DOC_ESPERA,
     @OLD_CAJA,
     @OLD_CODIGO_CORTO,
     @OLD_SUCURSAL,
     @OLD_BODEGA,
     @OLD_UBICACION,
     @OLD_ASIGNADO,
     @OLD_IDENTIFICADOR,    
     @OLD_CENTRO_COSTO,
	 @OLD_CONS_CIERRE_CAJA,
	 @OLD_CONSEC_DOC_ESPERA,
     @PARAMETROS
	--Dejar sólo los campos que se dejaron en la declaración
	--Asegurarse que las variables tengan el mismo orden que el select
	--del cursor
    WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
    BEGIN
      IF (NOT UPDATE(RECORDDATE)) -- se asegura que no sea activación del trigger de eDNA
      BEGIN
	SET @PARAMETROS = ''
	SET @DATOS_POR_CAMBIAR = ''
  	--Se arma la llave de la tabla que siempre debe ser indicada
	SET @PARAMETROS = '<CAJA Type="VARCHAR" PrimaryKey="True" >' + ERPADMIN.POS_ReemplazarCaracter(@CAJA) + '</CAJA>'
	IF ISNULL(@CODIGO_CORTO,'') != ISNULL(@OLD_CODIGO_CORTO,'') AND @TIPO_SITIO_LOCAL = 'C'
	BEGIN
	  SET @DATOS_POR_CAMBIAR = @DATOS_POR_CAMBIAR + '<CODIGO_CORTO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CODIGO_CORTO) + '</CODIGO_CORTO>'
	END
	
	IF ISNULL(@SUCURSAL,'') != ISNULL(@OLD_SUCURSAL,'') AND @TIPO_SITIO_LOCAL = 'C'
	BEGIN
	  SET @DATOS_POR_CAMBIAR = @DATOS_POR_CAMBIAR + '<SUCURSAL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@SUCURSAL) + '</SUCURSAL>'
	END
	
	IF ISNULL(@BODEGA,'') != ISNULL(@OLD_BODEGA,'') AND @TIPO_SITIO_LOCAL = 'C'
	BEGIN
	  SET @DATOS_POR_CAMBIAR = @DATOS_POR_CAMBIAR + '<BODEGA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@BODEGA) + '</BODEGA>'
	END
	
	IF ISNULL(@UBICACION,'') != ISNULL(@OLD_UBICACION,'') AND @TIPO_SITIO_LOCAL = 'C'
	BEGIN
	  SET @DATOS_POR_CAMBIAR = @DATOS_POR_CAMBIAR + '<UBICACION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@UBICACION) + '</UBICACION>'
	END
	
	IF ISNULL(@ASIGNADO,'') != ISNULL(@OLD_ASIGNADO,'') AND @TIPO_SITIO_LOCAL = 'C'
	BEGIN
	  SET @DATOS_POR_CAMBIAR = @DATOS_POR_CAMBIAR + '<ASIGNADO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ASIGNADO) + '</ASIGNADO>'
	END
	
	IF ISNULL(@IDENTIFICADOR,'') != ISNULL(@OLD_IDENTIFICADOR,'') AND @TIPO_SITIO_LOCAL = 'C'
	BEGIN
	  SET @DATOS_POR_CAMBIAR = @DATOS_POR_CAMBIAR + '<IDENTIFICADOR Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@IDENTIFICADOR) + '</IDENTIFICADOR>'
	END	
	
	IF ISNULL(@CENTRO_COSTO,'') != ISNULL(@OLD_CENTRO_COSTO,'') AND @TIPO_SITIO_LOCAL = 'C'
	BEGIN
	  SET @DATOS_POR_CAMBIAR = @DATOS_POR_CAMBIAR + '<CENTRO_COSTO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CENTRO_COSTO) + '</CENTRO_COSTO>'
	END	
	
	IF ISNULL(@CONS_CIERRE_CAJA,'') != ISNULL(@OLD_CONS_CIERRE_CAJA,'')
	BEGIN
	  SET @DATOS_POR_CAMBIAR = @DATOS_POR_CAMBIAR + '<CONS_CIERRE_CAJA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CONS_CIERRE_CAJA) + '</CONS_CIERRE_CAJA>'
	END	
	
	IF ISNULL(@CONSEC_DOC_ESPERA,'') != ISNULL(@OLD_CONSEC_DOC_ESPERA,'')
	BEGIN
	  SET @DATOS_POR_CAMBIAR = @DATOS_POR_CAMBIAR + '<CONSEC_DOC_ESPERA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CONSEC_DOC_ESPERA) + '</CONSEC_DOC_ESPERA>'
	END	

	
	IF @DATOS_POR_CAMBIAR <> ''
	BEGIN
	  SET @PARAMETROS = @PARAMETROS + @DATOS_POR_CAMBIAR
	  SET @HAY_DATOS = 'S'
	END
	IF @HAY_DATOS = 'S'
	BEGIN
	 SET @PARAMETROS =
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<CAJA_POS>' + @PARAMETROS + '</CAJA_POS>'
	  -- inserta la solicitud correspondiente
	  EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR,
                                         'CAJAPOSPOS600',
                                         'MODIFICA',
                                         @PARAMETROS,
                                         0,
                                         ''
	END
      END
      FETCH NEXT FROM C_MODIFIED
      INTO @CAJA,
      @CODIGO_CORTO,
      @SUCURSAL,
      @BODEGA,
      @UBICACION,
      @ASIGNADO,
      @IDENTIFICADOR,
      @CENTRO_COSTO,
	  @CONS_CIERRE_CAJA,
	  @CONSEC_DOC_ESPERA,
      @OLD_CAJA,
      @OLD_CODIGO_CORTO,
      @OLD_SUCURSAL,
      @OLD_BODEGA,
      @OLD_UBICACION,
      @OLD_ASIGNADO,
      @OLD_IDENTIFICADOR,     
      @OLD_CENTRO_COSTO,
	  @OLD_CONS_CIERRE_CAJA,
	  @OLD_CONSEC_DOC_ESPERA,
      @PARAMETROS
	--Dejar sólo los campos que se dejaron en la declaración
	--Asegurarse que las variables tengan el mismo orden que el select
	--del cursor
    END
   CLOSE C_MODIFIED
   DEALLOCATE C_MODIFIED
  END
  IF (@@ERROR <> 0 OR @ERROR <> 0)
   BEGIN
     RAISERROR( 'Error generando la solicitud de servicio para modificar la tabla CAJA_POS.',16,1 )
   END
END
;




CREATE TRIGGER $$Compania$$.CAJERO_POS_INS
ON $$Compania$$.CAJERO
FOR INSERT
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @CAJERO VARCHAR(25)
	DECLARE @GRUPO VARCHAR(6)
	DECLARE @VENDEDOR VARCHAR(4)
	DECLARE @VERIFICACION VARCHAR(1)
	DECLARE @ROTATIVO VARCHAR(1)
	DECLARE @TIPO_SITIO_LOCAL VARCHAR(1)
	
	SELECT @PUBLICADOR = SITIO_LOCAL,
		@USUARIO_POS_WSQM = USUARIO_WSQM,
		@TIPO_SITIO_LOCAL = TIPO_SITIO_LOCAL
  	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM) AND @TIPO_SITIO_LOCAL = 'C'
	BEGIN
		DECLARE C_INSERTED CURSOR LOCAL FOR
		SELECT CAJERO, GRUPO, VENDEDOR, VERIFICACION, ROTATIVO
		FROM INSERTED i
		WHERE 0 = (
				SELECT COUNT('n')
				FROM DELETED d
				WHERE i.CAJERO = d.CAJERO
			   )
			
		OPEN C_INSERTED	
		FETCH NEXT FROM C_INSERTED INTO
		@CAJERO, @GRUPO, @VENDEDOR, @VERIFICACION, @ROTATIVO
		SET @ERROR = 0
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS =
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<CAJERO>' +
				'<CAJERO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CAJERO) + '</CAJERO>' +
				'<GRUPO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@GRUPO) + '</GRUPO>' +
				'<VENDEDOR Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@VENDEDOR) + '</VENDEDOR>' +
				'<VERIFICACION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@VERIFICACION) + '</VERIFICACION>' +
				'<ROTATIVO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ROTATIVO) + '</ROTATIVO>' +
				'</CAJERO>'
			-- Inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'CAJEROPOS600', 'INSERTA', @PARAMETROS, 0, ''
			FETCH NEXT FROM C_INSERTED INTO
			@CAJERO, @GRUPO, @VENDEDOR, @VERIFICACION, @ROTATIVO
		END
		CLOSE C_INSERTED
    		DEALLOCATE C_INSERTED
	END
	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla CAJERO.',16,1 )
	END
END
;




CREATE TRIGGER $$Compania$$.CAJERO_POS_DEL
ON $$Compania$$.CAJERO
FOR DELETE
AS
BEGIN   	
                DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @TIPO_SITIO_LOCAL VARCHAR(1)
	DECLARE @CAJERO VARCHAR(25)
	
	
	SELECT @PUBLICADOR = SITIO_LOCAL,
		@USUARIO_POS_WSQM = USUARIO_WSQM,
		@TIPO_SITIO_LOCAL = TIPO_SITIO_LOCAL
  	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM) AND @TIPO_SITIO_LOCAL = 'C'
	BEGIN
		DECLARE C_DELETED CURSOR LOCAL FOR
			SELECT CAJERO
			FROM DELETED d
			WHERE 0 = (
				SELECT COUNT('n')
				FROM INSERTED i
				WHERE d.CAJERO = i.CAJERO
			   )
		OPEN C_DELETED
		FETCH NEXT FROM C_DELETED INTO
		@CAJERO
		
		SET @ERROR = 0
		
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS =
								'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<CAJERO>' +
				'<CAJERO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CAJERO) + '</CAJERO>' +
				'</CAJERO>'
 -- XML
			
			-- inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'CAJEROPOS600', 'ELIMINA', @PARAMETROS, 0, ''
			
			FETCH NEXT FROM C_DELETED INTO
			@CAJERO
		END
		CLOSE C_DELETED
		DEALLOCATE C_DELETED
	END
	
	IF (@@ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para eliminar de la tabla CAJERO.',16,1 )
	END
END
;




CREATE TRIGGER $$Compania$$.CAJERO_POS_MOD
ON $$Compania$$.CAJERO
FOR UPDATE
AS
BEGIN   	
	DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @COL_ROWPOINTER VARCHAR(36)
	DECLARE @HAY_CAMPOS_PARA_POS BIT
	DECLARE @ACTUALIZAR_SOLICITUD BIT
	DECLARE @CAJERO VARCHAR(25)
	DECLARE @GRUPO VARCHAR(6)
	DECLARE @VENDEDOR VARCHAR(4)
	DECLARE @VERIFICACION VARCHAR(1)
	DECLARE @ROTATIVO VARCHAR(1)
	DECLARE @TIPO_SITIO_LOCAL VARCHAR(1)
	
	SELECT @PUBLICADOR = SITIO_LOCAL,
		@USUARIO_POS_WSQM = USUARIO_WSQM,
		@TIPO_SITIO_LOCAL = TIPO_SITIO_LOCAL
  	FROM $$Compania$$.GLOBALES_POS
	SET @ERROR = 0	
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM) AND @TIPO_SITIO_LOCAL = 'C'
	BEGIN
		DECLARE C_MODIFIED CURSOR LOCAL FOR
			SELECT CAJERO, GRUPO, VENDEDOR, VERIFICACION, ROTATIVO -- Columnas
			FROM INSERTED I
		SET @ACTUALIZAR_SOLICITUD = 1
		OPEN C_MODIFIED
		FETCH NEXT FROM C_MODIFIED
		INTO @CAJERO, @GRUPO, @VENDEDOR, @VERIFICACION, @ROTATIVO
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			IF ( NOT UPDATE(RECORDDATE) AND ( UPDATE(CAJERO) OR UPDATE(GRUPO) OR UPDATE(VENDEDOR) OR UPDATE(VERIFICACION) OR UPDATE(ROTATIVO) ) )
			BEGIN
				SELECT @COL_ROWPOINTER = ROWPOINTER
				FROM $$Compania$$.CAJERO
				WHERE CAJERO = @CAJERO
				SET @PARAMETROS =
					'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<CAJERO>' +
				'<CAJERO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CAJERO) + '</CAJERO>' +
				'<GRUPO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@GRUPO) + '</GRUPO>' +
				'<VENDEDOR Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@VENDEDOR) + '</VENDEDOR>' +
				'<VERIFICACION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@VERIFICACION) + '</VERIFICACION>' +
				'<ROTATIVO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ROTATIVO) + '</ROTATIVO>' +
				'</CAJERO>'
				-- inserta la solicitud correspondiente
				EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'CAJEROPOS600', 'MODIFICA', @PARAMETROS, @ACTUALIZAR_SOLICITUD, @COL_ROWPOINTER
			END
			FETCH NEXT FROM C_MODIFIED
			INTO @CAJERO, @GRUPO, @VENDEDOR, @VERIFICACION, @ROTATIVO
		END
		CLOSE C_MODIFIED
		DEALLOCATE C_MODIFIED
	END
	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para modificar la tabla CAJERO.',16,1 )
	END
END
;




CREATE TRIGGER $$Compania$$.CATEGORIA_CLIENTE_POS_INS
ON $$Compania$$.CATEGORIA_CLIENTE
FOR INSERT
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @CATEGORIA_CLIENTE VARCHAR(8)
	DECLARE @DESCRIPCION VARCHAR(40)
	DECLARE @CTR_VENTAS VARCHAR(25)
	DECLARE @CTA_VENTAS VARCHAR(25)
	DECLARE @CTR_DESC_GRAL VARCHAR(25)
	DECLARE @CTA_DESC_GRAL VARCHAR(25)
	DECLARE @CTR_COST_VENT VARCHAR(25)
	DECLARE @CTA_COST_VENT VARCHAR(25)
	DECLARE @CTR_DESC_LIN VARCHAR(25)
	DECLARE @CTA_DESC_LIN VARCHAR(25)
	DECLARE @CTR_COST_LIN VARCHAR(25)
	DECLARE @CTA_COST_LIN VARCHAR(25)
	DECLARE @CTR_VEND_COM VARCHAR(25)
	DECLARE @CTA_VEND_COM VARCHAR(25)
	DECLARE @CTR_COBR_COM VARCHAR(25)
	DECLARE @CTA_COBR_COM VARCHAR(25)
	DECLARE @CTR_CXC VARCHAR(25)
	DECLARE @CTA_CXC VARCHAR(25)
	DECLARE @CTR_LXC VARCHAR(25)
	DECLARE @CTA_LXC VARCHAR(25)
	DECLARE @CTR_CONTADO VARCHAR(25)
	DECLARE @CTA_CONTADO VARCHAR(25)
	DECLARE @CTR_PRONTO_PAG_CXC VARCHAR(25)
	DECLARE @CTA_PRONTO_PAG_CXC VARCHAR(25)
	DECLARE @CTR_INT_MORA_CXC VARCHAR(25)
	DECLARE @CTA_INT_MORA_CXC VARCHAR(25)
	DECLARE @CTR_RECIBOS_CXC VARCHAR(25)
	DECLARE @CTA_RECIBOS_CXC VARCHAR(25)
	DECLARE @CTR_DEBITO_CXC VARCHAR(25)
	DECLARE @CTA_DEBITO_CXC VARCHAR(25)
	DECLARE @CTR_CREDITO_CXC VARCHAR(25)
	DECLARE @CTA_CREDITO_CXC VARCHAR(25)
	DECLARE @CTR_IMPUESTO1_CXC VARCHAR(25)
	DECLARE @CTA_IMPUESTO1_CXC VARCHAR(25)
	DECLARE @CTR_IMPUESTO2_CXC VARCHAR(25)
	DECLARE @CTA_IMPUESTO2_CXC VARCHAR(25)
	DECLARE @CTR_RUBRO1_CXC VARCHAR(25)
	DECLARE @CTA_RUBRO1_CXC VARCHAR(25)
	DECLARE @CTR_RUBRO2_CXC VARCHAR(25)
	DECLARE @CTA_RUBRO2_CXC VARCHAR(25)
	DECLARE @CTR_ANTICIPO_CXC VARCHAR(25)
	DECLARE @CTA_ANTICIPO_CXC VARCHAR(25)
	DECLARE @CTR_DESC_BONIF VARCHAR(25)
	DECLARE @CTA_DESC_BONIF VARCHAR(25)
	DECLARE @CTR_DEV_VENTAS VARCHAR(25)
	DECLARE @CTA_DEV_VENTAS VARCHAR(25)
	DECLARE @CTR_INT_CORRIENTE VARCHAR(25)
	DECLARE @CTA_INT_CORRIENTE VARCHAR(25)

	
	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_INSERTED CURSOR LOCAL FOR
		SELECT CATEGORIA_CLIENTE, DESCRIPCION, CTR_VENTAS, CTA_VENTAS, CTR_DESC_GRAL, CTA_DESC_GRAL, CTR_COST_VENT, CTA_COST_VENT, CTR_DESC_LIN, CTA_DESC_LIN, CTR_COST_LIN, CTA_COST_LIN, CTR_VEND_COM, CTA_VEND_COM, CTR_COBR_COM, CTA_COBR_COM, CTR_CXC, CTA_CXC, CTR_LXC, CTA_LXC, CTR_CONTADO, CTA_CONTADO, CTR_PRONTO_PAG_CXC, CTA_PRONTO_PAG_CXC, CTR_INT_MORA_CXC, CTA_INT_MORA_CXC, CTR_RECIBOS_CXC, CTA_RECIBOS_CXC, CTR_DEBITO_CXC, CTA_DEBITO_CXC, CTR_CREDITO_CXC, CTA_CREDITO_CXC, CTR_IMPUESTO1_CXC, CTA_IMPUESTO1_CXC, CTR_IMPUESTO2_CXC, CTA_IMPUESTO2_CXC, CTR_RUBRO1_CXC, CTA_RUBRO1_CXC, CTR_RUBRO2_CXC, CTA_RUBRO2_CXC, CTR_ANTICIPO_CXC, CTA_ANTICIPO_CXC, CTR_DESC_BONIF, CTA_DESC_BONIF, CTR_DEV_VENTAS, CTA_DEV_VENTAS, CTR_INT_CORRIENTE, CTA_INT_CORRIENTE
		FROM INSERTED i
		WHERE 0 = (
				SELECT COUNT('n')
				FROM DELETED d
				WHERE i.CATEGORIA_CLIENTE = d.CATEGORIA_CLIENTE
			   )
			
		OPEN C_INSERTED	
		FETCH NEXT FROM C_INSERTED INTO
		@CATEGORIA_CLIENTE, @DESCRIPCION, @CTR_VENTAS, @CTA_VENTAS, @CTR_DESC_GRAL, @CTA_DESC_GRAL, @CTR_COST_VENT, @CTA_COST_VENT, @CTR_DESC_LIN, @CTA_DESC_LIN, @CTR_COST_LIN, @CTA_COST_LIN, @CTR_VEND_COM, @CTA_VEND_COM, @CTR_COBR_COM, @CTA_COBR_COM, @CTR_CXC, @CTA_CXC, @CTR_LXC, @CTA_LXC, @CTR_CONTADO, @CTA_CONTADO, @CTR_PRONTO_PAG_CXC, @CTA_PRONTO_PAG_CXC, @CTR_INT_MORA_CXC, @CTA_INT_MORA_CXC, @CTR_RECIBOS_CXC, @CTA_RECIBOS_CXC, @CTR_DEBITO_CXC, @CTA_DEBITO_CXC, @CTR_CREDITO_CXC, @CTA_CREDITO_CXC, @CTR_IMPUESTO1_CXC, @CTA_IMPUESTO1_CXC, @CTR_IMPUESTO2_CXC, @CTA_IMPUESTO2_CXC, @CTR_RUBRO1_CXC, @CTA_RUBRO1_CXC, @CTR_RUBRO2_CXC, @CTA_RUBRO2_CXC, @CTR_ANTICIPO_CXC, @CTA_ANTICIPO_CXC, @CTR_DESC_BONIF, @CTA_DESC_BONIF, @CTR_DEV_VENTAS, @CTA_DEV_VENTAS, @CTR_INT_CORRIENTE, @CTA_INT_CORRIENTE
		SET @ERROR = 0
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS =
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<CATEGORIA_CLIENTE>' +
				'<CATEGORIA_CLIENTE Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CATEGORIA_CLIENTE) + '</CATEGORIA_CLIENTE>' +
				'<DESCRIPCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DESCRIPCION) + '</DESCRIPCION>' +
				'<CTR_VENTAS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_VENTAS) + '</CTR_VENTAS>' +
				'<CTA_VENTAS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_VENTAS) + '</CTA_VENTAS>' +
				'<CTR_DESC_GRAL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_DESC_GRAL) + '</CTR_DESC_GRAL>' +
				'<CTA_DESC_GRAL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_DESC_GRAL) + '</CTA_DESC_GRAL>' +
				'<CTR_COST_VENT Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_COST_VENT) + '</CTR_COST_VENT>' +
				'<CTA_COST_VENT Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_COST_VENT) + '</CTA_COST_VENT>' +
				'<CTR_DESC_LIN Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_DESC_LIN) + '</CTR_DESC_LIN>' +
				'<CTA_DESC_LIN Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_DESC_LIN) + '</CTA_DESC_LIN>' +
				'<CTR_COST_LIN Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_COST_LIN) + '</CTR_COST_LIN>' +
				'<CTA_COST_LIN Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_COST_LIN) + '</CTA_COST_LIN>' +
				'<CTR_VEND_COM Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_VEND_COM) + '</CTR_VEND_COM>' +
				'<CTA_VEND_COM Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_VEND_COM) + '</CTA_VEND_COM>' +
				'<CTR_COBR_COM Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_COBR_COM) + '</CTR_COBR_COM>' +
				'<CTA_COBR_COM Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_COBR_COM) + '</CTA_COBR_COM>' +
				'<CTR_CXC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_CXC) + '</CTR_CXC>' +
				'<CTA_CXC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_CXC) + '</CTA_CXC>' +
				'<CTR_LXC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_LXC) + '</CTR_LXC>' +
				'<CTA_LXC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_LXC) + '</CTA_LXC>' +
				'<CTR_CONTADO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_CONTADO) + '</CTR_CONTADO>' +
				'<CTA_CONTADO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_CONTADO) + '</CTA_CONTADO>' +
				'<CTR_PRONTO_PAG_CXC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_PRONTO_PAG_CXC) + '</CTR_PRONTO_PAG_CXC>' +
				'<CTA_PRONTO_PAG_CXC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_PRONTO_PAG_CXC) + '</CTA_PRONTO_PAG_CXC>' +
				'<CTR_INT_MORA_CXC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_INT_MORA_CXC) + '</CTR_INT_MORA_CXC>' +
				'<CTA_INT_MORA_CXC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_INT_MORA_CXC) + '</CTA_INT_MORA_CXC>' +
				'<CTR_RECIBOS_CXC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_RECIBOS_CXC) + '</CTR_RECIBOS_CXC>' +
				'<CTA_RECIBOS_CXC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_RECIBOS_CXC) + '</CTA_RECIBOS_CXC>' +
				'<CTR_DEBITO_CXC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_DEBITO_CXC) + '</CTR_DEBITO_CXC>' +
				'<CTA_DEBITO_CXC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_DEBITO_CXC) + '</CTA_DEBITO_CXC>' +
				'<CTR_CREDITO_CXC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_CREDITO_CXC) + '</CTR_CREDITO_CXC>' +
				'<CTA_CREDITO_CXC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_CREDITO_CXC) + '</CTA_CREDITO_CXC>' +
				'<CTR_IMPUESTO1_CXC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_IMPUESTO1_CXC) + '</CTR_IMPUESTO1_CXC>' +
				'<CTA_IMPUESTO1_CXC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_IMPUESTO1_CXC) + '</CTA_IMPUESTO1_CXC>' +
				'<CTR_IMPUESTO2_CXC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_IMPUESTO2_CXC) + '</CTR_IMPUESTO2_CXC>' +
				'<CTA_IMPUESTO2_CXC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_IMPUESTO2_CXC) + '</CTA_IMPUESTO2_CXC>' +
				'<CTR_RUBRO1_CXC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_RUBRO1_CXC) + '</CTR_RUBRO1_CXC>' +
				'<CTA_RUBRO1_CXC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_RUBRO1_CXC) + '</CTA_RUBRO1_CXC>' +
				'<CTR_RUBRO2_CXC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_RUBRO2_CXC) + '</CTR_RUBRO2_CXC>' +
				'<CTA_RUBRO2_CXC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_RUBRO2_CXC) + '</CTA_RUBRO2_CXC>' +
				'<CTR_ANTICIPO_CXC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_ANTICIPO_CXC) + '</CTR_ANTICIPO_CXC>' +
				'<CTA_ANTICIPO_CXC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_ANTICIPO_CXC) + '</CTA_ANTICIPO_CXC>' +
				'<CTR_DESC_BONIF Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_DESC_BONIF) + '</CTR_DESC_BONIF>' +
				'<CTA_DESC_BONIF Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_DESC_BONIF) + '</CTA_DESC_BONIF>' +
				'<CTR_DEV_VENTAS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_DEV_VENTAS) + '</CTR_DEV_VENTAS>' +
				'<CTA_DEV_VENTAS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_DEV_VENTAS) + '</CTA_DEV_VENTAS>' +
				'<CTR_INT_CORRIENTE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_INT_CORRIENTE) + '</CTR_INT_CORRIENTE>' +
				'<CTA_INT_CORRIENTE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_INT_CORRIENTE) + '</CTA_INT_CORRIENTE>' +

				'</CATEGORIA_CLIENTE>'
			-- Inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'CATEGORIACLIENTEPOS600', 'INSERTA', @PARAMETROS, 0, ''
			FETCH NEXT FROM C_INSERTED INTO
			@CATEGORIA_CLIENTE, @DESCRIPCION, @CTR_VENTAS, @CTA_VENTAS, @CTR_DESC_GRAL, @CTA_DESC_GRAL, @CTR_COST_VENT, @CTA_COST_VENT, @CTR_DESC_LIN, @CTA_DESC_LIN, @CTR_COST_LIN, @CTA_COST_LIN, @CTR_VEND_COM, @CTA_VEND_COM, @CTR_COBR_COM, @CTA_COBR_COM, @CTR_CXC, @CTA_CXC, @CTR_LXC, @CTA_LXC, @CTR_CONTADO, @CTA_CONTADO, @CTR_PRONTO_PAG_CXC, @CTA_PRONTO_PAG_CXC, @CTR_INT_MORA_CXC, @CTA_INT_MORA_CXC, @CTR_RECIBOS_CXC, @CTA_RECIBOS_CXC, @CTR_DEBITO_CXC, @CTA_DEBITO_CXC, @CTR_CREDITO_CXC, @CTA_CREDITO_CXC, @CTR_IMPUESTO1_CXC, @CTA_IMPUESTO1_CXC, @CTR_IMPUESTO2_CXC, @CTA_IMPUESTO2_CXC, @CTR_RUBRO1_CXC, @CTA_RUBRO1_CXC, @CTR_RUBRO2_CXC, @CTA_RUBRO2_CXC, @CTR_ANTICIPO_CXC, @CTA_ANTICIPO_CXC, @CTR_DESC_BONIF, @CTA_DESC_BONIF, @CTR_DEV_VENTAS, @CTA_DEV_VENTAS, @CTR_INT_CORRIENTE, @CTA_INT_CORRIENTE
		END
		CLOSE C_INSERTED
    		DEALLOCATE C_INSERTED
	END
	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla CATEGORIA_CLIENTE.',16,1 )
	END
END
;




CREATE TRIGGER $$Compania$$.CATEGORIA_CLIENTE_POS_DEL
ON $$Compania$$.CATEGORIA_CLIENTE
FOR DELETE
AS
BEGIN   	
                DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @CATEGORIA_CLIENTE VARCHAR(8)
	 -- Declaraciones	
	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_DELETED CURSOR LOCAL FOR
			SELECT CATEGORIA_CLIENTE
			FROM DELETED d
			WHERE 0 = (
				SELECT COUNT('n')
				FROM INSERTED i
				WHERE d.CATEGORIA_CLIENTE = i.CATEGORIA_CLIENTE
			   )
		OPEN C_DELETED
		FETCH NEXT FROM C_DELETED INTO
		@CATEGORIA_CLIENTE
		
		SET @ERROR = 0
		
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS =
								'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<CATEGORIA_CLIENTE>' +
				'<CATEGORIA_CLIENTE Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CATEGORIA_CLIENTE) + '</CATEGORIA_CLIENTE>' +
				'</CATEGORIA_CLIENTE>'
 -- XML
			
			-- inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'CATEGORIACLIENTEPOS600', 'ELIMINA', @PARAMETROS, 0, ''
			
			FETCH NEXT FROM C_DELETED INTO
			@CATEGORIA_CLIENTE
		END
		CLOSE C_DELETED
		DEALLOCATE C_DELETED
	END
	
	IF (@@ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para eliminar de la tabla CATEGORIA_CLIENTE.',16,1 )
	END
END
;




CREATE TRIGGER $$Compania$$.CATEGORIA_CLIENTE_POS_MOD
ON $$Compania$$.CATEGORIA_CLIENTE
FOR UPDATE
AS
BEGIN   	
	DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @COL_ROWPOINTER VARCHAR(36)
	DECLARE @HAY_CAMPOS_PARA_POS BIT
	DECLARE @ACTUALIZAR_SOLICITUD BIT
	DECLARE @CATEGORIA_CLIENTE VARCHAR(8)
	DECLARE @DESCRIPCION VARCHAR(40)
	 -- Declaraciones
	SET @ERROR = 0
	SELECT @PUBLICADOR = SITIO_LOCAL, @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_MODIFIED CURSOR LOCAL FOR
			SELECT CATEGORIA_CLIENTE, DESCRIPCION
			FROM INSERTED I
		SET @ACTUALIZAR_SOLICITUD = 1
		OPEN C_MODIFIED
		FETCH NEXT FROM C_MODIFIED
		INTO @CATEGORIA_CLIENTE, @DESCRIPCION
		
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			IF ( NOT UPDATE(RECORDDATE) AND ( UPDATE(CATEGORIA_CLIENTE) OR UPDATE(DESCRIPCION)) )
			BEGIN
				SELECT @COL_ROWPOINTER = ROWPOINTER
				FROM $$Compania$$.CATEGORIA_CLIENTE
				WHERE CATEGORIA_CLIENTE = @CATEGORIA_CLIENTE
				SET @PARAMETROS =
					'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<CATEGORIA_CLIENTE>' +
				'<CATEGORIA_CLIENTE Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CATEGORIA_CLIENTE) + '</CATEGORIA_CLIENTE>' +
				'<DESCRIPCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DESCRIPCION) + '</DESCRIPCION>' +
				'</CATEGORIA_CLIENTE>'
				-- inserta la solicitud correspondiente
				EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'CATEGORIACLIENTEPOS600', 'MODIFICA', @PARAMETROS, @ACTUALIZAR_SOLICITUD, @COL_ROWPOINTER
			END
			FETCH NEXT FROM C_MODIFIED
			INTO @CATEGORIA_CLIENTE, @DESCRIPCION
		END
		CLOSE C_MODIFIED
		DEALLOCATE C_MODIFIED
	END
	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para modificar la tabla CATEGORIA_CLIENTE.',16,1 )
	END
END
;


CREATE TRIGGER $$Compania$$.CIERRE_TIENDA_POS_INS
ON $$Compania$$.CIERRE_TIENDA
FOR INSERT
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @TIPO_SITIO_LOCAL VARCHAR(1)
	DECLARE @GRUPO VARCHAR(6)
	DECLARE @NUM_CIERRE INT
	DECLARE @FECHA_INICIO DATETIME
	DECLARE @FECHA_FIN DATETIME
	DECLARE @USUARIO VARCHAR(30)
	DECLARE @DESCUENTO_LINEA DECIMAL(28,8)
	DECLARE @DESCUENTO_GENERAL DECIMAL(28,8)
	DECLARE @IMPUESTO1 DECIMAL(28,8)
	DECLARE @IMPUESTO2 DECIMAL(28,8)
	DECLARE @TOTAL DECIMAL(28,8)
	DECLARE @TOTAL_PAGAR DECIMAL(28,8)
	DECLARE @PREFIJO VARCHAR(20)
	DECLARE @NCF VARCHAR(20)

	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM ,
		@TIPO_SITIO_LOCAL = TIPO_SITIO_LOCAL
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM) AND @TIPO_SITIO_LOCAL = 'T'
	BEGIN
		DECLARE C_INSERTED CURSOR LOCAL FOR
		SELECT GRUPO, NUM_CIERRE, FECHA_INICIO, FECHA_FIN, USUARIO, DESCUENTO_LINEA, DESCUENTO_GENERAL, IMPUESTO1, IMPUESTO2, TOTAL, TOTAL_PAGAR, PREFIJO, NCF -- Columnas
		FROM INSERTED i
		WHERE 0 = (
				SELECT COUNT('n')
				FROM DELETED d
				WHERE i.GRUPO = d.GRUPO AND i.NUM_CIERRE = d.NUM_CIERRE
			   )
			
		OPEN C_INSERTED	
		FETCH NEXT FROM C_INSERTED INTO
		@GRUPO, @NUM_CIERRE, @FECHA_INICIO, @FECHA_FIN, @USUARIO, @DESCUENTO_LINEA, @DESCUENTO_GENERAL, @IMPUESTO1, @IMPUESTO2, @TOTAL, @TOTAL_PAGAR, @PREFIJO, @NCF
		SET @ERROR = 0
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS =
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<CIERRE_TIENDA>' +
				'<GRUPO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@GRUPO) + '</GRUPO>' +
				'<NUM_CIERRE Type="INT" PrimaryKey="True">' + ERPADMIN.POS_NumberToVarchar(@NUM_CIERRE) + '</NUM_CIERRE>' +
				'<FECHA_INICIO Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_INICIO) + '</FECHA_INICIO>' +
				'<FECHA_FIN Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_FIN) + '</FECHA_FIN>' +
				'<USUARIO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USUARIO) + '</USUARIO>' +
				'<DESCUENTO_LINEA Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@DESCUENTO_LINEA) + '</DESCUENTO_LINEA>' +
				'<DESCUENTO_GENERAL Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@DESCUENTO_GENERAL) + '</DESCUENTO_GENERAL>' +
				'<IMPUESTO1 Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@IMPUESTO1) + '</IMPUESTO1>' +
				'<IMPUESTO2 Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@IMPUESTO2) + '</IMPUESTO2>' +
				'<TOTAL Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@TOTAL) + '</TOTAL>' +
				'<TOTAL_PAGAR Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@TOTAL_PAGAR) + '</TOTAL_PAGAR>' +
				'<PREFIJO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@PREFIJO) + '</PREFIJO>' +
				'<NCF Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NCF) + '</NCF>' +
				'</CIERRE_TIENDA>'
			-- Inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'CIERRETIENDAPOS600', 'INSERTA', @PARAMETROS, 0, ''
			FETCH NEXT FROM C_INSERTED INTO
			@GRUPO, @NUM_CIERRE, @FECHA_INICIO, @FECHA_FIN, @USUARIO, @DESCUENTO_LINEA, @DESCUENTO_GENERAL, @IMPUESTO1, @IMPUESTO2, @TOTAL, @TOTAL_PAGAR, @PREFIJO, @NCF
		END
		CLOSE C_INSERTED
    		DEALLOCATE C_INSERTED
	END
	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla CIERRE_TIENDA.',16,1 )
	END
END;




CREATE TRIGGER $$Compania$$.CIERRE_TIENDA_POS_DEL
ON $$Compania$$.CIERRE_TIENDA
FOR DELETE
AS
BEGIN   	
                DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @TIPO_SITIO_LOCAL VARCHAR(1)
	DECLARE @GRUPO VARCHAR(6)
	DECLARE @NUM_CIERRE INT
	-- Declaraciones	
	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM ,
		@TIPO_SITIO_LOCAL = TIPO_SITIO_LOCAL
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM) AND @TIPO_SITIO_LOCAL = 'T'
	BEGIN
		DECLARE C_DELETED CURSOR LOCAL FOR
			SELECT GRUPO, NUM_CIERRE
			FROM DELETED d
			WHERE 0 = (
				SELECT COUNT('n')
				FROM INSERTED i
				WHERE d.GRUPO = i.GRUPO AND d.NUM_CIERRE = i.NUM_CIERRE
			   )
		OPEN C_DELETED
		FETCH NEXT FROM C_DELETED INTO
		@GRUPO, @NUM_CIERRE
		
		SET @ERROR = 0
		
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS =
								'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<CIERRE_TIENDA>' +
				'<GRUPO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@GRUPO) + '</GRUPO>' +
				'<NUM_CIERRE Type="INT" PrimaryKey="True">' + ERPADMIN.POS_NumberToVarchar(@NUM_CIERRE) + '</NUM_CIERRE>' +
				'</CIERRE_TIENDA>'
 -- XML
			
			-- inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'CIERRETIENDAPOS600', 'ELIMINA', @PARAMETROS, 0, ''
			
			FETCH NEXT FROM C_DELETED INTO
			@GRUPO, @NUM_CIERRE
		END
		CLOSE C_DELETED
		DEALLOCATE C_DELETED
	END
	
	IF (@@ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para eliminar de la tabla CIERRE_TIENDA.',16,1 )
	END
END
;



CREATE TRIGGER $$Compania$$.CIERRE_TIENDA_POS_MOD
ON $$Compania$$.CIERRE_TIENDA
FOR UPDATE
AS
BEGIN   	
	DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @TIPO_SITIO_LOCAL VARCHAR(1)
	DECLARE @COL_ROWPOINTER VARCHAR(36)
	DECLARE @HAY_CAMPOS_PARA_POS BIT
	DECLARE @ACTUALIZAR_SOLICITUD BIT
	DECLARE @GRUPO VARCHAR(6)
	DECLARE @NUM_CIERRE INT
	DECLARE @FECHA_INICIO DATETIME
	DECLARE @FECHA_FIN DATETIME
	DECLARE @USUARIO VARCHAR(30)
	DECLARE @DESCUENTO_LINEA DECIMAL(28,8)
	DECLARE @DESCUENTO_GENERAL DECIMAL(28,8)
	DECLARE @IMPUESTO1 DECIMAL(28,8)
	DECLARE @IMPUESTO2 DECIMAL(28,8)
	DECLARE @TOTAL DECIMAL(28,8)
	DECLARE @TOTAL_PAGAR DECIMAL(28,8)
	DECLARE @PREFIJO VARCHAR(20)
	DECLARE @NCF VARCHAR(20)

	 -- Declaraciones
	SET @ERROR = 0
	SELECT @PUBLICADOR = SITIO_LOCAL, @USUARIO_POS_WSQM = USUARIO_WSQM,
		@TIPO_SITIO_LOCAL = TIPO_SITIO_LOCAL
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM) AND @TIPO_SITIO_LOCAL = 'T'
	BEGIN
		DECLARE C_MODIFIED CURSOR LOCAL FOR
			SELECT GRUPO, NUM_CIERRE, FECHA_INICIO, FECHA_FIN, USUARIO, DESCUENTO_LINEA, DESCUENTO_GENERAL, IMPUESTO1, IMPUESTO2, TOTAL, TOTAL_PAGAR, PREFIJO, NCF -- Columnas
			FROM INSERTED I
		SET @ACTUALIZAR_SOLICITUD = 1
		OPEN C_MODIFIED
		FETCH NEXT FROM C_MODIFIED
		INTO @GRUPO, @NUM_CIERRE, @FECHA_INICIO, @FECHA_FIN, @USUARIO, @DESCUENTO_LINEA, @DESCUENTO_GENERAL, @IMPUESTO1, @IMPUESTO2, @TOTAL, @TOTAL_PAGAR, @PREFIJO, @NCF
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			IF ( NOT UPDATE(RECORDDATE) AND ( UPDATE(GRUPO) OR UPDATE(NUM_CIERRE) OR UPDATE(FECHA_INICIO) OR UPDATE(FECHA_FIN) OR UPDATE(USUARIO) OR UPDATE(DESCUENTO_LINEA) OR UPDATE(DESCUENTO_GENERAL)  OR UPDATE(IMPUESTO1) OR UPDATE(IMPUESTO2) OR UPDATE(PREFIJO) OR UPDATE(NCF)) )
			BEGIN
				SELECT @COL_ROWPOINTER = ROWPOINTER
				FROM $$Compania$$.CIERRE_TIENDA
				WHERE GRUPO = @GRUPO AND NUM_CIERRE = @NUM_CIERRE
				SET @PARAMETROS =
					'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<CIERRE_TIENDA>' +
				'<GRUPO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@GRUPO) + '</GRUPO>' +
				'<NUM_CIERRE Type="INT" PrimaryKey="True">' + ERPADMIN.POS_NumberToVarchar(@NUM_CIERRE) + '</NUM_CIERRE>' +
				'<FECHA_INICIO Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_INICIO) + '</FECHA_INICIO>' +
				'<FECHA_FIN Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_FIN) + '</FECHA_FIN>' +
				'<USUARIO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USUARIO) + '</USUARIO>' +
				'<DESCUENTO_LINEA Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@DESCUENTO_LINEA) + '</DESCUENTO_LINEA>' +
				'<DESCUENTO_GENERAL Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@DESCUENTO_GENERAL) + '</DESCUENTO_GENERAL>' +
				'<IMPUESTO1 Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@IMPUESTO1) + '</IMPUESTO1>' +
				'<IMPUESTO2 Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@IMPUESTO2) + '</IMPUESTO2>' +
				'<TOTAL Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@TOTAL) + '</TOTAL>' +
				'<TOTAL_PAGAR Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@TOTAL_PAGAR) + '</TOTAL_PAGAR>' +
				'<PREFIJO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@PREFIJO) + '</PREFIJO>' +
				'<NCF Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NCF) + '</NCF>' +
				'</CIERRE_TIENDA>'
				-- inserta la solicitud correspondiente
				EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'CIERRETIENDAPOS600', 'MODIFICA', @PARAMETROS, @ACTUALIZAR_SOLICITUD, @COL_ROWPOINTER
			END
			FETCH NEXT FROM C_MODIFIED
			INTO @GRUPO, @NUM_CIERRE, @FECHA_INICIO, @FECHA_FIN, @USUARIO, @DESCUENTO_LINEA, @DESCUENTO_GENERAL, @IMPUESTO1, @IMPUESTO2, @TOTAL, @TOTAL_PAGAR, @PREFIJO, @NCF
		END
		CLOSE C_MODIFIED
		DEALLOCATE C_MODIFIED
	END
	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para modificar la tabla CIERRE_TIENDA.',16,1 )
	END
END;





CREATE TRIGGER $$Compania$$.CLASIFICACION_POS_INS
ON $$Compania$$.CLASIFICACION
FOR INSERT
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @CLASIFICACION VARCHAR(12)
	DECLARE @DESCRIPCION VARCHAR(40)
	DECLARE @AGRUPACION INT
	DECLARE @USA_NUMEROS_SERIE VARCHAR(1)
	DECLARE @PLANTILLA_SERIE VARCHAR(4)
	DECLARE @APORTE_CODIGO VARCHAR(5)
	DECLARE @TIPO_CODIGO_BARRAS VARCHAR(1)
	DECLARE @UNIDAD_MEDIDA VARCHAR(6)
	
	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_INSERTED CURSOR LOCAL FOR
		SELECT CLASIFICACION, DESCRIPCION, AGRUPACION, USA_NUMEROS_SERIE, PLANTILLA_SERIE, APORTE_CODIGO, TIPO_CODIGO_BARRAS, UNIDAD_MEDIDA
		FROM INSERTED i
		WHERE 0 = (
				SELECT COUNT('n')
				FROM DELETED d
				WHERE i.CLASIFICACION = d.CLASIFICACION
			   )
			
		OPEN C_INSERTED	
		FETCH NEXT FROM C_INSERTED INTO
		@CLASIFICACION, @DESCRIPCION, @AGRUPACION, @USA_NUMEROS_SERIE, @PLANTILLA_SERIE, @APORTE_CODIGO, @TIPO_CODIGO_BARRAS, @UNIDAD_MEDIDA
		SET @ERROR = 0
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS =
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<CLASIFICACION>' +
				'<CLASIFICACION Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CLASIFICACION) + '</CLASIFICACION>' +
				'<DESCRIPCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DESCRIPCION) + '</DESCRIPCION>' +
				'<AGRUPACION Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@AGRUPACION) + '</AGRUPACION>' +
				'<USA_NUMEROS_SERIE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USA_NUMEROS_SERIE) + '</USA_NUMEROS_SERIE>' +
				'<PLANTILLA_SERIE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@PLANTILLA_SERIE) + '</PLANTILLA_SERIE>' +
				'<APORTE_CODIGO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@APORTE_CODIGO) + '</APORTE_CODIGO>' +
				'<TIPO_CODIGO_BARRAS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_CODIGO_BARRAS) + '</TIPO_CODIGO_BARRAS>' +
				'<UNIDAD_MEDIDA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@UNIDAD_MEDIDA) + '</UNIDAD_MEDIDA>' +
				'</CLASIFICACION>'
			-- Inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'CLASIFICACIONPOS600', 'INSERTA', @PARAMETROS, 0, ''
			FETCH NEXT FROM C_INSERTED INTO
			@CLASIFICACION, @DESCRIPCION, @AGRUPACION, @USA_NUMEROS_SERIE, @PLANTILLA_SERIE, @APORTE_CODIGO, @TIPO_CODIGO_BARRAS, @UNIDAD_MEDIDA
		END
		CLOSE C_INSERTED
    		DEALLOCATE C_INSERTED
	END
	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla CLASIFICACION.',16,1 )
	END
END
;




CREATE TRIGGER $$Compania$$.CLASIFICACION_POS_DEL
ON $$Compania$$.CLASIFICACION
FOR DELETE
AS
BEGIN   	
                DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @CLASIFICACION VARCHAR(12)
	 -- Declaraciones	
	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_DELETED CURSOR LOCAL FOR
			SELECT CLASIFICACION
			FROM DELETED d
			WHERE 0 = (
				SELECT COUNT('n')
				FROM INSERTED i
				WHERE d.CLASIFICACION = i.CLASIFICACION
			   )
		OPEN C_DELETED
		FETCH NEXT FROM C_DELETED INTO
		@CLASIFICACION
		
		SET @ERROR = 0
		
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS =
								'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<CLASIFICACION>' +
				'<CLASIFICACION Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CLASIFICACION) + '</CLASIFICACION>' +
				'</CLASIFICACION>'
 -- XML
			
			-- inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'CLASIFICACIONPOS600', 'ELIMINA', @PARAMETROS, 0, ''
			
			FETCH NEXT FROM C_DELETED INTO
			@CLASIFICACION
		END
		CLOSE C_DELETED
		DEALLOCATE C_DELETED
	END
	
	IF (@@ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para eliminar de la tabla CLASIFICACION.',16,1 )
	END
END
;




CREATE TRIGGER $$Compania$$.CLASIFICACION_POS_MOD
ON $$Compania$$.CLASIFICACION
FOR UPDATE
AS
BEGIN   	
	DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @COL_ROWPOINTER VARCHAR(36)
	DECLARE @HAY_CAMPOS_PARA_POS BIT
	DECLARE @ACTUALIZAR_SOLICITUD BIT
	DECLARE @CLASIFICACION VARCHAR(12)
	DECLARE @DESCRIPCION VARCHAR(40)
	 -- Declaraciones
	SET @ERROR = 0
	SELECT @PUBLICADOR = SITIO_LOCAL, @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_MODIFIED CURSOR LOCAL FOR
			SELECT CLASIFICACION, DESCRIPCION
			FROM INSERTED I
		SET @ACTUALIZAR_SOLICITUD = 1
		OPEN C_MODIFIED
		FETCH NEXT FROM C_MODIFIED
		INTO @CLASIFICACION, @DESCRIPCION
		
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			IF ( NOT UPDATE(RECORDDATE) AND ( UPDATE(CLASIFICACION) OR UPDATE(DESCRIPCION) ) )
			BEGIN
				SELECT @COL_ROWPOINTER = ROWPOINTER
				FROM $$Compania$$.CLASIFICACION
				WHERE CLASIFICACION = @CLASIFICACION
				SET @PARAMETROS =
					'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<CLASIFICACION>' +
				'<CLASIFICACION Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CLASIFICACION) + '</CLASIFICACION>' +
				'<DESCRIPCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DESCRIPCION) + '</DESCRIPCION>' +
				'</CLASIFICACION>'
				-- inserta la solicitud correspondiente
				EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'CLASIFICACIONPOS600', 'MODIFICA', @PARAMETROS, @ACTUALIZAR_SOLICITUD, @COL_ROWPOINTER
			END
			FETCH NEXT FROM C_MODIFIED
			INTO @CLASIFICACION, @DESCRIPCION
		END
		CLOSE C_MODIFIED
		DEALLOCATE C_MODIFIED
	END
	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para modificar la tabla CLASIFICACION.',16,1 )
	END
END
;


CREATE TRIGGER $$Compania$$.CLIENTE_POS_INS
ON $$Compania$$.CLIENTE
FOR INSERT
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS1 VARCHAR(8000)
	DECLARE @PARAMETROS2 VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @TIPO_SITIO_LOCAL VARCHAR(1)	
	DECLARE @NOMBRE_CAMPO1 VARCHAR(60)
	DECLARE @NOMBRE_CAMPO2 VARCHAR(60)
	DECLARE @NOMBRE_CAMPO3 VARCHAR(60)
	DECLARE @NOMBRE_CAMPO4 VARCHAR(60)
	DECLARE @NOMBRE_CAMPO5 VARCHAR(60)
	DECLARE @NOMBRE_CAMPO6 VARCHAR(60)
	DECLARE @NOMBRE_CAMPO7 VARCHAR(60)
	DECLARE @NOMBRE_CAMPO8 VARCHAR(60)
	DECLARE @NOMBRE_CAMPO9 VARCHAR(60)	
	DECLARE @NOMBRE_CAMPO10 VARCHAR(60)
	DECLARE @DETALLE_CAMPO1 VARCHAR(250)
	DECLARE @DETALLE_CAMPO2 VARCHAR(250)
	DECLARE @DETALLE_CAMPO3 VARCHAR(250)
	DECLARE @DETALLE_CAMPO4 VARCHAR(250)
	DECLARE @DETALLE_CAMPO5 VARCHAR(250)
	DECLARE @DETALLE_CAMPO6 VARCHAR(250)
	DECLARE @DETALLE_CAMPO7 VARCHAR(250)
	DECLARE @DETALLE_CAMPO8 VARCHAR(250)
	DECLARE @DETALLE_CAMPO9 VARCHAR(250)	
	DECLARE @DETALLE_CAMPO10 VARCHAR(250)
	DECLARE @DIRECCION VARCHAR(4000)
	DECLARE @TIPO_DIRECCION VARCHAR(10)	
	DECLARE @CLIENTE VARCHAR(20)
	DECLARE @NOMBRE VARCHAR(80)
	DECLARE @DETALLE_DIRECCION INT
	DECLARE @ALIAS VARCHAR(80)
	DECLARE @CONTACTO VARCHAR(30)
	DECLARE @CARGO VARCHAR(30)
	DECLARE @DIR_EMB_DEFAULT VARCHAR(8)
	DECLARE @TELEFONO1 VARCHAR(15)
	DECLARE @TELEFONO2 VARCHAR(15)
	DECLARE @FAX VARCHAR(15)
	DECLARE @CONTRIBUYENTE VARCHAR(20)
	DECLARE @FECHA_INGRESO DATETIME
	DECLARE @MULTIMONEDA VARCHAR(1)
	DECLARE @MONEDA VARCHAR(4)
	DECLARE @SALDO DECIMAL(28,8)
	DECLARE @SALDO_LOCAL DECIMAL(28,8)
	DECLARE @SALDO_DOLAR DECIMAL(28,8)
	DECLARE @SALDO_CREDITO DECIMAL(28,8)
	DECLARE @SALDO_NOCARGOS DECIMAL(28,8)
	DECLARE @LIMITE_CREDITO DECIMAL(28,8)
	DECLARE @EXCEDER_LIMITE VARCHAR(1)
	DECLARE @TASA_INTERES DECIMAL(28,8)
	DECLARE @TASA_INTERES_MORA DECIMAL(28,8)
	DECLARE @FECHA_ULT_MORA DATETIME
	DECLARE @FECHA_ULT_MOV DATETIME
	DECLARE @CONDICION_PAGO VARCHAR(4)
	DECLARE @NIVEL_PRECIO VARCHAR(12)
	DECLARE @DESCUENTO DECIMAL(28,8)
	DECLARE @MONEDA_NIVEL VARCHAR(1)
	DECLARE @ACEPTA_BACKORDER VARCHAR(1)
	DECLARE @PAIS VARCHAR(4)
	DECLARE @ZONA VARCHAR(4)
	DECLARE @RUTA VARCHAR(4)
	DECLARE @VENDEDOR VARCHAR(4)
	DECLARE @COBRADOR VARCHAR(4)
	DECLARE @ACEPTA_FRACCIONES VARCHAR(1)
	DECLARE @ACTIVO VARCHAR(1)
	DECLARE @EXENTO_IMPUESTOS VARCHAR(1)
	DECLARE @EXENCION_IMP1 DECIMAL(28,8)
	DECLARE @EXENCION_IMP2 DECIMAL(28,8)
	DECLARE @COBRO_JUDICIAL VARCHAR(1)
	DECLARE @CATEGORIA_CLIENTE VARCHAR(8)
	DECLARE @CLASE_ABC VARCHAR(1)
	DECLARE @DIAS_ABASTECIMIEN INT
	DECLARE @USA_TARJETA VARCHAR(1)
	DECLARE @TARJETA_CREDITO VARCHAR(20)
	DECLARE @TIPO_TARJETA VARCHAR(12)
	DECLARE @FECHA_VENCE_TARJ DATETIME
	DECLARE @E_MAIL VARCHAR(249)
	DECLARE @REQUIERE_OC VARCHAR(1)
	DECLARE @ES_CORPORACION VARCHAR(1)
	DECLARE @CLI_CORPORAC_ASOC VARCHAR(20)
	DECLARE @REGISTRARDOCSACORP VARCHAR(1)
	DECLARE @USAR_DIREMB_CORP VARCHAR(1)
	DECLARE @APLICAC_ABIERTAS VARCHAR(1)
	DECLARE @VERIF_LIMCRED_CORP VARCHAR(1)
	DECLARE @USAR_DESC_CORP VARCHAR(1)
	DECLARE @DOC_A_GENERAR VARCHAR(1)
	DECLARE @RUBRO1_CLIENTE VARCHAR(40)
	DECLARE @RUBRO2_CLIENTE VARCHAR(40)
	DECLARE @RUBRO3_CLIENTE VARCHAR(40)
	DECLARE @TIENE_CONVENIO VARCHAR(1)
	DECLARE @DIAS_PROMED_ATRASO INT
	DECLARE @RUBRO1_CLI VARCHAR(50)
	DECLARE @RUBRO2_CLI VARCHAR(50)
	DECLARE @RUBRO3_CLI VARCHAR(50)
	DECLARE @RUBRO4_CLI VARCHAR(50)
	DECLARE @RUBRO5_CLI VARCHAR(50)
	DECLARE @ASOCOBLIGCONTFACT VARCHAR(1)
	DECLARE @RUBRO4_CLIENTE VARCHAR(40)
	DECLARE @RUBRO5_CLIENTE VARCHAR(40)
	DECLARE @RUBRO6_CLIENTE VARCHAR(40)
	DECLARE @RUBRO7_CLIENTE VARCHAR(40)
	DECLARE @RUBRO8_CLIENTE VARCHAR(40)
	DECLARE @RUBRO9_CLIENTE VARCHAR(40)
	DECLARE @RUBRO10_CLIENTE VARCHAR(40)
	DECLARE @USAR_PRECIOS_CORP VARCHAR(1)
	DECLARE @USAR_EXENCIMP_CORP VARCHAR(1)
	DECLARE @DIAS_DE_COBRO VARCHAR(13)
	DECLARE @AJUSTE_FECHA_COBRO VARCHAR(1)
	DECLARE @GLN VARCHAR(13)
	DECLARE @UBICACION VARCHAR(10)
	DECLARE @CLASE_DOCUMENTO VARCHAR(1)
	DECLARE @LOCAL VARCHAR(1)
	DECLARE @TIPO_CONTRIBUYENTE VARCHAR(1)
	DECLARE @RUBRO11_CLIENTE VARCHAR(40)
	DECLARE @RUBRO12_CLIENTE VARCHAR(40)
	DECLARE @RUBRO13_CLIENTE VARCHAR(40)
	DECLARE @RUBRO14_CLIENTE VARCHAR(40)
	DECLARE @RUBRO15_CLIENTE VARCHAR(40)
	DECLARE @RUBRO16_CLIENTE VARCHAR(40)
	DECLARE @RUBRO17_CLIENTE VARCHAR(40)
	DECLARE @RUBRO18_CLIENTE VARCHAR(40)
	DECLARE @RUBRO19_CLIENTE VARCHAR(40)
	DECLARE @RUBRO20_CLIENTE VARCHAR(40)
	DECLARE @MODELO_RETENCION VARCHAR(4)
	DECLARE @ACEPTA_DOC_ELECTRONICO VARCHAR(1)
	DECLARE @CONFIRMA_DOC_ELECTRONICO VARCHAR(1)
	DECLARE @EMAIL_DOC_ELECTRONICO VARCHAR(40)
	DECLARE @EMAIL_PED_EDI VARCHAR(249)
	DECLARE @ACEPTA_DOC_EDI VARCHAR(1)
	DECLARE @NOTIFICAR_ERROR_EDI VARCHAR(1)
	DECLARE @EMAIL_ERROR_PED_EDI VARCHAR(249)
	DECLARE @CODIGO_IMPUESTO VARCHAR(4)
	DECLARE @DIVISION_GEOGRAFICA1 VARCHAR(12)
	DECLARE @DIVISION_GEOGRAFICA2 VARCHAR(12)
	DECLARE @REGIMEN_TRIB VARCHAR(12)
	DECLARE @MOROSO VARCHAR(1)
	DECLARE @MODIF_NOMB_EN_FAC VARCHAR(1)
	DECLARE @SALDO_TRANS DECIMAL(28,8)
	DECLARE @SALDO_TRANS_LOCAL DECIMAL(28,8)
	DECLARE @SALDO_TRANS_DOLAR DECIMAL(28,8)
	DECLARE @PERMITE_DOC_GP VARCHAR(1)
	DECLARE @PARTICIPA_FLUJOCAJA VARCHAR(1)
	DECLARE @CURP VARCHAR(18)
	DECLARE @USUARIO_CREACION VARCHAR(25)
	DECLARE @FECHA_HORA_CREACION DATETIME
	DECLARE @USUARIO_ULT_MOD VARCHAR(25)
	DECLARE @FCH_HORA_ULT_MOD DATETIME
	

	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM,
	       @TIPO_SITIO_LOCAL = TIPO_SITIO_LOCAL 
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (SYSTEM_USER = @USUARIO_POS_WSQM AND @TIPO_SITIO_LOCAL = 'T')
	BEGIN
		DECLARE C_INSERTED CURSOR LOCAL FOR
		SELECT CLIENTE, NOMBRE, DETALLE_DIRECCION, ALIAS, CONTACTO, CARGO, DIR_EMB_DEFAULT, TELEFONO1, TELEFONO2, FAX, CONTRIBUYENTE, FECHA_INGRESO, MULTIMONEDA, MONEDA, SALDO, SALDO_LOCAL, SALDO_DOLAR, SALDO_CREDITO, SALDO_NOCARGOS, LIMITE_CREDITO, EXCEDER_LIMITE, TASA_INTERES, TASA_INTERES_MORA, FECHA_ULT_MORA, FECHA_ULT_MOV, CONDICION_PAGO, NIVEL_PRECIO, DESCUENTO, MONEDA_NIVEL, ACEPTA_BACKORDER, PAIS, ZONA, RUTA, VENDEDOR, COBRADOR, ACEPTA_FRACCIONES, ACTIVO, EXENTO_IMPUESTOS, EXENCION_IMP1, EXENCION_IMP2, COBRO_JUDICIAL, CATEGORIA_CLIENTE, CLASE_ABC, DIAS_ABASTECIMIEN, USA_TARJETA, TARJETA_CREDITO, TIPO_TARJETA, FECHA_VENCE_TARJ, E_MAIL, REQUIERE_OC, ES_CORPORACION, CLI_CORPORAC_ASOC, REGISTRARDOCSACORP, USAR_DIREMB_CORP, APLICAC_ABIERTAS, VERIF_LIMCRED_CORP, USAR_DESC_CORP, DOC_A_GENERAR, RUBRO1_CLIENTE, RUBRO2_CLIENTE, RUBRO3_CLIENTE, TIENE_CONVENIO, DIAS_PROMED_ATRASO, RUBRO1_CLI, RUBRO2_CLI, RUBRO3_CLI, RUBRO4_CLI, RUBRO5_CLI, ASOCOBLIGCONTFACT, RUBRO4_CLIENTE, RUBRO5_CLIENTE, RUBRO6_CLIENTE, RUBRO7_CLIENTE, RUBRO8_CLIENTE, RUBRO9_CLIENTE, RUBRO10_CLIENTE, USAR_PRECIOS_CORP, USAR_EXENCIMP_CORP, DIAS_DE_COBRO, AJUSTE_FECHA_COBRO, GLN, UBICACION, CLASE_DOCUMENTO, LOCAL, TIPO_CONTRIBUYENTE, RUBRO11_CLIENTE, RUBRO12_CLIENTE, RUBRO13_CLIENTE, RUBRO14_CLIENTE, RUBRO15_CLIENTE, RUBRO16_CLIENTE, RUBRO17_CLIENTE, RUBRO18_CLIENTE, RUBRO19_CLIENTE, RUBRO20_CLIENTE, MODELO_RETENCION, ACEPTA_DOC_ELECTRONICO, CONFIRMA_DOC_ELECTRONICO, EMAIL_DOC_ELECTRONICO, EMAIL_PED_EDI, ACEPTA_DOC_EDI, NOTIFICAR_ERROR_EDI, EMAIL_ERROR_PED_EDI, CODIGO_IMPUESTO, DIVISION_GEOGRAFICA1, DIVISION_GEOGRAFICA2, REGIMEN_TRIB, MOROSO, MODIF_NOMB_EN_FAC, SALDO_TRANS, SALDO_TRANS_LOCAL, SALDO_TRANS_DOLAR, PERMITE_DOC_GP, PARTICIPA_FLUJOCAJA, CURP, USUARIO_CREACION, FECHA_HORA_CREACION, USUARIO_ULT_MOD, FCH_HORA_ULT_MOD
		FROM INSERTED 
			
		OPEN C_INSERTED	
		FETCH NEXT FROM C_INSERTED INTO
		@CLIENTE, @NOMBRE, @DETALLE_DIRECCION, @ALIAS, @CONTACTO, @CARGO, @DIR_EMB_DEFAULT, @TELEFONO1, @TELEFONO2, @FAX, @CONTRIBUYENTE, @FECHA_INGRESO, @MULTIMONEDA, @MONEDA, @SALDO, @SALDO_LOCAL, @SALDO_DOLAR, @SALDO_CREDITO, @SALDO_NOCARGOS, @LIMITE_CREDITO, @EXCEDER_LIMITE, @TASA_INTERES, @TASA_INTERES_MORA, @FECHA_ULT_MORA, @FECHA_ULT_MOV, @CONDICION_PAGO, @NIVEL_PRECIO, @DESCUENTO, @MONEDA_NIVEL, @ACEPTA_BACKORDER, @PAIS, @ZONA, @RUTA, @VENDEDOR, @COBRADOR, @ACEPTA_FRACCIONES, @ACTIVO, @EXENTO_IMPUESTOS, @EXENCION_IMP1, @EXENCION_IMP2, @COBRO_JUDICIAL, @CATEGORIA_CLIENTE, @CLASE_ABC, @DIAS_ABASTECIMIEN, @USA_TARJETA, @TARJETA_CREDITO, @TIPO_TARJETA, @FECHA_VENCE_TARJ, @E_MAIL, @REQUIERE_OC, @ES_CORPORACION, @CLI_CORPORAC_ASOC, @REGISTRARDOCSACORP, @USAR_DIREMB_CORP, @APLICAC_ABIERTAS, @VERIF_LIMCRED_CORP, @USAR_DESC_CORP, @DOC_A_GENERAR, @RUBRO1_CLIENTE, @RUBRO2_CLIENTE, @RUBRO3_CLIENTE, @TIENE_CONVENIO, @DIAS_PROMED_ATRASO, @RUBRO1_CLI, @RUBRO2_CLI, @RUBRO3_CLI, @RUBRO4_CLI, @RUBRO5_CLI, @ASOCOBLIGCONTFACT, @RUBRO4_CLIENTE, @RUBRO5_CLIENTE, @RUBRO6_CLIENTE, @RUBRO7_CLIENTE, @RUBRO8_CLIENTE, @RUBRO9_CLIENTE, @RUBRO10_CLIENTE, @USAR_PRECIOS_CORP, @USAR_EXENCIMP_CORP, @DIAS_DE_COBRO, @AJUSTE_FECHA_COBRO, @GLN, @UBICACION, @CLASE_DOCUMENTO, @LOCAL, @TIPO_CONTRIBUYENTE, @RUBRO11_CLIENTE, @RUBRO12_CLIENTE, @RUBRO13_CLIENTE, @RUBRO14_CLIENTE, @RUBRO15_CLIENTE, @RUBRO16_CLIENTE, @RUBRO17_CLIENTE, @RUBRO18_CLIENTE, @RUBRO19_CLIENTE, @RUBRO20_CLIENTE, @MODELO_RETENCION, @ACEPTA_DOC_ELECTRONICO, @CONFIRMA_DOC_ELECTRONICO, @EMAIL_DOC_ELECTRONICO, @EMAIL_PED_EDI, @ACEPTA_DOC_EDI, @NOTIFICAR_ERROR_EDI, @EMAIL_ERROR_PED_EDI, @CODIGO_IMPUESTO, @DIVISION_GEOGRAFICA1, @DIVISION_GEOGRAFICA2, @REGIMEN_TRIB, @MOROSO, @MODIF_NOMB_EN_FAC, @SALDO_TRANS, @SALDO_TRANS_LOCAL, @SALDO_TRANS_DOLAR, @PERMITE_DOC_GP, @PARTICIPA_FLUJOCAJA, @CURP, @USUARIO_CREACION, @FECHA_HORA_CREACION, @USUARIO_ULT_MOD, @FCH_HORA_ULT_MOD

		SET @ERROR = 0
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
		
			IF @TIPO_SITIO_LOCAL = 'C'
			BEGIN
				SET @DIRECCION = ''
				--OBTIENE EL TIPO DE DIRECCION DEL CLIENTE
				SELECT @TIPO_DIRECCION = DIRECCION FROM $$Compania$$.DETALLE_DIRECCION WHERE DETALLE_DIRECCION = @DETALLE_DIRECCION

				--OBTIENE EL NOMBRE DE LOS CAMPOS UTILIZADOS EN EL TIPO DE DIRECCION 	
				SELECT @NOMBRE_CAMPO1 = NOMBRE_CAMPO_1,
					   @NOMBRE_CAMPO2 = NOMBRE_CAMPO_2, 
				   @NOMBRE_CAMPO3 = NOMBRE_CAMPO_3, 
				   @NOMBRE_CAMPO4 = NOMBRE_CAMPO_4, 
				   @NOMBRE_CAMPO5 = NOMBRE_CAMPO_5, 
				   @NOMBRE_CAMPO6 = NOMBRE_CAMPO_6, 
				   @NOMBRE_CAMPO7 = NOMBRE_CAMPO_7, 
				   @NOMBRE_CAMPO8 = NOMBRE_CAMPO_8, 
				   @NOMBRE_CAMPO9 = NOMBRE_CAMPO_9,
				   @NOMBRE_CAMPO10 = NOMBRE_CAMPO_10
				FROM $$Compania$$.DIRECCION
				   WHERE DIRECCION = @TIPO_DIRECCION

				--OBTIENE EL DETALLE DE CADA UNO DE LOS CAMPOS
				SELECT @DETALLE_CAMPO1 = CAMPO_1,
				       @DETALLE_CAMPO2 = CAMPO_2, 
				   @DETALLE_CAMPO3 = CAMPO_3, 
				   @DETALLE_CAMPO4 = CAMPO_4, 
				   @DETALLE_CAMPO5 = CAMPO_5, 
				   @DETALLE_CAMPO6 = CAMPO_6, 
				   @DETALLE_CAMPO7 = CAMPO_7, 
				   @DETALLE_CAMPO8 = CAMPO_8, 
				   @DETALLE_CAMPO9 = CAMPO_9,
				   @DETALLE_CAMPO10 =CAMPO_10
				FROM $$Compania$$.DETALLE_DIRECCION
				    WHERE DETALLE_DIRECCION = @DETALLE_DIRECCION

				--SE ARMA LA DIRECCION

				IF ISNULL(@DETALLE_CAMPO1,'') != ''
				BEGIN
				 SET @DIRECCION = @NOMBRE_CAMPO1 + ': ' + @DETALLE_CAMPO1 + ' '			
				END

				IF ISNULL(@DETALLE_CAMPO2,'') != ''
				BEGIN
				 SET @DIRECCION = @DIRECCION + @NOMBRE_CAMPO2+': '+@DETALLE_CAMPO2 +' '			
				END

				IF ISNULL(@DETALLE_CAMPO3,'') != ''
				BEGIN
				 SET @DIRECCION = @DIRECCION + @NOMBRE_CAMPO3+': '+@DETALLE_CAMPO3+' '
				END

				IF ISNULL(@DETALLE_CAMPO4,'') != ''
				BEGIN
				 SET @DIRECCION = @DIRECCION + @NOMBRE_CAMPO4+': '+@DETALLE_CAMPO4+' '
				END

				IF ISNULL(@DETALLE_CAMPO5,'') != ''
				BEGIN
				 SET @DIRECCION = @DIRECCION + @NOMBRE_CAMPO5+': '+@DETALLE_CAMPO5+' '
				END

				IF ISNULL(@DETALLE_CAMPO6,'') != ''
				BEGIN
				 SET @DIRECCION = @DIRECCION + @NOMBRE_CAMPO6+': '+@DETALLE_CAMPO6+' ' 
				END

				IF ISNULL(@DETALLE_CAMPO7,'') != ''
				BEGIN
				 SET @DIRECCION = @DIRECCION + @NOMBRE_CAMPO7+': '+@DETALLE_CAMPO7+' ' 
				END

				IF ISNULL(@DETALLE_CAMPO8,'') != ''
				BEGIN
				 SET @DIRECCION = @DIRECCION + @NOMBRE_CAMPO8+': '+@DETALLE_CAMPO8+' ' 
				END

				IF ISNULL(@DETALLE_CAMPO9,'') != ''
				BEGIN
				 SET @DIRECCION = @DIRECCION + @NOMBRE_CAMPO9+': '+@DETALLE_CAMPO9+' '
				END

				IF ISNULL(@DETALLE_CAMPO10,'') != ''
				BEGIN
				 SET @DIRECCION = @DIRECCION + @NOMBRE_CAMPO10+': '+@DETALLE_CAMPO10 
				END
			END

			IF @TIPO_SITIO_LOCAL = 'T'
			BEGIN
				SET @DIRECCION = ''
			END		
			
			SET @PARAMETROS1 = 
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<CLIENTE>' + 
				'<CLIENTE Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CLIENTE) + '</CLIENTE>' + 
				'<NOMBRE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOMBRE) + '</NOMBRE>' + 
				'<DETALLE_DIRECCION Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@DETALLE_DIRECCION) + '</DETALLE_DIRECCION>' + 
				'<ALIAS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ALIAS) + '</ALIAS>' + 
				'<CONTACTO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CONTACTO) + '</CONTACTO>' + 
				'<CARGO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CARGO) + '</CARGO>' + 
				'<DIR_EMB_DEFAULT Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DIR_EMB_DEFAULT) + '</DIR_EMB_DEFAULT>' + 
				'<TELEFONO1 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TELEFONO1) + '</TELEFONO1>' + 
				'<TELEFONO2 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TELEFONO2) + '</TELEFONO2>' + 
				'<FAX Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@FAX) + '</FAX>' + 
				'<CONTRIBUYENTE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CONTRIBUYENTE) + '</CONTRIBUYENTE>' + 
				'<FECHA_INGRESO Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_INGRESO) + '</FECHA_INGRESO>' + 
				'<MULTIMONEDA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@MULTIMONEDA) + '</MULTIMONEDA>' + 
				'<MONEDA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@MONEDA) + '</MONEDA>' + 
				'<SALDO Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@SALDO) + '</SALDO>' + 
				'<SALDO_LOCAL Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@SALDO_LOCAL) + '</SALDO_LOCAL>' + 
				'<SALDO_DOLAR Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@SALDO_DOLAR) + '</SALDO_DOLAR>' + 
				'<SALDO_CREDITO Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@SALDO_CREDITO) + '</SALDO_CREDITO>' + 
				'<SALDO_NOCARGOS Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@SALDO_NOCARGOS) + '</SALDO_NOCARGOS>' + 
				'<LIMITE_CREDITO Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@LIMITE_CREDITO) + '</LIMITE_CREDITO>' + 
				'<EXCEDER_LIMITE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@EXCEDER_LIMITE) + '</EXCEDER_LIMITE>' + 
				'<TASA_INTERES Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@TASA_INTERES) + '</TASA_INTERES>' + 
				'<TASA_INTERES_MORA Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@TASA_INTERES_MORA) + '</TASA_INTERES_MORA>' + 
				'<FECHA_ULT_MORA Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_ULT_MORA) + '</FECHA_ULT_MORA>' + 
				'<FECHA_ULT_MOV Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_ULT_MOV) + '</FECHA_ULT_MOV>' + 
				'<CONDICION_PAGO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CONDICION_PAGO) + '</CONDICION_PAGO>' + 
				'<NIVEL_PRECIO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NIVEL_PRECIO) + '</NIVEL_PRECIO>' + 
				'<DESCUENTO Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@DESCUENTO) + '</DESCUENTO>' + 
				'<MONEDA_NIVEL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@MONEDA_NIVEL) + '</MONEDA_NIVEL>' + 
				'<ACEPTA_BACKORDER Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ACEPTA_BACKORDER) + '</ACEPTA_BACKORDER>' + 
				'<PAIS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@PAIS) + '</PAIS>' + 
				'<ZONA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ZONA) + '</ZONA>' + 
				'<RUTA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@RUTA) + '</RUTA>' + 
				'<VENDEDOR Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@VENDEDOR) + '</VENDEDOR>' + 
				'<COBRADOR Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@COBRADOR) + '</COBRADOR>' + 
				'<ACEPTA_FRACCIONES Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ACEPTA_FRACCIONES) + '</ACEPTA_FRACCIONES>' + 
				'<ACTIVO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ACTIVO) + '</ACTIVO>' + 
				'<EXENTO_IMPUESTOS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@EXENTO_IMPUESTOS) + '</EXENTO_IMPUESTOS>' + 
				'<EXENCION_IMP1 Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@EXENCION_IMP1) + '</EXENCION_IMP1>' + 
				'<EXENCION_IMP2 Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@EXENCION_IMP2) + '</EXENCION_IMP2>' + 
				'<COBRO_JUDICIAL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@COBRO_JUDICIAL) + '</COBRO_JUDICIAL>' + 
				'<CATEGORIA_CLIENTE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CATEGORIA_CLIENTE) + '</CATEGORIA_CLIENTE>' + 
				'<CLASE_ABC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CLASE_ABC) + '</CLASE_ABC>' + 
				'<DIAS_ABASTECIMIEN Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@DIAS_ABASTECIMIEN) + '</DIAS_ABASTECIMIEN>' + 
				'<USA_TARJETA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USA_TARJETA) + '</USA_TARJETA>' + 
				'<TARJETA_CREDITO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TARJETA_CREDITO) + '</TARJETA_CREDITO>' + 
				'<TIPO_TARJETA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_TARJETA) + '</TIPO_TARJETA>' + 
				'<FECHA_VENCE_TARJ Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_VENCE_TARJ) + '</FECHA_VENCE_TARJ>' + 
				'<E_MAIL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@E_MAIL) + '</E_MAIL>' + 
				'<REQUIERE_OC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@REQUIERE_OC) + '</REQUIERE_OC>' + 
				'<ES_CORPORACION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ES_CORPORACION) + '</ES_CORPORACION>' + 
				'<CLI_CORPORAC_ASOC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CLI_CORPORAC_ASOC) + '</CLI_CORPORAC_ASOC>' + 
				'<REGISTRARDOCSACORP Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@REGISTRARDOCSACORP) + '</REGISTRARDOCSACORP>' + 
				'<USAR_DIREMB_CORP Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USAR_DIREMB_CORP) + '</USAR_DIREMB_CORP>' + 
				'<APLICAC_ABIERTAS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@APLICAC_ABIERTAS) + '</APLICAC_ABIERTAS>' + 
				'<VERIF_LIMCRED_CORP Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@VERIF_LIMCRED_CORP) + '</VERIF_LIMCRED_CORP>' + 
				'<USAR_DESC_CORP Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USAR_DESC_CORP) + '</USAR_DESC_CORP>' + 
				'<DOC_A_GENERAR Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DOC_A_GENERAR) + '</DOC_A_GENERAR>' + 
				'<RUBRO1_CLIENTE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@RUBRO1_CLIENTE) + '</RUBRO1_CLIENTE>' + 
				'<RUBRO2_CLIENTE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@RUBRO2_CLIENTE) + '</RUBRO2_CLIENTE>' + 
				'<RUBRO3_CLIENTE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@RUBRO3_CLIENTE) + '</RUBRO3_CLIENTE>' + 
				'<TIENE_CONVENIO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIENE_CONVENIO) + '</TIENE_CONVENIO>' + 
				'<DIAS_PROMED_ATRASO Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@DIAS_PROMED_ATRASO) + '</DIAS_PROMED_ATRASO>' + 
				'<RUBRO1_CLI Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@RUBRO1_CLI) + '</RUBRO1_CLI>' + 
				'<RUBRO2_CLI Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@RUBRO2_CLI) + '</RUBRO2_CLI>'
				
				
			SET @PARAMETROS2 = 
				'<RUBRO3_CLI Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@RUBRO3_CLI) + '</RUBRO3_CLI>' + 
				'<RUBRO4_CLI Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@RUBRO4_CLI) + '</RUBRO4_CLI>' + 
				'<RUBRO5_CLI Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@RUBRO5_CLI) + '</RUBRO5_CLI>' + 
				'<ASOCOBLIGCONTFACT Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ASOCOBLIGCONTFACT) + '</ASOCOBLIGCONTFACT>' + 
				'<RUBRO4_CLIENTE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@RUBRO4_CLIENTE) + '</RUBRO4_CLIENTE>' + 
				'<RUBRO5_CLIENTE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@RUBRO5_CLIENTE) + '</RUBRO5_CLIENTE>' + 
				'<RUBRO6_CLIENTE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@RUBRO6_CLIENTE) + '</RUBRO6_CLIENTE>' + 
				'<RUBRO7_CLIENTE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@RUBRO7_CLIENTE) + '</RUBRO7_CLIENTE>' + 
				'<RUBRO8_CLIENTE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@RUBRO8_CLIENTE) + '</RUBRO8_CLIENTE>' + 
				'<RUBRO9_CLIENTE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@RUBRO9_CLIENTE) + '</RUBRO9_CLIENTE>' + 
				'<RUBRO10_CLIENTE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@RUBRO10_CLIENTE) + '</RUBRO10_CLIENTE>' + 
				'<USAR_PRECIOS_CORP Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USAR_PRECIOS_CORP) + '</USAR_PRECIOS_CORP>' + 
				'<USAR_EXENCIMP_CORP Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USAR_EXENCIMP_CORP) + '</USAR_EXENCIMP_CORP>' + 
				'<DIAS_DE_COBRO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DIAS_DE_COBRO) + '</DIAS_DE_COBRO>' + 
				'<AJUSTE_FECHA_COBRO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@AJUSTE_FECHA_COBRO) + '</AJUSTE_FECHA_COBRO>' + 
				'<GLN Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@GLN) + '</GLN>' + 
				'<UBICACION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@UBICACION) + '</UBICACION>' + 
				'<CLASE_DOCUMENTO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CLASE_DOCUMENTO) + '</CLASE_DOCUMENTO>' + 
				'<LOCAL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@LOCAL) + '</LOCAL>' + 
				'<TIPO_CONTRIBUYENTE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_CONTRIBUYENTE) + '</TIPO_CONTRIBUYENTE>' + 
				'<RUBRO11_CLIENTE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@RUBRO11_CLIENTE) + '</RUBRO11_CLIENTE>' + 
				'<RUBRO12_CLIENTE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@RUBRO12_CLIENTE) + '</RUBRO12_CLIENTE>' + 
				'<RUBRO13_CLIENTE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@RUBRO13_CLIENTE) + '</RUBRO13_CLIENTE>' + 
				'<RUBRO14_CLIENTE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@RUBRO14_CLIENTE) + '</RUBRO14_CLIENTE>' + 
				'<RUBRO15_CLIENTE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@RUBRO15_CLIENTE) + '</RUBRO15_CLIENTE>' + 
				'<RUBRO16_CLIENTE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@RUBRO16_CLIENTE) + '</RUBRO16_CLIENTE>' + 
				'<RUBRO17_CLIENTE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@RUBRO17_CLIENTE) + '</RUBRO17_CLIENTE>' + 
				'<RUBRO18_CLIENTE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@RUBRO18_CLIENTE) + '</RUBRO18_CLIENTE>' + 
				'<RUBRO19_CLIENTE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@RUBRO19_CLIENTE) + '</RUBRO19_CLIENTE>' + 
				'<RUBRO20_CLIENTE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@RUBRO20_CLIENTE) + '</RUBRO20_CLIENTE>' + 
				'<MODELO_RETENCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@MODELO_RETENCION) + '</MODELO_RETENCION>' + 
				'<ACEPTA_DOC_ELECTRONICO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ACEPTA_DOC_ELECTRONICO) + '</ACEPTA_DOC_ELECTRONICO>' + 
				'<CONFIRMA_DOC_ELECTRONICO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CONFIRMA_DOC_ELECTRONICO) + '</CONFIRMA_DOC_ELECTRONICO>' + 
				'<EMAIL_DOC_ELECTRONICO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@EMAIL_DOC_ELECTRONICO) + '</EMAIL_DOC_ELECTRONICO>' + 
				'<EMAIL_PED_EDI Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@EMAIL_PED_EDI) + '</EMAIL_PED_EDI>' + 
				'<ACEPTA_DOC_EDI Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ACEPTA_DOC_EDI) + '</ACEPTA_DOC_EDI>' + 
				'<NOTIFICAR_ERROR_EDI Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOTIFICAR_ERROR_EDI) + '</NOTIFICAR_ERROR_EDI>' + 
				'<EMAIL_ERROR_PED_EDI Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@EMAIL_ERROR_PED_EDI) + '</EMAIL_ERROR_PED_EDI>' + 
				'<CODIGO_IMPUESTO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CODIGO_IMPUESTO) + '</CODIGO_IMPUESTO>' + 
				'<DIVISION_GEOGRAFICA1 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DIVISION_GEOGRAFICA1) + '</DIVISION_GEOGRAFICA1>' + 
				'<DIVISION_GEOGRAFICA2 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DIVISION_GEOGRAFICA2) + '</DIVISION_GEOGRAFICA2>' + 
				'<REGIMEN_TRIB Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@REGIMEN_TRIB) + '</REGIMEN_TRIB>' + 
				'<MOROSO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@MOROSO) + '</MOROSO>' + 
				'<MODIF_NOMB_EN_FAC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@MODIF_NOMB_EN_FAC) + '</MODIF_NOMB_EN_FAC>' + 
				'<SALDO_TRANS Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@SALDO_TRANS) + '</SALDO_TRANS>' + 
				'<SALDO_TRANS_LOCAL Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@SALDO_TRANS_LOCAL) + '</SALDO_TRANS_LOCAL>' + 
				'<SALDO_TRANS_DOLAR Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@SALDO_TRANS_DOLAR) + '</SALDO_TRANS_DOLAR>' + 
				'<PERMITE_DOC_GP Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@PERMITE_DOC_GP) + '</PERMITE_DOC_GP>' + 
				'<PARTICIPA_FLUJOCAJA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@PARTICIPA_FLUJOCAJA) + '</PARTICIPA_FLUJOCAJA>' + 
				'<CURP Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CURP) + '</CURP>' + 
				'<USUARIO_CREACION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USUARIO_CREACION) + '</USUARIO_CREACION>' + 
				'<FECHA_HORA_CREACION Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_HORA_CREACION) + '</FECHA_HORA_CREACION>' + 
				'<USUARIO_ULT_MOD Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USUARIO_ULT_MOD) + '</USUARIO_ULT_MOD>' + 
				'<FCH_HORA_ULT_MOD Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FCH_HORA_ULT_MOD) + '</FCH_HORA_ULT_MOD>' + 
				'<DIRECCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DIRECCION) + '</DIRECCION>' +
				'</CLIENTE>'
				
			-- Inserta la solicitud correspondiente
			
			EXECUTE  ('ERPADMIN.POS_InsertarSolicitud ''' + @PUBLICADOR + ''', ''CLIENTEPOS600'', ''INSERTA'', ''' + @PARAMETROS1 + @PARAMETROS2 + ''', 0, ''''')

			FETCH NEXT FROM C_INSERTED INTO
			@CLIENTE, @NOMBRE, @DETALLE_DIRECCION, @ALIAS, @CONTACTO, @CARGO, @DIR_EMB_DEFAULT, @TELEFONO1, @TELEFONO2, @FAX, @CONTRIBUYENTE, @FECHA_INGRESO, @MULTIMONEDA, @MONEDA, @SALDO, @SALDO_LOCAL, @SALDO_DOLAR, @SALDO_CREDITO, @SALDO_NOCARGOS, @LIMITE_CREDITO, @EXCEDER_LIMITE, @TASA_INTERES, @TASA_INTERES_MORA, @FECHA_ULT_MORA, @FECHA_ULT_MOV, @CONDICION_PAGO, @NIVEL_PRECIO, @DESCUENTO, @MONEDA_NIVEL, @ACEPTA_BACKORDER, @PAIS, @ZONA, @RUTA, @VENDEDOR, @COBRADOR, @ACEPTA_FRACCIONES, @ACTIVO, @EXENTO_IMPUESTOS, @EXENCION_IMP1, @EXENCION_IMP2, @COBRO_JUDICIAL, @CATEGORIA_CLIENTE, @CLASE_ABC, @DIAS_ABASTECIMIEN, @USA_TARJETA, @TARJETA_CREDITO, @TIPO_TARJETA, @FECHA_VENCE_TARJ, @E_MAIL, @REQUIERE_OC, @ES_CORPORACION, @CLI_CORPORAC_ASOC, @REGISTRARDOCSACORP, @USAR_DIREMB_CORP, @APLICAC_ABIERTAS, @VERIF_LIMCRED_CORP, @USAR_DESC_CORP, @DOC_A_GENERAR, @RUBRO1_CLIENTE, @RUBRO2_CLIENTE, @RUBRO3_CLIENTE, @TIENE_CONVENIO, @DIAS_PROMED_ATRASO, @RUBRO1_CLI, @RUBRO2_CLI, @RUBRO3_CLI, @RUBRO4_CLI, @RUBRO5_CLI, @ASOCOBLIGCONTFACT, @RUBRO4_CLIENTE, @RUBRO5_CLIENTE, @RUBRO6_CLIENTE, @RUBRO7_CLIENTE, @RUBRO8_CLIENTE, @RUBRO9_CLIENTE, @RUBRO10_CLIENTE, @USAR_PRECIOS_CORP, @USAR_EXENCIMP_CORP, @DIAS_DE_COBRO, @AJUSTE_FECHA_COBRO, @GLN, @UBICACION, @CLASE_DOCUMENTO, @LOCAL, @TIPO_CONTRIBUYENTE, @RUBRO11_CLIENTE, @RUBRO12_CLIENTE, @RUBRO13_CLIENTE, @RUBRO14_CLIENTE, @RUBRO15_CLIENTE, @RUBRO16_CLIENTE, @RUBRO17_CLIENTE, @RUBRO18_CLIENTE, @RUBRO19_CLIENTE, @RUBRO20_CLIENTE, @MODELO_RETENCION, @ACEPTA_DOC_ELECTRONICO, @CONFIRMA_DOC_ELECTRONICO, @EMAIL_DOC_ELECTRONICO, @EMAIL_PED_EDI, @ACEPTA_DOC_EDI, @NOTIFICAR_ERROR_EDI, @EMAIL_ERROR_PED_EDI, @CODIGO_IMPUESTO, @DIVISION_GEOGRAFICA1, @DIVISION_GEOGRAFICA2, @REGIMEN_TRIB, @MOROSO, @MODIF_NOMB_EN_FAC, @SALDO_TRANS, @SALDO_TRANS_LOCAL, @SALDO_TRANS_DOLAR, @PERMITE_DOC_GP, @PARTICIPA_FLUJOCAJA, @CURP, @USUARIO_CREACION, @FECHA_HORA_CREACION, @USUARIO_ULT_MOD, @FCH_HORA_ULT_MOD
		END

		CLOSE C_INSERTED
    		DEALLOCATE C_INSERTED
	END

	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla CLIENTE.',16,1 )
	END
END;




CREATE TRIGGER $$Compania$$.CLIENTE_POS_DEL
ON $$Compania$$.CLIENTE
FOR DELETE
AS
BEGIN   	
                DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @CLIENTE VARCHAR(20)
	 -- Declaraciones	
	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_DELETED CURSOR LOCAL FOR
			SELECT CLIENTE
			FROM DELETED d
			WHERE 0 = (
				SELECT COUNT('n')
				FROM INSERTED i
				WHERE d.CLIENTE = i.CLIENTE
			   )
		OPEN C_DELETED
		FETCH NEXT FROM C_DELETED INTO
		@CLIENTE
		
		SET @ERROR = 0
		
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS =
								'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<CLIENTE>' +
				'<CLIENTE Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CLIENTE) + '</CLIENTE>' +
				'</CLIENTE>'
 -- XML
			
			-- inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'CLIENTEPOS600', 'ELIMINA', @PARAMETROS, 0, ''
			
			FETCH NEXT FROM C_DELETED INTO
			@CLIENTE
		END
		CLOSE C_DELETED
		DEALLOCATE C_DELETED
	END
	
	IF (@@ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para eliminar de la tabla CLIENTE.',16,1 )
	END
END
;


CREATE TRIGGER $$Compania$$.CLIENTE_POS_MOD
ON $$Compania$$.CLIENTE
FOR UPDATE
AS 
BEGIN   	
	DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS1 VARCHAR(8000)
	DECLARE @PARAMETROS2 VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @TIPO_SITIO_LOCAL VARCHAR(1)
	DECLARE @COL_ROWPOINTER VARCHAR(36)
	DECLARE @HAY_CAMPOS_PARA_POS BIT
	DECLARE @ACTUALIZAR_SOLICITUD BIT
	DECLARE @CLIENTE VARCHAR(20)
	DECLARE @NOMBRE VARCHAR(80)
	DECLARE @DETALLE_DIRECCION INT
	DECLARE @ALIAS VARCHAR(80)
	DECLARE @CONTACTO VARCHAR(30)
	DECLARE @CARGO VARCHAR(30)
	DECLARE @DIR_EMB_DEFAULT VARCHAR(8)
	DECLARE @TELEFONO1 VARCHAR(15)
	DECLARE @TELEFONO2 VARCHAR(15)
	DECLARE @FAX VARCHAR(15)
	DECLARE @CONTRIBUYENTE VARCHAR(20)
	DECLARE @FECHA_INGRESO DATETIME
	DECLARE @MULTIMONEDA VARCHAR(1)
	DECLARE @MONEDA VARCHAR(4)
	DECLARE @SALDO DECIMAL(28,8)
	DECLARE @SALDO_LOCAL DECIMAL(28,8)
	DECLARE @SALDO_DOLAR DECIMAL(28,8)
	DECLARE @SALDO_CREDITO DECIMAL(28,8)
	DECLARE @SALDO_NOCARGOS DECIMAL(28,8)
	DECLARE @LIMITE_CREDITO DECIMAL(28,8)
	DECLARE @EXCEDER_LIMITE VARCHAR(1)
	DECLARE @TASA_INTERES DECIMAL(28,8)
	DECLARE @TASA_INTERES_MORA DECIMAL(28,8)
	DECLARE @FECHA_ULT_MORA DATETIME
	DECLARE @FECHA_ULT_MOV DATETIME
	DECLARE @CONDICION_PAGO VARCHAR(4)
	DECLARE @NIVEL_PRECIO VARCHAR(12)
	DECLARE @DESCUENTO DECIMAL(28,8)
	DECLARE @MONEDA_NIVEL VARCHAR(1)
	DECLARE @ACEPTA_BACKORDER VARCHAR(1)
	DECLARE @PAIS VARCHAR(4)
	DECLARE @ZONA VARCHAR(4)
	DECLARE @RUTA VARCHAR(4)
	DECLARE @VENDEDOR VARCHAR(4)
	DECLARE @COBRADOR VARCHAR(4)
	DECLARE @ACEPTA_FRACCIONES VARCHAR(1)
	DECLARE @ACTIVO VARCHAR(1)
	DECLARE @EXENTO_IMPUESTOS VARCHAR(1)
	DECLARE @EXENCION_IMP1 DECIMAL(28,8)
	DECLARE @EXENCION_IMP2 DECIMAL(28,8)
	DECLARE @COBRO_JUDICIAL VARCHAR(1)
	DECLARE @CATEGORIA_CLIENTE VARCHAR(8)
	DECLARE @CLASE_ABC VARCHAR(1)
	DECLARE @DIAS_ABASTECIMIEN INT
	DECLARE @USA_TARJETA VARCHAR(1)
	DECLARE @TARJETA_CREDITO VARCHAR(20)
	DECLARE @TIPO_TARJETA VARCHAR(12)
	DECLARE @FECHA_VENCE_TARJ DATETIME
	DECLARE @E_MAIL VARCHAR(249)
	DECLARE @REQUIERE_OC VARCHAR(1)
	DECLARE @ES_CORPORACION VARCHAR(1)
	DECLARE @CLI_CORPORAC_ASOC VARCHAR(20)
	DECLARE @REGISTRARDOCSACORP VARCHAR(1)
	DECLARE @USAR_DIREMB_CORP VARCHAR(1)
	DECLARE @APLICAC_ABIERTAS VARCHAR(1)
	DECLARE @VERIF_LIMCRED_CORP VARCHAR(1)
	DECLARE @USAR_DESC_CORP VARCHAR(1)
	DECLARE @DOC_A_GENERAR VARCHAR(1)
	DECLARE @RUBRO1_CLIENTE VARCHAR(40)
	DECLARE @RUBRO2_CLIENTE VARCHAR(40)
	DECLARE @RUBRO3_CLIENTE VARCHAR(40)
	DECLARE @TIENE_CONVENIO VARCHAR(1)
	DECLARE @DIAS_PROMED_ATRASO INT
	DECLARE @RUBRO1_CLI VARCHAR(50)
	DECLARE @RUBRO2_CLI VARCHAR(50)
	DECLARE @RUBRO3_CLI VARCHAR(50)
	DECLARE @RUBRO4_CLI VARCHAR(50)
	DECLARE @RUBRO5_CLI VARCHAR(50)
	DECLARE @ASOCOBLIGCONTFACT VARCHAR(1)
	DECLARE @RUBRO4_CLIENTE VARCHAR(40)
	DECLARE @RUBRO5_CLIENTE VARCHAR(40)
	DECLARE @RUBRO6_CLIENTE VARCHAR(40)
	DECLARE @RUBRO7_CLIENTE VARCHAR(40)
	DECLARE @RUBRO8_CLIENTE VARCHAR(40)
	DECLARE @RUBRO9_CLIENTE VARCHAR(40)
	DECLARE @RUBRO10_CLIENTE VARCHAR(40)
	DECLARE @USAR_PRECIOS_CORP VARCHAR(1)
	DECLARE @USAR_EXENCIMP_CORP VARCHAR(1)
	DECLARE @DIAS_DE_COBRO VARCHAR(13)
	DECLARE @AJUSTE_FECHA_COBRO VARCHAR(1)
	DECLARE @GLN VARCHAR(13)
	DECLARE @UBICACION VARCHAR(10)
	DECLARE @CLASE_DOCUMENTO VARCHAR(1)
	DECLARE @LOCAL VARCHAR(1)
	DECLARE @TIPO_CONTRIBUYENTE VARCHAR(1)
	DECLARE @RUBRO11_CLIENTE VARCHAR(40)
	DECLARE @RUBRO12_CLIENTE VARCHAR(40)
	DECLARE @RUBRO13_CLIENTE VARCHAR(40)
	DECLARE @RUBRO14_CLIENTE VARCHAR(40)
	DECLARE @RUBRO15_CLIENTE VARCHAR(40)
	DECLARE @RUBRO16_CLIENTE VARCHAR(40)
	DECLARE @RUBRO17_CLIENTE VARCHAR(40)
	DECLARE @RUBRO18_CLIENTE VARCHAR(40)
	DECLARE @RUBRO19_CLIENTE VARCHAR(40)
	DECLARE @RUBRO20_CLIENTE VARCHAR(40)
	DECLARE @MODELO_RETENCION VARCHAR(4)
	DECLARE @ACEPTA_DOC_ELECTRONICO VARCHAR(1)
	DECLARE @CONFIRMA_DOC_ELECTRONICO VARCHAR(1)
	DECLARE @EMAIL_DOC_ELECTRONICO VARCHAR(40)
	DECLARE @EMAIL_PED_EDI VARCHAR(249)
	DECLARE @ACEPTA_DOC_EDI VARCHAR(1)
	DECLARE @NOTIFICAR_ERROR_EDI VARCHAR(1)
	DECLARE @EMAIL_ERROR_PED_EDI VARCHAR(249)
	DECLARE @CODIGO_IMPUESTO VARCHAR(4)
	DECLARE @DIVISION_GEOGRAFICA1 VARCHAR(12)
	DECLARE @DIVISION_GEOGRAFICA2 VARCHAR(12)
	DECLARE @REGIMEN_TRIB VARCHAR(12)
	DECLARE @MOROSO VARCHAR(1)
	DECLARE @MODIF_NOMB_EN_FAC VARCHAR(1)
	DECLARE @SALDO_TRANS DECIMAL(28,8)
	DECLARE @SALDO_TRANS_LOCAL DECIMAL(28,8)
	DECLARE @SALDO_TRANS_DOLAR DECIMAL(28,8)
	DECLARE @PERMITE_DOC_GP VARCHAR(1)
	DECLARE @PARTICIPA_FLUJOCAJA VARCHAR(1)
	DECLARE @CURP VARCHAR(18)
	DECLARE @USUARIO_CREACION VARCHAR(25)
	DECLARE @FECHA_HORA_CREACION DATETIME
	DECLARE @USUARIO_ULT_MOD VARCHAR(25)
	DECLARE @FCH_HORA_ULT_MOD DATETIME
	 -- Declaraciones

	SET @ERROR = 0

	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM,
	       @TIPO_SITIO_LOCAL = TIPO_SITIO_LOCAL 
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (SYSTEM_USER = @USUARIO_POS_WSQM AND @TIPO_SITIO_LOCAL = 'T')
	BEGIN
		DECLARE C_MODIFIED CURSOR LOCAL FOR
			SELECT CLIENTE, NOMBRE, DETALLE_DIRECCION, ALIAS, CONTACTO, CARGO, DIR_EMB_DEFAULT, TELEFONO1, TELEFONO2, FAX, CONTRIBUYENTE, FECHA_INGRESO, MULTIMONEDA, MONEDA, SALDO, SALDO_LOCAL, SALDO_DOLAR, SALDO_CREDITO, SALDO_NOCARGOS, LIMITE_CREDITO, EXCEDER_LIMITE, TASA_INTERES, TASA_INTERES_MORA, FECHA_ULT_MORA, FECHA_ULT_MOV, CONDICION_PAGO, NIVEL_PRECIO, DESCUENTO, MONEDA_NIVEL, ACEPTA_BACKORDER, PAIS, ZONA, RUTA, VENDEDOR, COBRADOR, ACEPTA_FRACCIONES, ACTIVO, EXENTO_IMPUESTOS, EXENCION_IMP1, EXENCION_IMP2, COBRO_JUDICIAL, CATEGORIA_CLIENTE, CLASE_ABC, DIAS_ABASTECIMIEN, USA_TARJETA, TARJETA_CREDITO, TIPO_TARJETA, FECHA_VENCE_TARJ, E_MAIL, REQUIERE_OC, ES_CORPORACION, CLI_CORPORAC_ASOC, REGISTRARDOCSACORP, USAR_DIREMB_CORP, APLICAC_ABIERTAS, VERIF_LIMCRED_CORP, USAR_DESC_CORP, DOC_A_GENERAR, RUBRO1_CLIENTE, RUBRO2_CLIENTE, RUBRO3_CLIENTE, TIENE_CONVENIO, DIAS_PROMED_ATRASO, RUBRO1_CLI, RUBRO2_CLI, RUBRO3_CLI, RUBRO4_CLI, RUBRO5_CLI, ASOCOBLIGCONTFACT, RUBRO4_CLIENTE, RUBRO5_CLIENTE, RUBRO6_CLIENTE, RUBRO7_CLIENTE, RUBRO8_CLIENTE, RUBRO9_CLIENTE, RUBRO10_CLIENTE, USAR_PRECIOS_CORP, USAR_EXENCIMP_CORP, DIAS_DE_COBRO, AJUSTE_FECHA_COBRO, GLN, UBICACION, CLASE_DOCUMENTO, LOCAL, TIPO_CONTRIBUYENTE, RUBRO11_CLIENTE, RUBRO12_CLIENTE, RUBRO13_CLIENTE, RUBRO14_CLIENTE, RUBRO15_CLIENTE, RUBRO16_CLIENTE, RUBRO17_CLIENTE, RUBRO18_CLIENTE, RUBRO19_CLIENTE, RUBRO20_CLIENTE, MODELO_RETENCION, ACEPTA_DOC_ELECTRONICO, CONFIRMA_DOC_ELECTRONICO, EMAIL_DOC_ELECTRONICO, EMAIL_PED_EDI, ACEPTA_DOC_EDI, NOTIFICAR_ERROR_EDI, EMAIL_ERROR_PED_EDI, CODIGO_IMPUESTO, DIVISION_GEOGRAFICA1, DIVISION_GEOGRAFICA2, REGIMEN_TRIB, MOROSO, MODIF_NOMB_EN_FAC, SALDO_TRANS, SALDO_TRANS_LOCAL, SALDO_TRANS_DOLAR, PERMITE_DOC_GP, PARTICIPA_FLUJOCAJA, CURP, USUARIO_CREACION, FECHA_HORA_CREACION, USUARIO_ULT_MOD, FCH_HORA_ULT_MOD -- Columnas
			FROM INSERTED I

		SET @ACTUALIZAR_SOLICITUD = 1

		OPEN C_MODIFIED

		FETCH NEXT FROM C_MODIFIED
		INTO @CLIENTE, @NOMBRE, @DETALLE_DIRECCION, @ALIAS, @CONTACTO, @CARGO, @DIR_EMB_DEFAULT, @TELEFONO1, @TELEFONO2, @FAX, @CONTRIBUYENTE, @FECHA_INGRESO, @MULTIMONEDA, @MONEDA, @SALDO, @SALDO_LOCAL, @SALDO_DOLAR, @SALDO_CREDITO, @SALDO_NOCARGOS, @LIMITE_CREDITO, @EXCEDER_LIMITE, @TASA_INTERES, @TASA_INTERES_MORA, @FECHA_ULT_MORA, @FECHA_ULT_MOV, @CONDICION_PAGO, @NIVEL_PRECIO, @DESCUENTO, @MONEDA_NIVEL, @ACEPTA_BACKORDER, @PAIS, @ZONA, @RUTA, @VENDEDOR, @COBRADOR, @ACEPTA_FRACCIONES, @ACTIVO, @EXENTO_IMPUESTOS, @EXENCION_IMP1, @EXENCION_IMP2, @COBRO_JUDICIAL, @CATEGORIA_CLIENTE, @CLASE_ABC, @DIAS_ABASTECIMIEN, @USA_TARJETA, @TARJETA_CREDITO, @TIPO_TARJETA, @FECHA_VENCE_TARJ, @E_MAIL, @REQUIERE_OC, @ES_CORPORACION, @CLI_CORPORAC_ASOC, @REGISTRARDOCSACORP, @USAR_DIREMB_CORP, @APLICAC_ABIERTAS, @VERIF_LIMCRED_CORP, @USAR_DESC_CORP, @DOC_A_GENERAR, @RUBRO1_CLIENTE, @RUBRO2_CLIENTE, @RUBRO3_CLIENTE, @TIENE_CONVENIO, @DIAS_PROMED_ATRASO, @RUBRO1_CLI, @RUBRO2_CLI, @RUBRO3_CLI, @RUBRO4_CLI, @RUBRO5_CLI, @ASOCOBLIGCONTFACT, @RUBRO4_CLIENTE, @RUBRO5_CLIENTE, @RUBRO6_CLIENTE, @RUBRO7_CLIENTE, @RUBRO8_CLIENTE, @RUBRO9_CLIENTE, @RUBRO10_CLIENTE, @USAR_PRECIOS_CORP, @USAR_EXENCIMP_CORP, @DIAS_DE_COBRO, @AJUSTE_FECHA_COBRO, @GLN, @UBICACION, @CLASE_DOCUMENTO, @LOCAL, @TIPO_CONTRIBUYENTE, @RUBRO11_CLIENTE, @RUBRO12_CLIENTE, @RUBRO13_CLIENTE, @RUBRO14_CLIENTE, @RUBRO15_CLIENTE, @RUBRO16_CLIENTE, @RUBRO17_CLIENTE, @RUBRO18_CLIENTE, @RUBRO19_CLIENTE, @RUBRO20_CLIENTE, @MODELO_RETENCION, @ACEPTA_DOC_ELECTRONICO, @CONFIRMA_DOC_ELECTRONICO, @EMAIL_DOC_ELECTRONICO, @EMAIL_PED_EDI, @ACEPTA_DOC_EDI, @NOTIFICAR_ERROR_EDI, @EMAIL_ERROR_PED_EDI, @CODIGO_IMPUESTO, @DIVISION_GEOGRAFICA1, @DIVISION_GEOGRAFICA2, @REGIMEN_TRIB, @MOROSO, @MODIF_NOMB_EN_FAC, @SALDO_TRANS, @SALDO_TRANS_LOCAL, @SALDO_TRANS_DOLAR, @PERMITE_DOC_GP, @PARTICIPA_FLUJOCAJA, @CURP, @USUARIO_CREACION, @FECHA_HORA_CREACION, @USUARIO_ULT_MOD, @FCH_HORA_ULT_MOD

		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			IF ( NOT UPDATE(RECORDDATE) AND ( UPDATE(CLIENTE) OR UPDATE(NOMBRE) OR UPDATE(DETALLE_DIRECCION) OR UPDATE(ALIAS) OR UPDATE(CONTACTO) OR UPDATE(CARGO) OR UPDATE(DIR_EMB_DEFAULT) OR UPDATE(TELEFONO1) OR UPDATE(TELEFONO2) OR UPDATE(FAX) OR UPDATE(CONTRIBUYENTE) OR UPDATE(FECHA_INGRESO) OR UPDATE(MULTIMONEDA) OR UPDATE(MONEDA) OR UPDATE(SALDO) OR UPDATE(SALDO_LOCAL) OR UPDATE(SALDO_DOLAR) OR UPDATE(SALDO_CREDITO) OR UPDATE(SALDO_NOCARGOS) OR UPDATE(LIMITE_CREDITO) OR UPDATE(EXCEDER_LIMITE) OR UPDATE(TASA_INTERES) OR UPDATE(TASA_INTERES_MORA) OR UPDATE(FECHA_ULT_MORA) OR UPDATE(FECHA_ULT_MOV) OR UPDATE(CONDICION_PAGO) OR UPDATE(NIVEL_PRECIO) OR UPDATE(DESCUENTO) OR UPDATE(MONEDA_NIVEL) OR UPDATE(ACEPTA_BACKORDER) OR UPDATE(PAIS) OR UPDATE(ZONA) OR UPDATE(RUTA) OR UPDATE(VENDEDOR) OR UPDATE(COBRADOR) OR UPDATE(ACEPTA_FRACCIONES) OR UPDATE(ACTIVO) OR UPDATE(EXENTO_IMPUESTOS) OR UPDATE(EXENCION_IMP1) OR UPDATE(EXENCION_IMP2) OR UPDATE(COBRO_JUDICIAL) OR UPDATE(CATEGORIA_CLIENTE) OR UPDATE(CLASE_ABC) OR UPDATE(DIAS_ABASTECIMIEN) OR UPDATE(USA_TARJETA) OR UPDATE(TARJETA_CREDITO) OR UPDATE(TIPO_TARJETA) OR UPDATE(FECHA_VENCE_TARJ) OR UPDATE(E_MAIL) OR UPDATE(REQUIERE_OC) OR UPDATE(ES_CORPORACION) OR UPDATE(CLI_CORPORAC_ASOC) OR UPDATE(REGISTRARDOCSACORP) OR UPDATE(USAR_DIREMB_CORP) OR UPDATE(APLICAC_ABIERTAS) OR UPDATE(VERIF_LIMCRED_CORP) OR UPDATE(USAR_DESC_CORP) OR UPDATE(DOC_A_GENERAR) OR UPDATE(RUBRO1_CLIENTE) OR UPDATE(RUBRO2_CLIENTE) OR UPDATE(RUBRO3_CLIENTE) OR UPDATE(TIENE_CONVENIO) OR UPDATE(DIAS_PROMED_ATRASO) OR UPDATE(RUBRO1_CLI) OR UPDATE(RUBRO2_CLI) OR UPDATE(RUBRO3_CLI) OR UPDATE(RUBRO4_CLI) OR UPDATE(RUBRO5_CLI) OR UPDATE(ASOCOBLIGCONTFACT) OR UPDATE(RUBRO4_CLIENTE) OR UPDATE(RUBRO5_CLIENTE) OR UPDATE(RUBRO6_CLIENTE) OR UPDATE(RUBRO7_CLIENTE) OR UPDATE(RUBRO8_CLIENTE) OR UPDATE(RUBRO9_CLIENTE) OR UPDATE(RUBRO10_CLIENTE) OR UPDATE(USAR_PRECIOS_CORP) OR UPDATE(USAR_EXENCIMP_CORP) OR UPDATE(DIAS_DE_COBRO) OR UPDATE(AJUSTE_FECHA_COBRO) OR UPDATE(GLN) OR UPDATE(UBICACION) OR UPDATE(CLASE_DOCUMENTO) OR UPDATE(LOCAL) OR UPDATE(TIPO_CONTRIBUYENTE) OR UPDATE(RUBRO11_CLIENTE) OR UPDATE(RUBRO12_CLIENTE) OR UPDATE(RUBRO13_CLIENTE) OR UPDATE(RUBRO14_CLIENTE) OR UPDATE(RUBRO15_CLIENTE) OR UPDATE(RUBRO16_CLIENTE) OR UPDATE(RUBRO17_CLIENTE) OR UPDATE(RUBRO18_CLIENTE) OR UPDATE(RUBRO19_CLIENTE) OR UPDATE(RUBRO20_CLIENTE) OR UPDATE(MODELO_RETENCION) OR UPDATE(ACEPTA_DOC_ELECTRONICO) OR UPDATE(CONFIRMA_DOC_ELECTRONICO) OR UPDATE(EMAIL_DOC_ELECTRONICO) OR UPDATE(EMAIL_PED_EDI) OR UPDATE(ACEPTA_DOC_EDI) OR UPDATE(NOTIFICAR_ERROR_EDI) OR UPDATE(EMAIL_ERROR_PED_EDI) OR UPDATE(CODIGO_IMPUESTO) OR UPDATE(DIVISION_GEOGRAFICA1) OR UPDATE(DIVISION_GEOGRAFICA2) OR UPDATE(REGIMEN_TRIB) OR UPDATE(MOROSO) OR UPDATE(MODIF_NOMB_EN_FAC) OR UPDATE(SALDO_TRANS) OR UPDATE(SALDO_TRANS_LOCAL) OR UPDATE(SALDO_TRANS_DOLAR) OR UPDATE(PERMITE_DOC_GP) OR UPDATE(PARTICIPA_FLUJOCAJA) OR UPDATE(CURP) OR UPDATE(USUARIO_CREACION) OR UPDATE(FECHA_HORA_CREACION) OR UPDATE(USUARIO_ULT_MOD) OR UPDATE(FCH_HORA_ULT_MOD) ) )
			BEGIN

				SELECT @COL_ROWPOINTER = ROWPOINTER 
				FROM $$Compania$$.CLIENTE
				WHERE CLIENTE = @CLIENTE 

				SET @PARAMETROS1 =
					'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<CLIENTE>' + 
				'<CLIENTE Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CLIENTE) + '</CLIENTE>' + 
				'<NOMBRE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOMBRE) + '</NOMBRE>' + 
				'<DETALLE_DIRECCION Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@DETALLE_DIRECCION) + '</DETALLE_DIRECCION>' + 
				'<ALIAS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ALIAS) + '</ALIAS>' + 
				'<CONTACTO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CONTACTO) + '</CONTACTO>' + 
				'<CARGO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CARGO) + '</CARGO>' + 
				'<DIR_EMB_DEFAULT Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DIR_EMB_DEFAULT) + '</DIR_EMB_DEFAULT>' + 
				'<TELEFONO1 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TELEFONO1) + '</TELEFONO1>' + 
				'<TELEFONO2 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TELEFONO2) + '</TELEFONO2>' + 
				'<FAX Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@FAX) + '</FAX>' + 
				'<CONTRIBUYENTE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CONTRIBUYENTE) + '</CONTRIBUYENTE>' + 
				'<FECHA_INGRESO Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_INGRESO) + '</FECHA_INGRESO>' + 
				'<MULTIMONEDA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@MULTIMONEDA) + '</MULTIMONEDA>' + 
				'<MONEDA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@MONEDA) + '</MONEDA>' + 
				'<SALDO Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@SALDO) + '</SALDO>' + 
				'<SALDO_LOCAL Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@SALDO_LOCAL) + '</SALDO_LOCAL>' + 
				'<SALDO_DOLAR Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@SALDO_DOLAR) + '</SALDO_DOLAR>' + 
				'<SALDO_CREDITO Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@SALDO_CREDITO) + '</SALDO_CREDITO>' + 
				'<SALDO_NOCARGOS Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@SALDO_NOCARGOS) + '</SALDO_NOCARGOS>' + 
				'<LIMITE_CREDITO Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@LIMITE_CREDITO) + '</LIMITE_CREDITO>' + 
				'<EXCEDER_LIMITE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@EXCEDER_LIMITE) + '</EXCEDER_LIMITE>' + 
				'<TASA_INTERES Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@TASA_INTERES) + '</TASA_INTERES>' + 
				'<TASA_INTERES_MORA Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@TASA_INTERES_MORA) + '</TASA_INTERES_MORA>' + 
				'<FECHA_ULT_MORA Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_ULT_MORA) + '</FECHA_ULT_MORA>' + 
				'<FECHA_ULT_MOV Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_ULT_MOV) + '</FECHA_ULT_MOV>' + 
				'<CONDICION_PAGO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CONDICION_PAGO) + '</CONDICION_PAGO>' + 
				'<NIVEL_PRECIO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NIVEL_PRECIO) + '</NIVEL_PRECIO>' + 
				'<DESCUENTO Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@DESCUENTO) + '</DESCUENTO>' + 
				'<MONEDA_NIVEL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@MONEDA_NIVEL) + '</MONEDA_NIVEL>' + 
				'<ACEPTA_BACKORDER Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ACEPTA_BACKORDER) + '</ACEPTA_BACKORDER>' + 
				'<PAIS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@PAIS) + '</PAIS>' + 
				'<ZONA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ZONA) + '</ZONA>' + 
				'<RUTA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@RUTA) + '</RUTA>' + 
				'<VENDEDOR Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@VENDEDOR) + '</VENDEDOR>' + 
				'<COBRADOR Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@COBRADOR) + '</COBRADOR>' + 
				'<ACEPTA_FRACCIONES Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ACEPTA_FRACCIONES) + '</ACEPTA_FRACCIONES>' + 
				'<ACTIVO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ACTIVO) + '</ACTIVO>' + 
				'<EXENTO_IMPUESTOS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@EXENTO_IMPUESTOS) + '</EXENTO_IMPUESTOS>' + 
				'<EXENCION_IMP1 Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@EXENCION_IMP1) + '</EXENCION_IMP1>' + 
				'<EXENCION_IMP2 Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@EXENCION_IMP2) + '</EXENCION_IMP2>' + 
				'<COBRO_JUDICIAL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@COBRO_JUDICIAL) + '</COBRO_JUDICIAL>' + 
				'<CATEGORIA_CLIENTE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CATEGORIA_CLIENTE) + '</CATEGORIA_CLIENTE>' + 
				'<CLASE_ABC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CLASE_ABC) + '</CLASE_ABC>' + 
				'<DIAS_ABASTECIMIEN Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@DIAS_ABASTECIMIEN) + '</DIAS_ABASTECIMIEN>' + 
				'<USA_TARJETA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USA_TARJETA) + '</USA_TARJETA>' + 
				'<TARJETA_CREDITO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TARJETA_CREDITO) + '</TARJETA_CREDITO>' + 
				'<TIPO_TARJETA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_TARJETA) + '</TIPO_TARJETA>' + 
				'<FECHA_VENCE_TARJ Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_VENCE_TARJ) + '</FECHA_VENCE_TARJ>' + 
				'<E_MAIL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@E_MAIL) + '</E_MAIL>' + 
				'<REQUIERE_OC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@REQUIERE_OC) + '</REQUIERE_OC>' + 
				'<ES_CORPORACION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ES_CORPORACION) + '</ES_CORPORACION>' + 
				'<CLI_CORPORAC_ASOC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CLI_CORPORAC_ASOC) + '</CLI_CORPORAC_ASOC>' + 
				'<REGISTRARDOCSACORP Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@REGISTRARDOCSACORP) + '</REGISTRARDOCSACORP>' + 
				'<USAR_DIREMB_CORP Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USAR_DIREMB_CORP) + '</USAR_DIREMB_CORP>' + 
				'<APLICAC_ABIERTAS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@APLICAC_ABIERTAS) + '</APLICAC_ABIERTAS>' + 
				'<VERIF_LIMCRED_CORP Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@VERIF_LIMCRED_CORP) + '</VERIF_LIMCRED_CORP>' + 
				'<USAR_DESC_CORP Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USAR_DESC_CORP) + '</USAR_DESC_CORP>' + 
				'<DOC_A_GENERAR Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DOC_A_GENERAR) + '</DOC_A_GENERAR>' + 
				'<RUBRO1_CLIENTE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@RUBRO1_CLIENTE) + '</RUBRO1_CLIENTE>' + 
				'<RUBRO2_CLIENTE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@RUBRO2_CLIENTE) + '</RUBRO2_CLIENTE>' + 
				'<RUBRO3_CLIENTE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@RUBRO3_CLIENTE) + '</RUBRO3_CLIENTE>' + 
				'<TIENE_CONVENIO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIENE_CONVENIO) + '</TIENE_CONVENIO>' + 
				'<DIAS_PROMED_ATRASO Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@DIAS_PROMED_ATRASO) + '</DIAS_PROMED_ATRASO>' + 
				'<RUBRO1_CLI Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@RUBRO1_CLI) + '</RUBRO1_CLI>' + 
				'<RUBRO2_CLI Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@RUBRO2_CLI) + '</RUBRO2_CLI>' 
				
				
			SET @PARAMETROS2 = 
				'<RUBRO3_CLI Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@RUBRO3_CLI) + '</RUBRO3_CLI>' + 
				'<RUBRO4_CLI Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@RUBRO4_CLI) + '</RUBRO4_CLI>' + 
				'<RUBRO5_CLI Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@RUBRO5_CLI) + '</RUBRO5_CLI>' + 
				'<ASOCOBLIGCONTFACT Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ASOCOBLIGCONTFACT) + '</ASOCOBLIGCONTFACT>' + 
				'<RUBRO4_CLIENTE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@RUBRO4_CLIENTE) + '</RUBRO4_CLIENTE>' + 
				'<RUBRO5_CLIENTE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@RUBRO5_CLIENTE) + '</RUBRO5_CLIENTE>' + 
				'<RUBRO6_CLIENTE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@RUBRO6_CLIENTE) + '</RUBRO6_CLIENTE>' + 
				'<RUBRO7_CLIENTE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@RUBRO7_CLIENTE) + '</RUBRO7_CLIENTE>' + 
				'<RUBRO8_CLIENTE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@RUBRO8_CLIENTE) + '</RUBRO8_CLIENTE>' + 
				'<RUBRO9_CLIENTE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@RUBRO9_CLIENTE) + '</RUBRO9_CLIENTE>' + 
				'<RUBRO10_CLIENTE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@RUBRO10_CLIENTE) + '</RUBRO10_CLIENTE>' + 
				'<USAR_PRECIOS_CORP Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USAR_PRECIOS_CORP) + '</USAR_PRECIOS_CORP>' + 
				'<USAR_EXENCIMP_CORP Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USAR_EXENCIMP_CORP) + '</USAR_EXENCIMP_CORP>' + 
				'<DIAS_DE_COBRO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DIAS_DE_COBRO) + '</DIAS_DE_COBRO>' + 
				'<AJUSTE_FECHA_COBRO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@AJUSTE_FECHA_COBRO) + '</AJUSTE_FECHA_COBRO>' + 
				'<GLN Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@GLN) + '</GLN>' + 
				'<UBICACION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@UBICACION) + '</UBICACION>' + 
				'<CLASE_DOCUMENTO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CLASE_DOCUMENTO) + '</CLASE_DOCUMENTO>' + 
				'<LOCAL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@LOCAL) + '</LOCAL>' + 
				'<TIPO_CONTRIBUYENTE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_CONTRIBUYENTE) + '</TIPO_CONTRIBUYENTE>' + 
				'<RUBRO11_CLIENTE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@RUBRO11_CLIENTE) + '</RUBRO11_CLIENTE>' + 
				'<RUBRO12_CLIENTE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@RUBRO12_CLIENTE) + '</RUBRO12_CLIENTE>' + 
				'<RUBRO13_CLIENTE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@RUBRO13_CLIENTE) + '</RUBRO13_CLIENTE>' + 
				'<RUBRO14_CLIENTE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@RUBRO14_CLIENTE) + '</RUBRO14_CLIENTE>' + 
				'<RUBRO15_CLIENTE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@RUBRO15_CLIENTE) + '</RUBRO15_CLIENTE>' + 
				'<RUBRO16_CLIENTE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@RUBRO16_CLIENTE) + '</RUBRO16_CLIENTE>' + 
				'<RUBRO17_CLIENTE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@RUBRO17_CLIENTE) + '</RUBRO17_CLIENTE>' + 
				'<RUBRO18_CLIENTE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@RUBRO18_CLIENTE) + '</RUBRO18_CLIENTE>' + 
				'<RUBRO19_CLIENTE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@RUBRO19_CLIENTE) + '</RUBRO19_CLIENTE>' + 
				'<RUBRO20_CLIENTE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@RUBRO20_CLIENTE) + '</RUBRO20_CLIENTE>' + 
				'<MODELO_RETENCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@MODELO_RETENCION) + '</MODELO_RETENCION>' + 
				'<ACEPTA_DOC_ELECTRONICO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ACEPTA_DOC_ELECTRONICO) + '</ACEPTA_DOC_ELECTRONICO>' + 
				'<CONFIRMA_DOC_ELECTRONICO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CONFIRMA_DOC_ELECTRONICO) + '</CONFIRMA_DOC_ELECTRONICO>' + 
				'<EMAIL_DOC_ELECTRONICO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@EMAIL_DOC_ELECTRONICO) + '</EMAIL_DOC_ELECTRONICO>' + 
				'<EMAIL_PED_EDI Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@EMAIL_PED_EDI) + '</EMAIL_PED_EDI>' + 
				'<ACEPTA_DOC_EDI Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ACEPTA_DOC_EDI) + '</ACEPTA_DOC_EDI>' + 
				'<NOTIFICAR_ERROR_EDI Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOTIFICAR_ERROR_EDI) + '</NOTIFICAR_ERROR_EDI>' + 
				'<EMAIL_ERROR_PED_EDI Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@EMAIL_ERROR_PED_EDI) + '</EMAIL_ERROR_PED_EDI>' + 
				'<CODIGO_IMPUESTO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CODIGO_IMPUESTO) + '</CODIGO_IMPUESTO>' + 
				'<DIVISION_GEOGRAFICA1 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DIVISION_GEOGRAFICA1) + '</DIVISION_GEOGRAFICA1>' + 
				'<DIVISION_GEOGRAFICA2 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DIVISION_GEOGRAFICA2) + '</DIVISION_GEOGRAFICA2>' + 
				'<REGIMEN_TRIB Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@REGIMEN_TRIB) + '</REGIMEN_TRIB>' + 
				'<MOROSO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@MOROSO) + '</MOROSO>' + 
				'<MODIF_NOMB_EN_FAC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@MODIF_NOMB_EN_FAC) + '</MODIF_NOMB_EN_FAC>' + 
				'<SALDO_TRANS Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@SALDO_TRANS) + '</SALDO_TRANS>' + 
				'<SALDO_TRANS_LOCAL Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@SALDO_TRANS_LOCAL) + '</SALDO_TRANS_LOCAL>' + 
				'<SALDO_TRANS_DOLAR Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@SALDO_TRANS_DOLAR) + '</SALDO_TRANS_DOLAR>' + 
				'<PERMITE_DOC_GP Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@PERMITE_DOC_GP) + '</PERMITE_DOC_GP>' + 
				'<PARTICIPA_FLUJOCAJA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@PARTICIPA_FLUJOCAJA) + '</PARTICIPA_FLUJOCAJA>' + 
				'<CURP Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CURP) + '</CURP>' + 
				'<USUARIO_CREACION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USUARIO_CREACION) + '</USUARIO_CREACION>' + 
				'<FECHA_HORA_CREACION Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_HORA_CREACION) + '</FECHA_HORA_CREACION>' + 
				'<USUARIO_ULT_MOD Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USUARIO_ULT_MOD) + '</USUARIO_ULT_MOD>' + 
				'<FCH_HORA_ULT_MOD Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FCH_HORA_ULT_MOD) + '</FCH_HORA_ULT_MOD>' + 
				'</CLIENTE>'

				-- inserta la solicitud correspondiente				
				EXECUTE  ('ERPADMIN.POS_InsertarSolicitud ''' + @PUBLICADOR + ''', ''CLIENTEPOS600'', ''MODIFICA'', ''' + @PARAMETROS1 + @PARAMETROS2 + ''', ' + @ACTUALIZAR_SOLICITUD + ', ''' + @COL_ROWPOINTER + '''')
			END

			FETCH NEXT FROM C_MODIFIED
			INTO @CLIENTE, @NOMBRE, @DETALLE_DIRECCION, @ALIAS, @CONTACTO, @CARGO, @DIR_EMB_DEFAULT, @TELEFONO1, @TELEFONO2, @FAX, @CONTRIBUYENTE, @FECHA_INGRESO, @MULTIMONEDA, @MONEDA, @SALDO, @SALDO_LOCAL, @SALDO_DOLAR, @SALDO_CREDITO, @SALDO_NOCARGOS, @LIMITE_CREDITO, @EXCEDER_LIMITE, @TASA_INTERES, @TASA_INTERES_MORA, @FECHA_ULT_MORA, @FECHA_ULT_MOV, @CONDICION_PAGO, @NIVEL_PRECIO, @DESCUENTO, @MONEDA_NIVEL, @ACEPTA_BACKORDER, @PAIS, @ZONA, @RUTA, @VENDEDOR, @COBRADOR, @ACEPTA_FRACCIONES, @ACTIVO, @EXENTO_IMPUESTOS, @EXENCION_IMP1, @EXENCION_IMP2, @COBRO_JUDICIAL, @CATEGORIA_CLIENTE, @CLASE_ABC, @DIAS_ABASTECIMIEN, @USA_TARJETA, @TARJETA_CREDITO, @TIPO_TARJETA, @FECHA_VENCE_TARJ, @E_MAIL, @REQUIERE_OC, @ES_CORPORACION, @CLI_CORPORAC_ASOC, @REGISTRARDOCSACORP, @USAR_DIREMB_CORP, @APLICAC_ABIERTAS, @VERIF_LIMCRED_CORP, @USAR_DESC_CORP, @DOC_A_GENERAR, @RUBRO1_CLIENTE, @RUBRO2_CLIENTE, @RUBRO3_CLIENTE, @TIENE_CONVENIO, @DIAS_PROMED_ATRASO, @RUBRO1_CLI, @RUBRO2_CLI, @RUBRO3_CLI, @RUBRO4_CLI, @RUBRO5_CLI, @ASOCOBLIGCONTFACT, @RUBRO4_CLIENTE, @RUBRO5_CLIENTE, @RUBRO6_CLIENTE, @RUBRO7_CLIENTE, @RUBRO8_CLIENTE, @RUBRO9_CLIENTE, @RUBRO10_CLIENTE, @USAR_PRECIOS_CORP, @USAR_EXENCIMP_CORP, @DIAS_DE_COBRO, @AJUSTE_FECHA_COBRO, @GLN, @UBICACION, @CLASE_DOCUMENTO, @LOCAL, @TIPO_CONTRIBUYENTE, @RUBRO11_CLIENTE, @RUBRO12_CLIENTE, @RUBRO13_CLIENTE, @RUBRO14_CLIENTE, @RUBRO15_CLIENTE, @RUBRO16_CLIENTE, @RUBRO17_CLIENTE, @RUBRO18_CLIENTE, @RUBRO19_CLIENTE, @RUBRO20_CLIENTE, @MODELO_RETENCION, @ACEPTA_DOC_ELECTRONICO, @CONFIRMA_DOC_ELECTRONICO, @EMAIL_DOC_ELECTRONICO, @EMAIL_PED_EDI, @ACEPTA_DOC_EDI, @NOTIFICAR_ERROR_EDI, @EMAIL_ERROR_PED_EDI, @CODIGO_IMPUESTO, @DIVISION_GEOGRAFICA1, @DIVISION_GEOGRAFICA2, @REGIMEN_TRIB, @MOROSO, @MODIF_NOMB_EN_FAC, @SALDO_TRANS, @SALDO_TRANS_LOCAL, @SALDO_TRANS_DOLAR, @PERMITE_DOC_GP, @PARTICIPA_FLUJOCAJA, @CURP, @USUARIO_CREACION, @FECHA_HORA_CREACION, @USUARIO_ULT_MOD, @FCH_HORA_ULT_MOD
		END

		CLOSE C_MODIFIED
		DEALLOCATE C_MODIFIED
	END

	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para modificar la tabla CLIENTE.',16,1 )
	END
END;




CREATE TRIGGER $$Compania$$.CLIENTE_FORMA_PAGO_POS_INS
ON $$Compania$$.CLIENTE_FORMA_PAGO
FOR INSERT
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @TIPO_SITIO_LOCAL VARCHAR(1)
	DECLARE @FORMA_PAGO VARCHAR(4)
	DECLARE @CLIENTE VARCHAR(20)
	DECLARE @ENTIDAD_FINANCIERA VARCHAR(8)
	DECLARE @NUMERO_CTA VARCHAR(25)
	DECLARE @ESTADO VARCHAR(1)
	DECLARE @RESP_CTA VARCHAR(40)
	
	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM ,
		@TIPO_SITIO_LOCAL = TIPO_SITIO_LOCAL
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM) AND @TIPO_SITIO_LOCAL = 'C'
	BEGIN
		DECLARE C_INSERTED CURSOR LOCAL FOR
		SELECT FORMA_PAGO, CLIENTE, ENTIDAD_FINANCIERA, NUMERO_CTA, ESTADO, RESP_CTA
		FROM INSERTED i
		WHERE 0 = (
				SELECT COUNT('n')
				FROM DELETED d
				WHERE i.FORMA_PAGO = d.FORMA_PAGO AND i.CLIENTE = d.CLIENTE AND i.ENTIDAD_FINANCIERA = d.ENTIDAD_FINANCIERA
			   )
			
		OPEN C_INSERTED	
		FETCH NEXT FROM C_INSERTED INTO
		@FORMA_PAGO, @CLIENTE, @ENTIDAD_FINANCIERA, @NUMERO_CTA, @ESTADO, @RESP_CTA
		SET @ERROR = 0
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS =
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<CLIENTE_FORMA_PAGO>' +
				'<FORMA_PAGO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@FORMA_PAGO) + '</FORMA_PAGO>' +
				'<CLIENTE Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CLIENTE) + '</CLIENTE>' +
				'<ENTIDAD_FINANCIERA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@ENTIDAD_FINANCIERA) + '</ENTIDAD_FINANCIERA>' +
				'<NUMERO_CTA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NUMERO_CTA) + '</NUMERO_CTA>' +
				'<ESTADO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ESTADO) + '</ESTADO>' +
				'<RESP_CTA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@RESP_CTA) + '</RESP_CTA>' +
				'</CLIENTE_FORMA_PAGO>'
			-- Inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'CLIENTEFORMAPAGOPOS600', 'INSERTA', @PARAMETROS, 0, ''
			FETCH NEXT FROM C_INSERTED INTO
			@FORMA_PAGO, @CLIENTE, @ENTIDAD_FINANCIERA, @NUMERO_CTA, @ESTADO, @RESP_CTA
		END
		CLOSE C_INSERTED
    		DEALLOCATE C_INSERTED
	END
	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla CLIENTE_FORMA_PAGO.',16,1 )
	END
END
;




CREATE TRIGGER $$Compania$$.CLIENTE_FORMA_PAGO_POS_DEL
ON $$Compania$$.CLIENTE_FORMA_PAGO
FOR DELETE
AS
BEGIN   	
                DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @TIPO_SITIO_LOCAL VARCHAR(1)
	DECLARE @FORMA_PAGO VARCHAR(4)
	DECLARE @CLIENTE VARCHAR(20)
	DECLARE @ENTIDAD_FINANCIERA VARCHAR(8)
	 -- Declaraciones	
	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM ,
		@TIPO_SITIO_LOCAL = TIPO_SITIO_LOCAL
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM) AND @TIPO_SITIO_LOCAL = 'C'
	BEGIN
		DECLARE C_DELETED CURSOR LOCAL FOR
			SELECT FORMA_PAGO, CLIENTE, ENTIDAD_FINANCIERA
			FROM DELETED d
			WHERE 0 = (
				SELECT COUNT('n')
				FROM INSERTED i
				WHERE d.FORMA_PAGO = i.FORMA_PAGO AND d.CLIENTE = i.CLIENTE AND d.ENTIDAD_FINANCIERA = i.ENTIDAD_FINANCIERA
			   )
		OPEN C_DELETED
		FETCH NEXT FROM C_DELETED INTO
		@FORMA_PAGO, @CLIENTE, @ENTIDAD_FINANCIERA
		
		SET @ERROR = 0
		
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS =
								'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<CLIENTE_FORMA_PAGO>' +
				'<FORMA_PAGO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@FORMA_PAGO) + '</FORMA_PAGO>' +
				'<CLIENTE Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CLIENTE) + '</CLIENTE>' +
				'<ENTIDAD_FINANCIERA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@ENTIDAD_FINANCIERA) + '</ENTIDAD_FINANCIERA>' +
				'</CLIENTE_FORMA_PAGO>'
 -- XML
			
			-- inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'CLIENTEFORMAPAGOPOS600', 'ELIMINA', @PARAMETROS, 0, ''
			
			FETCH NEXT FROM C_DELETED INTO
			@FORMA_PAGO, @CLIENTE, @ENTIDAD_FINANCIERA
		END
		CLOSE C_DELETED
		DEALLOCATE C_DELETED
	END
	
	IF (@@ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para eliminar de la tabla CLIENTE_FORMA_PAGO.',16,1 )
	END
END
;




CREATE TRIGGER $$Compania$$.CLIENTE_FORMA_PAGO_POS_MOD
ON $$Compania$$.CLIENTE_FORMA_PAGO
FOR UPDATE
AS
BEGIN   	
	DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @TIPO_SITIO_LOCAL VARCHAR(1)
	DECLARE @COL_ROWPOINTER VARCHAR(36)
	DECLARE @HAY_CAMPOS_PARA_POS BIT
	DECLARE @ACTUALIZAR_SOLICITUD BIT
	DECLARE @FORMA_PAGO VARCHAR(4)
	DECLARE @CLIENTE VARCHAR(20)
	DECLARE @ENTIDAD_FINANCIERA VARCHAR(8)
	DECLARE @NUMERO_CTA VARCHAR(25)
	DECLARE @ESTADO VARCHAR(1)
	DECLARE @RESP_CTA VARCHAR(40)
	 -- Declaraciones
	SET @ERROR = 0
	SELECT @PUBLICADOR = SITIO_LOCAL, @USUARIO_POS_WSQM = USUARIO_WSQM,
		@TIPO_SITIO_LOCAL = TIPO_SITIO_LOCAL
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM) AND @TIPO_SITIO_LOCAL = 'C'
	BEGIN
		DECLARE C_MODIFIED CURSOR LOCAL FOR
			SELECT FORMA_PAGO, CLIENTE, ENTIDAD_FINANCIERA, NUMERO_CTA, ESTADO, RESP_CTA -- Columnas
			FROM INSERTED I
		SET @ACTUALIZAR_SOLICITUD = 1
		OPEN C_MODIFIED
		FETCH NEXT FROM C_MODIFIED
		INTO @FORMA_PAGO, @CLIENTE, @ENTIDAD_FINANCIERA, @NUMERO_CTA, @ESTADO, @RESP_CTA
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			IF ( NOT UPDATE(RECORDDATE) AND ( UPDATE(FORMA_PAGO) OR UPDATE(CLIENTE) OR UPDATE(ENTIDAD_FINANCIERA) OR UPDATE(NUMERO_CTA) OR UPDATE(ESTADO) OR UPDATE(RESP_CTA) ) )
			BEGIN
				SELECT @COL_ROWPOINTER = ROWPOINTER
				FROM $$Compania$$.CLIENTE_FORMA_PAGO
				WHERE FORMA_PAGO = @FORMA_PAGO AND CLIENTE = @CLIENTE AND ENTIDAD_FINANCIERA = @ENTIDAD_FINANCIERA
				SET @PARAMETROS =
					'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<CLIENTE_FORMA_PAGO>' +
				'<FORMA_PAGO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@FORMA_PAGO) + '</FORMA_PAGO>' +
				'<CLIENTE Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CLIENTE) + '</CLIENTE>' +
				'<ENTIDAD_FINANCIERA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@ENTIDAD_FINANCIERA) + '</ENTIDAD_FINANCIERA>' +
				'<NUMERO_CTA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NUMERO_CTA) + '</NUMERO_CTA>' +
				'<ESTADO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ESTADO) + '</ESTADO>' +
				'<RESP_CTA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@RESP_CTA) + '</RESP_CTA>' +
				'</CLIENTE_FORMA_PAGO>'
				-- inserta la solicitud correspondiente
				EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'CLIENTEFORMAPAGOPOS600', 'MODIFICA', @PARAMETROS, @ACTUALIZAR_SOLICITUD, @COL_ROWPOINTER
			END
			FETCH NEXT FROM C_MODIFIED
			INTO @FORMA_PAGO, @CLIENTE, @ENTIDAD_FINANCIERA, @NUMERO_CTA, @ESTADO, @RESP_CTA
		END
		CLOSE C_MODIFIED
		DEALLOCATE C_MODIFIED
	END
	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para modificar la tabla CLIENTE_FORMA_PAGO.',16,1 )
	END
END
;



CREATE TRIGGER $$Compania$$.CLIENTE_POS_POS_INS
ON $$Compania$$.CLIENTE_POS
FOR INSERT
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @TIPO_SITIO_LOCAL VARCHAR(1)
	DECLARE @CLIENTE VARCHAR(20)
	DECLARE @FECHA_NACIMIENTO DATETIME
	DECLARE @PAIS_EMBAJADA VARCHAR(4)
	DECLARE @CARNE VARCHAR(40)
	DECLARE @ES_VIP VARCHAR(1)
	DECLARE @GENERO VARCHAR(1)
	

	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM,
	       @TIPO_SITIO_LOCAL = TIPO_SITIO_LOCAL
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (SYSTEM_USER = @USUARIO_POS_WSQM AND @TIPO_SITIO_LOCAL = 'T')
	BEGIN
		DECLARE C_INSERTED CURSOR LOCAL FOR
		SELECT CLIENTE, FECHA_NACIMIENTO, PAIS_EMBAJADA, CARNE, ES_VIP, GENERO
		FROM INSERTED i
			
		OPEN C_INSERTED	
		FETCH NEXT FROM C_INSERTED INTO
		@CLIENTE, @FECHA_NACIMIENTO, @PAIS_EMBAJADA, @CARNE, @ES_VIP, @GENERO

		SET @ERROR = 0
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS = 
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<CLIENTE_POS>' + 
				'<CLIENTE Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CLIENTE) + '</CLIENTE>' + 
				'<FECHA_NACIMIENTO Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_NACIMIENTO) + '</FECHA_NACIMIENTO>' + 
				'<PAIS_EMBAJADA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@PAIS_EMBAJADA) + '</PAIS_EMBAJADA>' + 
				'<CARNE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CARNE) + '</CARNE>' + 
				'<ES_VIP Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ES_VIP) + '</ES_VIP>' + 
				'<GENERO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@GENERO) + '</GENERO>' + 
				'</CLIENTE_POS>'


			-- Inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'CLIENTEPOSPOS600', 'INSERTA', @PARAMETROS, 0, ''

			FETCH NEXT FROM C_INSERTED INTO
			@CLIENTE, @FECHA_NACIMIENTO, @PAIS_EMBAJADA, @CARNE, @ES_VIP, @GENERO
		END

		CLOSE C_INSERTED
    		DEALLOCATE C_INSERTED
	END

	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla CLIENTE_POS.',16,1 )
	END
END;



CREATE TRIGGER $$Compania$$.CLIENTE_POS_POS_DEL
ON $$Compania$$.CLIENTE_POS
FOR DELETE  
AS 
BEGIN   	
        DECLARE @ERROR  int
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @TIPO_SITIO_LOCAL VARCHAR(1)
	DECLARE @CLIENTE VARCHAR(20)
	DECLARE @FECHA_NACIMIENTO DATETIME
	DECLARE @PAIS_EMBAJADA VARCHAR(4)
	DECLARE @CARNE VARCHAR(40)
	DECLARE @ES_VIP VARCHAR(1)
	DECLARE @GENERO VARCHAR(1)
	 -- Declaraciones	

	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM,
	       @TIPO_SITIO_LOCAL = TIPO_SITIO_LOCAL
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (SYSTEM_USER = @USUARIO_POS_WSQM AND @TIPO_SITIO_LOCAL = 'T')
	BEGIN
		DECLARE C_DELETED CURSOR LOCAL FOR
			SELECT CLIENTE, FECHA_NACIMIENTO, PAIS_EMBAJADA, CARNE, ES_VIP, GENERO
			FROM DELETED d

		OPEN C_DELETED
		FETCH NEXT FROM C_DELETED INTO 
		@CLIENTE, @FECHA_NACIMIENTO, @PAIS_EMBAJADA, @CARNE, @ES_VIP, @GENERO -- VARIABLES
		
		SET @ERROR = 0
		
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS = 
								'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<CLIENTE_POS>' + 
				'<CLIENTE Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CLIENTE) + '</CLIENTE>' + 
				'<FECHA_NACIMIENTO Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_NACIMIENTO) + '</FECHA_NACIMIENTO>' + 
				'<PAIS_EMBAJADA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@PAIS_EMBAJADA) + '</PAIS_EMBAJADA>' + 
				'<CARNE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CARNE) + '</CARNE>' + 
				'<ES_VIP Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ES_VIP) + '</ES_VIP>' + 
				'<GENERO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@GENERO) + '</GENERO>' + 
				'</CLIENTE_POS>'
 
			
			-- inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'CLIENTEPOSPOS600', 'ELIMINA', @PARAMETROS, 0, ''
			
			FETCH NEXT FROM C_DELETED INTO 
			@CLIENTE, @FECHA_NACIMIENTO, @PAIS_EMBAJADA, @CARNE, @ES_VIP, @GENERO -- VARIABLES
		END

		CLOSE C_DELETED
		DEALLOCATE C_DELETED
	END
	
	IF (@@ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para eliminar de la tabla CLIENTE_POS.',16,1 )
	END
END;



CREATE TRIGGER $$Compania$$.CLIENTE_POS_POS_MOD
ON $$Compania$$.CLIENTE_POS
FOR UPDATE
AS 
BEGIN   	
	DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @TIPO_SITIO_LOCAL VARCHAR(1)
	DECLARE @COL_ROWPOINTER VARCHAR(36)
	DECLARE @HAY_CAMPOS_PARA_POS BIT
	DECLARE @ACTUALIZAR_SOLICITUD BIT
	DECLARE @CLIENTE VARCHAR(20)
	DECLARE @FECHA_NACIMIENTO DATETIME
	DECLARE @PAIS_EMBAJADA VARCHAR(4)
	DECLARE @CARNE VARCHAR(40)
	DECLARE @ES_VIP VARCHAR(1)
	DECLARE @GENERO VARCHAR(1)
	 -- Declaraciones

	SET @ERROR = 0

	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM,
	       @TIPO_SITIO_LOCAL = TIPO_SITIO_LOCAL
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (SYSTEM_USER = @USUARIO_POS_WSQM AND @TIPO_SITIO_LOCAL = 'T')
	BEGIN
		DECLARE C_MODIFIED CURSOR LOCAL FOR
			SELECT CLIENTE, FECHA_NACIMIENTO, PAIS_EMBAJADA, CARNE, ES_VIP, GENERO -- Columnas
			FROM INSERTED I

		SET @ACTUALIZAR_SOLICITUD = 1

		OPEN C_MODIFIED

		FETCH NEXT FROM C_MODIFIED
		INTO @CLIENTE, @FECHA_NACIMIENTO, @PAIS_EMBAJADA, @CARNE, @ES_VIP, @GENERO

		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			IF ( NOT UPDATE(RECORDDATE) AND ( UPDATE(CLIENTE) OR UPDATE(FECHA_NACIMIENTO) OR UPDATE(PAIS_EMBAJADA) OR UPDATE(CARNE) OR UPDATE(ES_VIP) OR UPDATE(GENERO) ) )
			BEGIN

				SELECT @COL_ROWPOINTER = ROWPOINTER 
				FROM $$Compania$$.CLIENTE_POS
				WHERE CLIENTE = @CLIENTE 

				SET @PARAMETROS =
					'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<CLIENTE_POS>' + 
				'<CLIENTE Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CLIENTE) + '</CLIENTE>' + 
				'<FECHA_NACIMIENTO Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_NACIMIENTO) + '</FECHA_NACIMIENTO>' + 
				'<PAIS_EMBAJADA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@PAIS_EMBAJADA) + '</PAIS_EMBAJADA>' + 
				'<CARNE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CARNE) + '</CARNE>' + 
				'<ES_VIP Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ES_VIP) + '</ES_VIP>' + 
				'<GENERO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@GENERO) + '</GENERO>' + 
				'</CLIENTE_POS>'


				-- inserta la solicitud correspondiente
				EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'CLIENTEPOSPOS600', 'MODIFICA', @PARAMETROS, @ACTUALIZAR_SOLICITUD, @COL_ROWPOINTER
			END

			FETCH NEXT FROM C_MODIFIED
			INTO @CLIENTE, @FECHA_NACIMIENTO, @PAIS_EMBAJADA, @CARNE, @ES_VIP, @GENERO
		END

		CLOSE C_MODIFIED
		DEALLOCATE C_MODIFIED
	END

	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para modificar la tabla CLIENTE_POS.',16,1 )
	END
END;




CREATE TRIGGER $$Compania$$.CLIENTE_VENDEDOR_POS_INS
ON $$Compania$$.CLIENTE_VENDEDOR
FOR INSERT
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @TIPO_SITIO_LOCAL VARCHAR(1)
	DECLARE @CLIENTE VARCHAR(20)
	DECLARE @VENDEDOR VARCHAR(4)
	
	
	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM,
	       @TIPO_SITIO_LOCAL = TIPO_SITIO_LOCAL
	FROM $$Compania$$.GLOBALES_POS
	
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (SYSTEM_USER = @USUARIO_POS_WSQM AND @TIPO_SITIO_LOCAL = 'T')
	BEGIN
		DECLARE C_INSERTED CURSOR LOCAL FOR
		SELECT CLIENTE, VENDEDOR
		FROM INSERTED i
			
		OPEN C_INSERTED	
		FETCH NEXT FROM C_INSERTED INTO
		@CLIENTE, @VENDEDOR
		SET @ERROR = 0
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS =
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<CLIENTE_VENDEDOR>' +
				'<CLIENTE Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CLIENTE) + '</CLIENTE>' +
				'<VENDEDOR Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@VENDEDOR) + '</VENDEDOR>' +
				'</CLIENTE_VENDEDOR>'
			-- Inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'CLIENTEVENDEDORPOS600', 'INSERTA', @PARAMETROS, 0, ''
			FETCH NEXT FROM C_INSERTED INTO
			@CLIENTE, @VENDEDOR
		END
		CLOSE C_INSERTED
    		DEALLOCATE C_INSERTED
	END
	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla CLIENTE_VENDEDOR.',16,1 )
	END
END;



CREATE TRIGGER $$Compania$$.CLIENTE_VENDEDOR_POS_DEL
ON $$Compania$$.CLIENTE_VENDEDOR
FOR DELETE
AS
BEGIN   	
                DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @TIPO_SITIO_LOCAL VARCHAR(1)
	DECLARE @CLIENTE VARCHAR(20)
	DECLARE @VENDEDOR VARCHAR(4)
	
	 -- Declaraciones	
	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM,
	       @TIPO_SITIO_LOCAL = TIPO_SITIO_LOCAL
	FROM $$Compania$$.GLOBALES_POS
	
	
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (SYSTEM_USER = @USUARIO_POS_WSQM AND @TIPO_SITIO_LOCAL = 'T')
	BEGIN
		DECLARE C_DELETED CURSOR LOCAL FOR
			SELECT CLIENTE, VENDEDOR
			FROM DELETED d
			
		OPEN C_DELETED
		FETCH NEXT FROM C_DELETED INTO
		@CLIENTE, @VENDEDOR -- VARIABLES
		
		SET @ERROR = 0
		
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS =
								'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<CLIENTE_VENDEDOR>' +
				'<CLIENTE Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CLIENTE) + '</CLIENTE>' +
				'<VENDEDOR Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@VENDEDOR) + '</VENDEDOR>' +
				'</CLIENTE_VENDEDOR>'
 -- XML
			
			-- inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'CLIENTEVENDEDORPOS600', 'ELIMINA', @PARAMETROS, 0, ''
			
			FETCH NEXT FROM C_DELETED INTO
			@CLIENTE, @VENDEDOR -- VARIABLES
		END
		CLOSE C_DELETED
		DEALLOCATE C_DELETED
	END
	
	IF (@@ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para eliminar de la tabla CLIENTE_VENDEDOR.',16,1 )
	END
END;




CREATE TRIGGER $$Compania$$.CLIENTE_VENDEDOR_POS_MOD
ON $$Compania$$.CLIENTE_VENDEDOR
FOR UPDATE
AS
BEGIN   	
	DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @TIPO_SITIO_LOCAL VARCHAR(1)
	DECLARE @COL_ROWPOINTER VARCHAR(36)
	DECLARE @HAY_CAMPOS_PARA_POS BIT
	DECLARE @ACTUALIZAR_SOLICITUD BIT
	DECLARE @CLIENTE VARCHAR(20)
	DECLARE @VENDEDOR VARCHAR(4)
	 -- Declaraciones
	 
	SET @ERROR = 0
	
	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM,
	       @TIPO_SITIO_LOCAL = TIPO_SITIO_LOCAL
	FROM $$Compania$$.GLOBALES_POS
		
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (SYSTEM_USER = @USUARIO_POS_WSQM AND @TIPO_SITIO_LOCAL = 'T')
	BEGIN
		DECLARE C_MODIFIED CURSOR LOCAL FOR
			SELECT CLIENTE, VENDEDOR -- Columnas
			FROM INSERTED I
		SET @ACTUALIZAR_SOLICITUD = 1
		OPEN C_MODIFIED
		FETCH NEXT FROM C_MODIFIED
		INTO @CLIENTE, @VENDEDOR
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			IF ( NOT UPDATE(RECORDDATE) AND ( UPDATE(CLIENTE) OR UPDATE(VENDEDOR) ) )
			BEGIN
				SELECT @COL_ROWPOINTER = ROWPOINTER
				FROM $$Compania$$.CLIENTE_VENDEDOR
				WHERE CLIENTE = @CLIENTE AND VENDEDOR = @VENDEDOR
				SET @PARAMETROS =
					'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<CLIENTE_VENDEDOR>' +
				'<CLIENTE Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CLIENTE) + '</CLIENTE>' +
				'<VENDEDOR Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@VENDEDOR) + '</VENDEDOR>' +
				'</CLIENTE_VENDEDOR>'
				-- inserta la solicitud correspondiente
				EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'CLIENTEVENDEDORPOS600', 'MODIFICA', @PARAMETROS, @ACTUALIZAR_SOLICITUD, @COL_ROWPOINTER
			END
			FETCH NEXT FROM C_MODIFIED
			INTO @CLIENTE, @VENDEDOR
		END
		CLOSE C_MODIFIED
		DEALLOCATE C_MODIFIED
	END
	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para modificar la tabla CLIENTE_VENDEDOR.',16,1 )
	END
END;






CREATE TRIGGER $$Compania$$.COBRADOR_POS_INS
ON $$Compania$$.COBRADOR
FOR INSERT
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @COBRADOR VARCHAR(4)
	DECLARE @NOMBRE VARCHAR(40)
	DECLARE @EMPLEADO VARCHAR(25)
	DECLARE @COMISION DECIMAL(28,8)
	DECLARE @CTR_COMISION VARCHAR(25)
	DECLARE @CTA_COMISION VARCHAR(25)
	DECLARE @E_MAIL VARCHAR(40)
	DECLARE @ACTIVO VARCHAR(1)
	 
	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_INSERTED CURSOR LOCAL FOR
		SELECT COBRADOR, NOMBRE, EMPLEADO, COMISION, CTR_COMISION, CTA_COMISION, E_MAIL, ACTIVO
		FROM INSERTED i
		WHERE 0 = (
				SELECT COUNT('n')
				FROM DELETED d
				WHERE i.COBRADOR = d.COBRADOR
			   )
			
		OPEN C_INSERTED	
		FETCH NEXT FROM C_INSERTED INTO
		@COBRADOR, @NOMBRE, @EMPLEADO, @COMISION, @CTR_COMISION, @CTA_COMISION, @E_MAIL, @ACTIVO
		SET @ERROR = 0
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS =
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<COBRADOR>' +
				'<COBRADOR Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@COBRADOR) + '</COBRADOR>' +
				'<NOMBRE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOMBRE) + '</NOMBRE>' +
				'<EMPLEADO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@EMPLEADO) + '</EMPLEADO>' +
				'<COMISION Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@COMISION) + '</COMISION>' +
				'<CTR_COMISION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_COMISION) + '</CTR_COMISION>' +
				'<CTA_COMISION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_COMISION) + '</CTA_COMISION>' +
				'<E_MAIL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@E_MAIL) + '</E_MAIL>' +
				'<ACTIVO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ACTIVO) + '</ACTIVO>' +
				'</COBRADOR>'
			-- Inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'COBRADORPOS600', 'INSERTA', @PARAMETROS, 0, ''
			FETCH NEXT FROM C_INSERTED INTO
			@COBRADOR, @NOMBRE, @EMPLEADO, @COMISION, @CTR_COMISION, @CTA_COMISION, @E_MAIL, @ACTIVO
		END
		CLOSE C_INSERTED
    		DEALLOCATE C_INSERTED
	END
	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla COBRADOR.',16,1 )
	END
END
;




CREATE TRIGGER $$Compania$$.COBRADOR_POS_DEL
ON $$Compania$$.COBRADOR
FOR DELETE
AS
BEGIN   	
                DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @COBRADOR VARCHAR(4)
	 -- Declaraciones	
	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_DELETED CURSOR LOCAL FOR
			SELECT COBRADOR
			FROM DELETED d
			WHERE 0 = (
				SELECT COUNT('n')
				FROM INSERTED i
				WHERE d.COBRADOR = i.COBRADOR
			   )
		OPEN C_DELETED
		FETCH NEXT FROM C_DELETED INTO
		@COBRADOR
		
		SET @ERROR = 0
		
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS =
								'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<COBRADOR>' +
				'<COBRADOR Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@COBRADOR) + '</COBRADOR>' +
				'</COBRADOR>'
 -- XML
			
			-- inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'COBRADORPOS600', 'ELIMINA', @PARAMETROS, 0, ''
			
			FETCH NEXT FROM C_DELETED INTO
			@COBRADOR
		END
		CLOSE C_DELETED
		DEALLOCATE C_DELETED
	END
	
	IF (@@ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para eliminar de la tabla COBRADOR.',16,1 )
	END
END
;




CREATE TRIGGER $$Compania$$.COBRADOR_POS_MOD
ON $$Compania$$.COBRADOR
FOR UPDATE
AS 
BEGIN   	
	DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @COL_ROWPOINTER VARCHAR(36)
	DECLARE @HAY_CAMPOS_PARA_POS BIT
	DECLARE @ACTUALIZAR_SOLICITUD BIT
	DECLARE @COBRADOR VARCHAR(4)
	DECLARE @NOMBRE VARCHAR(40)
	DECLARE @EMPLEADO VARCHAR(20)
	DECLARE @COMISION DECIMAL(28,8)
	DECLARE @CTR_COMISION VARCHAR(25)
	DECLARE @CTA_COMISION VARCHAR(25)
	DECLARE @E_MAIL VARCHAR(249)
	DECLARE @ACTIVO VARCHAR(1)
	 -- Declaraciones

	SET @ERROR = 0

	SELECT @PUBLICADOR = SITIO_LOCAL, @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_MODIFIED CURSOR LOCAL FOR
			SELECT COBRADOR, NOMBRE, EMPLEADO, COMISION, CTR_COMISION, CTA_COMISION, E_MAIL, ACTIVO -- Columnas
			FROM INSERTED I

		SET @ACTUALIZAR_SOLICITUD = 1

		OPEN C_MODIFIED

		FETCH NEXT FROM C_MODIFIED
		INTO @COBRADOR, @NOMBRE, @EMPLEADO, @COMISION, @CTR_COMISION, @CTA_COMISION, @E_MAIL, @ACTIVO

		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			IF ( NOT UPDATE(RECORDDATE) AND ( UPDATE(COBRADOR) OR UPDATE(NOMBRE) OR UPDATE(EMPLEADO) OR UPDATE(COMISION) OR UPDATE(CTR_COMISION) OR UPDATE(CTA_COMISION) OR UPDATE(E_MAIL) OR UPDATE(ACTIVO) ) )
			BEGIN

				SELECT @COL_ROWPOINTER = ROWPOINTER 
				FROM $$Compania$$.COBRADOR
				WHERE COBRADOR = @COBRADOR 

				SET @PARAMETROS =
					'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<COBRADOR>' + 
				'<COBRADOR Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@COBRADOR) + '</COBRADOR>' + 
				'<NOMBRE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOMBRE) + '</NOMBRE>' + 
				'<EMPLEADO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@EMPLEADO) + '</EMPLEADO>' + 
				'<COMISION Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@COMISION) + '</COMISION>' + 
				'<CTR_COMISION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_COMISION) + '</CTR_COMISION>' + 
				'<CTA_COMISION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_COMISION) + '</CTA_COMISION>' + 
				'<E_MAIL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@E_MAIL) + '</E_MAIL>' + 
				'<ACTIVO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ACTIVO) + '</ACTIVO>' + 
				'</COBRADOR>'


				-- inserta la solicitud correspondiente
				EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'COBRADORPOS600', 'MODIFICA', @PARAMETROS, @ACTUALIZAR_SOLICITUD, @COL_ROWPOINTER
			END

			FETCH NEXT FROM C_MODIFIED
			INTO @COBRADOR, @NOMBRE, @EMPLEADO, @COMISION, @CTR_COMISION, @CTA_COMISION, @E_MAIL, @ACTIVO
		END

		CLOSE C_MODIFIED
		DEALLOCATE C_MODIFIED
	END

	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para modificar la tabla COBRADOR.',16,1 )
	END
END;




CREATE TRIGGER $$Compania$$.COBRO_POS_POS_INS
ON $$Compania$$.COBRO_POS
FOR INSERT
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @COBRO INT
	DECLARE @TIENDA VARCHAR(6)
	DECLARE @FECHA DATETIME
	DECLARE @MONTO DECIMAL(28,8)
	DECLARE @CLIENTE VARCHAR(20)
	DECLARE @COMISION DECIMAL(28,8)
	DECLARE @COMENTARIO VARCHAR(254)
	DECLARE @APROBADO VARCHAR(1)
	DECLARE @FECHA_HORA_CARGA DATETIME
	DECLARE @TIPO_SITIO_LOCAL VARCHAR(1)
	DECLARE @TIPO_CAMBIO DECIMAL(28,8)
	DECLARE @MONEDA_REPORTE VARCHAR(1)
	DECLARE @NUM_CIERRE INT
	DECLARE @ESTADO	VARCHAR(1) 	
	DECLARE @DOC_OD	VARCHAR(20) 
	DECLARE @TIPO_DOC_OD VARCHAR(20) 
	DECLARE @DOC_OC VARCHAR(20) 
	DECLARE @TIPO_DOC_OC VARCHAR(20) 
	DECLARE @FCH_HORA_ANUL DATETIME	
	DECLARE @TIPO_COBRO VARCHAR(1)

	SELECT @PUBLICADOR = SITIO_LOCAL,
		@USUARIO_POS_WSQM = USUARIO_WSQM,
		@TIPO_SITIO_LOCAL = TIPO_SITIO_LOCAL
  	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM) AND @TIPO_SITIO_LOCAL = 'T'
	BEGIN
		DECLARE C_INSERTED CURSOR LOCAL FOR
		SELECT COBRO, TIENDA, FECHA, MONTO, CLIENTE, COMISION, COMENTARIO, APROBADO, FECHA_HORA_CARGA, TIPO_CAMBIO, MONEDA_REPORTE, NUM_CIERRE, ESTADO, DOC_OD, TIPO_DOC_OD, DOC_OC, TIPO_DOC_OC, FCH_HORA_ANUL, TIPO_COBRO
		FROM INSERTED i
		WHERE 0 = (
				SELECT COUNT('n')
				FROM DELETED d
				WHERE i.COBRO = d.COBRO
			   )
			
		OPEN C_INSERTED	
		FETCH NEXT FROM C_INSERTED INTO
		@COBRO, @TIENDA, @FECHA, @MONTO, @CLIENTE, @COMISION, @COMENTARIO, @APROBADO, @FECHA_HORA_CARGA, @TIPO_CAMBIO, @MONEDA_REPORTE, @NUM_CIERRE, @ESTADO, @DOC_OD, @TIPO_DOC_OD, @DOC_OC, @TIPO_DOC_OC, @FCH_HORA_ANUL, @TIPO_COBRO
		SET @ERROR = 0
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS =
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<COBRO_POS>' +
				'<COBRO Type="INT" PrimaryKey="True">' + ERPADMIN.POS_NumberToVarchar(@COBRO) + '</COBRO>' +
				'<TIENDA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@TIENDA) + '</TIENDA>' +
				'<FECHA Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA) + '</FECHA>' +
				'<MONTO Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@MONTO) + '</MONTO>' +
				'<CLIENTE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CLIENTE) + '</CLIENTE>' +
				'<COMISION Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@COMISION) + '</COMISION>' +
				'<COMENTARIO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@COMENTARIO) + '</COMENTARIO>' +
				'<APROBADO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@APROBADO) + '</APROBADO>' +
				'<FECHA_HORA_CARGA Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_HORA_CARGA) + '</FECHA_HORA_CARGA>' +
				'<TIPO_CAMBIO Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@TIPO_CAMBIO) + '</TIPO_CAMBIO>' +
				'<MONEDA_REPORTE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@MONEDA_REPORTE) + '</MONEDA_REPORTE>' +
				'<NUM_CIERRE Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@NUM_CIERRE) + '</NUM_CIERRE>' +
				'<ESTADO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ESTADO) + '</ESTADO>' +
				'<DOC_OD Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DOC_OD) + '</DOC_OD>' +
				'<TIPO_DOC_OD Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_DOC_OD) + '</TIPO_DOC_OD>' +
				'<DOC_OC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DOC_OC) + '</DOC_OC>' +
				'<TIPO_DOC_OC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_DOC_OC) + '</TIPO_DOC_OC>' +
				'<FCH_HORA_ANUL Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FCH_HORA_ANUL) + '</FCH_HORA_ANUL>' +
				'<TIPO_COBRO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_COBRO) + '</TIPO_COBRO>' + 
				'</COBRO_POS>'
			-- Inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'COBROPOSPOS600', 'INSERTA', @PARAMETROS, 0, ''
			FETCH NEXT FROM C_INSERTED INTO
			@COBRO, @TIENDA, @FECHA, @MONTO, @CLIENTE, @COMISION, @COMENTARIO, @APROBADO, @FECHA_HORA_CARGA, @TIPO_CAMBIO, @MONEDA_REPORTE, @NUM_CIERRE, @ESTADO, @DOC_OD, @TIPO_DOC_OD, @DOC_OC, @TIPO_DOC_OC, @FCH_HORA_ANUL, @TIPO_COBRO
		END
		CLOSE C_INSERTED
    		DEALLOCATE C_INSERTED
	END
	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla COBRO_POS.',16,1 )
	END
END;







CREATE TRIGGER $$Compania$$.COBRO_POS_POS_DEL
ON $$Compania$$.COBRO_POS
FOR DELETE
AS
BEGIN   	
                DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @COBRO INT
	DECLARE @TIENDA VARCHAR(6)
	
	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_DELETED CURSOR LOCAL FOR
			SELECT COBRO, TIENDA
			FROM DELETED d
			WHERE 0 = (
				SELECT COUNT('n')
				FROM INSERTED i
				WHERE d.COBRO = i.COBRO
			   )
		OPEN C_DELETED
		FETCH NEXT FROM C_DELETED INTO
		@COBRO, @TIENDA
		
		SET @ERROR = 0
		
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS =
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<COBRO_POS>' +
				'<COBRO Type="INT" PrimaryKey="True">' + ERPADMIN.POS_NumberToVarchar(@COBRO) + '</COBRO>' +
				'<TIENDA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@TIENDA) + '</TIENDA>' +
				'</COBRO_POS>'
 -- XML
			
			-- inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'COBROPOSPOS600', 'ELIMINA', @PARAMETROS, 0, ''
			
			FETCH NEXT FROM C_DELETED INTO
			@COBRO, @TIENDA
		END
		CLOSE C_DELETED
		DEALLOCATE C_DELETED
	END
	
	IF (@@ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para eliminar de la tabla COBRO_POS.',16,1 )
	END
END
;



CREATE TRIGGER $$Compania$$.COBRO_POS_POS_MOD
ON $$Compania$$.COBRO_POS
FOR UPDATE
AS
BEGIN   	
	DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @COL_ROWPOINTER VARCHAR(36)
	DECLARE @HAY_CAMPOS_PARA_POS BIT
	DECLARE @ACTUALIZAR_SOLICITUD BIT
	DECLARE @COBRO INT
	DECLARE @TIENDA VARCHAR(6)
	DECLARE @FECHA DATETIME
	DECLARE @MONTO DECIMAL(28,8)
	DECLARE @CLIENTE VARCHAR(20)
	DECLARE @COMISION DECIMAL(28,8)
	DECLARE @COMENTARIO VARCHAR(254)
	DECLARE @APROBADO VARCHAR(1)
	DECLARE @FECHA_HORA_CARGA DATETIME
	DECLARE @TIPO_CAMBIO DECIMAL(28,8)
	DECLARE @MONEDA_REPORTE VARCHAR(1)
	DECLARE @NUM_CIERRE INT
	DECLARE @ESTADO	VARCHAR(1) 	
	DECLARE @DOC_OD	VARCHAR(20) 
	DECLARE @TIPO_DOC_OD VARCHAR(20) 
	DECLARE @DOC_OC VARCHAR(20) 
	DECLARE @TIPO_DOC_OC VARCHAR(20) 
	DECLARE @FCH_HORA_ANUL DATETIME	
	DECLARE @TIPO_COBRO VARCHAR(1)
	
	SET @ERROR = 0
	
	SELECT @PUBLICADOR = SITIO_LOCAL,
		@USUARIO_POS_WSQM = USUARIO_WSQM
  	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_MODIFIED CURSOR LOCAL FOR
			SELECT COBRO, TIENDA, FECHA, MONTO, CLIENTE, COMISION, COMENTARIO, APROBADO, FECHA_HORA_CARGA, TIPO_CAMBIO, MONEDA_REPORTE, NUM_CIERRE, ESTADO, DOC_OD, TIPO_DOC_OD, DOC_OC, TIPO_DOC_OC, FCH_HORA_ANUL, TIPO_COBRO -- Columnas
			FROM INSERTED I
		SET @ACTUALIZAR_SOLICITUD = 1
		OPEN C_MODIFIED
		FETCH NEXT FROM C_MODIFIED
		INTO @COBRO, @TIENDA, @FECHA, @MONTO, @CLIENTE, @COMISION, @COMENTARIO, @APROBADO, @FECHA_HORA_CARGA, @TIPO_CAMBIO, @MONEDA_REPORTE, @NUM_CIERRE, @ESTADO, @DOC_OD, @TIPO_DOC_OD, @DOC_OC, @TIPO_DOC_OC, @FCH_HORA_ANUL, @TIPO_COBRO
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			IF ( NOT UPDATE(RECORDDATE) AND ( UPDATE(COBRO) OR UPDATE(TIENDA) OR UPDATE(FECHA) OR UPDATE(MONTO) OR UPDATE(CLIENTE) OR UPDATE(COMISION) OR UPDATE(COMENTARIO) OR UPDATE(APROBADO) OR UPDATE(FECHA_HORA_CARGA) OR UPDATE(TIPO_CAMBIO) OR UPDATE(MONEDA_REPORTE) OR UPDATE(NUM_CIERRE) OR UPDATE(ESTADO) OR UPDATE(DOC_OD) OR UPDATE(TIPO_DOC_OD) OR UPDATE(DOC_OC) OR UPDATE(TIPO_DOC_OC) OR UPDATE(FCH_HORA_ANUL) OR UPDATE(TIPO_COBRO) ) )
			BEGIN
				IF @APROBADO = 'S'
        			BEGIN
					SELECT @COL_ROWPOINTER = ROWPOINTER
					FROM $$Compania$$.COBRO_POS
					WHERE COBRO = @COBRO
					SET @PARAMETROS =
					'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
					'<COBRO_POS>' +
					'<COBRO Type="INT" PrimaryKey="True">' + ERPADMIN.POS_NumberToVarchar(@COBRO) + '</COBRO>' +
					'<TIENDA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@TIENDA) + '</TIENDA>' +
					'<FECHA Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA) + '</FECHA>' +
					'<MONTO Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@MONTO) + '</MONTO>' +
					'<CLIENTE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CLIENTE) + '</CLIENTE>' +
					'<COMISION Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@COMISION) + '</COMISION>' +
					'<COMENTARIO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@COMENTARIO) + '</COMENTARIO>' +
					'<APROBADO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@APROBADO) + '</APROBADO>' +
					'<FECHA_HORA_CARGA Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_HORA_CARGA) + '</FECHA_HORA_CARGA>' +
					'<TIPO_CAMBIO Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@TIPO_CAMBIO) + '</TIPO_CAMBIO>' +
					'<MONEDA_REPORTE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@MONEDA_REPORTE) + '</MONEDA_REPORTE>' +
					'<NUM_CIERRE Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@NUM_CIERRE) + '</NUM_CIERRE>' +
					'<ESTADO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ESTADO) + '</ESTADO>' +
					'<DOC_OD Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DOC_OD) + '</DOC_OD>' +
					'<TIPO_DOC_OD Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_DOC_OD) + '</TIPO_DOC_OD>' +
					'<DOC_OC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DOC_OC) + '</DOC_OC>' +
					'<TIPO_DOC_OC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_DOC_OC) + '</TIPO_DOC_OC>' +
					'<FCH_HORA_ANUL Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FCH_HORA_ANUL) + '</FCH_HORA_ANUL>' +
					'<TIPO_COBRO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_COBRO) + '</TIPO_COBRO>' + 
					'</COBRO_POS>'
					-- inserta la solicitud correspondiente
					EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'COBROPOSPOS600', 'MODIFICA', @PARAMETROS, @ACTUALIZAR_SOLICITUD, @COL_ROWPOINTER
				END
			END
			FETCH NEXT FROM C_MODIFIED
			INTO @COBRO, @TIENDA, @FECHA, @MONTO, @CLIENTE, @COMISION, @COMENTARIO, @APROBADO, @FECHA_HORA_CARGA, @TIPO_CAMBIO, @MONEDA_REPORTE, @NUM_CIERRE, @ESTADO, @DOC_OD, @TIPO_DOC_OD, @DOC_OC, @TIPO_DOC_OC, @FCH_HORA_ANUL, @TIPO_COBRO
		END
		CLOSE C_MODIFIED
		DEALLOCATE C_MODIFIED
	END
	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para modificar la tabla COBRO_POS.',16,1 )
	END
END;






CREATE TRIGGER $$Compania$$.CONDICION_PAGO_POS_INS
ON $$Compania$$.CONDICION_PAGO
FOR INSERT
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @CONDICION_PAGO VARCHAR(4)
	DECLARE @DESCRIPCION VARCHAR(40)
	DECLARE @DIAS_NETO INT
	DECLARE @PAGOS_PARCIALES VARCHAR(1)
	DECLARE @DESCUENTO_CONTADO DECIMAL(28,8)
	DECLARE @TIPO_CONDPAGO VARCHAR(2)
	DECLARE @PLAZO_CONDPAGO INT
	
	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_INSERTED CURSOR LOCAL FOR
		SELECT CONDICION_PAGO, DESCRIPCION, DIAS_NETO, PAGOS_PARCIALES, DESCUENTO_CONTADO, TIPO_CONDPAGO, PLAZO_CONDPAGO
		FROM INSERTED i
		WHERE 0 = (
				SELECT COUNT('n')
				FROM DELETED d
				WHERE i.CONDICION_PAGO = d.CONDICION_PAGO
			   )
			
		OPEN C_INSERTED	
		FETCH NEXT FROM C_INSERTED INTO
		@CONDICION_PAGO, @DESCRIPCION, @DIAS_NETO, @PAGOS_PARCIALES, @DESCUENTO_CONTADO, @TIPO_CONDPAGO, @PLAZO_CONDPAGO
		SET @ERROR = 0
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS =
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<CONDICION_PAGO>' +
				'<CONDICION_PAGO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CONDICION_PAGO) + '</CONDICION_PAGO>' +
				'<DESCRIPCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DESCRIPCION) + '</DESCRIPCION>' +
				'<DIAS_NETO Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@DIAS_NETO) + '</DIAS_NETO>' +
				'<PAGOS_PARCIALES Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@PAGOS_PARCIALES) + '</PAGOS_PARCIALES>' +
				'<DESCUENTO_CONTADO Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@DESCUENTO_CONTADO) + '</DESCUENTO_CONTADO>' +
				'<TIPO_CONDPAGO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_CONDPAGO) + '</TIPO_CONDPAGO>' +
				'<PLAZO_CONDPAGO Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@PLAZO_CONDPAGO) + '</PLAZO_CONDPAGO>' +
				'</CONDICION_PAGO>'
			-- Inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'CONDICIONPAGOPOS600', 'INSERTA', @PARAMETROS, 0, ''
			FETCH NEXT FROM C_INSERTED INTO
			@CONDICION_PAGO, @DESCRIPCION, @DIAS_NETO, @PAGOS_PARCIALES, @DESCUENTO_CONTADO, @TIPO_CONDPAGO, @PLAZO_CONDPAGO
		END
		CLOSE C_INSERTED
    		DEALLOCATE C_INSERTED
	END
	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla CONDICION_PAGO.',16,1 )
	END
END
;




CREATE TRIGGER $$Compania$$.CONDICION_PAGO_POS_DEL
ON $$Compania$$.CONDICION_PAGO
FOR DELETE
AS
BEGIN   	
                DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @CONDICION_PAGO VARCHAR(4)
	 -- Declaraciones	
	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_DELETED CURSOR LOCAL FOR
			SELECT CONDICION_PAGO
			FROM DELETED d
			WHERE 0 = (
				SELECT COUNT('n')
				FROM INSERTED i
				WHERE d.CONDICION_PAGO = i.CONDICION_PAGO
			   )
		OPEN C_DELETED
		FETCH NEXT FROM C_DELETED INTO
		@CONDICION_PAGO
		
		SET @ERROR = 0
		
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS =
								'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<CONDICION_PAGO>' +
				'<CONDICION_PAGO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CONDICION_PAGO) + '</CONDICION_PAGO>' +
				'</CONDICION_PAGO>'
 -- XML
			
			-- inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'CONDICIONPAGOPOS600', 'ELIMINA', @PARAMETROS, 0, ''
			
			FETCH NEXT FROM C_DELETED INTO
			@CONDICION_PAGO
		END
		CLOSE C_DELETED
		DEALLOCATE C_DELETED
	END
	
	IF (@@ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para eliminar de la tabla CONDICION_PAGO.',16,1 )
	END
END
;




CREATE TRIGGER $$Compania$$.CONDICION_PAGO_POS_MOD
ON $$Compania$$.CONDICION_PAGO
FOR UPDATE
AS 
BEGIN   	
	DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @COL_ROWPOINTER VARCHAR(36)
	DECLARE @HAY_CAMPOS_PARA_POS BIT
	DECLARE @ACTUALIZAR_SOLICITUD BIT
	DECLARE @CONDICION_PAGO VARCHAR(4)
	DECLARE @DESCRIPCION VARCHAR(40)
	DECLARE @DIAS_NETO INT
	DECLARE @PAGOS_PARCIALES VARCHAR(1)
	DECLARE @DESCUENTO_CONTADO DECIMAL(28,8)
	DECLARE @TIPO_CONDPAGO VARCHAR(2)
	DECLARE @PLAZO_CONDPAGO INT
	 -- Declaraciones

	SET @ERROR = 0

	SELECT @PUBLICADOR = SITIO_LOCAL, @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_MODIFIED CURSOR LOCAL FOR
			SELECT CONDICION_PAGO, DESCRIPCION, DIAS_NETO, PAGOS_PARCIALES, DESCUENTO_CONTADO, TIPO_CONDPAGO, PLAZO_CONDPAGO -- Columnas
			FROM INSERTED I

		SET @ACTUALIZAR_SOLICITUD = 1

		OPEN C_MODIFIED

		FETCH NEXT FROM C_MODIFIED
		INTO @CONDICION_PAGO, @DESCRIPCION, @DIAS_NETO, @PAGOS_PARCIALES, @DESCUENTO_CONTADO, @TIPO_CONDPAGO, @PLAZO_CONDPAGO

		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			IF ( NOT UPDATE(RECORDDATE) AND ( UPDATE(CONDICION_PAGO) OR UPDATE(DESCRIPCION) OR UPDATE(DIAS_NETO) OR UPDATE(PAGOS_PARCIALES) OR UPDATE(DESCUENTO_CONTADO) OR UPDATE(TIPO_CONDPAGO) OR UPDATE(PLAZO_CONDPAGO) ) )
			BEGIN

				SELECT @COL_ROWPOINTER = ROWPOINTER 
				FROM $$Compania$$.CONDICION_PAGO
				WHERE CONDICION_PAGO = @CONDICION_PAGO 

				SET @PARAMETROS =
					'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<CONDICION_PAGO>' + 
				'<CONDICION_PAGO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CONDICION_PAGO) + '</CONDICION_PAGO>' + 
				'<DESCRIPCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DESCRIPCION) + '</DESCRIPCION>' + 
				'<DIAS_NETO Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@DIAS_NETO) + '</DIAS_NETO>' + 
				'<PAGOS_PARCIALES Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@PAGOS_PARCIALES) + '</PAGOS_PARCIALES>' + 
				'<DESCUENTO_CONTADO Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@DESCUENTO_CONTADO) + '</DESCUENTO_CONTADO>' + 
				'<TIPO_CONDPAGO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_CONDPAGO) + '</TIPO_CONDPAGO>' + 
				'<PLAZO_CONDPAGO Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@PLAZO_CONDPAGO) + '</PLAZO_CONDPAGO>' + 
				'</CONDICION_PAGO>'


				-- inserta la solicitud correspondiente
				EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'CONDICIONPAGOPOS600', 'MODIFICA', @PARAMETROS, @ACTUALIZAR_SOLICITUD, @COL_ROWPOINTER
			END

			FETCH NEXT FROM C_MODIFIED
			INTO @CONDICION_PAGO, @DESCRIPCION, @DIAS_NETO, @PAGOS_PARCIALES, @DESCUENTO_CONTADO, @TIPO_CONDPAGO, @PLAZO_CONDPAGO
		END

		CLOSE C_MODIFIED
		DEALLOCATE C_MODIFIED
	END

	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para modificar la tabla CONDICION_PAGO.',16,1 )
	END
END;



CREATE TRIGGER $$Compania$$.CONSECUTIVO_POS_INS
ON $$Compania$$.CONSECUTIVO
FOR INSERT
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @CONSECUTIVO VARCHAR(10)
	DECLARE @DESCRIPCION VARCHAR(40)
	DECLARE @ACTIVO VARCHAR(1)
	DECLARE @LONGITUD DECIMAL(28,8)
	DECLARE @ENTIDAD VARCHAR(40)
	DECLARE @DOCUMENTO VARCHAR(40)
	DECLARE @FORMATO_IMPRESION_DETALLADO VARCHAR(250)
	DECLARE @FORMATO_IMPRESION_RESUMIDO VARCHAR(250)
	DECLARE @MASCARA VARCHAR(50)
	DECLARE @VALOR_INICIAL VARCHAR(50)
	DECLARE @VALOR_FINAL VARCHAR(50)
	DECLARE @ULTIMO_VALOR VARCHAR(50)
	DECLARE @ULTIMO_USUARIO VARCHAR(25)
	DECLARE @FECHA_HORA_ULT DATETIME
	

	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM 
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (SYSTEM_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_INSERTED CURSOR LOCAL FOR
		SELECT CONSECUTIVO, DESCRIPCION, ACTIVO, LONGITUD, ENTIDAD, DOCUMENTO, FORMATO_IMPRESION_DETALLADO, FORMATO_IMPRESION_RESUMIDO, MASCARA, VALOR_INICIAL, VALOR_FINAL, ULTIMO_VALOR, ULTIMO_USUARIO, FECHA_HORA_ULT
		FROM INSERTED i
		WHERE 0 = (
				SELECT COUNT('n')
				FROM DELETED d
				WHERE i.CONSECUTIVO = d.CONSECUTIVO
			   )
			
		OPEN C_INSERTED	
		FETCH NEXT FROM C_INSERTED INTO
		@CONSECUTIVO, @DESCRIPCION, @ACTIVO, @LONGITUD, @ENTIDAD, @DOCUMENTO, @FORMATO_IMPRESION_DETALLADO, @FORMATO_IMPRESION_RESUMIDO, @MASCARA, @VALOR_INICIAL, @VALOR_FINAL, @ULTIMO_VALOR, @ULTIMO_USUARIO, @FECHA_HORA_ULT

		SET @ERROR = 0
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS = 
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<CONSECUTIVO>' + 
				'<CONSECUTIVO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CONSECUTIVO) + '</CONSECUTIVO>' + 
				'<DESCRIPCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DESCRIPCION) + '</DESCRIPCION>' + 
				'<ACTIVO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ACTIVO) + '</ACTIVO>' + 
				'<LONGITUD Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@LONGITUD) + '</LONGITUD>' + 
				'<ENTIDAD Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ENTIDAD) + '</ENTIDAD>' + 
				'<DOCUMENTO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DOCUMENTO) + '</DOCUMENTO>' + 
				'<FORMATO_IMPRESION_DETALLADO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@FORMATO_IMPRESION_DETALLADO) + '</FORMATO_IMPRESION_DETALLADO>' + 
				'<FORMATO_IMPRESION_RESUMIDO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@FORMATO_IMPRESION_RESUMIDO) + '</FORMATO_IMPRESION_RESUMIDO>' + 
				'<MASCARA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@MASCARA) + '</MASCARA>' + 
				'<VALOR_INICIAL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@VALOR_INICIAL) + '</VALOR_INICIAL>' + 
				'<VALOR_FINAL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@VALOR_FINAL) + '</VALOR_FINAL>' + 
				'<ULTIMO_VALOR Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ULTIMO_VALOR) + '</ULTIMO_VALOR>' + 
				'<ULTIMO_USUARIO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ULTIMO_USUARIO) + '</ULTIMO_USUARIO>' + 
				'<FECHA_HORA_ULT Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_HORA_ULT) + '</FECHA_HORA_ULT>' + 
				'</CONSECUTIVO>'


			-- Inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'CONSECUTIVOPOS600', 'INSERTA', @PARAMETROS, 0, ''

			FETCH NEXT FROM C_INSERTED INTO
			@CONSECUTIVO, @DESCRIPCION, @ACTIVO, @LONGITUD, @ENTIDAD, @DOCUMENTO, @FORMATO_IMPRESION_DETALLADO, @FORMATO_IMPRESION_RESUMIDO, @MASCARA, @VALOR_INICIAL, @VALOR_FINAL, @ULTIMO_VALOR, @ULTIMO_USUARIO, @FECHA_HORA_ULT
		END

		CLOSE C_INSERTED
    		DEALLOCATE C_INSERTED
	END

	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla CONSECUTIVO.',16,1 )
	END
END;






CREATE TRIGGER $$Compania$$.CONSECUTIVO_POS_MOD
ON $$Compania$$.CONSECUTIVO
FOR UPDATE
AS 
BEGIN   	
	DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @COL_ROWPOINTER VARCHAR(36)
	DECLARE @HAY_CAMPOS_PARA_POS BIT
	DECLARE @ACTUALIZAR_SOLICITUD BIT
	DECLARE @CONSECUTIVO VARCHAR(10)
	DECLARE @DESCRIPCION VARCHAR(40)
	DECLARE @ACTIVO VARCHAR(1)
	DECLARE @LONGITUD DECIMAL(28,8)
	DECLARE @ENTIDAD VARCHAR(40)
	DECLARE @DOCUMENTO VARCHAR(40)
	DECLARE @FORMATO_IMPRESION_DETALLADO VARCHAR(250)
	DECLARE @FORMATO_IMPRESION_RESUMIDO VARCHAR(250)
	DECLARE @MASCARA VARCHAR(50)
	DECLARE @VALOR_INICIAL VARCHAR(50)
	DECLARE @VALOR_FINAL VARCHAR(50)
	DECLARE @ULTIMO_VALOR VARCHAR(50)
	DECLARE @ULTIMO_USUARIO VARCHAR(25)
	DECLARE @FECHA_HORA_ULT DATETIME
	 -- Declaraciones

	SET @ERROR = 0

	SELECT @PUBLICADOR = SITIO_LOCAL, @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (SYSTEM_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_MODIFIED CURSOR LOCAL FOR
			SELECT CONSECUTIVO, DESCRIPCION, ACTIVO, LONGITUD, ENTIDAD, DOCUMENTO, FORMATO_IMPRESION_DETALLADO, FORMATO_IMPRESION_RESUMIDO, MASCARA, VALOR_INICIAL, VALOR_FINAL, ULTIMO_VALOR, ULTIMO_USUARIO, FECHA_HORA_ULT -- Columnas
			FROM INSERTED I

		SET @ACTUALIZAR_SOLICITUD = 1

		OPEN C_MODIFIED

		FETCH NEXT FROM C_MODIFIED
		INTO @CONSECUTIVO, @DESCRIPCION, @ACTIVO, @LONGITUD, @ENTIDAD, @DOCUMENTO, @FORMATO_IMPRESION_DETALLADO, @FORMATO_IMPRESION_RESUMIDO, @MASCARA, @VALOR_INICIAL, @VALOR_FINAL, @ULTIMO_VALOR, @ULTIMO_USUARIO, @FECHA_HORA_ULT

		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			IF ( NOT UPDATE(RECORDDATE) AND ( UPDATE(CONSECUTIVO) OR UPDATE(DESCRIPCION) OR UPDATE(ACTIVO) OR UPDATE(LONGITUD) OR UPDATE(ENTIDAD) OR UPDATE(DOCUMENTO) OR UPDATE(FORMATO_IMPRESION_DETALLADO) OR UPDATE(FORMATO_IMPRESION_RESUMIDO) OR UPDATE(MASCARA) OR UPDATE(VALOR_INICIAL) OR UPDATE(VALOR_FINAL) OR UPDATE(ULTIMO_VALOR) OR UPDATE(ULTIMO_USUARIO) OR UPDATE(FECHA_HORA_ULT) ) )
			BEGIN

				SELECT @COL_ROWPOINTER = ROWPOINTER 
				FROM $$Compania$$.CONSECUTIVO
				WHERE CONSECUTIVO = @CONSECUTIVO 

				SET @PARAMETROS =
					'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<CONSECUTIVO>' + 
				'<CONSECUTIVO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CONSECUTIVO) + '</CONSECUTIVO>' + 
				'<DESCRIPCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DESCRIPCION) + '</DESCRIPCION>' + 
				'<ACTIVO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ACTIVO) + '</ACTIVO>' + 
				'<LONGITUD Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@LONGITUD) + '</LONGITUD>' + 
				'<ENTIDAD Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ENTIDAD) + '</ENTIDAD>' + 
				'<DOCUMENTO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DOCUMENTO) + '</DOCUMENTO>' + 
				'<FORMATO_IMPRESION_DETALLADO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@FORMATO_IMPRESION_DETALLADO) + '</FORMATO_IMPRESION_DETALLADO>' + 
				'<FORMATO_IMPRESION_RESUMIDO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@FORMATO_IMPRESION_RESUMIDO) + '</FORMATO_IMPRESION_RESUMIDO>' + 
				'<MASCARA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@MASCARA) + '</MASCARA>' + 
				'<VALOR_INICIAL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@VALOR_INICIAL) + '</VALOR_INICIAL>' + 
				'<VALOR_FINAL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@VALOR_FINAL) + '</VALOR_FINAL>' + 
				'<ULTIMO_VALOR Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ULTIMO_VALOR) + '</ULTIMO_VALOR>' + 
				'<ULTIMO_USUARIO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ULTIMO_USUARIO) + '</ULTIMO_USUARIO>' + 
				'<FECHA_HORA_ULT Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_HORA_ULT) + '</FECHA_HORA_ULT>' + 
				'</CONSECUTIVO>'


				-- inserta la solicitud correspondiente
				EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'CONSECUTIVOPOS600', 'MODIFICA', @PARAMETROS, @ACTUALIZAR_SOLICITUD, @COL_ROWPOINTER
			END

			FETCH NEXT FROM C_MODIFIED
			INTO @CONSECUTIVO, @DESCRIPCION, @ACTIVO, @LONGITUD, @ENTIDAD, @DOCUMENTO, @FORMATO_IMPRESION_DETALLADO, @FORMATO_IMPRESION_RESUMIDO, @MASCARA, @VALOR_INICIAL, @VALOR_FINAL, @ULTIMO_VALOR, @ULTIMO_USUARIO, @FECHA_HORA_ULT
		END

		CLOSE C_MODIFIED
		DEALLOCATE C_MODIFIED
	END

	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para modificar la tabla CONSECUTIVO.',16,1 )
	END
END;




CREATE TRIGGER $$Compania$$.CONSECUTIVO_POS_DEL
ON $$Compania$$.CONSECUTIVO
FOR DELETE  
AS 
BEGIN   	
    DECLARE @ERROR  int
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @CONSECUTIVO VARCHAR(10)
	DECLARE @DESCRIPCION VARCHAR(40)
	DECLARE @ACTIVO VARCHAR(1)
	DECLARE @LONGITUD DECIMAL(28,8)
	DECLARE @ENTIDAD VARCHAR(40)
	DECLARE @DOCUMENTO VARCHAR(40)
	DECLARE @FORMATO_IMPRESION_DETALLADO VARCHAR(250)
	DECLARE @FORMATO_IMPRESION_RESUMIDO VARCHAR(250)
	DECLARE @MASCARA VARCHAR(50)
	DECLARE @VALOR_INICIAL VARCHAR(50)
	DECLARE @VALOR_FINAL VARCHAR(50)
	DECLARE @ULTIMO_VALOR VARCHAR(50)
	DECLARE @ULTIMO_USUARIO VARCHAR(25)
	DECLARE @FECHA_HORA_ULT DATETIME
	 -- Declaraciones	

	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM 
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (SYSTEM_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_DELETED CURSOR LOCAL FOR
			SELECT CONSECUTIVO, DESCRIPCION, ACTIVO, LONGITUD, ENTIDAD, DOCUMENTO, FORMATO_IMPRESION_DETALLADO, FORMATO_IMPRESION_RESUMIDO, MASCARA, VALOR_INICIAL, VALOR_FINAL, ULTIMO_VALOR, ULTIMO_USUARIO, FECHA_HORA_ULT
			FROM DELETED d
			WHERE 0 = (
				SELECT COUNT('n')
				FROM INSERTED i
				WHERE d.CONSECUTIVO = i.CONSECUTIVO
			   )

		OPEN C_DELETED
		FETCH NEXT FROM C_DELETED INTO 
		@CONSECUTIVO, @DESCRIPCION, @ACTIVO, @LONGITUD, @ENTIDAD, @DOCUMENTO, @FORMATO_IMPRESION_DETALLADO, @FORMATO_IMPRESION_RESUMIDO, @MASCARA, @VALOR_INICIAL, @VALOR_FINAL, @ULTIMO_VALOR, @ULTIMO_USUARIO, @FECHA_HORA_ULT -- VARIABLES
		
		SET @ERROR = 0
		
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS = 
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<CONSECUTIVO>' + 
				'<CONSECUTIVO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CONSECUTIVO) + '</CONSECUTIVO>' + 
				'<DESCRIPCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DESCRIPCION) + '</DESCRIPCION>' + 
				'<ACTIVO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ACTIVO) + '</ACTIVO>' + 
				'<LONGITUD Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@LONGITUD) + '</LONGITUD>' + 
				'<ENTIDAD Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ENTIDAD) + '</ENTIDAD>' + 
				'<DOCUMENTO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DOCUMENTO) + '</DOCUMENTO>' + 
				'<FORMATO_IMPRESION_DETALLADO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@FORMATO_IMPRESION_DETALLADO) + '</FORMATO_IMPRESION_DETALLADO>' + 
				'<FORMATO_IMPRESION_RESUMIDO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@FORMATO_IMPRESION_RESUMIDO) + '</FORMATO_IMPRESION_RESUMIDO>' + 
				'<MASCARA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@MASCARA) + '</MASCARA>' + 
				'<VALOR_INICIAL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@VALOR_INICIAL) + '</VALOR_INICIAL>' + 
				'<VALOR_FINAL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@VALOR_FINAL) + '</VALOR_FINAL>' + 
				'<ULTIMO_VALOR Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ULTIMO_VALOR) + '</ULTIMO_VALOR>' + 
				'<ULTIMO_USUARIO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ULTIMO_USUARIO) + '</ULTIMO_USUARIO>' + 
				'<FECHA_HORA_ULT Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_HORA_ULT) + '</FECHA_HORA_ULT>' + 
				'</CONSECUTIVO>'
 
			
			-- inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'CONSECUTIVOPOS600', 'ELIMINA', @PARAMETROS, 0, ''
			
			FETCH NEXT FROM C_DELETED INTO 
			@CONSECUTIVO, @DESCRIPCION, @ACTIVO, @LONGITUD, @ENTIDAD, @DOCUMENTO, @FORMATO_IMPRESION_DETALLADO, @FORMATO_IMPRESION_RESUMIDO, @MASCARA, @VALOR_INICIAL, @VALOR_FINAL, @ULTIMO_VALOR, @ULTIMO_USUARIO, @FECHA_HORA_ULT -- VARIABLES
		END

		CLOSE C_DELETED
		DEALLOCATE C_DELETED
	END
	
	IF (@@ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para eliminar de la tabla CONSECUTIVO.',16,1 )
	END
END;






CREATE TRIGGER $$Compania$$.CONSECUTIVO_USUARIO_POS_INS
ON $$Compania$$.CONSECUTIVO_USUARIO
FOR INSERT
AS
BEGIN
 DECLARE @ERROR INT
 DECLARE @PUBLICADOR VARCHAR(20)
 DECLARE @PARAMETROS VARCHAR(8000)
 DECLARE @USUARIO_POS_WSQM VARCHAR(100)
 DECLARE @CONSECUTIVO VARCHAR(10)
 DECLARE @USUARIO VARCHAR(25)
 

 SELECT @PUBLICADOR = SITIO_LOCAL,
        @USUARIO_POS_WSQM = USUARIO_WSQM 
 FROM $$Compania$$.GLOBALES_POS

 -- Aquí se hace la validación del usuario de conexión para evitar ping-pong
 IF NOT (SYSTEM_USER = @USUARIO_POS_WSQM)
 BEGIN
  DECLARE C_INSERTED CURSOR LOCAL FOR
  SELECT CONSECUTIVO, USUARIO
  FROM INSERTED
   
  OPEN C_INSERTED 
  FETCH NEXT FROM C_INSERTED INTO
  @CONSECUTIVO, @USUARIO

  SET @ERROR = 0
  WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
  BEGIN
   SET @PARAMETROS = 
    '<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
    '<CONSECUTIVO_USUARIO>' + 
    '<CONSECUTIVO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CONSECUTIVO) + '</CONSECUTIVO>' + 
    '<USUARIO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USUARIO) + '</USUARIO>' + 
    '</CONSECUTIVO_USUARIO>'

   -- Inserta la solicitud correspondiente
   EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'CONSECUTIVOUSUARIOPOS600', 'INSERTA', @PARAMETROS, 0, ''

   FETCH NEXT FROM C_INSERTED INTO
   @CONSECUTIVO, @USUARIO
  END

  CLOSE C_INSERTED
      DEALLOCATE C_INSERTED
 END

 IF (@@ERROR <> 0 OR @ERROR <> 0) 
 BEGIN
  RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla CONSECUTIVO_USUARIO.',16,1 )
 END
END;





CREATE TRIGGER $$Compania$$.CONSECUTIVO_USUARIO_POS_MOD
ON $$Compania$$.CONSECUTIVO_USUARIO
FOR UPDATE
AS 
BEGIN    
 DECLARE @ERROR  INT
 DECLARE @PUBLICADOR VARCHAR(20)
 DECLARE @PARAMETROS VARCHAR(8000)
 DECLARE @USUARIO_POS_WSQM VARCHAR(100)
 DECLARE @COL_ROWPOINTER VARCHAR(36)
 DECLARE @HAY_CAMPOS_PARA_POS BIT
 DECLARE @ACTUALIZAR_SOLICITUD BIT
 DECLARE @CONSECUTIVO VARCHAR(10)
 DECLARE @USUARIO VARCHAR(25)
 
  -- Declaraciones

 SET @ERROR = 0

 SELECT @PUBLICADOR = SITIO_LOCAL, @USUARIO_POS_WSQM = USUARIO_WSQM
 FROM $$Compania$$.GLOBALES_POS

 -- Aquí se hace la validación del usuario de conexión para evitar ping-pong
 IF NOT (SYSTEM_USER = @USUARIO_POS_WSQM)
 BEGIN
  DECLARE C_MODIFIED CURSOR LOCAL FOR
   SELECT CONSECUTIVO, USUARIO  -- Columnas
   FROM INSERTED I

  SET @ACTUALIZAR_SOLICITUD = 1

  OPEN C_MODIFIED

  FETCH NEXT FROM C_MODIFIED
  INTO @CONSECUTIVO, @USUARIO

  WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
  BEGIN
   IF ( NOT UPDATE(RECORDDATE) OR ( UPDATE(CONSECUTIVO) OR UPDATE(USUARIO)) )
   BEGIN

    SELECT @COL_ROWPOINTER = ROWPOINTER 
    FROM $$Compania$$.CONSECUTIVO_USUARIO
    WHERE CONSECUTIVO = @CONSECUTIVO
    AND USUARIO = @USUARIO
    
    SET @PARAMETROS =
    '<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
    '<CONSECUTIVO_USUARIO>' + 
    '<CONSECUTIVO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CONSECUTIVO) + '</CONSECUTIVO>' + 
    '<USUARIO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USUARIO) + '</USUARIO>' + 
    '</CONSECUTIVO_USUARIO>'

    -- inserta la solicitud correspondiente
    EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'CONSECUTIVOUSUARIOPOS600', 'MODIFICA', @PARAMETROS, @ACTUALIZAR_SOLICITUD, @COL_ROWPOINTER
   END

   FETCH NEXT FROM C_MODIFIED
   INTO @CONSECUTIVO, @USUARIO
  END

  CLOSE C_MODIFIED
  DEALLOCATE C_MODIFIED
 END

 IF (@@ERROR <> 0 OR @ERROR <> 0) 
 BEGIN
  RAISERROR( 'Error generando la solicitud de servicio para modificar la tabla CONSECUTIVO_USUARIO.',16,1 )
 END
END;





CREATE TRIGGER $$Compania$$.CONSECUTIVO_USUARIO_POS_DEL
ON $$Compania$$.CONSECUTIVO_USUARIO
FOR DELETE  
AS 
BEGIN    
    DECLARE @ERROR  int
 DECLARE @PUBLICADOR VARCHAR(20)
 DECLARE @PARAMETROS VARCHAR(8000)
 DECLARE @USUARIO_POS_WSQM VARCHAR(100)
 DECLARE @CONSECUTIVO VARCHAR(10)
 DECLARE @USUARIO VARCHAR(25)
 
  -- Declaraciones 

 SELECT @PUBLICADOR = SITIO_LOCAL,
        @USUARIO_POS_WSQM = USUARIO_WSQM 
 FROM $$Compania$$.GLOBALES_POS

 -- Aquí se hace la validación del usuario de conexión para evitar ping-pong
 IF NOT (SYSTEM_USER = @USUARIO_POS_WSQM)
 BEGIN
  DECLARE C_DELETED CURSOR LOCAL FOR
   SELECT CONSECUTIVO, USUARIO
   FROM DELETED

  OPEN C_DELETED
  FETCH NEXT FROM C_DELETED INTO 
  @CONSECUTIVO, @USUARIO -- VARIABLES
  
  SET @ERROR = 0
  
  WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
  BEGIN
   SET @PARAMETROS = 
    '<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
    '<CONSECUTIVO_USUARIO>' + 
    '<CONSECUTIVO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CONSECUTIVO) + '</CONSECUTIVO>' + 
    '<USUARIO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USUARIO) + '</USUARIO>' + 
    '</CONSECUTIVO_USUARIO>'
 
   -- inserta la solicitud correspondiente
   EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'CONSECUTIVOUSUARIOPOS600', 'ELIMINA', @PARAMETROS, 0, ''
   
   FETCH NEXT FROM C_DELETED INTO 
   @CONSECUTIVO, @USUARIO -- VARIABLES
  END

  CLOSE C_DELETED
  DEALLOCATE C_DELETED
 END
 
 IF (@@ERROR <> 0) 
 BEGIN
  RAISERROR( 'Error generando la solicitud de servicio para eliminar de la tabla CONSECUTIVO_USUARIO.',16,1 )
 END
END;




CREATE TRIGGER $$Compania$$.CUENTA_BANCARIA_POS_INS
ON $$Compania$$.CUENTA_BANCARIA
FOR INSERT
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @CUENTA_BANCO VARCHAR(20)
	DECLARE @NOMBRE VARCHAR(40)
	DECLARE @ENTIDAD_FINANCIERA VARCHAR(8)
	DECLARE @MONEDA VARCHAR(4)
	DECLARE @DIRECCION VARCHAR(90)
	DECLARE @TELEFONO1 VARCHAR(15)
	DECLARE @TELEFONO2 VARCHAR(15)
	DECLARE @CONTACTO VARCHAR(40)
	DECLARE @CARGO VARCHAR(40)
	DECLARE @FORMATO VARCHAR(30)
	DECLARE @FECHA_ULT_MOV DATETIME
	DECLARE @SALDO DECIMAL(28,8)
	DECLARE @SALDO_BANCOS DECIMAL(28,8)
	DECLARE @POSICION_DE_CAJA DECIMAL(28,8)
	DECLARE @SALDO_ANTERIOR DECIMAL(28,8)
	DECLARE @TIPO_CAMBIO_LOCAL DECIMAL(28,8)
	DECLARE @TIPO_CAMBIO_DOLAR DECIMAL(28,8)
	DECLARE @ACTIVA VARCHAR(1)
	DECLARE @ULTIMO_DEPOSITO DECIMAL(28,8)
	DECLARE @ULTIMA_TEFCR DECIMAL(28,8)
	DECLARE @LIMITE_SOBREGIRO DECIMAL(28,8)
	DECLARE @CTR_CONTABLE VARCHAR(25)
	DECLARE @CTA_CONTABLE VARCHAR(25)
	DECLARE @CTR_CIERRE_DEB VARCHAR(25)
	DECLARE @CTA_CIERRE_DEB VARCHAR(25)
	DECLARE @CTR_CIERRE_CRED VARCHAR(25)
	DECLARE @CTA_CIERRE_CRED VARCHAR(25)
	DECLARE @ULTIMA_NOTACR DECIMAL(28,8)
	DECLARE @ULTIMO_CHEQUE DECIMAL(28,8)
	DECLARE @ULTIMO_OTROCR DECIMAL(28,8)
	DECLARE @ULTIMA_TEFDB DECIMAL(28,8)
	DECLARE @ULTIMA_NOTADB DECIMAL(28,8)
	DECLARE @ULTIMO_OTRODB DECIMAL(28,8)
	DECLARE @ULTIMA_CONCIL INT
	DECLARE @MODO_CONCILIAR VARCHAR(1)
	DECLARE @IDIOMA_MON_LETRAS VARCHAR(1)
	DECLARE @TIPO_CRED_AJUSTE VARCHAR(3)
	DECLARE @SUBTIPO_CRED_AJUST INT
	DECLARE @TIPO_DEB_AJUSTE VARCHAR(3)
	DECLARE @SUBTIPO_DEB_AJUST INT
	DECLARE @PERMITE_SOBREGIRO VARCHAR(1)
	DECLARE @CTA_AJUSTE_CRED VARCHAR(25)
	DECLARE @FCH_HORA_CREACION DATETIME
	DECLARE @USUARIO_CREACION VARCHAR(25)
	DECLARE @CTR_AJUSTE_DEB VARCHAR(25)
	DECLARE @CTR_GASTO_TRANSF VARCHAR(25)
	DECLARE @CTA_AJUSTE_DEB VARCHAR(25)
	DECLARE @CTA_GASTO_TRANSF VARCHAR(25)
	DECLARE @CTR_LIQUIDAR_CRED VARCHAR(25)
	DECLARE @CTA_LIQUIDAR_CRED VARCHAR(25)
	DECLARE @CTR_LIQUIDAR_DEB VARCHAR(25)
	DECLARE @CTA_LIQUIDAR_DEB VARCHAR(25)
	DECLARE @CTR_AJUSTE_CRED VARCHAR(25)
	DECLARE @FCH_HORA_MODIFIC DATETIME
	DECLARE @USUARIO_MODIFIC VARCHAR(25)
	DECLARE @PERMITE_TRANSF_IC VARCHAR(1)
	DECLARE @CTA_TRANSF_IC VARCHAR(25)
	DECLARE @CTR_TRANSF_IC VARCHAR(25)
	DECLARE @RUBRO1_CTABANCO VARCHAR(40)
	DECLARE @RUBRO2_CTABANCO VARCHAR(40)
	DECLARE @RUBRO3_CTABANCO VARCHAR(40)
	DECLARE @RUBRO4_CTABANCO VARCHAR(40)
	DECLARE @RUBRO5_CTABANCO VARCHAR(40)
	DECLARE @RUBRO6_CTABANCO VARCHAR(40)
	DECLARE @RUBRO7_CTABANCO VARCHAR(40)
	DECLARE @RUBRO8_CTABANCO VARCHAR(40)
	DECLARE @RUBRO9_CTABANCO VARCHAR(40)
	DECLARE @RUBRO10_CTABANCO VARCHAR(40)
	
	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_INSERTED CURSOR LOCAL FOR
		SELECT CUENTA_BANCO, NOMBRE, ENTIDAD_FINANCIERA, MONEDA, DIRECCION, TELEFONO1, TELEFONO2, CONTACTO, CARGO, FORMATO, FECHA_ULT_MOV, SALDO, SALDO_BANCOS, POSICION_DE_CAJA, SALDO_ANTERIOR, TIPO_CAMBIO_LOCAL, TIPO_CAMBIO_DOLAR, ACTIVA, ULTIMO_DEPOSITO, ULTIMA_TEFCR, LIMITE_SOBREGIRO, CTR_CONTABLE, CTA_CONTABLE, CTR_CIERRE_DEB, CTA_CIERRE_DEB, CTR_CIERRE_CRED, CTA_CIERRE_CRED, ULTIMA_NOTACR, ULTIMO_CHEQUE, ULTIMO_OTROCR, ULTIMA_TEFDB, ULTIMA_NOTADB, ULTIMO_OTRODB, ULTIMA_CONCIL, MODO_CONCILIAR, IDIOMA_MON_LETRAS, TIPO_CRED_AJUSTE, SUBTIPO_CRED_AJUST, TIPO_DEB_AJUSTE, SUBTIPO_DEB_AJUST, PERMITE_SOBREGIRO, CTA_AJUSTE_CRED, FCH_HORA_CREACION, USUARIO_CREACION, CTR_AJUSTE_DEB, CTR_GASTO_TRANSF, CTA_AJUSTE_DEB, CTA_GASTO_TRANSF, CTR_LIQUIDAR_CRED, CTA_LIQUIDAR_CRED, CTR_LIQUIDAR_DEB, CTA_LIQUIDAR_DEB, CTR_AJUSTE_CRED, FCH_HORA_MODIFIC, USUARIO_MODIFIC, PERMITE_TRANSF_IC, CTA_TRANSF_IC, CTR_TRANSF_IC, RUBRO1_CTABANCO, RUBRO2_CTABANCO, RUBRO3_CTABANCO, RUBRO4_CTABANCO, RUBRO5_CTABANCO, RUBRO6_CTABANCO, RUBRO7_CTABANCO, RUBRO8_CTABANCO, RUBRO9_CTABANCO, RUBRO10_CTABANCO
		FROM INSERTED i
		WHERE 0 = (
				SELECT COUNT('n')
				FROM DELETED d
				WHERE i.CUENTA_BANCO = d.CUENTA_BANCO
			   )
			
		OPEN C_INSERTED	
		FETCH NEXT FROM C_INSERTED INTO
		@CUENTA_BANCO, @NOMBRE, @ENTIDAD_FINANCIERA, @MONEDA, @DIRECCION, @TELEFONO1, @TELEFONO2, @CONTACTO, @CARGO, @FORMATO, @FECHA_ULT_MOV, @SALDO, @SALDO_BANCOS, @POSICION_DE_CAJA, @SALDO_ANTERIOR, @TIPO_CAMBIO_LOCAL, @TIPO_CAMBIO_DOLAR, @ACTIVA, @ULTIMO_DEPOSITO, @ULTIMA_TEFCR, @LIMITE_SOBREGIRO, @CTR_CONTABLE, @CTA_CONTABLE, @CTR_CIERRE_DEB, @CTA_CIERRE_DEB, @CTR_CIERRE_CRED, @CTA_CIERRE_CRED, @ULTIMA_NOTACR, @ULTIMO_CHEQUE, @ULTIMO_OTROCR, @ULTIMA_TEFDB, @ULTIMA_NOTADB, @ULTIMO_OTRODB, @ULTIMA_CONCIL, @MODO_CONCILIAR, @IDIOMA_MON_LETRAS, @TIPO_CRED_AJUSTE, @SUBTIPO_CRED_AJUST, @TIPO_DEB_AJUSTE, @SUBTIPO_DEB_AJUST, @PERMITE_SOBREGIRO, @CTA_AJUSTE_CRED, @FCH_HORA_CREACION, @USUARIO_CREACION, @CTR_AJUSTE_DEB, @CTR_GASTO_TRANSF, @CTA_AJUSTE_DEB, @CTA_GASTO_TRANSF, @CTR_LIQUIDAR_CRED, @CTA_LIQUIDAR_CRED, @CTR_LIQUIDAR_DEB, @CTA_LIQUIDAR_DEB, @CTR_AJUSTE_CRED, @FCH_HORA_MODIFIC, @USUARIO_MODIFIC, @PERMITE_TRANSF_IC, @CTA_TRANSF_IC, @CTR_TRANSF_IC, @RUBRO1_CTABANCO, @RUBRO2_CTABANCO, @RUBRO3_CTABANCO, @RUBRO4_CTABANCO, @RUBRO5_CTABANCO, @RUBRO6_CTABANCO, @RUBRO7_CTABANCO, @RUBRO8_CTABANCO, @RUBRO9_CTABANCO, @RUBRO10_CTABANCO
		SET @ERROR = 0
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS =
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<CUENTA_BANCARIA>' +
				'<CUENTA_BANCO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CUENTA_BANCO) + '</CUENTA_BANCO>' +
				'<NOMBRE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOMBRE) + '</NOMBRE>' +
				'<ENTIDAD_FINANCIERA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ENTIDAD_FINANCIERA) + '</ENTIDAD_FINANCIERA>' +
				'<MONEDA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@MONEDA) + '</MONEDA>' +
				'<DIRECCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DIRECCION) + '</DIRECCION>' +
				'<TELEFONO1 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TELEFONO1) + '</TELEFONO1>' +
				'<TELEFONO2 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TELEFONO2) + '</TELEFONO2>' +
				'<CONTACTO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CONTACTO) + '</CONTACTO>' +
				'<CARGO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CARGO) + '</CARGO>' +
				'<FORMATO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@FORMATO) + '</FORMATO>' +
				'<FECHA_ULT_MOV Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_ULT_MOV) + '</FECHA_ULT_MOV>' +
				'<SALDO Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@SALDO) + '</SALDO>' +
				'<SALDO_BANCOS Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@SALDO_BANCOS) + '</SALDO_BANCOS>' +
				'<POSICION_DE_CAJA Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@POSICION_DE_CAJA) + '</POSICION_DE_CAJA>' +
				'<SALDO_ANTERIOR Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@SALDO_ANTERIOR) + '</SALDO_ANTERIOR>' +
				'<TIPO_CAMBIO_LOCAL Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@TIPO_CAMBIO_LOCAL) + '</TIPO_CAMBIO_LOCAL>' +
				'<TIPO_CAMBIO_DOLAR Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@TIPO_CAMBIO_DOLAR) + '</TIPO_CAMBIO_DOLAR>' +
				'<ACTIVA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ACTIVA) + '</ACTIVA>' +
				'<ULTIMO_DEPOSITO Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@ULTIMO_DEPOSITO) + '</ULTIMO_DEPOSITO>' +
				'<ULTIMA_TEFCR Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@ULTIMA_TEFCR) + '</ULTIMA_TEFCR>' +
				'<LIMITE_SOBREGIRO Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@LIMITE_SOBREGIRO) + '</LIMITE_SOBREGIRO>' +
				'<CTR_CONTABLE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_CONTABLE) + '</CTR_CONTABLE>' +
				'<CTA_CONTABLE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_CONTABLE) + '</CTA_CONTABLE>' +
				'<CTR_CIERRE_DEB Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_CIERRE_DEB) + '</CTR_CIERRE_DEB>' +
				'<CTA_CIERRE_DEB Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_CIERRE_DEB) + '</CTA_CIERRE_DEB>' +
				'<CTR_CIERRE_CRED Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_CIERRE_CRED) + '</CTR_CIERRE_CRED>' +
				'<CTA_CIERRE_CRED Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_CIERRE_CRED) + '</CTA_CIERRE_CRED>' +
				'<ULTIMA_NOTACR Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@ULTIMA_NOTACR) + '</ULTIMA_NOTACR>' +
				'<ULTIMO_CHEQUE Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@ULTIMO_CHEQUE) + '</ULTIMO_CHEQUE>' +
				'<ULTIMO_OTROCR Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@ULTIMO_OTROCR) + '</ULTIMO_OTROCR>' +
				'<ULTIMA_TEFDB Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@ULTIMA_TEFDB) + '</ULTIMA_TEFDB>' +
				'<ULTIMA_NOTADB Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@ULTIMA_NOTADB) + '</ULTIMA_NOTADB>' +
				'<ULTIMO_OTRODB Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@ULTIMO_OTRODB) + '</ULTIMO_OTRODB>' +
				'<ULTIMA_CONCIL Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@ULTIMA_CONCIL) + '</ULTIMA_CONCIL>' +
				'<MODO_CONCILIAR Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@MODO_CONCILIAR) + '</MODO_CONCILIAR>' +
				'<IDIOMA_MON_LETRAS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@IDIOMA_MON_LETRAS) + '</IDIOMA_MON_LETRAS>' +
				'<TIPO_CRED_AJUSTE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_CRED_AJUSTE) + '</TIPO_CRED_AJUSTE>' +
				'<SUBTIPO_CRED_AJUST Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@SUBTIPO_CRED_AJUST) + '</SUBTIPO_CRED_AJUST>' +
				'<TIPO_DEB_AJUSTE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_DEB_AJUSTE) + '</TIPO_DEB_AJUSTE>' +
				'<SUBTIPO_DEB_AJUST Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@SUBTIPO_DEB_AJUST) + '</SUBTIPO_DEB_AJUST>' +
				'<PERMITE_SOBREGIRO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@PERMITE_SOBREGIRO) + '</PERMITE_SOBREGIRO>' +
				'<CTA_AJUSTE_CRED Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_AJUSTE_CRED) + '</CTA_AJUSTE_CRED>' +
				'<FCH_HORA_CREACION Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FCH_HORA_CREACION) + '</FCH_HORA_CREACION>' +
				'<USUARIO_CREACION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USUARIO_CREACION) + '</USUARIO_CREACION>' +
				'<CTR_AJUSTE_DEB Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_AJUSTE_DEB) + '</CTR_AJUSTE_DEB>' +
				'<CTR_GASTO_TRANSF Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_GASTO_TRANSF) + '</CTR_GASTO_TRANSF>' +
				'<CTA_AJUSTE_DEB Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_AJUSTE_DEB) + '</CTA_AJUSTE_DEB>' +
				'<CTA_GASTO_TRANSF Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_GASTO_TRANSF) + '</CTA_GASTO_TRANSF>' +
				'<CTR_LIQUIDAR_CRED Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_LIQUIDAR_CRED) + '</CTR_LIQUIDAR_CRED>' +
				'<CTA_LIQUIDAR_CRED Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_LIQUIDAR_CRED) + '</CTA_LIQUIDAR_CRED>' +
				'<CTR_LIQUIDAR_DEB Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_LIQUIDAR_DEB) + '</CTR_LIQUIDAR_DEB>' +
				'<CTA_LIQUIDAR_DEB Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_LIQUIDAR_DEB) + '</CTA_LIQUIDAR_DEB>' +
				'<CTR_AJUSTE_CRED Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_AJUSTE_CRED) + '</CTR_AJUSTE_CRED>' +
				'<FCH_HORA_MODIFIC Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FCH_HORA_MODIFIC) + '</FCH_HORA_MODIFIC>' +
				'<USUARIO_MODIFIC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USUARIO_MODIFIC) + '</USUARIO_MODIFIC>' +
				'<PERMITE_TRANSF_IC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@PERMITE_TRANSF_IC) + '</PERMITE_TRANSF_IC>' +
				'<CTA_TRANSF_IC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_TRANSF_IC) + '</CTA_TRANSF_IC>' +
				'<CTR_TRANSF_IC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_TRANSF_IC) + '</CTR_TRANSF_IC>' +
				'<RUBRO1_CTABANCO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@RUBRO1_CTABANCO) + '</RUBRO1_CTABANCO>' +
				'<RUBRO2_CTABANCO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@RUBRO2_CTABANCO) + '</RUBRO2_CTABANCO>' +
				'<RUBRO3_CTABANCO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@RUBRO3_CTABANCO) + '</RUBRO3_CTABANCO>' +
				'<RUBRO4_CTABANCO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@RUBRO4_CTABANCO) + '</RUBRO4_CTABANCO>' +
				'<RUBRO5_CTABANCO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@RUBRO5_CTABANCO) + '</RUBRO5_CTABANCO>' +
				'<RUBRO6_CTABANCO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@RUBRO6_CTABANCO) + '</RUBRO6_CTABANCO>' +
				'<RUBRO7_CTABANCO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@RUBRO7_CTABANCO) + '</RUBRO7_CTABANCO>' +
				'<RUBRO8_CTABANCO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@RUBRO8_CTABANCO) + '</RUBRO8_CTABANCO>' +
				'<RUBRO9_CTABANCO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@RUBRO9_CTABANCO) + '</RUBRO9_CTABANCO>' +
				'<RUBRO10_CTABANCO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@RUBRO10_CTABANCO) + '</RUBRO10_CTABANCO>' +
				'</CUENTA_BANCARIA>'
			-- Inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'CUENTABANCARIAPOS600', 'INSERTA', @PARAMETROS, 0, ''
			FETCH NEXT FROM C_INSERTED INTO
			@CUENTA_BANCO, @NOMBRE, @ENTIDAD_FINANCIERA, @MONEDA, @DIRECCION, @TELEFONO1, @TELEFONO2, @CONTACTO, @CARGO, @FORMATO, @FECHA_ULT_MOV, @SALDO, @SALDO_BANCOS, @POSICION_DE_CAJA, @SALDO_ANTERIOR, @TIPO_CAMBIO_LOCAL, @TIPO_CAMBIO_DOLAR, @ACTIVA, @ULTIMO_DEPOSITO, @ULTIMA_TEFCR, @LIMITE_SOBREGIRO, @CTR_CONTABLE, @CTA_CONTABLE, @CTR_CIERRE_DEB, @CTA_CIERRE_DEB, @CTR_CIERRE_CRED, @CTA_CIERRE_CRED, @ULTIMA_NOTACR, @ULTIMO_CHEQUE, @ULTIMO_OTROCR, @ULTIMA_TEFDB, @ULTIMA_NOTADB, @ULTIMO_OTRODB, @ULTIMA_CONCIL, @MODO_CONCILIAR, @IDIOMA_MON_LETRAS, @TIPO_CRED_AJUSTE, @SUBTIPO_CRED_AJUST, @TIPO_DEB_AJUSTE, @SUBTIPO_DEB_AJUST, @PERMITE_SOBREGIRO, @CTA_AJUSTE_CRED, @FCH_HORA_CREACION, @USUARIO_CREACION, @CTR_AJUSTE_DEB, @CTR_GASTO_TRANSF, @CTA_AJUSTE_DEB, @CTA_GASTO_TRANSF, @CTR_LIQUIDAR_CRED, @CTA_LIQUIDAR_CRED, @CTR_LIQUIDAR_DEB, @CTA_LIQUIDAR_DEB, @CTR_AJUSTE_CRED, @FCH_HORA_MODIFIC, @USUARIO_MODIFIC, @PERMITE_TRANSF_IC, @CTA_TRANSF_IC, @CTR_TRANSF_IC, @RUBRO1_CTABANCO, @RUBRO2_CTABANCO, @RUBRO3_CTABANCO, @RUBRO4_CTABANCO, @RUBRO5_CTABANCO, @RUBRO6_CTABANCO, @RUBRO7_CTABANCO, @RUBRO8_CTABANCO, @RUBRO9_CTABANCO, @RUBRO10_CTABANCO
		END
		CLOSE C_INSERTED
    		DEALLOCATE C_INSERTED
	END
	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla CUENTA_BANCARIA.',16,1 )
	END
END
;




CREATE TRIGGER $$Compania$$.CUENTA_BANCARIA_POS_DEL
ON $$Compania$$.CUENTA_BANCARIA
FOR DELETE
AS
BEGIN   	
                DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @CUENTA_BANCO VARCHAR(20)
	 -- Declaraciones	
	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_DELETED CURSOR LOCAL FOR
			SELECT CUENTA_BANCO
			FROM DELETED d
			WHERE 0 = (
				SELECT COUNT('n')
				FROM INSERTED i
				WHERE d.CUENTA_BANCO = i.CUENTA_BANCO
			   )
		OPEN C_DELETED
		FETCH NEXT FROM C_DELETED INTO
		@CUENTA_BANCO
		
		SET @ERROR = 0
		
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS =
								'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<CUENTA_BANCARIA>' +
				'<CUENTA_BANCO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CUENTA_BANCO) + '</CUENTA_BANCO>' +
				'</CUENTA_BANCARIA>'
 -- XML
			
			-- inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'CUENTABANCARIAPOS600', 'ELIMINA', @PARAMETROS, 0, ''
			
			FETCH NEXT FROM C_DELETED INTO
			@CUENTA_BANCO
		END
		CLOSE C_DELETED
		DEALLOCATE C_DELETED
	END
	
	IF (@@ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para eliminar de la tabla CUENTA_BANCARIA.',16,1 )
	END
END
;




CREATE TRIGGER $$Compania$$.CUENTA_BANCARIA_POS_MOD
ON $$Compania$$.CUENTA_BANCARIA
FOR UPDATE
AS
BEGIN   	
	DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @COL_ROWPOINTER VARCHAR(36)
	DECLARE @HAY_CAMPOS_PARA_POS BIT
	DECLARE @ACTUALIZAR_SOLICITUD BIT
	DECLARE @CUENTA_BANCO VARCHAR(20)
	DECLARE @NOMBRE VARCHAR(40)
	DECLARE @ENTIDAD_FINANCIERA VARCHAR(8)
	DECLARE @MONEDA VARCHAR(4)
	 -- Declaraciones
	SET @ERROR = 0
	SELECT @PUBLICADOR = SITIO_LOCAL, @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_MODIFIED CURSOR LOCAL FOR
			SELECT CUENTA_BANCO, NOMBRE, ENTIDAD_FINANCIERA, MONEDA -- Columnas
			FROM INSERTED I
		SET @ACTUALIZAR_SOLICITUD = 1
		OPEN C_MODIFIED
		FETCH NEXT FROM C_MODIFIED
		INTO @CUENTA_BANCO, @NOMBRE, @ENTIDAD_FINANCIERA, @MONEDA
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			IF ( NOT UPDATE(RECORDDATE) AND ( UPDATE(CUENTA_BANCO) OR UPDATE(NOMBRE) OR UPDATE(ENTIDAD_FINANCIERA) OR UPDATE(MONEDA)) )
			BEGIN
				SELECT @COL_ROWPOINTER = ROWPOINTER
				FROM $$Compania$$.CUENTA_BANCARIA
				WHERE CUENTA_BANCO = @CUENTA_BANCO
				SET @PARAMETROS =
					'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<CUENTA_BANCARIA>' +
				'<CUENTA_BANCO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CUENTA_BANCO) + '</CUENTA_BANCO>' +
				'<NOMBRE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOMBRE) + '</NOMBRE>' +
				'<ENTIDAD_FINANCIERA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ENTIDAD_FINANCIERA) + '</ENTIDAD_FINANCIERA>' +
				'<MONEDA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@MONEDA) + '</MONEDA>' +
				'</CUENTA_BANCARIA>'
				-- inserta la solicitud correspondiente
				EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'CUENTABANCARIAPOS600', 'MODIFICA', @PARAMETROS, @ACTUALIZAR_SOLICITUD, @COL_ROWPOINTER
			END
			FETCH NEXT FROM C_MODIFIED
			INTO @CUENTA_BANCO, @NOMBRE, @ENTIDAD_FINANCIERA, @MONEDA
		END
		CLOSE C_MODIFIED
		DEALLOCATE C_MODIFIED
	END
	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para modificar la tabla CUENTA_BANCARIA.',16,1 )
	END
END
;




CREATE TRIGGER $$Compania$$.DENOMINACION_POS_INS
ON $$Compania$$.DENOMINACION
FOR INSERT
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @TIPO VARCHAR(1)
	DECLARE @DENOM_MONTO DECIMAL(28,8)
	
	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_INSERTED CURSOR LOCAL FOR
		SELECT TIPO, DENOM_MONTO
		FROM INSERTED i
		WHERE 0 = (
				SELECT COUNT('n')
				FROM DELETED d
				WHERE i.TIPO = d.TIPO AND i.DENOM_MONTO = d.DENOM_MONTO
			   )
			
		OPEN C_INSERTED	
		FETCH NEXT FROM C_INSERTED INTO
		@TIPO, @DENOM_MONTO
		SET @ERROR = 0
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS =
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<DENOMINACION>' +
				'<TIPO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO) + '</TIPO>' +
				'<DENOM_MONTO Type="DECIMAL" PrimaryKey="True">' + ERPADMIN.POS_NumberToVarchar(@DENOM_MONTO) + '</DENOM_MONTO>' +
				'</DENOMINACION>'
			-- Inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'DENOMINACIONPOS600', 'INSERTA', @PARAMETROS, 0, ''
			FETCH NEXT FROM C_INSERTED INTO
			@TIPO, @DENOM_MONTO
		END
		CLOSE C_INSERTED
    		DEALLOCATE C_INSERTED
	END
	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla DENOMINACION.',16,1 )
	END
END
;




CREATE TRIGGER $$Compania$$.DENOMINACION_POS_DEL
ON $$Compania$$.DENOMINACION
FOR DELETE
AS
BEGIN   	
                DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @TIPO VARCHAR(1)
	DECLARE @DENOM_MONTO DECIMAL(28,8)
	 -- Declaraciones	
	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_DELETED CURSOR LOCAL FOR
			SELECT TIPO, DENOM_MONTO
			FROM DELETED d
			WHERE 0 = (
				SELECT COUNT('n')
				FROM INSERTED i
				WHERE d.TIPO = i.TIPO AND d.DENOM_MONTO = i.DENOM_MONTO
			   )
		OPEN C_DELETED
		FETCH NEXT FROM C_DELETED INTO
		@TIPO, @DENOM_MONTO -- VARIABLES
		
		SET @ERROR = 0
		
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS =
								'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<DENOMINACION>' +
				'<TIPO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO) + '</TIPO>' +
				'<DENOM_MONTO Type="DECIMAL" PrimaryKey="True">' + ERPADMIN.POS_NumberToVarchar(@DENOM_MONTO) + '</DENOM_MONTO>' +
				'</DENOMINACION>'
 -- XML
			
			-- inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'DENOMINACIONPOS600', 'ELIMINA', @PARAMETROS, 0, ''
			
			FETCH NEXT FROM C_DELETED INTO
			@TIPO, @DENOM_MONTO -- VARIABLES
		END
		CLOSE C_DELETED
		DEALLOCATE C_DELETED
	END
	
	IF (@@ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para eliminar de la tabla DENOMINACION.',16,1 )
	END
END
;




CREATE TRIGGER $$Compania$$.DENOMINACION_POS_MOD
ON $$Compania$$.DENOMINACION
FOR UPDATE
AS
BEGIN   	
	DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @COL_ROWPOINTER VARCHAR(36)
	DECLARE @HAY_CAMPOS_PARA_POS BIT
	DECLARE @ACTUALIZAR_SOLICITUD BIT
	DECLARE @TIPO VARCHAR(1)
	DECLARE @DENOM_MONTO DECIMAL(28,8)
	 -- Declaraciones
	SET @ERROR = 0
	SELECT @PUBLICADOR = SITIO_LOCAL, @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_MODIFIED CURSOR LOCAL FOR
			SELECT TIPO, DENOM_MONTO -- Columnas
			FROM INSERTED I
		SET @ACTUALIZAR_SOLICITUD = 1
		OPEN C_MODIFIED
		FETCH NEXT FROM C_MODIFIED
		INTO @TIPO, @DENOM_MONTO
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			IF ( NOT UPDATE(RECORDDATE) AND ( UPDATE(TIPO) OR UPDATE(DENOM_MONTO) ) )
			BEGIN
				SELECT @COL_ROWPOINTER = ROWPOINTER
				FROM $$Compania$$.DENOMINACION
				WHERE TIPO = @TIPO AND DENOM_MONTO = @DENOM_MONTO
				SET @PARAMETROS =
					'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<DENOMINACION>' +
				'<TIPO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO) + '</TIPO>' +
				'<DENOM_MONTO Type="DECIMAL" PrimaryKey="True">' + ERPADMIN.POS_NumberToVarchar(@DENOM_MONTO) + '</DENOM_MONTO>' +
				'</DENOMINACION>'
				-- inserta la solicitud correspondiente
				EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'DENOMINACIONPOS600', 'MODIFICA', @PARAMETROS, @ACTUALIZAR_SOLICITUD, @COL_ROWPOINTER
			END
			FETCH NEXT FROM C_MODIFIED
			INTO @TIPO, @DENOM_MONTO
		END
		CLOSE C_MODIFIED
		DEALLOCATE C_MODIFIED
	END
	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para modificar la tabla DENOMINACION.',16,1 )
	END
END
;




CREATE TRIGGER $$Compania$$.DEPOSITO_POS_POS_INS
ON $$Compania$$.DEPOSITO_POS
FOR INSERT
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @DEPOSITO INT
	DECLARE @TIENDA VARCHAR(6)
	DECLARE @CUENTA_BANCO VARCHAR(20)
	DECLARE @DOCUMENTO INT
	DECLARE @FECHA DATETIME
	DECLARE @MONTO DECIMAL(28,8)
	DECLARE @APROBADO VARCHAR(1)
	DECLARE @FECHA_HORA_CARGA DATETIME
	DECLARE @TIPO_SITIO_LOCAL VARCHAR(1)
	
	SELECT @PUBLICADOR = SITIO_LOCAL,
		@USUARIO_POS_WSQM = USUARIO_WSQM,
		@TIPO_SITIO_LOCAL = TIPO_SITIO_LOCAL
  	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM) AND @TIPO_SITIO_LOCAL = 'T'
	BEGIN
		DECLARE C_INSERTED CURSOR LOCAL FOR
		SELECT DEPOSITO, TIENDA, CUENTA_BANCO, DOCUMENTO, FECHA, MONTO, APROBADO, FECHA_HORA_CARGA
		FROM INSERTED i
		WHERE 0 = (
				SELECT COUNT('n')
				FROM DELETED d
				WHERE i.DEPOSITO = d.DEPOSITO
			   )
			
		OPEN C_INSERTED	
		FETCH NEXT FROM C_INSERTED INTO
		@DEPOSITO, @TIENDA, @CUENTA_BANCO, @DOCUMENTO, @FECHA, @MONTO, @APROBADO, @FECHA_HORA_CARGA
		SET @ERROR = 0
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS =
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<DEPOSITO_POS>' +
				'<DEPOSITO Type="INT" PrimaryKey="True">' + ERPADMIN.POS_NumberToVarchar(@DEPOSITO) + '</DEPOSITO>' +
				'<TIENDA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@TIENDA) + '</TIENDA>' +
				'<CUENTA_BANCO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CUENTA_BANCO) + '</CUENTA_BANCO>' +
				'<DOCUMENTO Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@DOCUMENTO) + '</DOCUMENTO>' +
				'<FECHA Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA) + '</FECHA>' +
				'<MONTO Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@MONTO) + '</MONTO>' +
				'<APROBADO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@APROBADO) + '</APROBADO>' +
				'<FECHA_HORA_CARGA Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_HORA_CARGA) + '</FECHA_HORA_CARGA>' +
				'</DEPOSITO_POS>'
			-- Inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'DEPOSITOPOSPOS600', 'INSERTA', @PARAMETROS, 0, ''
			FETCH NEXT FROM C_INSERTED INTO
			@DEPOSITO, @TIENDA, @CUENTA_BANCO, @DOCUMENTO, @FECHA, @MONTO, @APROBADO, @FECHA_HORA_CARGA
		END
		CLOSE C_INSERTED
    		DEALLOCATE C_INSERTED
	END
	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla DEPOSITO_POS.',16,1 )
	END
END
;




CREATE TRIGGER $$Compania$$.DEPOSITO_POS_POS_DEL
ON $$Compania$$.DEPOSITO_POS
FOR DELETE
AS
BEGIN   	
                DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @DEPOSITO INT
	DECLARE @TIENDA VARCHAR(6)
	 -- Declaraciones	
	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_DELETED CURSOR LOCAL FOR
			SELECT DEPOSITO, TIENDA
			FROM DELETED d
			WHERE 0 = (
				SELECT COUNT('n')
				FROM INSERTED i
				WHERE d.DEPOSITO = i.DEPOSITO
			   )
		OPEN C_DELETED
		FETCH NEXT FROM C_DELETED INTO
		@DEPOSITO, @TIENDA
		
		SET @ERROR = 0
		
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS =
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<DEPOSITO_POS>' +
				'<DEPOSITO Type="INT" PrimaryKey="True">' + ERPADMIN.POS_NumberToVarchar(@DEPOSITO) + '</DEPOSITO>' +
				'<TIENDA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@TIENDA) + '</TIENDA>' +
				'</DEPOSITO_POS>'
 -- XML
			
			-- inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'DEPOSITOPOSPOS600', 'ELIMINA', @PARAMETROS, 0, ''
			
			FETCH NEXT FROM C_DELETED INTO
			@DEPOSITO, @TIENDA
		END
		CLOSE C_DELETED
		DEALLOCATE C_DELETED
	END
	
	IF (@@ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para eliminar de la tabla DEPOSITO_POS.',16,1 )
	END
END
;




CREATE TRIGGER $$Compania$$.DEPOSITO_POS_POS_MOD
ON $$Compania$$.DEPOSITO_POS
FOR UPDATE
AS
BEGIN   	
	DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @COL_ROWPOINTER VARCHAR(36)
	DECLARE @HAY_CAMPOS_PARA_POS BIT
	DECLARE @ACTUALIZAR_SOLICITUD BIT
	DECLARE @DEPOSITO INT
	DECLARE @TIENDA VARCHAR(6)
	DECLARE @CUENTA_BANCO VARCHAR(20)
	DECLARE @DOCUMENTO INT
	DECLARE @FECHA DATETIME
	DECLARE @MONTO DECIMAL(28,8)
	DECLARE @APROBADO VARCHAR(1)
	DECLARE @FECHA_HORA_CARGA DATETIME
	 -- Declaraciones
	SET @ERROR = 0
	SELECT @PUBLICADOR = SITIO_LOCAL,
		@USUARIO_POS_WSQM = USUARIO_WSQM
  	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_MODIFIED CURSOR LOCAL FOR
			SELECT DEPOSITO, TIENDA, CUENTA_BANCO, DOCUMENTO, FECHA, MONTO, APROBADO, FECHA_HORA_CARGA -- Columnas
			FROM INSERTED I
		SET @ACTUALIZAR_SOLICITUD = 1
		OPEN C_MODIFIED
		FETCH NEXT FROM C_MODIFIED
		INTO @DEPOSITO, @TIENDA, @CUENTA_BANCO, @DOCUMENTO, @FECHA, @MONTO, @APROBADO, @FECHA_HORA_CARGA
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			IF ( NOT UPDATE(RECORDDATE) AND ( UPDATE(DEPOSITO) OR UPDATE(TIENDA) OR UPDATE(CUENTA_BANCO) OR UPDATE(DOCUMENTO) OR UPDATE(FECHA) OR UPDATE(MONTO) OR UPDATE(APROBADO) OR UPDATE(FECHA_HORA_CARGA) ) )
			BEGIN
				IF @APROBADO = 'S'
       				BEGIN
					SELECT @COL_ROWPOINTER = ROWPOINTER
					FROM $$Compania$$.DEPOSITO_POS
					WHERE DEPOSITO = @DEPOSITO
					SET @PARAMETROS =
					'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
					'<DEPOSITO_POS>' +
					'<DEPOSITO Type="INT" PrimaryKey="True">' + ERPADMIN.POS_NumberToVarchar(@DEPOSITO) + '</DEPOSITO>' +
					'<TIENDA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@TIENDA) + '</TIENDA>' +
					'<CUENTA_BANCO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CUENTA_BANCO) + '</CUENTA_BANCO>' +
					'<DOCUMENTO Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@DOCUMENTO) + '</DOCUMENTO>' +
					'<FECHA Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA) + '</FECHA>' +
					'<MONTO Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@MONTO) + '</MONTO>' +
					'<APROBADO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@APROBADO) + '</APROBADO>' +
					'<FECHA_HORA_CARGA Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_HORA_CARGA) + '</FECHA_HORA_CARGA>' +
					'</DEPOSITO_POS>'
					-- inserta la solicitud correspondiente
					EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'DEPOSITOPOSPOS600', 'MODIFICA', @PARAMETROS, @ACTUALIZAR_SOLICITUD, @COL_ROWPOINTER
				END
			END
			FETCH NEXT FROM C_MODIFIED
			INTO @DEPOSITO, @TIENDA, @CUENTA_BANCO, @DOCUMENTO, @FECHA, @MONTO, @APROBADO, @FECHA_HORA_CARGA
		END
		CLOSE C_MODIFIED
		DEALLOCATE C_MODIFIED
	END
	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para modificar la tabla DEPOSITO_POS.',16,1 )
	END
END
;




CREATE TRIGGER $$Compania$$.DIRECC_EMBARQUE_POS_INS
ON $$Compania$$.DIRECC_EMBARQUE
FOR INSERT
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @TIPO_SITIO_LOCAL VARCHAR(1)
	DECLARE @CLIENTE VARCHAR(20)
	DECLARE @DIRECCION VARCHAR(8)
	DECLARE @DETALLE_DIRECCION INT
	DECLARE @CONTACTO VARCHAR(30)
	DECLARE @CARGO VARCHAR(30)
	DECLARE @TELEFONO1 VARCHAR(15)
	DECLARE @TELEFONO2 VARCHAR(15)
	DECLARE @FAX VARCHAR(15)
	DECLARE @EMAIL VARCHAR(40)
	
	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM,
	       @TIPO_SITIO_LOCAL = TIPO_SITIO_LOCAL
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (SYSTEM_USER = @USUARIO_POS_WSQM AND @TIPO_SITIO_LOCAL = 'T')
	BEGIN
		DECLARE C_INSERTED CURSOR LOCAL FOR
		SELECT CLIENTE, DIRECCION, DETALLE_DIRECCION, CONTACTO, CARGO, TELEFONO1, TELEFONO2, FAX, EMAIL
		FROM INSERTED 
			
		OPEN C_INSERTED	
		FETCH NEXT FROM C_INSERTED INTO
		@CLIENTE, @DIRECCION, @DETALLE_DIRECCION, @CONTACTO, @CARGO, @TELEFONO1, @TELEFONO2, @FAX, @EMAIL
		SET @ERROR = 0
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS =
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<DIRECC_EMBARQUE>' +
				'<CLIENTE Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CLIENTE) + '</CLIENTE>' +
				'<DIRECCION Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@DIRECCION) + '</DIRECCION>' +
				'<DETALLE_DIRECCION Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@DETALLE_DIRECCION) + '</DETALLE_DIRECCION>' +
				'<CONTACTO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CONTACTO) + '</CONTACTO>' +
				'<CARGO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CARGO) + '</CARGO>' +
				'<TELEFONO1 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TELEFONO1) + '</TELEFONO1>' +
				'<TELEFONO2 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TELEFONO2) + '</TELEFONO2>' +
				'<FAX Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@FAX) + '</FAX>' +
				'<EMAIL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@EMAIL) + '</EMAIL>' +
				'</DIRECC_EMBARQUE>'
			-- Inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'DIRECCEMBARQUEPOS600', 'INSERTA', @PARAMETROS, 0, ''
			FETCH NEXT FROM C_INSERTED INTO
			@CLIENTE, @DIRECCION, @DETALLE_DIRECCION, @CONTACTO, @CARGO, @TELEFONO1, @TELEFONO2, @FAX, @EMAIL
		END
		CLOSE C_INSERTED
    		DEALLOCATE C_INSERTED
	END
	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla DIRECC_EMBARQUE.',16,1 )
	END
END;



CREATE TRIGGER $$Compania$$.DIRECC_EMBARQUE_POS_DEL
ON $$Compania$$.DIRECC_EMBARQUE
FOR DELETE
AS
BEGIN   	
        DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @TIPO_SITIO_LOCAL VARCHAR(1)
	DECLARE @CLIENTE VARCHAR(20)
	DECLARE @DIRECCION VARCHAR(8)
	
	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM,
	       @TIPO_SITIO_LOCAL = TIPO_SITIO_LOCAL
	FROM $$Compania$$.GLOBALES_POS
	
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (SYSTEM_USER = @USUARIO_POS_WSQM AND @TIPO_SITIO_LOCAL = 'T')
	BEGIN
		DECLARE C_DELETED CURSOR LOCAL FOR
			SELECT CLIENTE, DIRECCION
			FROM DELETED d
			
		OPEN C_DELETED
		FETCH NEXT FROM C_DELETED INTO
		@CLIENTE, @DIRECCION
		
		SET @ERROR = 0
		
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS =
								'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<DIRECC_EMBARQUE>' +
				'<CLIENTE Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CLIENTE) + '</CLIENTE>' +
				'<DIRECCION Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@DIRECCION) + '</DIRECCION>' +
				'</DIRECC_EMBARQUE>'
 -- XML
			
			-- inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'DIRECCEMBARQUEPOS600', 'ELIMINA', @PARAMETROS, 0, ''
			
			FETCH NEXT FROM C_DELETED INTO
			@CLIENTE, @DIRECCION
		END
		CLOSE C_DELETED
		DEALLOCATE C_DELETED
	END
	
	IF (@@ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para eliminar de la tabla DIRECC_EMBARQUE.',16,1 )
	END
END;



CREATE TRIGGER $$Compania$$.DIRECC_EMBARQUE_POS_MOD
ON $$Compania$$.DIRECC_EMBARQUE
FOR UPDATE
AS 
BEGIN   	
	DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @TIPO_SITIO_LOCAL VARCHAR(1)
	DECLARE @COL_ROWPOINTER VARCHAR(36)
	DECLARE @HAY_CAMPOS_PARA_POS BIT
	DECLARE @ACTUALIZAR_SOLICITUD BIT
	DECLARE @MODULO_OFFLINE INT
	DECLARE @CLIENTE VARCHAR(20)
	DECLARE @DIRECCION VARCHAR(8)
	DECLARE @DETALLE_DIRECCION INT
	DECLARE @CONTACTO VARCHAR(30)
	DECLARE @CARGO VARCHAR(30)
	DECLARE @TELEFONO1 VARCHAR(15)
	DECLARE @TELEFONO2 VARCHAR(15)
	DECLARE @FAX VARCHAR(15)
	DECLARE @EMAIL VARCHAR(40)
	 -- Declaraciones

	SET @ERROR = 0
	
	SELECT @MODULO_OFFLINE = COUNT(0)
	FROM ERPADMIN.MODULO_INSTALADO
	WHERE CONJUNTO = '$$Compania$$'
	AND ACCION = 3159

	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM,
	       @TIPO_SITIO_LOCAL = TIPO_SITIO_LOCAL
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF @MODULO_OFFLINE  = 1 AND NOT (SYSTEM_USER = @USUARIO_POS_WSQM AND @TIPO_SITIO_LOCAL = 'T')
	BEGIN
		DECLARE C_MODIFIED CURSOR LOCAL FOR
			SELECT CLIENTE, DIRECCION, DETALLE_DIRECCION, CONTACTO, CARGO, TELEFONO1, TELEFONO2, FAX, EMAIL -- Columnas
			FROM INSERTED I

		SET @ACTUALIZAR_SOLICITUD = 1

		OPEN C_MODIFIED

		FETCH NEXT FROM C_MODIFIED
		INTO @CLIENTE, @DIRECCION, @DETALLE_DIRECCION, @CONTACTO, @CARGO, @TELEFONO1, @TELEFONO2, @FAX, @EMAIL

		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			IF ( NOT UPDATE(RECORDDATE) AND ( UPDATE(CLIENTE) OR UPDATE(DIRECCION) OR UPDATE(DETALLE_DIRECCION) OR UPDATE(CONTACTO) OR UPDATE(CARGO) OR UPDATE(TELEFONO1) OR UPDATE(TELEFONO2) OR UPDATE(FAX) OR UPDATE(EMAIL) ) )
			BEGIN

				SELECT @COL_ROWPOINTER = ROWPOINTER 
				FROM $$Compania$$.DIRECC_EMBARQUE
				WHERE CLIENTE = @CLIENTE AND DIRECCION = @DIRECCION 

				SET @PARAMETROS =
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<DIRECC_EMBARQUE>' + 
				'<CLIENTE Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CLIENTE) + '</CLIENTE>' + 
				'<DIRECCION Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@DIRECCION) + '</DIRECCION>' + 
				'<DETALLE_DIRECCION Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@DETALLE_DIRECCION) + '</DETALLE_DIRECCION>' + 
				'<CONTACTO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CONTACTO) + '</CONTACTO>' + 
				'<CARGO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CARGO) + '</CARGO>' + 
				'<TELEFONO1 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TELEFONO1) + '</TELEFONO1>' + 
				'<TELEFONO2 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TELEFONO2) + '</TELEFONO2>' + 
				'<FAX Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@FAX) + '</FAX>' + 
				'<EMAIL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@EMAIL) + '</EMAIL>' + 
				'</DIRECC_EMBARQUE>'


				-- inserta la solicitud correspondiente
				EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'DIRECCEMBARQUEPOS600', 'MODIFICA', @PARAMETROS, @ACTUALIZAR_SOLICITUD, @COL_ROWPOINTER
			END

			FETCH NEXT FROM C_MODIFIED
			INTO @CLIENTE, @DIRECCION, @DETALLE_DIRECCION, @CONTACTO, @CARGO, @TELEFONO1, @TELEFONO2, @FAX, @EMAIL
		END

		CLOSE C_MODIFIED
		DEALLOCATE C_MODIFIED
	END

	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para modificar la tabla DIRECC_EMBARQUE.',16,1 )
	END
END;





CREATE TRIGGER $$Compania$$.DIVISION_GEOGRAFICA1_POS_INS
ON $$Compania$$.DIVISION_GEOGRAFICA1
FOR INSERT
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @MODULO_OFFLINE INT
	DECLARE @PAIS VARCHAR(4)
	DECLARE @DIVISION_GEOGRAFICA1 VARCHAR(12)
	DECLARE @NOMBRE VARCHAR(40)
	
	
	SELECT @MODULO_OFFLINE = COUNT(0)
	FROM ERPADMIN.MODULO_INSTALADO
	WHERE CONJUNTO = '$$Compania$$'
	AND ACCION = 3159

	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM 
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF @MODULO_OFFLINE  = 1 AND NOT (SYSTEM_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_INSERTED CURSOR LOCAL FOR
		SELECT PAIS, DIVISION_GEOGRAFICA1, NOMBRE
		FROM INSERTED
				
		OPEN C_INSERTED	
		FETCH NEXT FROM C_INSERTED INTO
		@PAIS, @DIVISION_GEOGRAFICA1, @NOMBRE

		SET @ERROR = 0
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS = 
			'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<DIVISION_GEOGRAFICA1>' + 
				'<PAIS Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@PAIS) + '</PAIS>' + 
				'<DIVISION_GEOGRAFICA1 Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@DIVISION_GEOGRAFICA1) + '</DIVISION_GEOGRAFICA1>' + 
				'<NOMBRE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOMBRE) + '</NOMBRE>' + 
				'</DIVISION_GEOGRAFICA1>'


			-- Inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'DIVISIONGEOGRAFICA1POS600', 'INSERTA', @PARAMETROS, 0, ''

			FETCH NEXT FROM C_INSERTED INTO
			@PAIS, @DIVISION_GEOGRAFICA1, @NOMBRE
		END

		CLOSE C_INSERTED
    		DEALLOCATE C_INSERTED
	END

	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla DIVISION_GEOGRAFICA1.',16,1 )
	END
END;







CREATE TRIGGER $$Compania$$.DIVISION_GEOGRAFICA1_POS_DEL
ON $$Compania$$.DIVISION_GEOGRAFICA1
FOR DELETE  
AS 
BEGIN   	
        DECLARE @ERROR  int
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @MODULO_OFFLINE INT
	DECLARE @PAIS VARCHAR(4)
	DECLARE @DIVISION_GEOGRAFICA1 VARCHAR(12)
	 -- Declaraciones	
	
	SELECT @MODULO_OFFLINE = COUNT(0)
	FROM ERPADMIN.MODULO_INSTALADO
	WHERE CONJUNTO = '$$Compania$$'
	AND ACCION = 3159

	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM 
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF @MODULO_OFFLINE  = 1 AND NOT (SYSTEM_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_DELETED CURSOR LOCAL FOR
			SELECT PAIS, DIVISION_GEOGRAFICA1
			FROM DELETED

		OPEN C_DELETED
		FETCH NEXT FROM C_DELETED INTO 
		@PAIS, @DIVISION_GEOGRAFICA1 -- VARIABLES
		
		SET @ERROR = 0
		
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS = 
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<DIVISION_GEOGRAFICA1>' + 
				'<PAIS Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@PAIS) + '</PAIS>' + 
				'<DIVISION_GEOGRAFICA1 Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@DIVISION_GEOGRAFICA1) + '</DIVISION_GEOGRAFICA1>' + 
				'</DIVISION_GEOGRAFICA1>'
 
			
			-- inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'DIVISIONGEOGRAFICA1POS600', 'ELIMINA', @PARAMETROS, 0, ''
			
			FETCH NEXT FROM C_DELETED INTO 
			@PAIS, @DIVISION_GEOGRAFICA1 -- VARIABLES
		END

		CLOSE C_DELETED
		DEALLOCATE C_DELETED
	END
	
	IF (@@ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para eliminar de la tabla DIVISION_GEOGRAFICA1.',16,1 )
	END
END;







CREATE TRIGGER $$Compania$$.DIVISION_GEOGRAFICA1_POS_MOD
ON $$Compania$$.DIVISION_GEOGRAFICA1
FOR UPDATE
AS 
BEGIN   	
	DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @COL_ROWPOINTER VARCHAR(36)
	DECLARE @HAY_CAMPOS_PARA_POS BIT
	DECLARE @ACTUALIZAR_SOLICITUD BIT
	DECLARE @MODULO_OFFLINE INT
	DECLARE @PAIS VARCHAR(4)
	DECLARE @DIVISION_GEOGRAFICA1 VARCHAR(12)
	DECLARE @NOMBRE VARCHAR(40)
	 -- Declaraciones

	SET @ERROR = 0
	
	SELECT @MODULO_OFFLINE = COUNT(0)
	FROM ERPADMIN.MODULO_INSTALADO
	WHERE CONJUNTO = '$$Compania$$'
	AND ACCION = 3159

	SELECT @PUBLICADOR = SITIO_LOCAL, @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF @MODULO_OFFLINE  = 1 AND NOT (SYSTEM_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_MODIFIED CURSOR LOCAL FOR
			SELECT PAIS, DIVISION_GEOGRAFICA1, NOMBRE -- Columnas
			FROM INSERTED I

		SET @ACTUALIZAR_SOLICITUD = 1

		OPEN C_MODIFIED

		FETCH NEXT FROM C_MODIFIED
		INTO @PAIS, @DIVISION_GEOGRAFICA1, @NOMBRE

		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			IF ( NOT UPDATE(RECORDDATE) AND ( UPDATE(PAIS) OR UPDATE(DIVISION_GEOGRAFICA1) OR UPDATE(NOMBRE) ) )
			BEGIN

				SELECT @COL_ROWPOINTER = ROWPOINTER 
				FROM $$Compania$$.DIVISION_GEOGRAFICA1
				WHERE PAIS = @PAIS AND DIVISION_GEOGRAFICA1 = @DIVISION_GEOGRAFICA1 

				SET @PARAMETROS =
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<DIVISION_GEOGRAFICA1>' + 
				'<PAIS Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@PAIS) + '</PAIS>' + 
				'<DIVISION_GEOGRAFICA1 Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@DIVISION_GEOGRAFICA1) + '</DIVISION_GEOGRAFICA1>' + 
				'<NOMBRE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOMBRE) + '</NOMBRE>' + 
				'</DIVISION_GEOGRAFICA1>'


				-- inserta la solicitud correspondiente
				EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'DIVISIONGEOGRAFICA1POS600', 'MODIFICA', @PARAMETROS, @ACTUALIZAR_SOLICITUD, @COL_ROWPOINTER
			END

			FETCH NEXT FROM C_MODIFIED
			INTO @PAIS, @DIVISION_GEOGRAFICA1, @NOMBRE
		END

		CLOSE C_MODIFIED
		DEALLOCATE C_MODIFIED
	END

	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para modificar la tabla DIVISION_GEOGRAFICA1.',16,1 )
	END
END;



CREATE TRIGGER $$Compania$$.DIVISION_GEOGRAFICA2_POS_INS
ON $$Compania$$.DIVISION_GEOGRAFICA2
FOR INSERT
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @MODULO_OFFLINE INT
	DECLARE @PAIS VARCHAR(4)
	DECLARE @DIVISION_GEOGRAFICA1 VARCHAR(12)
	DECLARE @DIVISION_GEOGRAFICA2 VARCHAR(12)
	DECLARE @NOMBRE VARCHAR(40)
	
	
	SELECT @MODULO_OFFLINE = COUNT(0)
	FROM ERPADMIN.MODULO_INSTALADO
	WHERE CONJUNTO = '$$Compania$$'
	AND ACCION = 3159

	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM 
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF @MODULO_OFFLINE  = 1 AND NOT (SYSTEM_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_INSERTED CURSOR LOCAL FOR
		SELECT PAIS, DIVISION_GEOGRAFICA1, DIVISION_GEOGRAFICA2, NOMBRE
		FROM INSERTED
				
		OPEN C_INSERTED	
		FETCH NEXT FROM C_INSERTED INTO
		@PAIS, @DIVISION_GEOGRAFICA1, @DIVISION_GEOGRAFICA2, @NOMBRE

		SET @ERROR = 0
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS = 
			'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<DIVISION_GEOGRAFICA2>' + 
				'<PAIS Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@PAIS) + '</PAIS>' + 
				'<DIVISION_GEOGRAFICA1 Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@DIVISION_GEOGRAFICA1) + '</DIVISION_GEOGRAFICA1>' + 
				'<DIVISION_GEOGRAFICA2 Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@DIVISION_GEOGRAFICA2) + '</DIVISION_GEOGRAFICA2>' + 
				'<NOMBRE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOMBRE) + '</NOMBRE>' + 
				'</DIVISION_GEOGRAFICA2>'


			-- Inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'DIVISIONGEOGRAFICA2POS600', 'INSERTA', @PARAMETROS, 0, ''

			FETCH NEXT FROM C_INSERTED INTO
			@PAIS, @DIVISION_GEOGRAFICA1, @DIVISION_GEOGRAFICA2, @NOMBRE
		END

		CLOSE C_INSERTED
    		DEALLOCATE C_INSERTED
	END

	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla DIVISION_GEOGRAFICA2.',16,1 )
	END
END;







CREATE TRIGGER $$Compania$$.DIVISION_GEOGRAFICA2_POS_DEL
ON $$Compania$$.DIVISION_GEOGRAFICA2
FOR DELETE  
AS 
BEGIN   	
        DECLARE @ERROR  int
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @MODULO_OFFLINE INT
	DECLARE @PAIS VARCHAR(4)
	DECLARE @DIVISION_GEOGRAFICA1 VARCHAR(12)
	DECLARE @DIVISION_GEOGRAFICA2 VARCHAR(12)
	 -- Declaraciones	
	
	SELECT @MODULO_OFFLINE = COUNT(0)
	FROM ERPADMIN.MODULO_INSTALADO
	WHERE CONJUNTO = '$$Compania$$'
	AND ACCION = 3159

	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM 
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF @MODULO_OFFLINE  = 1 AND NOT (SYSTEM_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_DELETED CURSOR LOCAL FOR
			SELECT PAIS, DIVISION_GEOGRAFICA1, DIVISION_GEOGRAFICA2
			FROM DELETED

		OPEN C_DELETED
		FETCH NEXT FROM C_DELETED INTO 
		@PAIS, @DIVISION_GEOGRAFICA1, @DIVISION_GEOGRAFICA2 -- VARIABLES
		
		SET @ERROR = 0
		
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS = 
							'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<DIVISION_GEOGRAFICA2>' + 
				'<PAIS Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@PAIS) + '</PAIS>' + 
				'<DIVISION_GEOGRAFICA1 Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@DIVISION_GEOGRAFICA1) + '</DIVISION_GEOGRAFICA1>' + 
				'<DIVISION_GEOGRAFICA2 Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@DIVISION_GEOGRAFICA2) + '</DIVISION_GEOGRAFICA2>' + 
				'</DIVISION_GEOGRAFICA2>'
 
			
			-- inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'DIVISIONGEOGRAFICA2POS600', 'ELIMINA', @PARAMETROS, 0, ''
			
			FETCH NEXT FROM C_DELETED INTO 
			@PAIS, @DIVISION_GEOGRAFICA1, @DIVISION_GEOGRAFICA2 -- VARIABLES
		END

		CLOSE C_DELETED
		DEALLOCATE C_DELETED
	END
	
	IF (@@ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para eliminar de la tabla DIVISION_GEOGRAFICA2.',16,1 )
	END
END;







CREATE TRIGGER $$Compania$$.DIVISION_GEOGRAFICA2_POS_MOD
ON $$Compania$$.DIVISION_GEOGRAFICA2
FOR UPDATE
AS 
BEGIN   	
	DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @COL_ROWPOINTER VARCHAR(36)
	DECLARE @HAY_CAMPOS_PARA_POS BIT
	DECLARE @ACTUALIZAR_SOLICITUD BIT
	DECLARE @MODULO_OFFLINE INT
	DECLARE @PAIS VARCHAR(4)
	DECLARE @DIVISION_GEOGRAFICA1 VARCHAR(12)
	DECLARE @DIVISION_GEOGRAFICA2 VARCHAR(12)
	DECLARE @NOMBRE VARCHAR(40)
	 -- Declaraciones

	SET @ERROR = 0
	
	SELECT @MODULO_OFFLINE = COUNT(0)
	FROM ERPADMIN.MODULO_INSTALADO
	WHERE CONJUNTO = '$$Compania$$'
	AND ACCION = 3159

	SELECT @PUBLICADOR = SITIO_LOCAL, @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF @MODULO_OFFLINE  = 1 AND NOT (SYSTEM_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_MODIFIED CURSOR LOCAL FOR
			SELECT PAIS, DIVISION_GEOGRAFICA1, DIVISION_GEOGRAFICA2, NOMBRE -- Columnas
			FROM INSERTED I

		SET @ACTUALIZAR_SOLICITUD = 1

		OPEN C_MODIFIED

		FETCH NEXT FROM C_MODIFIED
		INTO @PAIS, @DIVISION_GEOGRAFICA1, @DIVISION_GEOGRAFICA2, @NOMBRE

		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			IF ( NOT UPDATE(RECORDDATE) AND ( UPDATE(PAIS) OR UPDATE(DIVISION_GEOGRAFICA1) OR UPDATE(DIVISION_GEOGRAFICA2) OR UPDATE(NOMBRE) ) )
			BEGIN

				SELECT @COL_ROWPOINTER = ROWPOINTER 
				FROM $$Compania$$.DIVISION_GEOGRAFICA2
				WHERE PAIS = @PAIS AND DIVISION_GEOGRAFICA1 = @DIVISION_GEOGRAFICA1 AND DIVISION_GEOGRAFICA2 = @DIVISION_GEOGRAFICA2 

				SET @PARAMETROS =
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<DIVISION_GEOGRAFICA2>' + 
				'<PAIS Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@PAIS) + '</PAIS>' + 
				'<DIVISION_GEOGRAFICA1 Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@DIVISION_GEOGRAFICA1) + '</DIVISION_GEOGRAFICA1>' + 
				'<DIVISION_GEOGRAFICA2 Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@DIVISION_GEOGRAFICA2) + '</DIVISION_GEOGRAFICA2>' + 
				'<NOMBRE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOMBRE) + '</NOMBRE>' + 
				'</DIVISION_GEOGRAFICA2>'


				-- inserta la solicitud correspondiente
				EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'DIVISIONGEOGRAFICA2POS600', 'MODIFICA', @PARAMETROS, @ACTUALIZAR_SOLICITUD, @COL_ROWPOINTER
			END

			FETCH NEXT FROM C_MODIFIED
			INTO @PAIS, @DIVISION_GEOGRAFICA1, @DIVISION_GEOGRAFICA2, @NOMBRE
		END

		CLOSE C_MODIFIED
		DEALLOCATE C_MODIFIED
	END

	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para modificar la tabla DIVISION_GEOGRAFICA2.',16,1 )
	END
END;



CREATE TRIGGER $$Compania$$.DOC_POS_RETENCION_POS_INS	
ON $$Compania$$.DOC_POS_RETENCION
FOR INSERT
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @MODULO_OFFLINE INT
	DECLARE @DOCUMENTO VARCHAR(50)
	DECLARE @TIPO VARCHAR(1)
	DECLARE @CAJA VARCHAR(6)
	DECLARE @CODIGO_RETENCION VARCHAR(4)
	DECLARE @AUTORETENEDORA VARCHAR(1)
	DECLARE @MONTO DECIMAL(28,8)
	DECLARE @BASE DECIMAL(28,8)
	DECLARE @DOC_REFERENCIA VARCHAR(50)
	DECLARE @DOC_CXC_RETENCION 	VARCHAR(50)
	DECLARE @TIPO_DOC_RETENCION 	VARCHAR(3)

	
	
	SELECT @MODULO_OFFLINE = COUNT(0)
	FROM ERPADMIN.MODULO_INSTALADO
	WHERE CONJUNTO = '$$Compania$$'
	AND ACCION = 3159

	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM 
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF @MODULO_OFFLINE  = 1 AND NOT (SYSTEM_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_INSERTED CURSOR LOCAL FOR
		SELECT DOCUMENTO, TIPO, CAJA, CODIGO_RETENCION, AUTORETENEDORA, MONTO, BASE, DOC_REFERENCIA, DOC_CXC_RETENCION, TIPO_DOC_RETENCION 
		FROM INSERTED
				
		OPEN C_INSERTED	
		FETCH NEXT FROM C_INSERTED INTO
		@DOCUMENTO, @TIPO, @CAJA, @CODIGO_RETENCION, @AUTORETENEDORA, @MONTO, @BASE, @DOC_REFERENCIA, @DOC_CXC_RETENCION, @TIPO_DOC_RETENCION

		SET @ERROR = 0
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS = 
			'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<DOC_POS_RETENCION>' + 
				'<DOCUMENTO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@DOCUMENTO) + '</DOCUMENTO>' + 
				'<TIPO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO) + '</TIPO>' + 
				'<CAJA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CAJA) + '</CAJA>' + 
				'<CODIGO_RETENCION Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CODIGO_RETENCION) + '</CODIGO_RETENCION>' + 
				'<AUTORETENEDORA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@AUTORETENEDORA) + '</AUTORETENEDORA>' + 
				'<MONTO Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@MONTO) + '</MONTO>' + 
				'<BASE Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@BASE) + '</BASE>' + 
				'<DOC_REFERENCIA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DOC_REFERENCIA) + '</DOC_REFERENCIA>' + 
				'<DOC_CXC_RETENCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DOC_CXC_RETENCION) + '</DOC_CXC_RETENCION>' + 
				'<TIPO_DOC_RETENCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_DOC_RETENCION) + '</TIPO_DOC_RETENCION>' + 								
				'</DOC_POS_RETENCION>'


			-- Inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'DOCPOSRETENCIONPOS600', 'INSERTA', @PARAMETROS, 0, ''

			FETCH NEXT FROM C_INSERTED INTO
			@DOCUMENTO, @TIPO, @CAJA, @CODIGO_RETENCION, @AUTORETENEDORA, @MONTO, @BASE, @DOC_REFERENCIA, @DOC_CXC_RETENCION, @TIPO_DOC_RETENCION
		END

		CLOSE C_INSERTED
    		DEALLOCATE C_INSERTED
	END

	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla DOC_POS_RETENCION.',16,1 )
	END
END;


CREATE TRIGGER $$Compania$$.DOC_POS_RETENCION_POS_MOD
ON $$Compania$$.DOC_POS_RETENCION
FOR UPDATE
AS 
BEGIN   	
	DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @COL_ROWPOINTER VARCHAR(36)
	DECLARE @HAY_CAMPOS_PARA_POS BIT
	DECLARE @ACTUALIZAR_SOLICITUD BIT
	DECLARE @MODULO_OFFLINE INT
	DECLARE @DOCUMENTO VARCHAR(50)
	DECLARE @TIPO VARCHAR(1)
	DECLARE @CAJA VARCHAR(6)
	DECLARE @CODIGO_RETENCION VARCHAR(4)
	DECLARE @AUTORETENEDORA VARCHAR(1)
	DECLARE @MONTO DECIMAL(28,8)
	DECLARE @BASE DECIMAL(28,8)
	DECLARE @DOC_REFERENCIA VARCHAR(50)
	DECLARE @DOC_CXC_RETENCION 	VARCHAR(50)
	DECLARE @TIPO_DOC_RETENCION 	VARCHAR(3)

	 -- Declaraciones

	SET @ERROR = 0
	
	SELECT @MODULO_OFFLINE = COUNT(0)
	FROM ERPADMIN.MODULO_INSTALADO
	WHERE CONJUNTO = '$$Compania$$'
	AND ACCION = 3159

	SELECT @PUBLICADOR = SITIO_LOCAL, @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF @MODULO_OFFLINE  = 1 AND NOT (SYSTEM_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_MODIFIED CURSOR LOCAL FOR
			SELECT DOCUMENTO, TIPO, CAJA, CODIGO_RETENCION, AUTORETENEDORA, MONTO, BASE, DOC_REFERENCIA, DOC_CXC_RETENCION, TIPO_DOC_RETENCION -- Columnas
			FROM INSERTED I

		SET @ACTUALIZAR_SOLICITUD = 1

		OPEN C_MODIFIED

		FETCH NEXT FROM C_MODIFIED
		INTO @DOCUMENTO, @TIPO, @CAJA, @CODIGO_RETENCION, @AUTORETENEDORA, @MONTO, @BASE, @DOC_REFERENCIA, @DOC_CXC_RETENCION, @TIPO_DOC_RETENCION

		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			IF ( NOT UPDATE(RECORDDATE) AND ( UPDATE(DOCUMENTO) OR UPDATE(TIPO) OR UPDATE(CAJA) OR UPDATE(CODIGO_RETENCION) OR UPDATE(AUTORETENEDORA) OR UPDATE(MONTO) OR UPDATE(BASE) OR UPDATE(DOC_REFERENCIA) OR UPDATE(DOC_CXC_RETENCION) OR UPDATE(TIPO_DOC_RETENCION)) )
			BEGIN

				SELECT @COL_ROWPOINTER = ROWPOINTER 
				FROM $$Compania$$.DOC_POS_RETENCION
				WHERE DOCUMENTO = @DOCUMENTO AND TIPO = @TIPO AND CAJA = @CAJA AND CODIGO_RETENCION = @CODIGO_RETENCION 

				SET @PARAMETROS =
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<DOC_POS_RETENCION>' + 
				'<DOCUMENTO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@DOCUMENTO) + '</DOCUMENTO>' + 
				'<TIPO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO) + '</TIPO>' + 
				'<CAJA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CAJA) + '</CAJA>' + 
				'<CODIGO_RETENCION Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CODIGO_RETENCION) + '</CODIGO_RETENCION>' + 
				'<AUTORETENEDORA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@AUTORETENEDORA) + '</AUTORETENEDORA>' + 
				'<MONTO Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@MONTO) + '</MONTO>' + 
				'<BASE Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@BASE) + '</BASE>' + 
				'<DOC_REFERENCIA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DOC_REFERENCIA) + '</DOC_REFERENCIA>' + 
				'<DOC_CXC_RETENCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DOC_CXC_RETENCION) + '</DOC_CXC_RETENCION>' + 
				'<TIPO_DOC_RETENCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_DOC_RETENCION) + '</TIPO_DOC_RETENCION>' + 								
				'</DOC_POS_RETENCION>'


				-- inserta la solicitud correspondiente
				EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'DOCPOSRETENCIONPOS600', 'MODIFICA', @PARAMETROS, @ACTUALIZAR_SOLICITUD, @COL_ROWPOINTER
			END

			FETCH NEXT FROM C_MODIFIED
			INTO @DOCUMENTO, @TIPO, @CAJA, @CODIGO_RETENCION, @AUTORETENEDORA, @MONTO, @BASE, @DOC_REFERENCIA, @DOC_CXC_RETENCION, @TIPO_DOC_RETENCION
		END

		CLOSE C_MODIFIED
		DEALLOCATE C_MODIFIED
	END

	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para modificar la tabla DOC_POS_RETENCION.',16,1 )
	END
END;


CREATE TRIGGER $$Compania$$.DOC_POS_RETENCION_POS_DEL
ON $$Compania$$.DOC_POS_RETENCION
FOR DELETE  
AS 
BEGIN   	
        DECLARE @ERROR  int
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @MODULO_OFFLINE INT
	DECLARE @DOCUMENTO VARCHAR(50)
	DECLARE @TIPO VARCHAR(1)
	DECLARE @CAJA VARCHAR(6)
	DECLARE @CODIGO_RETENCION VARCHAR(4)
	 -- Declaraciones	
	
	SELECT @MODULO_OFFLINE = COUNT(0)
	FROM ERPADMIN.MODULO_INSTALADO
	WHERE CONJUNTO = '$$Compania$$'
	AND ACCION = 3159

	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM 
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF @MODULO_OFFLINE  = 1 AND NOT (SYSTEM_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_DELETED CURSOR LOCAL FOR
			SELECT DOCUMENTO, TIPO, CAJA, CODIGO_RETENCION
			FROM DELETED

		OPEN C_DELETED
		FETCH NEXT FROM C_DELETED INTO 
		@DOCUMENTO, @TIPO, @CAJA, @CODIGO_RETENCION -- VARIABLES
		
		SET @ERROR = 0
		
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS = 
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<DOC_POS_RETENCION>' + 
				'<DOCUMENTO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@DOCUMENTO) + '</DOCUMENTO>' + 
				'<TIPO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO) + '</TIPO>' + 
				'<CAJA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CAJA) + '</CAJA>' + 
				'<CODIGO_RETENCION Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CODIGO_RETENCION) + '</CODIGO_RETENCION>' + 
				'</DOC_POS_RETENCION>'
 
			
			-- inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'DOCPOSRETENCIONPOS600', 'ELIMINA', @PARAMETROS, 0, ''
			
			FETCH NEXT FROM C_DELETED INTO 
			@DOCUMENTO, @TIPO, @CAJA, @CODIGO_RETENCION -- VARIABLES
		END

		CLOSE C_DELETED
		DEALLOCATE C_DELETED
	END
	
	IF (@@ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para eliminar de la tabla DOC_POS_RETENCION.',16,1 )
	END
END;



CREATE TRIGGER $$Compania$$.EXCEP_CIUDAD_POS_INS
ON $$Compania$$.EXCEP_CIUDAD
FOR INSERT
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @MODULO_OFFLINE INT
	DECLARE @PAIS VARCHAR(4)
	DECLARE @DIVISION_GEOGRAFICA1 VARCHAR(12)
	DECLARE @DIVISION_GEOGRAFICA2 VARCHAR(12)
	DECLARE @CODIGO_RETENCION VARCHAR(4)
	DECLARE @PORCENTAJE DECIMAL(28,8)
	DECLARE @CENTRO_COSTO VARCHAR(25)
	DECLARE @CUENTA_CONTABLE VARCHAR(25)
	
	
	SELECT @MODULO_OFFLINE = COUNT(0)
	FROM ERPADMIN.MODULO_INSTALADO
	WHERE CONJUNTO = '$$Compania$$'
	AND ACCION = 3159

	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM 
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF @MODULO_OFFLINE  = 1 AND NOT (SYSTEM_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_INSERTED CURSOR LOCAL FOR
		SELECT PAIS, DIVISION_GEOGRAFICA1, DIVISION_GEOGRAFICA2, CODIGO_RETENCION, PORCENTAJE, CENTRO_COSTO, CUENTA_CONTABLE
		FROM INSERTED
				
		OPEN C_INSERTED	
		FETCH NEXT FROM C_INSERTED INTO
		@PAIS, @DIVISION_GEOGRAFICA1, @DIVISION_GEOGRAFICA2, @CODIGO_RETENCION, @PORCENTAJE, @CENTRO_COSTO, @CUENTA_CONTABLE

		SET @ERROR = 0
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS = 
			'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<EXCEP_CIUDAD>' + 
				'<PAIS Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@PAIS) + '</PAIS>' + 
				'<DIVISION_GEOGRAFICA1 Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@DIVISION_GEOGRAFICA1) + '</DIVISION_GEOGRAFICA1>' + 
				'<DIVISION_GEOGRAFICA2 Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@DIVISION_GEOGRAFICA2) + '</DIVISION_GEOGRAFICA2>' + 
				'<CODIGO_RETENCION Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CODIGO_RETENCION) + '</CODIGO_RETENCION>' + 
				'<PORCENTAJE Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@PORCENTAJE) + '</PORCENTAJE>' + 
				'<CENTRO_COSTO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CENTRO_COSTO) + '</CENTRO_COSTO>' + 
				'<CUENTA_CONTABLE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CUENTA_CONTABLE) + '</CUENTA_CONTABLE>' + 
				'</EXCEP_CIUDAD>'


			-- Inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'EXCEPCIUDADPOS600', 'INSERTA', @PARAMETROS, 0, ''

			FETCH NEXT FROM C_INSERTED INTO
			@PAIS, @DIVISION_GEOGRAFICA1, @DIVISION_GEOGRAFICA2, @CODIGO_RETENCION, @PORCENTAJE, @CENTRO_COSTO, @CUENTA_CONTABLE
		END

		CLOSE C_INSERTED
    		DEALLOCATE C_INSERTED
	END

	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla EXCEP_CIUDAD.',16,1 )
	END
END;





CREATE TRIGGER $$Compania$$.EXCEP_CIUDAD_POS_DEL
ON $$Compania$$.EXCEP_CIUDAD
FOR DELETE  
AS 
BEGIN   	
        DECLARE @ERROR  int
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @MODULO_OFFLINE INT
	DECLARE @PAIS VARCHAR(4)
	DECLARE @DIVISION_GEOGRAFICA1 VARCHAR(12)
	DECLARE @DIVISION_GEOGRAFICA2 VARCHAR(12)
	DECLARE @CODIGO_RETENCION VARCHAR(4)
	 -- Declaraciones	
	
	SELECT @MODULO_OFFLINE = COUNT(0)
	FROM ERPADMIN.MODULO_INSTALADO
	WHERE CONJUNTO = '$$Compania$$'
	AND ACCION = 3159

	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM 
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF @MODULO_OFFLINE  = 1 AND NOT (SYSTEM_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_DELETED CURSOR LOCAL FOR
			SELECT PAIS, DIVISION_GEOGRAFICA1, DIVISION_GEOGRAFICA2, CODIGO_RETENCION
			FROM DELETED

		OPEN C_DELETED
		FETCH NEXT FROM C_DELETED INTO 
		@PAIS, @DIVISION_GEOGRAFICA1, @DIVISION_GEOGRAFICA2, @CODIGO_RETENCION -- VARIABLES
		
		SET @ERROR = 0
		
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS = 
							'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<EXCEP_CIUDAD>' + 
				'<PAIS Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@PAIS) + '</PAIS>' + 
				'<DIVISION_GEOGRAFICA1 Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@DIVISION_GEOGRAFICA1) + '</DIVISION_GEOGRAFICA1>' + 
				'<DIVISION_GEOGRAFICA2 Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@DIVISION_GEOGRAFICA2) + '</DIVISION_GEOGRAFICA2>' + 
				'<CODIGO_RETENCION Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CODIGO_RETENCION) + '</CODIGO_RETENCION>' + 
				'</EXCEP_CIUDAD>'
 
			-- inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'EXCEPCIUDADPOS600', 'ELIMINA', @PARAMETROS, 0, ''
			
			FETCH NEXT FROM C_DELETED INTO 
			@PAIS, @DIVISION_GEOGRAFICA1, @DIVISION_GEOGRAFICA2, @CODIGO_RETENCION -- VARIABLES
		END
		CLOSE C_DELETED
		DEALLOCATE C_DELETED
	END
	IF (@@ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para eliminar de la tabla EXCEP_CIUDAD.',16,1 )
	END
END;






CREATE TRIGGER $$Compania$$.EXCEP_CIUDAD_POS_MOD
ON $$Compania$$.EXCEP_CIUDAD
FOR UPDATE
AS 
BEGIN   	
	DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @COL_ROWPOINTER VARCHAR(36)
	DECLARE @HAY_CAMPOS_PARA_POS BIT
	DECLARE @ACTUALIZAR_SOLICITUD BIT
	DECLARE @MODULO_OFFLINE INT
	DECLARE @PAIS VARCHAR(4)
	DECLARE @DIVISION_GEOGRAFICA1 VARCHAR(12)
	DECLARE @DIVISION_GEOGRAFICA2 VARCHAR(12)
	DECLARE @CODIGO_RETENCION VARCHAR(4)
	DECLARE @PORCENTAJE DECIMAL(28,8)
	DECLARE @CENTRO_COSTO VARCHAR(25)
	DECLARE @CUENTA_CONTABLE VARCHAR(25)
	 -- Declaraciones

	SET @ERROR = 0
	
	SELECT @MODULO_OFFLINE = COUNT(0)
	FROM ERPADMIN.MODULO_INSTALADO
	WHERE CONJUNTO = '$$Compania$$'
	AND ACCION = 3159

	SELECT @PUBLICADOR = SITIO_LOCAL, @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF @MODULO_OFFLINE  = 1 AND NOT (SYSTEM_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_MODIFIED CURSOR LOCAL FOR
			SELECT PAIS, DIVISION_GEOGRAFICA1, DIVISION_GEOGRAFICA2, CODIGO_RETENCION, PORCENTAJE, CENTRO_COSTO, CUENTA_CONTABLE -- Columnas
			FROM INSERTED I

		SET @ACTUALIZAR_SOLICITUD = 1
		OPEN C_MODIFIED
		FETCH NEXT FROM C_MODIFIED
		INTO @PAIS, @DIVISION_GEOGRAFICA1, @DIVISION_GEOGRAFICA2, @CODIGO_RETENCION, @PORCENTAJE, @CENTRO_COSTO, @CUENTA_CONTABLE

		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			IF ( NOT UPDATE(RECORDDATE) AND ( UPDATE(PAIS) OR UPDATE(DIVISION_GEOGRAFICA1) OR UPDATE(DIVISION_GEOGRAFICA2) OR UPDATE(CODIGO_RETENCION) OR UPDATE(PORCENTAJE) OR UPDATE(CENTRO_COSTO) OR UPDATE(CUENTA_CONTABLE) ) )
			BEGIN
				SELECT @COL_ROWPOINTER = ROWPOINTER 
				FROM $$Compania$$.EXCEP_CIUDAD
				WHERE PAIS = @PAIS AND DIVISION_GEOGRAFICA1 = @DIVISION_GEOGRAFICA1 AND DIVISION_GEOGRAFICA2 = @DIVISION_GEOGRAFICA2 AND CODIGO_RETENCION = @CODIGO_RETENCION 

				SET @PARAMETROS =
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<EXCEP_CIUDAD>' + 
				'<PAIS Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@PAIS) + '</PAIS>' + 
				'<DIVISION_GEOGRAFICA1 Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@DIVISION_GEOGRAFICA1) + '</DIVISION_GEOGRAFICA1>' + 
				'<DIVISION_GEOGRAFICA2 Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@DIVISION_GEOGRAFICA2) + '</DIVISION_GEOGRAFICA2>' + 
				'<CODIGO_RETENCION Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CODIGO_RETENCION) + '</CODIGO_RETENCION>' + 
				'<PORCENTAJE Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@PORCENTAJE) + '</PORCENTAJE>' + 
				'<CENTRO_COSTO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CENTRO_COSTO) + '</CENTRO_COSTO>' + 
				'<CUENTA_CONTABLE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CUENTA_CONTABLE) + '</CUENTA_CONTABLE>' + 
				'</EXCEP_CIUDAD>'

				-- inserta la solicitud correspondiente
				EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'EXCEPCIUDADPOS600', 'MODIFICA', @PARAMETROS, @ACTUALIZAR_SOLICITUD, @COL_ROWPOINTER
			END

			FETCH NEXT FROM C_MODIFIED
			INTO @PAIS, @DIVISION_GEOGRAFICA1, @DIVISION_GEOGRAFICA2, @CODIGO_RETENCION, @PORCENTAJE, @CENTRO_COSTO, @CUENTA_CONTABLE
		END
		CLOSE C_MODIFIED
		DEALLOCATE C_MODIFIED
	END
	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para modificar la tabla EXCEP_CIUDAD.',16,1 )
	END
END;



CREATE TRIGGER $$Compania$$.EXCEP_REGIMEN_POS_INS
ON $$Compania$$.EXCEP_REGIMEN
FOR INSERT
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @MODULO_OFFLINE INT
	DECLARE @CODIGO VARCHAR(12)
	DECLARE @CODIGO_RETENCION VARCHAR(4)
	DECLARE @PORCENTAJE DECIMAL(28,8)
	DECLARE @CENTRO_COSTO VARCHAR(25)
	DECLARE @CUENTA_CONTABLE VARCHAR(25)
	
	
	SELECT @MODULO_OFFLINE = COUNT(0)
	FROM ERPADMIN.MODULO_INSTALADO
	WHERE CONJUNTO = '$$Compania$$'
	AND ACCION = 3159

	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM 
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF @MODULO_OFFLINE  = 1 AND NOT (SYSTEM_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_INSERTED CURSOR LOCAL FOR
		SELECT CODIGO, CODIGO_RETENCION, PORCENTAJE, CENTRO_COSTO, CUENTA_CONTABLE
		FROM INSERTED
				
		OPEN C_INSERTED	
		FETCH NEXT FROM C_INSERTED INTO
		@CODIGO, @CODIGO_RETENCION, @PORCENTAJE, @CENTRO_COSTO, @CUENTA_CONTABLE

		SET @ERROR = 0
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS = 
			'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<EXCEP_REGIMEN>' + 
				'<CODIGO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CODIGO) + '</CODIGO>' + 
				'<CODIGO_RETENCION Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CODIGO_RETENCION) + '</CODIGO_RETENCION>' + 
				'<PORCENTAJE Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@PORCENTAJE) + '</PORCENTAJE>' + 
				'<CENTRO_COSTO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CENTRO_COSTO) + '</CENTRO_COSTO>' + 
				'<CUENTA_CONTABLE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CUENTA_CONTABLE) + '</CUENTA_CONTABLE>' + 
				'</EXCEP_REGIMEN>'


			-- Inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'EXCEPREGIMENPOS600', 'INSERTA', @PARAMETROS, 0, ''

			FETCH NEXT FROM C_INSERTED INTO
			@CODIGO, @CODIGO_RETENCION, @PORCENTAJE, @CENTRO_COSTO, @CUENTA_CONTABLE
		END

		CLOSE C_INSERTED
    		DEALLOCATE C_INSERTED
	END

	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla EXCEP_REGIMEN.',16,1 )
	END
END;







CREATE TRIGGER $$Compania$$.EXCEP_REGIMEN_POS_DEL
ON $$Compania$$.EXCEP_REGIMEN
FOR DELETE  
AS 
BEGIN   	
        DECLARE @ERROR  int
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @MODULO_OFFLINE INT
	DECLARE @CODIGO VARCHAR(12)
	DECLARE @CODIGO_RETENCION VARCHAR(4)
	 -- Declaraciones	
	
	SELECT @MODULO_OFFLINE = COUNT(0)
	FROM ERPADMIN.MODULO_INSTALADO
	WHERE CONJUNTO = '$$Compania$$'
	AND ACCION = 3159

	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM 
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF @MODULO_OFFLINE  = 1 AND NOT (SYSTEM_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_DELETED CURSOR LOCAL FOR
			SELECT CODIGO, CODIGO_RETENCION
			FROM DELETED

		OPEN C_DELETED
		FETCH NEXT FROM C_DELETED INTO 
		@CODIGO, @CODIGO_RETENCION -- VARIABLES
		
		SET @ERROR = 0
		
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS = 
							'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<EXCEP_REGIMEN>' + 
				'<CODIGO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CODIGO) + '</CODIGO>' + 
				'<CODIGO_RETENCION Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CODIGO_RETENCION) + '</CODIGO_RETENCION>' + 
				'</EXCEP_REGIMEN>'
 
			-- inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'EXCEPREGIMENPOS600', 'ELIMINA', @PARAMETROS, 0, ''
			
			FETCH NEXT FROM C_DELETED INTO 
			@CODIGO, @CODIGO_RETENCION -- VARIABLES
		END

		CLOSE C_DELETED
		DEALLOCATE C_DELETED
	END
	
	IF (@@ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para eliminar de la tabla EXCEP_REGIMEN.',16,1 )
	END
END;








CREATE TRIGGER $$Compania$$.EXCEP_REGIMEN_POS_MOD
ON $$Compania$$.EXCEP_REGIMEN
FOR UPDATE
AS 
BEGIN   	
	DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @COL_ROWPOINTER VARCHAR(36)
	DECLARE @HAY_CAMPOS_PARA_POS BIT
	DECLARE @ACTUALIZAR_SOLICITUD BIT
	DECLARE @MODULO_OFFLINE INT
	DECLARE @CODIGO VARCHAR(12)
	DECLARE @CODIGO_RETENCION VARCHAR(4)
	DECLARE @PORCENTAJE DECIMAL(28,8)
	DECLARE @CENTRO_COSTO VARCHAR(25)
	DECLARE @CUENTA_CONTABLE VARCHAR(25)
	 -- Declaraciones

	SET @ERROR = 0
	
	SELECT @MODULO_OFFLINE = COUNT(0)
	FROM ERPADMIN.MODULO_INSTALADO
	WHERE CONJUNTO = '$$Compania$$'
	AND ACCION = 3159

	SELECT @PUBLICADOR = SITIO_LOCAL, @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF @MODULO_OFFLINE  = 1 AND NOT (SYSTEM_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_MODIFIED CURSOR LOCAL FOR
			SELECT CODIGO, CODIGO_RETENCION, PORCENTAJE, CENTRO_COSTO, CUENTA_CONTABLE -- Columnas
			FROM INSERTED I

		SET @ACTUALIZAR_SOLICITUD = 1

		OPEN C_MODIFIED

		FETCH NEXT FROM C_MODIFIED
		INTO @CODIGO, @CODIGO_RETENCION, @PORCENTAJE, @CENTRO_COSTO, @CUENTA_CONTABLE

		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			IF ( NOT UPDATE(RECORDDATE) AND ( UPDATE(CODIGO) OR UPDATE(CODIGO_RETENCION) OR UPDATE(PORCENTAJE) OR UPDATE(CENTRO_COSTO) OR UPDATE(CUENTA_CONTABLE) ) )
			BEGIN

				SELECT @COL_ROWPOINTER = ROWPOINTER 
				FROM $$Compania$$.EXCEP_REGIMEN
				WHERE CODIGO = @CODIGO AND CODIGO_RETENCION = @CODIGO_RETENCION 

				SET @PARAMETROS =
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<EXCEP_REGIMEN>' + 
				'<CODIGO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CODIGO) + '</CODIGO>' + 
				'<CODIGO_RETENCION Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CODIGO_RETENCION) + '</CODIGO_RETENCION>' + 
				'<PORCENTAJE Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@PORCENTAJE) + '</PORCENTAJE>' + 
				'<CENTRO_COSTO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CENTRO_COSTO) + '</CENTRO_COSTO>' + 
				'<CUENTA_CONTABLE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CUENTA_CONTABLE) + '</CUENTA_CONTABLE>' + 
				'</EXCEP_REGIMEN>'

				-- inserta la solicitud correspondiente
				EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'EXCEPREGIMENPOS600', 'MODIFICA', @PARAMETROS, @ACTUALIZAR_SOLICITUD, @COL_ROWPOINTER
			END

			FETCH NEXT FROM C_MODIFIED
			INTO @CODIGO, @CODIGO_RETENCION, @PORCENTAJE, @CENTRO_COSTO, @CUENTA_CONTABLE
		END

		CLOSE C_MODIFIED
		DEALLOCATE C_MODIFIED
	END

	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para modificar la tabla EXCEP_REGIMEN.',16,1 )
	END
END;





CREATE TRIGGER $$Compania$$.MENSAJERO_POS_INS
ON $$Compania$$.MENSAJERO
FOR INSERT
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @MENSAJERO	VARCHAR(25)
    DECLARE @NOMBRE		VARCHAR(100)
    DECLARE @ROTATIVO		VARCHAR(1)
    DECLARE @TIENDA		VARCHAR(6)
	
	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_INSERTED CURSOR LOCAL FOR
		SELECT MENSAJERO, NOMBRE, ROTATIVO, TIENDA
		FROM INSERTED i
		WHERE 0 = (
				SELECT COUNT('n')
				FROM DELETED d
				WHERE i.MENSAJERO = d.MENSAJERO
			   )
			
		OPEN C_INSERTED	
		FETCH NEXT FROM C_INSERTED INTO
		@MENSAJERO, @NOMBRE, @ROTATIVO, @TIENDA
		SET @ERROR = 0
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS =
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<MENSAJERO>' +
				'<MENSAJERO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@MENSAJERO) + '</MENSAJERO>' +
				'<NOMBRE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOMBRE) + '</NOMBRE>' +
				'<ROTATIVO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ROTATIVO) + '</ROTATIVO>' +
				'<TIENDA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIENDA) + '</TIENDA>' +
				'</MENSAJERO>'
			-- Inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'MENSAJEROPOS600', 'INSERTA', @PARAMETROS, 0, ''
			FETCH NEXT FROM C_INSERTED INTO
			@MENSAJERO, @NOMBRE, @ROTATIVO, @TIENDA
		END
		CLOSE C_INSERTED
    		DEALLOCATE C_INSERTED
	END
	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla MENSAJERO.',16,1 )
	END
END
;




CREATE TRIGGER $$Compania$$.MENSAJERO_POS_DEL
ON $$Compania$$.MENSAJERO
FOR DELETE
AS
BEGIN   	
    DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @MENSAJERO VARCHAR(8)
	 -- Declaraciones	
	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_DELETED CURSOR LOCAL FOR
			SELECT MENSAJERO
			FROM DELETED d
			WHERE 0 = (
				SELECT COUNT('n')
				FROM INSERTED i
				WHERE d.MENSAJERO = i.MENSAJERO
			   )
		OPEN C_DELETED
		FETCH NEXT FROM C_DELETED INTO
		@MENSAJERO
		
		SET @ERROR = 0
		
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS =
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<MENSAJERO>' +
				'<MENSAJERO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@MENSAJERO) + '</MENSAJERO>' +
				'</MENSAJERO>'
 -- XML
			
			-- inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'MENSAJEROPOS600', 'ELIMINA', @PARAMETROS, 0, ''
			
			FETCH NEXT FROM C_DELETED INTO
			@MENSAJERO
		END
		CLOSE C_DELETED
		DEALLOCATE C_DELETED
	END
	
	IF (@@ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para eliminar de la tabla MENSAJERO.',16,1 )
	END
END
;




CREATE TRIGGER $$Compania$$.MENSAJERO_POS_MOD
ON $$Compania$$.MENSAJERO
FOR UPDATE
AS
BEGIN   	
	DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @COL_ROWPOINTER VARCHAR(36)
	DECLARE @HAY_CAMPOS_PARA_POS BIT
	DECLARE @ACTUALIZAR_SOLICITUD BIT
	DECLARE @MENSAJERO	VARCHAR(25)
    DECLARE @NOMBRE		VARCHAR(100)
    DECLARE @ROTATIVO		VARCHAR(1)
    DECLARE @TIENDA		VARCHAR(6)
	 -- Declaraciones
	SET @ERROR = 0
	SELECT @PUBLICADOR = SITIO_LOCAL, @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_MODIFIED CURSOR LOCAL FOR
			SELECT MENSAJERO, NOMBRE, ROTATIVO, TIENDA -- Columnas
			FROM INSERTED I
		SET @ACTUALIZAR_SOLICITUD = 1
		OPEN C_MODIFIED
		FETCH NEXT FROM C_MODIFIED
		INTO @MENSAJERO, @NOMBRE, @ROTATIVO, @TIENDA
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			IF ( NOT UPDATE(RECORDDATE) AND ( UPDATE(MENSAJERO) OR UPDATE(NOMBRE) OR UPDATE(ROTATIVO) OR UPDATE(TIENDA) ) )
			BEGIN
				SELECT @COL_ROWPOINTER = ROWPOINTER
				FROM $$Compania$$.MENSAJERO
				WHERE MENSAJERO = @MENSAJERO
				SET @PARAMETROS =
					'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<MENSAJERO>' +
				'<MENSAJERO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@MENSAJERO) + '</MENSAJERO>' +
				'<NOMBRE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOMBRE) + '</NOMBRE>' +
				'<ROTATIVO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ROTATIVO) + '</ROTATIVO>' +
				'<TIENDA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIENDA) + '</TIENDA>' +
				'</MENSAJERO>'
				-- inserta la solicitud correspondiente
				EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'MENSAJEROPOS600', 'MODIFICA', @PARAMETROS, @ACTUALIZAR_SOLICITUD, @COL_ROWPOINTER
			END
			FETCH NEXT FROM C_MODIFIED
			INTO @MENSAJERO, @NOMBRE, @ROTATIVO, @TIENDA
		END
		CLOSE C_MODIFIED
		DEALLOCATE C_MODIFIED
	END
	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para modificar la tabla MENSAJERO.',16,1 )
	END
END
;




CREATE TRIGGER $$Compania$$.MOTIVO_CANCEL_EXPR_POS_INS
ON $$Compania$$.MOTIVO_CANCEL_EXPR
FOR INSERT
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @CODIGO				VARCHAR(10)
	DECLARE	@DESCRIPCION		VARCHAR(80)
	
	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_INSERTED CURSOR LOCAL FOR
		SELECT CODIGO, DESCRIPCION
		FROM INSERTED i
		WHERE 0 = (
				SELECT COUNT('n')
				FROM DELETED d
				WHERE i.CODIGO = d.CODIGO
			   )
			
		OPEN C_INSERTED	
		FETCH NEXT FROM C_INSERTED INTO
		@CODIGO, @DESCRIPCION
		SET @ERROR = 0
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS =
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<MOTIVO_CANCEL_EXPR>' +
				'<CODIGO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CODIGO) + '</CODIGO>' +
				'<DESCRIPCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DESCRIPCION) + '</DESCRIPCION>' +
				'</MOTIVO_CANCEL_EXPR>'
			-- Inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'MOTIVOCANCELEXPRPOS600', 'INSERTA', @PARAMETROS, 0, ''
			FETCH NEXT FROM C_INSERTED INTO
			@CODIGO, @DESCRIPCION
		END
		CLOSE C_INSERTED
    		DEALLOCATE C_INSERTED
	END
	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla MOTIVO_CANCEL_EXPR.',16,1 )
	END
END
;




CREATE TRIGGER $$Compania$$.MOTIVO_CANCEL_EXPR_POS_DEL
ON $$Compania$$.MOTIVO_CANCEL_EXPR
FOR DELETE
AS
BEGIN   	
    DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @CODIGO			VARCHAR(10)
	 -- Declaraciones	
	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_DELETED CURSOR LOCAL FOR
			SELECT CODIGO
			FROM DELETED d
			WHERE 0 = (
				SELECT COUNT('n')
				FROM INSERTED i
				WHERE d.CODIGO = i.CODIGO
			   )
		OPEN C_DELETED
		FETCH NEXT FROM C_DELETED INTO
		@CODIGO
		
		SET @ERROR = 0
		
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS =
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<MOTIVO_CANCEL_EXPR>' +
				'<CODIGO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CODIGO) + '</CODIGO>' +
				'</MOTIVO_CANCEL_EXPR>'
 -- XML
			
			-- inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'MOTIVOCANCELEXPRPOS600', 'ELIMINA', @PARAMETROS, 0, ''
			
			FETCH NEXT FROM C_DELETED INTO
			@CODIGO
		END
		CLOSE C_DELETED
		DEALLOCATE C_DELETED
	END
	
	IF (@@ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para eliminar de la tabla MOTIVO_CANCEL_EXPR.',16,1 )
	END
END
;




CREATE TRIGGER $$Compania$$.MOTIVO_CANCEL_EXPR_POS_MOD
ON $$Compania$$.MOTIVO_CANCEL_EXPR
FOR UPDATE
AS
BEGIN   	
	DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @COL_ROWPOINTER VARCHAR(36)
	DECLARE @HAY_CAMPOS_PARA_POS BIT
	DECLARE @ACTUALIZAR_SOLICITUD BIT
	DECLARE @CODIGO				VARCHAR(10)
	DECLARE	@DESCRIPCION		VARCHAR(80)
	 -- Declaraciones
	SET @ERROR = 0
	SELECT @PUBLICADOR = SITIO_LOCAL, @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_MODIFIED CURSOR LOCAL FOR
			SELECT CODIGO, DESCRIPCION -- Columnas
			FROM INSERTED I
		SET @ACTUALIZAR_SOLICITUD = 1
		OPEN C_MODIFIED
		FETCH NEXT FROM C_MODIFIED
		INTO @CODIGO, @DESCRIPCION
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			IF ( NOT UPDATE(RECORDDATE) AND ( UPDATE(CODIGO) OR UPDATE(DESCRIPCION) ) )
			BEGIN
				SELECT @COL_ROWPOINTER = ROWPOINTER
				FROM $$Compania$$.MOTIVO_CANCEL_EXPR
				WHERE CODIGO = @CODIGO
				SET @PARAMETROS =
					'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<MOTIVO_CANCEL_EXPR>' +
				'<CODIGO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CODIGO) + '</CODIGO>' +
				'<DESCRIPCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DESCRIPCION) + '</DESCRIPCION>' +
				'</MOTIVO_CANCEL_EXPR>'
				-- inserta la solicitud correspondiente
				EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'MOTIVOCANCELEXPRPOS600', 'MODIFICA', @PARAMETROS, @ACTUALIZAR_SOLICITUD, @COL_ROWPOINTER
			END
			FETCH NEXT FROM C_MODIFIED
			INTO @CODIGO, @DESCRIPCION
		END
		CLOSE C_MODIFIED
		DEALLOCATE C_MODIFIED
	END
	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para modificar la tabla MOTIVO_CANCEL_EXPR.',16,1 )
	END
END
;




CREATE TRIGGER $$Compania$$.CLIENTE_EXPRESS_POS_INS
ON $$Compania$$.CLIENTE_EXPRESS
FOR INSERT
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @CLIENTE_EXP			VARCHAR(20)
	DECLARE @DIRECCION_ENTREGA      VARCHAR(1000)
	
	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_INSERTED CURSOR LOCAL FOR
		SELECT CLIENTE_EXP, DIRECCION_ENTREGA
		FROM INSERTED i
		WHERE 0 = (
				SELECT COUNT('n')
				FROM DELETED d
				WHERE i.CLIENTE_EXP = d.CLIENTE_EXP
			   )
			
		OPEN C_INSERTED	
		FETCH NEXT FROM C_INSERTED INTO
		@CLIENTE_EXP, @DIRECCION_ENTREGA
		SET @ERROR = 0
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS =
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<CLIENTE_EXPRESS>' +
				'<CLIENTE_EXP Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CLIENTE_EXP) + '</CLIENTE_EXP>' +
				'<DIRECCION_ENTREGA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DIRECCION_ENTREGA) + '</DIRECCION_ENTREGA>' +
				'</CLIENTE_EXPRESS>'
			-- Inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'CLIENTEEXPRESSPOS600', 'INSERTA', @PARAMETROS, 0, ''
			FETCH NEXT FROM C_INSERTED INTO
			@CLIENTE_EXP, @DIRECCION_ENTREGA
		END
		CLOSE C_INSERTED
    		DEALLOCATE C_INSERTED
	END
	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla CLIENTE_EXP.',16,1 )
	END
END
;




CREATE TRIGGER $$Compania$$.CLIENTE_EXPRESS_POS_DEL
ON $$Compania$$.CLIENTE_EXPRESS
FOR DELETE
AS
BEGIN   	
    DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @CLIENTE_EXP			VARCHAR(20)
	 -- Declaraciones	
	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_DELETED CURSOR LOCAL FOR
			SELECT CLIENTE_EXP
			FROM DELETED d
			WHERE 0 = (
				SELECT COUNT('n')
				FROM INSERTED i
				WHERE d.CLIENTE_EXP = i.CLIENTE_EXP
			   )
		OPEN C_DELETED
		FETCH NEXT FROM C_DELETED INTO
		@CLIENTE_EXP
		
		SET @ERROR = 0
		
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS =
								'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<CLIENTE_EXPRESS>' +
				'<CLIENTE_EXP Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CLIENTE_EXP) + '</CLIENTE_EXP>' +
				'</CLIENTE_EXPRESS>'
 -- XML
			
			-- inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'CLIENTEEXPRESSPOS600', 'ELIMINA', @PARAMETROS, 0, ''
			
			FETCH NEXT FROM C_DELETED INTO
			@CLIENTE_EXP
		END
		CLOSE C_DELETED
		DEALLOCATE C_DELETED
	END
	
	IF (@@ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para eliminar de la tabla CLIENTE_EXPRESS.',16,1 )
	END
END
;




CREATE TRIGGER $$Compania$$.CLIENTE_EXPRESS_POS_MOD
ON $$Compania$$.CLIENTE_EXPRESS
FOR UPDATE
AS
BEGIN   	
	DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @COL_ROWPOINTER VARCHAR(36)
	DECLARE @HAY_CAMPOS_PARA_POS BIT
	DECLARE @ACTUALIZAR_SOLICITUD BIT
	DECLARE @CLIENTE_EXP				VARCHAR(20)
	DECLARE	@DIRECCION_ENTREGA		VARCHAR(1000)
	 -- Declaraciones
	SET @ERROR = 0
	SELECT @PUBLICADOR = SITIO_LOCAL, @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_MODIFIED CURSOR LOCAL FOR
			SELECT CLIENTE_EXP, DIRECCION_ENTREGA -- Columnas
			FROM INSERTED I
		SET @ACTUALIZAR_SOLICITUD = 1
		OPEN C_MODIFIED
		FETCH NEXT FROM C_MODIFIED
		INTO @CLIENTE_EXP, @DIRECCION_ENTREGA
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			IF ( NOT UPDATE(RECORDDATE) AND ( UPDATE(CLIENTE_EXP) OR UPDATE(DIRECCION_ENTREGA) ) )
			BEGIN
				SELECT @COL_ROWPOINTER = ROWPOINTER
				FROM $$Compania$$.CLIENTE_EXPRESS
				WHERE CLIENTE_EXP = @CLIENTE_EXP
				SET @PARAMETROS =
					'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<CLIENTE_EXPRESS>' +
				'<CLIENTE_EXP Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CLIENTE_EXP) + '</CLIENTE_EXP>' +
				'<DIRECCION_ENTREGA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DIRECCION_ENTREGA) + '</DIRECCION_ENTREGA>' +
				'</CLIENTE_EXPRESS>'
				-- inserta la solicitud correspondiente
				EXECUTE @CLIENTE_EXP = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'CLIENTEEXPRESSPOS600', 'MODIFICA', @PARAMETROS, @ACTUALIZAR_SOLICITUD, @COL_ROWPOINTER
			END
			FETCH NEXT FROM C_MODIFIED
			INTO @CLIENTE_EXP, @DIRECCION_ENTREGA
		END
		CLOSE C_MODIFIED
		DEALLOCATE C_MODIFIED
	END
	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para modificar la tabla CLIENTE_EXPRESS.',16,1 )
	END
END
;


       

CREATE TRIGGER $$Compania$$.CLIENTE_EXPR_ENTR_POS_INS
ON $$Compania$$.CLIENTE_EXPR_ENTR
FOR INSERT
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @CLIENTE_EXP			VARCHAR(20)
	DECLARE @ENTREGAR_A      VARCHAR(80)
	
	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_INSERTED CURSOR LOCAL FOR
		SELECT CLIENTE_EXP, ENTREGAR_A
		FROM INSERTED i
		WHERE 0 = (
				SELECT COUNT('n')
				FROM DELETED d
				WHERE i.CLIENTE_EXP = d.CLIENTE_EXP AND i.ENTREGAR_A = d.ENTREGAR_A
			   )
			
		OPEN C_INSERTED	
		FETCH NEXT FROM C_INSERTED INTO
		@CLIENTE_EXP, @ENTREGAR_A
		SET @ERROR = 0
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS =
				'<CLIENTE_EXPR_ENTR>' +
				'<CLIENTE_EXP Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CLIENTE_EXP) + '</CLIENTE_EXP>' +
				'<ENTREGAR_A Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@ENTREGAR_A) + '</ENTREGAR_A>' +
				'</CLIENTE_EXPR_ENTR>'
			-- Inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'CLIENTEEXPRENTRPOS600', 'INSERTA', @PARAMETROS, 0, ''
			FETCH NEXT FROM C_INSERTED INTO
			@CLIENTE_EXP, @ENTREGAR_A
		END
		CLOSE C_INSERTED
    		DEALLOCATE C_INSERTED
	END
	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla CLIENTE_EXPR_ENTR.',16,1 )
	END
END
;



CREATE TRIGGER $$Compania$$.CLIENTE_EXPR_ENTR_POS_DEL
ON $$Compania$$.CLIENTE_EXPR_ENTR
FOR DELETE  
AS 
BEGIN   	
                DECLARE @ERROR  int
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @CLIENTE_EXP VARCHAR(20)
	DECLARE @ENTREGAR_A VARCHAR(80)
	 -- Declaraciones	

	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM 
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_DELETED CURSOR LOCAL FOR
			SELECT CLIENTE_EXP, ENTREGAR_A
			FROM DELETED d

		OPEN C_DELETED
		FETCH NEXT FROM C_DELETED INTO 
		@CLIENTE_EXP, @ENTREGAR_A -- VARIABLES
		
		SET @ERROR = 0
		
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS = 
								'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<CLIENTE_EXPR_ENTR>' + 
				'<CLIENTE_EXP Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CLIENTE_EXP) + '</CLIENTE_EXP>' + 
				'<ENTREGAR_A Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@ENTREGAR_A) + '</ENTREGAR_A>' + 
				'</CLIENTE_EXPR_ENTR>'
 
			
			-- inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'CLIENTEEXPRENTRPOS600', 'ELIMINA', @PARAMETROS, 0, ''
			
			FETCH NEXT FROM C_DELETED INTO 
			@CLIENTE_EXP, @ENTREGAR_A -- VARIABLES
		END

		CLOSE C_DELETED
		DEALLOCATE C_DELETED
	END
	
	IF (@@ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para eliminar de la tabla CLIENTE_EXPR_ENTR.',16,1 )
	END
END;






CREATE TRIGGER $$Compania$$.CLIENTE_EXPR_ENTR_POS_MOD
ON $$Compania$$.CLIENTE_EXPR_ENTR
FOR UPDATE
AS
BEGIN   	
	DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @COL_ROWPOINTER VARCHAR(36)
	DECLARE @HAY_CAMPOS_PARA_POS BIT
	DECLARE @ACTUALIZAR_SOLICITUD BIT
	DECLARE @CLIENTE_EXP				VARCHAR(20)
	DECLARE	@ENTREGAR_A		VARCHAR(80)
	 -- Declaraciones
	SET @ERROR = 0
	SELECT @PUBLICADOR = SITIO_LOCAL, @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_MODIFIED CURSOR LOCAL FOR
			SELECT CLIENTE_EXP, ENTREGAR_A -- Columnas
			FROM INSERTED I
		SET @ACTUALIZAR_SOLICITUD = 1
		OPEN C_MODIFIED
		FETCH NEXT FROM C_MODIFIED
		INTO @CLIENTE_EXP, @ENTREGAR_A
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			IF ( NOT UPDATE(RECORDDATE) AND ( UPDATE(CLIENTE_EXP) OR UPDATE(ENTREGAR_A) ) )
			BEGIN
				SELECT @COL_ROWPOINTER = ROWPOINTER
				FROM $$Compania$$.CLIENTE_EXPR_ENTR
				WHERE CLIENTE_EXP = @CLIENTE_EXP
				SET @PARAMETROS =
					'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<CLIENTE_EXPR_ENTR>' +
				'<CLIENTE_EXP Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CLIENTE_EXP) + '</CLIENTE_EXP>' +
				'<ENTREGAR_A Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@ENTREGAR_A) + '</ENTREGAR_A>' +
				'</CLIENTE_EXPR_ENTR>'
				-- inserta la solicitud correspondiente
				EXECUTE @CLIENTE_EXP = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'CLIENTEEXPRENTRPOS600', 'MODIFICA', @PARAMETROS, @ACTUALIZAR_SOLICITUD, @COL_ROWPOINTER
			END
			FETCH NEXT FROM C_MODIFIED
			INTO @CLIENTE_EXP, @ENTREGAR_A
		END
		CLOSE C_MODIFIED
		DEALLOCATE C_MODIFIED
	END
	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para modificar la tabla CLIENTE_EXPR_ENTR.',16,1 )
	END
END
;


CREATE TRIGGER $$Compania$$.CLIENTE_RETENCION_POS_INS
ON $$Compania$$.CLIENTE_RETENCION
FOR INSERT
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @MODULO_OFFLINE INT
	DECLARE @CLIENTE VARCHAR(20)
	DECLARE @CODIGO_RETENCION VARCHAR(4)
	
	
	SELECT @MODULO_OFFLINE = COUNT(0)
	FROM ERPADMIN.MODULO_INSTALADO
	WHERE CONJUNTO = '$$Compania$$'
	AND ACCION = 3159

	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM 
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF @MODULO_OFFLINE  = 1 AND NOT (SYSTEM_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_INSERTED CURSOR LOCAL FOR
		SELECT CLIENTE, CODIGO_RETENCION
		FROM INSERTED
				
		OPEN C_INSERTED	
		FETCH NEXT FROM C_INSERTED INTO
		@CLIENTE, @CODIGO_RETENCION

		SET @ERROR = 0
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS = 
			'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<CLIENTE_RETENCION>' + 
				'<CLIENTE Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CLIENTE) + '</CLIENTE>' + 
				'<CODIGO_RETENCION Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CODIGO_RETENCION) + '</CODIGO_RETENCION>' + 
				'</CLIENTE_RETENCION>'

			-- Inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'CLIENTERETENCIONPOS600', 'INSERTA', @PARAMETROS, 0, ''

			FETCH NEXT FROM C_INSERTED INTO
			@CLIENTE, @CODIGO_RETENCION
		END

		CLOSE C_INSERTED
    		DEALLOCATE C_INSERTED
	END

	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla CLIENTE_RETENCION.',16,1 )
	END
END;



CREATE TRIGGER $$Compania$$.CLIENTE_RETENCION_POS_DEL
ON $$Compania$$.CLIENTE_RETENCION
FOR DELETE  
AS 
BEGIN   	
        DECLARE @ERROR  int
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @MODULO_OFFLINE INT
	DECLARE @CLIENTE VARCHAR(20)
	DECLARE @CODIGO_RETENCION VARCHAR(4)
	 -- Declaraciones	
	
	SELECT @MODULO_OFFLINE = COUNT(0)
	FROM ERPADMIN.MODULO_INSTALADO
	WHERE CONJUNTO = '$$Compania$$'
	AND ACCION = 3159

	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM 
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF @MODULO_OFFLINE  = 1 AND NOT (SYSTEM_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_DELETED CURSOR LOCAL FOR
			SELECT CLIENTE, CODIGO_RETENCION
			FROM DELETED

		OPEN C_DELETED
		FETCH NEXT FROM C_DELETED INTO 
		@CLIENTE, @CODIGO_RETENCION -- VARIABLES
		
		SET @ERROR = 0
		
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS = 
							'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<CLIENTE_RETENCION>' + 
				'<CLIENTE Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CLIENTE) + '</CLIENTE>' + 
				'<CODIGO_RETENCION Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CODIGO_RETENCION) + '</CODIGO_RETENCION>' + 
				'</CLIENTE_RETENCION>'
 
			
			-- inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'CLIENTERETENCIONPOS600', 'ELIMINA', @PARAMETROS, 0, ''
			
			FETCH NEXT FROM C_DELETED INTO 
			@CLIENTE, @CODIGO_RETENCION -- VARIABLES
		END

		CLOSE C_DELETED
		DEALLOCATE C_DELETED
	END
	
	IF (@@ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para eliminar de la tabla CLIENTE_RETENCION.',16,1 )
	END
END;


CREATE TRIGGER $$Compania$$.CLIENTE_RETENCION_POS_MOD
ON $$Compania$$.CLIENTE_RETENCION
FOR UPDATE
AS 
BEGIN   	
	DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @COL_ROWPOINTER VARCHAR(36)
	DECLARE @HAY_CAMPOS_PARA_POS BIT
	DECLARE @ACTUALIZAR_SOLICITUD BIT
	DECLARE @MODULO_OFFLINE INT
	DECLARE @CLIENTE VARCHAR(20)
	DECLARE @CODIGO_RETENCION VARCHAR(4)
	 -- Declaraciones

	SET @ERROR = 0
	
	SELECT @MODULO_OFFLINE = COUNT(0)
	FROM ERPADMIN.MODULO_INSTALADO
	WHERE CONJUNTO = '$$Compania$$'
	AND ACCION = 3159

	SELECT @PUBLICADOR = SITIO_LOCAL, @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF @MODULO_OFFLINE  = 1 AND NOT (SYSTEM_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_MODIFIED CURSOR LOCAL FOR
			SELECT CLIENTE, CODIGO_RETENCION -- Columnas
			FROM INSERTED I

		SET @ACTUALIZAR_SOLICITUD = 1

		OPEN C_MODIFIED

		FETCH NEXT FROM C_MODIFIED
		INTO @CLIENTE, @CODIGO_RETENCION

		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			IF ( NOT UPDATE(RECORDDATE) AND ( UPDATE(CLIENTE) OR UPDATE(CODIGO_RETENCION) ) )
			BEGIN

				SELECT @COL_ROWPOINTER = ROWPOINTER 
				FROM $$Compania$$.CLIENTE_RETENCION
				WHERE CLIENTE = @CLIENTE AND CODIGO_RETENCION = @CODIGO_RETENCION 

				SET @PARAMETROS =
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<CLIENTE_RETENCION>' + 
				'<CLIENTE Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CLIENTE) + '</CLIENTE>' + 
				'<CODIGO_RETENCION Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CODIGO_RETENCION) + '</CODIGO_RETENCION>' + 
				'</CLIENTE_RETENCION>'

				-- inserta la solicitud correspondiente
				EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'CLIENTERETENCIONPOS600', 'MODIFICA', @PARAMETROS, @ACTUALIZAR_SOLICITUD, @COL_ROWPOINTER
			END

			FETCH NEXT FROM C_MODIFIED
			INTO @CLIENTE, @CODIGO_RETENCION
		END

		CLOSE C_MODIFIED
		DEALLOCATE C_MODIFIED
	END

	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para modificar la tabla CLIENTE_RETENCION.',16,1 )
	END
END;



CREATE TRIGGER $$Compania$$.DET_MOD_RETENCION_POS_INS
ON $$Compania$$.DET_MOD_RETENCION
FOR INSERT
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @MODULO_OFFLINE INT
	DECLARE @CODIGO_RETENCION VARCHAR(4)
	DECLARE @MODELO_RETENCION VARCHAR(4)
	DECLARE @APLICA VARCHAR(1)
	
	
	SELECT @MODULO_OFFLINE = COUNT(0)
	FROM ERPADMIN.MODULO_INSTALADO
	WHERE CONJUNTO = '$$Compania$$'
	AND ACCION = 3159

	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM 
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF @MODULO_OFFLINE  = 1 AND NOT (SYSTEM_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_INSERTED CURSOR LOCAL FOR
		SELECT CODIGO_RETENCION, MODELO_RETENCION, APLICA
		FROM INSERTED
				
		OPEN C_INSERTED	
		FETCH NEXT FROM C_INSERTED INTO
		@CODIGO_RETENCION, @MODELO_RETENCION, @APLICA

		SET @ERROR = 0
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS = 
			'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<DET_MOD_RETENCION>' + 
				'<CODIGO_RETENCION Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CODIGO_RETENCION) + '</CODIGO_RETENCION>' + 
				'<MODELO_RETENCION Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@MODELO_RETENCION) + '</MODELO_RETENCION>' + 
				'<APLICA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@APLICA) + '</APLICA>' + 
				'</DET_MOD_RETENCION>'


			-- Inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'DETMODRETENCIONPOS600', 'INSERTA', @PARAMETROS, 0, ''

			FETCH NEXT FROM C_INSERTED INTO
			@CODIGO_RETENCION, @MODELO_RETENCION, @APLICA
		END

		CLOSE C_INSERTED
    		DEALLOCATE C_INSERTED
	END

	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla DET_MOD_RETENCION.',16,1 )
	END
END;



CREATE TRIGGER $$Compania$$.DET_MOD_RETENCION_POS_DEL
ON $$Compania$$.DET_MOD_RETENCION
FOR DELETE  
AS 
BEGIN   	
        DECLARE @ERROR  int
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @MODULO_OFFLINE INT
	DECLARE @CODIGO_RETENCION VARCHAR(4)
	DECLARE @MODELO_RETENCION VARCHAR(4)
	 -- Declaraciones	
	
	SELECT @MODULO_OFFLINE = COUNT(0)
	FROM ERPADMIN.MODULO_INSTALADO
	WHERE CONJUNTO = '$$Compania$$'
	AND ACCION = 3159

	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM 
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF @MODULO_OFFLINE  = 1 AND NOT (SYSTEM_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_DELETED CURSOR LOCAL FOR
			SELECT CODIGO_RETENCION, MODELO_RETENCION
			FROM DELETED

		OPEN C_DELETED
		FETCH NEXT FROM C_DELETED INTO 
		@CODIGO_RETENCION, @MODELO_RETENCION -- VARIABLES
		
		SET @ERROR = 0
		
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS = 
							'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<DET_MOD_RETENCION>' + 
				'<CODIGO_RETENCION Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CODIGO_RETENCION) + '</CODIGO_RETENCION>' + 
				'<MODELO_RETENCION Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@MODELO_RETENCION) + '</MODELO_RETENCION>' + 
				'</DET_MOD_RETENCION>'
 
			
			-- inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'DETMODRETENCIONPOS600', 'ELIMINA', @PARAMETROS, 0, ''
			
			FETCH NEXT FROM C_DELETED INTO 
			@CODIGO_RETENCION, @MODELO_RETENCION -- VARIABLES
		END

		CLOSE C_DELETED
		DEALLOCATE C_DELETED
	END
	
	IF (@@ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para eliminar de la tabla DET_MOD_RETENCION.',16,1 )
	END
END;



CREATE TRIGGER $$Compania$$.DET_MOD_RETENCION_POS_MOD
ON $$Compania$$.DET_MOD_RETENCION
FOR UPDATE
AS 
BEGIN   	
	DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @COL_ROWPOINTER VARCHAR(36)
	DECLARE @HAY_CAMPOS_PARA_POS BIT
	DECLARE @ACTUALIZAR_SOLICITUD BIT
	DECLARE @MODULO_OFFLINE INT
	DECLARE @CODIGO_RETENCION VARCHAR(4)
	DECLARE @MODELO_RETENCION VARCHAR(4)
	DECLARE @APLICA VARCHAR(1)
	 -- Declaraciones

	SET @ERROR = 0
	
	SELECT @MODULO_OFFLINE = COUNT(0)
	FROM ERPADMIN.MODULO_INSTALADO
	WHERE CONJUNTO = '$$Compania$$'
	AND ACCION = 3159

	SELECT @PUBLICADOR = SITIO_LOCAL, @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF @MODULO_OFFLINE  = 1 AND NOT (SYSTEM_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_MODIFIED CURSOR LOCAL FOR
			SELECT CODIGO_RETENCION, MODELO_RETENCION, APLICA -- Columnas
			FROM INSERTED I

		SET @ACTUALIZAR_SOLICITUD = 1

		OPEN C_MODIFIED

		FETCH NEXT FROM C_MODIFIED
		INTO @CODIGO_RETENCION, @MODELO_RETENCION, @APLICA

		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			IF ( NOT UPDATE(RECORDDATE) AND ( UPDATE(CODIGO_RETENCION) OR UPDATE(MODELO_RETENCION) OR UPDATE(APLICA) ) )
			BEGIN

				SELECT @COL_ROWPOINTER = ROWPOINTER 
				FROM $$Compania$$.DET_MOD_RETENCION
				WHERE CODIGO_RETENCION = @CODIGO_RETENCION AND MODELO_RETENCION = @MODELO_RETENCION 

				SET @PARAMETROS =
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<DET_MOD_RETENCION>' + 
				'<CODIGO_RETENCION Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CODIGO_RETENCION) + '</CODIGO_RETENCION>' + 
				'<MODELO_RETENCION Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@MODELO_RETENCION) + '</MODELO_RETENCION>' + 
				'<APLICA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@APLICA) + '</APLICA>' + 
				'</DET_MOD_RETENCION>'

				-- inserta la solicitud correspondiente
				EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'DETMODRETENCIONPOS600', 'MODIFICA', @PARAMETROS, @ACTUALIZAR_SOLICITUD, @COL_ROWPOINTER
			END

			FETCH NEXT FROM C_MODIFIED
			INTO @CODIGO_RETENCION, @MODELO_RETENCION, @APLICA
		END

		CLOSE C_MODIFIED
		DEALLOCATE C_MODIFIED
	END

	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para modificar la tabla DET_MOD_RETENCION.',16,1 )
	END
END;



CREATE TRIGGER $$Compania$$.DET_REG_BILLETE_POS_INS
ON $$Compania$$.DET_REG_BILLETE
FOR INSERT
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @DOCUMENTO VARCHAR(20)
	DECLARE @CAJA VARCHAR(6)
	DECLARE @TIPO VARCHAR(1)
	DECLARE @PAGO VARCHAR(4)
	DECLARE @IDENTIFICACION VARCHAR(80)
	DECLARE @LINEA INT
	DECLARE @DENOMINACION VARCHAR(30)
	DECLARE @SERIE VARCHAR(100)
	

	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM 
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_INSERTED CURSOR LOCAL FOR
		SELECT DOCUMENTO, CAJA, TIPO, PAGO, IDENTIFICACION, LINEA, DENOMINACION, SERIE
		FROM INSERTED 
			
		OPEN C_INSERTED	
		FETCH NEXT FROM C_INSERTED INTO
		@DOCUMENTO, @CAJA, @TIPO, @PAGO, @IDENTIFICACION, @LINEA, @DENOMINACION, @SERIE

		SET @ERROR = 0
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS = 
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<DET_REG_BILLETE>' + 
				'<DOCUMENTO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@DOCUMENTO) + '</DOCUMENTO>' + 
				'<CAJA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CAJA) + '</CAJA>' + 
				'<TIPO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO) + '</TIPO>' + 
				'<PAGO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@PAGO) + '</PAGO>' + 
				'<IDENTIFICACION Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@IDENTIFICACION) + '</IDENTIFICACION>' + 
				'<LINEA Type="INT" PrimaryKey="True">' + ERPADMIN.POS_NumberToVarchar(@LINEA) + '</LINEA>' + 
				'<DENOMINACION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DENOMINACION) + '</DENOMINACION>' + 
				'<SERIE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@SERIE) + '</SERIE>' + 
				'</DET_REG_BILLETE>'


			-- Inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'DETREGBILLETEPOS600', 'INSERTA', @PARAMETROS, 0, ''

			FETCH NEXT FROM C_INSERTED INTO
			@DOCUMENTO, @CAJA, @TIPO, @PAGO, @IDENTIFICACION, @LINEA, @DENOMINACION, @SERIE
		END

		CLOSE C_INSERTED
    		DEALLOCATE C_INSERTED
	END

	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla DET_REG_BILLETE.',16,1 )
	END
END;


CREATE TRIGGER $$Compania$$.DET_REG_BILLETE_POS_MOD
ON $$Compania$$.DET_REG_BILLETE
FOR UPDATE
AS 
BEGIN   	
	DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @COL_ROWPOINTER VARCHAR(36)
	DECLARE @HAY_CAMPOS_PARA_POS BIT
	DECLARE @ACTUALIZAR_SOLICITUD BIT
	DECLARE @DOCUMENTO VARCHAR(20)
	DECLARE @CAJA VARCHAR(6)
	DECLARE @TIPO VARCHAR(1)
	DECLARE @PAGO VARCHAR(4)
	DECLARE @IDENTIFICACION VARCHAR(80)
	DECLARE @LINEA INT
	DECLARE @DENOMINACION VARCHAR(30)
	DECLARE @SERIE VARCHAR(100)
	 -- Declaraciones

	SET @ERROR = 0

	SELECT @PUBLICADOR = SITIO_LOCAL, @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_MODIFIED CURSOR LOCAL FOR
			SELECT DOCUMENTO, CAJA, TIPO, PAGO, IDENTIFICACION, LINEA, DENOMINACION, SERIE -- Columnas
			FROM INSERTED I

		SET @ACTUALIZAR_SOLICITUD = 1

		OPEN C_MODIFIED

		FETCH NEXT FROM C_MODIFIED
		INTO @DOCUMENTO, @CAJA, @TIPO, @PAGO, @IDENTIFICACION, @LINEA, @DENOMINACION, @SERIE

		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			IF ( NOT UPDATE(RECORDDATE) AND ( UPDATE(DOCUMENTO) OR UPDATE(CAJA) OR UPDATE(TIPO) OR UPDATE(PAGO) OR UPDATE(IDENTIFICACION) OR UPDATE(LINEA) OR UPDATE(DENOMINACION) OR UPDATE(SERIE) ) )
			BEGIN

				SELECT @COL_ROWPOINTER = ROWPOINTER 
				FROM $$Compania$$.DET_REG_BILLETE
				WHERE DOCUMENTO = @DOCUMENTO AND CAJA = @CAJA AND TIPO = @TIPO AND PAGO = @PAGO AND IDENTIFICACION = @IDENTIFICACION AND LINEA = @LINEA 

				SET @PARAMETROS =
					'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<DET_REG_BILLETE>' + 
				'<DOCUMENTO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@DOCUMENTO) + '</DOCUMENTO>' + 
				'<CAJA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CAJA) + '</CAJA>' + 
				'<TIPO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO) + '</TIPO>' + 
				'<PAGO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@PAGO) + '</PAGO>' + 
				'<IDENTIFICACION Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@IDENTIFICACION) + '</IDENTIFICACION>' + 
				'<LINEA Type="INT" PrimaryKey="True">' + ERPADMIN.POS_NumberToVarchar(@LINEA) + '</LINEA>' + 
				'<DENOMINACION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DENOMINACION) + '</DENOMINACION>' + 
				'<SERIE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@SERIE) + '</SERIE>' + 
				'</DET_REG_BILLETE>'


				-- inserta la solicitud correspondiente
				EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'DETREGBILLETEPOS600', 'MODIFICA', @PARAMETROS, @ACTUALIZAR_SOLICITUD, @COL_ROWPOINTER
			END

			FETCH NEXT FROM C_MODIFIED
			INTO @DOCUMENTO, @CAJA, @TIPO, @PAGO, @IDENTIFICACION, @LINEA, @DENOMINACION, @SERIE
		END

		CLOSE C_MODIFIED
		DEALLOCATE C_MODIFIED
	END

	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para modificar la tabla DET_REG_BILLETE.',16,1 )
	END
END;


CREATE TRIGGER $$Compania$$.DET_REG_BILLETE_POS_DEL
ON $$Compania$$.DET_REG_BILLETE
FOR DELETE  
AS 
BEGIN   	
                DECLARE @ERROR  int
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @DOCUMENTO VARCHAR(20)
	DECLARE @CAJA VARCHAR(6)
	DECLARE @TIPO VARCHAR(1)
	DECLARE @PAGO VARCHAR(4)
	DECLARE @IDENTIFICACION VARCHAR(80)
	DECLARE @LINEA INT

	 -- Declaraciones	

	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM 
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_DELETED CURSOR LOCAL FOR
			SELECT DOCUMENTO, CAJA, TIPO, PAGO, IDENTIFICACION, LINEA
			FROM DELETED d
			WHERE 0 = (
				SELECT COUNT('n')
				FROM INSERTED i
				WHERE d.DOCUMENTO = i.DOCUMENTO AND d.CAJA = i.CAJA AND d.TIPO = i.TIPO AND d.PAGO = i.PAGO AND d.IDENTIFICACION = i.IDENTIFICACION AND d.LINEA = i.LINEA
			   )

		OPEN C_DELETED
		FETCH NEXT FROM C_DELETED INTO 
		@DOCUMENTO, @CAJA, @TIPO, @PAGO, @IDENTIFICACION, @LINEA-- VARIABLES
		
		SET @ERROR = 0
		
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS = 
								'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<DET_REG_BILLETE>' + 
				'<DOCUMENTO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@DOCUMENTO) + '</DOCUMENTO>' + 
				'<CAJA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CAJA) + '</CAJA>' + 
				'<TIPO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO) + '</TIPO>' + 
				'<PAGO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@PAGO) + '</PAGO>' + 
				'<IDENTIFICACION Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@IDENTIFICACION) + '</IDENTIFICACION>' + 
				'<LINEA Type="INT" PrimaryKey="True">' + ERPADMIN.POS_NumberToVarchar(@LINEA) + '</LINEA>' + 
				'</DET_REG_BILLETE>'
 
			
			-- inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'DETREGBILLETEPOS600', 'ELIMINA', @PARAMETROS, 0, ''
			
			FETCH NEXT FROM C_DELETED INTO 
			@DOCUMENTO, @CAJA, @TIPO, @PAGO, @IDENTIFICACION, @LINEA -- VARIABLES
		END

		CLOSE C_DELETED
		DEALLOCATE C_DELETED
	END
	
	IF (@@ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para eliminar de la tabla DET_REG_BILLETE.',16,1 )
	END
END;







CREATE TRIGGER $$Compania$$.DOCUMENTO_POS_POS_INS
ON $$Compania$$.DOCUMENTO_POS
FOR INSERT
AS
BEGIN
	DECLARE @ERROR				INT
	DECLARE @PUBLICADOR			VARCHAR(20)
	DECLARE @PARAMETROS			VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM	VARCHAR(100)
	DECLARE @TIPO_SITIO_LOCAL	VARCHAR(1)
	DECLARE @DOCUMENTO			VARCHAR(50)
	DECLARE @CAJA				VARCHAR(6)
	DECLARE @TIPO				VARCHAR(1)
	DECLARE @PERFIL				VARCHAR(4)
	DECLARE @VENDEDOR			VARCHAR(4)
	DECLARE @CLIENTE			VARCHAR(20)
	DECLARE @NOMBRE_CLIENTE		VARCHAR(80)
	DECLARE @CAJERO				VARCHAR(25)
	DECLARE @CAJA_COBRO			VARCHAR(6)
	DECLARE @IMPUESTO1			DECIMAL(28,8)
	DECLARE @IMPUESTO2			DECIMAL(28,8)
	DECLARE @DESCUENTO			DECIMAL(28,8)
	DECLARE @TOTAL_PAGAR		DECIMAL(28,8)
	DECLARE @TOTAL				DECIMAL(28,8)
	DECLARE @FCH_HORA_CREACION	DATETIME
	DECLARE @FCH_HORA_COBRO		DATETIME
	DECLARE @FCH_HORA_ANULA		DATETIME
	DECLARE @EXPORTADO			VARCHAR(1)
	DECLARE @ESTADO_COBRO		VARCHAR(1)
	DECLARE @SALDO				DECIMAL(28,8)
	DECLARE @FECHA_VENCE		DATETIME
	DECLARE @LISTO_INVENTARIO	VARCHAR(1)
	DECLARE @NIVEL_PRECIO		VARCHAR(12)
	DECLARE @MONEDA_NIVEL		VARCHAR(1)
	DECLARE @VERSION 			INT
	DECLARE @FECHANAC_CLIENTE	DATETIME
	DECLARE @TELEFONO_CLIENTE	VARCHAR(15)
	DECLARE @NIT_CLIENTE		VARCHAR(20)
	DECLARE @PAIS				VARCHAR(4)
	DECLARE @CLASE_DOCUMENTO	VARCHAR(1)
	DECLARE @CONDICION_PAGO_APA	VARCHAR(4)
	DECLARE @DOC_CC				VARCHAR(50)
	DECLARE @TIPO_DOC_CC		VARCHAR(3)
	DECLARE @CARGADO_CC			VARCHAR(1)
	DECLARE @CARGADO_CG			VARCHAR(1)
	DECLARE @DEVUELVE_DINERO	VARCHAR(1)
	DECLARE @DOC_CC_ANUL		VARCHAR(50)
	DECLARE @TIPO_DOC_CC_ANUL	VARCHAR(3)
	DECLARE @GENERO_FACTURA_INICIO	VARCHAR(1)
	DECLARE @AFECTA_CONTABIL	VARCHAR(1)
	DECLARE @EFECTIVO_DEVUELTO	DECIMAL(28,8)
	DECLARE @TIPO_CAMBIO		DECIMAL(28,8)
	DECLARE @BENEFICIARIO		VARCHAR(254)
	DECLARE @MONEDA				VARCHAR(1)
	DECLARE @SUBTIPO			VARCHAR(1)
	DECLARE @ID_BENEFICIARIO	VARCHAR(20)
	DECLARE @USUARIO_ULT_IMPRE	VARCHAR(25)
	DECLARE @FCH_HORA_ULT_IMPRE	DATETIME
	DECLARE @USUARIO_APLICACION	VARCHAR(25)
	DECLARE @FCH_HORA_APLICACIO	DATETIME
	DECLARE @USUARIO_ANULACION	VARCHAR(25)
	DECLARE @ESTADO_IMPRESION	VARCHAR(1)
	DECLARE @TELEFONO_BENEFICIA	VARCHAR(15)
	DECLARE @SALDO_REPORTE		DECIMAL(28,8)
	DECLARE @MONEDA_DOC			VARCHAR(1)
	DECLARE @NCF				VARCHAR(20)
	DECLARE @TIPO_NCF			VARCHAR(6)
	DECLARE @NUM_CIERRE			VARCHAR(20)
	DECLARE @DIRECCION			VARCHAR(4000)
	DECLARE @CORRELATIVO		VARCHAR(10)
	DECLARE @RECIBIDO_DE		VARCHAR(80)
	DECLARE @RESOLUCION			VARCHAR(20)
	DECLARE @COD_CLASE_DOC		VARCHAR(10)
	DECLARE @DOC_EXPRESS 		VARCHAR(1)
	DECLARE @MENSAJERO 			VARCHAR(10)
	DECLARE @CLIENTE_EXPRESS 	VARCHAR(20)
	DECLARE @ENTREGA_EXPRSS_A 	VARCHAR(80)
	DECLARE @ESTADO_EXPRESS 	VARCHAR(1)
	DECLARE @MONTO_ENTREGADO 	DECIMAL (28,8)
	DECLARE @MONTO_DEVUELTO 	DECIMAL (28,8)
	DECLARE @FCH_ENVIO 			DATETIME
	DECLARE @FCH_ENTREGA 		DATETIME
	DECLARE @MOTIV_CANCELA_EXPR 	VARCHAR(10)
	DECLARE @NOTA_EXPRESS 		VARCHAR(1000)
	DECLARE @BASE_IMPUESTO1		DECIMAL(28,8)
	DECLARE @BASE_IMPUESTO2		DECIMAL(28,8) 
	DECLARE @NOTAS 				VARCHAR(4000)
	DECLARE @DOC_FISCAL 		VARCHAR(50)
	DECLARE @PREFIJO 			VARCHAR(20)
	DECLARE @PEDIDO_AUTORIZADO 	VARCHAR(50)
	DECLARE @DOC_CC_ANTICIPO 	VARCHAR(50)
	DECLARE @NOMBREMAQUINA		VARCHAR(20)
	
	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM ,
		@TIPO_SITIO_LOCAL = TIPO_SITIO_LOCAL
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM) AND @TIPO_SITIO_LOCAL = 'T'
	BEGIN
		DECLARE C_INSERTED CURSOR LOCAL FOR
		SELECT DOCUMENTO, CAJA, TIPO, PERFIL, VENDEDOR, CLIENTE, NOMBRE_CLIENTE, CAJERO, CAJA_COBRO, IMPUESTO1, IMPUESTO2, DESCUENTO, TOTAL_PAGAR, TOTAL, FCH_HORA_CREACION, FCH_HORA_COBRO, FCH_HORA_ANULA, EXPORTADO, ESTADO_COBRO, SALDO, FECHA_VENCE, LISTO_INVENTARIO, NIVEL_PRECIO, MONEDA_NIVEL, VERSION, FECHANAC_CLIENTE, TELEFONO_CLIENTE, NIT_CLIENTE, PAIS, CLASE_DOCUMENTO, CONDICION_PAGO_APA, DOC_CC, TIPO_DOC_CC, CARGADO_CC, CARGADO_CG, DEVUELVE_DINERO, DOC_CC_ANUL, TIPO_DOC_CC_ANUL, GENERO_FACTURA_INICIO, AFECTA_CONTABIL, EFECTIVO_DEVUELTO, TIPO_CAMBIO, BENEFICIARIO, MONEDA, SUBTIPO, ID_BENEFICIARIO, USUARIO_ULT_IMPRE, FCH_HORA_ULT_IMPRE, USUARIO_APLICACION, FCH_HORA_APLICACIO, USUARIO_ANULACION, ESTADO_IMPRESION, TELEFONO_BENEFICIA,SALDO_REPORTE, MONEDA_DOC, NCF, TIPO_NCF, NUM_CIERRE, DIRECCION, CORRELATIVO, RECIBIDO_DE, RESOLUCION, COD_CLASE_DOC, DOC_EXPRESS, MENSAJERO, CLIENTE_EXPRESS, ENTREGA_EXPRSS_A, ESTADO_EXPRESS, MONTO_ENTREGADO, MONTO_DEVUELTO, FCH_ENVIO, FCH_ENTREGA, MOTIV_CANCELA_EXPR, NOTA_EXPRESS, BASE_IMPUESTO1, BASE_IMPUESTO2,DOC_FISCAL, PREFIJO, PEDIDO_AUTORIZADO, DOC_CC_ANTICIPO, NOMBREMAQUINA
		FROM INSERTED i
		WHERE 0 = (
				SELECT COUNT('n')
				FROM DELETED d
				WHERE i.DOCUMENTO = d.DOCUMENTO AND i.CAJA = d.CAJA AND i.TIPO = d.TIPO
			   )
			
		OPEN C_INSERTED	
		FETCH NEXT FROM C_INSERTED INTO
		@DOCUMENTO, @CAJA, @TIPO, @PERFIL, @VENDEDOR, @CLIENTE, @NOMBRE_CLIENTE, @CAJERO, @CAJA_COBRO, @IMPUESTO1, @IMPUESTO2, @DESCUENTO, @TOTAL_PAGAR, @TOTAL, @FCH_HORA_CREACION, @FCH_HORA_COBRO, @FCH_HORA_ANULA, @EXPORTADO, @ESTADO_COBRO, @SALDO, @FECHA_VENCE, @LISTO_INVENTARIO, @NIVEL_PRECIO, @MONEDA_NIVEL, @VERSION, @FECHANAC_CLIENTE, @TELEFONO_CLIENTE, @NIT_CLIENTE, @PAIS, @CLASE_DOCUMENTO, @CONDICION_PAGO_APA, @DOC_CC, @TIPO_DOC_CC, @CARGADO_CC, @CARGADO_CG, @DEVUELVE_DINERO, @DOC_CC_ANUL, @TIPO_DOC_CC_ANUL, @GENERO_FACTURA_INICIO, @AFECTA_CONTABIL, @EFECTIVO_DEVUELTO, @TIPO_CAMBIO, @BENEFICIARIO, @MONEDA, @SUBTIPO, @ID_BENEFICIARIO, @USUARIO_ULT_IMPRE, @FCH_HORA_ULT_IMPRE, @USUARIO_APLICACION, @FCH_HORA_APLICACIO, @USUARIO_ANULACION, @ESTADO_IMPRESION, @TELEFONO_BENEFICIA,@SALDO_REPORTE,@MONEDA_DOC, @NCF, @TIPO_NCF, @NUM_CIERRE, @DIRECCION, @CORRELATIVO, @RECIBIDO_DE, @RESOLUCION, @COD_CLASE_DOC, @DOC_EXPRESS, @MENSAJERO, @CLIENTE_EXPRESS, @ENTREGA_EXPRSS_A, @ESTADO_EXPRESS, @MONTO_ENTREGADO, @MONTO_DEVUELTO, @FCH_ENVIO, @FCH_ENTREGA, @MOTIV_CANCELA_EXPR, @NOTA_EXPRESS, @BASE_IMPUESTO1, @BASE_IMPUESTO2, @DOC_FISCAL, @PREFIJO, @PEDIDO_AUTORIZADO, @DOC_CC_ANTICIPO, @NOMBREMAQUINA
		SET @ERROR = 0
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
		    SELECT @NOTAS = CONVERT(VARCHAR(4000),NOTAS )
		    FROM $$Compania$$.DOCUMENTO_POS 
		    WHERE DOCUMENTO = @DOCUMENTO AND CAJA = @CAJA AND TIPO = @TIPO
			
			SET @PARAMETROS = 
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<DOCUMENTO_POS>' + 
				'<DOCUMENTO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@DOCUMENTO) + '</DOCUMENTO>' + 
				'<CAJA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CAJA) + '</CAJA>' + 
				'<TIPO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO) + '</TIPO>' + 
				'<PERFIL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@PERFIL) + '</PERFIL>' + 
				'<VENDEDOR Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@VENDEDOR) + '</VENDEDOR>' + 
				'<CLIENTE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CLIENTE) + '</CLIENTE>' + 
				'<NOMBRE_CLIENTE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOMBRE_CLIENTE) + '</NOMBRE_CLIENTE>' + 
				'<CAJERO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CAJERO) + '</CAJERO>' + 
				'<CAJA_COBRO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CAJA_COBRO) + '</CAJA_COBRO>' + 
				'<IMPUESTO1 Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@IMPUESTO1) + '</IMPUESTO1>' + 
				'<IMPUESTO2 Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@IMPUESTO2) + '</IMPUESTO2>' + 
				'<DESCUENTO Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@DESCUENTO) + '</DESCUENTO>' + 
				'<TOTAL_PAGAR Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@TOTAL_PAGAR) + '</TOTAL_PAGAR>' + 
				'<TOTAL Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@TOTAL) + '</TOTAL>' + 
				'<FCH_HORA_CREACION Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FCH_HORA_CREACION) + '</FCH_HORA_CREACION>' + 
				'<FCH_HORA_COBRO Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FCH_HORA_COBRO) + '</FCH_HORA_COBRO>' + 
				'<FCH_HORA_ANULA Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FCH_HORA_ANULA) + '</FCH_HORA_ANULA>' + 
				'<EXPORTADO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@EXPORTADO) + '</EXPORTADO>' + 
				'<ESTADO_COBRO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ESTADO_COBRO) + '</ESTADO_COBRO>' + 
				'<SALDO Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@SALDO) + '</SALDO>' + 
				'<FECHA_VENCE Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_VENCE) + '</FECHA_VENCE>' + 
				'<LISTO_INVENTARIO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@LISTO_INVENTARIO) + '</LISTO_INVENTARIO>' + 
				'<NIVEL_PRECIO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NIVEL_PRECIO) + '</NIVEL_PRECIO>' + 
				'<MONEDA_NIVEL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@MONEDA_NIVEL) + '</MONEDA_NIVEL>' + 
				'<VERSION Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@VERSION) + '</VERSION>' + 
				'<FECHANAC_CLIENTE Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHANAC_CLIENTE) + '</FECHANAC_CLIENTE>' + 
				'<TELEFONO_CLIENTE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TELEFONO_CLIENTE) + '</TELEFONO_CLIENTE>' + 
				'<NIT_CLIENTE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NIT_CLIENTE) + '</NIT_CLIENTE>' + 
				'<NOTAS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOTAS) + '</NOTAS>' + 
				'<PAIS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@PAIS) + '</PAIS>' + 
				'<CLASE_DOCUMENTO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CLASE_DOCUMENTO) + '</CLASE_DOCUMENTO>' + 
				'<CONDICION_PAGO_APA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CONDICION_PAGO_APA) + '</CONDICION_PAGO_APA>' + 
				'<DOC_CC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DOC_CC) + '</DOC_CC>' + 
				'<TIPO_DOC_CC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_DOC_CC) + '</TIPO_DOC_CC>' + 
				'<CARGADO_CC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CARGADO_CC) + '</CARGADO_CC>' + 
				'<CARGADO_CG Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CARGADO_CG) + '</CARGADO_CG>' + 
				'<DEVUELVE_DINERO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DEVUELVE_DINERO) + '</DEVUELVE_DINERO>' + 
				'<DIRECCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DIRECCION) + '</DIRECCION>' + 
				'<DOC_CC_ANUL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DOC_CC_ANUL) + '</DOC_CC_ANUL>' + 
				'<TIPO_DOC_CC_ANUL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_DOC_CC_ANUL) + '</TIPO_DOC_CC_ANUL>' + 
				'<GENERO_FACTURA_INICIO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@GENERO_FACTURA_INICIO) + '</GENERO_FACTURA_INICIO>' + 
				'<AFECTA_CONTABIL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@AFECTA_CONTABIL) + '</AFECTA_CONTABIL>' + 
				'<EFECTIVO_DEVUELTO Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@EFECTIVO_DEVUELTO) + '</EFECTIVO_DEVUELTO>' + 
				'<TIPO_CAMBIO Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@TIPO_CAMBIO) + '</TIPO_CAMBIO>' + 
				'<BENEFICIARIO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@BENEFICIARIO) + '</BENEFICIARIO>' + 
				'<MONEDA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@MONEDA) + '</MONEDA>' + 
				'<SUBTIPO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@SUBTIPO) + '</SUBTIPO>' + 
				'<ID_BENEFICIARIO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ID_BENEFICIARIO) + '</ID_BENEFICIARIO>' + 
				'<USUARIO_ULT_IMPRE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USUARIO_ULT_IMPRE) + '</USUARIO_ULT_IMPRE>' + 
				'<FCH_HORA_ULT_IMPRE Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FCH_HORA_ULT_IMPRE) + '</FCH_HORA_ULT_IMPRE>' + 
				'<USUARIO_APLICACION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USUARIO_APLICACION) + '</USUARIO_APLICACION>' + 
				'<FCH_HORA_APLICACIO Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FCH_HORA_APLICACIO) + '</FCH_HORA_APLICACIO>' + 
				'<USUARIO_ANULACION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USUARIO_ANULACION) + '</USUARIO_ANULACION>' + 
				'<ESTADO_IMPRESION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ESTADO_IMPRESION) + '</ESTADO_IMPRESION>' + 
				'<TELEFONO_BENEFICIA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TELEFONO_BENEFICIA) + '</TELEFONO_BENEFICIA>' + 				
				'<SALDO_REPORTE Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@SALDO_REPORTE) + '</SALDO_REPORTE>' + 
				'<MONEDA_DOC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@MONEDA_DOC) + '</MONEDA_DOC>' + 
				'<NCF Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NCF) + '</NCF>' + 
				'<TIPO_NCF Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_NCF) + '</TIPO_NCF>' + 
				'<NUM_CIERRE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NUM_CIERRE) + '</NUM_CIERRE>' + 
				'<CORRELATIVO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CORRELATIVO) + '</CORRELATIVO>' +
				'<RECIBIDO_DE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@RECIBIDO_DE) + '</RECIBIDO_DE>' + 
				'<RESOLUCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@RESOLUCION) + '</RESOLUCION>' + 
				'<COD_CLASE_DOC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@COD_CLASE_DOC) + '</COD_CLASE_DOC>' + 
				'<DOC_EXPRESS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DOC_EXPRESS) + '</DOC_EXPRESS>' + 
				'<MENSAJERO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@MENSAJERO) + '</MENSAJERO>' + 
				'<CLIENTE_EXPRESS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CLIENTE_EXPRESS) + '</CLIENTE_EXPRESS>' + 
				'<ENTREGA_EXPRSS_A Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ENTREGA_EXPRSS_A) + '</ENTREGA_EXPRSS_A>' + 
				'<ESTADO_EXPRESS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ESTADO_EXPRESS) + '</ESTADO_EXPRESS>' + 
				'<MONTO_ENTREGADO Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@MONTO_ENTREGADO) + '</MONTO_ENTREGADO>' + 
				'<MONTO_DEVUELTO Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@MONTO_DEVUELTO) + '</MONTO_DEVUELTO>' + 
				'<FCH_ENVIO Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FCH_ENVIO) + '</FCH_ENVIO>' + 
				'<FCH_ENTREGA Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FCH_ENTREGA) + '</FCH_ENTREGA>' + 
				'<MOTIV_CANCELA_EXPR Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@MOTIV_CANCELA_EXPR) + '</MOTIV_CANCELA_EXPR>' + 
				'<NOTA_EXPRESS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOTA_EXPRESS) + '</NOTA_EXPRESS>' + 
				'<BASE_IMPUESTO1 Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@BASE_IMPUESTO1) + '</BASE_IMPUESTO1>' + 
				'<BASE_IMPUESTO2 Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@BASE_IMPUESTO2) + '</BASE_IMPUESTO2>' + 
				'<DOC_FISCAL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DOC_FISCAL) + '</DOC_FISCAL>' + 
				'<PREFIJO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DOC_FISCAL) + '</PREFIJO>' + 
				'<PEDIDO_AUTORIZADO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@PEDIDO_AUTORIZADO) + '</PEDIDO_AUTORIZADO>' + 
				'<DOC_CC_ANTICIPO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DOC_CC_ANTICIPO) + '</DOC_CC_ANTICIPO>' + 
				'<NOMBREMAQUINA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOMBREMAQUINA) + '</NOMBREMAQUINA>' +
				'</DOCUMENTO_POS>'
			
			-- Inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'DOCUMENTOPOSPOS600', 'INSERTA', @PARAMETROS, 0, ''
			
			FETCH NEXT FROM C_INSERTED INTO
			@DOCUMENTO, @CAJA, @TIPO, @PERFIL, @VENDEDOR, @CLIENTE, @NOMBRE_CLIENTE, @CAJERO, @CAJA_COBRO, @IMPUESTO1, @IMPUESTO2, @DESCUENTO, @TOTAL_PAGAR, @TOTAL, @FCH_HORA_CREACION, @FCH_HORA_COBRO, @FCH_HORA_ANULA, @EXPORTADO, @ESTADO_COBRO, @SALDO, @FECHA_VENCE, @LISTO_INVENTARIO, @NIVEL_PRECIO, @MONEDA_NIVEL, @VERSION, @FECHANAC_CLIENTE, @TELEFONO_CLIENTE, @NIT_CLIENTE, @PAIS, @CLASE_DOCUMENTO, @CONDICION_PAGO_APA, @DOC_CC, @TIPO_DOC_CC, @CARGADO_CC, @CARGADO_CG, @DEVUELVE_DINERO, @DOC_CC_ANUL, @TIPO_DOC_CC_ANUL, @GENERO_FACTURA_INICIO, @AFECTA_CONTABIL, @EFECTIVO_DEVUELTO, @TIPO_CAMBIO, @BENEFICIARIO, @MONEDA, @SUBTIPO, @ID_BENEFICIARIO, @USUARIO_ULT_IMPRE, @FCH_HORA_ULT_IMPRE, @USUARIO_APLICACION, @FCH_HORA_APLICACIO, @USUARIO_ANULACION, @ESTADO_IMPRESION, @TELEFONO_BENEFICIA,@SALDO_REPORTE,@MONEDA_DOC, @NCF, @TIPO_NCF, @NUM_CIERRE, @DIRECCION, @CORRELATIVO, @RECIBIDO_DE, @RESOLUCION, @COD_CLASE_DOC, @DOC_EXPRESS, @MENSAJERO, @CLIENTE_EXPRESS, @ENTREGA_EXPRSS_A, @ESTADO_EXPRESS, @MONTO_ENTREGADO, @MONTO_DEVUELTO, @FCH_ENVIO, @FCH_ENTREGA, @MOTIV_CANCELA_EXPR, @NOTA_EXPRESS, @BASE_IMPUESTO1, @BASE_IMPUESTO2, @DOC_FISCAL, @PREFIJO, @PEDIDO_AUTORIZADO, @DOC_CC_ANTICIPO, @NOMBREMAQUINA
		END
		CLOSE C_INSERTED
    		DEALLOCATE C_INSERTED
	END
	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla DOCUMENTO_POS.',16,1 )
	END
END;




CREATE TRIGGER $$Compania$$.DOCUMENTO_POS_POS_MOD
ON $$Compania$$.DOCUMENTO_POS
FOR UPDATE  
AS 
BEGIN   	
DECLARE @ERROR  INT,
	@PUBLICADOR VARCHAR(20),
	@USUARIO_POS_WSQM VARCHAR(100),
	@HAY_DATOS VARCHAR(1),
	@ACTUALIZAR_SOLICITUD BIT, 
	@DOCUMENTO VARCHAR(50),
	@CAJA VARCHAR(6),
	@TIPO VARCHAR(1),
	@PERFIL VARCHAR(4),
	@VENDEDOR VARCHAR(4),
	@CLIENTE VARCHAR(20),
	@NOMBRE_CLIENTE VARCHAR(80),
	@CAJERO VARCHAR(25),
	@CAJA_COBRO VARCHAR(6),
	@IMPUESTO1 DECIMAL(28,8),
	@IMPUESTO2 DECIMAL(28,8),
	@DESCUENTO DECIMAL(28,8),
	@TOTAL_PAGAR DECIMAL(28,8),
	@TOTAL DECIMAL(28,8),
	@FCH_HORA_CREACION DATETIME,
	@FCH_HORA_COBRO DATETIME,
	@FCH_HORA_ANULA DATETIME,
	@EXPORTADO VARCHAR(1),
	@ESTADO_COBRO VARCHAR(1),
	@SALDO DECIMAL(28,8),
	@FECHA_VENCE DATETIME,
	@LISTO_INVENTARIO VARCHAR(1),
	@NIVEL_PRECIO VARCHAR(12),
	@MONEDA_NIVEL VARCHAR(1),
	@VERSION INT,
	@FECHANAC_CLIENTE DATETIME,
	@TELEFONO_CLIENTE VARCHAR(15),
	@NIT_CLIENTE VARCHAR(20),
	@PAIS VARCHAR(4),
	@CLASE_DOCUMENTO VARCHAR(1),
	@CONDICION_PAGO_APA VARCHAR(4),
	@DOC_CC VARCHAR(50),
	@TIPO_DOC_CC VARCHAR(3),
	@CARGADO_CC VARCHAR(1),
	@CARGADO_CG VARCHAR(1),
	@DEVUELVE_DINERO VARCHAR(1),
	@DOC_CC_ANUL VARCHAR(50),
	@TIPO_DOC_CC_ANUL VARCHAR(3),
	@GENERO_FACTURA_INICIO VARCHAR(1),
	@AFECTA_CONTABIL VARCHAR(1),
	@EFECTIVO_DEVUELTO DECIMAL(28,8),
	@TIPO_CAMBIO DECIMAL(28,8),
	@BENEFICIARIO VARCHAR(254),
	@MONEDA VARCHAR(1),
	@SUBTIPO VARCHAR(1),
	@ID_BENEFICIARIO VARCHAR(20),
	@USUARIO_ULT_IMPRE VARCHAR(25),
	@FCH_HORA_ULT_IMPRE DATETIME,
	@USUARIO_APLICACION VARCHAR(25),
	@FCH_HORA_APLICACIO DATETIME,
	@USUARIO_ANULACION VARCHAR(25),
	@ESTADO_IMPRESION VARCHAR(1),
	@TELEFONO_BENEFICIA VARCHAR(15),
	@SALDO_REPORTE DECIMAL(28,8),
	@MONEDA_DOC VARCHAR(1),
	@NCF VARCHAR(20),
	@TIPO_NCF VARCHAR(6),
	@NUM_CIERRE VARCHAR(20),
	@CORRELATIVO VARCHAR(10),
	@RECIBIDO_DE VARCHAR(80),
	@RESOLUCION VARCHAR(20),
	@COD_CLASE_DOC 		VARCHAR(10),
    @DOC_EXPRESS 		VARCHAR(1),
	@MENSAJERO 		VARCHAR(10),
	@CLIENTE_EXPRESS 	VARCHAR(20),
	@ENTREGA_EXPRSS_A 	VARCHAR(80),
	@ESTADO_EXPRESS 	VARCHAR(1),
	@MONTO_ENTREGADO 	DECIMAL (28,8),
	@MONTO_DEVUELTO 	DECIMAL (28,8),
	@FCH_ENVIO 		DATETIME,
	@FCH_ENTREGA 		DATETIME,
	@MOTIV_CANCELA_EXPR 	VARCHAR(10),
    @NOTA_EXPRESS 		VARCHAR(1000),
	@BASE_IMPUESTO1		DECIMAL(28,8),
  	@BASE_IMPUESTO2		DECIMAL(28,8),  
  	@DOC_FISCAL 		VARCHAR(50),
	@PREFIJO		VARCHAR(20),
	@PEDIDO_AUTORIZADO 	VARCHAR(50),
	@DOC_CC_ANTICIPO 	VARCHAR(50),
	@NOMBREMAQUINA		VARCHAR(20),
	@OLD_DOCUMENTO 		VARCHAR(50),
	@OLD_CAJA VARCHAR(6),
	@OLD_TIPO VARCHAR(1),
	@OLD_PERFIL VARCHAR(4),
	@OLD_VENDEDOR VARCHAR(4),
	@OLD_CLIENTE VARCHAR(20),
	@OLD_NOMBRE_CLIENTE VARCHAR(80),
	@OLD_CAJERO VARCHAR(25),
	@OLD_CAJA_COBRO VARCHAR(6),
	@OLD_IMPUESTO1 DECIMAL(28,8),
	@OLD_IMPUESTO2 DECIMAL(28,8),
	@OLD_DESCUENTO DECIMAL(28,8),
	@OLD_TOTAL_PAGAR DECIMAL(28,8),
	@OLD_TOTAL DECIMAL(28,8),
	@OLD_FCH_HORA_CREACION DATETIME,
	@OLD_FCH_HORA_COBRO DATETIME,
	@OLD_FCH_HORA_ANULA DATETIME,
	@OLD_EXPORTADO VARCHAR(1),
	@OLD_ESTADO_COBRO VARCHAR(1),
	@OLD_SALDO DECIMAL(28,8),
	@OLD_FECHA_VENCE DATETIME,
	@OLD_LISTO_INVENTARIO VARCHAR(1),
	@OLD_NIVEL_PRECIO VARCHAR(12),
	@OLD_MONEDA_NIVEL VARCHAR(1),
	@OLD_VERSION INT,
	@OLD_FECHANAC_CLIENTE DATETIME,
	@OLD_TELEFONO_CLIENTE VARCHAR(15),
	@OLD_NIT_CLIENTE VARCHAR(20),
	@OLD_PAIS VARCHAR(4),
	@OLD_CLASE_DOCUMENTO VARCHAR(1),
	@OLD_CONDICION_PAGO_APA VARCHAR(4),
	@OLD_DOC_CC VARCHAR(50),
	@OLD_TIPO_DOC_CC VARCHAR(3),
	@OLD_CARGADO_CC VARCHAR(1),
	@OLD_CARGADO_CG VARCHAR(1),
	@OLD_DEVUELVE_DINERO VARCHAR(1),
	@OLD_DOC_CC_ANUL VARCHAR(50),
	@OLD_TIPO_DOC_CC_ANUL VARCHAR(3),
	@OLD_GENERO_FACTURA_INICIO VARCHAR(1),
	@OLD_AFECTA_CONTABIL VARCHAR(1),
	@OLD_EFECTIVO_DEVUELTO DECIMAL(28,8),
	@OLD_TIPO_CAMBIO DECIMAL(28,8),
	@OLD_BENEFICIARIO VARCHAR(254),
	@OLD_MONEDA VARCHAR(1),
	@OLD_SUBTIPO VARCHAR(1),
	@OLD_ID_BENEFICIARIO VARCHAR(20),
	@OLD_USUARIO_ULT_IMPRE VARCHAR(25),
	@OLD_FCH_HORA_ULT_IMPRE DATETIME,
	@OLD_USUARIO_APLICACION VARCHAR(25),
	@OLD_FCH_HORA_APLICACIO DATETIME,
	@OLD_USUARIO_ANULACION VARCHAR(25),
	@OLD_ESTADO_IMPRESION VARCHAR(1),
	@OLD_TELEFONO_BENEFICIA VARCHAR(15),
	@OLD_SALDO_REPORTE DECIMAL(28,8),
	@OLD_MONEDA_DOC VARCHAR(1),	
	@OLD_NCF VARCHAR(20),
	@OLD_TIPO_NCF VARCHAR(6),
	@OLD_NUM_CIERRE VARCHAR(20),
	@OLD_CORRELATIVO VARCHAR(10),
	@OLD_RECIBIDO_DE VARCHAR(80),
	@OLD_RESOLUCION VARCHAR(20),
	@OLD_COD_CLASE_DOC VARCHAR(10),
	@OLD_DOC_EXPRESS 		VARCHAR(1),
	@OLD_MENSAJERO 		VARCHAR(10),
	@OLD_CLIENTE_EXPRESS 	VARCHAR(20),
	@OLD_ENTREGA_EXPRSS_A 	VARCHAR(80),
	@OLD_ESTADO_EXPRESS 		VARCHAR(1),
	@OLD_MONTO_ENTREGADO 	DECIMAL (28,8),
	@OLD_MONTO_DEVUELTO 		DECIMAL (28,8),
	@OLD_FCH_ENVIO 			DATETIME,
	@OLD_FCH_ENTREGA 		DATETIME,
	@OLD_MOTIV_CANCELA_EXPR VARCHAR(10),
    @OLD_NOTA_EXPRESS 		VARCHAR(1000), 
    @OLD_BASE_IMPUESTO1		DECIMAL(28,8),
  	@OLD_BASE_IMPUESTO2		DECIMAL(28,8),
  	@OLD_DOC_FISCAL 		VARCHAR(50),
	@OLD_PREFIJO			VARCHAR(20),
	@OLD_PEDIDO_AUTORIZADO 	VARCHAR(50),
	@OLD_DOC_CC_ANTICIPO 	VARCHAR(50),
	@OLD_NOMBREMAQUINA		VARCHAR(20),
	@PARAMETROS 			VARCHAR(8000),
	@DATOS_POR_CAMBIAR 		VARCHAR(8000),
	@TIPO_SITIO_LOCAL 		VARCHAR(1)
	
	--Dejar sólo los campos que le interesen al POS luego de la variable ACTUALIZAR_SOLICITUD 
  SET @ERROR = 0
  SET @HAY_DATOS = 'N'  
  SELECT @PUBLICADOR = SITIO_LOCAL,
	@USUARIO_POS_WSQM = USUARIO_WSQM ,
		@TIPO_SITIO_LOCAL = TIPO_SITIO_LOCAL
  FROM $$Compania$$.GLOBALES_POS
  -- Aquí se hace la validación del usuario de conexión para evitar ping-pong
  IF NOT (CURRENT_USER = @USUARIO_POS_WSQM) AND @TIPO_SITIO_LOCAL = 'T'
  BEGIN
    IF NOT(UPDATE(DOCUMENTO) OR UPDATE(CAJA) OR UPDATE(TIPO) )
      BEGIN
        DECLARE C_MODIFIED CURSOR LOCAL FOR
        SELECT
          I.DOCUMENTO,
          I.CAJA,
          I.TIPO,
          I.PERFIL,
          I.VENDEDOR,
          I.CLIENTE,
          I.NOMBRE_CLIENTE,
          I.CAJERO,
          I.CAJA_COBRO,
          I.IMPUESTO1,
          I.IMPUESTO2,
          I.DESCUENTO,
          I.TOTAL_PAGAR,
          I.TOTAL,
          I.FCH_HORA_CREACION,
          I.FCH_HORA_COBRO,
          I.FCH_HORA_ANULA,
          I.EXPORTADO,
          I.ESTADO_COBRO,
          I.SALDO,
          I.FECHA_VENCE,
          I.LISTO_INVENTARIO,
          I.NIVEL_PRECIO,
          I.MONEDA_NIVEL,
          I.VERSION,
          I.FECHANAC_CLIENTE,
          I.TELEFONO_CLIENTE,
          I.NIT_CLIENTE,
          I.PAIS,
          I.CLASE_DOCUMENTO,
          I.CONDICION_PAGO_APA,
          I.DOC_CC,
          I.TIPO_DOC_CC,
          I.CARGADO_CC,
          I.CARGADO_CG,
          I.DEVUELVE_DINERO,
          I.DOC_CC_ANUL,
          I.TIPO_DOC_CC_ANUL,
          I.GENERO_FACTURA_INICIO,
          I.AFECTA_CONTABIL,
          I.EFECTIVO_DEVUELTO,
          I.TIPO_CAMBIO,
          I.BENEFICIARIO,
          I.MONEDA,
          I.SUBTIPO,
          I.ID_BENEFICIARIO,
          I.USUARIO_ULT_IMPRE,
          I.FCH_HORA_ULT_IMPRE,
          I.USUARIO_APLICACION,
          I.FCH_HORA_APLICACIO,
          I.USUARIO_ANULACION,
          I.ESTADO_IMPRESION,
          I.TELEFONO_BENEFICIA,
          I.SALDO_REPORTE,
          I.MONEDA_DOC,
          I.NCF,
          I.TIPO_NCF,
          I.NUM_CIERRE,
          I.CORRELATIVO,
          I.RECIBIDO_DE,
	  I.RESOLUCION,
	  I.COD_CLASE_DOC,
	  I.DOC_EXPRESS,
	  I.MENSAJERO,
	  I.CLIENTE_EXPRESS,
	  I.ENTREGA_EXPRSS_A,
	  I.ESTADO_EXPRESS,
	  I.MONTO_ENTREGADO,
	  I.MONTO_DEVUELTO,
	  I.FCH_ENVIO,
	  I.FCH_ENTREGA,
	  I.MOTIV_CANCELA_EXPR,
	  I.NOTA_EXPRESS, 
	  I.BASE_IMPUESTO1,	 
	  I.BASE_IMPUESTO2,
	  I.DOC_FISCAL,
	  I.PREFIJO,
	  I.PEDIDO_AUTORIZADO,
	  I.DOC_CC_ANTICIPO,
	  I.NOMBREMAQUINA,
	  D.DOCUMENTO,
          D.CAJA,
          D.TIPO,
          D.PERFIL,
          D.VENDEDOR,
          D.CLIENTE,
          D.NOMBRE_CLIENTE,
          D.CAJERO,
          D.CAJA_COBRO,
          D.IMPUESTO1,
          D.IMPUESTO2,
          D.DESCUENTO,
          D.TOTAL_PAGAR,
          D.TOTAL,
          D.FCH_HORA_CREACION,
          D.FCH_HORA_COBRO,
          D.FCH_HORA_ANULA,
          D.EXPORTADO,
          D.ESTADO_COBRO,
          D.SALDO,
          D.FECHA_VENCE,
          D.LISTO_INVENTARIO,
          D.NIVEL_PRECIO,
          D.MONEDA_NIVEL,
          D.VERSION,
          D.FECHANAC_CLIENTE,
          D.TELEFONO_CLIENTE,
          D.NIT_CLIENTE,
          D.PAIS,
          D.CLASE_DOCUMENTO,
          D.CONDICION_PAGO_APA,
          D.DOC_CC,
          D.TIPO_DOC_CC,
          D.CARGADO_CC,
          D.CARGADO_CG,
          D.DEVUELVE_DINERO,
          D.DOC_CC_ANUL,
          D.TIPO_DOC_CC_ANUL,
          D.GENERO_FACTURA_INICIO,
          D.AFECTA_CONTABIL,
          D.EFECTIVO_DEVUELTO,
          D.TIPO_CAMBIO,
          D.BENEFICIARIO,
          D.MONEDA,
          D.SUBTIPO,
          D.ID_BENEFICIARIO,
          D.USUARIO_ULT_IMPRE,
          D.FCH_HORA_ULT_IMPRE,
          D.USUARIO_APLICACION,
          D.FCH_HORA_APLICACIO,
          D.USUARIO_ANULACION,
          D.ESTADO_IMPRESION,
          D.TELEFONO_BENEFICIA,
          D.SALDO_REPORTE,
          D.MONEDA_DOC,
          D.NCF,
          D.TIPO_NCF,
          D.NUM_CIERRE,
          D.CORRELATIVO,
          D.RECIBIDO_DE,
          D.RESOLUCION,
          D.COD_CLASE_DOC,
          D.DOC_EXPRESS,
          D.MENSAJERO,
          D.CLIENTE_EXPRESS,
          D.ENTREGA_EXPRSS_A,
          D.ESTADO_EXPRESS,
          D.MONTO_ENTREGADO,
          D.MONTO_DEVUELTO,
          D.FCH_ENVIO,
          D.FCH_ENTREGA,
          D.MOTIV_CANCELA_EXPR,
          D.NOTA_EXPRESS, 
          D.BASE_IMPUESTO1,
          D.BASE_IMPUESTO2,
          D.DOC_FISCAL,
	  D.PREFIJO,
	  D.PEDIDO_AUTORIZADO,
	  D.DOC_CC_ANTICIPO,
	  D.NOMBREMAQUINA,
          ''
          FROM INSERTED I, DELETED D
          WHERE
            I.DOCUMENTO = D.DOCUMENTO and
      I.CAJA = D.CAJA and
      I.TIPO = D.TIPO
      END
    ELSE
      BEGIN
        DECLARE C_MODIFIED CURSOR LOCAL FOR
        SELECT
          I.DOCUMENTO,
          I.CAJA,
          I.TIPO,
          I.PERFIL,
          I.VENDEDOR,
          I.CLIENTE,
          I.NOMBRE_CLIENTE,
          I.CAJERO,
          I.CAJA_COBRO,
          I.IMPUESTO1,
          I.IMPUESTO2,
          I.DESCUENTO,
          I.TOTAL_PAGAR,
          I.TOTAL,
          I.FCH_HORA_CREACION,
          I.FCH_HORA_COBRO,
          I.FCH_HORA_ANULA,
          I.EXPORTADO,
          I.ESTADO_COBRO,
          I.SALDO,
          I.FECHA_VENCE,
          I.LISTO_INVENTARIO,
          I.NIVEL_PRECIO,
          I.MONEDA_NIVEL,
          I.VERSION,
          I.FECHANAC_CLIENTE,
          I.TELEFONO_CLIENTE,
          I.NIT_CLIENTE,
          I.PAIS,
          I.CLASE_DOCUMENTO,
          I.CONDICION_PAGO_APA,
          I.DOC_CC,
          I.TIPO_DOC_CC,
          I.CARGADO_CC,
          I.CARGADO_CG,
          I.DEVUELVE_DINERO,
          I.DOC_CC_ANUL,
          I.TIPO_DOC_CC_ANUL,
          I.GENERO_FACTURA_INICIO,
          I.AFECTA_CONTABIL,
          I.EFECTIVO_DEVUELTO,
          I.TIPO_CAMBIO,
          I.BENEFICIARIO,
          I.MONEDA,
          I.SUBTIPO,
          I.ID_BENEFICIARIO,
          I.USUARIO_ULT_IMPRE,
          I.FCH_HORA_ULT_IMPRE,
          I.USUARIO_APLICACION,
          I.FCH_HORA_APLICACIO,
          I.USUARIO_ANULACION,
          I.ESTADO_IMPRESION,
          I.TELEFONO_BENEFICIA,
          I.SALDO_REPORTE,
          I.MONEDA_DOC,
          I.NCF,
          I.TIPO_NCF,
          I.NUM_CIERRE,
          I.CORRELATIVO,
          I.RECIBIDO_DE,
          I.RESOLUCION,
          I.COD_CLASE_DOC,
          I.DOC_EXPRESS,
          I.MENSAJERO,
          I.CLIENTE_EXPRESS,
          I.ENTREGA_EXPRSS_A,
          I.ESTADO_EXPRESS,
          I.MONTO_ENTREGADO,
          I.MONTO_DEVUELTO,
          I.FCH_ENVIO,
          I.FCH_ENTREGA,
          I.MOTIV_CANCELA_EXPR,
          I.NOTA_EXPRESS,
          I.BASE_IMPUESTO1,
          I.BASE_IMPUESTO2,
          I.DOC_FISCAL,
	  I.PREFIJO,
	  I.PEDIDO_AUTORIZADO,
	  I.DOC_CC_ANTICIPO,
	  I.NOMBREMAQUINA,
          D.DOCUMENTO,
          D.CAJA,
          D.TIPO,
          D.PERFIL,
          D.VENDEDOR,
          D.CLIENTE,
          D.NOMBRE_CLIENTE,
          D.CAJERO,
          D.CAJA_COBRO,
          D.IMPUESTO1,
          D.IMPUESTO2,
          D.DESCUENTO,
          D.TOTAL_PAGAR,
          D.TOTAL,
          D.FCH_HORA_CREACION,
          D.FCH_HORA_COBRO,
          D.FCH_HORA_ANULA,
          D.EXPORTADO,
          D.ESTADO_COBRO,
          D.SALDO,
          D.FECHA_VENCE,
          D.LISTO_INVENTARIO,
          D.NIVEL_PRECIO,
          D.MONEDA_NIVEL,
          D.VERSION,
          D.FECHANAC_CLIENTE,
          D.TELEFONO_CLIENTE,
          D.NIT_CLIENTE,
          D.PAIS,
          D.CLASE_DOCUMENTO,
          D.CONDICION_PAGO_APA,
          D.DOC_CC,
          D.TIPO_DOC_CC,
          D.CARGADO_CC,
          D.CARGADO_CG,
          D.DEVUELVE_DINERO,
          D.DOC_CC_ANUL,
          D.TIPO_DOC_CC_ANUL,
          D.GENERO_FACTURA_INICIO,
          D.AFECTA_CONTABIL,
          D.EFECTIVO_DEVUELTO,
          D.TIPO_CAMBIO,
          D.BENEFICIARIO,
          D.MONEDA,
          D.SUBTIPO,
          D.ID_BENEFICIARIO,
          D.USUARIO_ULT_IMPRE,
          D.FCH_HORA_ULT_IMPRE,
          D.USUARIO_APLICACION,
          D.FCH_HORA_APLICACIO,
          D.USUARIO_ANULACION,
          D.ESTADO_IMPRESION,
          D.TELEFONO_BENEFICIA,
          D.SALDO_REPORTE,
          D.MONEDA_DOC,
          D.NCF,
          D.TIPO_NCF,
          D.NUM_CIERRE,
          D.CORRELATIVO,
          D.RECIBIDO_DE,
          D.RESOLUCION,
          D.COD_CLASE_DOC,
          D.DOC_EXPRESS,
          D.MENSAJERO,
          D.CLIENTE_EXPRESS,
          D.ENTREGA_EXPRSS_A,
          D.ESTADO_EXPRESS,
          D.MONTO_ENTREGADO,
          D.MONTO_DEVUELTO,
          D.FCH_ENVIO,
          D.FCH_ENTREGA,
          D.MOTIV_CANCELA_EXPR,
          D.NOTA_EXPRESS, 
          D.BASE_IMPUESTO1,
          D.BASE_IMPUESTO2,
          D.DOC_FISCAL,
	  D.PREFIJO,
	  D.PEDIDO_AUTORIZADO,
	  D.DOC_CC_ANTICIPO,
	  D.NOMBREMAQUINA,
          ''
          FROM INSERTED I, DELETED D
          WHERE
		I.ROWPOINTER = D.ROWPOINTER
        SET @HAY_DATOS = 'S'
      END
    SET @ACTUALIZAR_SOLICITUD = 1
    OPEN C_MODIFIED
    FETCH NEXT FROM C_MODIFIED
     INTO @DOCUMENTO, 
     @CAJA, 
     @TIPO, 
     @PERFIL, 
     @VENDEDOR, 
     @CLIENTE, 
     @NOMBRE_CLIENTE, 
     @CAJERO, 
     @CAJA_COBRO, 
     @IMPUESTO1, 
     @IMPUESTO2, 
     @DESCUENTO, 
     @TOTAL_PAGAR, 
     @TOTAL, 
     @FCH_HORA_CREACION, 
     @FCH_HORA_COBRO, 
     @FCH_HORA_ANULA, 
     @EXPORTADO, 
     @ESTADO_COBRO, 
     @SALDO, 
     @FECHA_VENCE, 
     @LISTO_INVENTARIO, 
     @NIVEL_PRECIO, 
     @MONEDA_NIVEL, 
     @VERSION, 
     @FECHANAC_CLIENTE, 
     @TELEFONO_CLIENTE, 
     @NIT_CLIENTE, 
     @PAIS, 
     @CLASE_DOCUMENTO, 
     @CONDICION_PAGO_APA, 
     @DOC_CC, 
     @TIPO_DOC_CC, 
     @CARGADO_CC, 
     @CARGADO_CG, 
     @DEVUELVE_DINERO, 
     @DOC_CC_ANUL, 
     @TIPO_DOC_CC_ANUL, 
     @GENERO_FACTURA_INICIO, 
     @AFECTA_CONTABIL, 
     @EFECTIVO_DEVUELTO, 
     @TIPO_CAMBIO, 
     @BENEFICIARIO, 
     @MONEDA, 
     @SUBTIPO, 
     @ID_BENEFICIARIO, 
     @USUARIO_ULT_IMPRE, 
     @FCH_HORA_ULT_IMPRE, 
     @USUARIO_APLICACION, 
     @FCH_HORA_APLICACIO, 
     @USUARIO_ANULACION, 
     @ESTADO_IMPRESION, 
     @TELEFONO_BENEFICIA, 
     @SALDO_REPORTE,
     @MONEDA_DOC,
     @NCF,
     @TIPO_NCF,
     @NUM_CIERRE,
     @CORRELATIVO,
     @RECIBIDO_DE,
     @RESOLUCION,
     @COD_CLASE_DOC,
     @DOC_EXPRESS,
     @MENSAJERO,
     @CLIENTE_EXPRESS,
     @ENTREGA_EXPRSS_A,
     @ESTADO_EXPRESS,
     @MONTO_ENTREGADO,
     @MONTO_DEVUELTO,
     @FCH_ENVIO,
     @FCH_ENTREGA,
     @MOTIV_CANCELA_EXPR,
     @NOTA_EXPRESS,
     @BASE_IMPUESTO1,
     @BASE_IMPUESTO2,
     @DOC_FISCAL,
     @PREFIJO,
     @PEDIDO_AUTORIZADO,
     @DOC_CC_ANTICIPO,
     @NOMBREMAQUINA,
     @OLD_DOCUMENTO, 
     @OLD_CAJA, 
     @OLD_TIPO, 
     @OLD_PERFIL, 
     @OLD_VENDEDOR, 
     @OLD_CLIENTE, 
     @OLD_NOMBRE_CLIENTE, 
     @OLD_CAJERO, 
     @OLD_CAJA_COBRO, 
     @OLD_IMPUESTO1, 
     @OLD_IMPUESTO2, 
     @OLD_DESCUENTO, 
     @OLD_TOTAL_PAGAR, 
     @OLD_TOTAL, 
     @OLD_FCH_HORA_CREACION, 
     @OLD_FCH_HORA_COBRO, 
     @OLD_FCH_HORA_ANULA, 
     @OLD_EXPORTADO, 
     @OLD_ESTADO_COBRO, 
     @OLD_SALDO, 
     @OLD_FECHA_VENCE, 
     @OLD_LISTO_INVENTARIO, 
     @OLD_NIVEL_PRECIO, 
     @OLD_MONEDA_NIVEL, 
     @OLD_VERSION, 
     @OLD_FECHANAC_CLIENTE, 
     @OLD_TELEFONO_CLIENTE, 
     @OLD_NIT_CLIENTE, 
     @OLD_PAIS, 
     @OLD_CLASE_DOCUMENTO, 
     @OLD_CONDICION_PAGO_APA, 
     @OLD_DOC_CC, 
     @OLD_TIPO_DOC_CC, 
     @OLD_CARGADO_CC, 
     @OLD_CARGADO_CG, 
     @OLD_DEVUELVE_DINERO, 
     @OLD_DOC_CC_ANUL, 
     @OLD_TIPO_DOC_CC_ANUL, 
     @OLD_GENERO_FACTURA_INICIO, 
     @OLD_AFECTA_CONTABIL, 
     @OLD_EFECTIVO_DEVUELTO, 
     @OLD_TIPO_CAMBIO, 
     @OLD_BENEFICIARIO, 
     @OLD_MONEDA, 
     @OLD_SUBTIPO, 
     @OLD_ID_BENEFICIARIO, 
     @OLD_USUARIO_ULT_IMPRE, 
     @OLD_FCH_HORA_ULT_IMPRE, 
     @OLD_USUARIO_APLICACION, 
     @OLD_FCH_HORA_APLICACIO, 
     @OLD_USUARIO_ANULACION, 
     @OLD_ESTADO_IMPRESION, 
     @OLD_TELEFONO_BENEFICIA, 
     @OLD_SALDO_REPORTE,
     @OLD_MONEDA_DOC,
     @OLD_NCF,
     @OLD_TIPO_NCF,
     @OLD_NUM_CIERRE,
     @OLD_CORRELATIVO,
     @OLD_RECIBIDO_DE,
     @OLD_RESOLUCION,
     @OLD_COD_CLASE_DOC,	 
     @OLD_DOC_EXPRESS,
     @OLD_MENSAJERO,
     @OLD_CLIENTE_EXPRESS,
     @OLD_ENTREGA_EXPRSS_A,
     @OLD_ESTADO_EXPRESS,
     @OLD_MONTO_ENTREGADO,
     @OLD_MONTO_DEVUELTO,
     @OLD_FCH_ENVIO,
     @OLD_FCH_ENTREGA,
     @OLD_MOTIV_CANCELA_EXPR,
     @OLD_NOTA_EXPRESS,
     @OLD_BASE_IMPUESTO1,
     @OLD_BASE_IMPUESTO2,
     @OLD_DOC_FISCAL,
     @OLD_PREFIJO,
     @OLD_PEDIDO_AUTORIZADO,
     @OLD_DOC_CC_ANTICIPO,
     @OLD_NOMBREMAQUINA,
     @PARAMETROS
	--Dejar sólo los campos que se dejaron en la declaración
	--Asegurarse que las variables tengan el mismo orden que el select del cursor
    WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
    BEGIN
      IF (NOT UPDATE(RECORDDATE)) -- se asegura que no sea activación del trigger de eDNA
      BEGIN
	SET @PARAMETROS = ''
	SET @DATOS_POR_CAMBIAR = ''
  	--Se arma la llave de la tabla que siempre debe ser indicada
	SET @PARAMETROS = 
				'<DOCUMENTO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@DOCUMENTO) + '</DOCUMENTO>' + 
				'<CAJA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CAJA) + '</CAJA>' + 
				'<TIPO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO) + '</TIPO>'
	IF ISNULL(@PERFIL,'') != ISNULL(@OLD_PERFIL,'')
	BEGIN
	  SET @DATOS_POR_CAMBIAR = @DATOS_POR_CAMBIAR + '<PERFIL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@PERFIL) + '</PERFIL>'
	END
	
	IF ISNULL(@VENDEDOR,'') != ISNULL(@OLD_VENDEDOR,'')
	BEGIN
	  SET @DATOS_POR_CAMBIAR = @DATOS_POR_CAMBIAR + '<VENDEDOR Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@VENDEDOR) + '</VENDEDOR>'
	END
	
	IF ISNULL(@CLIENTE,'') != ISNULL(@OLD_CLIENTE,'')
	BEGIN
	  SET @DATOS_POR_CAMBIAR = @DATOS_POR_CAMBIAR + '<CLIENTE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CLIENTE) + '</CLIENTE>'
	END
	
	IF ISNULL(@NOMBRE_CLIENTE,'') != ISNULL(@OLD_NOMBRE_CLIENTE,'')
	BEGIN
	  SET @DATOS_POR_CAMBIAR = @DATOS_POR_CAMBIAR + '<NOMBRE_CLIENTE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOMBRE_CLIENTE) + '</NOMBRE_CLIENTE>'
	END
	
	IF ISNULL(@CAJERO,'') != ISNULL(@OLD_CAJERO,'')
	BEGIN
	  SET @DATOS_POR_CAMBIAR = @DATOS_POR_CAMBIAR + '<CAJERO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CAJERO) + '</CAJERO>'
	END
	
	IF ISNULL(@CAJA_COBRO,'') != ISNULL(@OLD_CAJA_COBRO,'')
	BEGIN
	  SET @DATOS_POR_CAMBIAR = @DATOS_POR_CAMBIAR + '<CAJA_COBRO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CAJA_COBRO) + '</CAJA_COBRO>'
	END
	
	IF ISNULL(@IMPUESTO1,0) != ISNULL(@OLD_IMPUESTO1,0)
	BEGIN
	  SET @DATOS_POR_CAMBIAR = @DATOS_POR_CAMBIAR + '<IMPUESTO1 Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@IMPUESTO1) + '</IMPUESTO1>'
	END
	
	IF ISNULL(@IMPUESTO2,0) != ISNULL(@OLD_IMPUESTO2,0)
	BEGIN
	  SET @DATOS_POR_CAMBIAR = @DATOS_POR_CAMBIAR + '<IMPUESTO2 Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@IMPUESTO2) + '</IMPUESTO2>'
	END
	
	IF ISNULL(@DESCUENTO,0) != ISNULL(@OLD_DESCUENTO,0)
	BEGIN
	  SET @DATOS_POR_CAMBIAR = @DATOS_POR_CAMBIAR + '<DESCUENTO Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@DESCUENTO) + '</DESCUENTO>'
	END
	
	IF ISNULL(@TOTAL_PAGAR,0) != ISNULL(@OLD_TOTAL_PAGAR,0)
	BEGIN
	  SET @DATOS_POR_CAMBIAR = @DATOS_POR_CAMBIAR + '<TOTAL_PAGAR Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@TOTAL_PAGAR) + '</TOTAL_PAGAR>'
	END
	
	IF ISNULL(@TOTAL,0) != ISNULL(@OLD_TOTAL,0)
	BEGIN
	  SET @DATOS_POR_CAMBIAR = @DATOS_POR_CAMBIAR + '<TOTAL Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@TOTAL) + '</TOTAL>'
	END
	
	IF ISNULL(@FCH_HORA_CREACION,'') != ISNULL(@OLD_FCH_HORA_CREACION,'')
	BEGIN
	  SET @DATOS_POR_CAMBIAR = @DATOS_POR_CAMBIAR + '<FCH_HORA_CREACION Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FCH_HORA_CREACION) + '</FCH_HORA_CREACION>'
	END
	
	IF ISNULL(@FCH_HORA_COBRO,'') != ISNULL(@OLD_FCH_HORA_COBRO,'')
	BEGIN
	  SET @DATOS_POR_CAMBIAR = @DATOS_POR_CAMBIAR + '<FCH_HORA_COBRO Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FCH_HORA_COBRO) + '</FCH_HORA_COBRO>'
	END
	
	IF ISNULL(@FCH_HORA_ANULA,'') != ISNULL(@OLD_FCH_HORA_ANULA,'')
	BEGIN
	  SET @DATOS_POR_CAMBIAR = @DATOS_POR_CAMBIAR + '<FCH_HORA_ANULA Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FCH_HORA_ANULA) + '</FCH_HORA_ANULA>'
	END
	
	IF ISNULL(@EXPORTADO,'') != ISNULL(@OLD_EXPORTADO,'')
	BEGIN
	  SET @DATOS_POR_CAMBIAR = @DATOS_POR_CAMBIAR + '<EXPORTADO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@EXPORTADO) + '</EXPORTADO>'
	END
	
	IF ISNULL(@ESTADO_COBRO,'') != ISNULL(@OLD_ESTADO_COBRO,'')
	BEGIN
	  SET @DATOS_POR_CAMBIAR = @DATOS_POR_CAMBIAR + '<ESTADO_COBRO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ESTADO_COBRO) + '</ESTADO_COBRO>'
	END
	
	IF ISNULL(@SALDO,0) != ISNULL(@OLD_SALDO,0)
	BEGIN
	  SET @DATOS_POR_CAMBIAR = @DATOS_POR_CAMBIAR + '<SALDO Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@SALDO) + '</SALDO>'
	END
	
	IF ISNULL(@FECHA_VENCE,'') != ISNULL(@OLD_FECHA_VENCE,'')
	BEGIN
	  SET @DATOS_POR_CAMBIAR = @DATOS_POR_CAMBIAR + '<FECHA_VENCE Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_VENCE) + '</FECHA_VENCE>'
	END
	
	IF ISNULL(@LISTO_INVENTARIO,'') != ISNULL(@OLD_LISTO_INVENTARIO,'')
	BEGIN
	  SET @DATOS_POR_CAMBIAR = @DATOS_POR_CAMBIAR + '<LISTO_INVENTARIO Type="VARCHAR">' + ERPADMIN.POS_ReemplazarCaracter(@LISTO_INVENTARIO) + '</LISTO_INVENTARIO>'
	END
	
	IF ISNULL(@NIVEL_PRECIO,'') != ISNULL(@OLD_NIVEL_PRECIO,'')
	BEGIN
	  SET @DATOS_POR_CAMBIAR = @DATOS_POR_CAMBIAR + '<NIVEL_PRECIO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NIVEL_PRECIO) + '</NIVEL_PRECIO>'
	END
	
	IF ISNULL(@MONEDA_NIVEL,'') != ISNULL(@OLD_MONEDA_NIVEL,'')
	BEGIN
	  SET @DATOS_POR_CAMBIAR = @DATOS_POR_CAMBIAR + '<MONEDA_NIVEL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@MONEDA_NIVEL) + '</MONEDA_NIVEL>'
	END
	
	IF ISNULL(@VERSION,0) != ISNULL(@OLD_VERSION,0)
	BEGIN
	  SET @DATOS_POR_CAMBIAR = @DATOS_POR_CAMBIAR + '<VERSION Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@VERSION) + '</VERSION>'
	END
	
	IF ISNULL(@FECHANAC_CLIENTE,'') != ISNULL(@OLD_FECHANAC_CLIENTE,'')
	BEGIN
	  SET @DATOS_POR_CAMBIAR = @DATOS_POR_CAMBIAR + '<FECHANAC_CLIENTE Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHANAC_CLIENTE) + '</FECHANAC_CLIENTE>'
	END
	
	IF ISNULL(@TELEFONO_CLIENTE,'') != ISNULL(@OLD_TELEFONO_CLIENTE,'')
	BEGIN
	  SET @DATOS_POR_CAMBIAR = @DATOS_POR_CAMBIAR + '<TELEFONO_CLIENTE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TELEFONO_CLIENTE) + '</TELEFONO_CLIENTE>'
	END
	
	IF ISNULL(@NIT_CLIENTE,'') != ISNULL(@OLD_NIT_CLIENTE,'')
	BEGIN
	  SET @DATOS_POR_CAMBIAR = @DATOS_POR_CAMBIAR + '<NIT_CLIENTE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NIT_CLIENTE) + '</NIT_CLIENTE>'
	END
	
	IF ISNULL(@PAIS,'') != ISNULL(@OLD_PAIS,'')
	BEGIN
	  SET @DATOS_POR_CAMBIAR = @DATOS_POR_CAMBIAR + '<PAIS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@PAIS) + '</PAIS>'
	END
	
	IF ISNULL(@CLASE_DOCUMENTO,'') != ISNULL(@OLD_CLASE_DOCUMENTO,'')
	BEGIN
	  SET @DATOS_POR_CAMBIAR = @DATOS_POR_CAMBIAR + '<CLASE_DOCUMENTO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CLASE_DOCUMENTO) + '</CLASE_DOCUMENTO>'
	END
	
	IF ISNULL(@CONDICION_PAGO_APA,'') != ISNULL(@OLD_CONDICION_PAGO_APA,'')
	BEGIN
	  SET @DATOS_POR_CAMBIAR = @DATOS_POR_CAMBIAR + '<CONDICION_PAGO_APA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CONDICION_PAGO_APA) + '</CONDICION_PAGO_APA>'
	END
	
	IF ISNULL(@DOC_CC,'') != ISNULL(@OLD_DOC_CC,'')
	BEGIN
	  SET @DATOS_POR_CAMBIAR = @DATOS_POR_CAMBIAR + '<DOC_CC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DOC_CC) + '</DOC_CC>'
	END
	
	IF ISNULL(@TIPO_DOC_CC,'') != ISNULL(@OLD_TIPO_DOC_CC,'')
	BEGIN
	  SET @DATOS_POR_CAMBIAR = @DATOS_POR_CAMBIAR + '<TIPO_DOC_CC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_DOC_CC) + '</TIPO_DOC_CC>'
	END
	
	IF ISNULL(@CARGADO_CC,'') != ISNULL(@OLD_CARGADO_CC,'')
	BEGIN
	  SET @DATOS_POR_CAMBIAR = @DATOS_POR_CAMBIAR + '<CARGADO_CC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CARGADO_CC) + '</CARGADO_CC>'
	END
	
	IF ISNULL(@CARGADO_CG,'') != ISNULL(@OLD_CARGADO_CG,'')
	BEGIN
	  SET @DATOS_POR_CAMBIAR = @DATOS_POR_CAMBIAR + '<CARGADO_CG Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CARGADO_CG) + '</CARGADO_CG>'
	END
	
	IF ISNULL(@DEVUELVE_DINERO,'') != ISNULL(@OLD_DEVUELVE_DINERO,'')
	BEGIN
	  SET @DATOS_POR_CAMBIAR = @DATOS_POR_CAMBIAR + '<DEVUELVE_DINERO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DEVUELVE_DINERO) + '</DEVUELVE_DINERO>'
	END
	
	IF ISNULL(@DOC_CC_ANUL,'') != ISNULL(@OLD_DOC_CC_ANUL,'')
	BEGIN
	  SET @DATOS_POR_CAMBIAR = @DATOS_POR_CAMBIAR + '<DOC_CC_ANUL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DOC_CC_ANUL) + '</DOC_CC_ANUL>'
	END
	
	IF ISNULL(@TIPO_DOC_CC_ANUL,'') != ISNULL(@OLD_TIPO_DOC_CC_ANUL,'')
	BEGIN
	  SET @DATOS_POR_CAMBIAR = @DATOS_POR_CAMBIAR + '<TIPO_DOC_CC_ANUL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_DOC_CC_ANUL) + '</TIPO_DOC_CC_ANUL>'
	END
	
	IF ISNULL(@GENERO_FACTURA_INICIO,'') != ISNULL(@OLD_GENERO_FACTURA_INICIO,'')
	BEGIN
	  SET @DATOS_POR_CAMBIAR = @DATOS_POR_CAMBIAR + '<GENERO_FACTURA_INICIO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@GENERO_FACTURA_INICIO) + '</GENERO_FACTURA_INICIO>'
	END
	
	IF ISNULL(@AFECTA_CONTABIL,'') != ISNULL(@OLD_AFECTA_CONTABIL,'')
	BEGIN
	  SET @DATOS_POR_CAMBIAR = @DATOS_POR_CAMBIAR + '<AFECTA_CONTABIL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@AFECTA_CONTABIL) + '</AFECTA_CONTABIL>'
	END
	
	IF ISNULL(@EFECTIVO_DEVUELTO,0) != ISNULL(@OLD_EFECTIVO_DEVUELTO,0)
	BEGIN
	  SET @DATOS_POR_CAMBIAR = @DATOS_POR_CAMBIAR + '<EFECTIVO_DEVUELTO Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@EFECTIVO_DEVUELTO) + '</EFECTIVO_DEVUELTO>'
	END
	
	IF ISNULL(@TIPO_CAMBIO,0) != ISNULL(@OLD_TIPO_CAMBIO,0)
	BEGIN
	  SET @DATOS_POR_CAMBIAR = @DATOS_POR_CAMBIAR + '<TIPO_CAMBIO Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@TIPO_CAMBIO) + '</TIPO_CAMBIO>'
	END
	
	IF ISNULL(@BENEFICIARIO,'') != ISNULL(@OLD_BENEFICIARIO,'')
	BEGIN
	  SET @DATOS_POR_CAMBIAR = @DATOS_POR_CAMBIAR + '<BENEFICIARIO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@BENEFICIARIO) + '</BENEFICIARIO>'
	END
	
	IF ISNULL(@MONEDA,'') != ISNULL(@OLD_MONEDA,'')
	BEGIN
	  SET @DATOS_POR_CAMBIAR = @DATOS_POR_CAMBIAR + '<MONEDA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@MONEDA) + '</MONEDA>'
	END
	
	IF ISNULL(@SUBTIPO,'') != ISNULL(@OLD_SUBTIPO,'')
	BEGIN
	  SET @DATOS_POR_CAMBIAR = @DATOS_POR_CAMBIAR + '<SUBTIPO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@SUBTIPO) + '</SUBTIPO>'
	END
	
	IF ISNULL(@ID_BENEFICIARIO,'') != ISNULL(@OLD_ID_BENEFICIARIO,'')
	BEGIN
	  SET @DATOS_POR_CAMBIAR = @DATOS_POR_CAMBIAR + '<ID_BENEFICIARIO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ID_BENEFICIARIO) + '</ID_BENEFICIARIO>'
	END
	
	IF ISNULL(@USUARIO_ULT_IMPRE,'') != ISNULL(@OLD_USUARIO_ULT_IMPRE,'')
	BEGIN
	  SET @DATOS_POR_CAMBIAR = @DATOS_POR_CAMBIAR + '<USUARIO_ULT_IMPRE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USUARIO_ULT_IMPRE) + '</USUARIO_ULT_IMPRE>'
	END
	
	IF ISNULL(@FCH_HORA_ULT_IMPRE,'') != ISNULL(@OLD_FCH_HORA_ULT_IMPRE,'')
	BEGIN
	  SET @DATOS_POR_CAMBIAR = @DATOS_POR_CAMBIAR + '<FCH_HORA_ULT_IMPRE Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FCH_HORA_ULT_IMPRE) + '</FCH_HORA_ULT_IMPRE>'
	END
	
	IF ISNULL(@USUARIO_APLICACION,'') != ISNULL(@OLD_USUARIO_APLICACION,'')
	BEGIN
	  SET @DATOS_POR_CAMBIAR = @DATOS_POR_CAMBIAR + '<USUARIO_APLICACION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USUARIO_APLICACION) + '</USUARIO_APLICACION>'
	END
	
	IF ISNULL(@FCH_HORA_APLICACIO,'') != ISNULL(@OLD_FCH_HORA_APLICACIO,'')
	BEGIN
	  SET @DATOS_POR_CAMBIAR = @DATOS_POR_CAMBIAR + '<FCH_HORA_APLICACIO Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FCH_HORA_APLICACIO) + '</FCH_HORA_APLICACIO>'
	END
	
	IF ISNULL(@USUARIO_ANULACION,'') != ISNULL(@OLD_USUARIO_ANULACION,'')
	BEGIN
	  SET @DATOS_POR_CAMBIAR = @DATOS_POR_CAMBIAR + '<USUARIO_ANULACION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USUARIO_ANULACION) + '</USUARIO_ANULACION>'
	END
	
	IF ISNULL(@ESTADO_IMPRESION,'') != ISNULL(@OLD_ESTADO_IMPRESION,'')
	BEGIN
	  SET @DATOS_POR_CAMBIAR = @DATOS_POR_CAMBIAR + '<ESTADO_IMPRESION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ESTADO_IMPRESION) + '</ESTADO_IMPRESION>'
	END
	
	IF ISNULL(@TELEFONO_BENEFICIA,'') != ISNULL(@OLD_TELEFONO_BENEFICIA,'')
	BEGIN
	  SET @DATOS_POR_CAMBIAR = @DATOS_POR_CAMBIAR + '<TELEFONO_BENEFICIA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TELEFONO_BENEFICIA) + '</TELEFONO_BENEFICIA>'
	END	
	
	IF ISNULL(@SALDO_REPORTE,0) != ISNULL(@OLD_SALDO_REPORTE,0)
	BEGIN
	  SET @DATOS_POR_CAMBIAR = @DATOS_POR_CAMBIAR + '<SALDO_REPORTE Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@SALDO_REPORTE) + '</SALDO_REPORTE>'
	END	
	
	IF ISNULL(@MONEDA_DOC,'') != ISNULL(@OLD_MONEDA_DOC,'')
	BEGIN
	  SET @DATOS_POR_CAMBIAR = @DATOS_POR_CAMBIAR + '<MONEDA_DOC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@MONEDA_DOC) + '</MONEDA_DOC>'
	END
	IF ISNULL(@NCF,'') != ISNULL(@OLD_NCF,'')
	BEGIN
	  SET @DATOS_POR_CAMBIAR = @DATOS_POR_CAMBIAR + '<NCF Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NCF) + '</NCF>'
	END
	IF ISNULL(@TIPO_NCF,'') != ISNULL(@OLD_TIPO_NCF,'')
	BEGIN
	  SET @DATOS_POR_CAMBIAR = @DATOS_POR_CAMBIAR + '<TIPO_NCF Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_NCF) + '</TIPO_NCF>'
	END
	IF ISNULL(@NUM_CIERRE,'') != ISNULL(@OLD_NUM_CIERRE,'')
	BEGIN
	  SET @DATOS_POR_CAMBIAR = @DATOS_POR_CAMBIAR + '<NUM_CIERRE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NUM_CIERRE) + '</NUM_CIERRE>'
	END
	IF ISNULL(@CORRELATIVO,'') != ISNULL(@OLD_CORRELATIVO,'')
	BEGIN
	  SET @DATOS_POR_CAMBIAR = @DATOS_POR_CAMBIAR + '<CORRELATIVO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CORRELATIVO) + '</CORRELATIVO>'
	END
	IF ISNULL(@RECIBIDO_DE,'') != ISNULL(@OLD_RECIBIDO_DE,'')
		BEGIN
		  SET @DATOS_POR_CAMBIAR = @DATOS_POR_CAMBIAR + '<RECIBIDO_DE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@RECIBIDO_DE) + '</RECIBIDO_DE>'
	END
	IF ISNULL(@RESOLUCION,'') != ISNULL(@OLD_RESOLUCION,'')
		BEGIN
		  SET @DATOS_POR_CAMBIAR = @DATOS_POR_CAMBIAR + '<RESOLUCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@RESOLUCION) + '</RESOLUCION>'
	END
	IF ISNULL(@COD_CLASE_DOC,'') != ISNULL(@OLD_COD_CLASE_DOC,'')
		BEGIN
		  SET @DATOS_POR_CAMBIAR = @DATOS_POR_CAMBIAR + '<COD_CLASE_DOC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@COD_CLASE_DOC) + '</COD_CLASE_DOC>'
	END
	IF ISNULL(@DOC_EXPRESS,'') != ISNULL(@OLD_DOC_EXPRESS,'')
		BEGIN
		  SET @DATOS_POR_CAMBIAR = @DATOS_POR_CAMBIAR + '<DOC_EXPRESS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DOC_EXPRESS) + '</DOC_EXPRESS>'
	END
	IF ISNULL(@MENSAJERO,'') != ISNULL(@OLD_MENSAJERO,'')
		BEGIN
		  SET @DATOS_POR_CAMBIAR = @DATOS_POR_CAMBIAR + '<MENSAJERO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@MENSAJERO) + '</MENSAJERO>'
	END
	IF ISNULL(@CLIENTE_EXPRESS,'') != ISNULL(@OLD_CLIENTE_EXPRESS,'')
		BEGIN
		  SET @DATOS_POR_CAMBIAR = @DATOS_POR_CAMBIAR + '<CLIENTE_EXPRESS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CLIENTE_EXPRESS) + '</CLIENTE_EXPRESS>'
	END
	IF ISNULL(@ENTREGA_EXPRSS_A,'') != ISNULL(@OLD_ENTREGA_EXPRSS_A,'')
		BEGIN
		  SET @DATOS_POR_CAMBIAR = @DATOS_POR_CAMBIAR + '<ENTREGA_EXPRSS_A Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ENTREGA_EXPRSS_A) + '</ENTREGA_EXPRSS_A>'
	END
	IF ISNULL(@ESTADO_EXPRESS,'') != ISNULL(@OLD_ESTADO_EXPRESS,'')
		BEGIN
		  SET @DATOS_POR_CAMBIAR = @DATOS_POR_CAMBIAR + '<ESTADO_EXPRESS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ESTADO_EXPRESS) + '</ESTADO_EXPRESS>'
	END
	IF ISNULL(@MONTO_ENTREGADO,0) != ISNULL(@OLD_MONTO_ENTREGADO,0)
		BEGIN
		  SET @DATOS_POR_CAMBIAR = @DATOS_POR_CAMBIAR + '<MONTO_ENTREGADO Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@MONTO_ENTREGADO) + '</MONTO_ENTREGADO>'
	END
	IF ISNULL(@MONTO_DEVUELTO,0) != ISNULL(@OLD_MONTO_DEVUELTO,0)
		BEGIN
		  SET @DATOS_POR_CAMBIAR = @DATOS_POR_CAMBIAR + '<MONTO_DEVUELTO Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@MONTO_DEVUELTO) + '</MONTO_DEVUELTO>'
	END
	IF ISNULL(@FCH_ENVIO,'') != ISNULL(@OLD_FCH_ENVIO,'')
		BEGIN
		  SET @DATOS_POR_CAMBIAR = @DATOS_POR_CAMBIAR + '<FCH_ENVIO Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FCH_ENVIO) + '</FCH_ENVIO>'
	END
	IF ISNULL(@FCH_ENTREGA,'') != ISNULL(@OLD_FCH_ENTREGA,'')
		BEGIN
		  SET @DATOS_POR_CAMBIAR = @DATOS_POR_CAMBIAR + '<FCH_ENTREGA Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FCH_ENTREGA) + '</FCH_ENTREGA>'
	END
	IF ISNULL(@MOTIV_CANCELA_EXPR,'') != ISNULL(@OLD_MOTIV_CANCELA_EXPR,'')
		BEGIN
		  SET @DATOS_POR_CAMBIAR = @DATOS_POR_CAMBIAR + '<MOTIV_CANCELA_EXPR Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@MOTIV_CANCELA_EXPR) + '</MOTIV_CANCELA_EXPR>'
	END
	IF ISNULL(@NOTA_EXPRESS,'') != ISNULL(@OLD_NOTA_EXPRESS,'')
		BEGIN
		  SET @DATOS_POR_CAMBIAR = @DATOS_POR_CAMBIAR + '<NOTA_EXPRESS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOTA_EXPRESS) + '</NOTA_EXPRESS>'
	END
	
	IF ISNULL(@BASE_IMPUESTO1,0) != ISNULL(@OLD_BASE_IMPUESTO1,0)
		BEGIN
		  SET @DATOS_POR_CAMBIAR = @DATOS_POR_CAMBIAR + '<BASE_IMPUESTO1 Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@BASE_IMPUESTO1) + '</BASE_IMPUESTO1>'
	END
	
	IF ISNULL(@BASE_IMPUESTO2,0) != ISNULL(@OLD_BASE_IMPUESTO2,0)
		BEGIN
		  SET @DATOS_POR_CAMBIAR = @DATOS_POR_CAMBIAR + '<BASE_IMPUESTO2 Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@BASE_IMPUESTO2) + '</BASE_IMPUESTO2>'
	END
	
	IF ISNULL(@DOC_FISCAL,'') != ISNULL(@OLD_DOC_FISCAL,'')
	BEGIN
		SET @DATOS_POR_CAMBIAR = @DATOS_POR_CAMBIAR + '<DOC_FISCAL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DOC_FISCAL) + '</DOC_FISCAL>'
	END
   
	IF ISNULL(@PREFIJO,'') != ISNULL(@OLD_PREFIJO,'')
	BEGIN
		SET @DATOS_POR_CAMBIAR = @DATOS_POR_CAMBIAR + '<PREFIJO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@PREFIJO) + '</PREFIJO>'
	END

	IF ISNULL(@PEDIDO_AUTORIZADO,'') != ISNULL(@OLD_PEDIDO_AUTORIZADO,'')
	BEGIN
		SET @DATOS_POR_CAMBIAR = @DATOS_POR_CAMBIAR + '<PEDIDO_AUTORIZADO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@PEDIDO_AUTORIZADO) + '</PEDIDO_AUTORIZADO>'
	END
	
	IF ISNULL(@DOC_CC_ANTICIPO,'') != ISNULL(@OLD_DOC_CC_ANTICIPO,'')
	BEGIN
		SET @DATOS_POR_CAMBIAR = @DATOS_POR_CAMBIAR + '<DOC_CC_ANTICIPO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DOC_CC_ANTICIPO) + '</DOC_CC_ANTICIPO>'
	END
	
	IF ISNULL(@NOMBREMAQUINA,'') != ISNULL(@OLD_NOMBREMAQUINA,'')
	BEGIN
		SET @DATOS_POR_CAMBIAR = @DATOS_POR_CAMBIAR + '<NOMBREMAQUINA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOMBREMAQUINA) + '</NOMBREMAQUINA>'
	END
	
	IF @DATOS_POR_CAMBIAR <> ''
	BEGIN
	  SET @PARAMETROS = @PARAMETROS + @DATOS_POR_CAMBIAR
	  SET @HAY_DATOS = 'S'
	END
	IF @HAY_DATOS = 'S'
	BEGIN
	  SET @PARAMETROS = 
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<DOCUMENTO_POS>' + @PARAMETROS + '</DOCUMENTO_POS>'
	  -- inserta la solicitud correspondiente
	  EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 
                                         'DOCUMENTOPOSPOS600', 
                                         'MODIFICA',
                                         @PARAMETROS,
                                         0,
                                         ''
	END
      END
      FETCH NEXT FROM C_MODIFIED
      INTO @DOCUMENTO, 
      @CAJA, 
      @TIPO, 
      @PERFIL, 
      @VENDEDOR, 
      @CLIENTE, 
      @NOMBRE_CLIENTE, 
      @CAJERO, 
      @CAJA_COBRO, 
      @IMPUESTO1, 
      @IMPUESTO2, 
      @DESCUENTO, 
      @TOTAL_PAGAR, 
      @TOTAL, 
      @FCH_HORA_CREACION, 
      @FCH_HORA_COBRO, 
      @FCH_HORA_ANULA, 
      @EXPORTADO, 
      @ESTADO_COBRO, 
      @SALDO, 
      @FECHA_VENCE, 
      @LISTO_INVENTARIO, 
      @NIVEL_PRECIO, 
      @MONEDA_NIVEL, 
      @VERSION, 
      @FECHANAC_CLIENTE, 
      @TELEFONO_CLIENTE, 
      @NIT_CLIENTE, 
      @PAIS, 
      @CLASE_DOCUMENTO, 
      @CONDICION_PAGO_APA, 
      @DOC_CC, 
      @TIPO_DOC_CC, 
      @CARGADO_CC, 
      @CARGADO_CG, 
      @DEVUELVE_DINERO, 
      @DOC_CC_ANUL, 
      @TIPO_DOC_CC_ANUL, 
      @GENERO_FACTURA_INICIO, 
      @AFECTA_CONTABIL, 
      @EFECTIVO_DEVUELTO, 
      @TIPO_CAMBIO, 
      @BENEFICIARIO, 
      @MONEDA, 
      @SUBTIPO, 
      @ID_BENEFICIARIO, 
      @USUARIO_ULT_IMPRE, 
      @FCH_HORA_ULT_IMPRE, 
      @USUARIO_APLICACION, 
      @FCH_HORA_APLICACIO, 
      @USUARIO_ANULACION, 
      @ESTADO_IMPRESION, 
      @TELEFONO_BENEFICIA, 
      @SALDO_REPORTE,
      @MONEDA_DOC,
      @NCF,
      @TIPO_NCF,
      @NUM_CIERRE,
      @CORRELATIVO,
      @RECIBIDO_DE,
      @RESOLUCION,
      @COD_CLASE_DOC,
      @DOC_EXPRESS,
      @MENSAJERO,
      @CLIENTE_EXPRESS,
      @ENTREGA_EXPRSS_A,
      @ESTADO_EXPRESS,
      @MONTO_ENTREGADO,
      @MONTO_DEVUELTO,
      @FCH_ENVIO,
      @FCH_ENTREGA,
      @MOTIV_CANCELA_EXPR,
      @NOTA_EXPRESS,
      @BASE_IMPUESTO1,
      @BASE_IMPUESTO2,
      @DOC_FISCAL,
      @PREFIJO,
      @PEDIDO_AUTORIZADO,
      @DOC_CC_ANTICIPO,
      @NOMBREMAQUINA,
      @OLD_DOCUMENTO, 
      @OLD_CAJA, 
      @OLD_TIPO, 
      @OLD_PERFIL, 
      @OLD_VENDEDOR, 
      @OLD_CLIENTE, 
      @OLD_NOMBRE_CLIENTE, 
      @OLD_CAJERO, 
      @OLD_CAJA_COBRO, 
      @OLD_IMPUESTO1, 
      @OLD_IMPUESTO2, 
      @OLD_DESCUENTO, 
      @OLD_TOTAL_PAGAR, 
      @OLD_TOTAL, 
      @OLD_FCH_HORA_CREACION, 
      @OLD_FCH_HORA_COBRO, 
      @OLD_FCH_HORA_ANULA, 
      @OLD_EXPORTADO, 
      @OLD_ESTADO_COBRO, 
      @OLD_SALDO, 
      @OLD_FECHA_VENCE, 
      @OLD_LISTO_INVENTARIO, 
      @OLD_NIVEL_PRECIO, 
      @OLD_MONEDA_NIVEL, 
      @OLD_VERSION, 
      @OLD_FECHANAC_CLIENTE, 
      @OLD_TELEFONO_CLIENTE, 
      @OLD_NIT_CLIENTE, 
      @OLD_PAIS, 
      @OLD_CLASE_DOCUMENTO, 
      @OLD_CONDICION_PAGO_APA, 
      @OLD_DOC_CC, 
      @OLD_TIPO_DOC_CC, 
      @OLD_CARGADO_CC, 
      @OLD_CARGADO_CG, 
      @OLD_DEVUELVE_DINERO, 
      @OLD_DOC_CC_ANUL, 
      @OLD_TIPO_DOC_CC_ANUL, 
      @OLD_GENERO_FACTURA_INICIO, 
      @OLD_AFECTA_CONTABIL, 
      @OLD_EFECTIVO_DEVUELTO, 
      @OLD_TIPO_CAMBIO, 
      @OLD_BENEFICIARIO, 
      @OLD_MONEDA, 
      @OLD_SUBTIPO, 
      @OLD_ID_BENEFICIARIO, 
      @OLD_USUARIO_ULT_IMPRE, 
      @OLD_FCH_HORA_ULT_IMPRE, 
      @OLD_USUARIO_APLICACION, 
      @OLD_FCH_HORA_APLICACIO, 
      @OLD_USUARIO_ANULACION, 
      @OLD_ESTADO_IMPRESION, 
      @OLD_TELEFONO_BENEFICIA, 
      @OLD_SALDO_REPORTE,
      @OLD_MONEDA_DOC,
      @OLD_NCF,
      @OLD_TIPO_NCF,
      @OLD_NUM_CIERRE,
      @OLD_CORRELATIVO,
      @OLD_RECIBIDO_DE,
      @OLD_RESOLUCION,
      @OLD_COD_CLASE_DOC,
      @OLD_DOC_EXPRESS,
      @OLD_MENSAJERO,
      @OLD_CLIENTE_EXPRESS,
      @OLD_ENTREGA_EXPRSS_A,
      @OLD_ESTADO_EXPRESS,
      @OLD_MONTO_ENTREGADO,
      @OLD_MONTO_DEVUELTO,
      @OLD_FCH_ENVIO,
      @OLD_FCH_ENTREGA,
      @OLD_MOTIV_CANCELA_EXPR,
      @OLD_NOTA_EXPRESS,
      @OLD_BASE_IMPUESTO1,
      @OLD_BASE_IMPUESTO2,
      @OLD_DOC_FISCAL,
      @OLD_PREFIJO,
      @OLD_PEDIDO_AUTORIZADO,
      @OLD_DOC_CC_ANTICIPO,
      @OLD_NOMBREMAQUINA,
      @PARAMETROS
	--Dejar sólo los campos que se dejaron en la declaración
	--Asegurarse que las variables tengan el mismo orden que el select
	--del cursor
    END
   CLOSE C_MODIFIED
   DEALLOCATE C_MODIFIED
  END
  IF (@@ERROR <> 0 OR @ERROR <> 0) 
   BEGIN
     RAISERROR( 'Error generando la solicitud de servicio para modificar la tabla DOCUMENTO_POS.',16,1 )
   END
END;






CREATE TRIGGER $$Compania$$.DOCUMENTO_POS_POS_DEL
ON $$Compania$$.DOCUMENTO_POS
FOR DELETE  
AS 
BEGIN   	
        DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @TIPO_SITIO_LOCAL VARCHAR(1)
	DECLARE @DOCUMENTO VARCHAR(50)
	DECLARE @CAJA VARCHAR(6)
	DECLARE @TIPO VARCHAR(1)
	 -- Declaraciones	
	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM ,
		@TIPO_SITIO_LOCAL = TIPO_SITIO_LOCAL
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM) AND @TIPO_SITIO_LOCAL = 'T'
	BEGIN
		DECLARE C_DELETED CURSOR LOCAL FOR
			SELECT DOCUMENTO, CAJA, TIPO
			FROM DELETED d
			WHERE 0 = (
				SELECT COUNT('n')
				FROM INSERTED i
				WHERE d.DOCUMENTO = i.DOCUMENTO AND d.CAJA = i.CAJA AND d.TIPO = i.TIPO
			   )
		OPEN C_DELETED
		FETCH NEXT FROM C_DELETED INTO 
		@DOCUMENTO, @CAJA, @TIPO
		
		SET @ERROR = 0
		
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS = 
								'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<DOCUMENTO_POS>' + 
				'<DOCUMENTO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@DOCUMENTO) + '</DOCUMENTO>' + 
				'<CAJA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CAJA) + '</CAJA>' + 
				'<TIPO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO) + '</TIPO>' + 
				'</DOCUMENTO_POS>'
 -- XML
			
			-- inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'DOCUMENTOPOSPOS600', 'ELIMINA', @PARAMETROS, 0, ''
			
			FETCH NEXT FROM C_DELETED INTO 
			@DOCUMENTO, @CAJA, @TIPO
		END
		CLOSE C_DELETED
		DEALLOCATE C_DELETED
	END
	
	IF (@@ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para eliminar de la tabla DOCUMENTO_POS.',16,1 )
	END
END;





CREATE TRIGGER $$Compania$$.DOC_POS_LINEA_POS_INS
ON $$Compania$$.DOC_POS_LINEA
FOR INSERT
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @MODULO_OFFLINE INT
	DECLARE @LINEA VARCHAR(4)
	DECLARE @DOCUMENTO VARCHAR(50)
	DECLARE @CAJA VARCHAR(6)
	DECLARE @TIPO VARCHAR(1)
	DECLARE @ARTICULO VARCHAR(20)
	DECLARE @LOTE VARCHAR(15)
	DECLARE @CANTIDAD DECIMAL(28,8)
	DECLARE @PRECIO_VENTA DECIMAL(28,8)
	DECLARE @DESCUENTO_LINEA DECIMAL(28,8)
	DECLARE @DESCUENTO_GENERAL DECIMAL(28,8)
	DECLARE @TOTAL_IMPUESTO1 DECIMAL(28,8)
	DECLARE @TOTAL_IMPUESTO2 DECIMAL(28,8)
	DECLARE @LEYENDA VARCHAR(254)
	DECLARE @CANT_RESERVADA_PED DECIMAL(28,8)
	DECLARE @BODEGA VARCHAR(4)
	DECLARE @PEDIDO VARCHAR(55)
	DECLARE @LOCALIZACION VARCHAR(8)
	DECLARE @BASE_IMPUESTO1 DECIMAL(28,8)
	DECLARE @BASE_IMPUESTO2 DECIMAL(28,8)
	DECLARE @NOTAS VARCHAR(4000)
	DECLARE @MONTO_RETENCION DECIMAL(28,8)
	
	
	SELECT @MODULO_OFFLINE = COUNT(0)
	FROM ERPADMIN.MODULO_INSTALADO
	WHERE CONJUNTO = '$$Compania$$'
	AND ACCION = 3159

	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM 
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF @MODULO_OFFLINE  = 1 AND NOT (SYSTEM_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_INSERTED CURSOR LOCAL FOR
		SELECT LINEA, DOCUMENTO, CAJA, TIPO, ARTICULO, LOTE, CANTIDAD, PRECIO_VENTA, DESCUENTO_LINEA, DESCUENTO_GENERAL, TOTAL_IMPUESTO1, TOTAL_IMPUESTO2, LEYENDA, CANT_RESERVADA_PED, BODEGA, PEDIDO, LOCALIZACION, BASE_IMPUESTO1, BASE_IMPUESTO2, NOTAS, MONTO_RETENCION
		FROM INSERTED
				
		OPEN C_INSERTED	
		FETCH NEXT FROM C_INSERTED INTO
		@LINEA, @DOCUMENTO, @CAJA, @TIPO, @ARTICULO, @LOTE, @CANTIDAD, @PRECIO_VENTA, @DESCUENTO_LINEA, @DESCUENTO_GENERAL, @TOTAL_IMPUESTO1, @TOTAL_IMPUESTO2, @LEYENDA, @CANT_RESERVADA_PED, @BODEGA, @PEDIDO, @LOCALIZACION, @BASE_IMPUESTO1, @BASE_IMPUESTO2, @NOTAS, @MONTO_RETENCION

		SET @ERROR = 0
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS = 
			'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<DOC_POS_LINEA>' + 
				'<LINEA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@LINEA) + '</LINEA>' + 
				'<DOCUMENTO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@DOCUMENTO) + '</DOCUMENTO>' + 
				'<CAJA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CAJA) + '</CAJA>' + 
				'<TIPO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO) + '</TIPO>' + 
				'<ARTICULO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ARTICULO) + '</ARTICULO>' + 
				'<LOTE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@LOTE) + '</LOTE>' + 
				'<CANTIDAD Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@CANTIDAD) + '</CANTIDAD>' + 
				'<PRECIO_VENTA Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@PRECIO_VENTA) + '</PRECIO_VENTA>' + 
				'<DESCUENTO_LINEA Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@DESCUENTO_LINEA) + '</DESCUENTO_LINEA>' + 
				'<DESCUENTO_GENERAL Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@DESCUENTO_GENERAL) + '</DESCUENTO_GENERAL>' + 
				'<TOTAL_IMPUESTO1 Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@TOTAL_IMPUESTO1) + '</TOTAL_IMPUESTO1>' + 
				'<TOTAL_IMPUESTO2 Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@TOTAL_IMPUESTO2) + '</TOTAL_IMPUESTO2>' + 
				'<LEYENDA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@LEYENDA) + '</LEYENDA>' + 
				'<CANT_RESERVADA_PED Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@CANT_RESERVADA_PED) + '</CANT_RESERVADA_PED>' + 
				'<BODEGA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@BODEGA) + '</BODEGA>' + 
				'<PEDIDO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@PEDIDO) + '</PEDIDO>' + 
				'<LOCALIZACION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@LOCALIZACION) + '</LOCALIZACION>' + 
				'<BASE_IMPUESTO1 Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@BASE_IMPUESTO1) + '</BASE_IMPUESTO1>' + 
				'<BASE_IMPUESTO2 Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@BASE_IMPUESTO2) + '</BASE_IMPUESTO2>' + 
				'<NOTAS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOTAS) + '</NOTAS>' + 
				'<MONTO_RETENCION Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@MONTO_RETENCION) + '</MONTO_RETENCION>' + 
				'</DOC_POS_LINEA>'


			-- Inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'DOCPOSLINEAPOS600', 'INSERTA', @PARAMETROS, 0, ''

			FETCH NEXT FROM C_INSERTED INTO
			@LINEA, @DOCUMENTO, @CAJA, @TIPO, @ARTICULO, @LOTE, @CANTIDAD, @PRECIO_VENTA, @DESCUENTO_LINEA, @DESCUENTO_GENERAL, @TOTAL_IMPUESTO1, @TOTAL_IMPUESTO2, @LEYENDA, @CANT_RESERVADA_PED, @BODEGA, @PEDIDO, @LOCALIZACION, @BASE_IMPUESTO1, @BASE_IMPUESTO2, @NOTAS, @MONTO_RETENCION
		END

		CLOSE C_INSERTED
    		DEALLOCATE C_INSERTED
	END

	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla DOC_POS_LINEA.',16,1 )
	END
END;



CREATE TRIGGER $$Compania$$.DOC_POS_LINEA_POS_DEL
ON $$Compania$$.DOC_POS_LINEA
FOR DELETE
AS
BEGIN   	
        DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @TIPO_SITIO_LOCAL VARCHAR(1)
	DECLARE @LINEA VARCHAR(4)
	DECLARE @DOCUMENTO VARCHAR(50)
	DECLARE @CAJA VARCHAR(6)
	DECLARE @TIPO VARCHAR(1)
	 -- Declaraciones	
	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM ,
		@TIPO_SITIO_LOCAL = TIPO_SITIO_LOCAL
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM) AND @TIPO_SITIO_LOCAL = 'T'
	BEGIN
		DECLARE C_DELETED CURSOR LOCAL FOR
			SELECT LINEA, DOCUMENTO, CAJA, TIPO
			FROM DELETED d
			WHERE 0 = (
				SELECT COUNT('n')
				FROM INSERTED i
				WHERE d.LINEA = i.LINEA AND d.DOCUMENTO = i.DOCUMENTO AND d.CAJA = i.CAJA AND d.TIPO = i.TIPO
			   )
		OPEN C_DELETED
		FETCH NEXT FROM C_DELETED INTO
		@LINEA, @DOCUMENTO, @CAJA, @TIPO
		
		SET @ERROR = 0
		
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS =
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<DOC_POS_LINEA>' +
				'<LINEA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@LINEA) + '</LINEA>' +
				'<DOCUMENTO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@DOCUMENTO) + '</DOCUMENTO>' +
				'<CAJA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CAJA) + '</CAJA>' +
				'<TIPO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO) + '</TIPO>' +
				'</DOC_POS_LINEA>'
 -- XML
			
			-- inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'DOCPOSLINEAPOS600', 'ELIMINA', @PARAMETROS, 0, ''
			
			FETCH NEXT FROM C_DELETED INTO
			@LINEA, @DOCUMENTO, @CAJA, @TIPO
		END
		CLOSE C_DELETED
		DEALLOCATE C_DELETED
	END
	
	IF (@@ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para eliminar de la tabla DOC_POS_LINEA.',16,1 )
	END
END;




CREATE TRIGGER $$Compania$$.DOC_POS_LINEA_POS_MOD
ON $$Compania$$.DOC_POS_LINEA
FOR UPDATE
AS 
BEGIN   	
	DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @COL_ROWPOINTER VARCHAR(36)
	DECLARE @HAY_CAMPOS_PARA_POS BIT
	DECLARE @ACTUALIZAR_SOLICITUD BIT
	DECLARE @MODULO_OFFLINE INT
	DECLARE @LINEA VARCHAR(4)
	DECLARE @DOCUMENTO VARCHAR(50)
	DECLARE @CAJA VARCHAR(6)
	DECLARE @TIPO VARCHAR(1)
	DECLARE @ARTICULO VARCHAR(20)
	DECLARE @LOTE VARCHAR(15)
	DECLARE @CANTIDAD DECIMAL(28,8)
	DECLARE @PRECIO_VENTA DECIMAL(28,8)
	DECLARE @DESCUENTO_LINEA DECIMAL(28,8)
	DECLARE @DESCUENTO_GENERAL DECIMAL(28,8)
	DECLARE @TOTAL_IMPUESTO1 DECIMAL(28,8)
	DECLARE @TOTAL_IMPUESTO2 DECIMAL(28,8)
	DECLARE @LEYENDA VARCHAR(254)
	DECLARE @CANT_RESERVADA_PED DECIMAL(28,8)
	DECLARE @BODEGA VARCHAR(4)
	DECLARE @PEDIDO VARCHAR(55)
	DECLARE @LOCALIZACION VARCHAR(8)
	DECLARE @BASE_IMPUESTO1 DECIMAL(28,8)
	DECLARE @BASE_IMPUESTO2 DECIMAL(28,8)
	DECLARE @NOTAS VARCHAR(4000)
	DECLARE @MONTO_RETENCION DECIMAL(28,8)
	 -- Declaraciones

	SET @ERROR = 0
	
	SELECT @MODULO_OFFLINE = COUNT(0)
	FROM ERPADMIN.MODULO_INSTALADO
	WHERE CONJUNTO = '$$Compania$$'
	AND ACCION = 3159

	SELECT @PUBLICADOR = SITIO_LOCAL, @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF @MODULO_OFFLINE  = 1 AND NOT (SYSTEM_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_MODIFIED CURSOR LOCAL FOR
			SELECT LINEA, DOCUMENTO, CAJA, TIPO, ARTICULO, LOTE, CANTIDAD, PRECIO_VENTA, DESCUENTO_LINEA, DESCUENTO_GENERAL, TOTAL_IMPUESTO1, TOTAL_IMPUESTO2, LEYENDA, CANT_RESERVADA_PED, BODEGA, PEDIDO, LOCALIZACION, BASE_IMPUESTO1, BASE_IMPUESTO2, NOTAS, MONTO_RETENCION -- Columnas
			FROM INSERTED I

		SET @ACTUALIZAR_SOLICITUD = 1

		OPEN C_MODIFIED

		FETCH NEXT FROM C_MODIFIED
		INTO @LINEA, @DOCUMENTO, @CAJA, @TIPO, @ARTICULO, @LOTE, @CANTIDAD, @PRECIO_VENTA, @DESCUENTO_LINEA, @DESCUENTO_GENERAL, @TOTAL_IMPUESTO1, @TOTAL_IMPUESTO2, @LEYENDA, @CANT_RESERVADA_PED, @BODEGA, @PEDIDO, @LOCALIZACION, @BASE_IMPUESTO1, @BASE_IMPUESTO2, @NOTAS, @MONTO_RETENCION

		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			IF ( NOT UPDATE(RECORDDATE) AND ( UPDATE(LINEA) OR UPDATE(DOCUMENTO) OR UPDATE(CAJA) OR UPDATE(TIPO) OR UPDATE(ARTICULO) OR UPDATE(LOTE) OR UPDATE(CANTIDAD) OR UPDATE(PRECIO_VENTA) OR UPDATE(DESCUENTO_LINEA) OR UPDATE(DESCUENTO_GENERAL) OR UPDATE(TOTAL_IMPUESTO1) OR UPDATE(TOTAL_IMPUESTO2) OR UPDATE(LEYENDA) OR UPDATE(CANT_RESERVADA_PED) OR UPDATE(BODEGA) OR UPDATE(PEDIDO) OR UPDATE(LOCALIZACION) OR UPDATE(BASE_IMPUESTO1) OR UPDATE(BASE_IMPUESTO2) OR UPDATE(NOTAS) OR UPDATE(MONTO_RETENCION) ) )
			BEGIN

				SELECT @COL_ROWPOINTER = ROWPOINTER 
				FROM $$Compania$$.DOC_POS_LINEA
				WHERE LINEA = @LINEA AND DOCUMENTO = @DOCUMENTO AND CAJA = @CAJA AND TIPO = @TIPO 

				SET @PARAMETROS =
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<DOC_POS_LINEA>' + 
				'<LINEA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@LINEA) + '</LINEA>' + 
				'<DOCUMENTO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@DOCUMENTO) + '</DOCUMENTO>' + 
				'<CAJA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CAJA) + '</CAJA>' + 
				'<TIPO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO) + '</TIPO>' + 
				'<ARTICULO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ARTICULO) + '</ARTICULO>' + 
				'<LOTE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@LOTE) + '</LOTE>' + 
				'<CANTIDAD Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@CANTIDAD) + '</CANTIDAD>' + 
				'<PRECIO_VENTA Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@PRECIO_VENTA) + '</PRECIO_VENTA>' + 
				'<DESCUENTO_LINEA Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@DESCUENTO_LINEA) + '</DESCUENTO_LINEA>' + 
				'<DESCUENTO_GENERAL Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@DESCUENTO_GENERAL) + '</DESCUENTO_GENERAL>' + 
				'<TOTAL_IMPUESTO1 Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@TOTAL_IMPUESTO1) + '</TOTAL_IMPUESTO1>' + 
				'<TOTAL_IMPUESTO2 Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@TOTAL_IMPUESTO2) + '</TOTAL_IMPUESTO2>' + 
				'<LEYENDA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@LEYENDA) + '</LEYENDA>' + 
				'<CANT_RESERVADA_PED Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@CANT_RESERVADA_PED) + '</CANT_RESERVADA_PED>' + 
				'<BODEGA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@BODEGA) + '</BODEGA>' + 
				'<PEDIDO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@PEDIDO) + '</PEDIDO>' + 
				'<LOCALIZACION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@LOCALIZACION) + '</LOCALIZACION>' + 
				'<BASE_IMPUESTO1 Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@BASE_IMPUESTO1) + '</BASE_IMPUESTO1>' + 
				'<BASE_IMPUESTO2 Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@BASE_IMPUESTO2) + '</BASE_IMPUESTO2>' + 
				'<NOTAS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOTAS) + '</NOTAS>' + 
				'<MONTO_RETENCION Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@MONTO_RETENCION) + '</MONTO_RETENCION>' + 
				'</DOC_POS_LINEA>'


				-- inserta la solicitud correspondiente
				EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'DOCPOSLINEAPOS600', 'MODIFICA', @PARAMETROS, @ACTUALIZAR_SOLICITUD, @COL_ROWPOINTER
			END

			FETCH NEXT FROM C_MODIFIED
			INTO @LINEA, @DOCUMENTO, @CAJA, @TIPO, @ARTICULO, @LOTE, @CANTIDAD, @PRECIO_VENTA, @DESCUENTO_LINEA, @DESCUENTO_GENERAL, @TOTAL_IMPUESTO1, @TOTAL_IMPUESTO2, @LEYENDA, @CANT_RESERVADA_PED, @BODEGA, @PEDIDO, @LOCALIZACION, @BASE_IMPUESTO1, @BASE_IMPUESTO2, @NOTAS, @MONTO_RETENCION
		END

		CLOSE C_MODIFIED
		DEALLOCATE C_MODIFIED
	END

	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para modificar la tabla DOC_POS_LINEA.',16,1 )
	END
END;






CREATE TRIGGER $$Compania$$.ENTIDAD_FINANCIERA_POS_INS
ON $$Compania$$.ENTIDAD_FINANCIERA
FOR INSERT
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @ENTIDAD_FINANCIERA VARCHAR(8)
	DECLARE @NIT VARCHAR(20)
	DECLARE @DESCRIPCION VARCHAR(40)
	
	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_INSERTED CURSOR LOCAL FOR
		SELECT ENTIDAD_FINANCIERA, NIT, DESCRIPCION
		FROM INSERTED i
		WHERE 0 = (
				SELECT COUNT('n')
				FROM DELETED d
				WHERE i.ENTIDAD_FINANCIERA = d.ENTIDAD_FINANCIERA
			   )
			
		OPEN C_INSERTED	
		FETCH NEXT FROM C_INSERTED INTO
		@ENTIDAD_FINANCIERA, @NIT, @DESCRIPCION
		SET @ERROR = 0
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS =
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<ENTIDAD_FINANCIERA>' +
				'<ENTIDAD_FINANCIERA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@ENTIDAD_FINANCIERA) + '</ENTIDAD_FINANCIERA>' +
				'<NIT Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NIT) + '</NIT>' +
				'<DESCRIPCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DESCRIPCION) + '</DESCRIPCION>' +
				'</ENTIDAD_FINANCIERA>'
			-- Inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'ENTIDADFINANCIERAPOS600', 'INSERTA', @PARAMETROS, 0, ''
			FETCH NEXT FROM C_INSERTED INTO
			@ENTIDAD_FINANCIERA, @NIT, @DESCRIPCION
		END
		CLOSE C_INSERTED
    		DEALLOCATE C_INSERTED
	END
	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla ENTIDAD_FINANCIERA.',16,1 )
	END
END
;




CREATE TRIGGER $$Compania$$.ENTIDAD_FINANCIERA_POS_DEL
ON $$Compania$$.ENTIDAD_FINANCIERA
FOR DELETE
AS
BEGIN   	
                DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @ENTIDAD_FINANCIERA VARCHAR(8)
	 -- Declaraciones	
	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_DELETED CURSOR LOCAL FOR
			SELECT ENTIDAD_FINANCIERA
			FROM DELETED d
			WHERE 0 = (
				SELECT COUNT('n')
				FROM INSERTED i
				WHERE d.ENTIDAD_FINANCIERA = i.ENTIDAD_FINANCIERA
			   )
		OPEN C_DELETED
		FETCH NEXT FROM C_DELETED INTO
		@ENTIDAD_FINANCIERA
		
		SET @ERROR = 0
		
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS =
								'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<ENTIDAD_FINANCIERA>' +
				'<ENTIDAD_FINANCIERA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@ENTIDAD_FINANCIERA) + '</ENTIDAD_FINANCIERA>' +
				'</ENTIDAD_FINANCIERA>'
 -- XML
			
			-- inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'ENTIDADFINANCIERAPOS600', 'ELIMINA', @PARAMETROS, 0, ''
			
			FETCH NEXT FROM C_DELETED INTO
			@ENTIDAD_FINANCIERA
		END
		CLOSE C_DELETED
		DEALLOCATE C_DELETED
	END
	
	IF (@@ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para eliminar de la tabla ENTIDAD_FINANCIERA.',16,1 )
	END
END
;



CREATE TRIGGER $$Compania$$.ENTIDAD_FINANCIERA_POS_MOD
ON $$Compania$$.ENTIDAD_FINANCIERA
FOR UPDATE
AS
BEGIN   	
	DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @COL_ROWPOINTER VARCHAR(36)
	DECLARE @HAY_CAMPOS_PARA_POS BIT
	DECLARE @ACTUALIZAR_SOLICITUD BIT
	DECLARE @ENTIDAD_FINANCIERA VARCHAR(8)
	DECLARE @NIT VARCHAR(20)
	DECLARE @DESCRIPCION VARCHAR(40)
	 -- Declaraciones
	SET @ERROR = 0
	SELECT @PUBLICADOR = SITIO_LOCAL, @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_MODIFIED CURSOR LOCAL FOR
			SELECT ENTIDAD_FINANCIERA, NIT, DESCRIPCION -- Columnas
			FROM INSERTED I
		SET @ACTUALIZAR_SOLICITUD = 1
		OPEN C_MODIFIED
		FETCH NEXT FROM C_MODIFIED
		INTO @ENTIDAD_FINANCIERA, @NIT, @DESCRIPCION
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			IF ( NOT UPDATE(RECORDDATE) AND ( UPDATE(ENTIDAD_FINANCIERA) OR UPDATE(NIT) OR UPDATE(DESCRIPCION) ) )
			BEGIN
				SELECT @COL_ROWPOINTER = ROWPOINTER
				FROM $$Compania$$.ENTIDAD_FINANCIERA
				WHERE ENTIDAD_FINANCIERA = @ENTIDAD_FINANCIERA
				SET @PARAMETROS =
					'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<ENTIDAD_FINANCIERA>' +
				'<ENTIDAD_FINANCIERA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@ENTIDAD_FINANCIERA) + '</ENTIDAD_FINANCIERA>' +
				'<NIT Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NIT) + '</NIT>' +
				'<DESCRIPCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DESCRIPCION) + '</DESCRIPCION>' +
				'</ENTIDAD_FINANCIERA>'
				-- inserta la solicitud correspondiente
				EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'ENTIDADFINANCIERAPOS600', 'MODIFICA', @PARAMETROS, @ACTUALIZAR_SOLICITUD, @COL_ROWPOINTER
			END
			FETCH NEXT FROM C_MODIFIED
			INTO @ENTIDAD_FINANCIERA, @NIT, @DESCRIPCION
		END
		CLOSE C_MODIFIED
		DEALLOCATE C_MODIFIED
	END
	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para modificar la tabla ENTIDAD_FINANCIERA.',16,1 )
	END
END
;





CREATE TRIGGER $$Compania$$.ESCALA_BONIF_POS_INS
ON $$Compania$$.ESCALA_BONIF
FOR INSERT
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @NIVEL_PRECIO VARCHAR(12)
	DECLARE @MONEDA VARCHAR(1)
	DECLARE @VERSION INT
	DECLARE @ARTICULO VARCHAR(20)
	DECLARE @ESCALA_BONIF INT
	DECLARE @VERSION_BONIF INT
	DECLARE @ARTICULO_BONIF VARCHAR(20)
	DECLARE @MIN_ART_FACT INT
	DECLARE @MAX_ART_FACT INT
	DECLARE @UNIDADES_BONIF DECIMAL(28,8)
	DECLARE @FECHA_INICIO_ESC DATETIME
	DECLARE @FECHA_FIN_ESC DATETIME
	DECLARE @FACTOR_BONIF DECIMAL(28,8)
	DECLARE @FECHA_ULT_MODIF DATETIME
	DECLARE @USUARIO_ULT_MODIF VARCHAR(25)
	
	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_INSERTED CURSOR LOCAL FOR
		SELECT NIVEL_PRECIO, MONEDA, VERSION, ARTICULO, ESCALA_BONIF, VERSION_BONIF, ARTICULO_BONIF, MIN_ART_FACT, MAX_ART_FACT, UNIDADES_BONIF, FECHA_INICIO_ESC, FECHA_FIN_ESC, FACTOR_BONIF, FECHA_ULT_MODIF, USUARIO_ULT_MODIF
		FROM INSERTED i
		WHERE 0 = (
				SELECT COUNT('n')
				FROM DELETED d
				WHERE i.NIVEL_PRECIO = d.NIVEL_PRECIO AND i.MONEDA = d.MONEDA AND i.VERSION = d.VERSION AND i.ARTICULO = d.ARTICULO AND i.ESCALA_BONIF = d.ESCALA_BONIF AND i.VERSION_BONIF = d.VERSION_BONIF
			   )
			
		OPEN C_INSERTED	
		FETCH NEXT FROM C_INSERTED INTO
		@NIVEL_PRECIO, @MONEDA, @VERSION, @ARTICULO, @ESCALA_BONIF, @VERSION_BONIF, @ARTICULO_BONIF, @MIN_ART_FACT, @MAX_ART_FACT, @UNIDADES_BONIF, @FECHA_INICIO_ESC, @FECHA_FIN_ESC, @FACTOR_BONIF, @FECHA_ULT_MODIF, @USUARIO_ULT_MODIF
		SET @ERROR = 0
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS =
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<ESCALA_BONIF>' +
				'<NIVEL_PRECIO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@NIVEL_PRECIO) + '</NIVEL_PRECIO>' +
				'<MONEDA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@MONEDA) + '</MONEDA>' +
				'<VERSION Type="INT" PrimaryKey="True">' + ERPADMIN.POS_NumberToVarchar(@VERSION) + '</VERSION>' +
				'<ARTICULO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@ARTICULO) + '</ARTICULO>' +
				'<ESCALA_BONIF Type="INT" PrimaryKey="True">' + ERPADMIN.POS_NumberToVarchar(@ESCALA_BONIF) + '</ESCALA_BONIF>' +
				'<VERSION_BONIF Type="INT" PrimaryKey="True">' + ERPADMIN.POS_NumberToVarchar(@VERSION_BONIF) + '</VERSION_BONIF>' +
				'<ARTICULO_BONIF Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ARTICULO_BONIF) + '</ARTICULO_BONIF>' +
				'<MIN_ART_FACT Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@MIN_ART_FACT) + '</MIN_ART_FACT>' +
				'<MAX_ART_FACT Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@MAX_ART_FACT) + '</MAX_ART_FACT>' +
				'<UNIDADES_BONIF Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@UNIDADES_BONIF) + '</UNIDADES_BONIF>' +
				'<FECHA_INICIO_ESC Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_INICIO_ESC) + '</FECHA_INICIO_ESC>' +
				'<FECHA_FIN_ESC Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_FIN_ESC) + '</FECHA_FIN_ESC>' +
				'<FACTOR_BONIF Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@FACTOR_BONIF) + '</FACTOR_BONIF>' +
				'<FECHA_ULT_MODIF Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_ULT_MODIF) + '</FECHA_ULT_MODIF>' +
				'<USUARIO_ULT_MODIF Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USUARIO_ULT_MODIF) + '</USUARIO_ULT_MODIF>' +
				'</ESCALA_BONIF>'
			-- Inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'ESCALABONIFPOS600', 'INSERTA', @PARAMETROS, 0, ''
			FETCH NEXT FROM C_INSERTED INTO
			@NIVEL_PRECIO, @MONEDA, @VERSION, @ARTICULO, @ESCALA_BONIF, @VERSION_BONIF, @ARTICULO_BONIF, @MIN_ART_FACT, @MAX_ART_FACT, @UNIDADES_BONIF, @FECHA_INICIO_ESC, @FECHA_FIN_ESC, @FACTOR_BONIF, @FECHA_ULT_MODIF, @USUARIO_ULT_MODIF
		END
		CLOSE C_INSERTED
    		DEALLOCATE C_INSERTED
	END
	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla ESCALA_BONIF.',16,1 )
	END
END
;




CREATE TRIGGER $$Compania$$.ESCALA_BONIF_POS_DEL
ON $$Compania$$.ESCALA_BONIF
FOR DELETE
AS
BEGIN   	
                DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @NIVEL_PRECIO VARCHAR(12)
	DECLARE @MONEDA VARCHAR(1)
	DECLARE @VERSION INT
	DECLARE @ARTICULO VARCHAR(20)
	DECLARE @ESCALA_BONIF INT
	DECLARE @VERSION_BONIF INT
	 -- Declaraciones	
	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_DELETED CURSOR LOCAL FOR
			SELECT NIVEL_PRECIO, MONEDA, VERSION, ARTICULO, ESCALA_BONIF, VERSION_BONIF
			FROM DELETED d
			WHERE 0 = (
				SELECT COUNT('n')
				FROM INSERTED i
				WHERE d.NIVEL_PRECIO = i.NIVEL_PRECIO AND d.MONEDA = i.MONEDA AND d.VERSION = i.VERSION AND d.ARTICULO = i.ARTICULO AND d.ESCALA_BONIF = i.ESCALA_BONIF AND d.VERSION_BONIF = i.VERSION_BONIF
			   )
		OPEN C_DELETED
		FETCH NEXT FROM C_DELETED INTO
		@NIVEL_PRECIO, @MONEDA, @VERSION, @ARTICULO, @ESCALA_BONIF, @VERSION_BONIF
		
		SET @ERROR = 0
		
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS =
								'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<ESCALA_BONIF>' +
				'<NIVEL_PRECIO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@NIVEL_PRECIO) + '</NIVEL_PRECIO>' +
				'<MONEDA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@MONEDA) + '</MONEDA>' +
				'<VERSION Type="INT" PrimaryKey="True">' + ERPADMIN.POS_NumberToVarchar(@VERSION) + '</VERSION>' +
				'<ARTICULO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@ARTICULO) + '</ARTICULO>' +
				'<ESCALA_BONIF Type="INT" PrimaryKey="True">' + ERPADMIN.POS_NumberToVarchar(@ESCALA_BONIF) + '</ESCALA_BONIF>' +
				'<VERSION_BONIF Type="INT" PrimaryKey="True">' + ERPADMIN.POS_NumberToVarchar(@VERSION_BONIF) + '</VERSION_BONIF>' +
				'</ESCALA_BONIF>'
 -- XML
			
			-- inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'ESCALABONIFPOS600', 'ELIMINA', @PARAMETROS, 0, ''
			
			FETCH NEXT FROM C_DELETED INTO
			@NIVEL_PRECIO, @MONEDA, @VERSION, @ARTICULO, @ESCALA_BONIF, @VERSION_BONIF
		END
		CLOSE C_DELETED
		DEALLOCATE C_DELETED
	END
	
	IF (@@ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para eliminar de la tabla ESCALA_BONIF.',16,1 )
	END
END
;




CREATE TRIGGER $$Compania$$.ESCALA_BONIF_POS_MOD
ON $$Compania$$.ESCALA_BONIF
FOR UPDATE
AS
BEGIN   	
	DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @COL_ROWPOINTER VARCHAR(36)
	DECLARE @HAY_CAMPOS_PARA_POS BIT
	DECLARE @ACTUALIZAR_SOLICITUD BIT
	DECLARE @NIVEL_PRECIO VARCHAR(12)
	DECLARE @MONEDA VARCHAR(1)
	DECLARE @VERSION INT
	DECLARE @ARTICULO VARCHAR(20)
	DECLARE @ESCALA_BONIF INT
	DECLARE @VERSION_BONIF INT
	DECLARE @ARTICULO_BONIF VARCHAR(20)
	DECLARE @MIN_ART_FACT INT
	DECLARE @MAX_ART_FACT INT
	DECLARE @UNIDADES_BONIF DECIMAL(28,8)
	DECLARE @FECHA_INICIO_ESC DATETIME
	DECLARE @FECHA_FIN_ESC DATETIME
	DECLARE @FACTOR_BONIF DECIMAL(28,8)
	DECLARE @FECHA_ULT_MODIF DATETIME
	DECLARE @USUARIO_ULT_MODIF VARCHAR(25)
	 -- Declaraciones
	SET @ERROR = 0
	SELECT @PUBLICADOR = SITIO_LOCAL, @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_MODIFIED CURSOR LOCAL FOR
			SELECT NIVEL_PRECIO, MONEDA, VERSION, ARTICULO, ESCALA_BONIF, VERSION_BONIF, ARTICULO_BONIF, MIN_ART_FACT, MAX_ART_FACT, UNIDADES_BONIF, FECHA_INICIO_ESC, FECHA_FIN_ESC, FACTOR_BONIF, FECHA_ULT_MODIF, USUARIO_ULT_MODIF -- Columnas
			FROM INSERTED I
		SET @ACTUALIZAR_SOLICITUD = 1
		OPEN C_MODIFIED
		FETCH NEXT FROM C_MODIFIED
		INTO @NIVEL_PRECIO, @MONEDA, @VERSION, @ARTICULO, @ESCALA_BONIF, @VERSION_BONIF, @ARTICULO_BONIF, @MIN_ART_FACT, @MAX_ART_FACT, @UNIDADES_BONIF, @FECHA_INICIO_ESC, @FECHA_FIN_ESC, @FACTOR_BONIF, @FECHA_ULT_MODIF, @USUARIO_ULT_MODIF
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			IF ( NOT UPDATE(RECORDDATE) AND ( UPDATE(NIVEL_PRECIO) OR UPDATE(MONEDA) OR UPDATE(VERSION) OR UPDATE(ARTICULO) OR UPDATE(ESCALA_BONIF) OR UPDATE(VERSION_BONIF) OR UPDATE(ARTICULO_BONIF) OR UPDATE(MIN_ART_FACT) OR UPDATE(MAX_ART_FACT) OR UPDATE(UNIDADES_BONIF) OR UPDATE(FECHA_INICIO_ESC) OR UPDATE(FECHA_FIN_ESC) OR UPDATE(FACTOR_BONIF) OR UPDATE(FECHA_ULT_MODIF) OR UPDATE(USUARIO_ULT_MODIF) ) )
			BEGIN
				SELECT @COL_ROWPOINTER = ROWPOINTER
				FROM $$Compania$$.ESCALA_BONIF
				WHERE NIVEL_PRECIO = @NIVEL_PRECIO AND MONEDA = @MONEDA AND VERSION = @VERSION AND ARTICULO = @ARTICULO AND ESCALA_BONIF = @ESCALA_BONIF AND VERSION_BONIF = @VERSION_BONIF
				SET @PARAMETROS =
					'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<ESCALA_BONIF>' +
				'<NIVEL_PRECIO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@NIVEL_PRECIO) + '</NIVEL_PRECIO>' +
				'<MONEDA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@MONEDA) + '</MONEDA>' +
				'<VERSION Type="INT" PrimaryKey="True">' + ERPADMIN.POS_NumberToVarchar(@VERSION) + '</VERSION>' +
				'<ARTICULO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@ARTICULO) + '</ARTICULO>' +
				'<ESCALA_BONIF Type="INT" PrimaryKey="True">' + ERPADMIN.POS_NumberToVarchar(@ESCALA_BONIF) + '</ESCALA_BONIF>' +
				'<VERSION_BONIF Type="INT" PrimaryKey="True">' + ERPADMIN.POS_NumberToVarchar(@VERSION_BONIF) + '</VERSION_BONIF>' +
				'<ARTICULO_BONIF Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ARTICULO_BONIF) + '</ARTICULO_BONIF>' +
				'<MIN_ART_FACT Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@MIN_ART_FACT) + '</MIN_ART_FACT>' +
				'<MAX_ART_FACT Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@MAX_ART_FACT) + '</MAX_ART_FACT>' +
				'<UNIDADES_BONIF Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@UNIDADES_BONIF) + '</UNIDADES_BONIF>' +
				'<FECHA_INICIO_ESC Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_INICIO_ESC) + '</FECHA_INICIO_ESC>' +
				'<FECHA_FIN_ESC Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_FIN_ESC) + '</FECHA_FIN_ESC>' +
				'<FACTOR_BONIF Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@FACTOR_BONIF) + '</FACTOR_BONIF>' +
				'<FECHA_ULT_MODIF Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_ULT_MODIF) + '</FECHA_ULT_MODIF>' +
				'<USUARIO_ULT_MODIF Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USUARIO_ULT_MODIF) + '</USUARIO_ULT_MODIF>' +
				'</ESCALA_BONIF>'
				-- inserta la solicitud correspondiente
				EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'ESCALABONIFPOS600', 'MODIFICA', @PARAMETROS, @ACTUALIZAR_SOLICITUD, @COL_ROWPOINTER
			END
			FETCH NEXT FROM C_MODIFIED
			INTO @NIVEL_PRECIO, @MONEDA, @VERSION, @ARTICULO, @ESCALA_BONIF, @VERSION_BONIF, @ARTICULO_BONIF, @MIN_ART_FACT, @MAX_ART_FACT, @UNIDADES_BONIF, @FECHA_INICIO_ESC, @FECHA_FIN_ESC, @FACTOR_BONIF, @FECHA_ULT_MODIF, @USUARIO_ULT_MODIF
		END
		CLOSE C_MODIFIED
		DEALLOCATE C_MODIFIED
	END
	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para modificar la tabla ESCALA_BONIF.',16,1 )
	END
END
;




CREATE TRIGGER $$Compania$$.ESCALA_DCTO_POS_INS
ON $$Compania$$.ESCALA_DCTO
FOR INSERT
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @NIVEL_PRECIO VARCHAR(12)
	DECLARE @MONEDA VARCHAR(1)
	DECLARE @VERSION INT
	DECLARE @ARTICULO VARCHAR(20)
	DECLARE @ESCALA_DCTO INT
	DECLARE @VERSION_DCTO INT
	DECLARE @MIN_UNID_FACT INT
	DECLARE @MAX_UNID_FACT INT
	DECLARE @PORC_DCTO DECIMAL(28,8)
	DECLARE @FECHA_INICIO_ESC DATETIME
	DECLARE @FECHA_FIN_ESC DATETIME
	DECLARE @FECHA_ULT_MODIF DATETIME
	DECLARE @USUARIO_ULT_MODIF VARCHAR(25)
	
	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_INSERTED CURSOR LOCAL FOR
		SELECT NIVEL_PRECIO, MONEDA, VERSION, ARTICULO, ESCALA_DCTO, VERSION_DCTO, MIN_UNID_FACT, MAX_UNID_FACT, PORC_DCTO, FECHA_INICIO_ESC, FECHA_FIN_ESC, FECHA_ULT_MODIF, USUARIO_ULT_MODIF
		FROM INSERTED i
		WHERE 0 = (
				SELECT COUNT('n')
				FROM DELETED d
				WHERE i.NIVEL_PRECIO = d.NIVEL_PRECIO AND i.MONEDA = d.MONEDA AND i.VERSION = d.VERSION AND i.ARTICULO = d.ARTICULO AND i.ESCALA_DCTO = d.ESCALA_DCTO AND i.VERSION_DCTO = d.VERSION_DCTO
			   )
			
		OPEN C_INSERTED	
		FETCH NEXT FROM C_INSERTED INTO
		@NIVEL_PRECIO, @MONEDA, @VERSION, @ARTICULO, @ESCALA_DCTO, @VERSION_DCTO, @MIN_UNID_FACT, @MAX_UNID_FACT, @PORC_DCTO, @FECHA_INICIO_ESC, @FECHA_FIN_ESC, @FECHA_ULT_MODIF, @USUARIO_ULT_MODIF
		SET @ERROR = 0
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS =
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<ESCALA_DCTO>' +
				'<NIVEL_PRECIO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@NIVEL_PRECIO) + '</NIVEL_PRECIO>' +
				'<MONEDA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@MONEDA) + '</MONEDA>' +
				'<VERSION Type="INT" PrimaryKey="True">' + ERPADMIN.POS_NumberToVarchar(@VERSION) + '</VERSION>' +
				'<ARTICULO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@ARTICULO) + '</ARTICULO>' +
				'<ESCALA_DCTO Type="INT" PrimaryKey="True">' + ERPADMIN.POS_NumberToVarchar(@ESCALA_DCTO) + '</ESCALA_DCTO>' +
				'<VERSION_DCTO Type="INT" PrimaryKey="True">' + ERPADMIN.POS_NumberToVarchar(@VERSION_DCTO) + '</VERSION_DCTO>' +
				'<MIN_UNID_FACT Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@MIN_UNID_FACT) + '</MIN_UNID_FACT>' +
				'<MAX_UNID_FACT Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@MAX_UNID_FACT) + '</MAX_UNID_FACT>' +
				'<PORC_DCTO Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@PORC_DCTO) + '</PORC_DCTO>' +
				'<FECHA_INICIO_ESC Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_INICIO_ESC) + '</FECHA_INICIO_ESC>' +
				'<FECHA_FIN_ESC Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_FIN_ESC) + '</FECHA_FIN_ESC>' +
				'<FECHA_ULT_MODIF Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_ULT_MODIF) + '</FECHA_ULT_MODIF>' +
				'<USUARIO_ULT_MODIF Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USUARIO_ULT_MODIF) + '</USUARIO_ULT_MODIF>' +
				'</ESCALA_DCTO>'
			-- Inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'ESCALADCTOPOS600', 'INSERTA', @PARAMETROS, 0, ''
			FETCH NEXT FROM C_INSERTED INTO
			@NIVEL_PRECIO, @MONEDA, @VERSION, @ARTICULO, @ESCALA_DCTO, @VERSION_DCTO, @MIN_UNID_FACT, @MAX_UNID_FACT, @PORC_DCTO, @FECHA_INICIO_ESC, @FECHA_FIN_ESC, @FECHA_ULT_MODIF, @USUARIO_ULT_MODIF
		END
		CLOSE C_INSERTED
    		DEALLOCATE C_INSERTED
	END
	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla ESCALA_DCTO.',16,1 )
	END
END
;




CREATE TRIGGER $$Compania$$.ESCALA_DCTO_POS_DEL
ON $$Compania$$.ESCALA_DCTO
FOR DELETE
AS
BEGIN   	
                DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @NIVEL_PRECIO VARCHAR(12)
	DECLARE @MONEDA VARCHAR(1)
	DECLARE @VERSION INT
	DECLARE @ARTICULO VARCHAR(20)
	DECLARE @ESCALA_DCTO INT
	DECLARE @VERSION_DCTO INT
	 -- Declaraciones	
	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_DELETED CURSOR LOCAL FOR
			SELECT NIVEL_PRECIO, MONEDA, VERSION, ARTICULO, ESCALA_DCTO, VERSION_DCTO
			FROM DELETED d
			WHERE 0 = (
				SELECT COUNT('n')
				FROM INSERTED i
				WHERE d.NIVEL_PRECIO = i.NIVEL_PRECIO AND d.MONEDA = i.MONEDA AND d.VERSION = i.VERSION AND d.ARTICULO = i.ARTICULO AND d.ESCALA_DCTO = i.ESCALA_DCTO AND d.VERSION_DCTO = i.VERSION_DCTO
			   )
		OPEN C_DELETED
		FETCH NEXT FROM C_DELETED INTO
		@NIVEL_PRECIO, @MONEDA, @VERSION, @ARTICULO, @ESCALA_DCTO, @VERSION_DCTO
		
		SET @ERROR = 0
		
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS =
								'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<ESCALA_DCTO>' +
				'<NIVEL_PRECIO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@NIVEL_PRECIO) + '</NIVEL_PRECIO>' +
				'<MONEDA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@MONEDA) + '</MONEDA>' +
				'<VERSION Type="INT" PrimaryKey="True">' + ERPADMIN.POS_NumberToVarchar(@VERSION) + '</VERSION>' +
				'<ARTICULO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@ARTICULO) + '</ARTICULO>' +
				'<ESCALA_DCTO Type="INT" PrimaryKey="True">' + ERPADMIN.POS_NumberToVarchar(@ESCALA_DCTO) + '</ESCALA_DCTO>' +
				'<VERSION_DCTO Type="INT" PrimaryKey="True">' + ERPADMIN.POS_NumberToVarchar(@VERSION_DCTO) + '</VERSION_DCTO>' +
				'</ESCALA_DCTO>'
 -- XML
			
			-- inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'ESCALADCTOPOS600', 'ELIMINA', @PARAMETROS, 0, ''
			
			FETCH NEXT FROM C_DELETED INTO
			@NIVEL_PRECIO, @MONEDA, @VERSION, @ARTICULO, @ESCALA_DCTO, @VERSION_DCTO
		END
		CLOSE C_DELETED
		DEALLOCATE C_DELETED
	END
	
	IF (@@ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para eliminar de la tabla ESCALA_DCTO.',16,1 )
	END
END
;




CREATE TRIGGER $$Compania$$.ESCALA_DCTO_POS_MOD
ON $$Compania$$.ESCALA_DCTO
FOR UPDATE
AS
BEGIN   	
	DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @COL_ROWPOINTER VARCHAR(36)
	DECLARE @HAY_CAMPOS_PARA_POS BIT
	DECLARE @ACTUALIZAR_SOLICITUD BIT
	DECLARE @NIVEL_PRECIO VARCHAR(12)
	DECLARE @MONEDA VARCHAR(1)
	DECLARE @VERSION INT
	DECLARE @ARTICULO VARCHAR(20)
	DECLARE @ESCALA_DCTO INT
	DECLARE @VERSION_DCTO INT
	DECLARE @MIN_UNID_FACT INT
	DECLARE @MAX_UNID_FACT INT
	DECLARE @PORC_DCTO DECIMAL(28,8)
	DECLARE @FECHA_INICIO_ESC DATETIME
	DECLARE @FECHA_FIN_ESC DATETIME
	DECLARE @FECHA_ULT_MODIF DATETIME
	DECLARE @USUARIO_ULT_MODIF VARCHAR(25)
	 -- Declaraciones
	SET @ERROR = 0
	SELECT @PUBLICADOR = SITIO_LOCAL, @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_MODIFIED CURSOR LOCAL FOR
			SELECT NIVEL_PRECIO, MONEDA, VERSION, ARTICULO, ESCALA_DCTO, VERSION_DCTO, MIN_UNID_FACT, MAX_UNID_FACT, PORC_DCTO, FECHA_INICIO_ESC, FECHA_FIN_ESC, FECHA_ULT_MODIF, USUARIO_ULT_MODIF -- Columnas
			FROM INSERTED I
		SET @ACTUALIZAR_SOLICITUD = 1
		OPEN C_MODIFIED
		FETCH NEXT FROM C_MODIFIED
		INTO @NIVEL_PRECIO, @MONEDA, @VERSION, @ARTICULO, @ESCALA_DCTO, @VERSION_DCTO, @MIN_UNID_FACT, @MAX_UNID_FACT, @PORC_DCTO, @FECHA_INICIO_ESC, @FECHA_FIN_ESC, @FECHA_ULT_MODIF, @USUARIO_ULT_MODIF
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			IF ( NOT UPDATE(RECORDDATE) AND ( UPDATE(NIVEL_PRECIO) OR UPDATE(MONEDA) OR UPDATE(VERSION) OR UPDATE(ARTICULO) OR UPDATE(ESCALA_DCTO) OR UPDATE(VERSION_DCTO) OR UPDATE(MIN_UNID_FACT) OR UPDATE(MAX_UNID_FACT) OR UPDATE(PORC_DCTO) OR UPDATE(FECHA_INICIO_ESC) OR UPDATE(FECHA_FIN_ESC) OR UPDATE(FECHA_ULT_MODIF) OR UPDATE(USUARIO_ULT_MODIF) ) )
			BEGIN
				SELECT @COL_ROWPOINTER = ROWPOINTER
				FROM $$Compania$$.ESCALA_DCTO
				WHERE NIVEL_PRECIO = @NIVEL_PRECIO AND MONEDA = @MONEDA AND VERSION = @VERSION AND ARTICULO = @ARTICULO AND ESCALA_DCTO = @ESCALA_DCTO AND VERSION_DCTO = @VERSION_DCTO
				SET @PARAMETROS =
					'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<ESCALA_DCTO>' +
				'<NIVEL_PRECIO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@NIVEL_PRECIO) + '</NIVEL_PRECIO>' +
				'<MONEDA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@MONEDA) + '</MONEDA>' +
				'<VERSION Type="INT" PrimaryKey="True">' + ERPADMIN.POS_NumberToVarchar(@VERSION) + '</VERSION>' +
				'<ARTICULO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@ARTICULO) + '</ARTICULO>' +
				'<ESCALA_DCTO Type="INT" PrimaryKey="True">' + ERPADMIN.POS_NumberToVarchar(@ESCALA_DCTO) + '</ESCALA_DCTO>' +
				'<VERSION_DCTO Type="INT" PrimaryKey="True">' + ERPADMIN.POS_NumberToVarchar(@VERSION_DCTO) + '</VERSION_DCTO>' +
				'<MIN_UNID_FACT Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@MIN_UNID_FACT) + '</MIN_UNID_FACT>' +
				'<MAX_UNID_FACT Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@MAX_UNID_FACT) + '</MAX_UNID_FACT>' +
				'<PORC_DCTO Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@PORC_DCTO) + '</PORC_DCTO>' +
				'<FECHA_INICIO_ESC Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_INICIO_ESC) + '</FECHA_INICIO_ESC>' +
				'<FECHA_FIN_ESC Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_FIN_ESC) + '</FECHA_FIN_ESC>' +
				'<FECHA_ULT_MODIF Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_ULT_MODIF) + '</FECHA_ULT_MODIF>' +
				'<USUARIO_ULT_MODIF Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USUARIO_ULT_MODIF) + '</USUARIO_ULT_MODIF>' +
				'</ESCALA_DCTO>'
				-- inserta la solicitud correspondiente
				EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'ESCALADCTOPOS600', 'MODIFICA', @PARAMETROS, @ACTUALIZAR_SOLICITUD, @COL_ROWPOINTER
			END
			FETCH NEXT FROM C_MODIFIED
			INTO @NIVEL_PRECIO, @MONEDA, @VERSION, @ARTICULO, @ESCALA_DCTO, @VERSION_DCTO, @MIN_UNID_FACT, @MAX_UNID_FACT, @PORC_DCTO, @FECHA_INICIO_ESC, @FECHA_FIN_ESC, @FECHA_ULT_MODIF, @USUARIO_ULT_MODIF
		END
		CLOSE C_MODIFIED
		DEALLOCATE C_MODIFIED
	END
	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para modificar la tabla ESCALA_DCTO.',16,1 )
	END
END
;




CREATE TRIGGER $$Compania$$.EXISTENCIA_BODEGA_POS_INS
ON $$Compania$$.EXISTENCIA_BODEGA
FOR INSERT
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @ARTICULO VARCHAR(20)
	DECLARE @BODEGA VARCHAR(4)
	DECLARE @EXISTENCIA_MINIMA DECIMAL(28,8)
	DECLARE @EXISTENCIA_MAXIMA DECIMAL(28,8)
	DECLARE @PUNTO_DE_REORDEN DECIMAL(28,8)
	DECLARE @CANT_DISPONIBLE DECIMAL(28,8)
	DECLARE @CANT_RESERVADA DECIMAL(28,8)
	DECLARE @CANT_NO_APROBADA DECIMAL(28,8)
	DECLARE @CANT_VENCIDA DECIMAL(28,8)
	DECLARE @CANT_TRANSITO DECIMAL(28,8)
	DECLARE @CANT_PRODUCCION DECIMAL(28,8)
	DECLARE @CANT_PEDIDA DECIMAL(28,8)
	DECLARE @CANT_REMITIDA DECIMAL(28,8)
	DECLARE @CONGELADO VARCHAR(1)
	DECLARE @FECHA_CONG DATETIME
	DECLARE @BLOQUEA_TRANS VARCHAR(1)
	DECLARE @FECHA_DESCONG DATETIME
	
	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_INSERTED CURSOR LOCAL FOR
		SELECT ARTICULO, BODEGA, EXISTENCIA_MINIMA, EXISTENCIA_MAXIMA, PUNTO_DE_REORDEN, CANT_DISPONIBLE, CANT_RESERVADA, CANT_NO_APROBADA, CANT_VENCIDA, CANT_TRANSITO, CANT_PRODUCCION, CANT_PEDIDA, CANT_REMITIDA, CONGELADO, FECHA_CONG, BLOQUEA_TRANS, FECHA_DESCONG
		FROM INSERTED i
		WHERE 0 = (
				SELECT COUNT('n')
				FROM DELETED d
				WHERE i.ARTICULO = d.ARTICULO AND i.BODEGA = d.BODEGA
			   )
			
		OPEN C_INSERTED	
		FETCH NEXT FROM C_INSERTED INTO
		@ARTICULO, @BODEGA, @EXISTENCIA_MINIMA, @EXISTENCIA_MAXIMA, @PUNTO_DE_REORDEN, @CANT_DISPONIBLE, @CANT_RESERVADA, @CANT_NO_APROBADA, @CANT_VENCIDA, @CANT_TRANSITO, @CANT_PRODUCCION, @CANT_PEDIDA, @CANT_REMITIDA, @CONGELADO, @FECHA_CONG, @BLOQUEA_TRANS, @FECHA_DESCONG
		SET @ERROR = 0
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS =
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<EXISTENCIA_BODEGA>' +
				'<ARTICULO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@ARTICULO) + '</ARTICULO>' +
				'<BODEGA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@BODEGA) + '</BODEGA>' +
				'<EXISTENCIA_MINIMA Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@EXISTENCIA_MINIMA) + '</EXISTENCIA_MINIMA>' +
				'<EXISTENCIA_MAXIMA Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@EXISTENCIA_MAXIMA) + '</EXISTENCIA_MAXIMA>' +
				'<PUNTO_DE_REORDEN Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@PUNTO_DE_REORDEN) + '</PUNTO_DE_REORDEN>' +
				'<CANT_DISPONIBLE Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@CANT_DISPONIBLE) + '</CANT_DISPONIBLE>' +
				'<CANT_RESERVADA Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@CANT_RESERVADA) + '</CANT_RESERVADA>' +
				'<CANT_NO_APROBADA Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@CANT_NO_APROBADA) + '</CANT_NO_APROBADA>' +
				'<CANT_VENCIDA Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@CANT_VENCIDA) + '</CANT_VENCIDA>' +
				'<CANT_TRANSITO Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@CANT_TRANSITO) + '</CANT_TRANSITO>' +
				'<CANT_PRODUCCION Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@CANT_PRODUCCION) + '</CANT_PRODUCCION>' +
				'<CANT_PEDIDA Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@CANT_PEDIDA) + '</CANT_PEDIDA>' +
				'<CANT_REMITIDA Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@CANT_REMITIDA) + '</CANT_REMITIDA>' +
				'<CONGELADO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CONGELADO) + '</CONGELADO>' +
				'<FECHA_CONG Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_CONG) + '</FECHA_CONG>' +
				'<BLOQUEA_TRANS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@BLOQUEA_TRANS) + '</BLOQUEA_TRANS>' +
				'<FECHA_DESCONG Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_DESCONG) + '</FECHA_DESCONG>' +
				'</EXISTENCIA_BODEGA>'
			-- Inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'EXISTENCIABODEGAPOS600', 'INSERTA', @PARAMETROS, 0, ''
			FETCH NEXT FROM C_INSERTED INTO
			@ARTICULO, @BODEGA, @EXISTENCIA_MINIMA, @EXISTENCIA_MAXIMA, @PUNTO_DE_REORDEN, @CANT_DISPONIBLE, @CANT_RESERVADA, @CANT_NO_APROBADA, @CANT_VENCIDA, @CANT_TRANSITO, @CANT_PRODUCCION, @CANT_PEDIDA, @CANT_REMITIDA, @CONGELADO, @FECHA_CONG, @BLOQUEA_TRANS, @FECHA_DESCONG
		END
		CLOSE C_INSERTED
    		DEALLOCATE C_INSERTED
	END
	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla EXISTENCIA_BODEGA.',16,1 )
	END
END
;





CREATE TRIGGER $$Compania$$.EXISTENCIA_BODEGA_POS_MOD
ON $$Compania$$.EXISTENCIA_BODEGA
FOR UPDATE
AS 
BEGIN   	
	DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @TIPO_SITIO_LOCAL VARCHAR(1)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @COL_ROWPOINTER VARCHAR(36)
	DECLARE @HAY_CAMPOS_PARA_POS BIT
	DECLARE @ACTUALIZAR_SOLICITUD BIT
	DECLARE @ARTICULO VARCHAR(20)
	DECLARE @BODEGA VARCHAR(4)
	DECLARE @EXISTENCIA_MINIMA DECIMAL(28,8)
	DECLARE @EXISTENCIA_MAXIMA DECIMAL(28,8)
	DECLARE @PUNTO_DE_REORDEN DECIMAL(28,8)
	DECLARE @CANT_DISPONIBLE DECIMAL(28,8)
	DECLARE @CANT_RESERVADA DECIMAL(28,8)
	DECLARE @CANT_NO_APROBADA DECIMAL(28,8)
	DECLARE @CANT_VENCIDA DECIMAL(28,8)
	DECLARE @CANT_TRANSITO DECIMAL(28,8)
	DECLARE @CANT_PRODUCCION DECIMAL(28,8)
	DECLARE @CANT_PEDIDA DECIMAL(28,8)
	DECLARE @CANT_REMITIDA DECIMAL(28,8)
	DECLARE @CONGELADO VARCHAR(1)
	DECLARE @FECHA_CONG DATETIME
	DECLARE @BLOQUEA_TRANS VARCHAR(1)
	DECLARE @FECHA_DESCONG DATETIME
	DECLARE @APLICARMOVIMIENTO INT
	 -- Declaraciones

	SET @ERROR = 0

	SELECT @PUBLICADOR = SITIO_LOCAL, 
	       @USUARIO_POS_WSQM = USUARIO_WSQM,
	       @TIPO_SITIO_LOCAL = TIPO_SITIO_LOCAL
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM) AND @TIPO_SITIO_LOCAL = 'C'
	BEGIN
		DECLARE C_MODIFIED CURSOR LOCAL FOR
			SELECT ARTICULO, BODEGA, EXISTENCIA_MINIMA, EXISTENCIA_MAXIMA, PUNTO_DE_REORDEN, CANT_DISPONIBLE, CANT_RESERVADA, CANT_NO_APROBADA, CANT_VENCIDA, CANT_TRANSITO, CANT_PRODUCCION, CANT_PEDIDA, CANT_REMITIDA, CONGELADO, FECHA_CONG, BLOQUEA_TRANS, FECHA_DESCONG -- Columnas
			FROM INSERTED I

		SET @ACTUALIZAR_SOLICITUD = 1

		OPEN C_MODIFIED

		FETCH NEXT FROM C_MODIFIED
		INTO @ARTICULO, @BODEGA, @EXISTENCIA_MINIMA, @EXISTENCIA_MAXIMA, @PUNTO_DE_REORDEN, @CANT_DISPONIBLE, @CANT_RESERVADA, @CANT_NO_APROBADA, @CANT_VENCIDA, @CANT_TRANSITO, @CANT_PRODUCCION, @CANT_PEDIDA, @CANT_REMITIDA, @CONGELADO, @FECHA_CONG, @BLOQUEA_TRANS, @FECHA_DESCONG
		
		SELECT @APLICARMOVIMIENTO = COUNT(*)
		FROM $$Compania$$.V_SITIO_BODEGA
		WHERE BODEGA = @BODEGA
		
		IF @APLICARMOVIMIENTO > 0
		BEGIN	
			WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
			BEGIN
				IF ( NOT UPDATE(RECORDDATE) AND ( UPDATE(ARTICULO) OR UPDATE(BODEGA) OR UPDATE(EXISTENCIA_MINIMA) OR UPDATE(EXISTENCIA_MAXIMA) OR UPDATE(PUNTO_DE_REORDEN) OR UPDATE(CANT_DISPONIBLE) OR UPDATE(CANT_RESERVADA) OR UPDATE(CANT_NO_APROBADA) OR UPDATE(CANT_VENCIDA) OR UPDATE(CANT_TRANSITO) OR UPDATE(CANT_PRODUCCION) OR UPDATE(CANT_PEDIDA) OR UPDATE(CANT_REMITIDA) OR UPDATE(CONGELADO) OR UPDATE(FECHA_CONG) OR UPDATE(BLOQUEA_TRANS) OR UPDATE(FECHA_DESCONG) ) )
				BEGIN

					SELECT @COL_ROWPOINTER = ROWPOINTER 
					FROM $$Compania$$.EXISTENCIA_BODEGA WITH (NOLOCK)
					WHERE ARTICULO = @ARTICULO AND BODEGA = @BODEGA 

					SET @PARAMETROS =
						'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
					'<EXISTENCIA_BODEGA>' + 
					'<ARTICULO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@ARTICULO) + '</ARTICULO>' + 
					'<BODEGA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@BODEGA) + '</BODEGA>' + 
					'<EXISTENCIA_MINIMA Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@EXISTENCIA_MINIMA) + '</EXISTENCIA_MINIMA>' + 
					'<EXISTENCIA_MAXIMA Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@EXISTENCIA_MAXIMA) + '</EXISTENCIA_MAXIMA>' + 
					'<PUNTO_DE_REORDEN Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@PUNTO_DE_REORDEN) + '</PUNTO_DE_REORDEN>' + 
					'<CANT_DISPONIBLE Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@CANT_DISPONIBLE) + '</CANT_DISPONIBLE>' + 
					'<CANT_RESERVADA Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@CANT_RESERVADA) + '</CANT_RESERVADA>' + 
					'<CANT_NO_APROBADA Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@CANT_NO_APROBADA) + '</CANT_NO_APROBADA>' + 
					'<CANT_VENCIDA Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@CANT_VENCIDA) + '</CANT_VENCIDA>' + 
					'<CANT_TRANSITO Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@CANT_TRANSITO) + '</CANT_TRANSITO>' + 
					'<CANT_PRODUCCION Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@CANT_PRODUCCION) + '</CANT_PRODUCCION>' + 
					'<CANT_PEDIDA Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@CANT_PEDIDA) + '</CANT_PEDIDA>' + 
					'<CANT_REMITIDA Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@CANT_REMITIDA) + '</CANT_REMITIDA>' + 
					'<CONGELADO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CONGELADO) + '</CONGELADO>' + 
					'<FECHA_CONG Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_CONG) + '</FECHA_CONG>' + 
					'<BLOQUEA_TRANS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@BLOQUEA_TRANS) + '</BLOQUEA_TRANS>' + 
					'<FECHA_DESCONG Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_DESCONG) + '</FECHA_DESCONG>' + 
					'</EXISTENCIA_BODEGA>'


					-- inserta la solicitud correspondiente
					EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'EXISTENCIABODEGAPOS600', 'MODIFICA', @PARAMETROS, @ACTUALIZAR_SOLICITUD, @COL_ROWPOINTER
				END

				FETCH NEXT FROM C_MODIFIED
				INTO @ARTICULO, @BODEGA, @EXISTENCIA_MINIMA, @EXISTENCIA_MAXIMA, @PUNTO_DE_REORDEN, @CANT_DISPONIBLE, @CANT_RESERVADA, @CANT_NO_APROBADA, @CANT_VENCIDA, @CANT_TRANSITO, @CANT_PRODUCCION, @CANT_PEDIDA, @CANT_REMITIDA, @CONGELADO, @FECHA_CONG, @BLOQUEA_TRANS, @FECHA_DESCONG
			END
		END

		CLOSE C_MODIFIED
		DEALLOCATE C_MODIFIED
	END

	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para modificar la tabla EXISTENCIA_BODEGA.',16,1 )
	END
END
;





CREATE TRIGGER $$Compania$$.EXISTENCIA_BODEGA_POS_DEL
ON $$Compania$$.EXISTENCIA_BODEGA
FOR DELETE
AS
BEGIN   	
                DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @ARTICULO VARCHAR(20)
	DECLARE @BODEGA VARCHAR(4)
	 -- Declaraciones	
	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_DELETED CURSOR LOCAL FOR
			SELECT ARTICULO, BODEGA
			FROM DELETED d
			WHERE 0 = (
				SELECT COUNT('n')
				FROM INSERTED i
				WHERE d.ARTICULO = i.ARTICULO AND d.BODEGA = i.BODEGA
			   )
		OPEN C_DELETED
		FETCH NEXT FROM C_DELETED INTO
		@ARTICULO, @BODEGA
		
		SET @ERROR = 0
		
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS =
								'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<EXISTENCIA_BODEGA>' +
				'<ARTICULO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@ARTICULO) + '</ARTICULO>' +
				'<BODEGA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@BODEGA) + '</BODEGA>' +
				'</EXISTENCIA_BODEGA>'
 -- XML
			
			-- inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'EXISTENCIABODEGAPOS600', 'ELIMINA', @PARAMETROS, 0, ''
			
			FETCH NEXT FROM C_DELETED INTO
			@ARTICULO, @BODEGA
		END
		CLOSE C_DELETED
		DEALLOCATE C_DELETED
	END
	
	IF (@@ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para eliminar de la tabla EXISTENCIA_BODEGA.',16,1 )
	END
END
;





CREATE TRIGGER $$Compania$$.EXISTENCIA_LOTE_POS_INS
ON $$Compania$$.EXISTENCIA_LOTE
FOR INSERT
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @BODEGA VARCHAR(4)
	DECLARE @ARTICULO VARCHAR(20)
	DECLARE @LOCALIZACION VARCHAR(8)
	DECLARE @LOTE VARCHAR(15)
	DECLARE @CANT_DISPONIBLE DECIMAL(28,8)
	DECLARE @CANT_RESERVADA DECIMAL(28,8)
	DECLARE @CANT_NO_APROBADA DECIMAL(28,8)
	DECLARE @CANT_VENCIDA DECIMAL(28,8)
	DECLARE @CANT_REMITIDA DECIMAL(28,8)
	
	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_INSERTED CURSOR LOCAL FOR
		SELECT BODEGA, ARTICULO, LOCALIZACION, LOTE, CANT_DISPONIBLE, CANT_RESERVADA, CANT_NO_APROBADA, CANT_VENCIDA, CANT_REMITIDA
		FROM INSERTED i
		WHERE 0 = (
				SELECT COUNT('n')
				FROM DELETED d
				WHERE i.BODEGA = d.BODEGA AND i.ARTICULO = d.ARTICULO AND i.LOCALIZACION = d.LOCALIZACION AND i.LOTE = d.LOTE
			   )
			
		OPEN C_INSERTED	
		FETCH NEXT FROM C_INSERTED INTO
		@BODEGA, @ARTICULO, @LOCALIZACION, @LOTE, @CANT_DISPONIBLE, @CANT_RESERVADA, @CANT_NO_APROBADA, @CANT_VENCIDA, @CANT_REMITIDA
		SET @ERROR = 0
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS =
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<EXISTENCIA_LOTE>' +
				'<BODEGA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@BODEGA) + '</BODEGA>' +
				'<ARTICULO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@ARTICULO) + '</ARTICULO>' +
				'<LOCALIZACION Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@LOCALIZACION) + '</LOCALIZACION>' +
				'<LOTE Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@LOTE) + '</LOTE>' +
				'<CANT_DISPONIBLE Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@CANT_DISPONIBLE) + '</CANT_DISPONIBLE>' +
				'<CANT_RESERVADA Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@CANT_RESERVADA) + '</CANT_RESERVADA>' +
				'<CANT_NO_APROBADA Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@CANT_NO_APROBADA) + '</CANT_NO_APROBADA>' +
				'<CANT_VENCIDA Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@CANT_VENCIDA) + '</CANT_VENCIDA>' +
				'<CANT_REMITIDA Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@CANT_REMITIDA) + '</CANT_REMITIDA>' +
				'</EXISTENCIA_LOTE>'
			-- Inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'EXISTENCIALOTEPOS600', 'INSERTA', @PARAMETROS, 0, ''
			FETCH NEXT FROM C_INSERTED INTO
			@BODEGA, @ARTICULO, @LOCALIZACION, @LOTE, @CANT_DISPONIBLE, @CANT_RESERVADA, @CANT_NO_APROBADA, @CANT_VENCIDA, @CANT_REMITIDA
		END
		CLOSE C_INSERTED
    		DEALLOCATE C_INSERTED
	END
	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla EXISTENCIA_LOTE.',16,1 )
	END
END
;




CREATE TRIGGER $$Compania$$.EXISTENCIA_LOTE_POS_DEL
ON $$Compania$$.EXISTENCIA_LOTE
FOR DELETE
AS
BEGIN   	
                DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @BODEGA VARCHAR(4)
	DECLARE @ARTICULO VARCHAR(20)
	DECLARE @LOCALIZACION VARCHAR(8)
	DECLARE @LOTE VARCHAR(15)
	 -- Declaraciones	
	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_DELETED CURSOR LOCAL FOR
			SELECT BODEGA, ARTICULO, LOCALIZACION, LOTE
			FROM DELETED d
			WHERE 0 = (
				SELECT COUNT('n')
				FROM INSERTED i
				WHERE d.BODEGA = i.BODEGA AND d.ARTICULO = i.ARTICULO AND d.LOCALIZACION = i.LOCALIZACION AND d.LOTE = i.LOTE
			   )
		OPEN C_DELETED
		FETCH NEXT FROM C_DELETED INTO
		@BODEGA, @ARTICULO, @LOCALIZACION, @LOTE
		
		SET @ERROR = 0
		
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS =
								'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<EXISTENCIA_LOTE>' +
				'<BODEGA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@BODEGA) + '</BODEGA>' +
				'<ARTICULO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@ARTICULO) + '</ARTICULO>' +
				'<LOCALIZACION Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@LOCALIZACION) + '</LOCALIZACION>' +
				'<LOTE Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@LOTE) + '</LOTE>' +
				'</EXISTENCIA_LOTE>'
 -- XML
			
			-- inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'EXISTENCIALOTEPOS600', 'ELIMINA', @PARAMETROS, 0, ''
			
			FETCH NEXT FROM C_DELETED INTO
			@BODEGA, @ARTICULO, @LOCALIZACION, @LOTE
		END
		CLOSE C_DELETED
		DEALLOCATE C_DELETED
	END
	
	IF (@@ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para eliminar de la tabla EXISTENCIA_LOTE.',16,1 )
	END
END
;





CREATE TRIGGER $$Compania$$.EXISTENCIA_LOTE_POS_MOD
ON $$Compania$$.EXISTENCIA_LOTE
FOR UPDATE
AS
BEGIN   	
	DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @COL_ROWPOINTER VARCHAR(36)
	DECLARE @HAY_CAMPOS_PARA_POS BIT
	DECLARE @ACTUALIZAR_SOLICITUD BIT
	DECLARE @BODEGA VARCHAR(4)
	DECLARE @ARTICULO VARCHAR(20)
	DECLARE @LOCALIZACION VARCHAR(8)
	DECLARE @LOTE VARCHAR(15)
	DECLARE @CANT_DISPONIBLE DECIMAL(28,8)
	DECLARE @CANT_RESERVADA DECIMAL(28,8)
	DECLARE @APLICARMOVIMIENTO INT
	 -- Declaraciones
	SET @ERROR = 0
	SELECT @PUBLICADOR = SITIO_LOCAL, @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_MODIFIED CURSOR LOCAL FOR
			SELECT BODEGA, ARTICULO, LOCALIZACION, LOTE, CANT_DISPONIBLE, CANT_RESERVADA
			FROM INSERTED I
		SET @ACTUALIZAR_SOLICITUD = 1
		OPEN C_MODIFIED
		FETCH NEXT FROM C_MODIFIED
		INTO @BODEGA, @ARTICULO, @LOCALIZACION, @LOTE, @CANT_DISPONIBLE, @CANT_RESERVADA

		SELECT @APLICARMOVIMIENTO = COUNT(*)
		FROM $$Compania$$.V_SITIO_BODEGA
		WHERE BODEGA = @BODEGA
		
		IF @APLICARMOVIMIENTO > 0
		BEGIN					
			WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
			BEGIN
				IF ( NOT UPDATE(RECORDDATE) AND ( UPDATE(BODEGA) OR UPDATE(ARTICULO) OR UPDATE(LOCALIZACION) OR UPDATE(LOTE) OR UPDATE(CANT_DISPONIBLE) OR UPDATE(CANT_RESERVADA) ) )
				BEGIN
					SELECT @COL_ROWPOINTER = ROWPOINTER
					FROM $$Compania$$.EXISTENCIA_LOTE  WITH (NOLOCK)
					WHERE BODEGA = @BODEGA AND ARTICULO = @ARTICULO AND LOCALIZACION = @LOCALIZACION AND LOTE = @LOTE
					SET @PARAMETROS =
						'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
					'<EXISTENCIA_LOTE>' +
					'<BODEGA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@BODEGA) + '</BODEGA>' +
					'<ARTICULO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@ARTICULO) + '</ARTICULO>' +
					'<LOCALIZACION Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@LOCALIZACION) + '</LOCALIZACION>' +
					'<LOTE Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@LOTE) + '</LOTE>' +
					'<CANT_DISPONIBLE Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@CANT_DISPONIBLE) + '</CANT_DISPONIBLE>' +
					'<CANT_RESERVADA Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@CANT_RESERVADA) + '</CANT_RESERVADA>' +
					'</EXISTENCIA_LOTE>'
					-- inserta la solicitud correspondiente
					EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'EXISTENCIALOTEPOS600', 'MODIFICA', @PARAMETROS, @ACTUALIZAR_SOLICITUD, @COL_ROWPOINTER
				END
				FETCH NEXT FROM C_MODIFIED
				INTO @BODEGA, @ARTICULO, @LOCALIZACION, @LOTE, @CANT_DISPONIBLE, @CANT_RESERVADA
			END


		END
		CLOSE C_MODIFIED
		DEALLOCATE C_MODIFIED
	END
	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para modificar la tabla EXISTENCIA_LOTE.',16,1 )
	END
END
;





CREATE TRIGGER $$Compania$$.EXISTENCIA_RESERVA_POS_INS
ON $$Compania$$.EXISTENCIA_RESERVA
FOR INSERT
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @ARTICULO VARCHAR(20)
	DECLARE @APLICACION VARCHAR(20)
	DECLARE @BODEGA VARCHAR(4)
	DECLARE @LOTE VARCHAR(15)
	DECLARE @LOCALIZACION VARCHAR(8)
	DECLARE @SERIE_CADENA INT
	DECLARE @MODULO_ORIGEN VARCHAR(4)
	DECLARE @CANTIDAD DECIMAL(28,8)
	DECLARE @USUARIO VARCHAR(25)
	DECLARE @FECHA_HORA DATETIME
	
	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_INSERTED CURSOR LOCAL FOR
		SELECT ARTICULO, APLICACION, BODEGA, LOTE, LOCALIZACION, SERIE_CADENA, MODULO_ORIGEN, CANTIDAD, USUARIO, FECHA_HORA
		FROM INSERTED i
		WHERE 0 = (
				SELECT COUNT('n')
				FROM DELETED d
				WHERE i.ARTICULO = d.ARTICULO AND i.APLICACION = d.APLICACION AND i.BODEGA = d.BODEGA AND i.LOTE = d.LOTE AND i.LOCALIZACION = d.LOCALIZACION
			   )
			
		OPEN C_INSERTED	
		FETCH NEXT FROM C_INSERTED INTO
		@ARTICULO, @APLICACION, @BODEGA, @LOTE, @LOCALIZACION, @SERIE_CADENA, @MODULO_ORIGEN, @CANTIDAD, @USUARIO, @FECHA_HORA
		SET @ERROR = 0
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS =
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<EXISTENCIA_RESERVA>' +
				'<ARTICULO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@ARTICULO) + '</ARTICULO>' +
				'<APLICACION Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@APLICACION) + '</APLICACION>' +
				'<BODEGA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@BODEGA) + '</BODEGA>' +
				'<LOTE Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@LOTE) + '</LOTE>' +
				'<LOCALIZACION Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@LOCALIZACION) + '</LOCALIZACION>' +
				'<SERIE_CADENA Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@SERIE_CADENA) + '</SERIE_CADENA>' +
				'<MODULO_ORIGEN Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@MODULO_ORIGEN) + '</MODULO_ORIGEN>' +
				'<CANTIDAD Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@CANTIDAD) + '</CANTIDAD>' +
				'<USUARIO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USUARIO) + '</USUARIO>' +
				'<FECHA_HORA Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_HORA) + '</FECHA_HORA>' +
				'</EXISTENCIA_RESERVA>'
			-- Inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'EXISTENCIARESERVAPOS600', 'INSERTA', @PARAMETROS, 0, ''
			FETCH NEXT FROM C_INSERTED INTO
			@ARTICULO, @APLICACION, @BODEGA, @LOTE, @LOCALIZACION, @SERIE_CADENA, @MODULO_ORIGEN, @CANTIDAD, @USUARIO, @FECHA_HORA
		END
		CLOSE C_INSERTED
    		DEALLOCATE C_INSERTED
	END
	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla EXISTENCIA_RESERVA.',16,1 )
	END
END
;




CREATE TRIGGER $$Compania$$.EXISTENCIA_RESERVA_POS_DEL
ON $$Compania$$.EXISTENCIA_RESERVA
FOR DELETE
AS
BEGIN   	
                DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @ARTICULO VARCHAR(20)
	DECLARE @APLICACION VARCHAR(20)
	DECLARE @BODEGA VARCHAR(4)
	DECLARE @LOTE VARCHAR(15)
	DECLARE @LOCALIZACION VARCHAR(8)
	 -- Declaraciones	
	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_DELETED CURSOR LOCAL FOR
			SELECT ARTICULO, APLICACION, BODEGA, LOTE, LOCALIZACION
			FROM DELETED d
			WHERE 0 = (
				SELECT COUNT('n')
				FROM INSERTED i
				WHERE d.ARTICULO = i.ARTICULO AND d.APLICACION = i.APLICACION AND d.BODEGA = i.BODEGA AND d.LOTE = i.LOTE AND d.LOCALIZACION = i.LOCALIZACION
			   )
		OPEN C_DELETED
		FETCH NEXT FROM C_DELETED INTO
		@ARTICULO, @APLICACION, @BODEGA, @LOTE, @LOCALIZACION
		
		SET @ERROR = 0
		
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS =
								'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<EXISTENCIA_RESERVA>' +
				'<ARTICULO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@ARTICULO) + '</ARTICULO>' +
				'<APLICACION Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@APLICACION) + '</APLICACION>' +
				'<BODEGA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@BODEGA) + '</BODEGA>' +
				'<LOTE Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@LOTE) + '</LOTE>' +
				'<LOCALIZACION Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@LOCALIZACION) + '</LOCALIZACION>' +
				'</EXISTENCIA_RESERVA>'
 -- XML
			
			-- inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'EXISTENCIARESERVAPOS600', 'ELIMINA', @PARAMETROS, 0, ''
			
			FETCH NEXT FROM C_DELETED INTO
			@ARTICULO, @APLICACION, @BODEGA, @LOTE, @LOCALIZACION
		END
		CLOSE C_DELETED
		DEALLOCATE C_DELETED
	END
	
	IF (@@ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para eliminar de la tabla EXISTENCIA_RESERVA.',16,1 )
	END
END
;




CREATE TRIGGER $$Compania$$.EXISTENCIA_RESERVA_POS_MOD
ON $$Compania$$.EXISTENCIA_RESERVA
FOR UPDATE
AS
BEGIN   	
	DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @COL_ROWPOINTER VARCHAR(36)
	DECLARE @HAY_CAMPOS_PARA_POS BIT
	DECLARE @ACTUALIZAR_SOLICITUD BIT
	DECLARE @ARTICULO VARCHAR(20)
	DECLARE @APLICACION VARCHAR(20)
	DECLARE @BODEGA VARCHAR(4)
	DECLARE @LOTE VARCHAR(15)
	DECLARE @LOCALIZACION VARCHAR(8)
	DECLARE @SERIE_CADENA INT
	DECLARE @MODULO_ORIGEN VARCHAR(4)
	DECLARE @CANTIDAD DECIMAL(28,8)
	DECLARE @USUARIO VARCHAR(25)
	DECLARE @FECHA_HORA DATETIME
	DECLARE @APLICARMOVIMIENTO INT
	 -- Declaraciones
	SET @ERROR = 0
	SELECT @PUBLICADOR = SITIO_LOCAL, @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_MODIFIED CURSOR LOCAL FOR
			SELECT ARTICULO, APLICACION, BODEGA, LOTE, LOCALIZACION, SERIE_CADENA, MODULO_ORIGEN, CANTIDAD, USUARIO, FECHA_HORA -- Columnas
			FROM INSERTED I
		SET @ACTUALIZAR_SOLICITUD = 1
		OPEN C_MODIFIED
		FETCH NEXT FROM C_MODIFIED
		INTO @ARTICULO, @APLICACION, @BODEGA, @LOTE, @LOCALIZACION, @SERIE_CADENA, @MODULO_ORIGEN, @CANTIDAD, @USUARIO, @FECHA_HORA
		
		SELECT @APLICARMOVIMIENTO = COUNT(*)
		FROM $$Compania$$.V_SITIO_BODEGA
		WHERE BODEGA = @BODEGA
		
		IF @APLICARMOVIMIENTO > 0
		BEGIN					
			WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
			BEGIN
				IF ( NOT UPDATE(RECORDDATE) AND ( UPDATE(ARTICULO) OR UPDATE(APLICACION) OR UPDATE(BODEGA) OR UPDATE(LOTE) OR UPDATE(LOCALIZACION) OR UPDATE(SERIE_CADENA) OR UPDATE(MODULO_ORIGEN) OR UPDATE(CANTIDAD) OR UPDATE(USUARIO) OR UPDATE(FECHA_HORA) ) )
				BEGIN
					SELECT @COL_ROWPOINTER = ROWPOINTER
					FROM $$Compania$$.EXISTENCIA_RESERVA  WITH (NOLOCK)
					WHERE ARTICULO = @ARTICULO AND APLICACION = @APLICACION AND BODEGA = @BODEGA AND LOTE = @LOTE AND LOCALIZACION = @LOCALIZACION
					SET @PARAMETROS =
						'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
					'<EXISTENCIA_RESERVA>' +
					'<ARTICULO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@ARTICULO) + '</ARTICULO>' +
					'<APLICACION Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@APLICACION) + '</APLICACION>' +
					'<BODEGA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@BODEGA) + '</BODEGA>' +
					'<LOTE Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@LOTE) + '</LOTE>' +
					'<LOCALIZACION Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@LOCALIZACION) + '</LOCALIZACION>' +
					'<SERIE_CADENA Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@SERIE_CADENA) + '</SERIE_CADENA>' +
					'<MODULO_ORIGEN Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@MODULO_ORIGEN) + '</MODULO_ORIGEN>' +
					'<CANTIDAD Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@CANTIDAD) + '</CANTIDAD>' +
					'<USUARIO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USUARIO) + '</USUARIO>' +
					'<FECHA_HORA Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_HORA) + '</FECHA_HORA>' +
					'</EXISTENCIA_RESERVA>'
					-- inserta la solicitud correspondiente
					EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'EXISTENCIARESERVAPOS600', 'MODIFICA', @PARAMETROS, @ACTUALIZAR_SOLICITUD, @COL_ROWPOINTER
				END
				FETCH NEXT FROM C_MODIFIED
				INTO @ARTICULO, @APLICACION, @BODEGA, @LOTE, @LOCALIZACION, @SERIE_CADENA, @MODULO_ORIGEN, @CANTIDAD, @USUARIO, @FECHA_HORA
			END
		END
		CLOSE C_MODIFIED
		DEALLOCATE C_MODIFIED
	END
	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para modificar la tabla EXISTENCIA_RESERVA.',16,1 )
	END
END
;





CREATE TRIGGER $$Compania$$.EXISTENCIA_SERIE_POS_INS
ON $$Compania$$.EXISTENCIA_SERIE
FOR INSERT
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @BODEGA VARCHAR(4)
	DECLARE @LOTE VARCHAR(15)
	DECLARE @TIPO VARCHAR(1)
	DECLARE @LOCALIZACION VARCHAR(8)
	DECLARE @ARTICULO VARCHAR(20)
	DECLARE @SERIE_INICIAL VARCHAR(20)
	DECLARE @SERIE_FINAL VARCHAR(20)
	DECLARE @CANTIDAD DECIMAL(28,8)
	
	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_INSERTED CURSOR LOCAL FOR
		SELECT BODEGA, LOTE, TIPO, LOCALIZACION, ARTICULO, SERIE_INICIAL, SERIE_FINAL, CANTIDAD
		FROM INSERTED i
		WHERE 0 = (
				SELECT COUNT('n')
				FROM DELETED d
				WHERE i.BODEGA = d.BODEGA AND i.LOTE = d.LOTE AND i.TIPO = d.TIPO AND i.LOCALIZACION = d.LOCALIZACION AND i.ARTICULO = d.ARTICULO AND i.SERIE_INICIAL = d.SERIE_INICIAL AND i.SERIE_FINAL = d.SERIE_FINAL
			   )
			
		OPEN C_INSERTED	
		FETCH NEXT FROM C_INSERTED INTO
		@BODEGA, @LOTE, @TIPO, @LOCALIZACION, @ARTICULO, @SERIE_INICIAL, @SERIE_FINAL, @CANTIDAD
		SET @ERROR = 0
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS =
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<EXISTENCIA_SERIE>' +
				'<BODEGA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@BODEGA) + '</BODEGA>' +
				'<LOTE Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@LOTE) + '</LOTE>' +
				'<TIPO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO) + '</TIPO>' +
				'<LOCALIZACION Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@LOCALIZACION) + '</LOCALIZACION>' +
				'<ARTICULO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@ARTICULO) + '</ARTICULO>' +
				'<SERIE_INICIAL Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@SERIE_INICIAL) + '</SERIE_INICIAL>' +
				'<SERIE_FINAL Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@SERIE_FINAL) + '</SERIE_FINAL>' +
				'<CANTIDAD Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@CANTIDAD) + '</CANTIDAD>' +
				'</EXISTENCIA_SERIE>'
			-- Inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'EXISTENCIASERIEPOS600', 'INSERTA', @PARAMETROS, 0, ''
			FETCH NEXT FROM C_INSERTED INTO
			@BODEGA, @LOTE, @TIPO, @LOCALIZACION, @ARTICULO, @SERIE_INICIAL, @SERIE_FINAL, @CANTIDAD
		END
		CLOSE C_INSERTED
    		DEALLOCATE C_INSERTED
	END
	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla EXISTENCIA_SERIE.',16,1 )
	END
END
;
CREATE TRIGGER $$Compania$$.EXISTENCIA_SERIE_POS_DEL
ON $$Compania$$.EXISTENCIA_SERIE
FOR DELETE
AS
BEGIN   	
                DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @BODEGA VARCHAR(4)
	DECLARE @LOTE VARCHAR(15)
	DECLARE @TIPO VARCHAR(1)
	DECLARE @LOCALIZACION VARCHAR(8)
	DECLARE @ARTICULO VARCHAR(20)
	DECLARE @SERIE_INICIAL VARCHAR(20)
	DECLARE @SERIE_FINAL VARCHAR(20)
	 -- Declaraciones	
	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_DELETED CURSOR LOCAL FOR
			SELECT BODEGA, LOTE, TIPO, LOCALIZACION, ARTICULO, SERIE_INICIAL, SERIE_FINAL
			FROM DELETED d
			WHERE 0 = (
				SELECT COUNT('n')
				FROM INSERTED i
				WHERE d.BODEGA = i.BODEGA AND d.LOTE = i.LOTE AND d.TIPO = i.TIPO AND d.LOCALIZACION = i.LOCALIZACION AND d.ARTICULO = i.ARTICULO AND d.SERIE_INICIAL = i.SERIE_INICIAL AND d.SERIE_FINAL = i.SERIE_FINAL
			   )
		OPEN C_DELETED
		FETCH NEXT FROM C_DELETED INTO
		@BODEGA, @LOTE, @TIPO, @LOCALIZACION, @ARTICULO, @SERIE_INICIAL, @SERIE_FINAL
		
		SET @ERROR = 0
		
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS =
								'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<EXISTENCIA_SERIE>' +
				'<BODEGA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@BODEGA) + '</BODEGA>' +
				'<LOTE Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@LOTE) + '</LOTE>' +
				'<TIPO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO) + '</TIPO>' +
				'<LOCALIZACION Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@LOCALIZACION) + '</LOCALIZACION>' +
				'<ARTICULO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@ARTICULO) + '</ARTICULO>' +
				'<SERIE_INICIAL Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@SERIE_INICIAL) + '</SERIE_INICIAL>' +
				'<SERIE_FINAL Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@SERIE_FINAL) + '</SERIE_FINAL>' +
				'</EXISTENCIA_SERIE>'
 -- XML
			
			-- inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'EXISTENCIASERIEPOS600', 'ELIMINA', @PARAMETROS, 0, ''
			
			FETCH NEXT FROM C_DELETED INTO
			@BODEGA, @LOTE, @TIPO, @LOCALIZACION, @ARTICULO, @SERIE_INICIAL, @SERIE_FINAL
		END
		CLOSE C_DELETED
		DEALLOCATE C_DELETED
	END
	
	IF (@@ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para eliminar de la tabla EXISTENCIA_SERIE.',16,1 )
	END
END
;




CREATE TRIGGER $$Compania$$.EXISTENCIA_SERIE_POS_MOD
ON $$Compania$$.EXISTENCIA_SERIE
FOR UPDATE
AS
BEGIN   	
	DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @COL_ROWPOINTER VARCHAR(36)
	DECLARE @HAY_CAMPOS_PARA_POS BIT
	DECLARE @ACTUALIZAR_SOLICITUD BIT
	DECLARE @BODEGA VARCHAR(4)
	DECLARE @LOTE VARCHAR(15)
	DECLARE @TIPO VARCHAR(1)
	DECLARE @LOCALIZACION VARCHAR(8)
	DECLARE @ARTICULO VARCHAR(20)
	DECLARE @SERIE_INICIAL VARCHAR(20)
	DECLARE @SERIE_FINAL VARCHAR(20)
	DECLARE @CANTIDAD DECIMAL(28,8)
	DECLARE @APLICARMOVIMIENTO INT
	 -- Declaraciones
	SET @ERROR = 0
	SELECT @PUBLICADOR = SITIO_LOCAL, @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_MODIFIED CURSOR LOCAL FOR
			SELECT BODEGA, LOTE, TIPO, LOCALIZACION, ARTICULO, SERIE_INICIAL, SERIE_FINAL, CANTIDAD -- Columnas
			FROM INSERTED I
		SET @ACTUALIZAR_SOLICITUD = 1
		OPEN C_MODIFIED
		FETCH NEXT FROM C_MODIFIED
		INTO @BODEGA, @LOTE, @TIPO, @LOCALIZACION, @ARTICULO, @SERIE_INICIAL, @SERIE_FINAL, @CANTIDAD

		SELECT @APLICARMOVIMIENTO = COUNT(*)
		FROM $$Compania$$.V_SITIO_BODEGA
		WHERE BODEGA = @BODEGA
		
		IF @APLICARMOVIMIENTO > 0
		BEGIN					
			WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
			BEGIN
				IF ( NOT UPDATE(RECORDDATE) AND ( UPDATE(BODEGA) OR UPDATE(LOTE) OR UPDATE(TIPO) OR UPDATE(LOCALIZACION) OR UPDATE(ARTICULO) OR UPDATE(SERIE_INICIAL) OR UPDATE(SERIE_FINAL) OR UPDATE(CANTIDAD) ) )
				BEGIN
					SELECT @COL_ROWPOINTER = ROWPOINTER
					FROM $$Compania$$.EXISTENCIA_SERIE  WITH (NOLOCK)
					WHERE BODEGA = @BODEGA AND LOTE = @LOTE AND TIPO = @TIPO AND LOCALIZACION = @LOCALIZACION AND ARTICULO = @ARTICULO AND SERIE_INICIAL = @SERIE_INICIAL AND SERIE_FINAL = @SERIE_FINAL
					SET @PARAMETROS =
						'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
					'<EXISTENCIA_SERIE>' +
					'<BODEGA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@BODEGA) + '</BODEGA>' +
					'<LOTE Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@LOTE) + '</LOTE>' +
					'<TIPO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO) + '</TIPO>' +
					'<LOCALIZACION Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@LOCALIZACION) + '</LOCALIZACION>' +
					'<ARTICULO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@ARTICULO) + '</ARTICULO>' +
					'<SERIE_INICIAL Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@SERIE_INICIAL) + '</SERIE_INICIAL>' +
					'<SERIE_FINAL Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@SERIE_FINAL) + '</SERIE_FINAL>' +
					'<CANTIDAD Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@CANTIDAD) + '</CANTIDAD>' +
					'</EXISTENCIA_SERIE>'
					-- inserta la solicitud correspondiente
					EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'EXISTENCIASERIEPOS600', 'MODIFICA', @PARAMETROS, @ACTUALIZAR_SOLICITUD, @COL_ROWPOINTER
				END
				FETCH NEXT FROM C_MODIFIED
				INTO @BODEGA, @LOTE, @TIPO, @LOCALIZACION, @ARTICULO, @SERIE_INICIAL, @SERIE_FINAL, @CANTIDAD
			END
		END
		CLOSE C_MODIFIED
		DEALLOCATE C_MODIFIED
	END
	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para modificar la tabla EXISTENCIA_SERIE.',16,1 )
	END
END
;


CREATE TRIGGER $$Compania$$.FACTURA_DEVUELTA_POS_INS
ON $$Compania$$.FACTURA_DEVUELTA
FOR INSERT
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @DEV_DOCUMENTO VARCHAR(50)
	DECLARE @DEV_CAJA VARCHAR(6)
	DECLARE @DEV_TIPO VARCHAR(1)
	DECLARE @FAC_DOCUMENTO VARCHAR(50)
	DECLARE @FAC_CAJA VARCHAR(6)
	DECLARE @FAC_TIPO VARCHAR(1)
	
	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_INSERTED CURSOR LOCAL FOR
		SELECT DEV_DOCUMENTO, DEV_CAJA, DEV_TIPO, FAC_DOCUMENTO, FAC_CAJA, FAC_TIPO
		FROM INSERTED i
		WHERE 0 = (
				SELECT COUNT('n')
				FROM DELETED d
				WHERE i.DEV_DOCUMENTO = d.DEV_DOCUMENTO AND i.DEV_CAJA = d.DEV_CAJA AND i.DEV_TIPO = d.DEV_TIPO
			   )
			
		OPEN C_INSERTED	
		FETCH NEXT FROM C_INSERTED INTO
		@DEV_DOCUMENTO, @DEV_CAJA, @DEV_TIPO, @FAC_DOCUMENTO, @FAC_CAJA, @FAC_TIPO
		SET @ERROR = 0
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS =
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<FACTURA_DEVUELTA>' +
				'<DEV_DOCUMENTO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@DEV_DOCUMENTO) + '</DEV_DOCUMENTO>' +
				'<DEV_CAJA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@DEV_CAJA) + '</DEV_CAJA>' +
				'<DEV_TIPO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@DEV_TIPO) + '</DEV_TIPO>' +
				'<FAC_DOCUMENTO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@FAC_DOCUMENTO) + '</FAC_DOCUMENTO>' +
				'<FAC_CAJA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@FAC_CAJA) + '</FAC_CAJA>' +
				'<FAC_TIPO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@FAC_TIPO) + '</FAC_TIPO>' +
				'</FACTURA_DEVUELTA>'
			-- Inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'FACTURADEVUELTAPOS600', 'INSERTA', @PARAMETROS, 0, ''
			FETCH NEXT FROM C_INSERTED INTO
			@DEV_DOCUMENTO, @DEV_CAJA, @DEV_TIPO, @FAC_DOCUMENTO, @FAC_CAJA, @FAC_TIPO
		END
		CLOSE C_INSERTED
    		DEALLOCATE C_INSERTED
	END
	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla FACTURA_DEVUELTA.',16,1 )
	END
END;




CREATE TRIGGER $$Compania$$.FACTURA_DEVUELTA_POS_DEL
ON $$Compania$$.FACTURA_DEVUELTA
FOR DELETE
AS
BEGIN   	
                DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @DEV_DOCUMENTO VARCHAR(50)
	DECLARE @DEV_CAJA VARCHAR(6)
	DECLARE @DEV_TIPO VARCHAR(1)
	 -- Declaraciones	
	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_DELETED CURSOR LOCAL FOR
			SELECT DEV_DOCUMENTO, DEV_CAJA, DEV_TIPO
			FROM DELETED d
			WHERE 0 = (
				SELECT COUNT('n')
				FROM INSERTED i
				WHERE d.DEV_DOCUMENTO = i.DEV_DOCUMENTO AND d.DEV_CAJA = i.DEV_CAJA AND d.DEV_TIPO = i.DEV_TIPO
			   )
		OPEN C_DELETED
		FETCH NEXT FROM C_DELETED INTO
		@DEV_DOCUMENTO, @DEV_CAJA, @DEV_TIPO
		
		SET @ERROR = 0
		
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS =
								'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<FACTURA_DEVUELTA>' +
				'<DEV_DOCUMENTO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@DEV_DOCUMENTO) + '</DEV_DOCUMENTO>' +
				'<DEV_CAJA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@DEV_CAJA) + '</DEV_CAJA>' +
				'<DEV_TIPO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@DEV_TIPO) + '</DEV_TIPO>' +
				'</FACTURA_DEVUELTA>'
 -- XML
			
			-- inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'FACTURADEVUELTAPOS600', 'ELIMINA', @PARAMETROS, 0, ''
			
			FETCH NEXT FROM C_DELETED INTO
			@DEV_DOCUMENTO, @DEV_CAJA, @DEV_TIPO
		END
		CLOSE C_DELETED
		DEALLOCATE C_DELETED
	END
	
	IF (@@ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para eliminar de la tabla FACTURA_DEVUELTA.',16,1 )
	END
END;




CREATE TRIGGER $$Compania$$.FACTURA_DEVUELTA_POS_MOD
ON $$Compania$$.FACTURA_DEVUELTA
FOR UPDATE
AS
BEGIN   	
	DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @COL_ROWPOINTER VARCHAR(36)
	DECLARE @HAY_CAMPOS_PARA_POS BIT
	DECLARE @ACTUALIZAR_SOLICITUD BIT
	DECLARE @DEV_DOCUMENTO VARCHAR(50)
	DECLARE @DEV_CAJA VARCHAR(6)
	DECLARE @DEV_TIPO VARCHAR(1)
	DECLARE @FAC_DOCUMENTO VARCHAR(50)
	DECLARE @FAC_CAJA VARCHAR(6)
	DECLARE @FAC_TIPO VARCHAR(1)
	 -- Declaraciones
	SET @ERROR = 0
	SELECT @PUBLICADOR = SITIO_LOCAL, @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_MODIFIED CURSOR LOCAL FOR
			SELECT DEV_DOCUMENTO, DEV_CAJA, DEV_TIPO, FAC_DOCUMENTO, FAC_CAJA, FAC_TIPO -- Columnas
			FROM INSERTED I
		SET @ACTUALIZAR_SOLICITUD = 1
		OPEN C_MODIFIED
		FETCH NEXT FROM C_MODIFIED
		INTO @DEV_DOCUMENTO, @DEV_CAJA, @DEV_TIPO, @FAC_DOCUMENTO, @FAC_CAJA, @FAC_TIPO
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			IF ( NOT UPDATE(RECORDDATE) AND ( UPDATE(DEV_DOCUMENTO) OR UPDATE(DEV_CAJA) OR UPDATE(DEV_TIPO) OR UPDATE(FAC_DOCUMENTO) OR UPDATE(FAC_CAJA) OR UPDATE(FAC_TIPO) ) )
			BEGIN
				SELECT @COL_ROWPOINTER = ROWPOINTER
				FROM $$Compania$$.FACTURA_DEVUELTA
				WHERE DEV_DOCUMENTO = @DEV_DOCUMENTO AND DEV_CAJA = @DEV_CAJA AND DEV_TIPO = @DEV_TIPO
				SET @PARAMETROS =
					'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<FACTURA_DEVUELTA>' +
				'<DEV_DOCUMENTO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@DEV_DOCUMENTO) + '</DEV_DOCUMENTO>' +
				'<DEV_CAJA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@DEV_CAJA) + '</DEV_CAJA>' +
				'<DEV_TIPO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@DEV_TIPO) + '</DEV_TIPO>' +
				'<FAC_DOCUMENTO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@FAC_DOCUMENTO) + '</FAC_DOCUMENTO>' +
				'<FAC_CAJA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@FAC_CAJA) + '</FAC_CAJA>' +
				'<FAC_TIPO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@FAC_TIPO) + '</FAC_TIPO>' +
				'</FACTURA_DEVUELTA>'
				-- inserta la solicitud correspondiente
				EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'FACTURADEVUELTAPOS600', 'MODIFICA', @PARAMETROS, @ACTUALIZAR_SOLICITUD, @COL_ROWPOINTER
			END
			FETCH NEXT FROM C_MODIFIED
			INTO @DEV_DOCUMENTO, @DEV_CAJA, @DEV_TIPO, @FAC_DOCUMENTO, @FAC_CAJA, @FAC_TIPO
		END
		CLOSE C_MODIFIED
		DEALLOCATE C_MODIFIED
	END
	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para modificar la tabla FACTURA_DEVUELTA.',16,1 )
	END
END;



CREATE TRIGGER $$Compania$$.FORMA_PAGO_POS_INS
ON $$Compania$$.FORMA_PAGO
FOR INSERT
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @FORMA_PAGO VARCHAR(4)
	DECLARE @DESCRIPCION VARCHAR(40)
	DECLARE @IMPRESION_DOBLE VARCHAR(1)
	DECLARE @CANTIDAD INT
	DECLARE @FORMULARIO VARCHAR(40)
	DECLARE @USO_INTERNO VARCHAR(1)
	DECLARE @ACTIVO VARCHAR(1)
	DECLARE @CENTRO_COSTO VARCHAR(25)
	DECLARE @CUENTA_CONTABLE VARCHAR(25)
	DECLARE @NOMBRE_CAMPO1 VARCHAR(40)
	DECLARE @NOMBRE_CAMPO2 VARCHAR(40)
	DECLARE @MONEDA_REPORTE VARCHAR(1)
	

	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM 
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_INSERTED CURSOR LOCAL FOR
		SELECT FORMA_PAGO, DESCRIPCION, IMPRESION_DOBLE, CANTIDAD, FORMULARIO, USO_INTERNO, ACTIVO, CENTRO_COSTO, CUENTA_CONTABLE, NOMBRE_CAMPO1, NOMBRE_CAMPO2, MONEDA_REPORTE
		FROM INSERTED i
			
		OPEN C_INSERTED	
		FETCH NEXT FROM C_INSERTED INTO
		@FORMA_PAGO, @DESCRIPCION, @IMPRESION_DOBLE, @CANTIDAD, @FORMULARIO, @USO_INTERNO, @ACTIVO, @CENTRO_COSTO, @CUENTA_CONTABLE, @NOMBRE_CAMPO1, @NOMBRE_CAMPO2, @MONEDA_REPORTE

		SET @ERROR = 0
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS = 
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<FORMA_PAGO>' + 
				'<FORMA_PAGO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@FORMA_PAGO) + '</FORMA_PAGO>' + 
				'<DESCRIPCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DESCRIPCION) + '</DESCRIPCION>' + 
				'<IMPRESION_DOBLE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@IMPRESION_DOBLE) + '</IMPRESION_DOBLE>' + 
				'<CANTIDAD Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@CANTIDAD) + '</CANTIDAD>' + 
				'<FORMULARIO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@FORMULARIO) + '</FORMULARIO>' + 
				'<USO_INTERNO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USO_INTERNO) + '</USO_INTERNO>' + 
				'<ACTIVO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ACTIVO) + '</ACTIVO>' + 
				'<CENTRO_COSTO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CENTRO_COSTO) + '</CENTRO_COSTO>' + 
				'<CUENTA_CONTABLE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CUENTA_CONTABLE) + '</CUENTA_CONTABLE>' + 
				'<NOMBRE_CAMPO1 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOMBRE_CAMPO1) + '</NOMBRE_CAMPO1>' + 
				'<NOMBRE_CAMPO2 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOMBRE_CAMPO2) + '</NOMBRE_CAMPO2>' + 
				'<MONEDA_REPORTE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@MONEDA_REPORTE) + '</MONEDA_REPORTE>' + 
				'</FORMA_PAGO>'


			-- Inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'FORMAPAGOPOS600', 'INSERTA', @PARAMETROS, 0, ''

			FETCH NEXT FROM C_INSERTED INTO
			@FORMA_PAGO, @DESCRIPCION, @IMPRESION_DOBLE, @CANTIDAD, @FORMULARIO, @USO_INTERNO, @ACTIVO, @CENTRO_COSTO, @CUENTA_CONTABLE, @NOMBRE_CAMPO1, @NOMBRE_CAMPO2, @MONEDA_REPORTE
		END

		CLOSE C_INSERTED
    		DEALLOCATE C_INSERTED
	END

	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla FORMA_PAGO.',16,1 )
	END
END;



CREATE TRIGGER $$Compania$$.FORMA_PAGO_POS_MOD
ON $$Compania$$.FORMA_PAGO
FOR UPDATE
AS 
BEGIN   	
	DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @COL_ROWPOINTER VARCHAR(36)
	DECLARE @HAY_CAMPOS_PARA_POS BIT
	DECLARE @ACTUALIZAR_SOLICITUD BIT
	DECLARE @FORMA_PAGO VARCHAR(4)
	DECLARE @DESCRIPCION VARCHAR(40)
	DECLARE @IMPRESION_DOBLE VARCHAR(1)
	DECLARE @CANTIDAD INT
	DECLARE @FORMULARIO VARCHAR(40)
	DECLARE @USO_INTERNO VARCHAR(1)
	DECLARE @ACTIVO VARCHAR(1)
	DECLARE @CENTRO_COSTO VARCHAR(25)
	DECLARE @CUENTA_CONTABLE VARCHAR(25)
	DECLARE @NOMBRE_CAMPO1 VARCHAR(40)
	DECLARE @NOMBRE_CAMPO2 VARCHAR(40)
	DECLARE @MONEDA_REPORTE VARCHAR(1)
	 -- Declaraciones

	SET @ERROR = 0

	SELECT @PUBLICADOR = SITIO_LOCAL, @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_MODIFIED CURSOR LOCAL FOR
			SELECT FORMA_PAGO, DESCRIPCION, IMPRESION_DOBLE, CANTIDAD, FORMULARIO, USO_INTERNO, ACTIVO, CENTRO_COSTO, CUENTA_CONTABLE, NOMBRE_CAMPO1, NOMBRE_CAMPO2, MONEDA_REPORTE -- Columnas
			FROM INSERTED I

		SET @ACTUALIZAR_SOLICITUD = 1

		OPEN C_MODIFIED

		FETCH NEXT FROM C_MODIFIED
		INTO @FORMA_PAGO, @DESCRIPCION, @IMPRESION_DOBLE, @CANTIDAD, @FORMULARIO, @USO_INTERNO, @ACTIVO, @CENTRO_COSTO, @CUENTA_CONTABLE, @NOMBRE_CAMPO1, @NOMBRE_CAMPO2, @MONEDA_REPORTE

		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			IF ( NOT UPDATE(RECORDDATE) AND ( UPDATE(FORMA_PAGO) OR UPDATE(DESCRIPCION) OR UPDATE(IMPRESION_DOBLE) OR UPDATE(CANTIDAD) OR UPDATE(FORMULARIO) OR UPDATE(USO_INTERNO) OR UPDATE(ACTIVO) OR UPDATE(CENTRO_COSTO) OR UPDATE(CUENTA_CONTABLE) OR UPDATE(NOMBRE_CAMPO1) OR UPDATE(NOMBRE_CAMPO2) OR UPDATE(MONEDA_REPORTE) ) )
			BEGIN

				SELECT @COL_ROWPOINTER = ROWPOINTER 
				FROM $$Compania$$.FORMA_PAGO
				WHERE FORMA_PAGO = @FORMA_PAGO 

				SET @PARAMETROS =
					'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<FORMA_PAGO>' + 
				'<FORMA_PAGO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@FORMA_PAGO) + '</FORMA_PAGO>' + 
				'<DESCRIPCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DESCRIPCION) + '</DESCRIPCION>' + 
				'<IMPRESION_DOBLE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@IMPRESION_DOBLE) + '</IMPRESION_DOBLE>' + 
				'<CANTIDAD Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@CANTIDAD) + '</CANTIDAD>' + 
				'<FORMULARIO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@FORMULARIO) + '</FORMULARIO>' + 
				'<USO_INTERNO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USO_INTERNO) + '</USO_INTERNO>' + 
				'<ACTIVO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ACTIVO) + '</ACTIVO>' + 
				'<CENTRO_COSTO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CENTRO_COSTO) + '</CENTRO_COSTO>' + 
				'<CUENTA_CONTABLE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CUENTA_CONTABLE) + '</CUENTA_CONTABLE>' + 
				'<NOMBRE_CAMPO1 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOMBRE_CAMPO1) + '</NOMBRE_CAMPO1>' + 
				'<NOMBRE_CAMPO2 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOMBRE_CAMPO2) + '</NOMBRE_CAMPO2>' + 
				'<MONEDA_REPORTE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@MONEDA_REPORTE) + '</MONEDA_REPORTE>' + 
				'</FORMA_PAGO>'


				-- inserta la solicitud correspondiente
				EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'FORMAPAGOPOS600', 'MODIFICA', @PARAMETROS, @ACTUALIZAR_SOLICITUD, @COL_ROWPOINTER
			END

			FETCH NEXT FROM C_MODIFIED
			INTO @FORMA_PAGO, @DESCRIPCION, @IMPRESION_DOBLE, @CANTIDAD, @FORMULARIO, @USO_INTERNO, @ACTIVO, @CENTRO_COSTO, @CUENTA_CONTABLE, @NOMBRE_CAMPO1, @NOMBRE_CAMPO2, @MONEDA_REPORTE
		END

		CLOSE C_MODIFIED
		DEALLOCATE C_MODIFIED
	END

	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para modificar la tabla FORMA_PAGO.',16,1 )
	END
END;






CREATE TRIGGER $$Compania$$.FORMA_PAGO_POS_DEL
ON $$Compania$$.FORMA_PAGO
FOR DELETE
AS
BEGIN   	
                DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @TIPO_SITIO_LOCAL VARCHAR(1)
	DECLARE @FORMA_PAGO VARCHAR(4)
	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM ,
		@TIPO_SITIO_LOCAL = TIPO_SITIO_LOCAL
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM) AND @TIPO_SITIO_LOCAL = 'C'
	BEGIN
		DECLARE C_DELETED CURSOR LOCAL FOR
			SELECT FORMA_PAGO
			FROM DELETED d
			WHERE 0 = (
				SELECT COUNT('n')
				FROM INSERTED i
				WHERE d.FORMA_PAGO = i.FORMA_PAGO
			   )
		OPEN C_DELETED
		FETCH NEXT FROM C_DELETED INTO
		@FORMA_PAGO
		
		SET @ERROR = 0
		
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS =
								'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<FORMA_PAGO>' +
				'<FORMA_PAGO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@FORMA_PAGO) + '</FORMA_PAGO>' +
				'</FORMA_PAGO>'
 -- XML
			
			-- inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'FORMAPAGOPOS600', 'ELIMINA', @PARAMETROS, 0, ''
			
			FETCH NEXT FROM C_DELETED INTO
			@FORMA_PAGO
		END
		CLOSE C_DELETED
		DEALLOCATE C_DELETED
	END
	
	IF (@@ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para eliminar de la tabla FORMA_PAGO.',16,1 )
	END
END
;




CREATE TRIGGER $$Compania$$.GLOBALES_AS_POS_INS
ON $$Compania$$.GLOBALES_AS
FOR INSERT
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @FECHA_ADV_INI DATETIME
	DECLARE @FECHA_ADV_FIN DATETIME
	DECLARE @FECHA_TRABAJO_INI DATETIME
	DECLARE @FECHA_TRABAJO_FIN DATETIME
	DECLARE @NOMBRE_MON_FUNC VARCHAR(10)
	DECLARE @NOMBRE_MON_REP VARCHAR(10)
	DECLARE @SIMBOLO_MON_FUNC VARCHAR(3)
	DECLARE @SIMBOLO_MON_REP VARCHAR(3)
	DECLARE @IMPUESTO1_DESC VARCHAR(10)
	DECLARE @IMPUESTO2_DESC VARCHAR(10)
	DECLARE @PAIS_LOCAL VARCHAR(4)
	DECLARE @MONEDA_LOCAL VARCHAR(4)
	DECLARE @MONEDA_DOLAR VARCHAR(4)
	DECLARE @TIPO_CAMBIO_DOLAR VARCHAR(4)
	DECLARE @PATRON_CCOSTO VARCHAR(25)
	DECLARE @COBRAR_IMP1PP_CC VARCHAR(1)
	DECLARE @COBRAR_IMP2PP_CC VARCHAR(1)
	DECLARE @CALC_FRACC_INTCTE VARCHAR(1)
	DECLARE @AJUSTAR_FECHAPAGO VARCHAR(1)
	DECLARE @AJ_FCHPAGO_ATRAS VARCHAR(1)
	DECLARE @AJ_FCHPAGO_ADE VARCHAR(1)
	DECLARE @REPL_TC_CODIGO VARCHAR(1)
	DECLARE @REPL_TC_HIST VARCHAR(1)	
	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_INSERTED CURSOR LOCAL FOR
		SELECT FECHA_ADV_INI, FECHA_ADV_FIN, FECHA_TRABAJO_INI, FECHA_TRABAJO_FIN, NOMBRE_MON_FUNC, NOMBRE_MON_REP, SIMBOLO_MON_FUNC, SIMBOLO_MON_REP, IMPUESTO1_DESC, IMPUESTO2_DESC, PAIS_LOCAL, MONEDA_LOCAL, MONEDA_DOLAR, TIPO_CAMBIO_DOLAR, PATRON_CCOSTO, COBRAR_IMP1PP_CC, COBRAR_IMP2PP_CC, CALC_FRACC_INTCTE, AJUSTAR_FECHAPAGO, AJ_FCHPAGO_ATRAS, AJ_FCHPAGO_ADE, REPL_TC_CODIGO, REPL_TC_HIST
		FROM INSERTED i
			
		OPEN C_INSERTED	
		FETCH NEXT FROM C_INSERTED INTO
		@FECHA_ADV_INI, @FECHA_ADV_FIN, @FECHA_TRABAJO_INI, @FECHA_TRABAJO_FIN, @NOMBRE_MON_FUNC, @NOMBRE_MON_REP, @SIMBOLO_MON_FUNC, @SIMBOLO_MON_REP, @IMPUESTO1_DESC, @IMPUESTO2_DESC, @PAIS_LOCAL, @MONEDA_LOCAL, @MONEDA_DOLAR, @TIPO_CAMBIO_DOLAR, @PATRON_CCOSTO, @COBRAR_IMP1PP_CC, @COBRAR_IMP2PP_CC, @CALC_FRACC_INTCTE, @AJUSTAR_FECHAPAGO, @AJ_FCHPAGO_ATRAS, @AJ_FCHPAGO_ADE, @REPL_TC_CODIGO, @REPL_TC_HIST
		SET @ERROR = 0
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS =
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<GLOBALES_AS>' +
				'<FECHA_ADV_INI Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_ADV_INI) + '</FECHA_ADV_INI>' +
				'<FECHA_ADV_FIN Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_ADV_FIN) + '</FECHA_ADV_FIN>' +
				'<FECHA_TRABAJO_INI Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_TRABAJO_INI) + '</FECHA_TRABAJO_INI>' +
				'<FECHA_TRABAJO_FIN Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_TRABAJO_FIN) + '</FECHA_TRABAJO_FIN>' +
				'<NOMBRE_MON_FUNC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOMBRE_MON_FUNC) + '</NOMBRE_MON_FUNC>' +
				'<NOMBRE_MON_REP Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOMBRE_MON_REP) + '</NOMBRE_MON_REP>' +
				'<SIMBOLO_MON_FUNC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@SIMBOLO_MON_FUNC) + '</SIMBOLO_MON_FUNC>' +
				'<SIMBOLO_MON_REP Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@SIMBOLO_MON_REP) + '</SIMBOLO_MON_REP>' +
				'<IMPUESTO1_DESC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@IMPUESTO1_DESC) + '</IMPUESTO1_DESC>' +
				'<IMPUESTO2_DESC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@IMPUESTO2_DESC) + '</IMPUESTO2_DESC>' +
				'<PAIS_LOCAL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@PAIS_LOCAL) + '</PAIS_LOCAL>' +
				'<MONEDA_LOCAL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@MONEDA_LOCAL) + '</MONEDA_LOCAL>' +
				'<MONEDA_DOLAR Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@MONEDA_DOLAR) + '</MONEDA_DOLAR>' +
				'<TIPO_CAMBIO_DOLAR Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_CAMBIO_DOLAR) + '</TIPO_CAMBIO_DOLAR>' +
				'<PATRON_CCOSTO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@PATRON_CCOSTO) + '</PATRON_CCOSTO>' +
				'<COBRAR_IMP1PP_CC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@COBRAR_IMP1PP_CC) + '</COBRAR_IMP1PP_CC>' +
				'<COBRAR_IMP2PP_CC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@COBRAR_IMP2PP_CC) + '</COBRAR_IMP2PP_CC>' +
				'<CALC_FRACC_INTCTE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CALC_FRACC_INTCTE) + '</CALC_FRACC_INTCTE>' +
				'<AJUSTAR_FECHAPAGO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@AJUSTAR_FECHAPAGO) + '</AJUSTAR_FECHAPAGO>' +
				'<AJ_FCHPAGO_ATRAS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@AJ_FCHPAGO_ATRAS) + '</AJ_FCHPAGO_ATRAS>' +
				'<AJ_FCHPAGO_ADE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@AJ_FCHPAGO_ADE) + '</AJ_FCHPAGO_ADE>' +
				'<REPL_TC_CODIGO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@REPL_TC_CODIGO) + '</REPL_TC_CODIGO>' +
				'<REPL_TC_HIST Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@REPL_TC_HIST) + '</REPL_TC_HIST>' +
				'</GLOBALES_AS>'
			-- Inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'GLOBALESASPOS600', 'INSERTA', @PARAMETROS, 0, ''
			FETCH NEXT FROM C_INSERTED INTO
			@FECHA_ADV_INI, @FECHA_ADV_FIN, @FECHA_TRABAJO_INI, @FECHA_TRABAJO_FIN, @NOMBRE_MON_FUNC, @NOMBRE_MON_REP, @SIMBOLO_MON_FUNC, @SIMBOLO_MON_REP, @IMPUESTO1_DESC, @IMPUESTO2_DESC, @PAIS_LOCAL, @MONEDA_LOCAL, @MONEDA_DOLAR, @TIPO_CAMBIO_DOLAR, @PATRON_CCOSTO, @COBRAR_IMP1PP_CC, @COBRAR_IMP2PP_CC, @CALC_FRACC_INTCTE, @AJUSTAR_FECHAPAGO, @AJ_FCHPAGO_ATRAS, @AJ_FCHPAGO_ADE, @REPL_TC_CODIGO, @REPL_TC_HIST
		END
		CLOSE C_INSERTED
    		DEALLOCATE C_INSERTED
	END
	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla GLOBALES_AS.',16,1 )
	END
END
;




CREATE TRIGGER $$Compania$$.GLOBALES_AS_POS_DEL
ON $$Compania$$.GLOBALES_AS
FOR DELETE
AS
BEGIN   	
    DECLARE @ERROR  INT,
			@PUBLICADOR VARCHAR(20),
			@PARAMETROS VARCHAR(8000),
			@USUARIO_POS_WSQM VARCHAR(100),
			@FECHA_ADV_INI DATETIME
	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_DELETED CURSOR LOCAL FOR
  			--Verificar que los campos concuerden con la declaración de las variables
			SELECT D.FECHA_ADV_INI
				FROM DELETED D
		OPEN C_DELETED
		FETCH NEXT FROM C_DELETED
		INTO @FECHA_ADV_INI
		SET @ERROR = 0
		
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS =
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<GLOBALES_AS>' +
				'<FECHA_ADV_INI Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_ADV_INI) + '</FECHA_ADV_INI>' +
				'</GLOBALES_AS>'
 -- XML
			
			-- inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'GLOBALESASPOS600', 'ELIMINA', @PARAMETROS, 0, ''
			
			FETCH NEXT FROM C_DELETED
			INTO @FECHA_ADV_INI
		END
		CLOSE C_DELETED
		DEALLOCATE C_DELETED
	END
	
	IF (@@ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para eliminar de la tabla GLOBALES_AS.',16,1 )
	END
END
;




CREATE TRIGGER $$Compania$$.GLOBALES_AS_POS_MOD
ON $$Compania$$.GLOBALES_AS
FOR UPDATE
AS
BEGIN   	
	DECLARE @ERROR  INT,
			@PUBLICADOR VARCHAR(20),
			@PARAMETROS VARCHAR(8000),
			@USUARIO_POS_WSQM VARCHAR(100),
			@COL_ROWPOINTER VARCHAR(36),
			@HAY_CAMPOS_PARA_POS BIT,
			@ACTUALIZAR_SOLICITUD BIT,
			@IMPUESTO1_DESC VARCHAR(10),
			@IMPUESTO2_DESC VARCHAR(10),
			@PAIS_LOCAL VARCHAR(4),
			@MONEDA_LOCAL VARCHAR(4),
			@MONEDA_DOLAR VARCHAR(4),
			@TIPO_CAMBIO_DOLAR VARCHAR(4)
	SET @ERROR = 0
	SELECT @PUBLICADOR = SITIO_LOCAL, @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_MODIFIED CURSOR LOCAL FOR
			SELECT 	 I.IMPUESTO1_DESC,
				 I.IMPUESTO2_DESC,
				 I.PAIS_LOCAL,
				 I.MONEDA_LOCAL,
				 I.MONEDA_DOLAR,
				 I.TIPO_CAMBIO_DOLAR
			FROM INSERTED I
		SET @ACTUALIZAR_SOLICITUD = 1
		OPEN C_MODIFIED
		FETCH NEXT FROM C_MODIFIED
		 INTO  @IMPUESTO1_DESC,
			 @IMPUESTO2_DESC,
			 @PAIS_LOCAL,
			 @MONEDA_LOCAL,
			 @MONEDA_DOLAR,
			 @TIPO_CAMBIO_DOLAR
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			IF (NOT UPDATE(RECORDDATE)  AND
				( UPDATE(IMPUESTO1_DESC)
				OR UPDATE(IMPUESTO2_DESC)
				OR UPDATE(PAIS_LOCAL)
				OR UPDATE(MONEDA_LOCAL)
				OR UPDATE(MONEDA_DOLAR)
				OR UPDATE(TIPO_CAMBIO_DOLAR) )) -- se asegura que no sea activación del trigger de eDNA
			BEGIN
				SET @COL_ROWPOINTER = ''
				SET @ACTUALIZAR_SOLICITUD = 0
				SET @PARAMETROS =
					'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<GLOBALES_AS>' +
				'<IMPUESTO1_DESC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@IMPUESTO1_DESC) + '</IMPUESTO1_DESC>' +
				'<IMPUESTO2_DESC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@IMPUESTO2_DESC) + '</IMPUESTO2_DESC>' +
				'<PAIS_LOCAL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@PAIS_LOCAL) + '</PAIS_LOCAL>' +
				'<MONEDA_LOCAL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@MONEDA_LOCAL) + '</MONEDA_LOCAL>' +
				'<MONEDA_DOLAR Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@MONEDA_DOLAR) + '</MONEDA_DOLAR>' +
				'<TIPO_CAMBIO_DOLAR Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_CAMBIO_DOLAR) + '</TIPO_CAMBIO_DOLAR>' +
				'</GLOBALES_AS>'
				-- inserta la solicitud correspondiente
				EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'GLOBALESASPOS600', 'MODIFICA', @PARAMETROS, @ACTUALIZAR_SOLICITUD, @COL_ROWPOINTER
			END
			FETCH NEXT FROM C_MODIFIED
			 INTO  @IMPUESTO1_DESC,
				 @IMPUESTO2_DESC,
				 @PAIS_LOCAL,
				 @MONEDA_LOCAL,
				 @MONEDA_DOLAR,
				 @TIPO_CAMBIO_DOLAR
		END
		CLOSE C_MODIFIED
		DEALLOCATE C_MODIFIED
	END
	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para modificar la tabla GLOBALES_AS.',16,1 )
	END
END
;





CREATE TRIGGER $$Compania$$.GLOBALES_CI_POS_INS
ON $$Compania$$.GLOBALES_CI
FOR INSERT
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @PARAMETROS2 VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @COSTOS_DEC INT
	DECLARE @EXISTENCIAS_DEC INT
	DECLARE @PESOS_DEC INT
	DECLARE @COSTO_FISCAL VARCHAR(1)
	DECLARE @COSTO_COMPARATIVO VARCHAR(1)
	DECLARE @COSTO_INGR_DEFAULT VARCHAR(1)
	DECLARE @UNIDAD_PESO VARCHAR(6)
	DECLARE @UNIDAD_VOLUMEN VARCHAR(6)
	DECLARE @USA_LOCALIZACION VARCHAR(1)
	DECLARE @AJUSTAR_CONTEO VARCHAR(1)
	DECLARE @MAX_AUDITORIA INT
	DECLARE @FCH_ULT_PROC_VCTO DATETIME
	DECLARE @FCH_ULT_PROC_APROB DATETIME
	DECLARE @FECHA_INICIO_TRANS DATETIME
	DECLARE @PURGAR_CAPAS_COSTO VARCHAR(1)
	DECLARE @NOMBRE_CLASIF_1 VARCHAR(10)
	DECLARE @NOMBRE_CLASIF_2 VARCHAR(10)
	DECLARE @NOMBRE_CLASIF_3 VARCHAR(10)
	DECLARE @NOMBRE_CLASIF_4 VARCHAR(10)
	DECLARE @NOMBRE_CLASIF_5 VARCHAR(10)
	DECLARE @NOMBRE_CLASIF_6 VARCHAR(10)
	DECLARE @TIPO_ASIENTO VARCHAR(4)
	DECLARE @PAQUETE VARCHAR(4)
	DECLARE @ASNT_AJU_VENTA VARCHAR(1)
	DECLARE @ASNT_AJU_CONSUMO VARCHAR(1)
	DECLARE @ASNT_AJU_COMPRA VARCHAR(1)
	DECLARE @ASNT_AJU_PRODUC VARCHAR(1)
	DECLARE @ASNT_AJU_MISCELAN VARCHAR(1)
	DECLARE @ASNT_AJU_FISICO VARCHAR(1)
	DECLARE @ASNT_AJU_VENCIM VARCHAR(1)
	DECLARE @ASNT_AJU_COSTO VARCHAR(1)
	DECLARE @TIPO_FASB52 VARCHAR(1)
	DECLARE @MOD_APLIC_ASIENTO INT
	DECLARE @INTEGRACION_CONTA VARCHAR(1)
	DECLARE @TIPO_CONTA_OMISION VARCHAR(1)
	DECLARE @CTR_EN_TRANSACCION VARCHAR(1)
	DECLARE @EXIST_EN_TOTALES VARCHAR(10)
	DECLARE @TRANSAC_X_USUARIO VARCHAR(1)
	DECLARE @USA_CONSECUTIVOS VARCHAR(1)
	DECLARE @MODALIDAD_USO VARCHAR(1)
	DECLARE @USAR_NUMEROS_SERIE VARCHAR(1)
	DECLARE @CNTRL_SERIES_ENTR VARCHAR(1)
	DECLARE @USA_CODIGO_BARRAS VARCHAR(1)
	DECLARE @USA_UNIDADES_DIST VARCHAR(1)
	DECLARE @ASISTENCIA_AUTOMAT VARCHAR(1)
	DECLARE @USA_CODIGO_EAN13 VARCHAR(1)
	DECLARE @USA_CODIGO_EAN8 VARCHAR(1)
	DECLARE @USA_CODIGO_UCC12 VARCHAR(1)
	DECLARE @USA_CODIGO_UCC8 VARCHAR(1)
	DECLARE @EAN13_REGLA_LOCAL VARCHAR(18)
	DECLARE @EAN8_REGLA_LOCAL VARCHAR(3)
	DECLARE @UCC12_REGLA_LOCAL VARCHAR(6)
	DECLARE @PRIORIDAD_BUSQUEDA VARCHAR(1)
	DECLARE @USA_PEDIMENTOS VARCHAR(1)
	DECLARE @USA_CODIGO_GENERIC VARCHAR(1)
	DECLARE @LINEAS_MAX_TRANS INT
	DECLARE @USAR_APROBACION VARCHAR(1)
	

	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM 
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_INSERTED CURSOR LOCAL FOR
		SELECT COSTOS_DEC, EXISTENCIAS_DEC, PESOS_DEC, COSTO_FISCAL, COSTO_COMPARATIVO, COSTO_INGR_DEFAULT, UNIDAD_PESO, UNIDAD_VOLUMEN, USA_LOCALIZACION, AJUSTAR_CONTEO, MAX_AUDITORIA, FCH_ULT_PROC_VCTO, FCH_ULT_PROC_APROB, FECHA_INICIO_TRANS, PURGAR_CAPAS_COSTO, NOMBRE_CLASIF_1, NOMBRE_CLASIF_2, NOMBRE_CLASIF_3, NOMBRE_CLASIF_4, NOMBRE_CLASIF_5, NOMBRE_CLASIF_6, TIPO_ASIENTO, PAQUETE, ASNT_AJU_VENTA, ASNT_AJU_CONSUMO, ASNT_AJU_COMPRA, ASNT_AJU_PRODUC, ASNT_AJU_MISCELAN, ASNT_AJU_FISICO, ASNT_AJU_VENCIM, ASNT_AJU_COSTO, TIPO_FASB52, MOD_APLIC_ASIENTO, INTEGRACION_CONTA, TIPO_CONTA_OMISION, CTR_EN_TRANSACCION, EXIST_EN_TOTALES, TRANSAC_X_USUARIO, USA_CONSECUTIVOS, MODALIDAD_USO, USAR_NUMEROS_SERIE, CNTRL_SERIES_ENTR, USA_CODIGO_BARRAS, USA_UNIDADES_DIST, ASISTENCIA_AUTOMAT, USA_CODIGO_EAN13, USA_CODIGO_EAN8, USA_CODIGO_UCC12, USA_CODIGO_UCC8, EAN13_REGLA_LOCAL, EAN8_REGLA_LOCAL, UCC12_REGLA_LOCAL, PRIORIDAD_BUSQUEDA, USA_PEDIMENTOS, USA_CODIGO_GENERIC, LINEAS_MAX_TRANS, USAR_APROBACION
		FROM INSERTED i
			
		OPEN C_INSERTED	
		FETCH NEXT FROM C_INSERTED INTO
		@COSTOS_DEC, @EXISTENCIAS_DEC, @PESOS_DEC, @COSTO_FISCAL, @COSTO_COMPARATIVO, @COSTO_INGR_DEFAULT, @UNIDAD_PESO, @UNIDAD_VOLUMEN, @USA_LOCALIZACION, @AJUSTAR_CONTEO, @MAX_AUDITORIA, @FCH_ULT_PROC_VCTO, @FCH_ULT_PROC_APROB, @FECHA_INICIO_TRANS, @PURGAR_CAPAS_COSTO, @NOMBRE_CLASIF_1, @NOMBRE_CLASIF_2, @NOMBRE_CLASIF_3, @NOMBRE_CLASIF_4, @NOMBRE_CLASIF_5, @NOMBRE_CLASIF_6, @TIPO_ASIENTO, @PAQUETE, @ASNT_AJU_VENTA, @ASNT_AJU_CONSUMO, @ASNT_AJU_COMPRA, @ASNT_AJU_PRODUC, @ASNT_AJU_MISCELAN, @ASNT_AJU_FISICO, @ASNT_AJU_VENCIM, @ASNT_AJU_COSTO, @TIPO_FASB52, @MOD_APLIC_ASIENTO, @INTEGRACION_CONTA, @TIPO_CONTA_OMISION, @CTR_EN_TRANSACCION, @EXIST_EN_TOTALES, @TRANSAC_X_USUARIO, @USA_CONSECUTIVOS, @MODALIDAD_USO, @USAR_NUMEROS_SERIE, @CNTRL_SERIES_ENTR, @USA_CODIGO_BARRAS, @USA_UNIDADES_DIST, @ASISTENCIA_AUTOMAT, @USA_CODIGO_EAN13, @USA_CODIGO_EAN8, @USA_CODIGO_UCC12, @USA_CODIGO_UCC8, @EAN13_REGLA_LOCAL, @EAN8_REGLA_LOCAL, @UCC12_REGLA_LOCAL, @PRIORIDAD_BUSQUEDA, @USA_PEDIMENTOS, @USA_CODIGO_GENERIC, @LINEAS_MAX_TRANS, @USAR_APROBACION

		SET @ERROR = 0
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS = 
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<GLOBALES_CI>' + 
				'<COSTOS_DEC Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@COSTOS_DEC) + '</COSTOS_DEC>' + 
				'<EXISTENCIAS_DEC Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@EXISTENCIAS_DEC) + '</EXISTENCIAS_DEC>' + 
				'<PESOS_DEC Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@PESOS_DEC) + '</PESOS_DEC>' + 
				'<COSTO_FISCAL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@COSTO_FISCAL) + '</COSTO_FISCAL>' + 
				'<COSTO_COMPARATIVO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@COSTO_COMPARATIVO) + '</COSTO_COMPARATIVO>' + 
				'<COSTO_INGR_DEFAULT Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@COSTO_INGR_DEFAULT) + '</COSTO_INGR_DEFAULT>' + 
				'<UNIDAD_PESO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@UNIDAD_PESO) + '</UNIDAD_PESO>' + 
				'<UNIDAD_VOLUMEN Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@UNIDAD_VOLUMEN) + '</UNIDAD_VOLUMEN>' + 
				'<USA_LOCALIZACION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USA_LOCALIZACION) + '</USA_LOCALIZACION>' + 
				'<AJUSTAR_CONTEO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@AJUSTAR_CONTEO) + '</AJUSTAR_CONTEO>' + 
				'<MAX_AUDITORIA Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@MAX_AUDITORIA) + '</MAX_AUDITORIA>' + 
				'<FCH_ULT_PROC_VCTO Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FCH_ULT_PROC_VCTO) + '</FCH_ULT_PROC_VCTO>' + 
				'<FCH_ULT_PROC_APROB Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FCH_ULT_PROC_APROB) + '</FCH_ULT_PROC_APROB>' + 
				'<FECHA_INICIO_TRANS Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_INICIO_TRANS) + '</FECHA_INICIO_TRANS>' + 
				'<PURGAR_CAPAS_COSTO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@PURGAR_CAPAS_COSTO) + '</PURGAR_CAPAS_COSTO>' + 
				'<NOMBRE_CLASIF_1 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOMBRE_CLASIF_1) + '</NOMBRE_CLASIF_1>' + 
				'<NOMBRE_CLASIF_2 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOMBRE_CLASIF_2) + '</NOMBRE_CLASIF_2>' + 
				'<NOMBRE_CLASIF_3 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOMBRE_CLASIF_3) + '</NOMBRE_CLASIF_3>' + 
				'<NOMBRE_CLASIF_4 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOMBRE_CLASIF_4) + '</NOMBRE_CLASIF_4>' + 
				'<NOMBRE_CLASIF_5 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOMBRE_CLASIF_5) + '</NOMBRE_CLASIF_5>' + 
				'<NOMBRE_CLASIF_6 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOMBRE_CLASIF_6) + '</NOMBRE_CLASIF_6>' + 
				'<TIPO_ASIENTO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_ASIENTO) + '</TIPO_ASIENTO>' + 
				'<PAQUETE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@PAQUETE) + '</PAQUETE>' + 
				'<ASNT_AJU_VENTA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ASNT_AJU_VENTA) + '</ASNT_AJU_VENTA>' + 
				'<ASNT_AJU_CONSUMO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ASNT_AJU_CONSUMO) + '</ASNT_AJU_CONSUMO>' + 
				'<ASNT_AJU_COMPRA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ASNT_AJU_COMPRA) + '</ASNT_AJU_COMPRA>' + 
				'<ASNT_AJU_PRODUC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ASNT_AJU_PRODUC) + '</ASNT_AJU_PRODUC>' + 
				'<ASNT_AJU_MISCELAN Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ASNT_AJU_MISCELAN) + '</ASNT_AJU_MISCELAN>'
				
				
			SET @PARAMETROS2 =
				'<ASNT_AJU_FISICO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ASNT_AJU_FISICO) + '</ASNT_AJU_FISICO>' + 
				'<ASNT_AJU_VENCIM Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ASNT_AJU_VENCIM) + '</ASNT_AJU_VENCIM>' + 
				'<ASNT_AJU_COSTO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ASNT_AJU_COSTO) + '</ASNT_AJU_COSTO>' + 
				'<TIPO_FASB52 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_FASB52) + '</TIPO_FASB52>' + 
				'<MOD_APLIC_ASIENTO Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@MOD_APLIC_ASIENTO) + '</MOD_APLIC_ASIENTO>' + 
				'<INTEGRACION_CONTA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@INTEGRACION_CONTA) + '</INTEGRACION_CONTA>' + 
				'<TIPO_CONTA_OMISION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_CONTA_OMISION) + '</TIPO_CONTA_OMISION>' + 
				'<CTR_EN_TRANSACCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_EN_TRANSACCION) + '</CTR_EN_TRANSACCION>' + 
				'<EXIST_EN_TOTALES Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@EXIST_EN_TOTALES) + '</EXIST_EN_TOTALES>' + 
				'<TRANSAC_X_USUARIO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TRANSAC_X_USUARIO) + '</TRANSAC_X_USUARIO>' + 
				'<USA_CONSECUTIVOS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USA_CONSECUTIVOS) + '</USA_CONSECUTIVOS>' + 
				'<MODALIDAD_USO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@MODALIDAD_USO) + '</MODALIDAD_USO>' + 
				'<USAR_NUMEROS_SERIE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USAR_NUMEROS_SERIE) + '</USAR_NUMEROS_SERIE>' + 
				'<CNTRL_SERIES_ENTR Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CNTRL_SERIES_ENTR) + '</CNTRL_SERIES_ENTR>' + 
				'<USA_CODIGO_BARRAS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USA_CODIGO_BARRAS) + '</USA_CODIGO_BARRAS>' + 
				'<USA_UNIDADES_DIST Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USA_UNIDADES_DIST) + '</USA_UNIDADES_DIST>' + 
				'<ASISTENCIA_AUTOMAT Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ASISTENCIA_AUTOMAT) + '</ASISTENCIA_AUTOMAT>' + 
				'<USA_CODIGO_EAN13 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USA_CODIGO_EAN13) + '</USA_CODIGO_EAN13>' + 
				'<USA_CODIGO_EAN8 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USA_CODIGO_EAN8) + '</USA_CODIGO_EAN8>' + 
				'<USA_CODIGO_UCC12 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USA_CODIGO_UCC12) + '</USA_CODIGO_UCC12>' + 
				'<USA_CODIGO_UCC8 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USA_CODIGO_UCC8) + '</USA_CODIGO_UCC8>' + 
				'<EAN13_REGLA_LOCAL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@EAN13_REGLA_LOCAL) + '</EAN13_REGLA_LOCAL>' + 
				'<EAN8_REGLA_LOCAL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@EAN8_REGLA_LOCAL) + '</EAN8_REGLA_LOCAL>' + 
				'<UCC12_REGLA_LOCAL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@UCC12_REGLA_LOCAL) + '</UCC12_REGLA_LOCAL>' + 
				'<PRIORIDAD_BUSQUEDA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@PRIORIDAD_BUSQUEDA) + '</PRIORIDAD_BUSQUEDA>' + 
				'<USA_PEDIMENTOS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USA_PEDIMENTOS) + '</USA_PEDIMENTOS>' + 
				'<USA_CODIGO_GENERIC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USA_CODIGO_GENERIC) + '</USA_CODIGO_GENERIC>' + 
				'<LINEAS_MAX_TRANS Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@LINEAS_MAX_TRANS) + '</LINEAS_MAX_TRANS>' + 
				'<USAR_APROBACION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USAR_APROBACION) + '</USAR_APROBACION>' + 
				'</GLOBALES_CI>'


			-- Inserta la solicitud correspondiente
			EXECUTE  ('ERPADMIN.POS_InsertarSolicitud ''' + @PUBLICADOR + ''', ''GLOBALESCIPOS600'', ''INSERTA'', ''' + @PARAMETROS + @PARAMETROS2 + ''', 0, ''''')

			FETCH NEXT FROM C_INSERTED INTO
			@COSTOS_DEC, @EXISTENCIAS_DEC, @PESOS_DEC, @COSTO_FISCAL, @COSTO_COMPARATIVO, @COSTO_INGR_DEFAULT, @UNIDAD_PESO, @UNIDAD_VOLUMEN, @USA_LOCALIZACION, @AJUSTAR_CONTEO, @MAX_AUDITORIA, @FCH_ULT_PROC_VCTO, @FCH_ULT_PROC_APROB, @FECHA_INICIO_TRANS, @PURGAR_CAPAS_COSTO, @NOMBRE_CLASIF_1, @NOMBRE_CLASIF_2, @NOMBRE_CLASIF_3, @NOMBRE_CLASIF_4, @NOMBRE_CLASIF_5, @NOMBRE_CLASIF_6, @TIPO_ASIENTO, @PAQUETE, @ASNT_AJU_VENTA, @ASNT_AJU_CONSUMO, @ASNT_AJU_COMPRA, @ASNT_AJU_PRODUC, @ASNT_AJU_MISCELAN, @ASNT_AJU_FISICO, @ASNT_AJU_VENCIM, @ASNT_AJU_COSTO, @TIPO_FASB52, @MOD_APLIC_ASIENTO, @INTEGRACION_CONTA, @TIPO_CONTA_OMISION, @CTR_EN_TRANSACCION, @EXIST_EN_TOTALES, @TRANSAC_X_USUARIO, @USA_CONSECUTIVOS, @MODALIDAD_USO, @USAR_NUMEROS_SERIE, @CNTRL_SERIES_ENTR, @USA_CODIGO_BARRAS, @USA_UNIDADES_DIST, @ASISTENCIA_AUTOMAT, @USA_CODIGO_EAN13, @USA_CODIGO_EAN8, @USA_CODIGO_UCC12, @USA_CODIGO_UCC8, @EAN13_REGLA_LOCAL, @EAN8_REGLA_LOCAL, @UCC12_REGLA_LOCAL, @PRIORIDAD_BUSQUEDA, @USA_PEDIMENTOS, @USA_CODIGO_GENERIC, @LINEAS_MAX_TRANS, @USAR_APROBACION
		END

		CLOSE C_INSERTED
    		DEALLOCATE C_INSERTED
	END

	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla GLOBALES_CI.',16,1 )
	END
END;



CREATE TRIGGER $$Compania$$.GLOBALES_CI_POS_DEL
ON $$Compania$$.GLOBALES_CI
FOR DELETE  
AS 
BEGIN   	
        DECLARE @ERROR  int
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @PARAMETROS2 VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @COSTOS_DEC INT
	DECLARE @EXISTENCIAS_DEC INT
	DECLARE @PESOS_DEC INT
	DECLARE @COSTO_FISCAL VARCHAR(1)
	DECLARE @COSTO_COMPARATIVO VARCHAR(1)
	DECLARE @COSTO_INGR_DEFAULT VARCHAR(1)
	DECLARE @UNIDAD_PESO VARCHAR(6)
	DECLARE @UNIDAD_VOLUMEN VARCHAR(6)
	DECLARE @USA_LOCALIZACION VARCHAR(1)
	DECLARE @AJUSTAR_CONTEO VARCHAR(1)
	DECLARE @MAX_AUDITORIA INT
	DECLARE @FCH_ULT_PROC_VCTO DATETIME
	DECLARE @FCH_ULT_PROC_APROB DATETIME
	DECLARE @FECHA_INICIO_TRANS DATETIME
	DECLARE @PURGAR_CAPAS_COSTO VARCHAR(1)
	DECLARE @NOMBRE_CLASIF_1 VARCHAR(10)
	DECLARE @NOMBRE_CLASIF_2 VARCHAR(10)
	DECLARE @NOMBRE_CLASIF_3 VARCHAR(10)
	DECLARE @NOMBRE_CLASIF_4 VARCHAR(10)
	DECLARE @NOMBRE_CLASIF_5 VARCHAR(10)
	DECLARE @NOMBRE_CLASIF_6 VARCHAR(10)
	DECLARE @TIPO_ASIENTO VARCHAR(4)
	DECLARE @PAQUETE VARCHAR(4)
	DECLARE @ASNT_AJU_VENTA VARCHAR(1)
	DECLARE @ASNT_AJU_CONSUMO VARCHAR(1)
	DECLARE @ASNT_AJU_COMPRA VARCHAR(1)
	DECLARE @ASNT_AJU_PRODUC VARCHAR(1)
	DECLARE @ASNT_AJU_MISCELAN VARCHAR(1)
	DECLARE @ASNT_AJU_FISICO VARCHAR(1)
	DECLARE @ASNT_AJU_VENCIM VARCHAR(1)
	DECLARE @ASNT_AJU_COSTO VARCHAR(1)
	DECLARE @TIPO_FASB52 VARCHAR(1)
	DECLARE @MOD_APLIC_ASIENTO INT
	DECLARE @INTEGRACION_CONTA VARCHAR(1)
	DECLARE @TIPO_CONTA_OMISION VARCHAR(1)
	DECLARE @CTR_EN_TRANSACCION VARCHAR(1)
	DECLARE @EXIST_EN_TOTALES VARCHAR(10)
	DECLARE @TRANSAC_X_USUARIO VARCHAR(1)
	DECLARE @USA_CONSECUTIVOS VARCHAR(1)
	DECLARE @MODALIDAD_USO VARCHAR(1)
	DECLARE @USAR_NUMEROS_SERIE VARCHAR(1)
	DECLARE @CNTRL_SERIES_ENTR VARCHAR(1)
	DECLARE @USA_CODIGO_BARRAS VARCHAR(1)
	DECLARE @USA_UNIDADES_DIST VARCHAR(1)
	DECLARE @ASISTENCIA_AUTOMAT VARCHAR(1)
	DECLARE @USA_CODIGO_EAN13 VARCHAR(1)
	DECLARE @USA_CODIGO_EAN8 VARCHAR(1)
	DECLARE @USA_CODIGO_UCC12 VARCHAR(1)
	DECLARE @USA_CODIGO_UCC8 VARCHAR(1)
	DECLARE @EAN13_REGLA_LOCAL VARCHAR(18)
	DECLARE @EAN8_REGLA_LOCAL VARCHAR(3)
	DECLARE @UCC12_REGLA_LOCAL VARCHAR(6)
	DECLARE @PRIORIDAD_BUSQUEDA VARCHAR(1)
	DECLARE @USA_PEDIMENTOS VARCHAR(1)
	DECLARE @USA_CODIGO_GENERIC VARCHAR(1)
	DECLARE @LINEAS_MAX_TRANS INT
	DECLARE @USAR_APROBACION VARCHAR(1)
	 -- Declaraciones	

	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM 
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_DELETED CURSOR LOCAL FOR
			SELECT COSTOS_DEC, EXISTENCIAS_DEC, PESOS_DEC, COSTO_FISCAL, COSTO_COMPARATIVO, COSTO_INGR_DEFAULT, UNIDAD_PESO, UNIDAD_VOLUMEN, USA_LOCALIZACION, AJUSTAR_CONTEO, MAX_AUDITORIA, FCH_ULT_PROC_VCTO, FCH_ULT_PROC_APROB, FECHA_INICIO_TRANS, PURGAR_CAPAS_COSTO, NOMBRE_CLASIF_1, NOMBRE_CLASIF_2, NOMBRE_CLASIF_3, NOMBRE_CLASIF_4, NOMBRE_CLASIF_5, NOMBRE_CLASIF_6, TIPO_ASIENTO, PAQUETE, ASNT_AJU_VENTA, ASNT_AJU_CONSUMO, ASNT_AJU_COMPRA, ASNT_AJU_PRODUC, ASNT_AJU_MISCELAN, ASNT_AJU_FISICO, ASNT_AJU_VENCIM, ASNT_AJU_COSTO, TIPO_FASB52, MOD_APLIC_ASIENTO, INTEGRACION_CONTA, TIPO_CONTA_OMISION, CTR_EN_TRANSACCION, EXIST_EN_TOTALES, TRANSAC_X_USUARIO, USA_CONSECUTIVOS, MODALIDAD_USO, USAR_NUMEROS_SERIE, CNTRL_SERIES_ENTR, USA_CODIGO_BARRAS, USA_UNIDADES_DIST, ASISTENCIA_AUTOMAT, USA_CODIGO_EAN13, USA_CODIGO_EAN8, USA_CODIGO_UCC12, USA_CODIGO_UCC8, EAN13_REGLA_LOCAL, EAN8_REGLA_LOCAL, UCC12_REGLA_LOCAL, PRIORIDAD_BUSQUEDA, USA_PEDIMENTOS, USA_CODIGO_GENERIC, LINEAS_MAX_TRANS, USAR_APROBACION
			FROM DELETED d

		OPEN C_DELETED
		FETCH NEXT FROM C_DELETED INTO 
		@COSTOS_DEC, @EXISTENCIAS_DEC, @PESOS_DEC, @COSTO_FISCAL, @COSTO_COMPARATIVO, @COSTO_INGR_DEFAULT, @UNIDAD_PESO, @UNIDAD_VOLUMEN, @USA_LOCALIZACION, @AJUSTAR_CONTEO, @MAX_AUDITORIA, @FCH_ULT_PROC_VCTO, @FCH_ULT_PROC_APROB, @FECHA_INICIO_TRANS, @PURGAR_CAPAS_COSTO, @NOMBRE_CLASIF_1, @NOMBRE_CLASIF_2, @NOMBRE_CLASIF_3, @NOMBRE_CLASIF_4, @NOMBRE_CLASIF_5, @NOMBRE_CLASIF_6, @TIPO_ASIENTO, @PAQUETE, @ASNT_AJU_VENTA, @ASNT_AJU_CONSUMO, @ASNT_AJU_COMPRA, @ASNT_AJU_PRODUC, @ASNT_AJU_MISCELAN, @ASNT_AJU_FISICO, @ASNT_AJU_VENCIM, @ASNT_AJU_COSTO, @TIPO_FASB52, @MOD_APLIC_ASIENTO, @INTEGRACION_CONTA, @TIPO_CONTA_OMISION, @CTR_EN_TRANSACCION, @EXIST_EN_TOTALES, @TRANSAC_X_USUARIO, @USA_CONSECUTIVOS, @MODALIDAD_USO, @USAR_NUMEROS_SERIE, @CNTRL_SERIES_ENTR, @USA_CODIGO_BARRAS, @USA_UNIDADES_DIST, @ASISTENCIA_AUTOMAT, @USA_CODIGO_EAN13, @USA_CODIGO_EAN8, @USA_CODIGO_UCC12, @USA_CODIGO_UCC8, @EAN13_REGLA_LOCAL, @EAN8_REGLA_LOCAL, @UCC12_REGLA_LOCAL, @PRIORIDAD_BUSQUEDA, @USA_PEDIMENTOS, @USA_CODIGO_GENERIC, @LINEAS_MAX_TRANS, @USAR_APROBACION -- VARIABLES
		
		SET @ERROR = 0
		
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS = 
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<GLOBALES_CI>' + 
				'<COSTOS_DEC Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@COSTOS_DEC) + '</COSTOS_DEC>' + 
				'<EXISTENCIAS_DEC Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@EXISTENCIAS_DEC) + '</EXISTENCIAS_DEC>' + 
				'<PESOS_DEC Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@PESOS_DEC) + '</PESOS_DEC>' + 
				'<COSTO_FISCAL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@COSTO_FISCAL) + '</COSTO_FISCAL>' + 
				'<COSTO_COMPARATIVO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@COSTO_COMPARATIVO) + '</COSTO_COMPARATIVO>' + 
				'<COSTO_INGR_DEFAULT Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@COSTO_INGR_DEFAULT) + '</COSTO_INGR_DEFAULT>' + 
				'<UNIDAD_PESO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@UNIDAD_PESO) + '</UNIDAD_PESO>' + 
				'<UNIDAD_VOLUMEN Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@UNIDAD_VOLUMEN) + '</UNIDAD_VOLUMEN>' + 
				'<USA_LOCALIZACION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USA_LOCALIZACION) + '</USA_LOCALIZACION>' + 
				'<AJUSTAR_CONTEO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@AJUSTAR_CONTEO) + '</AJUSTAR_CONTEO>' + 
				'<MAX_AUDITORIA Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@MAX_AUDITORIA) + '</MAX_AUDITORIA>' + 
				'<FCH_ULT_PROC_VCTO Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FCH_ULT_PROC_VCTO) + '</FCH_ULT_PROC_VCTO>' + 
				'<FCH_ULT_PROC_APROB Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FCH_ULT_PROC_APROB) + '</FCH_ULT_PROC_APROB>' + 
				'<FECHA_INICIO_TRANS Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_INICIO_TRANS) + '</FECHA_INICIO_TRANS>' + 
				'<PURGAR_CAPAS_COSTO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@PURGAR_CAPAS_COSTO) + '</PURGAR_CAPAS_COSTO>' + 
				'<NOMBRE_CLASIF_1 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOMBRE_CLASIF_1) + '</NOMBRE_CLASIF_1>' + 
				'<NOMBRE_CLASIF_2 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOMBRE_CLASIF_2) + '</NOMBRE_CLASIF_2>' + 
				'<NOMBRE_CLASIF_3 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOMBRE_CLASIF_3) + '</NOMBRE_CLASIF_3>' + 
				'<NOMBRE_CLASIF_4 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOMBRE_CLASIF_4) + '</NOMBRE_CLASIF_4>' + 
				'<NOMBRE_CLASIF_5 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOMBRE_CLASIF_5) + '</NOMBRE_CLASIF_5>' + 
				'<NOMBRE_CLASIF_6 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOMBRE_CLASIF_6) + '</NOMBRE_CLASIF_6>' + 
				'<TIPO_ASIENTO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_ASIENTO) + '</TIPO_ASIENTO>' + 
				'<PAQUETE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@PAQUETE) + '</PAQUETE>' + 
				'<ASNT_AJU_VENTA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ASNT_AJU_VENTA) + '</ASNT_AJU_VENTA>' + 
				'<ASNT_AJU_CONSUMO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ASNT_AJU_CONSUMO) + '</ASNT_AJU_CONSUMO>' + 
				'<ASNT_AJU_COMPRA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ASNT_AJU_COMPRA) + '</ASNT_AJU_COMPRA>' + 
				'<ASNT_AJU_PRODUC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ASNT_AJU_PRODUC) + '</ASNT_AJU_PRODUC>' + 
				'<ASNT_AJU_MISCELAN Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ASNT_AJU_MISCELAN) + '</ASNT_AJU_MISCELAN>'
				
				
			SET @PARAMETROS2 =
				'<ASNT_AJU_FISICO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ASNT_AJU_FISICO) + '</ASNT_AJU_FISICO>' + 
				'<ASNT_AJU_VENCIM Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ASNT_AJU_VENCIM) + '</ASNT_AJU_VENCIM>' + 
				'<ASNT_AJU_COSTO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ASNT_AJU_COSTO) + '</ASNT_AJU_COSTO>' + 
				'<TIPO_FASB52 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_FASB52) + '</TIPO_FASB52>' + 
				'<MOD_APLIC_ASIENTO Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@MOD_APLIC_ASIENTO) + '</MOD_APLIC_ASIENTO>' + 
				'<INTEGRACION_CONTA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@INTEGRACION_CONTA) + '</INTEGRACION_CONTA>' + 
				'<TIPO_CONTA_OMISION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_CONTA_OMISION) + '</TIPO_CONTA_OMISION>' + 
				'<CTR_EN_TRANSACCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_EN_TRANSACCION) + '</CTR_EN_TRANSACCION>' + 
				'<EXIST_EN_TOTALES Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@EXIST_EN_TOTALES) + '</EXIST_EN_TOTALES>' + 
				'<TRANSAC_X_USUARIO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TRANSAC_X_USUARIO) + '</TRANSAC_X_USUARIO>' + 
				'<USA_CONSECUTIVOS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USA_CONSECUTIVOS) + '</USA_CONSECUTIVOS>' + 
				'<MODALIDAD_USO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@MODALIDAD_USO) + '</MODALIDAD_USO>' + 
				'<USAR_NUMEROS_SERIE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USAR_NUMEROS_SERIE) + '</USAR_NUMEROS_SERIE>' + 
				'<CNTRL_SERIES_ENTR Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CNTRL_SERIES_ENTR) + '</CNTRL_SERIES_ENTR>' + 
				'<USA_CODIGO_BARRAS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USA_CODIGO_BARRAS) + '</USA_CODIGO_BARRAS>' + 
				'<USA_UNIDADES_DIST Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USA_UNIDADES_DIST) + '</USA_UNIDADES_DIST>' + 
				'<ASISTENCIA_AUTOMAT Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ASISTENCIA_AUTOMAT) + '</ASISTENCIA_AUTOMAT>' + 
				'<USA_CODIGO_EAN13 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USA_CODIGO_EAN13) + '</USA_CODIGO_EAN13>' + 
				'<USA_CODIGO_EAN8 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USA_CODIGO_EAN8) + '</USA_CODIGO_EAN8>' + 
				'<USA_CODIGO_UCC12 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USA_CODIGO_UCC12) + '</USA_CODIGO_UCC12>' + 
				'<USA_CODIGO_UCC8 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USA_CODIGO_UCC8) + '</USA_CODIGO_UCC8>' + 
				'<EAN13_REGLA_LOCAL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@EAN13_REGLA_LOCAL) + '</EAN13_REGLA_LOCAL>' + 
				'<EAN8_REGLA_LOCAL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@EAN8_REGLA_LOCAL) + '</EAN8_REGLA_LOCAL>' + 
				'<UCC12_REGLA_LOCAL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@UCC12_REGLA_LOCAL) + '</UCC12_REGLA_LOCAL>' + 
				'<PRIORIDAD_BUSQUEDA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@PRIORIDAD_BUSQUEDA) + '</PRIORIDAD_BUSQUEDA>' + 
				'<USA_PEDIMENTOS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USA_PEDIMENTOS) + '</USA_PEDIMENTOS>' + 
				'<USA_CODIGO_GENERIC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USA_CODIGO_GENERIC) + '</USA_CODIGO_GENERIC>' + 
				'<LINEAS_MAX_TRANS Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@LINEAS_MAX_TRANS) + '</LINEAS_MAX_TRANS>' + 
				'<USAR_APROBACION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USAR_APROBACION) + '</USAR_APROBACION>' + 
				'</GLOBALES_CI>'
 
			
			-- inserta la solicitud correspondiente
			EXECUTE  ('ERPADMIN.POS_InsertarSolicitud ''' + @PUBLICADOR + ''', ''GLOBALESCIPOS600'', ''ELIMINA'', ''' + @PARAMETROS + @PARAMETROS2 + ''', 0, ''''')
			
			FETCH NEXT FROM C_DELETED INTO 
			@COSTOS_DEC, @EXISTENCIAS_DEC, @PESOS_DEC, @COSTO_FISCAL, @COSTO_COMPARATIVO, @COSTO_INGR_DEFAULT, @UNIDAD_PESO, @UNIDAD_VOLUMEN, @USA_LOCALIZACION, @AJUSTAR_CONTEO, @MAX_AUDITORIA, @FCH_ULT_PROC_VCTO, @FCH_ULT_PROC_APROB, @FECHA_INICIO_TRANS, @PURGAR_CAPAS_COSTO, @NOMBRE_CLASIF_1, @NOMBRE_CLASIF_2, @NOMBRE_CLASIF_3, @NOMBRE_CLASIF_4, @NOMBRE_CLASIF_5, @NOMBRE_CLASIF_6, @TIPO_ASIENTO, @PAQUETE, @ASNT_AJU_VENTA, @ASNT_AJU_CONSUMO, @ASNT_AJU_COMPRA, @ASNT_AJU_PRODUC, @ASNT_AJU_MISCELAN, @ASNT_AJU_FISICO, @ASNT_AJU_VENCIM, @ASNT_AJU_COSTO, @TIPO_FASB52, @MOD_APLIC_ASIENTO, @INTEGRACION_CONTA, @TIPO_CONTA_OMISION, @CTR_EN_TRANSACCION, @EXIST_EN_TOTALES, @TRANSAC_X_USUARIO, @USA_CONSECUTIVOS, @MODALIDAD_USO, @USAR_NUMEROS_SERIE, @CNTRL_SERIES_ENTR, @USA_CODIGO_BARRAS, @USA_UNIDADES_DIST, @ASISTENCIA_AUTOMAT, @USA_CODIGO_EAN13, @USA_CODIGO_EAN8, @USA_CODIGO_UCC12, @USA_CODIGO_UCC8, @EAN13_REGLA_LOCAL, @EAN8_REGLA_LOCAL, @UCC12_REGLA_LOCAL, @PRIORIDAD_BUSQUEDA, @USA_PEDIMENTOS, @USA_CODIGO_GENERIC, @LINEAS_MAX_TRANS, @USAR_APROBACION -- VARIABLES
		END

		CLOSE C_DELETED
		DEALLOCATE C_DELETED
	END
	
	IF (@@ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para eliminar de la tabla GLOBALES_CI.',16,1 )
	END
END;



CREATE TRIGGER $$Compania$$.GLOBALES_CI_POS_MOD
ON $$Compania$$.GLOBALES_CI
FOR UPDATE
AS 
BEGIN   	
	DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @PARAMETROS2 VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @COL_ROWPOINTER VARCHAR(36)
	DECLARE @HAY_CAMPOS_PARA_POS BIT
	DECLARE @ACTUALIZAR_SOLICITUD BIT
	DECLARE @COSTOS_DEC INT
	DECLARE @EXISTENCIAS_DEC INT
	DECLARE @PESOS_DEC INT
	DECLARE @COSTO_FISCAL VARCHAR(1)
	DECLARE @COSTO_COMPARATIVO VARCHAR(1)
	DECLARE @COSTO_INGR_DEFAULT VARCHAR(1)
	DECLARE @UNIDAD_PESO VARCHAR(6)
	DECLARE @UNIDAD_VOLUMEN VARCHAR(6)
	DECLARE @USA_LOCALIZACION VARCHAR(1)
	DECLARE @AJUSTAR_CONTEO VARCHAR(1)
	DECLARE @MAX_AUDITORIA INT
	DECLARE @FCH_ULT_PROC_VCTO DATETIME
	DECLARE @FCH_ULT_PROC_APROB DATETIME
	DECLARE @FECHA_INICIO_TRANS DATETIME
	DECLARE @PURGAR_CAPAS_COSTO VARCHAR(1)
	DECLARE @NOMBRE_CLASIF_1 VARCHAR(10)
	DECLARE @NOMBRE_CLASIF_2 VARCHAR(10)
	DECLARE @NOMBRE_CLASIF_3 VARCHAR(10)
	DECLARE @NOMBRE_CLASIF_4 VARCHAR(10)
	DECLARE @NOMBRE_CLASIF_5 VARCHAR(10)
	DECLARE @NOMBRE_CLASIF_6 VARCHAR(10)
	DECLARE @TIPO_ASIENTO VARCHAR(4)
	DECLARE @PAQUETE VARCHAR(4)
	DECLARE @ASNT_AJU_VENTA VARCHAR(1)
	DECLARE @ASNT_AJU_CONSUMO VARCHAR(1)
	DECLARE @ASNT_AJU_COMPRA VARCHAR(1)
	DECLARE @ASNT_AJU_PRODUC VARCHAR(1)
	DECLARE @ASNT_AJU_MISCELAN VARCHAR(1)
	DECLARE @ASNT_AJU_FISICO VARCHAR(1)
	DECLARE @ASNT_AJU_VENCIM VARCHAR(1)
	DECLARE @ASNT_AJU_COSTO VARCHAR(1)
	DECLARE @TIPO_FASB52 VARCHAR(1)
	DECLARE @MOD_APLIC_ASIENTO INT
	DECLARE @INTEGRACION_CONTA VARCHAR(1)
	DECLARE @TIPO_CONTA_OMISION VARCHAR(1)
	DECLARE @CTR_EN_TRANSACCION VARCHAR(1)
	DECLARE @EXIST_EN_TOTALES VARCHAR(10)
	DECLARE @TRANSAC_X_USUARIO VARCHAR(1)
	DECLARE @USA_CONSECUTIVOS VARCHAR(1)
	DECLARE @MODALIDAD_USO VARCHAR(1)
	DECLARE @USAR_NUMEROS_SERIE VARCHAR(1)
	DECLARE @CNTRL_SERIES_ENTR VARCHAR(1)
	DECLARE @USA_CODIGO_BARRAS VARCHAR(1)
	DECLARE @USA_UNIDADES_DIST VARCHAR(1)
	DECLARE @ASISTENCIA_AUTOMAT VARCHAR(1)
	DECLARE @USA_CODIGO_EAN13 VARCHAR(1)
	DECLARE @USA_CODIGO_EAN8 VARCHAR(1)
	DECLARE @USA_CODIGO_UCC12 VARCHAR(1)
	DECLARE @USA_CODIGO_UCC8 VARCHAR(1)
	DECLARE @EAN13_REGLA_LOCAL VARCHAR(18)
	DECLARE @EAN8_REGLA_LOCAL VARCHAR(3)
	DECLARE @UCC12_REGLA_LOCAL VARCHAR(6)
	DECLARE @PRIORIDAD_BUSQUEDA VARCHAR(1)
	DECLARE @USA_PEDIMENTOS VARCHAR(1)
	DECLARE @USA_CODIGO_GENERIC VARCHAR(1)
	DECLARE @LINEAS_MAX_TRANS INT
	DECLARE @USAR_APROBACION VARCHAR(1)
	 -- Declaraciones

	SET @ERROR = 0

	SELECT @PUBLICADOR = SITIO_LOCAL, @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_MODIFIED CURSOR LOCAL FOR
			SELECT COSTOS_DEC, EXISTENCIAS_DEC, PESOS_DEC, COSTO_FISCAL, COSTO_COMPARATIVO, COSTO_INGR_DEFAULT, UNIDAD_PESO, UNIDAD_VOLUMEN, USA_LOCALIZACION, AJUSTAR_CONTEO, MAX_AUDITORIA, FCH_ULT_PROC_VCTO, FCH_ULT_PROC_APROB, FECHA_INICIO_TRANS, PURGAR_CAPAS_COSTO, NOMBRE_CLASIF_1, NOMBRE_CLASIF_2, NOMBRE_CLASIF_3, NOMBRE_CLASIF_4, NOMBRE_CLASIF_5, NOMBRE_CLASIF_6, TIPO_ASIENTO, PAQUETE, ASNT_AJU_VENTA, ASNT_AJU_CONSUMO, ASNT_AJU_COMPRA, ASNT_AJU_PRODUC, ASNT_AJU_MISCELAN, ASNT_AJU_FISICO, ASNT_AJU_VENCIM, ASNT_AJU_COSTO, TIPO_FASB52, MOD_APLIC_ASIENTO, INTEGRACION_CONTA, TIPO_CONTA_OMISION, CTR_EN_TRANSACCION, EXIST_EN_TOTALES, TRANSAC_X_USUARIO, USA_CONSECUTIVOS, MODALIDAD_USO, USAR_NUMEROS_SERIE, CNTRL_SERIES_ENTR, USA_CODIGO_BARRAS, USA_UNIDADES_DIST, ASISTENCIA_AUTOMAT, USA_CODIGO_EAN13, USA_CODIGO_EAN8, USA_CODIGO_UCC12, USA_CODIGO_UCC8, EAN13_REGLA_LOCAL, EAN8_REGLA_LOCAL, UCC12_REGLA_LOCAL, PRIORIDAD_BUSQUEDA, USA_PEDIMENTOS, USA_CODIGO_GENERIC, LINEAS_MAX_TRANS, USAR_APROBACION -- Columnas
			FROM INSERTED I

		SET @ACTUALIZAR_SOLICITUD = 1

		OPEN C_MODIFIED

		FETCH NEXT FROM C_MODIFIED
		INTO @COSTOS_DEC, @EXISTENCIAS_DEC, @PESOS_DEC, @COSTO_FISCAL, @COSTO_COMPARATIVO, @COSTO_INGR_DEFAULT, @UNIDAD_PESO, @UNIDAD_VOLUMEN, @USA_LOCALIZACION, @AJUSTAR_CONTEO, @MAX_AUDITORIA, @FCH_ULT_PROC_VCTO, @FCH_ULT_PROC_APROB, @FECHA_INICIO_TRANS, @PURGAR_CAPAS_COSTO, @NOMBRE_CLASIF_1, @NOMBRE_CLASIF_2, @NOMBRE_CLASIF_3, @NOMBRE_CLASIF_4, @NOMBRE_CLASIF_5, @NOMBRE_CLASIF_6, @TIPO_ASIENTO, @PAQUETE, @ASNT_AJU_VENTA, @ASNT_AJU_CONSUMO, @ASNT_AJU_COMPRA, @ASNT_AJU_PRODUC, @ASNT_AJU_MISCELAN, @ASNT_AJU_FISICO, @ASNT_AJU_VENCIM, @ASNT_AJU_COSTO, @TIPO_FASB52, @MOD_APLIC_ASIENTO, @INTEGRACION_CONTA, @TIPO_CONTA_OMISION, @CTR_EN_TRANSACCION, @EXIST_EN_TOTALES, @TRANSAC_X_USUARIO, @USA_CONSECUTIVOS, @MODALIDAD_USO, @USAR_NUMEROS_SERIE, @CNTRL_SERIES_ENTR, @USA_CODIGO_BARRAS, @USA_UNIDADES_DIST, @ASISTENCIA_AUTOMAT, @USA_CODIGO_EAN13, @USA_CODIGO_EAN8, @USA_CODIGO_UCC12, @USA_CODIGO_UCC8, @EAN13_REGLA_LOCAL, @EAN8_REGLA_LOCAL, @UCC12_REGLA_LOCAL, @PRIORIDAD_BUSQUEDA, @USA_PEDIMENTOS, @USA_CODIGO_GENERIC, @LINEAS_MAX_TRANS, @USAR_APROBACION

		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			IF ( NOT UPDATE(RECORDDATE) AND ( UPDATE(COSTOS_DEC) OR UPDATE(EXISTENCIAS_DEC) OR UPDATE(PESOS_DEC) OR UPDATE(COSTO_FISCAL) OR UPDATE(COSTO_COMPARATIVO) OR UPDATE(COSTO_INGR_DEFAULT) OR UPDATE(UNIDAD_PESO) OR UPDATE(UNIDAD_VOLUMEN) OR UPDATE(USA_LOCALIZACION) OR UPDATE(AJUSTAR_CONTEO) OR UPDATE(MAX_AUDITORIA) OR UPDATE(FCH_ULT_PROC_VCTO) OR UPDATE(FCH_ULT_PROC_APROB) OR UPDATE(FECHA_INICIO_TRANS) OR UPDATE(PURGAR_CAPAS_COSTO) OR UPDATE(NOMBRE_CLASIF_1) OR UPDATE(NOMBRE_CLASIF_2) OR UPDATE(NOMBRE_CLASIF_3) OR UPDATE(NOMBRE_CLASIF_4) OR UPDATE(NOMBRE_CLASIF_5) OR UPDATE(NOMBRE_CLASIF_6) OR UPDATE(TIPO_ASIENTO) OR UPDATE(PAQUETE) OR UPDATE(ASNT_AJU_VENTA) OR UPDATE(ASNT_AJU_CONSUMO) OR UPDATE(ASNT_AJU_COMPRA) OR UPDATE(ASNT_AJU_PRODUC) OR UPDATE(ASNT_AJU_MISCELAN) OR UPDATE(ASNT_AJU_FISICO) OR UPDATE(ASNT_AJU_VENCIM) OR UPDATE(ASNT_AJU_COSTO) OR UPDATE(TIPO_FASB52) OR UPDATE(MOD_APLIC_ASIENTO) OR UPDATE(INTEGRACION_CONTA) OR UPDATE(TIPO_CONTA_OMISION) OR UPDATE(CTR_EN_TRANSACCION) OR UPDATE(EXIST_EN_TOTALES) OR UPDATE(TRANSAC_X_USUARIO) OR UPDATE(USA_CONSECUTIVOS) OR UPDATE(MODALIDAD_USO) OR UPDATE(USAR_NUMEROS_SERIE) OR UPDATE(CNTRL_SERIES_ENTR) OR UPDATE(USA_CODIGO_BARRAS) OR UPDATE(USA_UNIDADES_DIST) OR UPDATE(ASISTENCIA_AUTOMAT) OR UPDATE(USA_CODIGO_EAN13) OR UPDATE(USA_CODIGO_EAN8) OR UPDATE(USA_CODIGO_UCC12) OR UPDATE(USA_CODIGO_UCC8) OR UPDATE(EAN13_REGLA_LOCAL) OR UPDATE(EAN8_REGLA_LOCAL) OR UPDATE(UCC12_REGLA_LOCAL) OR UPDATE(PRIORIDAD_BUSQUEDA) OR UPDATE(USA_PEDIMENTOS) OR UPDATE(USA_CODIGO_GENERIC) OR UPDATE(LINEAS_MAX_TRANS) OR UPDATE(USAR_APROBACION) ) )
			BEGIN

				SELECT @COL_ROWPOINTER = ROWPOINTER 
				FROM $$Compania$$.GLOBALES_CI

				SET @PARAMETROS = 
					'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
					'<GLOBALES_CI>' + 
					'<COSTOS_DEC Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@COSTOS_DEC) + '</COSTOS_DEC>' + 
					'<EXISTENCIAS_DEC Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@EXISTENCIAS_DEC) + '</EXISTENCIAS_DEC>' + 
					'<PESOS_DEC Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@PESOS_DEC) + '</PESOS_DEC>' + 
					'<COSTO_FISCAL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@COSTO_FISCAL) + '</COSTO_FISCAL>' + 
					'<COSTO_COMPARATIVO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@COSTO_COMPARATIVO) + '</COSTO_COMPARATIVO>' + 
					'<COSTO_INGR_DEFAULT Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@COSTO_INGR_DEFAULT) + '</COSTO_INGR_DEFAULT>' + 
					'<UNIDAD_PESO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@UNIDAD_PESO) + '</UNIDAD_PESO>' + 
					'<UNIDAD_VOLUMEN Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@UNIDAD_VOLUMEN) + '</UNIDAD_VOLUMEN>' + 
					'<USA_LOCALIZACION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USA_LOCALIZACION) + '</USA_LOCALIZACION>' + 
					'<AJUSTAR_CONTEO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@AJUSTAR_CONTEO) + '</AJUSTAR_CONTEO>' + 
					'<MAX_AUDITORIA Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@MAX_AUDITORIA) + '</MAX_AUDITORIA>' + 
					'<FCH_ULT_PROC_VCTO Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FCH_ULT_PROC_VCTO) + '</FCH_ULT_PROC_VCTO>' + 
					'<FCH_ULT_PROC_APROB Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FCH_ULT_PROC_APROB) + '</FCH_ULT_PROC_APROB>' + 
					'<FECHA_INICIO_TRANS Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_INICIO_TRANS) + '</FECHA_INICIO_TRANS>' + 
					'<PURGAR_CAPAS_COSTO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@PURGAR_CAPAS_COSTO) + '</PURGAR_CAPAS_COSTO>' + 
					'<NOMBRE_CLASIF_1 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOMBRE_CLASIF_1) + '</NOMBRE_CLASIF_1>' + 
					'<NOMBRE_CLASIF_2 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOMBRE_CLASIF_2) + '</NOMBRE_CLASIF_2>' + 
					'<NOMBRE_CLASIF_3 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOMBRE_CLASIF_3) + '</NOMBRE_CLASIF_3>' + 
					'<NOMBRE_CLASIF_4 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOMBRE_CLASIF_4) + '</NOMBRE_CLASIF_4>' + 
					'<NOMBRE_CLASIF_5 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOMBRE_CLASIF_5) + '</NOMBRE_CLASIF_5>' + 
					'<NOMBRE_CLASIF_6 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOMBRE_CLASIF_6) + '</NOMBRE_CLASIF_6>' + 
					'<TIPO_ASIENTO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_ASIENTO) + '</TIPO_ASIENTO>' + 
					'<PAQUETE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@PAQUETE) + '</PAQUETE>' + 
					'<ASNT_AJU_VENTA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ASNT_AJU_VENTA) + '</ASNT_AJU_VENTA>' + 
					'<ASNT_AJU_CONSUMO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ASNT_AJU_CONSUMO) + '</ASNT_AJU_CONSUMO>' + 
					'<ASNT_AJU_COMPRA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ASNT_AJU_COMPRA) + '</ASNT_AJU_COMPRA>' + 
					'<ASNT_AJU_PRODUC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ASNT_AJU_PRODUC) + '</ASNT_AJU_PRODUC>' + 
					'<ASNT_AJU_MISCELAN Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ASNT_AJU_MISCELAN) + '</ASNT_AJU_MISCELAN>'


				SET @PARAMETROS2 =
					'<ASNT_AJU_FISICO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ASNT_AJU_FISICO) + '</ASNT_AJU_FISICO>' + 
					'<ASNT_AJU_VENCIM Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ASNT_AJU_VENCIM) + '</ASNT_AJU_VENCIM>' + 
					'<ASNT_AJU_COSTO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ASNT_AJU_COSTO) + '</ASNT_AJU_COSTO>' + 
					'<TIPO_FASB52 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_FASB52) + '</TIPO_FASB52>' + 
					'<MOD_APLIC_ASIENTO Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@MOD_APLIC_ASIENTO) + '</MOD_APLIC_ASIENTO>' + 
					'<INTEGRACION_CONTA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@INTEGRACION_CONTA) + '</INTEGRACION_CONTA>' + 
					'<TIPO_CONTA_OMISION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_CONTA_OMISION) + '</TIPO_CONTA_OMISION>' + 
					'<CTR_EN_TRANSACCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_EN_TRANSACCION) + '</CTR_EN_TRANSACCION>' + 
					'<EXIST_EN_TOTALES Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@EXIST_EN_TOTALES) + '</EXIST_EN_TOTALES>' + 
					'<TRANSAC_X_USUARIO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TRANSAC_X_USUARIO) + '</TRANSAC_X_USUARIO>' + 
					'<USA_CONSECUTIVOS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USA_CONSECUTIVOS) + '</USA_CONSECUTIVOS>' + 
					'<MODALIDAD_USO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@MODALIDAD_USO) + '</MODALIDAD_USO>' + 
					'<USAR_NUMEROS_SERIE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USAR_NUMEROS_SERIE) + '</USAR_NUMEROS_SERIE>' + 
					'<CNTRL_SERIES_ENTR Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CNTRL_SERIES_ENTR) + '</CNTRL_SERIES_ENTR>' + 
					'<USA_CODIGO_BARRAS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USA_CODIGO_BARRAS) + '</USA_CODIGO_BARRAS>' + 
					'<USA_UNIDADES_DIST Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USA_UNIDADES_DIST) + '</USA_UNIDADES_DIST>' + 
					'<ASISTENCIA_AUTOMAT Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ASISTENCIA_AUTOMAT) + '</ASISTENCIA_AUTOMAT>' + 
					'<USA_CODIGO_EAN13 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USA_CODIGO_EAN13) + '</USA_CODIGO_EAN13>' + 
					'<USA_CODIGO_EAN8 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USA_CODIGO_EAN8) + '</USA_CODIGO_EAN8>' + 
					'<USA_CODIGO_UCC12 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USA_CODIGO_UCC12) + '</USA_CODIGO_UCC12>' + 
					'<USA_CODIGO_UCC8 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USA_CODIGO_UCC8) + '</USA_CODIGO_UCC8>' + 
					'<EAN13_REGLA_LOCAL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@EAN13_REGLA_LOCAL) + '</EAN13_REGLA_LOCAL>' + 
					'<EAN8_REGLA_LOCAL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@EAN8_REGLA_LOCAL) + '</EAN8_REGLA_LOCAL>' + 
					'<UCC12_REGLA_LOCAL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@UCC12_REGLA_LOCAL) + '</UCC12_REGLA_LOCAL>' + 
					'<PRIORIDAD_BUSQUEDA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@PRIORIDAD_BUSQUEDA) + '</PRIORIDAD_BUSQUEDA>' + 
					'<USA_PEDIMENTOS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USA_PEDIMENTOS) + '</USA_PEDIMENTOS>' + 
					'<USA_CODIGO_GENERIC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USA_CODIGO_GENERIC) + '</USA_CODIGO_GENERIC>' + 
					'<LINEAS_MAX_TRANS Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@LINEAS_MAX_TRANS) + '</LINEAS_MAX_TRANS>' + 
					'<USAR_APROBACION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USAR_APROBACION) + '</USAR_APROBACION>' + 
					'</GLOBALES_CI>'



				-- inserta la solicitud correspondiente
				EXECUTE  ('ERPADMIN.POS_InsertarSolicitud ''' + @PUBLICADOR + ''', ''GLOBALESCIPOS600'', ''MODIFICA'', ''' + @PARAMETROS + @PARAMETROS2 + ''', ' + @ACTUALIZAR_SOLICITUD + ', ''' + @COL_ROWPOINTER + '''')				
			END

			FETCH NEXT FROM C_MODIFIED
			INTO @COSTOS_DEC, @EXISTENCIAS_DEC, @PESOS_DEC, @COSTO_FISCAL, @COSTO_COMPARATIVO, @COSTO_INGR_DEFAULT, @UNIDAD_PESO, @UNIDAD_VOLUMEN, @USA_LOCALIZACION, @AJUSTAR_CONTEO, @MAX_AUDITORIA, @FCH_ULT_PROC_VCTO, @FCH_ULT_PROC_APROB, @FECHA_INICIO_TRANS, @PURGAR_CAPAS_COSTO, @NOMBRE_CLASIF_1, @NOMBRE_CLASIF_2, @NOMBRE_CLASIF_3, @NOMBRE_CLASIF_4, @NOMBRE_CLASIF_5, @NOMBRE_CLASIF_6, @TIPO_ASIENTO, @PAQUETE, @ASNT_AJU_VENTA, @ASNT_AJU_CONSUMO, @ASNT_AJU_COMPRA, @ASNT_AJU_PRODUC, @ASNT_AJU_MISCELAN, @ASNT_AJU_FISICO, @ASNT_AJU_VENCIM, @ASNT_AJU_COSTO, @TIPO_FASB52, @MOD_APLIC_ASIENTO, @INTEGRACION_CONTA, @TIPO_CONTA_OMISION, @CTR_EN_TRANSACCION, @EXIST_EN_TOTALES, @TRANSAC_X_USUARIO, @USA_CONSECUTIVOS, @MODALIDAD_USO, @USAR_NUMEROS_SERIE, @CNTRL_SERIES_ENTR, @USA_CODIGO_BARRAS, @USA_UNIDADES_DIST, @ASISTENCIA_AUTOMAT, @USA_CODIGO_EAN13, @USA_CODIGO_EAN8, @USA_CODIGO_UCC12, @USA_CODIGO_UCC8, @EAN13_REGLA_LOCAL, @EAN8_REGLA_LOCAL, @UCC12_REGLA_LOCAL, @PRIORIDAD_BUSQUEDA, @USA_PEDIMENTOS, @USA_CODIGO_GENERIC, @LINEAS_MAX_TRANS, @USAR_APROBACION
		END

		CLOSE C_MODIFIED
		DEALLOCATE C_MODIFIED
	END

	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para modificar la tabla GLOBALES_CI.',16,1 )
	END
END;


CREATE TRIGGER $$Compania$$.GLOBALES_FA_POS_INS
ON $$Compania$$.GLOBALES_FA
FOR INSERT
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @PARAMETROS2 VARCHAR(8000)
	DECLARE @PARAMETROS3 VARCHAR(8000)	
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @LLAVE INT
	DECLARE @BODEGA_DEFAULT VARCHAR(4)
	DECLARE @COND_PAGO_CONTAD VARCHAR(4)
	DECLARE @VENDEDOR_OBLIGATOR VARCHAR(1)
	DECLARE @FACT_EXC_PEDIDO VARCHAR(1)
	DECLARE @USA_TARJETA_CRED VARCHAR(1)
	DECLARE @BODEGA_POR_LINEA VARCHAR(1)
	DECLARE @PERMITE_BACKORDER VARCHAR(1)
	DECLARE @CANCEL_PED_PARCIAL VARCHAR(1)
	DECLARE @PED_A_IMPRESORA VARCHAR(1)
	DECLARE @DOC_A_IMPRESORA VARCHAR(1)
	DECLARE @IMPRE_LOTE_SEPARAD VARCHAR(1)
	DECLARE @FACTURA_MULTIPAG VARCHAR(1)
	DECLARE @INCR_NUM_FACTURA VARCHAR(1)
	DECLARE @MULTIPLE_FMT_FACTU VARCHAR(1)
	DECLARE @MULTIPLE_FMT_PEDID VARCHAR(1)
	DECLARE @ORDEN_LINEAS_FACT VARCHAR(1)
	DECLARE @REIMPRESION_PEDIDO VARCHAR(1)
	DECLARE @IMP_PEDIDO_AL_FACT VARCHAR(1)
	DECLARE @REDONDEAR_FACTURA VARCHAR(1)
	DECLARE @FACTOR_REDONDEO DECIMAL(28,8)
	DECLARE @PRECIOS_DEC INT
	DECLARE @DESC_EN_PRECIO VARCHAR(1)
	DECLARE @IMP1_EN_PRECIO VARCHAR(1)
	DECLARE @IMP1_AFECTA_DESCTO VARCHAR(1)
	DECLARE @APLICA_NI_PR_IMP1 VARCHAR(1)
	DECLARE @MONEDA_IMP1 VARCHAR(1)
	DECLARE @NIV_PRECIO_IMP1 VARCHAR(12)
	DECLARE @PAGO_COM_PARCIAL VARCHAR(1)
	DECLARE @PORC_IMP_COMISION DECIMAL(28,8)
	DECLARE @ASIENTO_VENTA_POR VARCHAR(1)
	DECLARE @TIPO_ASIENTO VARCHAR(4)
	DECLARE @PAQUETE VARCHAR(4)
	DECLARE @CTR_FLETE VARCHAR(25)
	DECLARE @CTA_FLETE VARCHAR(25)
	DECLARE @CTR_SEGURO VARCHAR(25)
	DECLARE @CTA_SEGURO VARCHAR(25)
	DECLARE @CTR_DOCUMENTACI VARCHAR(25)
	DECLARE @CTA_DOCUMENTACI VARCHAR(25)
	DECLARE @CTR_IMPUESTO1 VARCHAR(25)
	DECLARE @CTA_IMPUESTO1 VARCHAR(25)
	DECLARE @CTR_IMPUESTO2 VARCHAR(25)
	DECLARE @CTA_IMPUESTO2 VARCHAR(25)
	DECLARE @CTR_IMP_COMISIO VARCHAR(25)
	DECLARE @CTA_IMP_COMISIO VARCHAR(25)
	DECLARE @USAR_RUBROS VARCHAR(1)
	DECLARE @RUBRO1_NOMBRE VARCHAR(15)
	DECLARE @RUBRO2_NOMBRE VARCHAR(15)
	DECLARE @RUBRO3_NOMBRE VARCHAR(15)
	DECLARE @RUBRO4_NOMBRE VARCHAR(15)
	DECLARE @USA_BOLETAS VARCHAR(1)
	DECLARE @NOM_RUBRO6_CLI VARCHAR(60)
	DECLARE @NOM_RUBRO7_CLI VARCHAR(60)
	DECLARE @NOM_RUBRO8_CLI VARCHAR(60)
	DECLARE @NOM_RUBRO9_CLI VARCHAR(60)
	DECLARE @RUBRO5_NOMBRE VARCHAR(15)
	DECLARE @NIV_PRE_PUBLICO VARCHAR(12)
	DECLARE @MONEDA_PUBLICO VARCHAR(1)
	DECLARE @COLUMNAS_ESTANDAR VARCHAR(4000)
	DECLARE @ASIENTO_COSTO_POR VARCHAR(1)
	DECLARE @CAMBIAR_ESQ_TRAB VARCHAR(1)
	DECLARE @FACT_DOCS_VENCIDOS VARCHAR(1)
	DECLARE @FACT_COBRO_JUD VARCHAR(1)
	DECLARE @FACT_LIMITE_CRED VARCHAR(1)
	DECLARE @MOD_APLIC_ASIENTO INT
	DECLARE @INTEGRACION_CONTA VARCHAR(1)
	DECLARE @TIPO_CONTA_OMISION VARCHAR(1)
	DECLARE @TIPO_CAMBIO VARCHAR(4)
	DECLARE @PRECISION_MAXIMA VARCHAR(1)
	DECLARE @LINEAS_ARTICULO INT
	DECLARE @LINEAS_FACTURA INT
	DECLARE @LINEAS_ADICIONALES INT
	DECLARE @DETALLE_KITS VARCHAR(1)
	DECLARE @MOD_PRECIOS VARCHAR(1)
	DECLARE @PREVISTA1 VARCHAR(1)
	DECLARE @PREVISTA2 VARCHAR(1)
	DECLARE @PREVISTA3 VARCHAR(1)
	DECLARE @PREVISTA4 VARCHAR(1)
	DECLARE @PREVISTA5 VARCHAR(1)
	DECLARE @CTR_CONSUMO VARCHAR(25)
	DECLARE @CC_EN_LINEA VARCHAR(1)
	DECLARE @CG_EN_LINEA VARCHAR(1)
	DECLARE @USAR_AUTORIZACION VARCHAR(1)
	DECLARE @IMP1_EN_BONIFICA VARCHAR(1)
	DECLARE @IMP2_EN_BONIFICA VARCHAR(1)
	DECLARE @ASIENTO_CONTCXCPOR VARCHAR(1)
	DECLARE @USAR_APROB_PEDIDOS VARCHAR(1)
	DECLARE @NOM_RUBRO10_CLI VARCHAR(60)
	DECLARE @LISTA_PRECIOS VARCHAR(1)
	DECLARE @MARGEN_UTILIDAD VARCHAR(1)
	DECLARE @MONTO_MINIMO VARCHAR(1)
	DECLARE @DOCS_VENCIDOS VARCHAR(1)
	DECLARE @LIMITE_CREDITO VARCHAR(1)
	DECLARE @COBRO_JUDICIAL VARCHAR(1)
	DECLARE @SIN_OC VARCHAR(1)
	DECLARE @DIAS_ATRASO VARCHAR(1)
	DECLARE @MONTO_MINIMO_LOCAL DECIMAL(28,8)
	DECLARE @MONTO_MINIMO_DOLAR DECIMAL(28,8)
	DECLARE @SALDO_MAX_LOCAL DECIMAL(28,8)
	DECLARE @SALDO_MAX_DOLAR DECIMAL(28,8)
	DECLARE @MAX_DIAS_ATRASO INT
	DECLARE @MAX_DOCS_VENC INT
	DECLARE @PRECIOS_DEC_DOLAR INT
	DECLARE @COND_PAGO_NIV_PRE VARCHAR(1)
	DECLARE @FACT_LISTA_PRECIOS VARCHAR(1)
	DECLARE @FACT_MARGEN_UTILID VARCHAR(1)
	DECLARE @FACT_MONTO_MINIMO VARCHAR(1)
	DECLARE @FACT_DIAS_ATRASO VARCHAR(1)
	DECLARE @FACT_SIN_OC VARCHAR(1)
	DECLARE @USAR_RUBROS_VAL VARCHAR(1)
	DECLARE @IMP_DESC_CLASIFIC VARCHAR(1)
	DECLARE @LIMITAR_MAX_LINEAS VARCHAR(1)
	DECLARE @INDICAD_PEDIDO VARCHAR(1)
	DECLARE @PRECIO_COSTO VARCHAR(1)
	DECLARE @FACT_MENOR_RESERVA VARCHAR(1)
	DECLARE @USA_DESPACHOS VARCHAR(1)
	DECLARE @CTR_INV_DESPACHAR VARCHAR(25)
	DECLARE @CTA_INV_DESPACHAR VARCHAR(25)
	DECLARE @ANULA_CXC_APLICADO VARCHAR(1)
	DECLARE @USA_ESQUEMA_CAJAS VARCHAR(1)
	DECLARE @TIPO_COSTO_NOEXIST VARCHAR(1)
	DECLARE @CALCULO_IMP2 VARCHAR(1)
	DECLARE @CATEGORIA_CLIENTE VARCHAR(8)
	DECLARE @NIVEL_PRECIO VARCHAR(12)
	DECLARE @MONEDA_NIVEL VARCHAR(1)
	DECLARE @DESCUENTO_CASCADA VARCHAR(1)
	DECLARE @RETENCIONES VARCHAR(1)
	DECLARE @RETENCIONES_FLETES VARCHAR(1)
	DECLARE @ARTICULO VARCHAR(20)
	DECLARE @CODIGO_RETENCION VARCHAR(4)
	DECLARE @APLICAR_DESC_GEN VARCHAR(1)
	DECLARE @MODO_DESC_MULT VARCHAR(1)
	DECLARE @DCTO_GENERAL VARCHAR(1)
	DECLARE @FACT_DCTO_GENERAL VARCHAR(1)
	DECLARE @AUTOR_GRABAR VARCHAR(1)
	DECLARE @AUTOR_APROBAR VARCHAR(1)
	DECLARE @AUTOR_FACTUREMITIR VARCHAR(1)
	DECLARE @AUTOR_FACTREMISION VARCHAR(1)
	DECLARE @CARGAR_APROBADO_CC VARCHAR(1)
	DECLARE @REMISION_A_IMPRES VARCHAR(1)
	DECLARE @DEVOLUC_A_IMPRES VARCHAR(1)
	DECLARE @NOM_RUBRO16_CLI VARCHAR(60)
	DECLARE @NOM_RUBRO17_CLI VARCHAR(60)
	DECLARE @NOM_RUBRO18_CLI VARCHAR(60)
	DECLARE @NOM_RUBRO19_CLI VARCHAR(60)
	DECLARE @NOM_RUBRO20_CLI VARCHAR(60)
	

	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM 
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_INSERTED CURSOR LOCAL FOR
		SELECT LLAVE, BODEGA_DEFAULT, COND_PAGO_CONTAD, VENDEDOR_OBLIGATOR, FACT_EXC_PEDIDO, USA_TARJETA_CRED, BODEGA_POR_LINEA, PERMITE_BACKORDER, CANCEL_PED_PARCIAL, PED_A_IMPRESORA, DOC_A_IMPRESORA, IMPRE_LOTE_SEPARAD, FACTURA_MULTIPAG, INCR_NUM_FACTURA, MULTIPLE_FMT_FACTU, MULTIPLE_FMT_PEDID, ORDEN_LINEAS_FACT, REIMPRESION_PEDIDO, IMP_PEDIDO_AL_FACT, REDONDEAR_FACTURA, FACTOR_REDONDEO, PRECIOS_DEC, DESC_EN_PRECIO, IMP1_EN_PRECIO, IMP1_AFECTA_DESCTO, APLICA_NI_PR_IMP1, MONEDA_IMP1, NIV_PRECIO_IMP1, PAGO_COM_PARCIAL, PORC_IMP_COMISION, ASIENTO_VENTA_POR, TIPO_ASIENTO, PAQUETE, CTR_FLETE, CTA_FLETE, CTR_SEGURO, CTA_SEGURO, CTR_DOCUMENTACI, CTA_DOCUMENTACI, CTR_IMPUESTO1, CTA_IMPUESTO1, CTR_IMPUESTO2, CTA_IMPUESTO2, CTR_IMP_COMISIO, CTA_IMP_COMISIO, USAR_RUBROS, RUBRO1_NOMBRE, RUBRO2_NOMBRE, RUBRO3_NOMBRE, RUBRO4_NOMBRE, USA_BOLETAS, NOM_RUBRO6_CLI, NOM_RUBRO7_CLI, NOM_RUBRO8_CLI, NOM_RUBRO9_CLI, RUBRO5_NOMBRE, NIV_PRE_PUBLICO, MONEDA_PUBLICO, COLUMNAS_ESTANDAR, ASIENTO_COSTO_POR, CAMBIAR_ESQ_TRAB, FACT_DOCS_VENCIDOS, FACT_COBRO_JUD, FACT_LIMITE_CRED, MOD_APLIC_ASIENTO, INTEGRACION_CONTA, TIPO_CONTA_OMISION, TIPO_CAMBIO, PRECISION_MAXIMA, LINEAS_ARTICULO, LINEAS_FACTURA, LINEAS_ADICIONALES, DETALLE_KITS, MOD_PRECIOS, PREVISTA1, PREVISTA2, PREVISTA3, PREVISTA4, PREVISTA5, CTR_CONSUMO, CC_EN_LINEA, CG_EN_LINEA, USAR_AUTORIZACION, IMP1_EN_BONIFICA, IMP2_EN_BONIFICA, ASIENTO_CONTCXCPOR, USAR_APROB_PEDIDOS, NOM_RUBRO10_CLI, LISTA_PRECIOS, MARGEN_UTILIDAD, MONTO_MINIMO, DOCS_VENCIDOS, LIMITE_CREDITO, COBRO_JUDICIAL, SIN_OC, DIAS_ATRASO, MONTO_MINIMO_LOCAL, MONTO_MINIMO_DOLAR, SALDO_MAX_LOCAL, SALDO_MAX_DOLAR, MAX_DIAS_ATRASO, MAX_DOCS_VENC, PRECIOS_DEC_DOLAR, COND_PAGO_NIV_PRE, FACT_LISTA_PRECIOS, FACT_MARGEN_UTILID, FACT_MONTO_MINIMO, FACT_DIAS_ATRASO, FACT_SIN_OC, USAR_RUBROS_VAL, IMP_DESC_CLASIFIC, LIMITAR_MAX_LINEAS, INDICAD_PEDIDO, PRECIO_COSTO, FACT_MENOR_RESERVA, USA_DESPACHOS, CTR_INV_DESPACHAR, CTA_INV_DESPACHAR, ANULA_CXC_APLICADO, USA_ESQUEMA_CAJAS, TIPO_COSTO_NOEXIST, CALCULO_IMP2, CATEGORIA_CLIENTE, NIVEL_PRECIO, MONEDA_NIVEL, DESCUENTO_CASCADA, RETENCIONES, RETENCIONES_FLETES, ARTICULO, CODIGO_RETENCION, APLICAR_DESC_GEN, MODO_DESC_MULT, DCTO_GENERAL, FACT_DCTO_GENERAL, AUTOR_GRABAR, AUTOR_APROBAR, AUTOR_FACTUREMITIR, AUTOR_FACTREMISION, CARGAR_APROBADO_CC, REMISION_A_IMPRES, DEVOLUC_A_IMPRES, NOM_RUBRO16_CLI, NOM_RUBRO17_CLI, NOM_RUBRO18_CLI, NOM_RUBRO19_CLI, NOM_RUBRO20_CLI
		FROM INSERTED i
			
		OPEN C_INSERTED	
		FETCH NEXT FROM C_INSERTED INTO
		@LLAVE, @BODEGA_DEFAULT, @COND_PAGO_CONTAD, @VENDEDOR_OBLIGATOR, @FACT_EXC_PEDIDO, @USA_TARJETA_CRED, @BODEGA_POR_LINEA, @PERMITE_BACKORDER, @CANCEL_PED_PARCIAL, @PED_A_IMPRESORA, @DOC_A_IMPRESORA, @IMPRE_LOTE_SEPARAD, @FACTURA_MULTIPAG, @INCR_NUM_FACTURA, @MULTIPLE_FMT_FACTU, @MULTIPLE_FMT_PEDID, @ORDEN_LINEAS_FACT, @REIMPRESION_PEDIDO, @IMP_PEDIDO_AL_FACT, @REDONDEAR_FACTURA, @FACTOR_REDONDEO, @PRECIOS_DEC, @DESC_EN_PRECIO, @IMP1_EN_PRECIO, @IMP1_AFECTA_DESCTO, @APLICA_NI_PR_IMP1, @MONEDA_IMP1, @NIV_PRECIO_IMP1, @PAGO_COM_PARCIAL, @PORC_IMP_COMISION, @ASIENTO_VENTA_POR, @TIPO_ASIENTO, @PAQUETE, @CTR_FLETE, @CTA_FLETE, @CTR_SEGURO, @CTA_SEGURO, @CTR_DOCUMENTACI, @CTA_DOCUMENTACI, @CTR_IMPUESTO1, @CTA_IMPUESTO1, @CTR_IMPUESTO2, @CTA_IMPUESTO2, @CTR_IMP_COMISIO, @CTA_IMP_COMISIO, @USAR_RUBROS, @RUBRO1_NOMBRE, @RUBRO2_NOMBRE, @RUBRO3_NOMBRE, @RUBRO4_NOMBRE, @USA_BOLETAS, @NOM_RUBRO6_CLI, @NOM_RUBRO7_CLI, @NOM_RUBRO8_CLI, @NOM_RUBRO9_CLI, @RUBRO5_NOMBRE, @NIV_PRE_PUBLICO, @MONEDA_PUBLICO, @COLUMNAS_ESTANDAR, @ASIENTO_COSTO_POR, @CAMBIAR_ESQ_TRAB, @FACT_DOCS_VENCIDOS, @FACT_COBRO_JUD, @FACT_LIMITE_CRED, @MOD_APLIC_ASIENTO, @INTEGRACION_CONTA, @TIPO_CONTA_OMISION, @TIPO_CAMBIO, @PRECISION_MAXIMA, @LINEAS_ARTICULO, @LINEAS_FACTURA, @LINEAS_ADICIONALES, @DETALLE_KITS, @MOD_PRECIOS, @PREVISTA1, @PREVISTA2, @PREVISTA3, @PREVISTA4, @PREVISTA5, @CTR_CONSUMO, @CC_EN_LINEA, @CG_EN_LINEA, @USAR_AUTORIZACION, @IMP1_EN_BONIFICA, @IMP2_EN_BONIFICA, @ASIENTO_CONTCXCPOR, @USAR_APROB_PEDIDOS, @NOM_RUBRO10_CLI, @LISTA_PRECIOS, @MARGEN_UTILIDAD, @MONTO_MINIMO, @DOCS_VENCIDOS, @LIMITE_CREDITO, @COBRO_JUDICIAL, @SIN_OC, @DIAS_ATRASO, @MONTO_MINIMO_LOCAL, @MONTO_MINIMO_DOLAR, @SALDO_MAX_LOCAL, @SALDO_MAX_DOLAR, @MAX_DIAS_ATRASO, @MAX_DOCS_VENC, @PRECIOS_DEC_DOLAR, @COND_PAGO_NIV_PRE, @FACT_LISTA_PRECIOS, @FACT_MARGEN_UTILID, @FACT_MONTO_MINIMO, @FACT_DIAS_ATRASO, @FACT_SIN_OC, @USAR_RUBROS_VAL, @IMP_DESC_CLASIFIC, @LIMITAR_MAX_LINEAS, @INDICAD_PEDIDO, @PRECIO_COSTO, @FACT_MENOR_RESERVA, @USA_DESPACHOS, @CTR_INV_DESPACHAR, @CTA_INV_DESPACHAR, @ANULA_CXC_APLICADO, @USA_ESQUEMA_CAJAS, @TIPO_COSTO_NOEXIST, @CALCULO_IMP2, @CATEGORIA_CLIENTE, @NIVEL_PRECIO, @MONEDA_NIVEL, @DESCUENTO_CASCADA, @RETENCIONES, @RETENCIONES_FLETES, @ARTICULO, @CODIGO_RETENCION, @APLICAR_DESC_GEN, @MODO_DESC_MULT, @DCTO_GENERAL, @FACT_DCTO_GENERAL, @AUTOR_GRABAR, @AUTOR_APROBAR, @AUTOR_FACTUREMITIR, @AUTOR_FACTREMISION, @CARGAR_APROBADO_CC, @REMISION_A_IMPRES, @DEVOLUC_A_IMPRES, @NOM_RUBRO16_CLI, @NOM_RUBRO17_CLI, @NOM_RUBRO18_CLI, @NOM_RUBRO19_CLI, @NOM_RUBRO20_CLI

		SET @ERROR = 0
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS = 
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<GLOBALES_FA>' + 
				'<LLAVE Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@LLAVE) + '</LLAVE>' + 
				'<BODEGA_DEFAULT Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@BODEGA_DEFAULT) + '</BODEGA_DEFAULT>' + 
				'<COND_PAGO_CONTAD Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@COND_PAGO_CONTAD) + '</COND_PAGO_CONTAD>' + 
				'<VENDEDOR_OBLIGATOR Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@VENDEDOR_OBLIGATOR) + '</VENDEDOR_OBLIGATOR>' + 
				'<FACT_EXC_PEDIDO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@FACT_EXC_PEDIDO) + '</FACT_EXC_PEDIDO>' + 
				'<USA_TARJETA_CRED Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USA_TARJETA_CRED) + '</USA_TARJETA_CRED>' + 
				'<BODEGA_POR_LINEA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@BODEGA_POR_LINEA) + '</BODEGA_POR_LINEA>' + 
				'<PERMITE_BACKORDER Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@PERMITE_BACKORDER) + '</PERMITE_BACKORDER>' + 
				'<CANCEL_PED_PARCIAL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CANCEL_PED_PARCIAL) + '</CANCEL_PED_PARCIAL>' + 
				'<PED_A_IMPRESORA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@PED_A_IMPRESORA) + '</PED_A_IMPRESORA>' + 
				'<DOC_A_IMPRESORA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DOC_A_IMPRESORA) + '</DOC_A_IMPRESORA>' + 
				'<IMPRE_LOTE_SEPARAD Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@IMPRE_LOTE_SEPARAD) + '</IMPRE_LOTE_SEPARAD>' + 
				'<FACTURA_MULTIPAG Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@FACTURA_MULTIPAG) + '</FACTURA_MULTIPAG>' + 
				'<INCR_NUM_FACTURA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@INCR_NUM_FACTURA) + '</INCR_NUM_FACTURA>' + 
				'<MULTIPLE_FMT_FACTU Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@MULTIPLE_FMT_FACTU) + '</MULTIPLE_FMT_FACTU>' + 
				'<MULTIPLE_FMT_PEDID Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@MULTIPLE_FMT_PEDID) + '</MULTIPLE_FMT_PEDID>' + 
				'<ORDEN_LINEAS_FACT Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ORDEN_LINEAS_FACT) + '</ORDEN_LINEAS_FACT>' + 
				'<REIMPRESION_PEDIDO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@REIMPRESION_PEDIDO) + '</REIMPRESION_PEDIDO>' + 
				'<IMP_PEDIDO_AL_FACT Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@IMP_PEDIDO_AL_FACT) + '</IMP_PEDIDO_AL_FACT>' + 
				'<REDONDEAR_FACTURA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@REDONDEAR_FACTURA) + '</REDONDEAR_FACTURA>' + 
				'<FACTOR_REDONDEO Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@FACTOR_REDONDEO) + '</FACTOR_REDONDEO>' + 
				'<PRECIOS_DEC Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@PRECIOS_DEC) + '</PRECIOS_DEC>' + 
				'<DESC_EN_PRECIO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DESC_EN_PRECIO) + '</DESC_EN_PRECIO>' + 
				'<IMP1_EN_PRECIO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@IMP1_EN_PRECIO) + '</IMP1_EN_PRECIO>' + 
				'<IMP1_AFECTA_DESCTO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@IMP1_AFECTA_DESCTO) + '</IMP1_AFECTA_DESCTO>' + 
				'<APLICA_NI_PR_IMP1 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@APLICA_NI_PR_IMP1) + '</APLICA_NI_PR_IMP1>' + 
				'<MONEDA_IMP1 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@MONEDA_IMP1) + '</MONEDA_IMP1>' + 
				'<NIV_PRECIO_IMP1 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NIV_PRECIO_IMP1) + '</NIV_PRECIO_IMP1>' + 
				'<PAGO_COM_PARCIAL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@PAGO_COM_PARCIAL) + '</PAGO_COM_PARCIAL>' + 
				'<PORC_IMP_COMISION Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@PORC_IMP_COMISION) + '</PORC_IMP_COMISION>' + 
				'<ASIENTO_VENTA_POR Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ASIENTO_VENTA_POR) + '</ASIENTO_VENTA_POR>' + 
				'<TIPO_ASIENTO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_ASIENTO) + '</TIPO_ASIENTO>' + 
				'<PAQUETE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@PAQUETE) + '</PAQUETE>' + 
				'<CTR_FLETE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_FLETE) + '</CTR_FLETE>' + 
				'<CTA_FLETE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_FLETE) + '</CTA_FLETE>' + 
				'<CTR_SEGURO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_SEGURO) + '</CTR_SEGURO>' + 
				'<CTA_SEGURO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_SEGURO) + '</CTA_SEGURO>' + 
				'<CTR_DOCUMENTACI Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_DOCUMENTACI) + '</CTR_DOCUMENTACI>' + 
				'<CTA_DOCUMENTACI Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_DOCUMENTACI) + '</CTA_DOCUMENTACI>' + 
				'<CTR_IMPUESTO1 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_IMPUESTO1) + '</CTR_IMPUESTO1>' + 
				'<CTA_IMPUESTO1 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_IMPUESTO1) + '</CTA_IMPUESTO1>' + 
				'<CTR_IMPUESTO2 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_IMPUESTO2) + '</CTR_IMPUESTO2>' + 
				'<CTA_IMPUESTO2 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_IMPUESTO2) + '</CTA_IMPUESTO2>' + 
				'<CTR_IMP_COMISIO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_IMP_COMISIO) + '</CTR_IMP_COMISIO>' + 
				'<CTA_IMP_COMISIO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_IMP_COMISIO) + '</CTA_IMP_COMISIO>' + 
				'<USAR_RUBROS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USAR_RUBROS) + '</USAR_RUBROS>' + 
				'<RUBRO1_NOMBRE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@RUBRO1_NOMBRE) + '</RUBRO1_NOMBRE>' + 
				'<RUBRO2_NOMBRE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@RUBRO2_NOMBRE) + '</RUBRO2_NOMBRE>'
				
			SET @PARAMETROS2 = 				
				'<RUBRO3_NOMBRE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@RUBRO3_NOMBRE) + '</RUBRO3_NOMBRE>' + 
				'<RUBRO4_NOMBRE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@RUBRO4_NOMBRE) + '</RUBRO4_NOMBRE>' + 
				'<USA_BOLETAS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USA_BOLETAS) + '</USA_BOLETAS>' + 
				'<NOM_RUBRO6_CLI Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOM_RUBRO6_CLI) + '</NOM_RUBRO6_CLI>' + 
				'<NOM_RUBRO7_CLI Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOM_RUBRO7_CLI) + '</NOM_RUBRO7_CLI>' + 
				'<NOM_RUBRO8_CLI Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOM_RUBRO8_CLI) + '</NOM_RUBRO8_CLI>' + 
				'<NOM_RUBRO9_CLI Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOM_RUBRO9_CLI) + '</NOM_RUBRO9_CLI>' + 
				'<RUBRO5_NOMBRE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@RUBRO5_NOMBRE) + '</RUBRO5_NOMBRE>' + 
				'<NIV_PRE_PUBLICO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NIV_PRE_PUBLICO) + '</NIV_PRE_PUBLICO>' + 
				'<MONEDA_PUBLICO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@MONEDA_PUBLICO) + '</MONEDA_PUBLICO>' + 
				'<COLUMNAS_ESTANDAR Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@COLUMNAS_ESTANDAR) + '</COLUMNAS_ESTANDAR>' + 
				'<ASIENTO_COSTO_POR Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ASIENTO_COSTO_POR) + '</ASIENTO_COSTO_POR>' + 
				'<CAMBIAR_ESQ_TRAB Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CAMBIAR_ESQ_TRAB) + '</CAMBIAR_ESQ_TRAB>' + 
				'<FACT_DOCS_VENCIDOS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@FACT_DOCS_VENCIDOS) + '</FACT_DOCS_VENCIDOS>' + 
				'<FACT_COBRO_JUD Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@FACT_COBRO_JUD) + '</FACT_COBRO_JUD>' + 
				'<FACT_LIMITE_CRED Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@FACT_LIMITE_CRED) + '</FACT_LIMITE_CRED>' + 
				'<MOD_APLIC_ASIENTO Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@MOD_APLIC_ASIENTO) + '</MOD_APLIC_ASIENTO>' + 
				'<INTEGRACION_CONTA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@INTEGRACION_CONTA) + '</INTEGRACION_CONTA>' + 
				'<TIPO_CONTA_OMISION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_CONTA_OMISION) + '</TIPO_CONTA_OMISION>' + 
				'<TIPO_CAMBIO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_CAMBIO) + '</TIPO_CAMBIO>' + 
				'<PRECISION_MAXIMA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@PRECISION_MAXIMA) + '</PRECISION_MAXIMA>' + 
				'<LINEAS_ARTICULO Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@LINEAS_ARTICULO) + '</LINEAS_ARTICULO>' + 
				'<LINEAS_FACTURA Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@LINEAS_FACTURA) + '</LINEAS_FACTURA>' + 
				'<LINEAS_ADICIONALES Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@LINEAS_ADICIONALES) + '</LINEAS_ADICIONALES>' + 
				'<DETALLE_KITS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DETALLE_KITS) + '</DETALLE_KITS>' + 
				'<MOD_PRECIOS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@MOD_PRECIOS) + '</MOD_PRECIOS>' + 
				'<PREVISTA1 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@PREVISTA1) + '</PREVISTA1>' + 
				'<PREVISTA2 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@PREVISTA2) + '</PREVISTA2>' + 
				'<PREVISTA3 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@PREVISTA3) + '</PREVISTA3>' + 
				'<PREVISTA4 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@PREVISTA4) + '</PREVISTA4>' + 
				'<PREVISTA5 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@PREVISTA5) + '</PREVISTA5>' + 
				'<CTR_CONSUMO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_CONSUMO) + '</CTR_CONSUMO>' + 
				'<CC_EN_LINEA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CC_EN_LINEA) + '</CC_EN_LINEA>' + 
				'<CG_EN_LINEA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CG_EN_LINEA) + '</CG_EN_LINEA>' + 
				'<USAR_AUTORIZACION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USAR_AUTORIZACION) + '</USAR_AUTORIZACION>' + 
				'<IMP1_EN_BONIFICA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@IMP1_EN_BONIFICA) + '</IMP1_EN_BONIFICA>' + 
				'<IMP2_EN_BONIFICA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@IMP2_EN_BONIFICA) + '</IMP2_EN_BONIFICA>' + 
				'<ASIENTO_CONTCXCPOR Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ASIENTO_CONTCXCPOR) + '</ASIENTO_CONTCXCPOR>' + 
				'<USAR_APROB_PEDIDOS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USAR_APROB_PEDIDOS) + '</USAR_APROB_PEDIDOS>' + 
				'<NOM_RUBRO10_CLI Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOM_RUBRO10_CLI) + '</NOM_RUBRO10_CLI>' + 
				'<LISTA_PRECIOS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@LISTA_PRECIOS) + '</LISTA_PRECIOS>' + 
				'<MARGEN_UTILIDAD Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@MARGEN_UTILIDAD) + '</MARGEN_UTILIDAD>' + 
				'<MONTO_MINIMO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@MONTO_MINIMO) + '</MONTO_MINIMO>' + 
				'<DOCS_VENCIDOS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DOCS_VENCIDOS) + '</DOCS_VENCIDOS>' + 
				'<LIMITE_CREDITO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@LIMITE_CREDITO) + '</LIMITE_CREDITO>' + 
				'<COBRO_JUDICIAL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@COBRO_JUDICIAL) + '</COBRO_JUDICIAL>' + 
				'<SIN_OC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@SIN_OC) + '</SIN_OC>' + 
				'<DIAS_ATRASO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DIAS_ATRASO) + '</DIAS_ATRASO>' + 
				'<MONTO_MINIMO_LOCAL Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@MONTO_MINIMO_LOCAL) + '</MONTO_MINIMO_LOCAL>' + 
				'<MONTO_MINIMO_DOLAR Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@MONTO_MINIMO_DOLAR) + '</MONTO_MINIMO_DOLAR>' + 
				'<SALDO_MAX_LOCAL Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@SALDO_MAX_LOCAL) + '</SALDO_MAX_LOCAL>' + 
				'<SALDO_MAX_DOLAR Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@SALDO_MAX_DOLAR) + '</SALDO_MAX_DOLAR>' + 
				'<MAX_DIAS_ATRASO Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@MAX_DIAS_ATRASO) + '</MAX_DIAS_ATRASO>' + 
				'<MAX_DOCS_VENC Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@MAX_DOCS_VENC) + '</MAX_DOCS_VENC>' 
				
			SET @PARAMETROS3 = 
				'<PRECIOS_DEC_DOLAR Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@PRECIOS_DEC_DOLAR) + '</PRECIOS_DEC_DOLAR>' + 
				'<COND_PAGO_NIV_PRE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@COND_PAGO_NIV_PRE) + '</COND_PAGO_NIV_PRE>' + 
				'<FACT_LISTA_PRECIOS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@FACT_LISTA_PRECIOS) + '</FACT_LISTA_PRECIOS>' + 
				'<FACT_MARGEN_UTILID Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@FACT_MARGEN_UTILID) + '</FACT_MARGEN_UTILID>' + 
				'<FACT_MONTO_MINIMO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@FACT_MONTO_MINIMO) + '</FACT_MONTO_MINIMO>' + 
				'<FACT_DIAS_ATRASO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@FACT_DIAS_ATRASO) + '</FACT_DIAS_ATRASO>' + 
				'<FACT_SIN_OC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@FACT_SIN_OC) + '</FACT_SIN_OC>' + 
				'<USAR_RUBROS_VAL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USAR_RUBROS_VAL) + '</USAR_RUBROS_VAL>' + 
				'<IMP_DESC_CLASIFIC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@IMP_DESC_CLASIFIC) + '</IMP_DESC_CLASIFIC>' + 
				'<LIMITAR_MAX_LINEAS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@LIMITAR_MAX_LINEAS) + '</LIMITAR_MAX_LINEAS>' + 
				'<INDICAD_PEDIDO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@INDICAD_PEDIDO) + '</INDICAD_PEDIDO>' + 
				'<PRECIO_COSTO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@PRECIO_COSTO) + '</PRECIO_COSTO>' + 
				'<FACT_MENOR_RESERVA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@FACT_MENOR_RESERVA) + '</FACT_MENOR_RESERVA>' + 
				'<USA_DESPACHOS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USA_DESPACHOS) + '</USA_DESPACHOS>' + 
				'<CTR_INV_DESPACHAR Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_INV_DESPACHAR) + '</CTR_INV_DESPACHAR>' + 
				'<CTA_INV_DESPACHAR Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_INV_DESPACHAR) + '</CTA_INV_DESPACHAR>' + 
				'<ANULA_CXC_APLICADO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ANULA_CXC_APLICADO) + '</ANULA_CXC_APLICADO>' + 
				'<USA_ESQUEMA_CAJAS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USA_ESQUEMA_CAJAS) + '</USA_ESQUEMA_CAJAS>' + 
				'<TIPO_COSTO_NOEXIST Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_COSTO_NOEXIST) + '</TIPO_COSTO_NOEXIST>' + 
				'<CALCULO_IMP2 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CALCULO_IMP2) + '</CALCULO_IMP2>' + 
				'<CATEGORIA_CLIENTE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CATEGORIA_CLIENTE) + '</CATEGORIA_CLIENTE>' + 
				'<NIVEL_PRECIO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NIVEL_PRECIO) + '</NIVEL_PRECIO>' + 
				'<MONEDA_NIVEL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@MONEDA_NIVEL) + '</MONEDA_NIVEL>' + 
				'<DESCUENTO_CASCADA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DESCUENTO_CASCADA) + '</DESCUENTO_CASCADA>' + 
				'<RETENCIONES Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@RETENCIONES) + '</RETENCIONES>' + 
				'<RETENCIONES_FLETES Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@RETENCIONES_FLETES) + '</RETENCIONES_FLETES>' + 
				'<ARTICULO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ARTICULO) + '</ARTICULO>' + 
				'<CODIGO_RETENCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CODIGO_RETENCION) + '</CODIGO_RETENCION>' + 
				'<APLICAR_DESC_GEN Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@APLICAR_DESC_GEN) + '</APLICAR_DESC_GEN>' + 
				'<MODO_DESC_MULT Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@MODO_DESC_MULT) + '</MODO_DESC_MULT>' + 
				'<DCTO_GENERAL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DCTO_GENERAL) + '</DCTO_GENERAL>' + 
				'<FACT_DCTO_GENERAL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@FACT_DCTO_GENERAL) + '</FACT_DCTO_GENERAL>' + 
				'<AUTOR_GRABAR Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@AUTOR_GRABAR) + '</AUTOR_GRABAR>' + 
				'<AUTOR_APROBAR Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@AUTOR_APROBAR) + '</AUTOR_APROBAR>' + 
				'<AUTOR_FACTUREMITIR Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@AUTOR_FACTUREMITIR) + '</AUTOR_FACTUREMITIR>' + 
				'<AUTOR_FACTREMISION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@AUTOR_FACTREMISION) + '</AUTOR_FACTREMISION>' + 
				'<CARGAR_APROBADO_CC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CARGAR_APROBADO_CC) + '</CARGAR_APROBADO_CC>' + 
				'<REMISION_A_IMPRES Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@REMISION_A_IMPRES) + '</REMISION_A_IMPRES>' + 
				'<DEVOLUC_A_IMPRES Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DEVOLUC_A_IMPRES) + '</DEVOLUC_A_IMPRES>' + 
				'<NOM_RUBRO16_CLI Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOM_RUBRO16_CLI) + '</NOM_RUBRO16_CLI>' + 
				'<NOM_RUBRO17_CLI Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOM_RUBRO17_CLI) + '</NOM_RUBRO17_CLI>' + 
				'<NOM_RUBRO18_CLI Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOM_RUBRO18_CLI) + '</NOM_RUBRO18_CLI>' + 
				'<NOM_RUBRO19_CLI Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOM_RUBRO19_CLI) + '</NOM_RUBRO19_CLI>' + 
				'<NOM_RUBRO20_CLI Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOM_RUBRO20_CLI) + '</NOM_RUBRO20_CLI>' + 
				'</GLOBALES_FA>'


			-- Inserta la solicitud correspondiente
			
			EXECUTE  ('ERPADMIN.POS_InsertarSolicitud ''' + @PUBLICADOR + ''', ''GLOBALESFAPOS600'', ''INSERTA'', ''' + @PARAMETROS + @PARAMETROS2 + @PARAMETROS3 + ''', 0, ''''')
			
			FETCH NEXT FROM C_INSERTED INTO
			@LLAVE, @BODEGA_DEFAULT, @COND_PAGO_CONTAD, @VENDEDOR_OBLIGATOR, @FACT_EXC_PEDIDO, @USA_TARJETA_CRED, @BODEGA_POR_LINEA, @PERMITE_BACKORDER, @CANCEL_PED_PARCIAL, @PED_A_IMPRESORA, @DOC_A_IMPRESORA, @IMPRE_LOTE_SEPARAD, @FACTURA_MULTIPAG, @INCR_NUM_FACTURA, @MULTIPLE_FMT_FACTU, @MULTIPLE_FMT_PEDID, @ORDEN_LINEAS_FACT, @REIMPRESION_PEDIDO, @IMP_PEDIDO_AL_FACT, @REDONDEAR_FACTURA, @FACTOR_REDONDEO, @PRECIOS_DEC, @DESC_EN_PRECIO, @IMP1_EN_PRECIO, @IMP1_AFECTA_DESCTO, @APLICA_NI_PR_IMP1, @MONEDA_IMP1, @NIV_PRECIO_IMP1, @PAGO_COM_PARCIAL, @PORC_IMP_COMISION, @ASIENTO_VENTA_POR, @TIPO_ASIENTO, @PAQUETE, @CTR_FLETE, @CTA_FLETE, @CTR_SEGURO, @CTA_SEGURO, @CTR_DOCUMENTACI, @CTA_DOCUMENTACI, @CTR_IMPUESTO1, @CTA_IMPUESTO1, @CTR_IMPUESTO2, @CTA_IMPUESTO2, @CTR_IMP_COMISIO, @CTA_IMP_COMISIO, @USAR_RUBROS, @RUBRO1_NOMBRE, @RUBRO2_NOMBRE, @RUBRO3_NOMBRE, @RUBRO4_NOMBRE, @USA_BOLETAS, @NOM_RUBRO6_CLI, @NOM_RUBRO7_CLI, @NOM_RUBRO8_CLI, @NOM_RUBRO9_CLI, @RUBRO5_NOMBRE, @NIV_PRE_PUBLICO, @MONEDA_PUBLICO, @COLUMNAS_ESTANDAR, @ASIENTO_COSTO_POR, @CAMBIAR_ESQ_TRAB, @FACT_DOCS_VENCIDOS, @FACT_COBRO_JUD, @FACT_LIMITE_CRED, @MOD_APLIC_ASIENTO, @INTEGRACION_CONTA, @TIPO_CONTA_OMISION, @TIPO_CAMBIO, @PRECISION_MAXIMA, @LINEAS_ARTICULO, @LINEAS_FACTURA, @LINEAS_ADICIONALES, @DETALLE_KITS, @MOD_PRECIOS, @PREVISTA1, @PREVISTA2, @PREVISTA3, @PREVISTA4, @PREVISTA5, @CTR_CONSUMO, @CC_EN_LINEA, @CG_EN_LINEA, @USAR_AUTORIZACION, @IMP1_EN_BONIFICA, @IMP2_EN_BONIFICA, @ASIENTO_CONTCXCPOR, @USAR_APROB_PEDIDOS, @NOM_RUBRO10_CLI, @LISTA_PRECIOS, @MARGEN_UTILIDAD, @MONTO_MINIMO, @DOCS_VENCIDOS, @LIMITE_CREDITO, @COBRO_JUDICIAL, @SIN_OC, @DIAS_ATRASO, @MONTO_MINIMO_LOCAL, @MONTO_MINIMO_DOLAR, @SALDO_MAX_LOCAL, @SALDO_MAX_DOLAR, @MAX_DIAS_ATRASO, @MAX_DOCS_VENC, @PRECIOS_DEC_DOLAR, @COND_PAGO_NIV_PRE, @FACT_LISTA_PRECIOS, @FACT_MARGEN_UTILID, @FACT_MONTO_MINIMO, @FACT_DIAS_ATRASO, @FACT_SIN_OC, @USAR_RUBROS_VAL, @IMP_DESC_CLASIFIC, @LIMITAR_MAX_LINEAS, @INDICAD_PEDIDO, @PRECIO_COSTO, @FACT_MENOR_RESERVA, @USA_DESPACHOS, @CTR_INV_DESPACHAR, @CTA_INV_DESPACHAR, @ANULA_CXC_APLICADO, @USA_ESQUEMA_CAJAS, @TIPO_COSTO_NOEXIST, @CALCULO_IMP2, @CATEGORIA_CLIENTE, @NIVEL_PRECIO, @MONEDA_NIVEL, @DESCUENTO_CASCADA, @RETENCIONES, @RETENCIONES_FLETES, @ARTICULO, @CODIGO_RETENCION, @APLICAR_DESC_GEN, @MODO_DESC_MULT, @DCTO_GENERAL, @FACT_DCTO_GENERAL, @AUTOR_GRABAR, @AUTOR_APROBAR, @AUTOR_FACTUREMITIR, @AUTOR_FACTREMISION, @CARGAR_APROBADO_CC, @REMISION_A_IMPRES, @DEVOLUC_A_IMPRES, @NOM_RUBRO16_CLI, @NOM_RUBRO17_CLI, @NOM_RUBRO18_CLI, @NOM_RUBRO19_CLI, @NOM_RUBRO20_CLI
		END

		CLOSE C_INSERTED
    		DEALLOCATE C_INSERTED
	END

	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla GLOBALES_FA.',16,1 )
	END
END;




CREATE TRIGGER $$Compania$$.GLOBALES_FA_POS_DEL
ON $$Compania$$.GLOBALES_FA
FOR DELETE  
AS 
BEGIN   	
	DECLARE @ERROR  int
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @PARAMETROS2 VARCHAR(8000)
	DECLARE @PARAMETROS3 VARCHAR(8000)	
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @LLAVE INT
	DECLARE @BODEGA_DEFAULT VARCHAR(4)
	DECLARE @COND_PAGO_CONTAD VARCHAR(4)
	DECLARE @VENDEDOR_OBLIGATOR VARCHAR(1)
	DECLARE @FACT_EXC_PEDIDO VARCHAR(1)
	DECLARE @USA_TARJETA_CRED VARCHAR(1)
	DECLARE @BODEGA_POR_LINEA VARCHAR(1)
	DECLARE @PERMITE_BACKORDER VARCHAR(1)
	DECLARE @CANCEL_PED_PARCIAL VARCHAR(1)
	DECLARE @PED_A_IMPRESORA VARCHAR(1)
	DECLARE @DOC_A_IMPRESORA VARCHAR(1)
	DECLARE @IMPRE_LOTE_SEPARAD VARCHAR(1)
	DECLARE @FACTURA_MULTIPAG VARCHAR(1)
	DECLARE @INCR_NUM_FACTURA VARCHAR(1)
	DECLARE @MULTIPLE_FMT_FACTU VARCHAR(1)
	DECLARE @MULTIPLE_FMT_PEDID VARCHAR(1)
	DECLARE @ORDEN_LINEAS_FACT VARCHAR(1)
	DECLARE @REIMPRESION_PEDIDO VARCHAR(1)
	DECLARE @IMP_PEDIDO_AL_FACT VARCHAR(1)
	DECLARE @REDONDEAR_FACTURA VARCHAR(1)
	DECLARE @FACTOR_REDONDEO DECIMAL(28,8)
	DECLARE @PRECIOS_DEC INT
	DECLARE @DESC_EN_PRECIO VARCHAR(1)
	DECLARE @IMP1_EN_PRECIO VARCHAR(1)
	DECLARE @IMP1_AFECTA_DESCTO VARCHAR(1)
	DECLARE @APLICA_NI_PR_IMP1 VARCHAR(1)
	DECLARE @MONEDA_IMP1 VARCHAR(1)
	DECLARE @NIV_PRECIO_IMP1 VARCHAR(12)
	DECLARE @PAGO_COM_PARCIAL VARCHAR(1)
	DECLARE @PORC_IMP_COMISION DECIMAL(28,8)
	DECLARE @ASIENTO_VENTA_POR VARCHAR(1)
	DECLARE @TIPO_ASIENTO VARCHAR(4)
	DECLARE @PAQUETE VARCHAR(4)
	DECLARE @CTR_FLETE VARCHAR(25)
	DECLARE @CTA_FLETE VARCHAR(25)
	DECLARE @CTR_SEGURO VARCHAR(25)
	DECLARE @CTA_SEGURO VARCHAR(25)
	DECLARE @CTR_DOCUMENTACI VARCHAR(25)
	DECLARE @CTA_DOCUMENTACI VARCHAR(25)
	DECLARE @CTR_IMPUESTO1 VARCHAR(25)
	DECLARE @CTA_IMPUESTO1 VARCHAR(25)
	DECLARE @CTR_IMPUESTO2 VARCHAR(25)
	DECLARE @CTA_IMPUESTO2 VARCHAR(25)
	DECLARE @CTR_IMP_COMISIO VARCHAR(25)
	DECLARE @CTA_IMP_COMISIO VARCHAR(25)
	DECLARE @USAR_RUBROS VARCHAR(1)
	DECLARE @RUBRO1_NOMBRE VARCHAR(15)
	DECLARE @RUBRO2_NOMBRE VARCHAR(15)
	DECLARE @RUBRO3_NOMBRE VARCHAR(15)
	DECLARE @RUBRO4_NOMBRE VARCHAR(15)
	DECLARE @USA_BOLETAS VARCHAR(1)
	DECLARE @NOM_RUBRO6_CLI VARCHAR(60)
	DECLARE @NOM_RUBRO7_CLI VARCHAR(60)
	DECLARE @NOM_RUBRO8_CLI VARCHAR(60)
	DECLARE @NOM_RUBRO9_CLI VARCHAR(60)
	DECLARE @RUBRO5_NOMBRE VARCHAR(15)
	DECLARE @NIV_PRE_PUBLICO VARCHAR(12)
	DECLARE @MONEDA_PUBLICO VARCHAR(1)
	DECLARE @COLUMNAS_ESTANDAR VARCHAR(4000)
	DECLARE @ASIENTO_COSTO_POR VARCHAR(1)
	DECLARE @CAMBIAR_ESQ_TRAB VARCHAR(1)
	DECLARE @FACT_DOCS_VENCIDOS VARCHAR(1)
	DECLARE @FACT_COBRO_JUD VARCHAR(1)
	DECLARE @FACT_LIMITE_CRED VARCHAR(1)
	DECLARE @MOD_APLIC_ASIENTO INT
	DECLARE @INTEGRACION_CONTA VARCHAR(1)
	DECLARE @TIPO_CONTA_OMISION VARCHAR(1)
	DECLARE @TIPO_CAMBIO VARCHAR(4)
	DECLARE @PRECISION_MAXIMA VARCHAR(1)
	DECLARE @LINEAS_ARTICULO INT
	DECLARE @LINEAS_FACTURA INT
	DECLARE @LINEAS_ADICIONALES INT
	DECLARE @DETALLE_KITS VARCHAR(1)
	DECLARE @MOD_PRECIOS VARCHAR(1)
	DECLARE @PREVISTA1 VARCHAR(1)
	DECLARE @PREVISTA2 VARCHAR(1)
	DECLARE @PREVISTA3 VARCHAR(1)
	DECLARE @PREVISTA4 VARCHAR(1)
	DECLARE @PREVISTA5 VARCHAR(1)
	DECLARE @CTR_CONSUMO VARCHAR(25)
	DECLARE @CC_EN_LINEA VARCHAR(1)
	DECLARE @CG_EN_LINEA VARCHAR(1)
	DECLARE @USAR_AUTORIZACION VARCHAR(1)
	DECLARE @IMP1_EN_BONIFICA VARCHAR(1)
	DECLARE @IMP2_EN_BONIFICA VARCHAR(1)
	DECLARE @ASIENTO_CONTCXCPOR VARCHAR(1)
	DECLARE @USAR_APROB_PEDIDOS VARCHAR(1)
	DECLARE @NOM_RUBRO10_CLI VARCHAR(60)
	DECLARE @LISTA_PRECIOS VARCHAR(1)
	DECLARE @MARGEN_UTILIDAD VARCHAR(1)
	DECLARE @MONTO_MINIMO VARCHAR(1)
	DECLARE @DOCS_VENCIDOS VARCHAR(1)
	DECLARE @LIMITE_CREDITO VARCHAR(1)
	DECLARE @COBRO_JUDICIAL VARCHAR(1)
	DECLARE @SIN_OC VARCHAR(1)
	DECLARE @DIAS_ATRASO VARCHAR(1)
	DECLARE @MONTO_MINIMO_LOCAL DECIMAL(28,8)
	DECLARE @MONTO_MINIMO_DOLAR DECIMAL(28,8)
	DECLARE @SALDO_MAX_LOCAL DECIMAL(28,8)
	DECLARE @SALDO_MAX_DOLAR DECIMAL(28,8)
	DECLARE @MAX_DIAS_ATRASO INT
	DECLARE @MAX_DOCS_VENC INT
	DECLARE @PRECIOS_DEC_DOLAR INT
	DECLARE @COND_PAGO_NIV_PRE VARCHAR(1)
	DECLARE @FACT_LISTA_PRECIOS VARCHAR(1)
	DECLARE @FACT_MARGEN_UTILID VARCHAR(1)
	DECLARE @FACT_MONTO_MINIMO VARCHAR(1)
	DECLARE @FACT_DIAS_ATRASO VARCHAR(1)
	DECLARE @FACT_SIN_OC VARCHAR(1)
	DECLARE @USAR_RUBROS_VAL VARCHAR(1)
	DECLARE @IMP_DESC_CLASIFIC VARCHAR(1)
	DECLARE @LIMITAR_MAX_LINEAS VARCHAR(1)
	DECLARE @INDICAD_PEDIDO VARCHAR(1)
	DECLARE @PRECIO_COSTO VARCHAR(1)
	DECLARE @FACT_MENOR_RESERVA VARCHAR(1)
	DECLARE @USA_DESPACHOS VARCHAR(1)
	DECLARE @CTR_INV_DESPACHAR VARCHAR(25)
	DECLARE @CTA_INV_DESPACHAR VARCHAR(25)
	DECLARE @ANULA_CXC_APLICADO VARCHAR(1)
	DECLARE @USA_ESQUEMA_CAJAS VARCHAR(1)
	DECLARE @TIPO_COSTO_NOEXIST VARCHAR(1)
	DECLARE @CALCULO_IMP2 VARCHAR(1)
	DECLARE @CATEGORIA_CLIENTE VARCHAR(8)
	DECLARE @NIVEL_PRECIO VARCHAR(12)
	DECLARE @MONEDA_NIVEL VARCHAR(1)
	DECLARE @DESCUENTO_CASCADA VARCHAR(1)
	DECLARE @RETENCIONES VARCHAR(1)
	DECLARE @RETENCIONES_FLETES VARCHAR(1)
	DECLARE @ARTICULO VARCHAR(20)
	DECLARE @CODIGO_RETENCION VARCHAR(4)
	DECLARE @APLICAR_DESC_GEN VARCHAR(1)
	DECLARE @MODO_DESC_MULT VARCHAR(1)
	DECLARE @DCTO_GENERAL VARCHAR(1)
	DECLARE @FACT_DCTO_GENERAL VARCHAR(1)
	DECLARE @AUTOR_GRABAR VARCHAR(1)
	DECLARE @AUTOR_APROBAR VARCHAR(1)
	DECLARE @AUTOR_FACTUREMITIR VARCHAR(1)
	DECLARE @AUTOR_FACTREMISION VARCHAR(1)
	DECLARE @CARGAR_APROBADO_CC VARCHAR(1)
	DECLARE @REMISION_A_IMPRES VARCHAR(1)
	DECLARE @DEVOLUC_A_IMPRES VARCHAR(1)
	DECLARE @NOM_RUBRO16_CLI VARCHAR(60)
	DECLARE @NOM_RUBRO17_CLI VARCHAR(60)
	DECLARE @NOM_RUBRO18_CLI VARCHAR(60)
	DECLARE @NOM_RUBRO19_CLI VARCHAR(60)
	DECLARE @NOM_RUBRO20_CLI VARCHAR(60)
	 -- Declaraciones	

	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM 
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_DELETED CURSOR LOCAL FOR
			SELECT LLAVE, BODEGA_DEFAULT, COND_PAGO_CONTAD, VENDEDOR_OBLIGATOR, FACT_EXC_PEDIDO, USA_TARJETA_CRED, BODEGA_POR_LINEA, PERMITE_BACKORDER, CANCEL_PED_PARCIAL, PED_A_IMPRESORA, DOC_A_IMPRESORA, IMPRE_LOTE_SEPARAD, FACTURA_MULTIPAG, INCR_NUM_FACTURA, MULTIPLE_FMT_FACTU, MULTIPLE_FMT_PEDID, ORDEN_LINEAS_FACT, REIMPRESION_PEDIDO, IMP_PEDIDO_AL_FACT, REDONDEAR_FACTURA, FACTOR_REDONDEO, PRECIOS_DEC, DESC_EN_PRECIO, IMP1_EN_PRECIO, IMP1_AFECTA_DESCTO, APLICA_NI_PR_IMP1, MONEDA_IMP1, NIV_PRECIO_IMP1, PAGO_COM_PARCIAL, PORC_IMP_COMISION, ASIENTO_VENTA_POR, TIPO_ASIENTO, PAQUETE, CTR_FLETE, CTA_FLETE, CTR_SEGURO, CTA_SEGURO, CTR_DOCUMENTACI, CTA_DOCUMENTACI, CTR_IMPUESTO1, CTA_IMPUESTO1, CTR_IMPUESTO2, CTA_IMPUESTO2, CTR_IMP_COMISIO, CTA_IMP_COMISIO, USAR_RUBROS, RUBRO1_NOMBRE, RUBRO2_NOMBRE, RUBRO3_NOMBRE, RUBRO4_NOMBRE, USA_BOLETAS, NOM_RUBRO6_CLI, NOM_RUBRO7_CLI, NOM_RUBRO8_CLI, NOM_RUBRO9_CLI, RUBRO5_NOMBRE, NIV_PRE_PUBLICO, MONEDA_PUBLICO, COLUMNAS_ESTANDAR, ASIENTO_COSTO_POR, CAMBIAR_ESQ_TRAB, FACT_DOCS_VENCIDOS, FACT_COBRO_JUD, FACT_LIMITE_CRED, MOD_APLIC_ASIENTO, INTEGRACION_CONTA, TIPO_CONTA_OMISION, TIPO_CAMBIO, PRECISION_MAXIMA, LINEAS_ARTICULO, LINEAS_FACTURA, LINEAS_ADICIONALES, DETALLE_KITS, MOD_PRECIOS, PREVISTA1, PREVISTA2, PREVISTA3, PREVISTA4, PREVISTA5, CTR_CONSUMO, CC_EN_LINEA, CG_EN_LINEA, USAR_AUTORIZACION, IMP1_EN_BONIFICA, IMP2_EN_BONIFICA, ASIENTO_CONTCXCPOR, USAR_APROB_PEDIDOS, NOM_RUBRO10_CLI, LISTA_PRECIOS, MARGEN_UTILIDAD, MONTO_MINIMO, DOCS_VENCIDOS, LIMITE_CREDITO, COBRO_JUDICIAL, SIN_OC, DIAS_ATRASO, MONTO_MINIMO_LOCAL, MONTO_MINIMO_DOLAR, SALDO_MAX_LOCAL, SALDO_MAX_DOLAR, MAX_DIAS_ATRASO, MAX_DOCS_VENC, PRECIOS_DEC_DOLAR, COND_PAGO_NIV_PRE, FACT_LISTA_PRECIOS, FACT_MARGEN_UTILID, FACT_MONTO_MINIMO, FACT_DIAS_ATRASO, FACT_SIN_OC, USAR_RUBROS_VAL, IMP_DESC_CLASIFIC, LIMITAR_MAX_LINEAS, INDICAD_PEDIDO, PRECIO_COSTO, FACT_MENOR_RESERVA, USA_DESPACHOS, CTR_INV_DESPACHAR, CTA_INV_DESPACHAR, ANULA_CXC_APLICADO, USA_ESQUEMA_CAJAS, TIPO_COSTO_NOEXIST, CALCULO_IMP2, CATEGORIA_CLIENTE, NIVEL_PRECIO, MONEDA_NIVEL, DESCUENTO_CASCADA, RETENCIONES, RETENCIONES_FLETES, ARTICULO, CODIGO_RETENCION, APLICAR_DESC_GEN, MODO_DESC_MULT, DCTO_GENERAL, FACT_DCTO_GENERAL, AUTOR_GRABAR, AUTOR_APROBAR, AUTOR_FACTUREMITIR, AUTOR_FACTREMISION, CARGAR_APROBADO_CC, REMISION_A_IMPRES, DEVOLUC_A_IMPRES, NOM_RUBRO16_CLI, NOM_RUBRO17_CLI, NOM_RUBRO18_CLI, NOM_RUBRO19_CLI, NOM_RUBRO20_CLI
			FROM DELETED d

		OPEN C_DELETED
		FETCH NEXT FROM C_DELETED INTO 
		@LLAVE, @BODEGA_DEFAULT, @COND_PAGO_CONTAD, @VENDEDOR_OBLIGATOR, @FACT_EXC_PEDIDO, @USA_TARJETA_CRED, @BODEGA_POR_LINEA, @PERMITE_BACKORDER, @CANCEL_PED_PARCIAL, @PED_A_IMPRESORA, @DOC_A_IMPRESORA, @IMPRE_LOTE_SEPARAD, @FACTURA_MULTIPAG, @INCR_NUM_FACTURA, @MULTIPLE_FMT_FACTU, @MULTIPLE_FMT_PEDID, @ORDEN_LINEAS_FACT, @REIMPRESION_PEDIDO, @IMP_PEDIDO_AL_FACT, @REDONDEAR_FACTURA, @FACTOR_REDONDEO, @PRECIOS_DEC, @DESC_EN_PRECIO, @IMP1_EN_PRECIO, @IMP1_AFECTA_DESCTO, @APLICA_NI_PR_IMP1, @MONEDA_IMP1, @NIV_PRECIO_IMP1, @PAGO_COM_PARCIAL, @PORC_IMP_COMISION, @ASIENTO_VENTA_POR, @TIPO_ASIENTO, @PAQUETE, @CTR_FLETE, @CTA_FLETE, @CTR_SEGURO, @CTA_SEGURO, @CTR_DOCUMENTACI, @CTA_DOCUMENTACI, @CTR_IMPUESTO1, @CTA_IMPUESTO1, @CTR_IMPUESTO2, @CTA_IMPUESTO2, @CTR_IMP_COMISIO, @CTA_IMP_COMISIO, @USAR_RUBROS, @RUBRO1_NOMBRE, @RUBRO2_NOMBRE, @RUBRO3_NOMBRE, @RUBRO4_NOMBRE, @USA_BOLETAS, @NOM_RUBRO6_CLI, @NOM_RUBRO7_CLI, @NOM_RUBRO8_CLI, @NOM_RUBRO9_CLI, @RUBRO5_NOMBRE, @NIV_PRE_PUBLICO, @MONEDA_PUBLICO, @COLUMNAS_ESTANDAR, @ASIENTO_COSTO_POR, @CAMBIAR_ESQ_TRAB, @FACT_DOCS_VENCIDOS, @FACT_COBRO_JUD, @FACT_LIMITE_CRED, @MOD_APLIC_ASIENTO, @INTEGRACION_CONTA, @TIPO_CONTA_OMISION, @TIPO_CAMBIO, @PRECISION_MAXIMA, @LINEAS_ARTICULO, @LINEAS_FACTURA, @LINEAS_ADICIONALES, @DETALLE_KITS, @MOD_PRECIOS, @PREVISTA1, @PREVISTA2, @PREVISTA3, @PREVISTA4, @PREVISTA5, @CTR_CONSUMO, @CC_EN_LINEA, @CG_EN_LINEA, @USAR_AUTORIZACION, @IMP1_EN_BONIFICA, @IMP2_EN_BONIFICA, @ASIENTO_CONTCXCPOR, @USAR_APROB_PEDIDOS, @NOM_RUBRO10_CLI, @LISTA_PRECIOS, @MARGEN_UTILIDAD, @MONTO_MINIMO, @DOCS_VENCIDOS, @LIMITE_CREDITO, @COBRO_JUDICIAL, @SIN_OC, @DIAS_ATRASO, @MONTO_MINIMO_LOCAL, @MONTO_MINIMO_DOLAR, @SALDO_MAX_LOCAL, @SALDO_MAX_DOLAR, @MAX_DIAS_ATRASO, @MAX_DOCS_VENC, @PRECIOS_DEC_DOLAR, @COND_PAGO_NIV_PRE, @FACT_LISTA_PRECIOS, @FACT_MARGEN_UTILID, @FACT_MONTO_MINIMO, @FACT_DIAS_ATRASO, @FACT_SIN_OC, @USAR_RUBROS_VAL, @IMP_DESC_CLASIFIC, @LIMITAR_MAX_LINEAS, @INDICAD_PEDIDO, @PRECIO_COSTO, @FACT_MENOR_RESERVA, @USA_DESPACHOS, @CTR_INV_DESPACHAR, @CTA_INV_DESPACHAR, @ANULA_CXC_APLICADO, @USA_ESQUEMA_CAJAS, @TIPO_COSTO_NOEXIST, @CALCULO_IMP2, @CATEGORIA_CLIENTE, @NIVEL_PRECIO, @MONEDA_NIVEL, @DESCUENTO_CASCADA, @RETENCIONES, @RETENCIONES_FLETES, @ARTICULO, @CODIGO_RETENCION, @APLICAR_DESC_GEN, @MODO_DESC_MULT, @DCTO_GENERAL, @FACT_DCTO_GENERAL, @AUTOR_GRABAR, @AUTOR_APROBAR, @AUTOR_FACTUREMITIR, @AUTOR_FACTREMISION, @CARGAR_APROBADO_CC, @REMISION_A_IMPRES, @DEVOLUC_A_IMPRES, @NOM_RUBRO16_CLI, @NOM_RUBRO17_CLI, @NOM_RUBRO18_CLI, @NOM_RUBRO19_CLI, @NOM_RUBRO20_CLI-- VARIABLES
		
		SET @ERROR = 0
		
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS = 
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<GLOBALES_FA>' + 
				'<LLAVE Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@LLAVE) + '</LLAVE>' + 
				'<BODEGA_DEFAULT Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@BODEGA_DEFAULT) + '</BODEGA_DEFAULT>' + 
				'<COND_PAGO_CONTAD Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@COND_PAGO_CONTAD) + '</COND_PAGO_CONTAD>' + 
				'<VENDEDOR_OBLIGATOR Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@VENDEDOR_OBLIGATOR) + '</VENDEDOR_OBLIGATOR>' + 
				'<FACT_EXC_PEDIDO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@FACT_EXC_PEDIDO) + '</FACT_EXC_PEDIDO>' + 
				'<USA_TARJETA_CRED Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USA_TARJETA_CRED) + '</USA_TARJETA_CRED>' + 
				'<BODEGA_POR_LINEA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@BODEGA_POR_LINEA) + '</BODEGA_POR_LINEA>' + 
				'<PERMITE_BACKORDER Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@PERMITE_BACKORDER) + '</PERMITE_BACKORDER>' + 
				'<CANCEL_PED_PARCIAL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CANCEL_PED_PARCIAL) + '</CANCEL_PED_PARCIAL>' + 
				'<PED_A_IMPRESORA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@PED_A_IMPRESORA) + '</PED_A_IMPRESORA>' + 
				'<DOC_A_IMPRESORA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DOC_A_IMPRESORA) + '</DOC_A_IMPRESORA>' + 
				'<IMPRE_LOTE_SEPARAD Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@IMPRE_LOTE_SEPARAD) + '</IMPRE_LOTE_SEPARAD>' + 
				'<FACTURA_MULTIPAG Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@FACTURA_MULTIPAG) + '</FACTURA_MULTIPAG>' + 
				'<INCR_NUM_FACTURA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@INCR_NUM_FACTURA) + '</INCR_NUM_FACTURA>' + 
				'<MULTIPLE_FMT_FACTU Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@MULTIPLE_FMT_FACTU) + '</MULTIPLE_FMT_FACTU>' + 
				'<MULTIPLE_FMT_PEDID Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@MULTIPLE_FMT_PEDID) + '</MULTIPLE_FMT_PEDID>' + 
				'<ORDEN_LINEAS_FACT Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ORDEN_LINEAS_FACT) + '</ORDEN_LINEAS_FACT>' + 
				'<REIMPRESION_PEDIDO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@REIMPRESION_PEDIDO) + '</REIMPRESION_PEDIDO>' + 
				'<IMP_PEDIDO_AL_FACT Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@IMP_PEDIDO_AL_FACT) + '</IMP_PEDIDO_AL_FACT>' + 
				'<REDONDEAR_FACTURA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@REDONDEAR_FACTURA) + '</REDONDEAR_FACTURA>' + 
				'<FACTOR_REDONDEO Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@FACTOR_REDONDEO) + '</FACTOR_REDONDEO>' + 
				'<PRECIOS_DEC Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@PRECIOS_DEC) + '</PRECIOS_DEC>' + 
				'<DESC_EN_PRECIO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DESC_EN_PRECIO) + '</DESC_EN_PRECIO>' + 
				'<IMP1_EN_PRECIO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@IMP1_EN_PRECIO) + '</IMP1_EN_PRECIO>' + 
				'<IMP1_AFECTA_DESCTO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@IMP1_AFECTA_DESCTO) + '</IMP1_AFECTA_DESCTO>' + 
				'<APLICA_NI_PR_IMP1 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@APLICA_NI_PR_IMP1) + '</APLICA_NI_PR_IMP1>' + 
				'<MONEDA_IMP1 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@MONEDA_IMP1) + '</MONEDA_IMP1>' + 
				'<NIV_PRECIO_IMP1 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NIV_PRECIO_IMP1) + '</NIV_PRECIO_IMP1>' + 
				'<PAGO_COM_PARCIAL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@PAGO_COM_PARCIAL) + '</PAGO_COM_PARCIAL>' + 
				'<PORC_IMP_COMISION Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@PORC_IMP_COMISION) + '</PORC_IMP_COMISION>' + 
				'<ASIENTO_VENTA_POR Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ASIENTO_VENTA_POR) + '</ASIENTO_VENTA_POR>' + 
				'<TIPO_ASIENTO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_ASIENTO) + '</TIPO_ASIENTO>' + 
				'<PAQUETE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@PAQUETE) + '</PAQUETE>' + 
				'<CTR_FLETE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_FLETE) + '</CTR_FLETE>' + 
				'<CTA_FLETE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_FLETE) + '</CTA_FLETE>' + 
				'<CTR_SEGURO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_SEGURO) + '</CTR_SEGURO>' + 
				'<CTA_SEGURO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_SEGURO) + '</CTA_SEGURO>' + 
				'<CTR_DOCUMENTACI Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_DOCUMENTACI) + '</CTR_DOCUMENTACI>' + 
				'<CTA_DOCUMENTACI Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_DOCUMENTACI) + '</CTA_DOCUMENTACI>' + 
				'<CTR_IMPUESTO1 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_IMPUESTO1) + '</CTR_IMPUESTO1>' + 
				'<CTA_IMPUESTO1 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_IMPUESTO1) + '</CTA_IMPUESTO1>' + 
				'<CTR_IMPUESTO2 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_IMPUESTO2) + '</CTR_IMPUESTO2>' + 
				'<CTA_IMPUESTO2 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_IMPUESTO2) + '</CTA_IMPUESTO2>' + 
				'<CTR_IMP_COMISIO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_IMP_COMISIO) + '</CTR_IMP_COMISIO>' + 
				'<CTA_IMP_COMISIO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_IMP_COMISIO) + '</CTA_IMP_COMISIO>' + 
				'<USAR_RUBROS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USAR_RUBROS) + '</USAR_RUBROS>' + 
				'<RUBRO1_NOMBRE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@RUBRO1_NOMBRE) + '</RUBRO1_NOMBRE>' + 
				'<RUBRO2_NOMBRE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@RUBRO2_NOMBRE) + '</RUBRO2_NOMBRE>'
				
			SET @PARAMETROS2 = 				
				'<RUBRO3_NOMBRE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@RUBRO3_NOMBRE) + '</RUBRO3_NOMBRE>' + 
				'<RUBRO4_NOMBRE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@RUBRO4_NOMBRE) + '</RUBRO4_NOMBRE>' + 
				'<USA_BOLETAS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USA_BOLETAS) + '</USA_BOLETAS>' + 
				'<NOM_RUBRO6_CLI Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOM_RUBRO6_CLI) + '</NOM_RUBRO6_CLI>' + 
				'<NOM_RUBRO7_CLI Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOM_RUBRO7_CLI) + '</NOM_RUBRO7_CLI>' + 
				'<NOM_RUBRO8_CLI Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOM_RUBRO8_CLI) + '</NOM_RUBRO8_CLI>' + 
				'<NOM_RUBRO9_CLI Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOM_RUBRO9_CLI) + '</NOM_RUBRO9_CLI>' + 
				'<RUBRO5_NOMBRE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@RUBRO5_NOMBRE) + '</RUBRO5_NOMBRE>' + 
				'<NIV_PRE_PUBLICO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NIV_PRE_PUBLICO) + '</NIV_PRE_PUBLICO>' + 
				'<MONEDA_PUBLICO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@MONEDA_PUBLICO) + '</MONEDA_PUBLICO>' + 
				'<COLUMNAS_ESTANDAR Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@COLUMNAS_ESTANDAR) + '</COLUMNAS_ESTANDAR>' + 
				'<ASIENTO_COSTO_POR Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ASIENTO_COSTO_POR) + '</ASIENTO_COSTO_POR>' + 
				'<CAMBIAR_ESQ_TRAB Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CAMBIAR_ESQ_TRAB) + '</CAMBIAR_ESQ_TRAB>' + 
				'<FACT_DOCS_VENCIDOS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@FACT_DOCS_VENCIDOS) + '</FACT_DOCS_VENCIDOS>' + 
				'<FACT_COBRO_JUD Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@FACT_COBRO_JUD) + '</FACT_COBRO_JUD>' + 
				'<FACT_LIMITE_CRED Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@FACT_LIMITE_CRED) + '</FACT_LIMITE_CRED>' + 
				'<MOD_APLIC_ASIENTO Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@MOD_APLIC_ASIENTO) + '</MOD_APLIC_ASIENTO>' + 
				'<INTEGRACION_CONTA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@INTEGRACION_CONTA) + '</INTEGRACION_CONTA>' + 
				'<TIPO_CONTA_OMISION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_CONTA_OMISION) + '</TIPO_CONTA_OMISION>' + 
				'<TIPO_CAMBIO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_CAMBIO) + '</TIPO_CAMBIO>' + 
				'<PRECISION_MAXIMA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@PRECISION_MAXIMA) + '</PRECISION_MAXIMA>' + 
				'<LINEAS_ARTICULO Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@LINEAS_ARTICULO) + '</LINEAS_ARTICULO>' + 
				'<LINEAS_FACTURA Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@LINEAS_FACTURA) + '</LINEAS_FACTURA>' + 
				'<LINEAS_ADICIONALES Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@LINEAS_ADICIONALES) + '</LINEAS_ADICIONALES>' + 
				'<DETALLE_KITS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DETALLE_KITS) + '</DETALLE_KITS>' + 
				'<MOD_PRECIOS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@MOD_PRECIOS) + '</MOD_PRECIOS>' + 
				'<PREVISTA1 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@PREVISTA1) + '</PREVISTA1>' + 
				'<PREVISTA2 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@PREVISTA2) + '</PREVISTA2>' + 
				'<PREVISTA3 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@PREVISTA3) + '</PREVISTA3>' + 
				'<PREVISTA4 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@PREVISTA4) + '</PREVISTA4>' + 
				'<PREVISTA5 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@PREVISTA5) + '</PREVISTA5>' + 
				'<CTR_CONSUMO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_CONSUMO) + '</CTR_CONSUMO>' + 
				'<CC_EN_LINEA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CC_EN_LINEA) + '</CC_EN_LINEA>' + 
				'<CG_EN_LINEA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CG_EN_LINEA) + '</CG_EN_LINEA>' + 
				'<USAR_AUTORIZACION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USAR_AUTORIZACION) + '</USAR_AUTORIZACION>' + 
				'<IMP1_EN_BONIFICA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@IMP1_EN_BONIFICA) + '</IMP1_EN_BONIFICA>' + 
				'<IMP2_EN_BONIFICA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@IMP2_EN_BONIFICA) + '</IMP2_EN_BONIFICA>' + 
				'<ASIENTO_CONTCXCPOR Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ASIENTO_CONTCXCPOR) + '</ASIENTO_CONTCXCPOR>' + 
				'<USAR_APROB_PEDIDOS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USAR_APROB_PEDIDOS) + '</USAR_APROB_PEDIDOS>' + 
				'<NOM_RUBRO10_CLI Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOM_RUBRO10_CLI) + '</NOM_RUBRO10_CLI>' + 
				'<LISTA_PRECIOS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@LISTA_PRECIOS) + '</LISTA_PRECIOS>' + 
				'<MARGEN_UTILIDAD Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@MARGEN_UTILIDAD) + '</MARGEN_UTILIDAD>' + 
				'<MONTO_MINIMO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@MONTO_MINIMO) + '</MONTO_MINIMO>' + 
				'<DOCS_VENCIDOS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DOCS_VENCIDOS) + '</DOCS_VENCIDOS>' + 
				'<LIMITE_CREDITO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@LIMITE_CREDITO) + '</LIMITE_CREDITO>' + 
				'<COBRO_JUDICIAL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@COBRO_JUDICIAL) + '</COBRO_JUDICIAL>' + 
				'<SIN_OC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@SIN_OC) + '</SIN_OC>' + 
				'<DIAS_ATRASO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DIAS_ATRASO) + '</DIAS_ATRASO>' + 
				'<MONTO_MINIMO_LOCAL Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@MONTO_MINIMO_LOCAL) + '</MONTO_MINIMO_LOCAL>' + 
				'<MONTO_MINIMO_DOLAR Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@MONTO_MINIMO_DOLAR) + '</MONTO_MINIMO_DOLAR>' + 
				'<SALDO_MAX_LOCAL Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@SALDO_MAX_LOCAL) + '</SALDO_MAX_LOCAL>' + 
				'<SALDO_MAX_DOLAR Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@SALDO_MAX_DOLAR) + '</SALDO_MAX_DOLAR>' + 
				'<MAX_DIAS_ATRASO Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@MAX_DIAS_ATRASO) + '</MAX_DIAS_ATRASO>' + 
				'<MAX_DOCS_VENC Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@MAX_DOCS_VENC) + '</MAX_DOCS_VENC>' 
				
			SET @PARAMETROS3 = 
				'<PRECIOS_DEC_DOLAR Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@PRECIOS_DEC_DOLAR) + '</PRECIOS_DEC_DOLAR>' + 
				'<COND_PAGO_NIV_PRE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@COND_PAGO_NIV_PRE) + '</COND_PAGO_NIV_PRE>' + 
				'<FACT_LISTA_PRECIOS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@FACT_LISTA_PRECIOS) + '</FACT_LISTA_PRECIOS>' + 
				'<FACT_MARGEN_UTILID Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@FACT_MARGEN_UTILID) + '</FACT_MARGEN_UTILID>' + 
				'<FACT_MONTO_MINIMO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@FACT_MONTO_MINIMO) + '</FACT_MONTO_MINIMO>' + 
				'<FACT_DIAS_ATRASO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@FACT_DIAS_ATRASO) + '</FACT_DIAS_ATRASO>' + 
				'<FACT_SIN_OC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@FACT_SIN_OC) + '</FACT_SIN_OC>' + 
				'<USAR_RUBROS_VAL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USAR_RUBROS_VAL) + '</USAR_RUBROS_VAL>' + 
				'<IMP_DESC_CLASIFIC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@IMP_DESC_CLASIFIC) + '</IMP_DESC_CLASIFIC>' + 
				'<LIMITAR_MAX_LINEAS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@LIMITAR_MAX_LINEAS) + '</LIMITAR_MAX_LINEAS>' + 
				'<INDICAD_PEDIDO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@INDICAD_PEDIDO) + '</INDICAD_PEDIDO>' + 
				'<PRECIO_COSTO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@PRECIO_COSTO) + '</PRECIO_COSTO>' + 
				'<FACT_MENOR_RESERVA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@FACT_MENOR_RESERVA) + '</FACT_MENOR_RESERVA>' + 
				'<USA_DESPACHOS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USA_DESPACHOS) + '</USA_DESPACHOS>' + 
				'<CTR_INV_DESPACHAR Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_INV_DESPACHAR) + '</CTR_INV_DESPACHAR>' + 
				'<CTA_INV_DESPACHAR Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_INV_DESPACHAR) + '</CTA_INV_DESPACHAR>' + 
				'<ANULA_CXC_APLICADO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ANULA_CXC_APLICADO) + '</ANULA_CXC_APLICADO>' + 
				'<USA_ESQUEMA_CAJAS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USA_ESQUEMA_CAJAS) + '</USA_ESQUEMA_CAJAS>' + 
				'<TIPO_COSTO_NOEXIST Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_COSTO_NOEXIST) + '</TIPO_COSTO_NOEXIST>' + 
				'<CALCULO_IMP2 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CALCULO_IMP2) + '</CALCULO_IMP2>' + 
				'<CATEGORIA_CLIENTE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CATEGORIA_CLIENTE) + '</CATEGORIA_CLIENTE>' + 
				'<NIVEL_PRECIO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NIVEL_PRECIO) + '</NIVEL_PRECIO>' + 
				'<MONEDA_NIVEL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@MONEDA_NIVEL) + '</MONEDA_NIVEL>' + 
				'<DESCUENTO_CASCADA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DESCUENTO_CASCADA) + '</DESCUENTO_CASCADA>' + 
				'<RETENCIONES Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@RETENCIONES) + '</RETENCIONES>' + 
				'<RETENCIONES_FLETES Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@RETENCIONES_FLETES) + '</RETENCIONES_FLETES>' + 
				'<ARTICULO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ARTICULO) + '</ARTICULO>' + 
				'<CODIGO_RETENCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CODIGO_RETENCION) + '</CODIGO_RETENCION>' + 
				'<APLICAR_DESC_GEN Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@APLICAR_DESC_GEN) + '</APLICAR_DESC_GEN>' + 
				'<MODO_DESC_MULT Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@MODO_DESC_MULT) + '</MODO_DESC_MULT>' + 
				'<DCTO_GENERAL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DCTO_GENERAL) + '</DCTO_GENERAL>' + 
				'<FACT_DCTO_GENERAL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@FACT_DCTO_GENERAL) + '</FACT_DCTO_GENERAL>' + 
				'<AUTOR_GRABAR Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@AUTOR_GRABAR) + '</AUTOR_GRABAR>' + 
				'<AUTOR_APROBAR Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@AUTOR_APROBAR) + '</AUTOR_APROBAR>' + 
				'<AUTOR_FACTUREMITIR Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@AUTOR_FACTUREMITIR) + '</AUTOR_FACTUREMITIR>' + 
				'<AUTOR_FACTREMISION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@AUTOR_FACTREMISION) + '</AUTOR_FACTREMISION>' + 
				'<CARGAR_APROBADO_CC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CARGAR_APROBADO_CC) + '</CARGAR_APROBADO_CC>' + 
				'<REMISION_A_IMPRES Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@REMISION_A_IMPRES) + '</REMISION_A_IMPRES>' + 
				'<DEVOLUC_A_IMPRES Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DEVOLUC_A_IMPRES) + '</DEVOLUC_A_IMPRES>' + 
				'<NOM_RUBRO16_CLI Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOM_RUBRO16_CLI) + '</NOM_RUBRO16_CLI>' + 
				'<NOM_RUBRO17_CLI Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOM_RUBRO17_CLI) + '</NOM_RUBRO17_CLI>' + 
				'<NOM_RUBRO18_CLI Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOM_RUBRO18_CLI) + '</NOM_RUBRO18_CLI>' + 
				'<NOM_RUBRO19_CLI Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOM_RUBRO19_CLI) + '</NOM_RUBRO19_CLI>' + 
				'<NOM_RUBRO20_CLI Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOM_RUBRO20_CLI) + '</NOM_RUBRO20_CLI>' + 
				'</GLOBALES_FA>'
 
			
			-- inserta la solicitud correspondiente
			EXECUTE  ('ERPADMIN.POS_InsertarSolicitud ''' + @PUBLICADOR + ''', ''GLOBALESFAPOS600'', ''ELIMINA'', ''' + @PARAMETROS + @PARAMETROS2 + @PARAMETROS3 + ''', 0, ''''')
			
			FETCH NEXT FROM C_DELETED INTO 
			@LLAVE, @BODEGA_DEFAULT, @COND_PAGO_CONTAD, @VENDEDOR_OBLIGATOR, @FACT_EXC_PEDIDO, @USA_TARJETA_CRED, @BODEGA_POR_LINEA, @PERMITE_BACKORDER, @CANCEL_PED_PARCIAL, @PED_A_IMPRESORA, @DOC_A_IMPRESORA, @IMPRE_LOTE_SEPARAD, @FACTURA_MULTIPAG, @INCR_NUM_FACTURA, @MULTIPLE_FMT_FACTU, @MULTIPLE_FMT_PEDID, @ORDEN_LINEAS_FACT, @REIMPRESION_PEDIDO, @IMP_PEDIDO_AL_FACT, @REDONDEAR_FACTURA, @FACTOR_REDONDEO, @PRECIOS_DEC, @DESC_EN_PRECIO, @IMP1_EN_PRECIO, @IMP1_AFECTA_DESCTO, @APLICA_NI_PR_IMP1, @MONEDA_IMP1, @NIV_PRECIO_IMP1, @PAGO_COM_PARCIAL, @PORC_IMP_COMISION, @ASIENTO_VENTA_POR, @TIPO_ASIENTO, @PAQUETE, @CTR_FLETE, @CTA_FLETE, @CTR_SEGURO, @CTA_SEGURO, @CTR_DOCUMENTACI, @CTA_DOCUMENTACI, @CTR_IMPUESTO1, @CTA_IMPUESTO1, @CTR_IMPUESTO2, @CTA_IMPUESTO2, @CTR_IMP_COMISIO, @CTA_IMP_COMISIO, @USAR_RUBROS, @RUBRO1_NOMBRE, @RUBRO2_NOMBRE, @RUBRO3_NOMBRE, @RUBRO4_NOMBRE, @USA_BOLETAS, @NOM_RUBRO6_CLI, @NOM_RUBRO7_CLI, @NOM_RUBRO8_CLI, @NOM_RUBRO9_CLI, @RUBRO5_NOMBRE, @NIV_PRE_PUBLICO, @MONEDA_PUBLICO, @COLUMNAS_ESTANDAR, @ASIENTO_COSTO_POR, @CAMBIAR_ESQ_TRAB, @FACT_DOCS_VENCIDOS, @FACT_COBRO_JUD, @FACT_LIMITE_CRED, @MOD_APLIC_ASIENTO, @INTEGRACION_CONTA, @TIPO_CONTA_OMISION, @TIPO_CAMBIO, @PRECISION_MAXIMA, @LINEAS_ARTICULO, @LINEAS_FACTURA, @LINEAS_ADICIONALES, @DETALLE_KITS, @MOD_PRECIOS, @PREVISTA1, @PREVISTA2, @PREVISTA3, @PREVISTA4, @PREVISTA5, @CTR_CONSUMO, @CC_EN_LINEA, @CG_EN_LINEA, @USAR_AUTORIZACION, @IMP1_EN_BONIFICA, @IMP2_EN_BONIFICA, @ASIENTO_CONTCXCPOR, @USAR_APROB_PEDIDOS, @NOM_RUBRO10_CLI, @LISTA_PRECIOS, @MARGEN_UTILIDAD, @MONTO_MINIMO, @DOCS_VENCIDOS, @LIMITE_CREDITO, @COBRO_JUDICIAL, @SIN_OC, @DIAS_ATRASO, @MONTO_MINIMO_LOCAL, @MONTO_MINIMO_DOLAR, @SALDO_MAX_LOCAL, @SALDO_MAX_DOLAR, @MAX_DIAS_ATRASO, @MAX_DOCS_VENC, @PRECIOS_DEC_DOLAR, @COND_PAGO_NIV_PRE, @FACT_LISTA_PRECIOS, @FACT_MARGEN_UTILID, @FACT_MONTO_MINIMO, @FACT_DIAS_ATRASO, @FACT_SIN_OC, @USAR_RUBROS_VAL, @IMP_DESC_CLASIFIC, @LIMITAR_MAX_LINEAS, @INDICAD_PEDIDO, @PRECIO_COSTO, @FACT_MENOR_RESERVA, @USA_DESPACHOS, @CTR_INV_DESPACHAR, @CTA_INV_DESPACHAR, @ANULA_CXC_APLICADO, @USA_ESQUEMA_CAJAS, @TIPO_COSTO_NOEXIST, @CALCULO_IMP2, @CATEGORIA_CLIENTE, @NIVEL_PRECIO, @MONEDA_NIVEL, @DESCUENTO_CASCADA, @RETENCIONES, @RETENCIONES_FLETES, @ARTICULO, @CODIGO_RETENCION, @APLICAR_DESC_GEN, @MODO_DESC_MULT, @DCTO_GENERAL, @FACT_DCTO_GENERAL, @AUTOR_GRABAR, @AUTOR_APROBAR, @AUTOR_FACTUREMITIR, @AUTOR_FACTREMISION, @CARGAR_APROBADO_CC, @REMISION_A_IMPRES, @DEVOLUC_A_IMPRES, @NOM_RUBRO16_CLI, @NOM_RUBRO17_CLI, @NOM_RUBRO18_CLI, @NOM_RUBRO19_CLI, @NOM_RUBRO20_CLI -- VARIABLES
		END

		CLOSE C_DELETED
		DEALLOCATE C_DELETED
	END
	
	IF (@@ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para eliminar de la tabla GLOBALES_FA.',16,1 )
	END
END;



CREATE TRIGGER $$Compania$$.GLOBALES_FA_POS_MOD
ON $$Compania$$.GLOBALES_FA
FOR UPDATE
AS 
BEGIN   	
	DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @PARAMETROS2 VARCHAR(8000)
	DECLARE @PARAMETROS3 VARCHAR(8000)	
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @COL_ROWPOINTER VARCHAR(36)
	DECLARE @HAY_CAMPOS_PARA_POS BIT
	DECLARE @ACTUALIZAR_SOLICITUD BIT
	DECLARE @LLAVE INT
	DECLARE @BODEGA_DEFAULT VARCHAR(4)
	DECLARE @COND_PAGO_CONTAD VARCHAR(4)
	DECLARE @VENDEDOR_OBLIGATOR VARCHAR(1)
	DECLARE @FACT_EXC_PEDIDO VARCHAR(1)
	DECLARE @USA_TARJETA_CRED VARCHAR(1)
	DECLARE @BODEGA_POR_LINEA VARCHAR(1)
	DECLARE @PERMITE_BACKORDER VARCHAR(1)
	DECLARE @CANCEL_PED_PARCIAL VARCHAR(1)
	DECLARE @PED_A_IMPRESORA VARCHAR(1)
	DECLARE @DOC_A_IMPRESORA VARCHAR(1)
	DECLARE @IMPRE_LOTE_SEPARAD VARCHAR(1)
	DECLARE @FACTURA_MULTIPAG VARCHAR(1)
	DECLARE @INCR_NUM_FACTURA VARCHAR(1)
	DECLARE @MULTIPLE_FMT_FACTU VARCHAR(1)
	DECLARE @MULTIPLE_FMT_PEDID VARCHAR(1)
	DECLARE @ORDEN_LINEAS_FACT VARCHAR(1)
	DECLARE @REIMPRESION_PEDIDO VARCHAR(1)
	DECLARE @IMP_PEDIDO_AL_FACT VARCHAR(1)
	DECLARE @REDONDEAR_FACTURA VARCHAR(1)
	DECLARE @FACTOR_REDONDEO DECIMAL(28,8)
	DECLARE @PRECIOS_DEC INT
	DECLARE @DESC_EN_PRECIO VARCHAR(1)
	DECLARE @IMP1_EN_PRECIO VARCHAR(1)
	DECLARE @IMP1_AFECTA_DESCTO VARCHAR(1)
	DECLARE @APLICA_NI_PR_IMP1 VARCHAR(1)
	DECLARE @MONEDA_IMP1 VARCHAR(1)
	DECLARE @NIV_PRECIO_IMP1 VARCHAR(12)
	DECLARE @PAGO_COM_PARCIAL VARCHAR(1)
	DECLARE @PORC_IMP_COMISION DECIMAL(28,8)
	DECLARE @ASIENTO_VENTA_POR VARCHAR(1)
	DECLARE @TIPO_ASIENTO VARCHAR(4)
	DECLARE @PAQUETE VARCHAR(4)
	DECLARE @CTR_FLETE VARCHAR(25)
	DECLARE @CTA_FLETE VARCHAR(25)
	DECLARE @CTR_SEGURO VARCHAR(25)
	DECLARE @CTA_SEGURO VARCHAR(25)
	DECLARE @CTR_DOCUMENTACI VARCHAR(25)
	DECLARE @CTA_DOCUMENTACI VARCHAR(25)
	DECLARE @CTR_IMPUESTO1 VARCHAR(25)
	DECLARE @CTA_IMPUESTO1 VARCHAR(25)
	DECLARE @CTR_IMPUESTO2 VARCHAR(25)
	DECLARE @CTA_IMPUESTO2 VARCHAR(25)
	DECLARE @CTR_IMP_COMISIO VARCHAR(25)
	DECLARE @CTA_IMP_COMISIO VARCHAR(25)
	DECLARE @USAR_RUBROS VARCHAR(1)
	DECLARE @RUBRO1_NOMBRE VARCHAR(15)
	DECLARE @RUBRO2_NOMBRE VARCHAR(15)
	DECLARE @RUBRO3_NOMBRE VARCHAR(15)
	DECLARE @RUBRO4_NOMBRE VARCHAR(15)
	DECLARE @USA_BOLETAS VARCHAR(1)
	DECLARE @NOM_RUBRO6_CLI VARCHAR(60)
	DECLARE @NOM_RUBRO7_CLI VARCHAR(60)
	DECLARE @NOM_RUBRO8_CLI VARCHAR(60)
	DECLARE @NOM_RUBRO9_CLI VARCHAR(60)
	DECLARE @RUBRO5_NOMBRE VARCHAR(15)
	DECLARE @NIV_PRE_PUBLICO VARCHAR(12)
	DECLARE @MONEDA_PUBLICO VARCHAR(1)
	DECLARE @COLUMNAS_ESTANDAR VARCHAR(4000)
	DECLARE @ASIENTO_COSTO_POR VARCHAR(1)
	DECLARE @CAMBIAR_ESQ_TRAB VARCHAR(1)
	DECLARE @FACT_DOCS_VENCIDOS VARCHAR(1)
	DECLARE @FACT_COBRO_JUD VARCHAR(1)
	DECLARE @FACT_LIMITE_CRED VARCHAR(1)
	DECLARE @MOD_APLIC_ASIENTO INT
	DECLARE @INTEGRACION_CONTA VARCHAR(1)
	DECLARE @TIPO_CONTA_OMISION VARCHAR(1)
	DECLARE @TIPO_CAMBIO VARCHAR(4)
	DECLARE @PRECISION_MAXIMA VARCHAR(1)
	DECLARE @LINEAS_ARTICULO INT
	DECLARE @LINEAS_FACTURA INT
	DECLARE @LINEAS_ADICIONALES INT
	DECLARE @DETALLE_KITS VARCHAR(1)
	DECLARE @MOD_PRECIOS VARCHAR(1)
	DECLARE @PREVISTA1 VARCHAR(1)
	DECLARE @PREVISTA2 VARCHAR(1)
	DECLARE @PREVISTA3 VARCHAR(1)
	DECLARE @PREVISTA4 VARCHAR(1)
	DECLARE @PREVISTA5 VARCHAR(1)
	DECLARE @CTR_CONSUMO VARCHAR(25)
	DECLARE @CC_EN_LINEA VARCHAR(1)
	DECLARE @CG_EN_LINEA VARCHAR(1)
	DECLARE @USAR_AUTORIZACION VARCHAR(1)
	DECLARE @IMP1_EN_BONIFICA VARCHAR(1)
	DECLARE @IMP2_EN_BONIFICA VARCHAR(1)
	DECLARE @ASIENTO_CONTCXCPOR VARCHAR(1)
	DECLARE @USAR_APROB_PEDIDOS VARCHAR(1)
	DECLARE @NOM_RUBRO10_CLI VARCHAR(60)
	DECLARE @LISTA_PRECIOS VARCHAR(1)
	DECLARE @MARGEN_UTILIDAD VARCHAR(1)
	DECLARE @MONTO_MINIMO VARCHAR(1)
	DECLARE @DOCS_VENCIDOS VARCHAR(1)
	DECLARE @LIMITE_CREDITO VARCHAR(1)
	DECLARE @COBRO_JUDICIAL VARCHAR(1)
	DECLARE @SIN_OC VARCHAR(1)
	DECLARE @DIAS_ATRASO VARCHAR(1)
	DECLARE @MONTO_MINIMO_LOCAL DECIMAL(28,8)
	DECLARE @MONTO_MINIMO_DOLAR DECIMAL(28,8)
	DECLARE @SALDO_MAX_LOCAL DECIMAL(28,8)
	DECLARE @SALDO_MAX_DOLAR DECIMAL(28,8)
	DECLARE @MAX_DIAS_ATRASO INT
	DECLARE @MAX_DOCS_VENC INT
	DECLARE @PRECIOS_DEC_DOLAR INT
	DECLARE @COND_PAGO_NIV_PRE VARCHAR(1)
	DECLARE @FACT_LISTA_PRECIOS VARCHAR(1)
	DECLARE @FACT_MARGEN_UTILID VARCHAR(1)
	DECLARE @FACT_MONTO_MINIMO VARCHAR(1)
	DECLARE @FACT_DIAS_ATRASO VARCHAR(1)
	DECLARE @FACT_SIN_OC VARCHAR(1)
	DECLARE @USAR_RUBROS_VAL VARCHAR(1)
	DECLARE @IMP_DESC_CLASIFIC VARCHAR(1)
	DECLARE @LIMITAR_MAX_LINEAS VARCHAR(1)
	DECLARE @INDICAD_PEDIDO VARCHAR(1)
	DECLARE @PRECIO_COSTO VARCHAR(1)
	DECLARE @FACT_MENOR_RESERVA VARCHAR(1)
	DECLARE @USA_DESPACHOS VARCHAR(1)
	DECLARE @CTR_INV_DESPACHAR VARCHAR(25)
	DECLARE @CTA_INV_DESPACHAR VARCHAR(25)
	DECLARE @ANULA_CXC_APLICADO VARCHAR(1)
	DECLARE @USA_ESQUEMA_CAJAS VARCHAR(1)
	DECLARE @TIPO_COSTO_NOEXIST VARCHAR(1)
	DECLARE @CALCULO_IMP2 VARCHAR(1)
	DECLARE @CATEGORIA_CLIENTE VARCHAR(8)
	DECLARE @NIVEL_PRECIO VARCHAR(12)
	DECLARE @MONEDA_NIVEL VARCHAR(1)
	DECLARE @DESCUENTO_CASCADA VARCHAR(1)
	DECLARE @RETENCIONES VARCHAR(1)
	DECLARE @RETENCIONES_FLETES VARCHAR(1)
	DECLARE @ARTICULO VARCHAR(20)
	DECLARE @CODIGO_RETENCION VARCHAR(4)
	DECLARE @APLICAR_DESC_GEN VARCHAR(1)
	DECLARE @MODO_DESC_MULT VARCHAR(1)
	DECLARE @DCTO_GENERAL VARCHAR(1)
	DECLARE @FACT_DCTO_GENERAL VARCHAR(1)
	DECLARE @AUTOR_GRABAR VARCHAR(1)
	DECLARE @AUTOR_APROBAR VARCHAR(1)
	DECLARE @AUTOR_FACTUREMITIR VARCHAR(1)
	DECLARE @AUTOR_FACTREMISION VARCHAR(1)
	DECLARE @CARGAR_APROBADO_CC VARCHAR(1)
	DECLARE @REMISION_A_IMPRES VARCHAR(1)
	DECLARE @DEVOLUC_A_IMPRES VARCHAR(1)
	DECLARE @NOM_RUBRO16_CLI VARCHAR(60)
	DECLARE @NOM_RUBRO17_CLI VARCHAR(60)
	DECLARE @NOM_RUBRO18_CLI VARCHAR(60)
	DECLARE @NOM_RUBRO19_CLI VARCHAR(60)
	DECLARE @NOM_RUBRO20_CLI VARCHAR(60)
	 -- Declaraciones

	SET @ERROR = 0

	SELECT @PUBLICADOR = SITIO_LOCAL, @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_MODIFIED CURSOR LOCAL FOR
			SELECT LLAVE, BODEGA_DEFAULT, COND_PAGO_CONTAD, VENDEDOR_OBLIGATOR, FACT_EXC_PEDIDO, USA_TARJETA_CRED, BODEGA_POR_LINEA, PERMITE_BACKORDER, CANCEL_PED_PARCIAL, PED_A_IMPRESORA, DOC_A_IMPRESORA, IMPRE_LOTE_SEPARAD, FACTURA_MULTIPAG, INCR_NUM_FACTURA, MULTIPLE_FMT_FACTU, MULTIPLE_FMT_PEDID, ORDEN_LINEAS_FACT, REIMPRESION_PEDIDO, IMP_PEDIDO_AL_FACT, REDONDEAR_FACTURA, FACTOR_REDONDEO, PRECIOS_DEC, DESC_EN_PRECIO, IMP1_EN_PRECIO, IMP1_AFECTA_DESCTO, APLICA_NI_PR_IMP1, MONEDA_IMP1, NIV_PRECIO_IMP1, PAGO_COM_PARCIAL, PORC_IMP_COMISION, ASIENTO_VENTA_POR, TIPO_ASIENTO, PAQUETE, CTR_FLETE, CTA_FLETE, CTR_SEGURO, CTA_SEGURO, CTR_DOCUMENTACI, CTA_DOCUMENTACI, CTR_IMPUESTO1, CTA_IMPUESTO1, CTR_IMPUESTO2, CTA_IMPUESTO2, CTR_IMP_COMISIO, CTA_IMP_COMISIO, USAR_RUBROS, RUBRO1_NOMBRE, RUBRO2_NOMBRE, RUBRO3_NOMBRE, RUBRO4_NOMBRE, USA_BOLETAS, NOM_RUBRO6_CLI, NOM_RUBRO7_CLI, NOM_RUBRO8_CLI, NOM_RUBRO9_CLI, RUBRO5_NOMBRE, NIV_PRE_PUBLICO, MONEDA_PUBLICO, COLUMNAS_ESTANDAR, ASIENTO_COSTO_POR, CAMBIAR_ESQ_TRAB, FACT_DOCS_VENCIDOS, FACT_COBRO_JUD, FACT_LIMITE_CRED, MOD_APLIC_ASIENTO, INTEGRACION_CONTA, TIPO_CONTA_OMISION, TIPO_CAMBIO, PRECISION_MAXIMA, LINEAS_ARTICULO, LINEAS_FACTURA, LINEAS_ADICIONALES, DETALLE_KITS, MOD_PRECIOS, PREVISTA1, PREVISTA2, PREVISTA3, PREVISTA4, PREVISTA5, CTR_CONSUMO, CC_EN_LINEA, CG_EN_LINEA, USAR_AUTORIZACION, IMP1_EN_BONIFICA, IMP2_EN_BONIFICA, ASIENTO_CONTCXCPOR, USAR_APROB_PEDIDOS, NOM_RUBRO10_CLI, LISTA_PRECIOS, MARGEN_UTILIDAD, MONTO_MINIMO, DOCS_VENCIDOS, LIMITE_CREDITO, COBRO_JUDICIAL, SIN_OC, DIAS_ATRASO, MONTO_MINIMO_LOCAL, MONTO_MINIMO_DOLAR, SALDO_MAX_LOCAL, SALDO_MAX_DOLAR, MAX_DIAS_ATRASO, MAX_DOCS_VENC, PRECIOS_DEC_DOLAR, COND_PAGO_NIV_PRE, FACT_LISTA_PRECIOS, FACT_MARGEN_UTILID, FACT_MONTO_MINIMO, FACT_DIAS_ATRASO, FACT_SIN_OC, USAR_RUBROS_VAL, IMP_DESC_CLASIFIC, LIMITAR_MAX_LINEAS, INDICAD_PEDIDO, PRECIO_COSTO, FACT_MENOR_RESERVA, USA_DESPACHOS, CTR_INV_DESPACHAR, CTA_INV_DESPACHAR, ANULA_CXC_APLICADO, USA_ESQUEMA_CAJAS, TIPO_COSTO_NOEXIST, CALCULO_IMP2, CATEGORIA_CLIENTE, NIVEL_PRECIO, MONEDA_NIVEL, DESCUENTO_CASCADA, RETENCIONES, RETENCIONES_FLETES, ARTICULO, CODIGO_RETENCION, APLICAR_DESC_GEN, MODO_DESC_MULT, DCTO_GENERAL, FACT_DCTO_GENERAL, AUTOR_GRABAR, AUTOR_APROBAR, AUTOR_FACTUREMITIR, AUTOR_FACTREMISION, CARGAR_APROBADO_CC, REMISION_A_IMPRES, DEVOLUC_A_IMPRES, NOM_RUBRO16_CLI, NOM_RUBRO17_CLI, NOM_RUBRO18_CLI, NOM_RUBRO19_CLI, NOM_RUBRO20_CLI-- Columnas
			FROM INSERTED I

		SET @ACTUALIZAR_SOLICITUD = 1

		OPEN C_MODIFIED

		FETCH NEXT FROM C_MODIFIED
		INTO @LLAVE, @BODEGA_DEFAULT, @COND_PAGO_CONTAD, @VENDEDOR_OBLIGATOR, @FACT_EXC_PEDIDO, @USA_TARJETA_CRED, @BODEGA_POR_LINEA, @PERMITE_BACKORDER, @CANCEL_PED_PARCIAL, @PED_A_IMPRESORA, @DOC_A_IMPRESORA, @IMPRE_LOTE_SEPARAD, @FACTURA_MULTIPAG, @INCR_NUM_FACTURA, @MULTIPLE_FMT_FACTU, @MULTIPLE_FMT_PEDID, @ORDEN_LINEAS_FACT, @REIMPRESION_PEDIDO, @IMP_PEDIDO_AL_FACT, @REDONDEAR_FACTURA, @FACTOR_REDONDEO, @PRECIOS_DEC, @DESC_EN_PRECIO, @IMP1_EN_PRECIO, @IMP1_AFECTA_DESCTO, @APLICA_NI_PR_IMP1, @MONEDA_IMP1, @NIV_PRECIO_IMP1, @PAGO_COM_PARCIAL, @PORC_IMP_COMISION, @ASIENTO_VENTA_POR, @TIPO_ASIENTO, @PAQUETE, @CTR_FLETE, @CTA_FLETE, @CTR_SEGURO, @CTA_SEGURO, @CTR_DOCUMENTACI, @CTA_DOCUMENTACI, @CTR_IMPUESTO1, @CTA_IMPUESTO1, @CTR_IMPUESTO2, @CTA_IMPUESTO2, @CTR_IMP_COMISIO, @CTA_IMP_COMISIO, @USAR_RUBROS, @RUBRO1_NOMBRE, @RUBRO2_NOMBRE, @RUBRO3_NOMBRE, @RUBRO4_NOMBRE, @USA_BOLETAS, @NOM_RUBRO6_CLI, @NOM_RUBRO7_CLI, @NOM_RUBRO8_CLI, @NOM_RUBRO9_CLI, @RUBRO5_NOMBRE, @NIV_PRE_PUBLICO, @MONEDA_PUBLICO, @COLUMNAS_ESTANDAR, @ASIENTO_COSTO_POR, @CAMBIAR_ESQ_TRAB, @FACT_DOCS_VENCIDOS, @FACT_COBRO_JUD, @FACT_LIMITE_CRED, @MOD_APLIC_ASIENTO, @INTEGRACION_CONTA, @TIPO_CONTA_OMISION, @TIPO_CAMBIO, @PRECISION_MAXIMA, @LINEAS_ARTICULO, @LINEAS_FACTURA, @LINEAS_ADICIONALES, @DETALLE_KITS, @MOD_PRECIOS, @PREVISTA1, @PREVISTA2, @PREVISTA3, @PREVISTA4, @PREVISTA5, @CTR_CONSUMO, @CC_EN_LINEA, @CG_EN_LINEA, @USAR_AUTORIZACION, @IMP1_EN_BONIFICA, @IMP2_EN_BONIFICA, @ASIENTO_CONTCXCPOR, @USAR_APROB_PEDIDOS, @NOM_RUBRO10_CLI, @LISTA_PRECIOS, @MARGEN_UTILIDAD, @MONTO_MINIMO, @DOCS_VENCIDOS, @LIMITE_CREDITO, @COBRO_JUDICIAL, @SIN_OC, @DIAS_ATRASO, @MONTO_MINIMO_LOCAL, @MONTO_MINIMO_DOLAR, @SALDO_MAX_LOCAL, @SALDO_MAX_DOLAR, @MAX_DIAS_ATRASO, @MAX_DOCS_VENC, @PRECIOS_DEC_DOLAR, @COND_PAGO_NIV_PRE, @FACT_LISTA_PRECIOS, @FACT_MARGEN_UTILID, @FACT_MONTO_MINIMO, @FACT_DIAS_ATRASO, @FACT_SIN_OC, @USAR_RUBROS_VAL, @IMP_DESC_CLASIFIC, @LIMITAR_MAX_LINEAS, @INDICAD_PEDIDO, @PRECIO_COSTO, @FACT_MENOR_RESERVA, @USA_DESPACHOS, @CTR_INV_DESPACHAR, @CTA_INV_DESPACHAR, @ANULA_CXC_APLICADO, @USA_ESQUEMA_CAJAS, @TIPO_COSTO_NOEXIST, @CALCULO_IMP2, @CATEGORIA_CLIENTE, @NIVEL_PRECIO, @MONEDA_NIVEL, @DESCUENTO_CASCADA, @RETENCIONES, @RETENCIONES_FLETES, @ARTICULO, @CODIGO_RETENCION, @APLICAR_DESC_GEN, @MODO_DESC_MULT, @DCTO_GENERAL, @FACT_DCTO_GENERAL, @AUTOR_GRABAR, @AUTOR_APROBAR, @AUTOR_FACTUREMITIR, @AUTOR_FACTREMISION, @CARGAR_APROBADO_CC, @REMISION_A_IMPRES, @DEVOLUC_A_IMPRES, @NOM_RUBRO16_CLI, @NOM_RUBRO17_CLI, @NOM_RUBRO18_CLI, @NOM_RUBRO19_CLI, @NOM_RUBRO20_CLI

		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			IF ( NOT UPDATE(RECORDDATE) AND ( UPDATE(LLAVE) OR UPDATE(BODEGA_DEFAULT) OR UPDATE(COND_PAGO_CONTAD) OR UPDATE(VENDEDOR_OBLIGATOR) OR UPDATE(FACT_EXC_PEDIDO) OR UPDATE(USA_TARJETA_CRED) OR UPDATE(BODEGA_POR_LINEA) OR UPDATE(PERMITE_BACKORDER) OR UPDATE(CANCEL_PED_PARCIAL) OR UPDATE(PED_A_IMPRESORA) OR UPDATE(DOC_A_IMPRESORA) OR UPDATE(IMPRE_LOTE_SEPARAD) OR UPDATE(FACTURA_MULTIPAG) OR UPDATE(INCR_NUM_FACTURA) OR UPDATE(MULTIPLE_FMT_FACTU) OR UPDATE(MULTIPLE_FMT_PEDID) OR UPDATE(ORDEN_LINEAS_FACT) OR UPDATE(REIMPRESION_PEDIDO) OR UPDATE(IMP_PEDIDO_AL_FACT) OR UPDATE(REDONDEAR_FACTURA) OR UPDATE(FACTOR_REDONDEO) OR UPDATE(PRECIOS_DEC) OR UPDATE(DESC_EN_PRECIO) OR UPDATE(IMP1_EN_PRECIO) OR UPDATE(IMP1_AFECTA_DESCTO) OR UPDATE(APLICA_NI_PR_IMP1) OR UPDATE(MONEDA_IMP1) OR UPDATE(NIV_PRECIO_IMP1) OR UPDATE(PAGO_COM_PARCIAL) OR UPDATE(PORC_IMP_COMISION) OR UPDATE(ASIENTO_VENTA_POR) OR UPDATE(TIPO_ASIENTO) OR UPDATE(PAQUETE) OR UPDATE(CTR_FLETE) OR UPDATE(CTA_FLETE) OR UPDATE(CTR_SEGURO) OR UPDATE(CTA_SEGURO) OR UPDATE(CTR_DOCUMENTACI) OR UPDATE(CTA_DOCUMENTACI) OR UPDATE(CTR_IMPUESTO1) OR UPDATE(CTA_IMPUESTO1) OR UPDATE(CTR_IMPUESTO2) OR UPDATE(CTA_IMPUESTO2) OR UPDATE(CTR_IMP_COMISIO) OR UPDATE(CTA_IMP_COMISIO) OR UPDATE(USAR_RUBROS) OR UPDATE(RUBRO1_NOMBRE) OR UPDATE(RUBRO2_NOMBRE) OR UPDATE(RUBRO3_NOMBRE) OR UPDATE(RUBRO4_NOMBRE) OR UPDATE(USA_BOLETAS) OR UPDATE(NOM_RUBRO6_CLI) OR UPDATE(NOM_RUBRO7_CLI) OR UPDATE(NOM_RUBRO8_CLI) OR UPDATE(NOM_RUBRO9_CLI) OR UPDATE(RUBRO5_NOMBRE) OR UPDATE(NIV_PRE_PUBLICO) OR UPDATE(MONEDA_PUBLICO) OR UPDATE(COLUMNAS_ESTANDAR) OR UPDATE(ASIENTO_COSTO_POR) OR UPDATE(CAMBIAR_ESQ_TRAB) OR UPDATE(FACT_DOCS_VENCIDOS) OR UPDATE(FACT_COBRO_JUD) OR UPDATE(FACT_LIMITE_CRED) OR UPDATE(MOD_APLIC_ASIENTO) OR UPDATE(INTEGRACION_CONTA) OR UPDATE(TIPO_CONTA_OMISION) OR UPDATE(TIPO_CAMBIO) OR UPDATE(PRECISION_MAXIMA) OR UPDATE(LINEAS_ARTICULO) OR UPDATE(LINEAS_FACTURA) OR UPDATE(LINEAS_ADICIONALES) OR UPDATE(DETALLE_KITS) OR UPDATE(MOD_PRECIOS) OR UPDATE(PREVISTA1) OR UPDATE(PREVISTA2) OR UPDATE(PREVISTA3) OR UPDATE(PREVISTA4) OR UPDATE(PREVISTA5) OR UPDATE(CTR_CONSUMO) OR UPDATE(CC_EN_LINEA) OR UPDATE(CG_EN_LINEA) OR UPDATE(USAR_AUTORIZACION) OR UPDATE(IMP1_EN_BONIFICA) OR UPDATE(IMP2_EN_BONIFICA) OR UPDATE(ASIENTO_CONTCXCPOR) OR UPDATE(USAR_APROB_PEDIDOS) OR UPDATE(NOM_RUBRO10_CLI) OR UPDATE(LISTA_PRECIOS) OR UPDATE(MARGEN_UTILIDAD) OR UPDATE(MONTO_MINIMO) OR UPDATE(DOCS_VENCIDOS) OR UPDATE(LIMITE_CREDITO) OR UPDATE(COBRO_JUDICIAL) OR UPDATE(SIN_OC) OR UPDATE(DIAS_ATRASO) OR UPDATE(MONTO_MINIMO_LOCAL) OR UPDATE(MONTO_MINIMO_DOLAR) OR UPDATE(SALDO_MAX_LOCAL) OR UPDATE(SALDO_MAX_DOLAR) OR UPDATE(MAX_DIAS_ATRASO) OR UPDATE(MAX_DOCS_VENC) OR UPDATE(PRECIOS_DEC_DOLAR) OR UPDATE(COND_PAGO_NIV_PRE) OR UPDATE(FACT_LISTA_PRECIOS) OR UPDATE(FACT_MARGEN_UTILID) OR UPDATE(FACT_MONTO_MINIMO) OR UPDATE(FACT_DIAS_ATRASO) OR UPDATE(FACT_SIN_OC) OR UPDATE(USAR_RUBROS_VAL) OR UPDATE(IMP_DESC_CLASIFIC) OR UPDATE(LIMITAR_MAX_LINEAS) OR UPDATE(INDICAD_PEDIDO) OR UPDATE(PRECIO_COSTO) OR UPDATE(FACT_MENOR_RESERVA) OR UPDATE(USA_DESPACHOS) OR UPDATE(CTR_INV_DESPACHAR) OR UPDATE(CTA_INV_DESPACHAR) OR UPDATE(ANULA_CXC_APLICADO) OR UPDATE(USA_ESQUEMA_CAJAS) OR UPDATE(TIPO_COSTO_NOEXIST) OR UPDATE(CALCULO_IMP2) OR UPDATE(CATEGORIA_CLIENTE) OR UPDATE(NIVEL_PRECIO) OR UPDATE(MONEDA_NIVEL) OR UPDATE(DESCUENTO_CASCADA) OR UPDATE(RETENCIONES) OR UPDATE(RETENCIONES_FLETES) OR UPDATE(ARTICULO) OR UPDATE(CODIGO_RETENCION) OR UPDATE(APLICAR_DESC_GEN) OR UPDATE(MODO_DESC_MULT) OR UPDATE(DCTO_GENERAL) OR UPDATE(FACT_DCTO_GENERAL) OR UPDATE(AUTOR_GRABAR) OR UPDATE(AUTOR_APROBAR) OR UPDATE(AUTOR_FACTUREMITIR) OR UPDATE(AUTOR_FACTREMISION) OR UPDATE(CARGAR_APROBADO_CC) OR UPDATE(REMISION_A_IMPRES) OR UPDATE(DEVOLUC_A_IMPRES) OR UPDATE(NOM_RUBRO16_CLI) OR UPDATE(NOM_RUBRO17_CLI) OR UPDATE(NOM_RUBRO18_CLI) OR UPDATE(NOM_RUBRO19_CLI) OR UPDATE(NOM_RUBRO20_CLI) ) )
			BEGIN

				SELECT @COL_ROWPOINTER = ROWPOINTER 
				FROM $$Compania$$.GLOBALES_FA

			SET @PARAMETROS = 
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<GLOBALES_FA>' + 
				'<LLAVE Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@LLAVE) + '</LLAVE>' + 
				'<BODEGA_DEFAULT Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@BODEGA_DEFAULT) + '</BODEGA_DEFAULT>' + 
				'<COND_PAGO_CONTAD Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@COND_PAGO_CONTAD) + '</COND_PAGO_CONTAD>' + 
				'<VENDEDOR_OBLIGATOR Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@VENDEDOR_OBLIGATOR) + '</VENDEDOR_OBLIGATOR>' + 
				'<FACT_EXC_PEDIDO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@FACT_EXC_PEDIDO) + '</FACT_EXC_PEDIDO>' + 
				'<USA_TARJETA_CRED Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USA_TARJETA_CRED) + '</USA_TARJETA_CRED>' + 
				'<BODEGA_POR_LINEA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@BODEGA_POR_LINEA) + '</BODEGA_POR_LINEA>' + 
				'<PERMITE_BACKORDER Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@PERMITE_BACKORDER) + '</PERMITE_BACKORDER>' + 
				'<CANCEL_PED_PARCIAL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CANCEL_PED_PARCIAL) + '</CANCEL_PED_PARCIAL>' + 
				'<PED_A_IMPRESORA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@PED_A_IMPRESORA) + '</PED_A_IMPRESORA>' + 
				'<DOC_A_IMPRESORA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DOC_A_IMPRESORA) + '</DOC_A_IMPRESORA>' + 
				'<IMPRE_LOTE_SEPARAD Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@IMPRE_LOTE_SEPARAD) + '</IMPRE_LOTE_SEPARAD>' + 
				'<FACTURA_MULTIPAG Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@FACTURA_MULTIPAG) + '</FACTURA_MULTIPAG>' + 
				'<INCR_NUM_FACTURA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@INCR_NUM_FACTURA) + '</INCR_NUM_FACTURA>' + 
				'<MULTIPLE_FMT_FACTU Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@MULTIPLE_FMT_FACTU) + '</MULTIPLE_FMT_FACTU>' + 
				'<MULTIPLE_FMT_PEDID Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@MULTIPLE_FMT_PEDID) + '</MULTIPLE_FMT_PEDID>' + 
				'<ORDEN_LINEAS_FACT Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ORDEN_LINEAS_FACT) + '</ORDEN_LINEAS_FACT>' + 
				'<REIMPRESION_PEDIDO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@REIMPRESION_PEDIDO) + '</REIMPRESION_PEDIDO>' + 
				'<IMP_PEDIDO_AL_FACT Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@IMP_PEDIDO_AL_FACT) + '</IMP_PEDIDO_AL_FACT>' + 
				'<REDONDEAR_FACTURA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@REDONDEAR_FACTURA) + '</REDONDEAR_FACTURA>' + 
				'<FACTOR_REDONDEO Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@FACTOR_REDONDEO) + '</FACTOR_REDONDEO>' + 
				'<PRECIOS_DEC Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@PRECIOS_DEC) + '</PRECIOS_DEC>' + 
				'<DESC_EN_PRECIO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DESC_EN_PRECIO) + '</DESC_EN_PRECIO>' + 
				'<IMP1_EN_PRECIO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@IMP1_EN_PRECIO) + '</IMP1_EN_PRECIO>' + 
				'<IMP1_AFECTA_DESCTO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@IMP1_AFECTA_DESCTO) + '</IMP1_AFECTA_DESCTO>' + 
				'<APLICA_NI_PR_IMP1 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@APLICA_NI_PR_IMP1) + '</APLICA_NI_PR_IMP1>' + 
				'<MONEDA_IMP1 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@MONEDA_IMP1) + '</MONEDA_IMP1>' + 
				'<NIV_PRECIO_IMP1 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NIV_PRECIO_IMP1) + '</NIV_PRECIO_IMP1>' + 
				'<PAGO_COM_PARCIAL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@PAGO_COM_PARCIAL) + '</PAGO_COM_PARCIAL>' + 
				'<PORC_IMP_COMISION Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@PORC_IMP_COMISION) + '</PORC_IMP_COMISION>' + 
				'<ASIENTO_VENTA_POR Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ASIENTO_VENTA_POR) + '</ASIENTO_VENTA_POR>' + 
				'<TIPO_ASIENTO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_ASIENTO) + '</TIPO_ASIENTO>' + 
				'<PAQUETE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@PAQUETE) + '</PAQUETE>' + 
				'<CTR_FLETE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_FLETE) + '</CTR_FLETE>' + 
				'<CTA_FLETE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_FLETE) + '</CTA_FLETE>' + 
				'<CTR_SEGURO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_SEGURO) + '</CTR_SEGURO>' + 
				'<CTA_SEGURO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_SEGURO) + '</CTA_SEGURO>' + 
				'<CTR_DOCUMENTACI Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_DOCUMENTACI) + '</CTR_DOCUMENTACI>' + 
				'<CTA_DOCUMENTACI Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_DOCUMENTACI) + '</CTA_DOCUMENTACI>' + 
				'<CTR_IMPUESTO1 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_IMPUESTO1) + '</CTR_IMPUESTO1>' + 
				'<CTA_IMPUESTO1 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_IMPUESTO1) + '</CTA_IMPUESTO1>' + 
				'<CTR_IMPUESTO2 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_IMPUESTO2) + '</CTR_IMPUESTO2>' + 
				'<CTA_IMPUESTO2 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_IMPUESTO2) + '</CTA_IMPUESTO2>' + 
				'<CTR_IMP_COMISIO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_IMP_COMISIO) + '</CTR_IMP_COMISIO>' + 
				'<CTA_IMP_COMISIO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_IMP_COMISIO) + '</CTA_IMP_COMISIO>' + 
				'<USAR_RUBROS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USAR_RUBROS) + '</USAR_RUBROS>' + 
				'<RUBRO1_NOMBRE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@RUBRO1_NOMBRE) + '</RUBRO1_NOMBRE>' + 
				'<RUBRO2_NOMBRE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@RUBRO2_NOMBRE) + '</RUBRO2_NOMBRE>'
				
			SET @PARAMETROS2 = 				
				'<RUBRO3_NOMBRE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@RUBRO3_NOMBRE) + '</RUBRO3_NOMBRE>' + 
				'<RUBRO4_NOMBRE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@RUBRO4_NOMBRE) + '</RUBRO4_NOMBRE>' + 
				'<USA_BOLETAS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USA_BOLETAS) + '</USA_BOLETAS>' + 
				'<NOM_RUBRO6_CLI Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOM_RUBRO6_CLI) + '</NOM_RUBRO6_CLI>' + 
				'<NOM_RUBRO7_CLI Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOM_RUBRO7_CLI) + '</NOM_RUBRO7_CLI>' + 
				'<NOM_RUBRO8_CLI Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOM_RUBRO8_CLI) + '</NOM_RUBRO8_CLI>' + 
				'<NOM_RUBRO9_CLI Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOM_RUBRO9_CLI) + '</NOM_RUBRO9_CLI>' + 
				'<RUBRO5_NOMBRE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@RUBRO5_NOMBRE) + '</RUBRO5_NOMBRE>' + 
				'<NIV_PRE_PUBLICO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NIV_PRE_PUBLICO) + '</NIV_PRE_PUBLICO>' + 
				'<MONEDA_PUBLICO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@MONEDA_PUBLICO) + '</MONEDA_PUBLICO>' + 
				'<COLUMNAS_ESTANDAR Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@COLUMNAS_ESTANDAR) + '</COLUMNAS_ESTANDAR>' + 
				'<ASIENTO_COSTO_POR Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ASIENTO_COSTO_POR) + '</ASIENTO_COSTO_POR>' + 
				'<CAMBIAR_ESQ_TRAB Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CAMBIAR_ESQ_TRAB) + '</CAMBIAR_ESQ_TRAB>' + 
				'<FACT_DOCS_VENCIDOS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@FACT_DOCS_VENCIDOS) + '</FACT_DOCS_VENCIDOS>' + 
				'<FACT_COBRO_JUD Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@FACT_COBRO_JUD) + '</FACT_COBRO_JUD>' + 
				'<FACT_LIMITE_CRED Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@FACT_LIMITE_CRED) + '</FACT_LIMITE_CRED>' + 
				'<MOD_APLIC_ASIENTO Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@MOD_APLIC_ASIENTO) + '</MOD_APLIC_ASIENTO>' + 
				'<INTEGRACION_CONTA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@INTEGRACION_CONTA) + '</INTEGRACION_CONTA>' + 
				'<TIPO_CONTA_OMISION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_CONTA_OMISION) + '</TIPO_CONTA_OMISION>' + 
				'<TIPO_CAMBIO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_CAMBIO) + '</TIPO_CAMBIO>' + 
				'<PRECISION_MAXIMA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@PRECISION_MAXIMA) + '</PRECISION_MAXIMA>' + 
				'<LINEAS_ARTICULO Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@LINEAS_ARTICULO) + '</LINEAS_ARTICULO>' + 
				'<LINEAS_FACTURA Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@LINEAS_FACTURA) + '</LINEAS_FACTURA>' + 
				'<LINEAS_ADICIONALES Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@LINEAS_ADICIONALES) + '</LINEAS_ADICIONALES>' + 
				'<DETALLE_KITS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DETALLE_KITS) + '</DETALLE_KITS>' + 
				'<MOD_PRECIOS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@MOD_PRECIOS) + '</MOD_PRECIOS>' + 
				'<PREVISTA1 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@PREVISTA1) + '</PREVISTA1>' + 
				'<PREVISTA2 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@PREVISTA2) + '</PREVISTA2>' + 
				'<PREVISTA3 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@PREVISTA3) + '</PREVISTA3>' + 
				'<PREVISTA4 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@PREVISTA4) + '</PREVISTA4>' + 
				'<PREVISTA5 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@PREVISTA5) + '</PREVISTA5>' + 
				'<CTR_CONSUMO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_CONSUMO) + '</CTR_CONSUMO>' + 
				'<CC_EN_LINEA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CC_EN_LINEA) + '</CC_EN_LINEA>' + 
				'<CG_EN_LINEA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CG_EN_LINEA) + '</CG_EN_LINEA>' + 
				'<USAR_AUTORIZACION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USAR_AUTORIZACION) + '</USAR_AUTORIZACION>' + 
				'<IMP1_EN_BONIFICA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@IMP1_EN_BONIFICA) + '</IMP1_EN_BONIFICA>' + 
				'<IMP2_EN_BONIFICA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@IMP2_EN_BONIFICA) + '</IMP2_EN_BONIFICA>' + 
				'<ASIENTO_CONTCXCPOR Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ASIENTO_CONTCXCPOR) + '</ASIENTO_CONTCXCPOR>' + 
				'<USAR_APROB_PEDIDOS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USAR_APROB_PEDIDOS) + '</USAR_APROB_PEDIDOS>' + 
				'<NOM_RUBRO10_CLI Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOM_RUBRO10_CLI) + '</NOM_RUBRO10_CLI>' + 
				'<LISTA_PRECIOS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@LISTA_PRECIOS) + '</LISTA_PRECIOS>' + 
				'<MARGEN_UTILIDAD Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@MARGEN_UTILIDAD) + '</MARGEN_UTILIDAD>' + 
				'<MONTO_MINIMO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@MONTO_MINIMO) + '</MONTO_MINIMO>' + 
				'<DOCS_VENCIDOS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DOCS_VENCIDOS) + '</DOCS_VENCIDOS>' + 
				'<LIMITE_CREDITO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@LIMITE_CREDITO) + '</LIMITE_CREDITO>' + 
				'<COBRO_JUDICIAL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@COBRO_JUDICIAL) + '</COBRO_JUDICIAL>' + 
				'<SIN_OC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@SIN_OC) + '</SIN_OC>' + 
				'<DIAS_ATRASO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DIAS_ATRASO) + '</DIAS_ATRASO>' + 
				'<MONTO_MINIMO_LOCAL Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@MONTO_MINIMO_LOCAL) + '</MONTO_MINIMO_LOCAL>' + 
				'<MONTO_MINIMO_DOLAR Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@MONTO_MINIMO_DOLAR) + '</MONTO_MINIMO_DOLAR>' + 
				'<SALDO_MAX_LOCAL Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@SALDO_MAX_LOCAL) + '</SALDO_MAX_LOCAL>' + 
				'<SALDO_MAX_DOLAR Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@SALDO_MAX_DOLAR) + '</SALDO_MAX_DOLAR>' + 
				'<MAX_DIAS_ATRASO Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@MAX_DIAS_ATRASO) + '</MAX_DIAS_ATRASO>' + 
				'<MAX_DOCS_VENC Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@MAX_DOCS_VENC) + '</MAX_DOCS_VENC>' 
				
			SET @PARAMETROS3 = 
				'<PRECIOS_DEC_DOLAR Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@PRECIOS_DEC_DOLAR) + '</PRECIOS_DEC_DOLAR>' + 
				'<COND_PAGO_NIV_PRE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@COND_PAGO_NIV_PRE) + '</COND_PAGO_NIV_PRE>' + 
				'<FACT_LISTA_PRECIOS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@FACT_LISTA_PRECIOS) + '</FACT_LISTA_PRECIOS>' + 
				'<FACT_MARGEN_UTILID Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@FACT_MARGEN_UTILID) + '</FACT_MARGEN_UTILID>' + 
				'<FACT_MONTO_MINIMO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@FACT_MONTO_MINIMO) + '</FACT_MONTO_MINIMO>' + 
				'<FACT_DIAS_ATRASO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@FACT_DIAS_ATRASO) + '</FACT_DIAS_ATRASO>' + 
				'<FACT_SIN_OC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@FACT_SIN_OC) + '</FACT_SIN_OC>' + 
				'<USAR_RUBROS_VAL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USAR_RUBROS_VAL) + '</USAR_RUBROS_VAL>' + 
				'<IMP_DESC_CLASIFIC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@IMP_DESC_CLASIFIC) + '</IMP_DESC_CLASIFIC>' + 
				'<LIMITAR_MAX_LINEAS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@LIMITAR_MAX_LINEAS) + '</LIMITAR_MAX_LINEAS>' + 
				'<INDICAD_PEDIDO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@INDICAD_PEDIDO) + '</INDICAD_PEDIDO>' + 
				'<PRECIO_COSTO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@PRECIO_COSTO) + '</PRECIO_COSTO>' + 
				'<FACT_MENOR_RESERVA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@FACT_MENOR_RESERVA) + '</FACT_MENOR_RESERVA>' + 
				'<USA_DESPACHOS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USA_DESPACHOS) + '</USA_DESPACHOS>' + 
				'<CTR_INV_DESPACHAR Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_INV_DESPACHAR) + '</CTR_INV_DESPACHAR>' + 
				'<CTA_INV_DESPACHAR Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_INV_DESPACHAR) + '</CTA_INV_DESPACHAR>' + 
				'<ANULA_CXC_APLICADO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ANULA_CXC_APLICADO) + '</ANULA_CXC_APLICADO>' + 
				'<USA_ESQUEMA_CAJAS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USA_ESQUEMA_CAJAS) + '</USA_ESQUEMA_CAJAS>' + 
				'<TIPO_COSTO_NOEXIST Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_COSTO_NOEXIST) + '</TIPO_COSTO_NOEXIST>' + 
				'<CALCULO_IMP2 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CALCULO_IMP2) + '</CALCULO_IMP2>' + 
				'<CATEGORIA_CLIENTE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CATEGORIA_CLIENTE) + '</CATEGORIA_CLIENTE>' + 
				'<NIVEL_PRECIO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NIVEL_PRECIO) + '</NIVEL_PRECIO>' + 
				'<MONEDA_NIVEL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@MONEDA_NIVEL) + '</MONEDA_NIVEL>' + 
				'<DESCUENTO_CASCADA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DESCUENTO_CASCADA) + '</DESCUENTO_CASCADA>' + 
				'<RETENCIONES Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@RETENCIONES) + '</RETENCIONES>' + 
				'<RETENCIONES_FLETES Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@RETENCIONES_FLETES) + '</RETENCIONES_FLETES>' + 
				'<ARTICULO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ARTICULO) + '</ARTICULO>' + 
				'<CODIGO_RETENCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CODIGO_RETENCION) + '</CODIGO_RETENCION>' + 
				'<APLICAR_DESC_GEN Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@APLICAR_DESC_GEN) + '</APLICAR_DESC_GEN>' + 
				'<MODO_DESC_MULT Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@MODO_DESC_MULT) + '</MODO_DESC_MULT>' + 
				'<DCTO_GENERAL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DCTO_GENERAL) + '</DCTO_GENERAL>' + 
				'<FACT_DCTO_GENERAL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@FACT_DCTO_GENERAL) + '</FACT_DCTO_GENERAL>' + 
				'<AUTOR_GRABAR Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@AUTOR_GRABAR) + '</AUTOR_GRABAR>' + 
				'<AUTOR_APROBAR Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@AUTOR_APROBAR) + '</AUTOR_APROBAR>' + 
				'<AUTOR_FACTUREMITIR Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@AUTOR_FACTUREMITIR) + '</AUTOR_FACTUREMITIR>' + 
				'<AUTOR_FACTREMISION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@AUTOR_FACTREMISION) + '</AUTOR_FACTREMISION>' + 
				'<CARGAR_APROBADO_CC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CARGAR_APROBADO_CC) + '</CARGAR_APROBADO_CC>' + 
				'<REMISION_A_IMPRES Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@REMISION_A_IMPRES) + '</REMISION_A_IMPRES>' + 
				'<DEVOLUC_A_IMPRES Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DEVOLUC_A_IMPRES) + '</DEVOLUC_A_IMPRES>' + 
				'<NOM_RUBRO16_CLI Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOM_RUBRO16_CLI) + '</NOM_RUBRO16_CLI>' + 
				'<NOM_RUBRO17_CLI Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOM_RUBRO17_CLI) + '</NOM_RUBRO17_CLI>' + 
				'<NOM_RUBRO18_CLI Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOM_RUBRO18_CLI) + '</NOM_RUBRO18_CLI>' + 
				'<NOM_RUBRO19_CLI Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOM_RUBRO19_CLI) + '</NOM_RUBRO19_CLI>' + 
				'<NOM_RUBRO20_CLI Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOM_RUBRO20_CLI) + '</NOM_RUBRO20_CLI>' + 
				'</GLOBALES_FA>'


				-- inserta la solicitud correspondiente
				EXECUTE  ('ERPADMIN.POS_InsertarSolicitud ''' + @PUBLICADOR + ''', ''GLOBALESFAPOS600'', ''MODIFICA'', ''' + @PARAMETROS + @PARAMETROS2 + @PARAMETROS3 + ''', ' + @ACTUALIZAR_SOLICITUD + ', ''' + @COL_ROWPOINTER + '''')
			END

			FETCH NEXT FROM C_MODIFIED
			INTO @LLAVE, @BODEGA_DEFAULT, @COND_PAGO_CONTAD, @VENDEDOR_OBLIGATOR, @FACT_EXC_PEDIDO, @USA_TARJETA_CRED, @BODEGA_POR_LINEA, @PERMITE_BACKORDER, @CANCEL_PED_PARCIAL, @PED_A_IMPRESORA, @DOC_A_IMPRESORA, @IMPRE_LOTE_SEPARAD, @FACTURA_MULTIPAG, @INCR_NUM_FACTURA, @MULTIPLE_FMT_FACTU, @MULTIPLE_FMT_PEDID, @ORDEN_LINEAS_FACT, @REIMPRESION_PEDIDO, @IMP_PEDIDO_AL_FACT, @REDONDEAR_FACTURA, @FACTOR_REDONDEO, @PRECIOS_DEC, @DESC_EN_PRECIO, @IMP1_EN_PRECIO, @IMP1_AFECTA_DESCTO, @APLICA_NI_PR_IMP1, @MONEDA_IMP1, @NIV_PRECIO_IMP1, @PAGO_COM_PARCIAL, @PORC_IMP_COMISION, @ASIENTO_VENTA_POR, @TIPO_ASIENTO, @PAQUETE, @CTR_FLETE, @CTA_FLETE, @CTR_SEGURO, @CTA_SEGURO, @CTR_DOCUMENTACI, @CTA_DOCUMENTACI, @CTR_IMPUESTO1, @CTA_IMPUESTO1, @CTR_IMPUESTO2, @CTA_IMPUESTO2, @CTR_IMP_COMISIO, @CTA_IMP_COMISIO, @USAR_RUBROS, @RUBRO1_NOMBRE, @RUBRO2_NOMBRE, @RUBRO3_NOMBRE, @RUBRO4_NOMBRE, @USA_BOLETAS, @NOM_RUBRO6_CLI, @NOM_RUBRO7_CLI, @NOM_RUBRO8_CLI, @NOM_RUBRO9_CLI, @RUBRO5_NOMBRE, @NIV_PRE_PUBLICO, @MONEDA_PUBLICO, @COLUMNAS_ESTANDAR, @ASIENTO_COSTO_POR, @CAMBIAR_ESQ_TRAB, @FACT_DOCS_VENCIDOS, @FACT_COBRO_JUD, @FACT_LIMITE_CRED, @MOD_APLIC_ASIENTO, @INTEGRACION_CONTA, @TIPO_CONTA_OMISION, @TIPO_CAMBIO, @PRECISION_MAXIMA, @LINEAS_ARTICULO, @LINEAS_FACTURA, @LINEAS_ADICIONALES, @DETALLE_KITS, @MOD_PRECIOS, @PREVISTA1, @PREVISTA2, @PREVISTA3, @PREVISTA4, @PREVISTA5, @CTR_CONSUMO, @CC_EN_LINEA, @CG_EN_LINEA, @USAR_AUTORIZACION, @IMP1_EN_BONIFICA, @IMP2_EN_BONIFICA, @ASIENTO_CONTCXCPOR, @USAR_APROB_PEDIDOS, @NOM_RUBRO10_CLI, @LISTA_PRECIOS, @MARGEN_UTILIDAD, @MONTO_MINIMO, @DOCS_VENCIDOS, @LIMITE_CREDITO, @COBRO_JUDICIAL, @SIN_OC, @DIAS_ATRASO, @MONTO_MINIMO_LOCAL, @MONTO_MINIMO_DOLAR, @SALDO_MAX_LOCAL, @SALDO_MAX_DOLAR, @MAX_DIAS_ATRASO, @MAX_DOCS_VENC, @PRECIOS_DEC_DOLAR, @COND_PAGO_NIV_PRE, @FACT_LISTA_PRECIOS, @FACT_MARGEN_UTILID, @FACT_MONTO_MINIMO, @FACT_DIAS_ATRASO, @FACT_SIN_OC, @USAR_RUBROS_VAL, @IMP_DESC_CLASIFIC, @LIMITAR_MAX_LINEAS, @INDICAD_PEDIDO, @PRECIO_COSTO, @FACT_MENOR_RESERVA, @USA_DESPACHOS, @CTR_INV_DESPACHAR, @CTA_INV_DESPACHAR, @ANULA_CXC_APLICADO, @USA_ESQUEMA_CAJAS, @TIPO_COSTO_NOEXIST, @CALCULO_IMP2, @CATEGORIA_CLIENTE, @NIVEL_PRECIO, @MONEDA_NIVEL, @DESCUENTO_CASCADA, @RETENCIONES, @RETENCIONES_FLETES, @ARTICULO, @CODIGO_RETENCION, @APLICAR_DESC_GEN, @MODO_DESC_MULT, @DCTO_GENERAL, @FACT_DCTO_GENERAL, @AUTOR_GRABAR, @AUTOR_APROBAR, @AUTOR_FACTUREMITIR, @AUTOR_FACTREMISION, @CARGAR_APROBADO_CC, @REMISION_A_IMPRES, @DEVOLUC_A_IMPRES, @NOM_RUBRO16_CLI, @NOM_RUBRO17_CLI, @NOM_RUBRO18_CLI, @NOM_RUBRO19_CLI, @NOM_RUBRO20_CLI
		END

		CLOSE C_MODIFIED
		DEALLOCATE C_MODIFIED
	END

	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para modificar la tabla GLOBALES_FA.',16,1 )
	END
END;






CREATE TRIGGER $$Compania$$.GLOBALES_POS_POS_INS
ON $$Compania$$.GLOBALES_POS
FOR INSERT
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @PARAMETROS2 VARCHAR(8000)
	DECLARE @PARAMETROS3 VARCHAR(8000)
	DECLARE @PARAMETROS4 VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @CONDICION_PAGO VARCHAR(4)
	DECLARE @TIPO_ASIENTO VARCHAR(4)
	DECLARE @PAQUETE VARCHAR(4)
	DECLARE @GRUPO_CAJERO VARCHAR(25)
	DECLARE @GRUPO_SUPERVISOR VARCHAR(25)
	DECLARE @CLIENTE_OMISION VARCHAR(20)
	DECLARE @INGRESO_CANTIDAD VARCHAR(1)
	DECLARE @IMPUESTO_INCLUIDO VARCHAR(1)
	DECLARE @DETALLE_KITS VARCHAR(1)
	DECLARE @REDONDEAR_FACTURA VARCHAR(1)
	DECLARE @FACTOR_REDONDEO DECIMAL(28,8)
	DECLARE @INTEGRACION_CONTA VARCHAR(1)
	DECLARE @VALIDAR_CHEQUES VARCHAR(1)
	DECLARE @PAGO_MIXTO VARCHAR(1)
	DECLARE @IMPRESION_DOBLE VARCHAR(1)
	DECLARE @MAX_FORMA_PAGO INT
	DECLARE @FOTO_ARTICULO VARCHAR(1)
	DECLARE @ESQUEMA_VENDEDOR VARCHAR(1)
	DECLARE @MANEJO_LOTE VARCHAR(1)
	DECLARE @VERIFICAR_FECHA VARCHAR(1)
	DECLARE @VALIDAR_EXISTENCIAS VARCHAR(1)
	DECLARE @MODO_APLIC_ASIENTO INT
	DECLARE @IMPRESION_SIMULTANEA VARCHAR(1)
	DECLARE @ACTUALIZACION_SIMULTANEA VARCHAR(1)
	DECLARE @PERMITE_REDUCCIONES VARCHAR(1)
	DECLARE @MOD_CONDICION_PAGO VARCHAR(1)
	DECLARE @LINEA_SUPERIOR1 VARCHAR(254)
	DECLARE @LINEA_SUPERIOR2 VARCHAR(254)
	DECLARE @LINEA_SUPERIOR3 VARCHAR(254)
	DECLARE @LINEA_SUPERIOR4 VARCHAR(254)
	DECLARE @LINEA_INFERIOR1 VARCHAR(254)
	DECLARE @LINEA_INFERIOR2 VARCHAR(254)
	DECLARE @LINEA_INFERIOR3 VARCHAR(254)
	DECLARE @LINEA_INFERIOR4 VARCHAR(254)
	DECLARE @IMP1_AFECTA_DESCTO VARCHAR(1)
	DECLARE @CALCULO_IMPUESTOS VARCHAR(1)
	DECLARE @AUTORIZA_PRECIO VARCHAR(1)
	DECLARE @PORC_DCTO_LINEA DECIMAL(28,8)
	DECLARE @PORC_DCTO_TOTAL DECIMAL(28,8)
	DECLARE @PORC_DCTO_LIN_SUP DECIMAL(28,8)
	DECLARE @PORC_DCTO_TOT_SUP DECIMAL(28,8)
	DECLARE @ARTICULO_APARTADO VARCHAR(20)
	DECLARE @LINEA_INFER1_APART VARCHAR(40)
	DECLARE @LINEA_INFER2_APART VARCHAR(40)
	DECLARE @LINEA_INFER3_APART VARCHAR(40)
	DECLARE @LINEA_INFER4_APART VARCHAR(40)
	DECLARE @DIAS_VENCE_APART INT
	DECLARE @IMPRIMIR_PRELECTURA VARCHAR(1)
	DECLARE @NIVEL_PRECIO VARCHAR(12)
	DECLARE @MONEDA_NIVEL VARCHAR(1)
	DECLARE @USAR_NIVEL_CLIENTE VARCHAR(1)
	DECLARE @USAR_BLOQUEO_AUTOM VARCHAR(1)
	DECLARE @TIEMPO_BLOQUEO INT
	DECLARE @CTR_ABONOS VARCHAR(25)
	DECLARE @CTA_ABONOS VARCHAR(25)
	DECLARE @CTR_CIERRE_CREDITO VARCHAR(25)
	DECLARE @CTA_CIERRE_CREDITO VARCHAR(25)
	DECLARE @CTR_CIERRE_DEBITO VARCHAR(25)
	DECLARE @CTA_CIERRE_DEBITO VARCHAR(25)
	DECLARE @CTR_DIFER_INGRESO VARCHAR(25)
	DECLARE @CTA_DIFER_INGRESO VARCHAR(25)
	DECLARE @CTR_DIFER_EGRESO VARCHAR(25)
	DECLARE @CTA_DIFER_EGRESO VARCHAR(25)
	DECLARE @TIPO_CONTA_OMISION VARCHAR(1)
	DECLARE @CTR_OTROS_INGRESOS VARCHAR(25)
	DECLARE @CTA_OTROS_INGRESOS VARCHAR(25)
	DECLARE @USAR_FECHA_DADA VARCHAR(1)
	DECLARE @CAMPOS_OBLIG_TARJ VARCHAR(1)
	DECLARE @IMPR_DESC_LINEAS VARCHAR(1)
	DECLARE @MODIF_COD_CLIENTE VARCHAR(1)
	DECLARE @VALID_PAGO_DEV_FAC VARCHAR(1)
	DECLARE @CTR_BONO VARCHAR(25)
	DECLARE @CTA_BONO VARCHAR(25)
	DECLARE @MODIF_CLNTS_CONT VARCHAR(1)
	DECLARE @DEVOLUCION_EFECTIVO VARCHAR(1)
	DECLARE @DEVOLUCION_CHEQUE VARCHAR(1)
	DECLARE @DEVOLUCION_TARJETA VARCHAR(1)
	DECLARE @DEVOLUCION_CREDITO VARCHAR(1)
	DECLARE @DEVOLUCION_VALE VARCHAR(1)
	DECLARE @DEVOLUCION_BONO VARCHAR(1)
	DECLARE @DEVOLUCION_DOLAR VARCHAR(1)
	DECLARE @LIMITAR_LINEAS VARCHAR(1)
	DECLARE @CANT_LINEAS_DOCUM INT
	DECLARE @CAPTURA_FECHA_NAC VARCHAR(1)
	DECLARE @CAPTURA_NIT VARCHAR(1)
	DECLARE @CAPTURA_TELEFONO VARCHAR(1)
	DECLARE @AUTOR_DESC_MONTO VARCHAR(1)
	DECLARE @USO_FORMULARIOS VARCHAR(1)
	DECLARE @VIS_MOD_NUM_DOC VARCHAR(1)
	DECLARE @DEV_MENU_PRINCIPAL VARCHAR(1)
	DECLARE @USAR_NOTASCREDITO VARCHAR(1)
	DECLARE @IMPRIMIR_ULT_ABONO VARCHAR(1)
	DECLARE @FACTURA_AL_APARTAR VARCHAR(1)
	DECLARE @CLIENTE_APARTADO VARCHAR(20)
	DECLARE @DESG_CIERRE_CAJERO VARCHAR(1)
	DECLARE @CONTROL_INFO_FISCAL VARCHAR(1)
	DECLARE @AUTO_CAMBIO_PRECIO VARCHAR(1)
	DECLARE @CONDPAG_VENC_APART VARCHAR(4)
	DECLARE @USA_APA_CNDPAG_CLI VARCHAR(1)
	DECLARE @CTA_VTA_APARTADO VARCHAR(25)
	DECLARE @CTR_VTA_APARTADO VARCHAR(25)
	DECLARE @CATEGORIA_CLIENTE VARCHAR(8)
	DECLARE @PORC_MIN_PRI_ABONO DECIMAL(28,8)
	DECLARE @CONTROL_CXC VARCHAR(1)
	DECLARE @CTA_DEVOL_DINERO VARCHAR(25)
	DECLARE @CTR_DEVOL_DINERO VARCHAR(25)
	DECLARE @CONSECUTIVO_DEVOL VARCHAR(10)
	DECLARE @CTA_INV_DESPACHAR VARCHAR(25)
	DECLARE @CTR_INV_DESPACHAR VARCHAR(25)
	DECLARE @PORC_DEVEFE_ANUAPA DECIMAL(28,8)
	DECLARE @CALCULAR_IMP2 VARCHAR(1)
	DECLARE @DIAS_VIGENCIA_DEV DECIMAL(28,8)
	DECLARE @USAR_CADENAS VARCHAR(1)
	DECLARE @DIAS_VIGENCIA_CERT INT
	DECLARE @TIPO_CAMBIO_CIERRE VARCHAR(1)
	DECLARE @CTR_EFECTIVO_LOCAL VARCHAR(25)
	DECLARE @CTA_EFECTIVO_LOCAL VARCHAR(25)
	DECLARE @CTR_EFECTIVO_DOLAR VARCHAR(25)
	DECLARE @CTA_EFECTIVO_DOLAR VARCHAR(25)
	DECLARE @CTR_CHEQUE VARCHAR(25)
	DECLARE @CTA_CHEQUE VARCHAR(25)
	DECLARE @CTR_NOTACREDITO VARCHAR(25)
	DECLARE @CTA_NOTACREDITO VARCHAR(25)
	DECLARE @CTR_CERTIFICADO VARCHAR(25)
	DECLARE @CTA_CERTIFICADO VARCHAR(25)
	DECLARE @CTR_CERTIF_OBSEQUI VARCHAR(25)
	DECLARE @CTA_CERTIF_OBSEQUI VARCHAR(25)
	DECLARE @CTR_CERTIF_VENCIDO VARCHAR(25)
	DECLARE @CTA_CERTIF_VENCIDO VARCHAR(25)
	DECLARE @CTR_NC_VENCIDA VARCHAR(25)
	DECLARE @CTA_NC_VENCIDA VARCHAR(25)
	DECLARE @CONTABILIZAR_DIA VARCHAR(1)
	DECLARE @CONTABILIZAR_CAJA VARCHAR(1)
	DECLARE @CONTABILIZAR_TRANS VARCHAR(1)
	DECLARE @CONTABILIZAR_PAGOS VARCHAR(1)
	DECLARE @SITIO_LOCAL VARCHAR(20)
	DECLARE @BODEGA_CENTRAL VARCHAR(4)
	DECLARE @TIPO_SITIO_LOCAL VARCHAR(1)
	DECLARE @TRASPASO_TIENDA VARCHAR(1)
	DECLARE @USUARIO_WSQM VARCHAR(100)
	DECLARE @USA_BIMONEDA VARCHAR(1)
	DECLARE @DIAS_GRACIA INT
	DECLARE @MANEJA_SERIES	VARCHAR(1)	
	DECLARE	@CIERRE_CAJERO 	VARCHAR(1) 	
	DECLARE @MODIF_INFO_FISCAL VARCHAR(1)	
	DECLARE @PORC_AUMEN_PRE	 DECIMAL (28, 8)	
	DECLARE @PORC_DISMIN_PRE DECIMAL (28, 8)	
	DECLARE @SOLO_CERT_CLIENTE VARCHAR(1)	
	DECLARE @SUBT_CRED_FISCAL INT		
	DECLARE @VALIDA_PRELECTURA VARCHAR(1)	
       	DECLARE	@LOCALIZACION	VARCHAR(8)  
       	DECLARE @MULT_CORRELATIVO VARCHAR(1)
	
	SELECT  @PUBLICADOR = SITIO_LOCAL, 
		@TIPO_SITIO_LOCAL = TIPO_SITIO_LOCAL, 
		@USUARIO_POS_WSQM = USUARIO_WSQM
	FROM INSERTED  

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM) AND @TIPO_SITIO_LOCAL = 'C'
	BEGIN
		DECLARE C_INSERTED CURSOR LOCAL FOR
		SELECT CONDICION_PAGO, TIPO_ASIENTO, PAQUETE, GRUPO_CAJERO, GRUPO_SUPERVISOR, CLIENTE_OMISION, INGRESO_CANTIDAD, IMPUESTO_INCLUIDO, DETALLE_KITS, REDONDEAR_FACTURA, FACTOR_REDONDEO, INTEGRACION_CONTA, VALIDAR_CHEQUES, PAGO_MIXTO, IMPRESION_DOBLE, MAX_FORMA_PAGO, FOTO_ARTICULO, ESQUEMA_VENDEDOR, MANEJO_LOTE, VERIFICAR_FECHA, VALIDAR_EXISTENCIAS, MODO_APLIC_ASIENTO, IMPRESION_SIMULTANEA, ACTUALIZACION_SIMULTANEA, PERMITE_REDUCCIONES, MOD_CONDICION_PAGO, LINEA_SUPERIOR1, LINEA_SUPERIOR2, LINEA_SUPERIOR3, LINEA_SUPERIOR4, LINEA_INFERIOR1, LINEA_INFERIOR2, LINEA_INFERIOR3, LINEA_INFERIOR4, IMP1_AFECTA_DESCTO, CALCULO_IMPUESTOS, AUTORIZA_PRECIO, PORC_DCTO_LINEA, PORC_DCTO_TOTAL, PORC_DCTO_LIN_SUP, PORC_DCTO_TOT_SUP, ARTICULO_APARTADO, LINEA_INFER1_APART, LINEA_INFER2_APART, LINEA_INFER3_APART, LINEA_INFER4_APART, DIAS_VENCE_APART, IMPRIMIR_PRELECTURA, NIVEL_PRECIO, MONEDA_NIVEL, USAR_NIVEL_CLIENTE, USAR_BLOQUEO_AUTOM, TIEMPO_BLOQUEO, CTR_ABONOS, CTA_ABONOS, CTR_CIERRE_CREDITO, CTA_CIERRE_CREDITO, CTR_CIERRE_DEBITO, CTA_CIERRE_DEBITO, CTR_DIFER_INGRESO, CTA_DIFER_INGRESO, CTR_DIFER_EGRESO, CTA_DIFER_EGRESO, TIPO_CONTA_OMISION, CTR_OTROS_INGRESOS, CTA_OTROS_INGRESOS, USAR_FECHA_DADA, CAMPOS_OBLIG_TARJ, IMPR_DESC_LINEAS, MODIF_COD_CLIENTE, VALID_PAGO_DEV_FAC, CTR_BONO, CTA_BONO, MODIF_CLNTS_CONT, DEVOLUCION_EFECTIVO, DEVOLUCION_CHEQUE, DEVOLUCION_TARJETA, DEVOLUCION_CREDITO, DEVOLUCION_VALE, DEVOLUCION_BONO, DEVOLUCION_DOLAR, LIMITAR_LINEAS, CANT_LINEAS_DOCUM, CAPTURA_FECHA_NAC, CAPTURA_NIT, CAPTURA_TELEFONO, AUTOR_DESC_MONTO, USO_FORMULARIOS, VIS_MOD_NUM_DOC, DEV_MENU_PRINCIPAL, USAR_NOTASCREDITO, IMPRIMIR_ULT_ABONO, FACTURA_AL_APARTAR, CLIENTE_APARTADO, DESG_CIERRE_CAJERO, CONTROL_INFO_FISCAL, AUTO_CAMBIO_PRECIO, CONDPAG_VENC_APART, USA_APA_CNDPAG_CLI, CTA_VTA_APARTADO, CTR_VTA_APARTADO, CATEGORIA_CLIENTE, PORC_MIN_PRI_ABONO, CONTROL_CXC, CTA_DEVOL_DINERO, CTR_DEVOL_DINERO, CONSECUTIVO_DEVOL, CTA_INV_DESPACHAR, CTR_INV_DESPACHAR, PORC_DEVEFE_ANUAPA, CALCULAR_IMP2, DIAS_VIGENCIA_DEV, USAR_CADENAS, DIAS_VIGENCIA_CERT, TIPO_CAMBIO_CIERRE, CTR_EFECTIVO_LOCAL, CTA_EFECTIVO_LOCAL, CTR_EFECTIVO_DOLAR, CTA_EFECTIVO_DOLAR, CTR_CHEQUE, CTA_CHEQUE, CTR_NOTACREDITO, CTA_NOTACREDITO, CTR_CERTIFICADO, CTA_CERTIFICADO, CTR_CERTIF_OBSEQUI, CTA_CERTIF_OBSEQUI, CTR_CERTIF_VENCIDO, CTA_CERTIF_VENCIDO, CTR_NC_VENCIDA, CTA_NC_VENCIDA, CONTABILIZAR_DIA, CONTABILIZAR_CAJA, CONTABILIZAR_TRANS, CONTABILIZAR_PAGOS, SITIO_LOCAL, BODEGA_CENTRAL, TIPO_SITIO_LOCAL, TRASPASO_TIENDA, USUARIO_WSQM, USA_BIMONEDA,DIAS_GRACIA,MANEJA_SERIES,CIERRE_CAJERO,MODIF_INFO_FISCAL,PORC_AUMEN_PRE,PORC_DISMIN_PRE,SOLO_CERT_CLIENTE,SUBT_CRED_FISCAL,VALIDA_PRELECTURA,LOCALIZACION,MULT_CORRELATIVO
		FROM INSERTED i
		
			
		OPEN C_INSERTED	
		FETCH NEXT FROM C_INSERTED INTO
		@CONDICION_PAGO, @TIPO_ASIENTO, @PAQUETE, @GRUPO_CAJERO, @GRUPO_SUPERVISOR, @CLIENTE_OMISION, @INGRESO_CANTIDAD, @IMPUESTO_INCLUIDO, @DETALLE_KITS, @REDONDEAR_FACTURA, @FACTOR_REDONDEO, @INTEGRACION_CONTA, @VALIDAR_CHEQUES, @PAGO_MIXTO, @IMPRESION_DOBLE, @MAX_FORMA_PAGO, @FOTO_ARTICULO, @ESQUEMA_VENDEDOR, @MANEJO_LOTE, @VERIFICAR_FECHA, @VALIDAR_EXISTENCIAS, @MODO_APLIC_ASIENTO, @IMPRESION_SIMULTANEA, @ACTUALIZACION_SIMULTANEA, @PERMITE_REDUCCIONES, @MOD_CONDICION_PAGO, @LINEA_SUPERIOR1, @LINEA_SUPERIOR2, @LINEA_SUPERIOR3, @LINEA_SUPERIOR4, @LINEA_INFERIOR1, @LINEA_INFERIOR2, @LINEA_INFERIOR3, @LINEA_INFERIOR4, @IMP1_AFECTA_DESCTO, @CALCULO_IMPUESTOS, @AUTORIZA_PRECIO, @PORC_DCTO_LINEA, @PORC_DCTO_TOTAL, @PORC_DCTO_LIN_SUP, @PORC_DCTO_TOT_SUP, @ARTICULO_APARTADO, @LINEA_INFER1_APART, @LINEA_INFER2_APART, @LINEA_INFER3_APART, @LINEA_INFER4_APART, @DIAS_VENCE_APART, @IMPRIMIR_PRELECTURA, @NIVEL_PRECIO, @MONEDA_NIVEL, @USAR_NIVEL_CLIENTE, @USAR_BLOQUEO_AUTOM, @TIEMPO_BLOQUEO, @CTR_ABONOS, @CTA_ABONOS, @CTR_CIERRE_CREDITO, @CTA_CIERRE_CREDITO, @CTR_CIERRE_DEBITO, @CTA_CIERRE_DEBITO, @CTR_DIFER_INGRESO, @CTA_DIFER_INGRESO, @CTR_DIFER_EGRESO, @CTA_DIFER_EGRESO, @TIPO_CONTA_OMISION, @CTR_OTROS_INGRESOS, @CTA_OTROS_INGRESOS, @USAR_FECHA_DADA, @CAMPOS_OBLIG_TARJ, @IMPR_DESC_LINEAS, @MODIF_COD_CLIENTE, @VALID_PAGO_DEV_FAC, @CTR_BONO, @CTA_BONO, @MODIF_CLNTS_CONT, @DEVOLUCION_EFECTIVO, @DEVOLUCION_CHEQUE, @DEVOLUCION_TARJETA, @DEVOLUCION_CREDITO, @DEVOLUCION_VALE, @DEVOLUCION_BONO, @DEVOLUCION_DOLAR, @LIMITAR_LINEAS, @CANT_LINEAS_DOCUM, @CAPTURA_FECHA_NAC, @CAPTURA_NIT, @CAPTURA_TELEFONO, @AUTOR_DESC_MONTO, @USO_FORMULARIOS, @VIS_MOD_NUM_DOC, @DEV_MENU_PRINCIPAL, @USAR_NOTASCREDITO, @IMPRIMIR_ULT_ABONO, @FACTURA_AL_APARTAR, @CLIENTE_APARTADO, @DESG_CIERRE_CAJERO, @CONTROL_INFO_FISCAL, @AUTO_CAMBIO_PRECIO, @CONDPAG_VENC_APART, @USA_APA_CNDPAG_CLI, @CTA_VTA_APARTADO, @CTR_VTA_APARTADO, @CATEGORIA_CLIENTE, @PORC_MIN_PRI_ABONO, @CONTROL_CXC, @CTA_DEVOL_DINERO, @CTR_DEVOL_DINERO, @CONSECUTIVO_DEVOL, @CTA_INV_DESPACHAR, @CTR_INV_DESPACHAR, @PORC_DEVEFE_ANUAPA, @CALCULAR_IMP2, @DIAS_VIGENCIA_DEV, @USAR_CADENAS, @DIAS_VIGENCIA_CERT, @TIPO_CAMBIO_CIERRE, @CTR_EFECTIVO_LOCAL, @CTA_EFECTIVO_LOCAL, @CTR_EFECTIVO_DOLAR, @CTA_EFECTIVO_DOLAR, @CTR_CHEQUE, @CTA_CHEQUE, @CTR_NOTACREDITO, @CTA_NOTACREDITO, @CTR_CERTIFICADO, @CTA_CERTIFICADO, @CTR_CERTIF_OBSEQUI, @CTA_CERTIF_OBSEQUI, @CTR_CERTIF_VENCIDO, @CTA_CERTIF_VENCIDO, @CTR_NC_VENCIDA, @CTA_NC_VENCIDA, @CONTABILIZAR_DIA, @CONTABILIZAR_CAJA, @CONTABILIZAR_TRANS, @CONTABILIZAR_PAGOS, @SITIO_LOCAL, @BODEGA_CENTRAL, @TIPO_SITIO_LOCAL, @TRASPASO_TIENDA, @USUARIO_WSQM, @USA_BIMONEDA,@DIAS_GRACIA,@MANEJA_SERIES,@CIERRE_CAJERO,@MODIF_INFO_FISCAL,@PORC_AUMEN_PRE,@PORC_DISMIN_PRE,@SOLO_CERT_CLIENTE,@SUBT_CRED_FISCAL,@VALIDA_PRELECTURA,@LOCALIZACION,@MULT_CORRELATIVO
		SET @ERROR = 0
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS =
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<GLOBALES_POS>' +
				'<CONDICION_PAGO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CONDICION_PAGO) + '</CONDICION_PAGO>' +
				'<TIPO_ASIENTO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_ASIENTO) + '</TIPO_ASIENTO>' +
				'<PAQUETE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@PAQUETE) + '</PAQUETE>' +
				'<GRUPO_CAJERO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@GRUPO_CAJERO) + '</GRUPO_CAJERO>' +
				'<GRUPO_SUPERVISOR Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@GRUPO_SUPERVISOR) + '</GRUPO_SUPERVISOR>' +
				'<CLIENTE_OMISION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CLIENTE_OMISION) + '</CLIENTE_OMISION>' +
				'<INGRESO_CANTIDAD Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@INGRESO_CANTIDAD) + '</INGRESO_CANTIDAD>' +
				'<IMPUESTO_INCLUIDO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@IMPUESTO_INCLUIDO) + '</IMPUESTO_INCLUIDO>' +
				'<DETALLE_KITS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DETALLE_KITS) + '</DETALLE_KITS>' +
				'<REDONDEAR_FACTURA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@REDONDEAR_FACTURA) + '</REDONDEAR_FACTURA>' +
				'<FACTOR_REDONDEO Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@FACTOR_REDONDEO) + '</FACTOR_REDONDEO>' +
				'<INTEGRACION_CONTA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@INTEGRACION_CONTA) + '</INTEGRACION_CONTA>' +
				'<VALIDAR_CHEQUES Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@VALIDAR_CHEQUES) + '</VALIDAR_CHEQUES>' +
				'<PAGO_MIXTO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@PAGO_MIXTO) + '</PAGO_MIXTO>' +
				'<IMPRESION_DOBLE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@IMPRESION_DOBLE) + '</IMPRESION_DOBLE>' +
				'<MAX_FORMA_PAGO Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@MAX_FORMA_PAGO) + '</MAX_FORMA_PAGO>' +
				'<FOTO_ARTICULO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@FOTO_ARTICULO) + '</FOTO_ARTICULO>' +
				'<ESQUEMA_VENDEDOR Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ESQUEMA_VENDEDOR) + '</ESQUEMA_VENDEDOR>' +
				'<MANEJO_LOTE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@MANEJO_LOTE) + '</MANEJO_LOTE>' +
				'<VERIFICAR_FECHA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@VERIFICAR_FECHA) + '</VERIFICAR_FECHA>' +
				'<VALIDAR_EXISTENCIAS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@VALIDAR_EXISTENCIAS) + '</VALIDAR_EXISTENCIAS>' +
				'<MODO_APLIC_ASIENTO Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@MODO_APLIC_ASIENTO) + '</MODO_APLIC_ASIENTO>' +
				'<IMPRESION_SIMULTANEA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@IMPRESION_SIMULTANEA) + '</IMPRESION_SIMULTANEA>' +
				'<ACTUALIZACION_SIMULTANEA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ACTUALIZACION_SIMULTANEA) + '</ACTUALIZACION_SIMULTANEA>' +
				'<PERMITE_REDUCCIONES Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@PERMITE_REDUCCIONES) + '</PERMITE_REDUCCIONES>' +
				'<MOD_CONDICION_PAGO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@MOD_CONDICION_PAGO) + '</MOD_CONDICION_PAGO>' +
				'<LINEA_SUPERIOR1 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@LINEA_SUPERIOR1) + '</LINEA_SUPERIOR1>' +
				'<LINEA_SUPERIOR2 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@LINEA_SUPERIOR2) + '</LINEA_SUPERIOR2>' +
				'<LINEA_SUPERIOR3 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@LINEA_SUPERIOR3) + '</LINEA_SUPERIOR3>' +
				'<LINEA_SUPERIOR4 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@LINEA_SUPERIOR4) + '</LINEA_SUPERIOR4>' +
				'<LINEA_INFERIOR1 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@LINEA_INFERIOR1) + '</LINEA_INFERIOR1>' +
				'<LINEA_INFERIOR2 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@LINEA_INFERIOR2) + '</LINEA_INFERIOR2>' +
				'<LINEA_INFERIOR3 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@LINEA_INFERIOR3) + '</LINEA_INFERIOR3>' +
				'<LINEA_INFERIOR4 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@LINEA_INFERIOR4) + '</LINEA_INFERIOR4>'

			SET @PARAMETROS2 =								
				'<IMP1_AFECTA_DESCTO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@IMP1_AFECTA_DESCTO) + '</IMP1_AFECTA_DESCTO>' +
				'<CALCULO_IMPUESTOS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CALCULO_IMPUESTOS) + '</CALCULO_IMPUESTOS>' +
				'<AUTORIZA_PRECIO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@AUTORIZA_PRECIO) + '</AUTORIZA_PRECIO>' +
				'<PORC_DCTO_LINEA Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@PORC_DCTO_LINEA) + '</PORC_DCTO_LINEA>' +
				'<PORC_DCTO_TOTAL Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@PORC_DCTO_TOTAL) + '</PORC_DCTO_TOTAL>' +
				'<PORC_DCTO_LIN_SUP Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@PORC_DCTO_LIN_SUP) + '</PORC_DCTO_LIN_SUP>' +
				'<PORC_DCTO_TOT_SUP Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@PORC_DCTO_TOT_SUP) + '</PORC_DCTO_TOT_SUP>' +
				'<ARTICULO_APARTADO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ARTICULO_APARTADO) + '</ARTICULO_APARTADO>' +
				'<LINEA_INFER1_APART Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@LINEA_INFER1_APART) + '</LINEA_INFER1_APART>' +
				'<LINEA_INFER2_APART Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@LINEA_INFER2_APART) + '</LINEA_INFER2_APART>' +
				'<LINEA_INFER3_APART Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@LINEA_INFER3_APART) + '</LINEA_INFER3_APART>' +
				'<LINEA_INFER4_APART Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@LINEA_INFER4_APART) + '</LINEA_INFER4_APART>' +
				'<DIAS_VENCE_APART Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@DIAS_VENCE_APART) + '</DIAS_VENCE_APART>' +
				'<IMPRIMIR_PRELECTURA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@IMPRIMIR_PRELECTURA) + '</IMPRIMIR_PRELECTURA>' +
				'<NIVEL_PRECIO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NIVEL_PRECIO) + '</NIVEL_PRECIO>' +
				'<MONEDA_NIVEL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@MONEDA_NIVEL) + '</MONEDA_NIVEL>' +
				'<USAR_NIVEL_CLIENTE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USAR_NIVEL_CLIENTE) + '</USAR_NIVEL_CLIENTE>' +
				'<USAR_BLOQUEO_AUTOM Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USAR_BLOQUEO_AUTOM) + '</USAR_BLOQUEO_AUTOM>' +
				'<TIEMPO_BLOQUEO Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@TIEMPO_BLOQUEO) + '</TIEMPO_BLOQUEO>' +
				'<CTR_ABONOS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_ABONOS) + '</CTR_ABONOS>' +
				'<CTA_ABONOS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_ABONOS) + '</CTA_ABONOS>' +
				'<CTR_CIERRE_CREDITO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_CIERRE_CREDITO) + '</CTR_CIERRE_CREDITO>' +
				'<CTA_CIERRE_CREDITO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_CIERRE_CREDITO) + '</CTA_CIERRE_CREDITO>' +
				'<CTR_CIERRE_DEBITO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_CIERRE_DEBITO) + '</CTR_CIERRE_DEBITO>' +
				'<CTA_CIERRE_DEBITO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_CIERRE_DEBITO) + '</CTA_CIERRE_DEBITO>' +
				'<CTR_DIFER_INGRESO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_DIFER_INGRESO) + '</CTR_DIFER_INGRESO>' +
				'<CTA_DIFER_INGRESO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_DIFER_INGRESO) + '</CTA_DIFER_INGRESO>' +
				'<CTR_DIFER_EGRESO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_DIFER_EGRESO) + '</CTR_DIFER_EGRESO>' +
				'<CTA_DIFER_EGRESO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_DIFER_EGRESO) + '</CTA_DIFER_EGRESO>' +
				'<TIPO_CONTA_OMISION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_CONTA_OMISION) + '</TIPO_CONTA_OMISION>' +
				'<CTR_OTROS_INGRESOS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_OTROS_INGRESOS) + '</CTR_OTROS_INGRESOS>' +
				'<CTA_OTROS_INGRESOS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_OTROS_INGRESOS) + '</CTA_OTROS_INGRESOS>' +
				'<USAR_FECHA_DADA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USAR_FECHA_DADA) + '</USAR_FECHA_DADA>' +
				'<CAMPOS_OBLIG_TARJ Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CAMPOS_OBLIG_TARJ) + '</CAMPOS_OBLIG_TARJ>' +
				'<IMPR_DESC_LINEAS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@IMPR_DESC_LINEAS) + '</IMPR_DESC_LINEAS>' +
				'<MODIF_COD_CLIENTE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@MODIF_COD_CLIENTE) + '</MODIF_COD_CLIENTE>' +
				'<VALID_PAGO_DEV_FAC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@VALID_PAGO_DEV_FAC) + '</VALID_PAGO_DEV_FAC>' +
				'<CTR_BONO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_BONO) + '</CTR_BONO>' +
				'<CTA_BONO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_BONO) + '</CTA_BONO>' +
				'<MODIF_CLNTS_CONT Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@MODIF_CLNTS_CONT) + '</MODIF_CLNTS_CONT>' +
				'<DEVOLUCION_EFECTIVO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DEVOLUCION_EFECTIVO) + '</DEVOLUCION_EFECTIVO>' +
				'<DEVOLUCION_CHEQUE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DEVOLUCION_CHEQUE) + '</DEVOLUCION_CHEQUE>' +
				'<DEVOLUCION_TARJETA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DEVOLUCION_TARJETA) + '</DEVOLUCION_TARJETA>' +
				'<DEVOLUCION_CREDITO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DEVOLUCION_CREDITO) + '</DEVOLUCION_CREDITO>' +
				'<DEVOLUCION_VALE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DEVOLUCION_VALE) + '</DEVOLUCION_VALE>' +
				'<DEVOLUCION_BONO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DEVOLUCION_BONO) + '</DEVOLUCION_BONO>' +
				'<DEVOLUCION_DOLAR Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DEVOLUCION_DOLAR) + '</DEVOLUCION_DOLAR>'
				
			SET @PARAMETROS3 =								
				'<LIMITAR_LINEAS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@LIMITAR_LINEAS) + '</LIMITAR_LINEAS>' +
				'<CANT_LINEAS_DOCUM Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@CANT_LINEAS_DOCUM) + '</CANT_LINEAS_DOCUM>' +
				'<CAPTURA_FECHA_NAC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CAPTURA_FECHA_NAC) + '</CAPTURA_FECHA_NAC>' +
				'<CAPTURA_NIT Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CAPTURA_NIT) + '</CAPTURA_NIT>' +
				'<CAPTURA_TELEFONO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CAPTURA_TELEFONO) + '</CAPTURA_TELEFONO>' +
				'<AUTOR_DESC_MONTO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@AUTOR_DESC_MONTO) + '</AUTOR_DESC_MONTO>' +
				'<USO_FORMULARIOS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USO_FORMULARIOS) + '</USO_FORMULARIOS>' +
				'<VIS_MOD_NUM_DOC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@VIS_MOD_NUM_DOC) + '</VIS_MOD_NUM_DOC>' +
				'<DEV_MENU_PRINCIPAL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DEV_MENU_PRINCIPAL) + '</DEV_MENU_PRINCIPAL>' +
				'<USAR_NOTASCREDITO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USAR_NOTASCREDITO) + '</USAR_NOTASCREDITO>' +
				'<IMPRIMIR_ULT_ABONO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@IMPRIMIR_ULT_ABONO) + '</IMPRIMIR_ULT_ABONO>' +
				'<FACTURA_AL_APARTAR Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@FACTURA_AL_APARTAR) + '</FACTURA_AL_APARTAR>' +
				'<CLIENTE_APARTADO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CLIENTE_APARTADO) + '</CLIENTE_APARTADO>' +
				'<DESG_CIERRE_CAJERO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DESG_CIERRE_CAJERO) + '</DESG_CIERRE_CAJERO>' +
				'<CONTROL_INFO_FISCAL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CONTROL_INFO_FISCAL) + '</CONTROL_INFO_FISCAL>' +
				'<AUTO_CAMBIO_PRECIO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@AUTO_CAMBIO_PRECIO) + '</AUTO_CAMBIO_PRECIO>' +
				'<CONDPAG_VENC_APART Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CONDPAG_VENC_APART) + '</CONDPAG_VENC_APART>' +
				'<USA_APA_CNDPAG_CLI Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USA_APA_CNDPAG_CLI) + '</USA_APA_CNDPAG_CLI>' +
				'<CTA_VTA_APARTADO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_VTA_APARTADO) + '</CTA_VTA_APARTADO>' +
				'<CTR_VTA_APARTADO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_VTA_APARTADO) + '</CTR_VTA_APARTADO>' +
				'<CATEGORIA_CLIENTE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CATEGORIA_CLIENTE) + '</CATEGORIA_CLIENTE>' +
				'<PORC_MIN_PRI_ABONO Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@PORC_MIN_PRI_ABONO) + '</PORC_MIN_PRI_ABONO>' +
				'<CONTROL_CXC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CONTROL_CXC) + '</CONTROL_CXC>' +
				'<CTA_DEVOL_DINERO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_DEVOL_DINERO) + '</CTA_DEVOL_DINERO>' +
				'<CTR_DEVOL_DINERO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_DEVOL_DINERO) + '</CTR_DEVOL_DINERO>' +
				'<CONSECUTIVO_DEVOL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CONSECUTIVO_DEVOL) + '</CONSECUTIVO_DEVOL>' +
				'<CTA_INV_DESPACHAR Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_INV_DESPACHAR) + '</CTA_INV_DESPACHAR>' +
				'<CTR_INV_DESPACHAR Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_INV_DESPACHAR) + '</CTR_INV_DESPACHAR>' +
				'<PORC_DEVEFE_ANUAPA Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@PORC_DEVEFE_ANUAPA) + '</PORC_DEVEFE_ANUAPA>' +
				'<CALCULAR_IMP2 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CALCULAR_IMP2) + '</CALCULAR_IMP2>' +
				'<DIAS_VIGENCIA_DEV Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@DIAS_VIGENCIA_DEV) + '</DIAS_VIGENCIA_DEV>' +
				'<USAR_CADENAS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USAR_CADENAS) + '</USAR_CADENAS>' +
				'<DIAS_VIGENCIA_CERT Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@DIAS_VIGENCIA_CERT) + '</DIAS_VIGENCIA_CERT>' +
				'<TIPO_CAMBIO_CIERRE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_CAMBIO_CIERRE) + '</TIPO_CAMBIO_CIERRE>'
				
			SET @PARAMETROS4 =				
				'<CTR_EFECTIVO_LOCAL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_EFECTIVO_LOCAL) + '</CTR_EFECTIVO_LOCAL>' +
				'<CTA_EFECTIVO_LOCAL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_EFECTIVO_LOCAL) + '</CTA_EFECTIVO_LOCAL>' +
				'<CTR_EFECTIVO_DOLAR Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_EFECTIVO_DOLAR) + '</CTR_EFECTIVO_DOLAR>' +
				'<CTA_EFECTIVO_DOLAR Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_EFECTIVO_DOLAR) + '</CTA_EFECTIVO_DOLAR>' +
				'<CTR_CHEQUE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_CHEQUE) + '</CTR_CHEQUE>' +
				'<CTA_CHEQUE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_CHEQUE) + '</CTA_CHEQUE>' +
				'<CTR_NOTACREDITO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_NOTACREDITO) + '</CTR_NOTACREDITO>' +
				'<CTA_NOTACREDITO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_NOTACREDITO) + '</CTA_NOTACREDITO>' +
				'<CTR_CERTIFICADO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_CERTIFICADO) + '</CTR_CERTIFICADO>' +
				'<CTA_CERTIFICADO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_CERTIFICADO) + '</CTA_CERTIFICADO>' +
				'<CTR_CERTIF_OBSEQUI Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_CERTIF_OBSEQUI) + '</CTR_CERTIF_OBSEQUI>' +
				'<CTA_CERTIF_OBSEQUI Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_CERTIF_OBSEQUI) + '</CTA_CERTIF_OBSEQUI>' +
				'<CTR_CERTIF_VENCIDO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_CERTIF_VENCIDO) + '</CTR_CERTIF_VENCIDO>' +
				'<CTA_CERTIF_VENCIDO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_CERTIF_VENCIDO) + '</CTA_CERTIF_VENCIDO>' +
				'<CTR_NC_VENCIDA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_NC_VENCIDA) + '</CTR_NC_VENCIDA>' +
				'<CTA_NC_VENCIDA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_NC_VENCIDA) + '</CTA_NC_VENCIDA>' +
				'<CONTABILIZAR_DIA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CONTABILIZAR_DIA) + '</CONTABILIZAR_DIA>' +
				'<CONTABILIZAR_CAJA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CONTABILIZAR_CAJA) + '</CONTABILIZAR_CAJA>' +
				'<CONTABILIZAR_TRANS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CONTABILIZAR_TRANS) + '</CONTABILIZAR_TRANS>' +
				'<CONTABILIZAR_PAGOS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CONTABILIZAR_PAGOS) + '</CONTABILIZAR_PAGOS>' +
				'<SITIO_LOCAL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@SITIO_LOCAL) + '</SITIO_LOCAL>' +
				'<BODEGA_CENTRAL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@BODEGA_CENTRAL) + '</BODEGA_CENTRAL>' +
				'<TIPO_SITIO_LOCAL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_SITIO_LOCAL) + '</TIPO_SITIO_LOCAL>' +
				'<TRASPASO_TIENDA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TRASPASO_TIENDA) + '</TRASPASO_TIENDA>' +
				'<USUARIO_WSQM Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USUARIO_WSQM) + '</USUARIO_WSQM>' +
				'<USA_BIMONEDA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USA_BIMONEDA) + '</USA_BIMONEDA>' +
				'<DIAS_GRACIA Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@DIAS_GRACIA) + '</DIAS_GRACIA>' +				
				'<MANEJA_SERIES Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@MANEJA_SERIES) + '</MANEJA_SERIES>' +
				'<CIERRE_CAJERO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CIERRE_CAJERO) + '</CIERRE_CAJERO>' +
				'<MODIF_INFO_FISCAL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@MODIF_INFO_FISCAL) + '</MODIF_INFO_FISCAL>' +
				'<PORC_AUMEN_PRE Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@PORC_AUMEN_PRE) + '</PORC_AUMEN_PRE>' +
				'<PORC_DISMIN_PRE Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@PORC_DISMIN_PRE) + '</PORC_DISMIN_PRE>' +
				'<SOLO_CERT_CLIENTE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@SOLO_CERT_CLIENTE) + '</SOLO_CERT_CLIENTE>' +
				'<SUBT_CRED_FISCAL Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@SUBT_CRED_FISCAL) + '</SUBT_CRED_FISCAL>' +
				'<VALIDA_PRELECTURA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@VALIDA_PRELECTURA) + '</VALIDA_PRELECTURA>' +
				'<LOCALIZACION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@LOCALIZACION) + '</LOCALIZACION>' +
				'<MULT_CORRELATIVO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@MULT_CORRELATIVO) + '</MULT_CORRELATIVO>' +				
				'</GLOBALES_POS>'
			-- Inserta la solicitud correspondiente
			
			EXECUTE  ('ERPADMIN.POS_InsertarSolicitud ''' + @PUBLICADOR + ''', ''GLOBALESPOSPOS600'', ''INSERTA'', ''' + @PARAMETROS + @PARAMETROS2 + @PARAMETROS3 + @PARAMETROS4 + ''', 0, ''''')
			
			FETCH NEXT FROM C_INSERTED INTO
			@CONDICION_PAGO, @TIPO_ASIENTO, @PAQUETE, @GRUPO_CAJERO, @GRUPO_SUPERVISOR, @CLIENTE_OMISION, @INGRESO_CANTIDAD, @IMPUESTO_INCLUIDO, @DETALLE_KITS, @REDONDEAR_FACTURA, @FACTOR_REDONDEO, @INTEGRACION_CONTA, @VALIDAR_CHEQUES, @PAGO_MIXTO, @IMPRESION_DOBLE, @MAX_FORMA_PAGO, @FOTO_ARTICULO, @ESQUEMA_VENDEDOR, @MANEJO_LOTE, @VERIFICAR_FECHA, @VALIDAR_EXISTENCIAS, @MODO_APLIC_ASIENTO, @IMPRESION_SIMULTANEA, @ACTUALIZACION_SIMULTANEA, @PERMITE_REDUCCIONES, @MOD_CONDICION_PAGO, @LINEA_SUPERIOR1, @LINEA_SUPERIOR2, @LINEA_SUPERIOR3, @LINEA_SUPERIOR4, @LINEA_INFERIOR1, @LINEA_INFERIOR2, @LINEA_INFERIOR3, @LINEA_INFERIOR4, @IMP1_AFECTA_DESCTO, @CALCULO_IMPUESTOS, @AUTORIZA_PRECIO, @PORC_DCTO_LINEA, @PORC_DCTO_TOTAL, @PORC_DCTO_LIN_SUP, @PORC_DCTO_TOT_SUP, @ARTICULO_APARTADO, @LINEA_INFER1_APART, @LINEA_INFER2_APART, @LINEA_INFER3_APART, @LINEA_INFER4_APART, @DIAS_VENCE_APART, @IMPRIMIR_PRELECTURA, @NIVEL_PRECIO, @MONEDA_NIVEL, @USAR_NIVEL_CLIENTE, @USAR_BLOQUEO_AUTOM, @TIEMPO_BLOQUEO, @CTR_ABONOS, @CTA_ABONOS, @CTR_CIERRE_CREDITO, @CTA_CIERRE_CREDITO, @CTR_CIERRE_DEBITO, @CTA_CIERRE_DEBITO, @CTR_DIFER_INGRESO, @CTA_DIFER_INGRESO, @CTR_DIFER_EGRESO, @CTA_DIFER_EGRESO, @TIPO_CONTA_OMISION, @CTR_OTROS_INGRESOS, @CTA_OTROS_INGRESOS, @USAR_FECHA_DADA, @CAMPOS_OBLIG_TARJ, @IMPR_DESC_LINEAS, @MODIF_COD_CLIENTE, @VALID_PAGO_DEV_FAC, @CTR_BONO, @CTA_BONO, @MODIF_CLNTS_CONT, @DEVOLUCION_EFECTIVO, @DEVOLUCION_CHEQUE, @DEVOLUCION_TARJETA, @DEVOLUCION_CREDITO, @DEVOLUCION_VALE, @DEVOLUCION_BONO, @DEVOLUCION_DOLAR, @LIMITAR_LINEAS, @CANT_LINEAS_DOCUM, @CAPTURA_FECHA_NAC, @CAPTURA_NIT, @CAPTURA_TELEFONO, @AUTOR_DESC_MONTO, @USO_FORMULARIOS, @VIS_MOD_NUM_DOC, @DEV_MENU_PRINCIPAL, @USAR_NOTASCREDITO, @IMPRIMIR_ULT_ABONO, @FACTURA_AL_APARTAR, @CLIENTE_APARTADO, @DESG_CIERRE_CAJERO, @CONTROL_INFO_FISCAL, @AUTO_CAMBIO_PRECIO, @CONDPAG_VENC_APART, @USA_APA_CNDPAG_CLI, @CTA_VTA_APARTADO, @CTR_VTA_APARTADO, @CATEGORIA_CLIENTE, @PORC_MIN_PRI_ABONO, @CONTROL_CXC, @CTA_DEVOL_DINERO, @CTR_DEVOL_DINERO, @CONSECUTIVO_DEVOL, @CTA_INV_DESPACHAR, @CTR_INV_DESPACHAR, @PORC_DEVEFE_ANUAPA, @CALCULAR_IMP2, @DIAS_VIGENCIA_DEV, @USAR_CADENAS, @DIAS_VIGENCIA_CERT, @TIPO_CAMBIO_CIERRE, @CTR_EFECTIVO_LOCAL, @CTA_EFECTIVO_LOCAL, @CTR_EFECTIVO_DOLAR, @CTA_EFECTIVO_DOLAR, @CTR_CHEQUE, @CTA_CHEQUE, @CTR_NOTACREDITO, @CTA_NOTACREDITO, @CTR_CERTIFICADO, @CTA_CERTIFICADO, @CTR_CERTIF_OBSEQUI, @CTA_CERTIF_OBSEQUI, @CTR_CERTIF_VENCIDO, @CTA_CERTIF_VENCIDO, @CTR_NC_VENCIDA, @CTA_NC_VENCIDA, @CONTABILIZAR_DIA, @CONTABILIZAR_CAJA, @CONTABILIZAR_TRANS, @CONTABILIZAR_PAGOS, @SITIO_LOCAL, @BODEGA_CENTRAL, @TIPO_SITIO_LOCAL, @TRASPASO_TIENDA, @USUARIO_WSQM, @USA_BIMONEDA,@DIAS_GRACIA,@MANEJA_SERIES,@CIERRE_CAJERO,@MODIF_INFO_FISCAL,@PORC_AUMEN_PRE,@PORC_DISMIN_PRE,@SOLO_CERT_CLIENTE,@SUBT_CRED_FISCAL,@VALIDA_PRELECTURA,@LOCALIZACION,@MULT_CORRELATIVO
		END
		CLOSE C_INSERTED
    		DEALLOCATE C_INSERTED
	END
	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla GLOBALES_POS.',16,1 )
	END
END
;




CREATE TRIGGER $$Compania$$.GLOBALES_POS_POS_DEL
ON $$Compania$$.GLOBALES_POS
FOR DELETE
AS
BEGIN   	
    DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @PARAMETROS2 VARCHAR(8000)
	DECLARE @PARAMETROS3 VARCHAR(8000)	
	DECLARE @PARAMETROS4 VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @CONDICION_PAGO VARCHAR(4)
	DECLARE @TIPO_ASIENTO VARCHAR(4)
	DECLARE @PAQUETE VARCHAR(4)
	DECLARE @GRUPO_CAJERO VARCHAR(25)
	DECLARE @GRUPO_SUPERVISOR VARCHAR(25)
	DECLARE @CLIENTE_OMISION VARCHAR(20)
	DECLARE @INGRESO_CANTIDAD VARCHAR(1)
	DECLARE @IMPUESTO_INCLUIDO VARCHAR(1)
	DECLARE @DETALLE_KITS VARCHAR(1)
	DECLARE @REDONDEAR_FACTURA VARCHAR(1)
	DECLARE @FACTOR_REDONDEO DECIMAL(28,8)
	DECLARE @INTEGRACION_CONTA VARCHAR(1)
	DECLARE @VALIDAR_CHEQUES VARCHAR(1)
	DECLARE @PAGO_MIXTO VARCHAR(1)
	DECLARE @IMPRESION_DOBLE VARCHAR(1)
	DECLARE @MAX_FORMA_PAGO INT
	DECLARE @FOTO_ARTICULO VARCHAR(1)
	DECLARE @ESQUEMA_VENDEDOR VARCHAR(1)
	DECLARE @MANEJO_LOTE VARCHAR(1)
	DECLARE @VERIFICAR_FECHA VARCHAR(1)
	DECLARE @VALIDAR_EXISTENCIAS VARCHAR(1)
	DECLARE @MODO_APLIC_ASIENTO INT
	DECLARE @IMPRESION_SIMULTANEA VARCHAR(1)
	DECLARE @ACTUALIZACION_SIMULTANEA VARCHAR(1)
	DECLARE @PERMITE_REDUCCIONES VARCHAR(1)
	DECLARE @MOD_CONDICION_PAGO VARCHAR(1)
	DECLARE @LINEA_SUPERIOR1 VARCHAR(254)
	DECLARE @LINEA_SUPERIOR2 VARCHAR(254)
	DECLARE @LINEA_SUPERIOR3 VARCHAR(254)
	DECLARE @LINEA_SUPERIOR4 VARCHAR(254)
	DECLARE @LINEA_INFERIOR1 VARCHAR(254)
	DECLARE @LINEA_INFERIOR2 VARCHAR(254)
	DECLARE @LINEA_INFERIOR3 VARCHAR(254)
	DECLARE @LINEA_INFERIOR4 VARCHAR(254)
	DECLARE @IMP1_AFECTA_DESCTO VARCHAR(1)
	DECLARE @CALCULO_IMPUESTOS VARCHAR(1)
	DECLARE @AUTORIZA_PRECIO VARCHAR(1)
	DECLARE @PORC_DCTO_LINEA DECIMAL(28,8)
	DECLARE @PORC_DCTO_TOTAL DECIMAL(28,8)
	DECLARE @PORC_DCTO_LIN_SUP DECIMAL(28,8)
	DECLARE @PORC_DCTO_TOT_SUP DECIMAL(28,8)
	DECLARE @ARTICULO_APARTADO VARCHAR(20)
	DECLARE @LINEA_INFER1_APART VARCHAR(40)
	DECLARE @LINEA_INFER2_APART VARCHAR(40)
	DECLARE @LINEA_INFER3_APART VARCHAR(40)
	DECLARE @LINEA_INFER4_APART VARCHAR(40)
	DECLARE @DIAS_VENCE_APART INT
	DECLARE @IMPRIMIR_PRELECTURA VARCHAR(1)
	DECLARE @NIVEL_PRECIO VARCHAR(12)
	DECLARE @MONEDA_NIVEL VARCHAR(1)
	DECLARE @USAR_NIVEL_CLIENTE VARCHAR(1)
	DECLARE @USAR_BLOQUEO_AUTOM VARCHAR(1)
	DECLARE @TIEMPO_BLOQUEO INT
	DECLARE @CTR_ABONOS VARCHAR(25)
	DECLARE @CTA_ABONOS VARCHAR(25)
	DECLARE @CTR_CIERRE_CREDITO VARCHAR(25)
	DECLARE @CTA_CIERRE_CREDITO VARCHAR(25)
	DECLARE @CTR_CIERRE_DEBITO VARCHAR(25)
	DECLARE @CTA_CIERRE_DEBITO VARCHAR(25)
	DECLARE @CTR_DIFER_INGRESO VARCHAR(25)
	DECLARE @CTA_DIFER_INGRESO VARCHAR(25)
	DECLARE @CTR_DIFER_EGRESO VARCHAR(25)
	DECLARE @CTA_DIFER_EGRESO VARCHAR(25)
	DECLARE @TIPO_CONTA_OMISION VARCHAR(1)
	DECLARE @CTR_OTROS_INGRESOS VARCHAR(25)
	DECLARE @CTA_OTROS_INGRESOS VARCHAR(25)
	DECLARE @USAR_FECHA_DADA VARCHAR(1)
	DECLARE @CAMPOS_OBLIG_TARJ VARCHAR(1)
	DECLARE @IMPR_DESC_LINEAS VARCHAR(1)
	DECLARE @MODIF_COD_CLIENTE VARCHAR(1)
	DECLARE @VALID_PAGO_DEV_FAC VARCHAR(1)
	DECLARE @CTR_BONO VARCHAR(25)
	DECLARE @CTA_BONO VARCHAR(25)
	DECLARE @MODIF_CLNTS_CONT VARCHAR(1)
	DECLARE @DEVOLUCION_EFECTIVO VARCHAR(1)
	DECLARE @DEVOLUCION_CHEQUE VARCHAR(1)
	DECLARE @DEVOLUCION_TARJETA VARCHAR(1)
	DECLARE @DEVOLUCION_CREDITO VARCHAR(1)
	DECLARE @DEVOLUCION_VALE VARCHAR(1)
	DECLARE @DEVOLUCION_BONO VARCHAR(1)
	DECLARE @DEVOLUCION_DOLAR VARCHAR(1)
	DECLARE @LIMITAR_LINEAS VARCHAR(1)
	DECLARE @CANT_LINEAS_DOCUM INT
	DECLARE @CAPTURA_FECHA_NAC VARCHAR(1)
	DECLARE @CAPTURA_NIT VARCHAR(1)
	DECLARE @CAPTURA_TELEFONO VARCHAR(1)
	DECLARE @AUTOR_DESC_MONTO VARCHAR(1)
	DECLARE @USO_FORMULARIOS VARCHAR(1)
	DECLARE @VIS_MOD_NUM_DOC VARCHAR(1)
	DECLARE @DEV_MENU_PRINCIPAL VARCHAR(1)
	DECLARE @USAR_NOTASCREDITO VARCHAR(1)
	DECLARE @IMPRIMIR_ULT_ABONO VARCHAR(1)
	DECLARE @FACTURA_AL_APARTAR VARCHAR(1)
	DECLARE @CLIENTE_APARTADO VARCHAR(20)
	DECLARE @DESG_CIERRE_CAJERO VARCHAR(1)
	DECLARE @CONTROL_INFO_FISCAL VARCHAR(1)
	DECLARE @AUTO_CAMBIO_PRECIO VARCHAR(1)
	DECLARE @CONDPAG_VENC_APART VARCHAR(4)
	DECLARE @USA_APA_CNDPAG_CLI VARCHAR(1)
	DECLARE @CTA_VTA_APARTADO VARCHAR(25)
	DECLARE @CTR_VTA_APARTADO VARCHAR(25)
	DECLARE @CATEGORIA_CLIENTE VARCHAR(8)
	DECLARE @PORC_MIN_PRI_ABONO DECIMAL(28,8)
	DECLARE @CONTROL_CXC VARCHAR(1)
	DECLARE @CTA_DEVOL_DINERO VARCHAR(25)
	DECLARE @CTR_DEVOL_DINERO VARCHAR(25)
	DECLARE @CONSECUTIVO_DEVOL VARCHAR(10)
	DECLARE @CTA_INV_DESPACHAR VARCHAR(25)
	DECLARE @CTR_INV_DESPACHAR VARCHAR(25)
	DECLARE @PORC_DEVEFE_ANUAPA DECIMAL(28,8)
	DECLARE @CALCULAR_IMP2 VARCHAR(1)
	DECLARE @DIAS_VIGENCIA_DEV DECIMAL(28,8)
	DECLARE @USAR_CADENAS VARCHAR(1)
	DECLARE @DIAS_VIGENCIA_CERT INT
	DECLARE @TIPO_CAMBIO_CIERRE VARCHAR(1)
	DECLARE @CTR_EFECTIVO_LOCAL VARCHAR(25)
	DECLARE @CTA_EFECTIVO_LOCAL VARCHAR(25)
	DECLARE @CTR_EFECTIVO_DOLAR VARCHAR(25)
	DECLARE @CTA_EFECTIVO_DOLAR VARCHAR(25)
	DECLARE @CTR_CHEQUE VARCHAR(25)
	DECLARE @CTA_CHEQUE VARCHAR(25)
	DECLARE @CTR_NOTACREDITO VARCHAR(25)
	DECLARE @CTA_NOTACREDITO VARCHAR(25)
	DECLARE @CTR_CERTIFICADO VARCHAR(25)
	DECLARE @CTA_CERTIFICADO VARCHAR(25)
	DECLARE @CTR_CERTIF_OBSEQUI VARCHAR(25)
	DECLARE @CTA_CERTIF_OBSEQUI VARCHAR(25)
	DECLARE @CTR_CERTIF_VENCIDO VARCHAR(25)
	DECLARE @CTA_CERTIF_VENCIDO VARCHAR(25)
	DECLARE @CTR_NC_VENCIDA VARCHAR(25)
	DECLARE @CTA_NC_VENCIDA VARCHAR(25)
	DECLARE @CONTABILIZAR_DIA VARCHAR(1)
	DECLARE @CONTABILIZAR_CAJA VARCHAR(1)
	DECLARE @CONTABILIZAR_TRANS VARCHAR(1)
	DECLARE @CONTABILIZAR_PAGOS VARCHAR(1)
	DECLARE @SITIO_LOCAL VARCHAR(20)
	DECLARE @BODEGA_CENTRAL VARCHAR(4)
	DECLARE @TIPO_SITIO_LOCAL VARCHAR(1)
	DECLARE @TRASPASO_TIENDA VARCHAR(1)
	DECLARE @USUARIO_WSQM VARCHAR(100)
        DECLARE @USA_BIMONEDA VARCHAR(1)
        DECLARE @DIAS_GRACIA INT
        DECLARE @MANEJA_SERIES	VARCHAR(1)	
	DECLARE	@CIERRE_CAJERO 	VARCHAR(1) 	
	DECLARE @MODIF_INFO_FISCAL VARCHAR(1)	
	DECLARE @PORC_AUMEN_PRE	 DECIMAL (28, 8)	
	DECLARE @PORC_DISMIN_PRE DECIMAL (28, 8)	
	DECLARE @SOLO_CERT_CLIENTE VARCHAR(1)	
	DECLARE @SUBT_CRED_FISCAL INT		
	DECLARE @VALIDA_PRELECTURA VARCHAR(1)	
       	DECLARE	@LOCALIZACION	VARCHAR(8) 
       	DECLARE @MULT_CORRELATIVO VARCHAR(1)
	 -- Declaraciones	
	 
	SELECT  @PUBLICADOR = SITIO_LOCAL, 
		@TIPO_SITIO_LOCAL = TIPO_SITIO_LOCAL, 
		@USUARIO_POS_WSQM = USUARIO_WSQM
	FROM DELETED

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM) AND @TIPO_SITIO_LOCAL = 'C'
	BEGIN
		DECLARE C_DELETED CURSOR LOCAL FOR
			SELECT CONDICION_PAGO, TIPO_ASIENTO, PAQUETE, GRUPO_CAJERO, GRUPO_SUPERVISOR, CLIENTE_OMISION, INGRESO_CANTIDAD, IMPUESTO_INCLUIDO, DETALLE_KITS, REDONDEAR_FACTURA, FACTOR_REDONDEO, INTEGRACION_CONTA, VALIDAR_CHEQUES, PAGO_MIXTO, IMPRESION_DOBLE, MAX_FORMA_PAGO, FOTO_ARTICULO, ESQUEMA_VENDEDOR, MANEJO_LOTE, VERIFICAR_FECHA, VALIDAR_EXISTENCIAS, MODO_APLIC_ASIENTO, IMPRESION_SIMULTANEA, ACTUALIZACION_SIMULTANEA, PERMITE_REDUCCIONES, MOD_CONDICION_PAGO, LINEA_SUPERIOR1, LINEA_SUPERIOR2, LINEA_SUPERIOR3, LINEA_SUPERIOR4, LINEA_INFERIOR1, LINEA_INFERIOR2, LINEA_INFERIOR3, LINEA_INFERIOR4, IMP1_AFECTA_DESCTO, CALCULO_IMPUESTOS, AUTORIZA_PRECIO, PORC_DCTO_LINEA, PORC_DCTO_TOTAL, PORC_DCTO_LIN_SUP, PORC_DCTO_TOT_SUP, ARTICULO_APARTADO, LINEA_INFER1_APART, LINEA_INFER2_APART, LINEA_INFER3_APART, LINEA_INFER4_APART, DIAS_VENCE_APART, IMPRIMIR_PRELECTURA, NIVEL_PRECIO, MONEDA_NIVEL, USAR_NIVEL_CLIENTE, USAR_BLOQUEO_AUTOM, TIEMPO_BLOQUEO, CTR_ABONOS, CTA_ABONOS, CTR_CIERRE_CREDITO, CTA_CIERRE_CREDITO, CTR_CIERRE_DEBITO, CTA_CIERRE_DEBITO, CTR_DIFER_INGRESO, CTA_DIFER_INGRESO, CTR_DIFER_EGRESO, CTA_DIFER_EGRESO, TIPO_CONTA_OMISION, CTR_OTROS_INGRESOS, CTA_OTROS_INGRESOS, USAR_FECHA_DADA, CAMPOS_OBLIG_TARJ, IMPR_DESC_LINEAS, MODIF_COD_CLIENTE, VALID_PAGO_DEV_FAC, CTR_BONO, CTA_BONO, MODIF_CLNTS_CONT, DEVOLUCION_EFECTIVO, DEVOLUCION_CHEQUE, DEVOLUCION_TARJETA, DEVOLUCION_CREDITO, DEVOLUCION_VALE, DEVOLUCION_BONO, DEVOLUCION_DOLAR, LIMITAR_LINEAS, CANT_LINEAS_DOCUM, CAPTURA_FECHA_NAC, CAPTURA_NIT, CAPTURA_TELEFONO, AUTOR_DESC_MONTO, USO_FORMULARIOS, VIS_MOD_NUM_DOC, DEV_MENU_PRINCIPAL, USAR_NOTASCREDITO, IMPRIMIR_ULT_ABONO, FACTURA_AL_APARTAR, CLIENTE_APARTADO, DESG_CIERRE_CAJERO, CONTROL_INFO_FISCAL, AUTO_CAMBIO_PRECIO, CONDPAG_VENC_APART, USA_APA_CNDPAG_CLI, CTA_VTA_APARTADO, CTR_VTA_APARTADO, CATEGORIA_CLIENTE, PORC_MIN_PRI_ABONO, CONTROL_CXC, CTA_DEVOL_DINERO, CTR_DEVOL_DINERO, CONSECUTIVO_DEVOL, CTA_INV_DESPACHAR, CTR_INV_DESPACHAR, PORC_DEVEFE_ANUAPA, CALCULAR_IMP2, DIAS_VIGENCIA_DEV, USAR_CADENAS, DIAS_VIGENCIA_CERT, TIPO_CAMBIO_CIERRE, CTR_EFECTIVO_LOCAL, CTA_EFECTIVO_LOCAL, CTR_EFECTIVO_DOLAR, CTA_EFECTIVO_DOLAR, CTR_CHEQUE, CTA_CHEQUE, CTR_NOTACREDITO, CTA_NOTACREDITO, CTR_CERTIFICADO, CTA_CERTIFICADO, CTR_CERTIF_OBSEQUI, CTA_CERTIF_OBSEQUI, CTR_CERTIF_VENCIDO, CTA_CERTIF_VENCIDO, CTR_NC_VENCIDA, CTA_NC_VENCIDA, CONTABILIZAR_DIA, CONTABILIZAR_CAJA, CONTABILIZAR_TRANS, CONTABILIZAR_PAGOS, SITIO_LOCAL, BODEGA_CENTRAL, TIPO_SITIO_LOCAL, TRASPASO_TIENDA, USUARIO_WSQM, USA_BIMONEDA,DIAS_GRACIA,MANEJA_SERIES,CIERRE_CAJERO,MODIF_INFO_FISCAL,PORC_AUMEN_PRE,PORC_DISMIN_PRE,SOLO_CERT_CLIENTE,SUBT_CRED_FISCAL,VALIDA_PRELECTURA,LOCALIZACION,MULT_CORRELATIVO
			FROM DELETED d
			
		OPEN C_DELETED
		FETCH NEXT FROM C_DELETED INTO
		@CONDICION_PAGO, @TIPO_ASIENTO, @PAQUETE, @GRUPO_CAJERO, @GRUPO_SUPERVISOR, @CLIENTE_OMISION, @INGRESO_CANTIDAD, @IMPUESTO_INCLUIDO, @DETALLE_KITS, @REDONDEAR_FACTURA, @FACTOR_REDONDEO, @INTEGRACION_CONTA, @VALIDAR_CHEQUES, @PAGO_MIXTO, @IMPRESION_DOBLE, @MAX_FORMA_PAGO, @FOTO_ARTICULO, @ESQUEMA_VENDEDOR, @MANEJO_LOTE, @VERIFICAR_FECHA, @VALIDAR_EXISTENCIAS, @MODO_APLIC_ASIENTO, @IMPRESION_SIMULTANEA, @ACTUALIZACION_SIMULTANEA, @PERMITE_REDUCCIONES, @MOD_CONDICION_PAGO, @LINEA_SUPERIOR1, @LINEA_SUPERIOR2, @LINEA_SUPERIOR3, @LINEA_SUPERIOR4, @LINEA_INFERIOR1, @LINEA_INFERIOR2, @LINEA_INFERIOR3, @LINEA_INFERIOR4, @IMP1_AFECTA_DESCTO, @CALCULO_IMPUESTOS, @AUTORIZA_PRECIO, @PORC_DCTO_LINEA, @PORC_DCTO_TOTAL, @PORC_DCTO_LIN_SUP, @PORC_DCTO_TOT_SUP, @ARTICULO_APARTADO, @LINEA_INFER1_APART, @LINEA_INFER2_APART, @LINEA_INFER3_APART, @LINEA_INFER4_APART, @DIAS_VENCE_APART, @IMPRIMIR_PRELECTURA, @NIVEL_PRECIO, @MONEDA_NIVEL, @USAR_NIVEL_CLIENTE, @USAR_BLOQUEO_AUTOM, @TIEMPO_BLOQUEO, @CTR_ABONOS, @CTA_ABONOS, @CTR_CIERRE_CREDITO, @CTA_CIERRE_CREDITO, @CTR_CIERRE_DEBITO, @CTA_CIERRE_DEBITO, @CTR_DIFER_INGRESO, @CTA_DIFER_INGRESO, @CTR_DIFER_EGRESO, @CTA_DIFER_EGRESO, @TIPO_CONTA_OMISION, @CTR_OTROS_INGRESOS, @CTA_OTROS_INGRESOS, @USAR_FECHA_DADA, @CAMPOS_OBLIG_TARJ, @IMPR_DESC_LINEAS, @MODIF_COD_CLIENTE, @VALID_PAGO_DEV_FAC, @CTR_BONO, @CTA_BONO, @MODIF_CLNTS_CONT, @DEVOLUCION_EFECTIVO, @DEVOLUCION_CHEQUE, @DEVOLUCION_TARJETA, @DEVOLUCION_CREDITO, @DEVOLUCION_VALE, @DEVOLUCION_BONO, @DEVOLUCION_DOLAR, @LIMITAR_LINEAS, @CANT_LINEAS_DOCUM, @CAPTURA_FECHA_NAC, @CAPTURA_NIT, @CAPTURA_TELEFONO, @AUTOR_DESC_MONTO, @USO_FORMULARIOS, @VIS_MOD_NUM_DOC, @DEV_MENU_PRINCIPAL, @USAR_NOTASCREDITO, @IMPRIMIR_ULT_ABONO, @FACTURA_AL_APARTAR, @CLIENTE_APARTADO, @DESG_CIERRE_CAJERO, @CONTROL_INFO_FISCAL, @AUTO_CAMBIO_PRECIO, @CONDPAG_VENC_APART, @USA_APA_CNDPAG_CLI, @CTA_VTA_APARTADO, @CTR_VTA_APARTADO, @CATEGORIA_CLIENTE, @PORC_MIN_PRI_ABONO, @CONTROL_CXC, @CTA_DEVOL_DINERO, @CTR_DEVOL_DINERO, @CONSECUTIVO_DEVOL, @CTA_INV_DESPACHAR, @CTR_INV_DESPACHAR, @PORC_DEVEFE_ANUAPA, @CALCULAR_IMP2, @DIAS_VIGENCIA_DEV, @USAR_CADENAS, @DIAS_VIGENCIA_CERT, @TIPO_CAMBIO_CIERRE, @CTR_EFECTIVO_LOCAL, @CTA_EFECTIVO_LOCAL, @CTR_EFECTIVO_DOLAR, @CTA_EFECTIVO_DOLAR, @CTR_CHEQUE, @CTA_CHEQUE, @CTR_NOTACREDITO, @CTA_NOTACREDITO, @CTR_CERTIFICADO, @CTA_CERTIFICADO, @CTR_CERTIF_OBSEQUI, @CTA_CERTIF_OBSEQUI, @CTR_CERTIF_VENCIDO, @CTA_CERTIF_VENCIDO, @CTR_NC_VENCIDA, @CTA_NC_VENCIDA, @CONTABILIZAR_DIA, @CONTABILIZAR_CAJA, @CONTABILIZAR_TRANS, @CONTABILIZAR_PAGOS, @SITIO_LOCAL, @BODEGA_CENTRAL, @TIPO_SITIO_LOCAL, @TRASPASO_TIENDA, @USUARIO_WSQM, @USA_BIMONEDA,@DIAS_GRACIA,@MANEJA_SERIES,@CIERRE_CAJERO,@MODIF_INFO_FISCAL,@PORC_AUMEN_PRE,@PORC_DISMIN_PRE,@SOLO_CERT_CLIENTE,@SUBT_CRED_FISCAL,@VALIDA_PRELECTURA,@LOCALIZACION,@MULT_CORRELATIVO
		
		SET @ERROR = 0
		
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS =
								'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<GLOBALES_POS>' +
				'<CONDICION_PAGO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CONDICION_PAGO) + '</CONDICION_PAGO>' +
				'<TIPO_ASIENTO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_ASIENTO) + '</TIPO_ASIENTO>' +
				'<PAQUETE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@PAQUETE) + '</PAQUETE>' +
				'<GRUPO_CAJERO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@GRUPO_CAJERO) + '</GRUPO_CAJERO>' +
				'<GRUPO_SUPERVISOR Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@GRUPO_SUPERVISOR) + '</GRUPO_SUPERVISOR>' +
				'<CLIENTE_OMISION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CLIENTE_OMISION) + '</CLIENTE_OMISION>' +
				'<INGRESO_CANTIDAD Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@INGRESO_CANTIDAD) + '</INGRESO_CANTIDAD>' +
				'<IMPUESTO_INCLUIDO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@IMPUESTO_INCLUIDO) + '</IMPUESTO_INCLUIDO>' +
				'<DETALLE_KITS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DETALLE_KITS) + '</DETALLE_KITS>' +
				'<REDONDEAR_FACTURA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@REDONDEAR_FACTURA) + '</REDONDEAR_FACTURA>' +
				'<FACTOR_REDONDEO Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@FACTOR_REDONDEO) + '</FACTOR_REDONDEO>' +
				'<INTEGRACION_CONTA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@INTEGRACION_CONTA) + '</INTEGRACION_CONTA>' +
				'<VALIDAR_CHEQUES Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@VALIDAR_CHEQUES) + '</VALIDAR_CHEQUES>' +
				'<PAGO_MIXTO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@PAGO_MIXTO) + '</PAGO_MIXTO>' +
				'<IMPRESION_DOBLE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@IMPRESION_DOBLE) + '</IMPRESION_DOBLE>' +
				'<MAX_FORMA_PAGO Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@MAX_FORMA_PAGO) + '</MAX_FORMA_PAGO>' +
				'<FOTO_ARTICULO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@FOTO_ARTICULO) + '</FOTO_ARTICULO>' +
				'<ESQUEMA_VENDEDOR Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ESQUEMA_VENDEDOR) + '</ESQUEMA_VENDEDOR>' +
				'<MANEJO_LOTE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@MANEJO_LOTE) + '</MANEJO_LOTE>' +
				'<VERIFICAR_FECHA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@VERIFICAR_FECHA) + '</VERIFICAR_FECHA>' +
				'<VALIDAR_EXISTENCIAS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@VALIDAR_EXISTENCIAS) + '</VALIDAR_EXISTENCIAS>' +
				'<MODO_APLIC_ASIENTO Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@MODO_APLIC_ASIENTO) + '</MODO_APLIC_ASIENTO>' +
				'<IMPRESION_SIMULTANEA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@IMPRESION_SIMULTANEA) + '</IMPRESION_SIMULTANEA>' +
				'<ACTUALIZACION_SIMULTANEA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ACTUALIZACION_SIMULTANEA) + '</ACTUALIZACION_SIMULTANEA>' +
				'<PERMITE_REDUCCIONES Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@PERMITE_REDUCCIONES) + '</PERMITE_REDUCCIONES>' +
				'<MOD_CONDICION_PAGO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@MOD_CONDICION_PAGO) + '</MOD_CONDICION_PAGO>' +
				'<LINEA_SUPERIOR1 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@LINEA_SUPERIOR1) + '</LINEA_SUPERIOR1>' +
				'<LINEA_SUPERIOR2 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@LINEA_SUPERIOR2) + '</LINEA_SUPERIOR2>' +
				'<LINEA_SUPERIOR3 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@LINEA_SUPERIOR3) + '</LINEA_SUPERIOR3>' +
				'<LINEA_SUPERIOR4 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@LINEA_SUPERIOR4) + '</LINEA_SUPERIOR4>' +
				'<LINEA_INFERIOR1 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@LINEA_INFERIOR1) + '</LINEA_INFERIOR1>' +
				'<LINEA_INFERIOR2 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@LINEA_INFERIOR2) + '</LINEA_INFERIOR2>' +
				'<LINEA_INFERIOR3 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@LINEA_INFERIOR3) + '</LINEA_INFERIOR3>' +
				'<LINEA_INFERIOR4 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@LINEA_INFERIOR4) + '</LINEA_INFERIOR4>'
				
			SET @PARAMETROS2 =				
				'<IMP1_AFECTA_DESCTO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@IMP1_AFECTA_DESCTO) + '</IMP1_AFECTA_DESCTO>' +
				'<CALCULO_IMPUESTOS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CALCULO_IMPUESTOS) + '</CALCULO_IMPUESTOS>' +
				'<AUTORIZA_PRECIO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@AUTORIZA_PRECIO) + '</AUTORIZA_PRECIO>' +
				'<PORC_DCTO_LINEA Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@PORC_DCTO_LINEA) + '</PORC_DCTO_LINEA>' +
				'<PORC_DCTO_TOTAL Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@PORC_DCTO_TOTAL) + '</PORC_DCTO_TOTAL>' +
				'<PORC_DCTO_LIN_SUP Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@PORC_DCTO_LIN_SUP) + '</PORC_DCTO_LIN_SUP>' +
				'<PORC_DCTO_TOT_SUP Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@PORC_DCTO_TOT_SUP) + '</PORC_DCTO_TOT_SUP>' +
				'<ARTICULO_APARTADO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ARTICULO_APARTADO) + '</ARTICULO_APARTADO>' +
				'<LINEA_INFER1_APART Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@LINEA_INFER1_APART) + '</LINEA_INFER1_APART>' +
				'<LINEA_INFER2_APART Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@LINEA_INFER2_APART) + '</LINEA_INFER2_APART>' +
				'<LINEA_INFER3_APART Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@LINEA_INFER3_APART) + '</LINEA_INFER3_APART>' +
				'<LINEA_INFER4_APART Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@LINEA_INFER4_APART) + '</LINEA_INFER4_APART>' +
				'<DIAS_VENCE_APART Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@DIAS_VENCE_APART) + '</DIAS_VENCE_APART>' +
				'<IMPRIMIR_PRELECTURA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@IMPRIMIR_PRELECTURA) + '</IMPRIMIR_PRELECTURA>' +
				'<NIVEL_PRECIO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NIVEL_PRECIO) + '</NIVEL_PRECIO>' +
				'<MONEDA_NIVEL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@MONEDA_NIVEL) + '</MONEDA_NIVEL>' +
				'<USAR_NIVEL_CLIENTE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USAR_NIVEL_CLIENTE) + '</USAR_NIVEL_CLIENTE>' +
				'<USAR_BLOQUEO_AUTOM Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USAR_BLOQUEO_AUTOM) + '</USAR_BLOQUEO_AUTOM>' +
				'<TIEMPO_BLOQUEO Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@TIEMPO_BLOQUEO) + '</TIEMPO_BLOQUEO>' +
				'<CTR_ABONOS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_ABONOS) + '</CTR_ABONOS>' +
				'<CTA_ABONOS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_ABONOS) + '</CTA_ABONOS>' +
				'<CTR_CIERRE_CREDITO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_CIERRE_CREDITO) + '</CTR_CIERRE_CREDITO>' +
				'<CTA_CIERRE_CREDITO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_CIERRE_CREDITO) + '</CTA_CIERRE_CREDITO>' +
				'<CTR_CIERRE_DEBITO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_CIERRE_DEBITO) + '</CTR_CIERRE_DEBITO>' +
				'<CTA_CIERRE_DEBITO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_CIERRE_DEBITO) + '</CTA_CIERRE_DEBITO>' +
				'<CTR_DIFER_INGRESO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_DIFER_INGRESO) + '</CTR_DIFER_INGRESO>' +
				'<CTA_DIFER_INGRESO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_DIFER_INGRESO) + '</CTA_DIFER_INGRESO>' +
				'<CTR_DIFER_EGRESO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_DIFER_EGRESO) + '</CTR_DIFER_EGRESO>' +
				'<CTA_DIFER_EGRESO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_DIFER_EGRESO) + '</CTA_DIFER_EGRESO>' +
				'<TIPO_CONTA_OMISION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_CONTA_OMISION) + '</TIPO_CONTA_OMISION>' +
				'<CTR_OTROS_INGRESOS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_OTROS_INGRESOS) + '</CTR_OTROS_INGRESOS>' +
				'<CTA_OTROS_INGRESOS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_OTROS_INGRESOS) + '</CTA_OTROS_INGRESOS>' +
				'<USAR_FECHA_DADA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USAR_FECHA_DADA) + '</USAR_FECHA_DADA>' +
				'<CAMPOS_OBLIG_TARJ Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CAMPOS_OBLIG_TARJ) + '</CAMPOS_OBLIG_TARJ>' +
				'<IMPR_DESC_LINEAS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@IMPR_DESC_LINEAS) + '</IMPR_DESC_LINEAS>' +
				'<MODIF_COD_CLIENTE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@MODIF_COD_CLIENTE) + '</MODIF_COD_CLIENTE>' +
				'<VALID_PAGO_DEV_FAC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@VALID_PAGO_DEV_FAC) + '</VALID_PAGO_DEV_FAC>' +
				'<CTR_BONO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_BONO) + '</CTR_BONO>' +
				'<CTA_BONO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_BONO) + '</CTA_BONO>' +
				'<MODIF_CLNTS_CONT Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@MODIF_CLNTS_CONT) + '</MODIF_CLNTS_CONT>' +
				'<DEVOLUCION_EFECTIVO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DEVOLUCION_EFECTIVO) + '</DEVOLUCION_EFECTIVO>' +
				'<DEVOLUCION_CHEQUE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DEVOLUCION_CHEQUE) + '</DEVOLUCION_CHEQUE>' +
				'<DEVOLUCION_TARJETA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DEVOLUCION_TARJETA) + '</DEVOLUCION_TARJETA>' +
				'<DEVOLUCION_CREDITO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DEVOLUCION_CREDITO) + '</DEVOLUCION_CREDITO>' +
				'<DEVOLUCION_VALE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DEVOLUCION_VALE) + '</DEVOLUCION_VALE>' +
				'<DEVOLUCION_BONO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DEVOLUCION_BONO) + '</DEVOLUCION_BONO>' +
				'<DEVOLUCION_DOLAR Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DEVOLUCION_DOLAR) + '</DEVOLUCION_DOLAR>'

			SET @PARAMETROS3 =	
				'<LIMITAR_LINEAS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@LIMITAR_LINEAS) + '</LIMITAR_LINEAS>' +
				'<CANT_LINEAS_DOCUM Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@CANT_LINEAS_DOCUM) + '</CANT_LINEAS_DOCUM>' +
				'<CAPTURA_FECHA_NAC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CAPTURA_FECHA_NAC) + '</CAPTURA_FECHA_NAC>' +
				'<CAPTURA_NIT Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CAPTURA_NIT) + '</CAPTURA_NIT>' +
				'<CAPTURA_TELEFONO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CAPTURA_TELEFONO) + '</CAPTURA_TELEFONO>' +
				'<AUTOR_DESC_MONTO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@AUTOR_DESC_MONTO) + '</AUTOR_DESC_MONTO>' +
				'<USO_FORMULARIOS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USO_FORMULARIOS) + '</USO_FORMULARIOS>' +
				'<VIS_MOD_NUM_DOC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@VIS_MOD_NUM_DOC) + '</VIS_MOD_NUM_DOC>' +
				'<DEV_MENU_PRINCIPAL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DEV_MENU_PRINCIPAL) + '</DEV_MENU_PRINCIPAL>' +
				'<USAR_NOTASCREDITO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USAR_NOTASCREDITO) + '</USAR_NOTASCREDITO>' +
				'<IMPRIMIR_ULT_ABONO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@IMPRIMIR_ULT_ABONO) + '</IMPRIMIR_ULT_ABONO>' +
				'<FACTURA_AL_APARTAR Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@FACTURA_AL_APARTAR) + '</FACTURA_AL_APARTAR>' +
				'<CLIENTE_APARTADO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CLIENTE_APARTADO) + '</CLIENTE_APARTADO>' +
				'<DESG_CIERRE_CAJERO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DESG_CIERRE_CAJERO) + '</DESG_CIERRE_CAJERO>' +
				'<CONTROL_INFO_FISCAL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CONTROL_INFO_FISCAL) + '</CONTROL_INFO_FISCAL>' +
				'<AUTO_CAMBIO_PRECIO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@AUTO_CAMBIO_PRECIO) + '</AUTO_CAMBIO_PRECIO>' +
				'<CONDPAG_VENC_APART Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CONDPAG_VENC_APART) + '</CONDPAG_VENC_APART>' +
				'<USA_APA_CNDPAG_CLI Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USA_APA_CNDPAG_CLI) + '</USA_APA_CNDPAG_CLI>' +
				'<CTA_VTA_APARTADO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_VTA_APARTADO) + '</CTA_VTA_APARTADO>' +
				'<CTR_VTA_APARTADO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_VTA_APARTADO) + '</CTR_VTA_APARTADO>' +
				'<CATEGORIA_CLIENTE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CATEGORIA_CLIENTE) + '</CATEGORIA_CLIENTE>' +
				'<PORC_MIN_PRI_ABONO Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@PORC_MIN_PRI_ABONO) + '</PORC_MIN_PRI_ABONO>' +
				'<CONTROL_CXC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CONTROL_CXC) + '</CONTROL_CXC>' +	
				'<CTA_DEVOL_DINERO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_DEVOL_DINERO) + '</CTA_DEVOL_DINERO>' +
				'<CTR_DEVOL_DINERO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_DEVOL_DINERO) + '</CTR_DEVOL_DINERO>' +
				'<CONSECUTIVO_DEVOL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CONSECUTIVO_DEVOL) + '</CONSECUTIVO_DEVOL>' +
				'<CTA_INV_DESPACHAR Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_INV_DESPACHAR) + '</CTA_INV_DESPACHAR>' +
				'<CTR_INV_DESPACHAR Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_INV_DESPACHAR) + '</CTR_INV_DESPACHAR>' +
				'<PORC_DEVEFE_ANUAPA Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@PORC_DEVEFE_ANUAPA) + '</PORC_DEVEFE_ANUAPA>' +
				'<CALCULAR_IMP2 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CALCULAR_IMP2) + '</CALCULAR_IMP2>' +
				'<DIAS_VIGENCIA_DEV Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@DIAS_VIGENCIA_DEV) + '</DIAS_VIGENCIA_DEV>' +
				'<USAR_CADENAS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USAR_CADENAS) + '</USAR_CADENAS>' +
				'<DIAS_VIGENCIA_CERT Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@DIAS_VIGENCIA_CERT) + '</DIAS_VIGENCIA_CERT>' +
				'<TIPO_CAMBIO_CIERRE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_CAMBIO_CIERRE) + '</TIPO_CAMBIO_CIERRE>'
				
			SET @PARAMETROS3 =					
				'<CTR_EFECTIVO_LOCAL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_EFECTIVO_LOCAL) + '</CTR_EFECTIVO_LOCAL>' +
				'<CTA_EFECTIVO_LOCAL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_EFECTIVO_LOCAL) + '</CTA_EFECTIVO_LOCAL>' +
				'<CTR_EFECTIVO_DOLAR Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_EFECTIVO_DOLAR) + '</CTR_EFECTIVO_DOLAR>' +
				'<CTA_EFECTIVO_DOLAR Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_EFECTIVO_DOLAR) + '</CTA_EFECTIVO_DOLAR>' +
				'<CTR_CHEQUE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_CHEQUE) + '</CTR_CHEQUE>' +
				'<CTA_CHEQUE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_CHEQUE) + '</CTA_CHEQUE>' +
				'<CTR_NOTACREDITO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_NOTACREDITO) + '</CTR_NOTACREDITO>' +
				'<CTA_NOTACREDITO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_NOTACREDITO) + '</CTA_NOTACREDITO>' +
				'<CTR_CERTIFICADO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_CERTIFICADO) + '</CTR_CERTIFICADO>' +
				'<CTA_CERTIFICADO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_CERTIFICADO) + '</CTA_CERTIFICADO>' +
				'<CTR_CERTIF_OBSEQUI Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_CERTIF_OBSEQUI) + '</CTR_CERTIF_OBSEQUI>' +
				'<CTA_CERTIF_OBSEQUI Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_CERTIF_OBSEQUI) + '</CTA_CERTIF_OBSEQUI>' +
				'<CTR_CERTIF_VENCIDO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_CERTIF_VENCIDO) + '</CTR_CERTIF_VENCIDO>' +
				'<CTA_CERTIF_VENCIDO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_CERTIF_VENCIDO) + '</CTA_CERTIF_VENCIDO>' +
				'<CTR_NC_VENCIDA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_NC_VENCIDA) + '</CTR_NC_VENCIDA>' +
				'<CTA_NC_VENCIDA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_NC_VENCIDA) + '</CTA_NC_VENCIDA>' +
				'<CONTABILIZAR_DIA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CONTABILIZAR_DIA) + '</CONTABILIZAR_DIA>' +
				'<CONTABILIZAR_CAJA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CONTABILIZAR_CAJA) + '</CONTABILIZAR_CAJA>' +
				'<CONTABILIZAR_TRANS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CONTABILIZAR_TRANS) + '</CONTABILIZAR_TRANS>' +
				'<CONTABILIZAR_PAGOS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CONTABILIZAR_PAGOS) + '</CONTABILIZAR_PAGOS>' +
				'<SITIO_LOCAL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@SITIO_LOCAL) + '</SITIO_LOCAL>' +
				'<BODEGA_CENTRAL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@BODEGA_CENTRAL) + '</BODEGA_CENTRAL>' +
				'<TIPO_SITIO_LOCAL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_SITIO_LOCAL) + '</TIPO_SITIO_LOCAL>' +
				'<TRASPASO_TIENDA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TRASPASO_TIENDA) + '</TRASPASO_TIENDA>' +
				'<USUARIO_WSQM Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USUARIO_WSQM) + '</USUARIO_WSQM>' +
				'<USA_BIMONEDA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USA_BIMONEDA) + '</USA_BIMONEDA>' +
				'<DIAS_GRACIA Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@DIAS_GRACIA) + '</DIAS_GRACIA>' +				
				'<MANEJA_SERIES Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@MANEJA_SERIES) + '</MANEJA_SERIES>' +
				'<CIERRE_CAJERO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CIERRE_CAJERO) + '</CIERRE_CAJERO>' +
				'<MODIF_INFO_FISCAL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@MODIF_INFO_FISCAL) + '</MODIF_INFO_FISCAL>' +
				'<PORC_AUMEN_PRE Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@PORC_AUMEN_PRE) + '</PORC_AUMEN_PRE>' +
				'<PORC_DISMIN_PRE Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@PORC_DISMIN_PRE) + '</PORC_DISMIN_PRE>' +
				'<SOLO_CERT_CLIENTE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@SOLO_CERT_CLIENTE) + '</SOLO_CERT_CLIENTE>' +
				'<SUBT_CRED_FISCAL Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@SUBT_CRED_FISCAL) + '</SUBT_CRED_FISCAL>' +
				'<VALIDA_PRELECTURA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@VALIDA_PRELECTURA) + '</VALIDA_PRELECTURA>' +
				'<LOCALIZACION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@LOCALIZACION) + '</LOCALIZACION>' +
				'<MULT_CORRELATIVO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@MULT_CORRELATIVO) + '</MULT_CORRELATIVO>' +				
				'</GLOBALES_POS>'
			
			-- inserta la solicitud correspondiente
			EXECUTE  ('ERPADMIN.POS_InsertarSolicitud ''' + @PUBLICADOR + ''', ''GLOBALESPOSPOS600'', ''ELIMINA'', ''' + @PARAMETROS + @PARAMETROS2 + @PARAMETROS3 + @PARAMETROS4 + ''', 0, ''''')
						
			FETCH NEXT FROM C_DELETED INTO
			@CONDICION_PAGO, @TIPO_ASIENTO, @PAQUETE, @GRUPO_CAJERO, @GRUPO_SUPERVISOR, @CLIENTE_OMISION, @INGRESO_CANTIDAD, @IMPUESTO_INCLUIDO, @DETALLE_KITS, @REDONDEAR_FACTURA, @FACTOR_REDONDEO, @INTEGRACION_CONTA, @VALIDAR_CHEQUES, @PAGO_MIXTO, @IMPRESION_DOBLE, @MAX_FORMA_PAGO, @FOTO_ARTICULO, @ESQUEMA_VENDEDOR, @MANEJO_LOTE, @VERIFICAR_FECHA, @VALIDAR_EXISTENCIAS, @MODO_APLIC_ASIENTO, @IMPRESION_SIMULTANEA, @ACTUALIZACION_SIMULTANEA, @PERMITE_REDUCCIONES, @MOD_CONDICION_PAGO, @LINEA_SUPERIOR1, @LINEA_SUPERIOR2, @LINEA_SUPERIOR3, @LINEA_SUPERIOR4, @LINEA_INFERIOR1, @LINEA_INFERIOR2, @LINEA_INFERIOR3, @LINEA_INFERIOR4, @IMP1_AFECTA_DESCTO, @CALCULO_IMPUESTOS, @AUTORIZA_PRECIO, @PORC_DCTO_LINEA, @PORC_DCTO_TOTAL, @PORC_DCTO_LIN_SUP, @PORC_DCTO_TOT_SUP, @ARTICULO_APARTADO, @LINEA_INFER1_APART, @LINEA_INFER2_APART, @LINEA_INFER3_APART, @LINEA_INFER4_APART, @DIAS_VENCE_APART, @IMPRIMIR_PRELECTURA, @NIVEL_PRECIO, @MONEDA_NIVEL, @USAR_NIVEL_CLIENTE, @USAR_BLOQUEO_AUTOM, @TIEMPO_BLOQUEO, @CTR_ABONOS, @CTA_ABONOS, @CTR_CIERRE_CREDITO, @CTA_CIERRE_CREDITO, @CTR_CIERRE_DEBITO, @CTA_CIERRE_DEBITO, @CTR_DIFER_INGRESO, @CTA_DIFER_INGRESO, @CTR_DIFER_EGRESO, @CTA_DIFER_EGRESO, @TIPO_CONTA_OMISION, @CTR_OTROS_INGRESOS, @CTA_OTROS_INGRESOS, @USAR_FECHA_DADA, @CAMPOS_OBLIG_TARJ, @IMPR_DESC_LINEAS, @MODIF_COD_CLIENTE, @VALID_PAGO_DEV_FAC, @CTR_BONO, @CTA_BONO, @MODIF_CLNTS_CONT, @DEVOLUCION_EFECTIVO, @DEVOLUCION_CHEQUE, @DEVOLUCION_TARJETA, @DEVOLUCION_CREDITO, @DEVOLUCION_VALE, @DEVOLUCION_BONO, @DEVOLUCION_DOLAR, @LIMITAR_LINEAS, @CANT_LINEAS_DOCUM, @CAPTURA_FECHA_NAC, @CAPTURA_NIT, @CAPTURA_TELEFONO, @AUTOR_DESC_MONTO, @USO_FORMULARIOS, @VIS_MOD_NUM_DOC, @DEV_MENU_PRINCIPAL, @USAR_NOTASCREDITO, @IMPRIMIR_ULT_ABONO, @FACTURA_AL_APARTAR, @CLIENTE_APARTADO, @DESG_CIERRE_CAJERO, @CONTROL_INFO_FISCAL, @AUTO_CAMBIO_PRECIO, @CONDPAG_VENC_APART, @USA_APA_CNDPAG_CLI, @CTA_VTA_APARTADO, @CTR_VTA_APARTADO, @CATEGORIA_CLIENTE, @PORC_MIN_PRI_ABONO, @CONTROL_CXC, @CTA_DEVOL_DINERO, @CTR_DEVOL_DINERO, @CONSECUTIVO_DEVOL, @CTA_INV_DESPACHAR, @CTR_INV_DESPACHAR, @PORC_DEVEFE_ANUAPA, @CALCULAR_IMP2, @DIAS_VIGENCIA_DEV, @USAR_CADENAS, @DIAS_VIGENCIA_CERT, @TIPO_CAMBIO_CIERRE, @CTR_EFECTIVO_LOCAL, @CTA_EFECTIVO_LOCAL, @CTR_EFECTIVO_DOLAR, @CTA_EFECTIVO_DOLAR, @CTR_CHEQUE, @CTA_CHEQUE, @CTR_NOTACREDITO, @CTA_NOTACREDITO, @CTR_CERTIFICADO, @CTA_CERTIFICADO, @CTR_CERTIF_OBSEQUI, @CTA_CERTIF_OBSEQUI, @CTR_CERTIF_VENCIDO, @CTA_CERTIF_VENCIDO, @CTR_NC_VENCIDA, @CTA_NC_VENCIDA, @CONTABILIZAR_DIA, @CONTABILIZAR_CAJA, @CONTABILIZAR_TRANS, @CONTABILIZAR_PAGOS, @SITIO_LOCAL, @BODEGA_CENTRAL, @TIPO_SITIO_LOCAL, @TRASPASO_TIENDA, @USUARIO_WSQM, @USA_BIMONEDA, @DIAS_GRACIA,@MANEJA_SERIES,@CIERRE_CAJERO,@MODIF_INFO_FISCAL,@PORC_AUMEN_PRE,@PORC_DISMIN_PRE,@SOLO_CERT_CLIENTE,@SUBT_CRED_FISCAL,@VALIDA_PRELECTURA,@LOCALIZACION,@MULT_CORRELATIVO -- VARIABLES
		END
		CLOSE C_DELETED
		DEALLOCATE C_DELETED
	END
	
	IF (@@ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para eliminar de la tabla GLOBALES_POS.',16,1 )
	END
END
;




CREATE TRIGGER $$Compania$$.GLOBALES_POS_POS_MOD
ON $$Compania$$.GLOBALES_POS
FOR UPDATE
AS
BEGIN   	
	DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @PARAMETROS2 VARCHAR(8000)
	DECLARE @PARAMETROS3 VARCHAR(8000)	
	DECLARE @PARAMETROS4 VARCHAR(8000)	
	DECLARE @EMPTY VARCHAR(9)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @COL_ROWPOINTER VARCHAR(36)
	DECLARE @HAY_CAMPOS_PARA_POS BIT
	DECLARE @ACTUALIZAR_SOLICITUD BIT
	DECLARE @CONDICION_PAGO VARCHAR(4)
	DECLARE @TIPO_ASIENTO VARCHAR(4)
	DECLARE @PAQUETE VARCHAR(4)
	DECLARE @GRUPO_CAJERO VARCHAR(25)
	DECLARE @GRUPO_SUPERVISOR VARCHAR(25)
	DECLARE @CLIENTE_OMISION VARCHAR(20)
	DECLARE @INGRESO_CANTIDAD VARCHAR(1)
	DECLARE @IMPUESTO_INCLUIDO VARCHAR(1)
	DECLARE @DETALLE_KITS VARCHAR(1)
	DECLARE @REDONDEAR_FACTURA VARCHAR(1)
	DECLARE @FACTOR_REDONDEO DECIMAL(28,8)
	DECLARE @INTEGRACION_CONTA VARCHAR(1)
	DECLARE @VALIDAR_CHEQUES VARCHAR(1)
	DECLARE @PAGO_MIXTO VARCHAR(1)
	DECLARE @IMPRESION_DOBLE VARCHAR(1)
	DECLARE @MAX_FORMA_PAGO INT
	DECLARE @FOTO_ARTICULO VARCHAR(1)
	DECLARE @ESQUEMA_VENDEDOR VARCHAR(1)
	DECLARE @MANEJO_LOTE VARCHAR(1)
	DECLARE @VERIFICAR_FECHA VARCHAR(1)
	DECLARE @VALIDAR_EXISTENCIAS VARCHAR(1)
	DECLARE @MODO_APLIC_ASIENTO INT
	DECLARE @IMPRESION_SIMULTANEA VARCHAR(1)
	DECLARE @ACTUALIZACION_SIMULTANEA VARCHAR(1)
	DECLARE @PERMITE_REDUCCIONES VARCHAR(1)
	DECLARE @MOD_CONDICION_PAGO VARCHAR(1)
	DECLARE @LINEA_SUPERIOR1 VARCHAR(254)
	DECLARE @LINEA_SUPERIOR2 VARCHAR(254)
	DECLARE @LINEA_SUPERIOR3 VARCHAR(254)
	DECLARE @LINEA_SUPERIOR4 VARCHAR(254)
	DECLARE @LINEA_INFERIOR1 VARCHAR(254)
	DECLARE @LINEA_INFERIOR2 VARCHAR(254)
	DECLARE @LINEA_INFERIOR3 VARCHAR(254)
	DECLARE @LINEA_INFERIOR4 VARCHAR(254)
	DECLARE @IMP1_AFECTA_DESCTO VARCHAR(1)
	DECLARE @CALCULO_IMPUESTOS VARCHAR(1)
	DECLARE @AUTORIZA_PRECIO VARCHAR(1)
	DECLARE @PORC_DCTO_LINEA DECIMAL(28,8)
	DECLARE @PORC_DCTO_TOTAL DECIMAL(28,8)
	DECLARE @PORC_DCTO_LIN_SUP DECIMAL(28,8)
	DECLARE @PORC_DCTO_TOT_SUP DECIMAL(28,8)
	DECLARE @ARTICULO_APARTADO VARCHAR(20)
	DECLARE @LINEA_INFER1_APART VARCHAR(40)
	DECLARE @LINEA_INFER2_APART VARCHAR(40)
	DECLARE @LINEA_INFER3_APART VARCHAR(40)
	DECLARE @LINEA_INFER4_APART VARCHAR(40)
	DECLARE @DIAS_VENCE_APART INT
	DECLARE @IMPRIMIR_PRELECTURA VARCHAR(1)
	DECLARE @NIVEL_PRECIO VARCHAR(12)
	DECLARE @MONEDA_NIVEL VARCHAR(1)
	DECLARE @USAR_NIVEL_CLIENTE VARCHAR(1)
	DECLARE @USAR_BLOQUEO_AUTOM VARCHAR(1)
	DECLARE @TIEMPO_BLOQUEO INT
	DECLARE @CTR_ABONOS VARCHAR(25)
	DECLARE @CTA_ABONOS VARCHAR(25)
	DECLARE @CTR_CIERRE_CREDITO VARCHAR(25)
	DECLARE @CTA_CIERRE_CREDITO VARCHAR(25)
	DECLARE @CTR_CIERRE_DEBITO VARCHAR(25)
	DECLARE @CTA_CIERRE_DEBITO VARCHAR(25)
	DECLARE @CTR_DIFER_INGRESO VARCHAR(25)
	DECLARE @CTA_DIFER_INGRESO VARCHAR(25)
	DECLARE @CTR_DIFER_EGRESO VARCHAR(25)
	DECLARE @CTA_DIFER_EGRESO VARCHAR(25)
	DECLARE @TIPO_CONTA_OMISION VARCHAR(1)
	DECLARE @CTR_OTROS_INGRESOS VARCHAR(25)
	DECLARE @CTA_OTROS_INGRESOS VARCHAR(25)
	DECLARE @USAR_FECHA_DADA VARCHAR(1)
	DECLARE @CAMPOS_OBLIG_TARJ VARCHAR(1)
	DECLARE @IMPR_DESC_LINEAS VARCHAR(1)
	DECLARE @MODIF_COD_CLIENTE VARCHAR(1)
	DECLARE @VALID_PAGO_DEV_FAC VARCHAR(1)
	DECLARE @CTR_BONO VARCHAR(25)
	DECLARE @CTA_BONO VARCHAR(25)
	DECLARE @MODIF_CLNTS_CONT VARCHAR(1)
	DECLARE @DEVOLUCION_EFECTIVO VARCHAR(1)
	DECLARE @DEVOLUCION_CHEQUE VARCHAR(1)
	DECLARE @DEVOLUCION_TARJETA VARCHAR(1)
	DECLARE @DEVOLUCION_CREDITO VARCHAR(1)
	DECLARE @DEVOLUCION_VALE VARCHAR(1)
	DECLARE @DEVOLUCION_BONO VARCHAR(1)
	DECLARE @DEVOLUCION_DOLAR VARCHAR(1)
	DECLARE @LIMITAR_LINEAS VARCHAR(1)
	DECLARE @CANT_LINEAS_DOCUM INT
	DECLARE @CAPTURA_FECHA_NAC VARCHAR(1)
	DECLARE @CAPTURA_NIT VARCHAR(1)
	DECLARE @CAPTURA_TELEFONO VARCHAR(1)
	DECLARE @AUTOR_DESC_MONTO VARCHAR(1)
	DECLARE @USO_FORMULARIOS VARCHAR(1)
	DECLARE @VIS_MOD_NUM_DOC VARCHAR(1)
	DECLARE @DEV_MENU_PRINCIPAL VARCHAR(1)
	DECLARE @USAR_NOTASCREDITO VARCHAR(1)
	DECLARE @IMPRIMIR_ULT_ABONO VARCHAR(1)
	DECLARE @FACTURA_AL_APARTAR VARCHAR(1)
	DECLARE @CLIENTE_APARTADO VARCHAR(20)
	DECLARE @DESG_CIERRE_CAJERO VARCHAR(1)
	DECLARE @CONTROL_INFO_FISCAL VARCHAR(1)
	DECLARE @AUTO_CAMBIO_PRECIO VARCHAR(1)
	DECLARE @CONDPAG_VENC_APART VARCHAR(4)
	DECLARE @USA_APA_CNDPAG_CLI VARCHAR(1)
	DECLARE @CTA_VTA_APARTADO VARCHAR(25)
	DECLARE @CTR_VTA_APARTADO VARCHAR(25)
	DECLARE @CATEGORIA_CLIENTE VARCHAR(8)
	DECLARE @PORC_MIN_PRI_ABONO DECIMAL(28,8)
	DECLARE @CONTROL_CXC VARCHAR(1)
	DECLARE @CTA_DEVOL_DINERO VARCHAR(25)
	DECLARE @CTR_DEVOL_DINERO VARCHAR(25)
	DECLARE @CONSECUTIVO_DEVOL VARCHAR(10)
	DECLARE @CTA_INV_DESPACHAR VARCHAR(25)
	DECLARE @CTR_INV_DESPACHAR VARCHAR(25)
	DECLARE @PORC_DEVEFE_ANUAPA DECIMAL(28,8)
	DECLARE @CALCULAR_IMP2 VARCHAR(1)
	DECLARE @DIAS_VIGENCIA_DEV DECIMAL(28,8)
	DECLARE @USAR_CADENAS VARCHAR(1)
	DECLARE @DIAS_VIGENCIA_CERT INT
	DECLARE @TIPO_CAMBIO_CIERRE VARCHAR(1)
	DECLARE @CTR_EFECTIVO_LOCAL VARCHAR(25)
	DECLARE @CTA_EFECTIVO_LOCAL VARCHAR(25)
	DECLARE @CTR_EFECTIVO_DOLAR VARCHAR(25)
	DECLARE @CTA_EFECTIVO_DOLAR VARCHAR(25)
	DECLARE @CTR_CHEQUE VARCHAR(25)
	DECLARE @CTA_CHEQUE VARCHAR(25)
	DECLARE @CTR_NOTACREDITO VARCHAR(25)
	DECLARE @CTA_NOTACREDITO VARCHAR(25)
	DECLARE @CTR_CERTIFICADO VARCHAR(25)
	DECLARE @CTA_CERTIFICADO VARCHAR(25)
	DECLARE @CTR_CERTIF_OBSEQUI VARCHAR(25)
	DECLARE @CTA_CERTIF_OBSEQUI VARCHAR(25)
	DECLARE @CTR_CERTIF_VENCIDO VARCHAR(25)
	DECLARE @CTA_CERTIF_VENCIDO VARCHAR(25)
	DECLARE @CTR_NC_VENCIDA VARCHAR(25)
	DECLARE @CTA_NC_VENCIDA VARCHAR(25)
	DECLARE @CONTABILIZAR_DIA VARCHAR(1)
	DECLARE @CONTABILIZAR_CAJA VARCHAR(1)
	DECLARE @CONTABILIZAR_TRANS VARCHAR(1)
	DECLARE @CONTABILIZAR_PAGOS VARCHAR(1)
	DECLARE @SITIO_LOCAL VARCHAR(20)
	DECLARE @BODEGA_CENTRAL VARCHAR(4)
	DECLARE @TIPO_SITIO_LOCAL VARCHAR(1)
	DECLARE @TRASPASO_TIENDA VARCHAR(1)
	DECLARE @USUARIO_WSQM VARCHAR(100)
	DECLARE @USA_BIMONEDA VARCHAR(1)
	DECLARE @DIAS_GRACIA INT
	DECLARE @MANEJA_SERIES	VARCHAR(1)	
	DECLARE	@CIERRE_CAJERO 	VARCHAR(1) 	
	DECLARE @MODIF_INFO_FISCAL VARCHAR(1)	
	DECLARE @PORC_AUMEN_PRE	 DECIMAL (28, 8)	
	DECLARE @PORC_DISMIN_PRE DECIMAL (28, 8)	
	DECLARE @SOLO_CERT_CLIENTE VARCHAR(1)	
	DECLARE @SUBT_CRED_FISCAL INT		
	DECLARE @VALIDA_PRELECTURA VARCHAR(1)	
       	DECLARE	@LOCALIZACION	VARCHAR(8) 
       	DECLARE @MULT_CORRELATIVO VARCHAR(1)
	SET @ERROR = 0

	SELECT  @PUBLICADOR = SITIO_LOCAL, 
		@TIPO_SITIO_LOCAL = TIPO_SITIO_LOCAL, 
		@USUARIO_POS_WSQM = USUARIO_WSQM
	FROM INSERTED  
	
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM) AND @TIPO_SITIO_LOCAL = 'C'
	BEGIN
		DECLARE C_MODIFIED CURSOR LOCAL FOR
			SELECT CONDICION_PAGO, TIPO_ASIENTO, PAQUETE, GRUPO_CAJERO, GRUPO_SUPERVISOR, CLIENTE_OMISION, INGRESO_CANTIDAD, IMPUESTO_INCLUIDO, DETALLE_KITS, REDONDEAR_FACTURA, FACTOR_REDONDEO, INTEGRACION_CONTA, VALIDAR_CHEQUES, PAGO_MIXTO, IMPRESION_DOBLE, MAX_FORMA_PAGO, FOTO_ARTICULO, ESQUEMA_VENDEDOR, MANEJO_LOTE, VERIFICAR_FECHA, VALIDAR_EXISTENCIAS, MODO_APLIC_ASIENTO, IMPRESION_SIMULTANEA, ACTUALIZACION_SIMULTANEA, PERMITE_REDUCCIONES, MOD_CONDICION_PAGO, LINEA_SUPERIOR1, LINEA_SUPERIOR2, LINEA_SUPERIOR3, LINEA_SUPERIOR4, LINEA_INFERIOR1, LINEA_INFERIOR2, LINEA_INFERIOR3, LINEA_INFERIOR4, IMP1_AFECTA_DESCTO, CALCULO_IMPUESTOS, AUTORIZA_PRECIO, PORC_DCTO_LINEA, PORC_DCTO_TOTAL, PORC_DCTO_LIN_SUP, PORC_DCTO_TOT_SUP, ARTICULO_APARTADO, LINEA_INFER1_APART, LINEA_INFER2_APART, LINEA_INFER3_APART, LINEA_INFER4_APART, DIAS_VENCE_APART, IMPRIMIR_PRELECTURA, NIVEL_PRECIO, MONEDA_NIVEL, USAR_NIVEL_CLIENTE, USAR_BLOQUEO_AUTOM, TIEMPO_BLOQUEO, CTR_ABONOS, CTA_ABONOS, CTR_CIERRE_CREDITO, CTA_CIERRE_CREDITO, CTR_CIERRE_DEBITO, CTA_CIERRE_DEBITO, CTR_DIFER_INGRESO, CTA_DIFER_INGRESO, CTR_DIFER_EGRESO, CTA_DIFER_EGRESO, TIPO_CONTA_OMISION, CTR_OTROS_INGRESOS, CTA_OTROS_INGRESOS, USAR_FECHA_DADA, CAMPOS_OBLIG_TARJ, IMPR_DESC_LINEAS, MODIF_COD_CLIENTE, VALID_PAGO_DEV_FAC, CTR_BONO, CTA_BONO, MODIF_CLNTS_CONT, DEVOLUCION_EFECTIVO, DEVOLUCION_CHEQUE, DEVOLUCION_TARJETA, DEVOLUCION_CREDITO, DEVOLUCION_VALE, DEVOLUCION_BONO, DEVOLUCION_DOLAR, LIMITAR_LINEAS, CANT_LINEAS_DOCUM, CAPTURA_FECHA_NAC, CAPTURA_NIT, CAPTURA_TELEFONO, AUTOR_DESC_MONTO, USO_FORMULARIOS, VIS_MOD_NUM_DOC, DEV_MENU_PRINCIPAL, USAR_NOTASCREDITO, IMPRIMIR_ULT_ABONO, FACTURA_AL_APARTAR, CLIENTE_APARTADO, DESG_CIERRE_CAJERO, CONTROL_INFO_FISCAL, AUTO_CAMBIO_PRECIO, CONDPAG_VENC_APART, USA_APA_CNDPAG_CLI, CTA_VTA_APARTADO, CTR_VTA_APARTADO, CATEGORIA_CLIENTE, PORC_MIN_PRI_ABONO, CONTROL_CXC, CTA_DEVOL_DINERO, CTR_DEVOL_DINERO, CONSECUTIVO_DEVOL, CTA_INV_DESPACHAR, CTR_INV_DESPACHAR, PORC_DEVEFE_ANUAPA, CALCULAR_IMP2, DIAS_VIGENCIA_DEV, USAR_CADENAS, DIAS_VIGENCIA_CERT, TIPO_CAMBIO_CIERRE, CTR_EFECTIVO_LOCAL, CTA_EFECTIVO_LOCAL, CTR_EFECTIVO_DOLAR, CTA_EFECTIVO_DOLAR, CTR_CHEQUE, CTA_CHEQUE, CTR_NOTACREDITO, CTA_NOTACREDITO, CTR_CERTIFICADO, CTA_CERTIFICADO, CTR_CERTIF_OBSEQUI, CTA_CERTIF_OBSEQUI, CTR_CERTIF_VENCIDO, CTA_CERTIF_VENCIDO, CTR_NC_VENCIDA, CTA_NC_VENCIDA, CONTABILIZAR_DIA, CONTABILIZAR_CAJA, CONTABILIZAR_TRANS, CONTABILIZAR_PAGOS, SITIO_LOCAL, BODEGA_CENTRAL, TIPO_SITIO_LOCAL, TRASPASO_TIENDA, USUARIO_WSQM, USA_BIMONEDA, DIAS_GRACIA,MANEJA_SERIES,CIERRE_CAJERO,MODIF_INFO_FISCAL,PORC_AUMEN_PRE,PORC_DISMIN_PRE,SOLO_CERT_CLIENTE,SUBT_CRED_FISCAL,VALIDA_PRELECTURA,LOCALIZACION,MULT_CORRELATIVO
			FROM INSERTED I
		SET @ACTUALIZAR_SOLICITUD = 1
		OPEN C_MODIFIED
		FETCH NEXT FROM C_MODIFIED
		INTO @CONDICION_PAGO, @TIPO_ASIENTO, @PAQUETE, @GRUPO_CAJERO, @GRUPO_SUPERVISOR, @CLIENTE_OMISION, @INGRESO_CANTIDAD, @IMPUESTO_INCLUIDO, @DETALLE_KITS, @REDONDEAR_FACTURA, @FACTOR_REDONDEO, @INTEGRACION_CONTA, @VALIDAR_CHEQUES, @PAGO_MIXTO, @IMPRESION_DOBLE, @MAX_FORMA_PAGO, @FOTO_ARTICULO, @ESQUEMA_VENDEDOR, @MANEJO_LOTE, @VERIFICAR_FECHA, @VALIDAR_EXISTENCIAS, @MODO_APLIC_ASIENTO, @IMPRESION_SIMULTANEA, @ACTUALIZACION_SIMULTANEA, @PERMITE_REDUCCIONES, @MOD_CONDICION_PAGO, @LINEA_SUPERIOR1, @LINEA_SUPERIOR2, @LINEA_SUPERIOR3, @LINEA_SUPERIOR4, @LINEA_INFERIOR1, @LINEA_INFERIOR2, @LINEA_INFERIOR3, @LINEA_INFERIOR4, @IMP1_AFECTA_DESCTO, @CALCULO_IMPUESTOS, @AUTORIZA_PRECIO, @PORC_DCTO_LINEA, @PORC_DCTO_TOTAL, @PORC_DCTO_LIN_SUP, @PORC_DCTO_TOT_SUP, @ARTICULO_APARTADO, @LINEA_INFER1_APART, @LINEA_INFER2_APART, @LINEA_INFER3_APART, @LINEA_INFER4_APART, @DIAS_VENCE_APART, @IMPRIMIR_PRELECTURA, @NIVEL_PRECIO, @MONEDA_NIVEL, @USAR_NIVEL_CLIENTE, @USAR_BLOQUEO_AUTOM, @TIEMPO_BLOQUEO, @CTR_ABONOS, @CTA_ABONOS, @CTR_CIERRE_CREDITO, @CTA_CIERRE_CREDITO, @CTR_CIERRE_DEBITO, @CTA_CIERRE_DEBITO, @CTR_DIFER_INGRESO, @CTA_DIFER_INGRESO, @CTR_DIFER_EGRESO, @CTA_DIFER_EGRESO, @TIPO_CONTA_OMISION, @CTR_OTROS_INGRESOS, @CTA_OTROS_INGRESOS, @USAR_FECHA_DADA, @CAMPOS_OBLIG_TARJ, @IMPR_DESC_LINEAS, @MODIF_COD_CLIENTE, @VALID_PAGO_DEV_FAC, @CTR_BONO, @CTA_BONO, @MODIF_CLNTS_CONT, @DEVOLUCION_EFECTIVO, @DEVOLUCION_CHEQUE, @DEVOLUCION_TARJETA, @DEVOLUCION_CREDITO, @DEVOLUCION_VALE, @DEVOLUCION_BONO, @DEVOLUCION_DOLAR, @LIMITAR_LINEAS, @CANT_LINEAS_DOCUM, @CAPTURA_FECHA_NAC, @CAPTURA_NIT, @CAPTURA_TELEFONO, @AUTOR_DESC_MONTO, @USO_FORMULARIOS, @VIS_MOD_NUM_DOC, @DEV_MENU_PRINCIPAL, @USAR_NOTASCREDITO, @IMPRIMIR_ULT_ABONO, @FACTURA_AL_APARTAR, @CLIENTE_APARTADO, @DESG_CIERRE_CAJERO, @CONTROL_INFO_FISCAL, @AUTO_CAMBIO_PRECIO, @CONDPAG_VENC_APART, @USA_APA_CNDPAG_CLI, @CTA_VTA_APARTADO, @CTR_VTA_APARTADO, @CATEGORIA_CLIENTE, @PORC_MIN_PRI_ABONO, @CONTROL_CXC, @CTA_DEVOL_DINERO, @CTR_DEVOL_DINERO, @CONSECUTIVO_DEVOL, @CTA_INV_DESPACHAR, @CTR_INV_DESPACHAR, @PORC_DEVEFE_ANUAPA, @CALCULAR_IMP2, @DIAS_VIGENCIA_DEV, @USAR_CADENAS, @DIAS_VIGENCIA_CERT, @TIPO_CAMBIO_CIERRE, @CTR_EFECTIVO_LOCAL, @CTA_EFECTIVO_LOCAL, @CTR_EFECTIVO_DOLAR, @CTA_EFECTIVO_DOLAR, @CTR_CHEQUE, @CTA_CHEQUE, @CTR_NOTACREDITO, @CTA_NOTACREDITO, @CTR_CERTIFICADO, @CTA_CERTIFICADO, @CTR_CERTIF_OBSEQUI, @CTA_CERTIF_OBSEQUI, @CTR_CERTIF_VENCIDO, @CTA_CERTIF_VENCIDO, @CTR_NC_VENCIDA, @CTA_NC_VENCIDA, @CONTABILIZAR_DIA, @CONTABILIZAR_CAJA, @CONTABILIZAR_TRANS, @CONTABILIZAR_PAGOS, @SITIO_LOCAL, @BODEGA_CENTRAL, @TIPO_SITIO_LOCAL, @TRASPASO_TIENDA, @USUARIO_WSQM, @USA_BIMONEDA,@DIAS_GRACIA,@MANEJA_SERIES,@CIERRE_CAJERO,@MODIF_INFO_FISCAL,@PORC_AUMEN_PRE,@PORC_DISMIN_PRE,@SOLO_CERT_CLIENTE,@SUBT_CRED_FISCAL,@VALIDA_PRELECTURA,@LOCALIZACION,@MULT_CORRELATIVO
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			IF ( NOT UPDATE(RECORDDATE) AND ( UPDATE(CONDICION_PAGO) OR UPDATE(TIPO_ASIENTO) OR UPDATE(PAQUETE) OR UPDATE(GRUPO_CAJERO) OR UPDATE(GRUPO_SUPERVISOR) OR UPDATE(CLIENTE_OMISION) OR UPDATE(INGRESO_CANTIDAD) OR UPDATE(IMPUESTO_INCLUIDO) OR UPDATE(DETALLE_KITS) OR UPDATE(REDONDEAR_FACTURA) OR UPDATE(FACTOR_REDONDEO) OR UPDATE(INTEGRACION_CONTA) OR UPDATE(VALIDAR_CHEQUES) OR UPDATE(PAGO_MIXTO) OR UPDATE(IMPRESION_DOBLE) OR UPDATE(MAX_FORMA_PAGO) OR UPDATE(FOTO_ARTICULO) OR UPDATE(ESQUEMA_VENDEDOR) OR UPDATE(MANEJO_LOTE) OR UPDATE(VERIFICAR_FECHA) OR UPDATE(VALIDAR_EXISTENCIAS) OR UPDATE(MODO_APLIC_ASIENTO) OR UPDATE(IMPRESION_SIMULTANEA) OR UPDATE(ACTUALIZACION_SIMULTANEA) OR UPDATE(PERMITE_REDUCCIONES) OR UPDATE(MOD_CONDICION_PAGO) OR UPDATE(LINEA_SUPERIOR1) OR UPDATE(LINEA_SUPERIOR2) OR UPDATE(LINEA_SUPERIOR3) OR UPDATE(LINEA_SUPERIOR4) OR UPDATE(LINEA_INFERIOR1) OR UPDATE(LINEA_INFERIOR2) OR UPDATE(LINEA_INFERIOR3) OR UPDATE(LINEA_INFERIOR4) OR UPDATE(IMP1_AFECTA_DESCTO) OR UPDATE(CALCULO_IMPUESTOS) OR UPDATE(AUTORIZA_PRECIO) OR UPDATE(PORC_DCTO_LINEA) OR UPDATE(PORC_DCTO_TOTAL) OR UPDATE(PORC_DCTO_LIN_SUP) OR UPDATE(PORC_DCTO_TOT_SUP) OR UPDATE(ARTICULO_APARTADO) OR UPDATE(LINEA_INFER1_APART) OR UPDATE(LINEA_INFER2_APART) OR UPDATE(LINEA_INFER3_APART) OR UPDATE(LINEA_INFER4_APART) OR UPDATE(DIAS_VENCE_APART) OR UPDATE(IMPRIMIR_PRELECTURA) OR UPDATE(NIVEL_PRECIO) OR UPDATE(MONEDA_NIVEL) OR UPDATE(USAR_NIVEL_CLIENTE) OR UPDATE(USAR_BLOQUEO_AUTOM) OR UPDATE(TIEMPO_BLOQUEO) OR UPDATE(CTR_ABONOS) OR UPDATE(CTA_ABONOS) OR UPDATE(CTR_CIERRE_CREDITO) OR UPDATE(CTA_CIERRE_CREDITO) OR UPDATE(CTR_CIERRE_DEBITO) OR UPDATE(CTA_CIERRE_DEBITO) OR UPDATE(CTR_DIFER_INGRESO) OR UPDATE(CTA_DIFER_INGRESO) OR UPDATE(CTR_DIFER_EGRESO) OR UPDATE(CTA_DIFER_EGRESO) OR UPDATE(TIPO_CONTA_OMISION) OR UPDATE(CTR_OTROS_INGRESOS) OR UPDATE(CTA_OTROS_INGRESOS) OR UPDATE(USAR_FECHA_DADA) OR UPDATE(CAMPOS_OBLIG_TARJ) OR UPDATE(IMPR_DESC_LINEAS) OR UPDATE(MODIF_COD_CLIENTE) OR UPDATE(VALID_PAGO_DEV_FAC) OR UPDATE(CTR_BONO) OR UPDATE(CTA_BONO) OR UPDATE(MODIF_CLNTS_CONT) OR UPDATE(DEVOLUCION_EFECTIVO) OR UPDATE(DEVOLUCION_CHEQUE) OR UPDATE(DEVOLUCION_TARJETA) OR UPDATE(DEVOLUCION_CREDITO) OR UPDATE(DEVOLUCION_VALE) OR UPDATE(DEVOLUCION_BONO) OR UPDATE(DEVOLUCION_DOLAR) OR UPDATE(LIMITAR_LINEAS) OR UPDATE(CANT_LINEAS_DOCUM) OR UPDATE(CAPTURA_FECHA_NAC) OR UPDATE(CAPTURA_NIT) OR UPDATE(CAPTURA_TELEFONO) OR UPDATE(AUTOR_DESC_MONTO) OR UPDATE(USO_FORMULARIOS) OR UPDATE(VIS_MOD_NUM_DOC) OR UPDATE(DEV_MENU_PRINCIPAL) OR UPDATE(USAR_NOTASCREDITO) OR UPDATE(IMPRIMIR_ULT_ABONO) OR UPDATE(FACTURA_AL_APARTAR) OR UPDATE(CLIENTE_APARTADO) OR UPDATE(DESG_CIERRE_CAJERO) OR UPDATE(CONTROL_INFO_FISCAL) OR UPDATE(AUTO_CAMBIO_PRECIO) OR UPDATE(CONDPAG_VENC_APART) OR UPDATE(USA_APA_CNDPAG_CLI) OR UPDATE(CTA_VTA_APARTADO) OR UPDATE(CTR_VTA_APARTADO) OR UPDATE(CATEGORIA_CLIENTE) OR UPDATE(PORC_MIN_PRI_ABONO) OR UPDATE(CONTROL_CXC) OR UPDATE(CTA_DEVOL_DINERO) OR UPDATE(CTR_DEVOL_DINERO) OR UPDATE(CONSECUTIVO_DEVOL) OR UPDATE(CTA_INV_DESPACHAR) OR UPDATE(CTR_INV_DESPACHAR) OR UPDATE(PORC_DEVEFE_ANUAPA) OR UPDATE(CALCULAR_IMP2) OR UPDATE(DIAS_VIGENCIA_DEV) OR UPDATE(USAR_CADENAS) OR UPDATE(DIAS_VIGENCIA_CERT) OR UPDATE(TIPO_CAMBIO_CIERRE) OR UPDATE(CTR_EFECTIVO_LOCAL) OR UPDATE(CTA_EFECTIVO_LOCAL) OR UPDATE(CTR_EFECTIVO_DOLAR) OR UPDATE(CTA_EFECTIVO_DOLAR) OR UPDATE(CTR_CHEQUE) OR UPDATE(CTA_CHEQUE) OR UPDATE(CTR_NOTACREDITO) OR UPDATE(CTA_NOTACREDITO) OR UPDATE(CTR_CERTIFICADO) OR UPDATE(CTA_CERTIFICADO) OR UPDATE(CTR_CERTIF_OBSEQUI) OR UPDATE(CTA_CERTIF_OBSEQUI) OR UPDATE(CTR_CERTIF_VENCIDO) OR UPDATE(CTA_CERTIF_VENCIDO) OR UPDATE(CTR_NC_VENCIDA) OR UPDATE(CTA_NC_VENCIDA) OR UPDATE(CONTABILIZAR_DIA) OR UPDATE(CONTABILIZAR_CAJA) OR UPDATE(CONTABILIZAR_TRANS) OR UPDATE(CONTABILIZAR_PAGOS) OR UPDATE(SITIO_LOCAL) OR UPDATE(BODEGA_CENTRAL) OR UPDATE(TIPO_SITIO_LOCAL) OR UPDATE(TRASPASO_TIENDA) OR UPDATE(USUARIO_WSQM) OR UPDATE(USA_BIMONEDA) OR UPDATE(DIAS_GRACIA) OR UPDATE(MANEJA_SERIES) OR UPDATE(CIERRE_CAJERO) OR UPDATE(MODIF_INFO_FISCAL) OR UPDATE(PORC_AUMEN_PRE) OR UPDATE(PORC_DISMIN_PRE) OR UPDATE(SOLO_CERT_CLIENTE) OR UPDATE(SUBT_CRED_FISCAL) OR UPDATE(VALIDA_PRELECTURA) OR UPDATE(LOCALIZACION) OR UPDATE(MULT_CORRELATIVO)) )
			BEGIN
				SELECT @COL_ROWPOINTER = ROWPOINTER
				FROM $$Compania$$.GLOBALES_POS
				
				SET @EMPTY = '@$EMPTY$@'
				SET @SITIO_LOCAL =  NULL
				SET @TIPO_SITIO_LOCAL =  NULL
				
				SET @PARAMETROS =
					'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<GLOBALES_POS>' +
				'<CONDICION_PAGO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CONDICION_PAGO) + '</CONDICION_PAGO>' +
				'<TIPO_ASIENTO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_ASIENTO) + '</TIPO_ASIENTO>' +
				'<PAQUETE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@PAQUETE) + '</PAQUETE>' +
				'<GRUPO_CAJERO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@GRUPO_CAJERO) + '</GRUPO_CAJERO>' +
				'<GRUPO_SUPERVISOR Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@GRUPO_SUPERVISOR) + '</GRUPO_SUPERVISOR>' +
				'<CLIENTE_OMISION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CLIENTE_OMISION) + '</CLIENTE_OMISION>' +
				'<INGRESO_CANTIDAD Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@INGRESO_CANTIDAD) + '</INGRESO_CANTIDAD>' +
				'<IMPUESTO_INCLUIDO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@IMPUESTO_INCLUIDO) + '</IMPUESTO_INCLUIDO>' +
				'<DETALLE_KITS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DETALLE_KITS) + '</DETALLE_KITS>' +
				'<REDONDEAR_FACTURA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@REDONDEAR_FACTURA) + '</REDONDEAR_FACTURA>' +
				'<FACTOR_REDONDEO Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@FACTOR_REDONDEO) + '</FACTOR_REDONDEO>' +
				'<INTEGRACION_CONTA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@INTEGRACION_CONTA) + '</INTEGRACION_CONTA>' +
				'<VALIDAR_CHEQUES Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@VALIDAR_CHEQUES) + '</VALIDAR_CHEQUES>' +
				'<PAGO_MIXTO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@PAGO_MIXTO) + '</PAGO_MIXTO>' +
				'<IMPRESION_DOBLE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@IMPRESION_DOBLE) + '</IMPRESION_DOBLE>' +
				'<MAX_FORMA_PAGO Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@MAX_FORMA_PAGO) + '</MAX_FORMA_PAGO>' +
				'<FOTO_ARTICULO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@FOTO_ARTICULO) + '</FOTO_ARTICULO>' +
				'<ESQUEMA_VENDEDOR Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ESQUEMA_VENDEDOR) + '</ESQUEMA_VENDEDOR>' +
				'<MANEJO_LOTE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@MANEJO_LOTE) + '</MANEJO_LOTE>' +
				'<VERIFICAR_FECHA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@VERIFICAR_FECHA) + '</VERIFICAR_FECHA>' +
				'<VALIDAR_EXISTENCIAS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@VALIDAR_EXISTENCIAS) + '</VALIDAR_EXISTENCIAS>' +
				'<MODO_APLIC_ASIENTO Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@MODO_APLIC_ASIENTO) + '</MODO_APLIC_ASIENTO>' +
				'<IMPRESION_SIMULTANEA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@IMPRESION_SIMULTANEA) + '</IMPRESION_SIMULTANEA>' +
				'<ACTUALIZACION_SIMULTANEA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ACTUALIZACION_SIMULTANEA) + '</ACTUALIZACION_SIMULTANEA>' +
				'<PERMITE_REDUCCIONES Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@PERMITE_REDUCCIONES) + '</PERMITE_REDUCCIONES>' +
				'<MOD_CONDICION_PAGO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@MOD_CONDICION_PAGO) + '</MOD_CONDICION_PAGO>' +
				'<LINEA_SUPERIOR1 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@LINEA_SUPERIOR1) + '</LINEA_SUPERIOR1>' +
				'<LINEA_SUPERIOR2 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@LINEA_SUPERIOR2) + '</LINEA_SUPERIOR2>' +
				'<LINEA_SUPERIOR3 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@LINEA_SUPERIOR3) + '</LINEA_SUPERIOR3>' +
				'<LINEA_SUPERIOR4 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@LINEA_SUPERIOR4) + '</LINEA_SUPERIOR4>' +
				'<LINEA_INFERIOR1 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@LINEA_INFERIOR1) + '</LINEA_INFERIOR1>' +
				'<LINEA_INFERIOR2 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@LINEA_INFERIOR2) + '</LINEA_INFERIOR2>' +
				'<LINEA_INFERIOR3 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@LINEA_INFERIOR3) + '</LINEA_INFERIOR3>' +
				'<LINEA_INFERIOR4 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@LINEA_INFERIOR4) + '</LINEA_INFERIOR4>'
				
			SET @PARAMETROS2 =
				'<IMP1_AFECTA_DESCTO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@IMP1_AFECTA_DESCTO) + '</IMP1_AFECTA_DESCTO>' +
				'<CALCULO_IMPUESTOS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CALCULO_IMPUESTOS) + '</CALCULO_IMPUESTOS>' +
				'<AUTORIZA_PRECIO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@AUTORIZA_PRECIO) + '</AUTORIZA_PRECIO>' +
				'<PORC_DCTO_LINEA Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@PORC_DCTO_LINEA) + '</PORC_DCTO_LINEA>' +
				'<PORC_DCTO_TOTAL Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@PORC_DCTO_TOTAL) + '</PORC_DCTO_TOTAL>' +
				'<PORC_DCTO_LIN_SUP Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@PORC_DCTO_LIN_SUP) + '</PORC_DCTO_LIN_SUP>' +
				'<PORC_DCTO_TOT_SUP Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@PORC_DCTO_TOT_SUP) + '</PORC_DCTO_TOT_SUP>' +
				'<ARTICULO_APARTADO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ARTICULO_APARTADO) + '</ARTICULO_APARTADO>' +
				'<LINEA_INFER1_APART Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@LINEA_INFER1_APART) + '</LINEA_INFER1_APART>' +
				'<LINEA_INFER2_APART Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@LINEA_INFER2_APART) + '</LINEA_INFER2_APART>' +
				'<LINEA_INFER3_APART Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@LINEA_INFER3_APART) + '</LINEA_INFER3_APART>' +
				'<LINEA_INFER4_APART Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@LINEA_INFER4_APART) + '</LINEA_INFER4_APART>' +
				'<DIAS_VENCE_APART Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@DIAS_VENCE_APART) + '</DIAS_VENCE_APART>' +
				'<IMPRIMIR_PRELECTURA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@IMPRIMIR_PRELECTURA) + '</IMPRIMIR_PRELECTURA>' +
				'<NIVEL_PRECIO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NIVEL_PRECIO) + '</NIVEL_PRECIO>' +
				'<MONEDA_NIVEL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@MONEDA_NIVEL) + '</MONEDA_NIVEL>' +
				'<USAR_NIVEL_CLIENTE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USAR_NIVEL_CLIENTE) + '</USAR_NIVEL_CLIENTE>' +
				'<USAR_BLOQUEO_AUTOM Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USAR_BLOQUEO_AUTOM) + '</USAR_BLOQUEO_AUTOM>' +
				'<TIEMPO_BLOQUEO Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@TIEMPO_BLOQUEO) + '</TIEMPO_BLOQUEO>' +
				'<CTR_ABONOS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_ABONOS) + '</CTR_ABONOS>' +
				'<CTA_ABONOS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_ABONOS) + '</CTA_ABONOS>' +
				'<CTR_CIERRE_CREDITO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_CIERRE_CREDITO) + '</CTR_CIERRE_CREDITO>' +
				'<CTA_CIERRE_CREDITO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_CIERRE_CREDITO) + '</CTA_CIERRE_CREDITO>' +
				'<CTR_CIERRE_DEBITO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_CIERRE_DEBITO) + '</CTR_CIERRE_DEBITO>' +
				'<CTA_CIERRE_DEBITO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_CIERRE_DEBITO) + '</CTA_CIERRE_DEBITO>' +
				'<CTR_DIFER_INGRESO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_DIFER_INGRESO) + '</CTR_DIFER_INGRESO>' +
				'<CTA_DIFER_INGRESO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_DIFER_INGRESO) + '</CTA_DIFER_INGRESO>' +
				'<CTR_DIFER_EGRESO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_DIFER_EGRESO) + '</CTR_DIFER_EGRESO>' +
				'<CTA_DIFER_EGRESO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_DIFER_EGRESO) + '</CTA_DIFER_EGRESO>' +
				'<TIPO_CONTA_OMISION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_CONTA_OMISION) + '</TIPO_CONTA_OMISION>' +
				'<CTR_OTROS_INGRESOS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_OTROS_INGRESOS) + '</CTR_OTROS_INGRESOS>' +
				'<CTA_OTROS_INGRESOS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_OTROS_INGRESOS) + '</CTA_OTROS_INGRESOS>' +
				'<USAR_FECHA_DADA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USAR_FECHA_DADA) + '</USAR_FECHA_DADA>' +
				'<CAMPOS_OBLIG_TARJ Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CAMPOS_OBLIG_TARJ) + '</CAMPOS_OBLIG_TARJ>' +
				'<IMPR_DESC_LINEAS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@IMPR_DESC_LINEAS) + '</IMPR_DESC_LINEAS>' +
				'<MODIF_COD_CLIENTE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@MODIF_COD_CLIENTE) + '</MODIF_COD_CLIENTE>' +
				'<VALID_PAGO_DEV_FAC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@VALID_PAGO_DEV_FAC) + '</VALID_PAGO_DEV_FAC>' +
				'<CTR_BONO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_BONO) + '</CTR_BONO>' +
				'<CTA_BONO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_BONO) + '</CTA_BONO>' +
				'<MODIF_CLNTS_CONT Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@MODIF_CLNTS_CONT) + '</MODIF_CLNTS_CONT>' +
				'<DEVOLUCION_EFECTIVO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DEVOLUCION_EFECTIVO) + '</DEVOLUCION_EFECTIVO>' +
				'<DEVOLUCION_CHEQUE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DEVOLUCION_CHEQUE) + '</DEVOLUCION_CHEQUE>' +
				'<DEVOLUCION_TARJETA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DEVOLUCION_TARJETA) + '</DEVOLUCION_TARJETA>' +
				'<DEVOLUCION_CREDITO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DEVOLUCION_CREDITO) + '</DEVOLUCION_CREDITO>' +
				'<DEVOLUCION_VALE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DEVOLUCION_VALE) + '</DEVOLUCION_VALE>' +
				'<DEVOLUCION_BONO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DEVOLUCION_BONO) + '</DEVOLUCION_BONO>' +
				'<DEVOLUCION_DOLAR Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DEVOLUCION_DOLAR) + '</DEVOLUCION_DOLAR>'
				
			SET @PARAMETROS3 =	
				'<LIMITAR_LINEAS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@LIMITAR_LINEAS) + '</LIMITAR_LINEAS>' +
				'<CANT_LINEAS_DOCUM Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@CANT_LINEAS_DOCUM) + '</CANT_LINEAS_DOCUM>' +
				'<CAPTURA_FECHA_NAC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CAPTURA_FECHA_NAC) + '</CAPTURA_FECHA_NAC>' +
				'<CAPTURA_NIT Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CAPTURA_NIT) + '</CAPTURA_NIT>' +
				'<CAPTURA_TELEFONO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CAPTURA_TELEFONO) + '</CAPTURA_TELEFONO>' +
				'<AUTOR_DESC_MONTO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@AUTOR_DESC_MONTO) + '</AUTOR_DESC_MONTO>' +
				'<USO_FORMULARIOS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USO_FORMULARIOS) + '</USO_FORMULARIOS>' +
				'<VIS_MOD_NUM_DOC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@VIS_MOD_NUM_DOC) + '</VIS_MOD_NUM_DOC>' +
				'<DEV_MENU_PRINCIPAL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DEV_MENU_PRINCIPAL) + '</DEV_MENU_PRINCIPAL>' +
				'<USAR_NOTASCREDITO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USAR_NOTASCREDITO) + '</USAR_NOTASCREDITO>' +
				'<IMPRIMIR_ULT_ABONO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@IMPRIMIR_ULT_ABONO) + '</IMPRIMIR_ULT_ABONO>' +
				'<FACTURA_AL_APARTAR Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@FACTURA_AL_APARTAR) + '</FACTURA_AL_APARTAR>' +
				'<CLIENTE_APARTADO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CLIENTE_APARTADO) + '</CLIENTE_APARTADO>' +
				'<DESG_CIERRE_CAJERO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DESG_CIERRE_CAJERO) + '</DESG_CIERRE_CAJERO>' +
				'<CONTROL_INFO_FISCAL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CONTROL_INFO_FISCAL) + '</CONTROL_INFO_FISCAL>' +
				'<AUTO_CAMBIO_PRECIO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@AUTO_CAMBIO_PRECIO) + '</AUTO_CAMBIO_PRECIO>' +
				'<CONDPAG_VENC_APART Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CONDPAG_VENC_APART) + '</CONDPAG_VENC_APART>' +
				'<USA_APA_CNDPAG_CLI Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USA_APA_CNDPAG_CLI) + '</USA_APA_CNDPAG_CLI>' +
				'<CTA_VTA_APARTADO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_VTA_APARTADO) + '</CTA_VTA_APARTADO>' +
				'<CTR_VTA_APARTADO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_VTA_APARTADO) + '</CTR_VTA_APARTADO>' +
				'<CATEGORIA_CLIENTE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CATEGORIA_CLIENTE) + '</CATEGORIA_CLIENTE>' +
				'<PORC_MIN_PRI_ABONO Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@PORC_MIN_PRI_ABONO) + '</PORC_MIN_PRI_ABONO>' +
				'<CONTROL_CXC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CONTROL_CXC) + '</CONTROL_CXC>' +
				'<CTA_DEVOL_DINERO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_DEVOL_DINERO) + '</CTA_DEVOL_DINERO>' +
				'<CTR_DEVOL_DINERO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_DEVOL_DINERO) + '</CTR_DEVOL_DINERO>' +
				'<CONSECUTIVO_DEVOL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CONSECUTIVO_DEVOL) + '</CONSECUTIVO_DEVOL>' +
				'<CTA_INV_DESPACHAR Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_INV_DESPACHAR) + '</CTA_INV_DESPACHAR>' +
				'<CTR_INV_DESPACHAR Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_INV_DESPACHAR) + '</CTR_INV_DESPACHAR>' +
				'<PORC_DEVEFE_ANUAPA Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@PORC_DEVEFE_ANUAPA) + '</PORC_DEVEFE_ANUAPA>' +
				'<CALCULAR_IMP2 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CALCULAR_IMP2) + '</CALCULAR_IMP2>' +
				'<DIAS_VIGENCIA_DEV Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@DIAS_VIGENCIA_DEV) + '</DIAS_VIGENCIA_DEV>' +
				'<USAR_CADENAS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USAR_CADENAS) + '</USAR_CADENAS>' +
				'<DIAS_VIGENCIA_CERT Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@DIAS_VIGENCIA_CERT) + '</DIAS_VIGENCIA_CERT>' +
				'<TIPO_CAMBIO_CIERRE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_CAMBIO_CIERRE) + '</TIPO_CAMBIO_CIERRE>'
				
			SET @PARAMETROS4 =
				'<CTR_EFECTIVO_LOCAL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_EFECTIVO_LOCAL) + '</CTR_EFECTIVO_LOCAL>' +
				'<CTA_EFECTIVO_LOCAL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_EFECTIVO_LOCAL) + '</CTA_EFECTIVO_LOCAL>' +
				'<CTR_EFECTIVO_DOLAR Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_EFECTIVO_DOLAR) + '</CTR_EFECTIVO_DOLAR>' +
				'<CTA_EFECTIVO_DOLAR Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_EFECTIVO_DOLAR) + '</CTA_EFECTIVO_DOLAR>' +
				'<CTR_CHEQUE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_CHEQUE) + '</CTR_CHEQUE>' +
				'<CTA_CHEQUE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_CHEQUE) + '</CTA_CHEQUE>' +
				'<CTR_NOTACREDITO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_NOTACREDITO) + '</CTR_NOTACREDITO>' +
				'<CTA_NOTACREDITO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_NOTACREDITO) + '</CTA_NOTACREDITO>' +
				'<CTR_CERTIFICADO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_CERTIFICADO) + '</CTR_CERTIFICADO>' +
				'<CTA_CERTIFICADO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_CERTIFICADO) + '</CTA_CERTIFICADO>' +
				'<CTR_CERTIF_OBSEQUI Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_CERTIF_OBSEQUI) + '</CTR_CERTIF_OBSEQUI>' +
				'<CTA_CERTIF_OBSEQUI Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_CERTIF_OBSEQUI) + '</CTA_CERTIF_OBSEQUI>' +
				'<CTR_CERTIF_VENCIDO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_CERTIF_VENCIDO) + '</CTR_CERTIF_VENCIDO>' +
				'<CTA_CERTIF_VENCIDO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_CERTIF_VENCIDO) + '</CTA_CERTIF_VENCIDO>' +
				'<CTR_NC_VENCIDA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_NC_VENCIDA) + '</CTR_NC_VENCIDA>' +
				'<CTA_NC_VENCIDA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_NC_VENCIDA) + '</CTA_NC_VENCIDA>' +
				'<CONTABILIZAR_DIA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CONTABILIZAR_DIA) + '</CONTABILIZAR_DIA>' +
				'<CONTABILIZAR_CAJA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CONTABILIZAR_CAJA) + '</CONTABILIZAR_CAJA>' +
				'<CONTABILIZAR_TRANS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CONTABILIZAR_TRANS) + '</CONTABILIZAR_TRANS>' +
				'<CONTABILIZAR_PAGOS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CONTABILIZAR_PAGOS) + '</CONTABILIZAR_PAGOS>' +
				'<SITIO_LOCAL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@EMPTY) + '</SITIO_LOCAL>' +
				'<BODEGA_CENTRAL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@BODEGA_CENTRAL) + '</BODEGA_CENTRAL>' +
				'<TIPO_SITIO_LOCAL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@EMPTY) + '</TIPO_SITIO_LOCAL>' +
				'<TRASPASO_TIENDA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TRASPASO_TIENDA) + '</TRASPASO_TIENDA>' +
				'<USUARIO_WSQM Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USUARIO_WSQM) + '</USUARIO_WSQM>' +
				'<USA_BIMONEDA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USA_BIMONEDA) + '</USA_BIMONEDA>' +
				'<DIAS_GRACIA Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@DIAS_GRACIA) + '</DIAS_GRACIA>' + 				
				'<MANEJA_SERIES Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@MANEJA_SERIES) + '</MANEJA_SERIES>' +
				'<CIERRE_CAJERO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CIERRE_CAJERO) + '</CIERRE_CAJERO>' +
				'<MODIF_INFO_FISCAL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@MODIF_INFO_FISCAL) + '</MODIF_INFO_FISCAL>' +
				'<PORC_AUMEN_PRE Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@PORC_AUMEN_PRE) + '</PORC_AUMEN_PRE>' +
				'<PORC_DISMIN_PRE Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@PORC_DISMIN_PRE) + '</PORC_DISMIN_PRE>' +
				'<SOLO_CERT_CLIENTE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@SOLO_CERT_CLIENTE) + '</SOLO_CERT_CLIENTE>' +
				'<SUBT_CRED_FISCAL Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@SUBT_CRED_FISCAL) + '</SUBT_CRED_FISCAL>' +
				'<VALIDA_PRELECTURA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@VALIDA_PRELECTURA) + '</VALIDA_PRELECTURA>' +
				'<LOCALIZACION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@LOCALIZACION) + '</LOCALIZACION>' +
				'<MULT_CORRELATIVO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@MULT_CORRELATIVO) + '</MULT_CORRELATIVO>' +				
				'</GLOBALES_POS>'
				-- inserta la solicitud correspondiente
				
				EXECUTE  ('ERPADMIN.POS_InsertarSolicitud ''' + @PUBLICADOR + ''', ''GLOBALESPOSPOS600'', ''MODIFICA'', ''' + @PARAMETROS + @PARAMETROS2 + @PARAMETROS3 + @PARAMETROS4 + ''', ' + @ACTUALIZAR_SOLICITUD + ', ''' + @COL_ROWPOINTER + '''')
			END
			FETCH NEXT FROM C_MODIFIED
			INTO @CONDICION_PAGO, @TIPO_ASIENTO, @PAQUETE, @GRUPO_CAJERO, @GRUPO_SUPERVISOR, @CLIENTE_OMISION, @INGRESO_CANTIDAD, @IMPUESTO_INCLUIDO, @DETALLE_KITS, @REDONDEAR_FACTURA, @FACTOR_REDONDEO, @INTEGRACION_CONTA, @VALIDAR_CHEQUES, @PAGO_MIXTO, @IMPRESION_DOBLE, @MAX_FORMA_PAGO, @FOTO_ARTICULO, @ESQUEMA_VENDEDOR, @MANEJO_LOTE, @VERIFICAR_FECHA, @VALIDAR_EXISTENCIAS, @MODO_APLIC_ASIENTO, @IMPRESION_SIMULTANEA, @ACTUALIZACION_SIMULTANEA, @PERMITE_REDUCCIONES, @MOD_CONDICION_PAGO, @LINEA_SUPERIOR1, @LINEA_SUPERIOR2, @LINEA_SUPERIOR3, @LINEA_SUPERIOR4, @LINEA_INFERIOR1, @LINEA_INFERIOR2, @LINEA_INFERIOR3, @LINEA_INFERIOR4, @IMP1_AFECTA_DESCTO, @CALCULO_IMPUESTOS, @AUTORIZA_PRECIO, @PORC_DCTO_LINEA, @PORC_DCTO_TOTAL, @PORC_DCTO_LIN_SUP, @PORC_DCTO_TOT_SUP, @ARTICULO_APARTADO, @LINEA_INFER1_APART, @LINEA_INFER2_APART, @LINEA_INFER3_APART, @LINEA_INFER4_APART, @DIAS_VENCE_APART, @IMPRIMIR_PRELECTURA, @NIVEL_PRECIO, @MONEDA_NIVEL, @USAR_NIVEL_CLIENTE, @USAR_BLOQUEO_AUTOM, @TIEMPO_BLOQUEO, @CTR_ABONOS, @CTA_ABONOS, @CTR_CIERRE_CREDITO, @CTA_CIERRE_CREDITO, @CTR_CIERRE_DEBITO, @CTA_CIERRE_DEBITO, @CTR_DIFER_INGRESO, @CTA_DIFER_INGRESO, @CTR_DIFER_EGRESO, @CTA_DIFER_EGRESO, @TIPO_CONTA_OMISION, @CTR_OTROS_INGRESOS, @CTA_OTROS_INGRESOS, @USAR_FECHA_DADA, @CAMPOS_OBLIG_TARJ, @IMPR_DESC_LINEAS, @MODIF_COD_CLIENTE, @VALID_PAGO_DEV_FAC, @CTR_BONO, @CTA_BONO, @MODIF_CLNTS_CONT, @DEVOLUCION_EFECTIVO, @DEVOLUCION_CHEQUE, @DEVOLUCION_TARJETA, @DEVOLUCION_CREDITO, @DEVOLUCION_VALE, @DEVOLUCION_BONO, @DEVOLUCION_DOLAR, @LIMITAR_LINEAS, @CANT_LINEAS_DOCUM, @CAPTURA_FECHA_NAC, @CAPTURA_NIT, @CAPTURA_TELEFONO, @AUTOR_DESC_MONTO, @USO_FORMULARIOS, @VIS_MOD_NUM_DOC, @DEV_MENU_PRINCIPAL, @USAR_NOTASCREDITO, @IMPRIMIR_ULT_ABONO, @FACTURA_AL_APARTAR, @CLIENTE_APARTADO, @DESG_CIERRE_CAJERO, @CONTROL_INFO_FISCAL, @AUTO_CAMBIO_PRECIO, @CONDPAG_VENC_APART, @USA_APA_CNDPAG_CLI, @CTA_VTA_APARTADO, @CTR_VTA_APARTADO, @CATEGORIA_CLIENTE, @PORC_MIN_PRI_ABONO, @CONTROL_CXC, @CTA_DEVOL_DINERO, @CTR_DEVOL_DINERO, @CONSECUTIVO_DEVOL, @CTA_INV_DESPACHAR, @CTR_INV_DESPACHAR, @PORC_DEVEFE_ANUAPA, @CALCULAR_IMP2, @DIAS_VIGENCIA_DEV, @USAR_CADENAS, @DIAS_VIGENCIA_CERT, @TIPO_CAMBIO_CIERRE, @CTR_EFECTIVO_LOCAL, @CTA_EFECTIVO_LOCAL, @CTR_EFECTIVO_DOLAR, @CTA_EFECTIVO_DOLAR, @CTR_CHEQUE, @CTA_CHEQUE, @CTR_NOTACREDITO, @CTA_NOTACREDITO, @CTR_CERTIFICADO, @CTA_CERTIFICADO, @CTR_CERTIF_OBSEQUI, @CTA_CERTIF_OBSEQUI, @CTR_CERTIF_VENCIDO, @CTA_CERTIF_VENCIDO, @CTR_NC_VENCIDA, @CTA_NC_VENCIDA, @CONTABILIZAR_DIA, @CONTABILIZAR_CAJA, @CONTABILIZAR_TRANS, @CONTABILIZAR_PAGOS, @SITIO_LOCAL, @BODEGA_CENTRAL, @TIPO_SITIO_LOCAL, @TRASPASO_TIENDA, @USUARIO_WSQM, @USA_BIMONEDA, @DIAS_GRACIA,@MANEJA_SERIES,@CIERRE_CAJERO,@MODIF_INFO_FISCAL,@PORC_AUMEN_PRE,@PORC_DISMIN_PRE,@SOLO_CERT_CLIENTE,@SUBT_CRED_FISCAL,@VALIDA_PRELECTURA,@LOCALIZACION,@MULT_CORRELATIVO
		END
		CLOSE C_MODIFIED
		DEALLOCATE C_MODIFIED
	END
	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para modificar la tabla GLOBALES_POS.',16,1 )
	END
END
;
CREATE TRIGGER $$Compania$$.GRUPO_POS_INS
ON $$Compania$$.GRUPO
FOR INSERT
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @GRUPO VARCHAR(6)
	DECLARE @DESCRIPCION VARCHAR(40)
	DECLARE @SUCURSAL VARCHAR(1)
	DECLARE @LINEA_SUPERIOR1 VARCHAR(254)
	DECLARE @LINEA_SUPERIOR2 VARCHAR(254)
	DECLARE @LINEA_SUPERIOR3 VARCHAR(254)
	DECLARE @LINEA_SUPERIOR4 VARCHAR(254)
	DECLARE @LINEA_INFERIOR1 VARCHAR(254)
	DECLARE @LINEA_INFERIOR2 VARCHAR(254)
	DECLARE @LINEA_INFERIOR3 VARCHAR(254)
	DECLARE @LINEA_INFERIOR4 VARCHAR(254)
	DECLARE @ULT_CIERRE INT
	DECLARE @FECHA DATETIME
	DECLARE @ABONO_APRT_VENCIDO VARCHAR(1)
	DECLARE @NIVEL_PRECIO VARCHAR(12)
	DECLARE @MONEDA_NIVEL VARCHAR(1)
	DECLARE @CADENA VARCHAR(20)
	DECLARE @CONSECUTIVO_CI VARCHAR(10)
	DECLARE @CONSEC_CIERRE VARCHAR(20)
	DECLARE @TIPO_SITIO_LOCAL VARCHAR(1)
	DECLARE @NCF_UNICO VARCHAR(20) 

	SELECT @PUBLICADOR = SITIO_LOCAL,
		@USUARIO_POS_WSQM = USUARIO_WSQM,
		@TIPO_SITIO_LOCAL = TIPO_SITIO_LOCAL
  	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM) AND @TIPO_SITIO_LOCAL = 'C'
	BEGIN
		DECLARE C_INSERTED CURSOR LOCAL FOR
		SELECT GRUPO, DESCRIPCION, SUCURSAL, LINEA_SUPERIOR1, LINEA_SUPERIOR2, LINEA_SUPERIOR3, LINEA_SUPERIOR4, LINEA_INFERIOR1, LINEA_INFERIOR2, LINEA_INFERIOR3, LINEA_INFERIOR4, ULT_CIERRE, FECHA, ABONO_APRT_VENCIDO, NIVEL_PRECIO, MONEDA_NIVEL, CADENA, CONSECUTIVO_CI, CONSEC_CIERRE, NCF_UNICO
		FROM INSERTED i
		WHERE 0 = (
				SELECT COUNT('n')
				FROM DELETED d
				WHERE i.GRUPO = d.GRUPO
			   )
			
		OPEN C_INSERTED	
		FETCH NEXT FROM C_INSERTED INTO
		@GRUPO, @DESCRIPCION, @SUCURSAL, @LINEA_SUPERIOR1, @LINEA_SUPERIOR2, @LINEA_SUPERIOR3, @LINEA_SUPERIOR4, @LINEA_INFERIOR1, @LINEA_INFERIOR2, @LINEA_INFERIOR3, @LINEA_INFERIOR4, @ULT_CIERRE, @FECHA, @ABONO_APRT_VENCIDO, @NIVEL_PRECIO, @MONEDA_NIVEL, @CADENA, @CONSECUTIVO_CI, @CONSEC_CIERRE, @NCF_UNICO
		SET @ERROR = 0
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS = 
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<GRUPO>' + 
				'<GRUPO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@GRUPO) + '</GRUPO>' + 
				'<DESCRIPCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DESCRIPCION) + '</DESCRIPCION>' + 
				'<SUCURSAL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@SUCURSAL) + '</SUCURSAL>' + 
				'<LINEA_SUPERIOR1 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@LINEA_SUPERIOR1) + '</LINEA_SUPERIOR1>' + 
				'<LINEA_SUPERIOR2 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@LINEA_SUPERIOR2) + '</LINEA_SUPERIOR2>' + 
				'<LINEA_SUPERIOR3 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@LINEA_SUPERIOR3) + '</LINEA_SUPERIOR3>' + 
				'<LINEA_SUPERIOR4 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@LINEA_SUPERIOR4) + '</LINEA_SUPERIOR4>' + 
				'<LINEA_INFERIOR1 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@LINEA_INFERIOR1) + '</LINEA_INFERIOR1>' + 
				'<LINEA_INFERIOR2 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@LINEA_INFERIOR2) + '</LINEA_INFERIOR2>' + 
				'<LINEA_INFERIOR3 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@LINEA_INFERIOR3) + '</LINEA_INFERIOR3>' + 
				'<LINEA_INFERIOR4 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@LINEA_INFERIOR4) + '</LINEA_INFERIOR4>' + 
				'<ULT_CIERRE Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@ULT_CIERRE) + '</ULT_CIERRE>' + 
				'<FECHA Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA) + '</FECHA>' + 
				'<ABONO_APRT_VENCIDO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ABONO_APRT_VENCIDO) + '</ABONO_APRT_VENCIDO>' + 
				'<NIVEL_PRECIO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NIVEL_PRECIO) + '</NIVEL_PRECIO>' + 
				'<MONEDA_NIVEL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@MONEDA_NIVEL) + '</MONEDA_NIVEL>' + 
				'<CADENA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CADENA) + '</CADENA>' + 
				'<CONSECUTIVO_CI Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CONSECUTIVO_CI) + '</CONSECUTIVO_CI>' + 
				'<CONSEC_CIERRE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CONSEC_CIERRE) + '</CONSEC_CIERRE>' + 
				'<NCF_UNICO	Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NCF_UNICO) + '</NCF_UNICO>' + 
				'</GRUPO>'
			-- Inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'GRUPOPOS600', 'INSERTA', @PARAMETROS, 0, ''
			FETCH NEXT FROM C_INSERTED INTO
			@GRUPO, @DESCRIPCION, @SUCURSAL, @LINEA_SUPERIOR1, @LINEA_SUPERIOR2, @LINEA_SUPERIOR3, @LINEA_SUPERIOR4, @LINEA_INFERIOR1, @LINEA_INFERIOR2, @LINEA_INFERIOR3, @LINEA_INFERIOR4, @ULT_CIERRE, @FECHA, @ABONO_APRT_VENCIDO, @NIVEL_PRECIO, @MONEDA_NIVEL, @CADENA, @CONSECUTIVO_CI, @CONSEC_CIERRE, @NCF_UNICO
		END
		CLOSE C_INSERTED
    		DEALLOCATE C_INSERTED
	END
	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla GRUPO.',16,1 )
	END
END
;




CREATE TRIGGER $$Compania$$.GRUPO_POS_DEL
ON $$Compania$$.GRUPO
FOR DELETE  
AS 
BEGIN   	
                DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @TIPO_SITIO_LOCAL VARCHAR(1)
	DECLARE @GRUPO VARCHAR(6)
	 -- Declaraciones	
	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM ,
		@TIPO_SITIO_LOCAL = TIPO_SITIO_LOCAL
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM) AND @TIPO_SITIO_LOCAL = 'C'
	BEGIN
		DECLARE C_DELETED CURSOR LOCAL FOR
			SELECT GRUPO
			FROM DELETED d
			WHERE 0 = (
				SELECT COUNT('n')
				FROM INSERTED i
				WHERE d.GRUPO = i.GRUPO
			   )
		OPEN C_DELETED
		FETCH NEXT FROM C_DELETED INTO 
		@GRUPO
		
		SET @ERROR = 0
		
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS = 
								'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<GRUPO>' + 
				'<GRUPO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@GRUPO) + '</GRUPO>' + 
				'</GRUPO>'
 -- XML
			
			-- inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'GRUPOPOS600', 'ELIMINA', @PARAMETROS, 0, ''
			
			FETCH NEXT FROM C_DELETED INTO 
			@GRUPO
		END
		CLOSE C_DELETED
		DEALLOCATE C_DELETED
	END
	
	IF (@@ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para eliminar de la tabla GRUPO.',16,1 )
	END
END
;




CREATE TRIGGER $$Compania$$.GRUPO_POS_MOD
ON $$Compania$$.GRUPO
FOR UPDATE
AS 
BEGIN   	
	DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @COL_ROWPOINTER VARCHAR(36)
	DECLARE @HAY_CAMPOS_PARA_POS BIT
	DECLARE @ACTUALIZAR_SOLICITUD BIT
	DECLARE @TIPO_SITIO_LOCAL VARCHAR(1)
	DECLARE @GRUPO VARCHAR(6)
	DECLARE @DESCRIPCION VARCHAR(40)
	DECLARE @SUCURSAL VARCHAR(1)
	DECLARE @LINEA_SUPERIOR1 VARCHAR(254)
	DECLARE @LINEA_SUPERIOR2 VARCHAR(254)
	DECLARE @LINEA_SUPERIOR3 VARCHAR(254)
	DECLARE @LINEA_SUPERIOR4 VARCHAR(254)
	DECLARE @LINEA_INFERIOR1 VARCHAR(254)
	DECLARE @LINEA_INFERIOR2 VARCHAR(254)
	DECLARE @LINEA_INFERIOR3 VARCHAR(254)
	DECLARE @LINEA_INFERIOR4 VARCHAR(254)
	DECLARE @ULT_CIERRE INT
	DECLARE @FECHA DATETIME
	DECLARE @ABONO_APRT_VENCIDO VARCHAR(1)
	DECLARE @NIVEL_PRECIO VARCHAR(12)
	DECLARE @MONEDA_NIVEL VARCHAR(1)
	DECLARE @CADENA VARCHAR(20)
	DECLARE @CONSECUTIVO_CI VARCHAR(10)
	DECLARE @CONSEC_CIERRE VARCHAR(20)
	DECLARE @NCF_UNICO VARCHAR(20) 
	
	SELECT @PUBLICADOR = SITIO_LOCAL,
		@USUARIO_POS_WSQM = USUARIO_WSQM,
		@TIPO_SITIO_LOCAL = TIPO_SITIO_LOCAL
  	FROM $$Compania$$.GLOBALES_POS
	SET @ERROR = 0
	-- Aqu se hace la validacin del usuario de conexin para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_MODIFIED CURSOR LOCAL FOR
			SELECT GRUPO, DESCRIPCION, SUCURSAL, LINEA_SUPERIOR1, LINEA_SUPERIOR2, LINEA_SUPERIOR3, LINEA_SUPERIOR4, LINEA_INFERIOR1, LINEA_INFERIOR2, LINEA_INFERIOR3, LINEA_INFERIOR4, ULT_CIERRE, FECHA, ABONO_APRT_VENCIDO, NIVEL_PRECIO, MONEDA_NIVEL, CADENA, CONSECUTIVO_CI, CONSEC_CIERRE, NCF_UNICO
			FROM INSERTED I
		SET @ACTUALIZAR_SOLICITUD = 0
		OPEN C_MODIFIED
		FETCH NEXT FROM C_MODIFIED
		INTO @GRUPO, @DESCRIPCION, @SUCURSAL, @LINEA_SUPERIOR1, @LINEA_SUPERIOR2, @LINEA_SUPERIOR3, @LINEA_SUPERIOR4, @LINEA_INFERIOR1, @LINEA_INFERIOR2, @LINEA_INFERIOR3, @LINEA_INFERIOR4, @ULT_CIERRE, @FECHA, @ABONO_APRT_VENCIDO, @NIVEL_PRECIO, @MONEDA_NIVEL, @CADENA, @CONSECUTIVO_CI, @CONSEC_CIERRE, @NCF_UNICO
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			IF ( NOT UPDATE(RECORDDATE) AND ( UPDATE(GRUPO) OR  UPDATE(DESCRIPCION) OR  UPDATE(SUCURSAL) OR  UPDATE(LINEA_SUPERIOR1) OR  UPDATE(LINEA_SUPERIOR2) OR  UPDATE(LINEA_SUPERIOR3) OR  UPDATE(LINEA_SUPERIOR4) OR  UPDATE(LINEA_INFERIOR1) OR  UPDATE(LINEA_INFERIOR2) OR  UPDATE(LINEA_INFERIOR3) OR  UPDATE(LINEA_INFERIOR4) OR  UPDATE(ULT_CIERRE) OR  UPDATE(FECHA) OR  UPDATE(ABONO_APRT_VENCIDO) OR  UPDATE(NIVEL_PRECIO) OR  UPDATE(MONEDA_NIVEL) OR  UPDATE(CADENA) OR  UPDATE(CONSECUTIVO_CI) OR  UPDATE(CONSEC_CIERRE) OR UPDATE(NCF_UNICO) ))
			BEGIN
				SELECT @COL_ROWPOINTER = ROWPOINTER 
				FROM $$Compania$$.GRUPO
				WHERE GRUPO = @GRUPO 

				IF @TIPO_SITIO_LOCAL = 'C'
				BEGIN
					SET @PARAMETROS =
						'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
					'<GRUPO>' + 
					'<GRUPO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@GRUPO) + '</GRUPO>' + 
					'<DESCRIPCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DESCRIPCION) + '</DESCRIPCION>' + 
					'<SUCURSAL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@SUCURSAL) + '</SUCURSAL>' + 
					'<LINEA_SUPERIOR1 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@LINEA_SUPERIOR1) + '</LINEA_SUPERIOR1>' + 
					'<LINEA_SUPERIOR2 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@LINEA_SUPERIOR2) + '</LINEA_SUPERIOR2>' + 
					'<LINEA_SUPERIOR3 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@LINEA_SUPERIOR3) + '</LINEA_SUPERIOR3>' + 
					'<LINEA_SUPERIOR4 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@LINEA_SUPERIOR4) + '</LINEA_SUPERIOR4>' + 
					'<LINEA_INFERIOR1 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@LINEA_INFERIOR1) + '</LINEA_INFERIOR1>' + 
					'<LINEA_INFERIOR2 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@LINEA_INFERIOR2) + '</LINEA_INFERIOR2>' + 
					'<LINEA_INFERIOR3 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@LINEA_INFERIOR3) + '</LINEA_INFERIOR3>' + 
					'<LINEA_INFERIOR4 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@LINEA_INFERIOR4) + '</LINEA_INFERIOR4>' + 
					'<FECHA Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA) + '</FECHA>' + 
					'<ABONO_APRT_VENCIDO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ABONO_APRT_VENCIDO) + '</ABONO_APRT_VENCIDO>' + 
					'<NIVEL_PRECIO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NIVEL_PRECIO) + '</NIVEL_PRECIO>' + 
					'<MONEDA_NIVEL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@MONEDA_NIVEL) + '</MONEDA_NIVEL>' + 
					'<CADENA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CADENA) + '</CADENA>' + 
					'<CONSECUTIVO_CI Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CONSECUTIVO_CI) + '</CONSECUTIVO_CI>' +
					'<NCF_UNICO	Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NCF_UNICO) + '</NCF_UNICO>'
					IF UPDATE(CONSEC_CIERRE)
					BEGIN
						SET @PARAMETROS = @PARAMETROS + 
						'<CONSEC_CIERRE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CONSEC_CIERRE) + '</CONSEC_CIERRE>' 
					END
					IF UPDATE(ULT_CIERRE)
					BEGIN
						SET @PARAMETROS = @PARAMETROS + 
						'<ULT_CIERRE Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@ULT_CIERRE) + '</ULT_CIERRE>'
					END
					
					SET @PARAMETROS = @PARAMETROS + '</GRUPO>'
				END
				ELSE
				BEGIN
					SET @PARAMETROS =
						'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
					'<GRUPO>' + 
					'<GRUPO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@GRUPO) + '</GRUPO>' + 
					'<ULT_CIERRE Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@ULT_CIERRE) + '</ULT_CIERRE>' + 
					'<CONSEC_CIERRE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CONSEC_CIERRE) + '</CONSEC_CIERRE>' + 
					'</GRUPO>'
				END
				-- inserta la solicitud correspondiente
				EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'GRUPOPOS600', 'MODIFICA', @PARAMETROS, @ACTUALIZAR_SOLICITUD, @COL_ROWPOINTER
			END
			FETCH NEXT FROM C_MODIFIED
			INTO @GRUPO, @DESCRIPCION, @SUCURSAL, @LINEA_SUPERIOR1, @LINEA_SUPERIOR2, @LINEA_SUPERIOR3, @LINEA_SUPERIOR4, @LINEA_INFERIOR1, @LINEA_INFERIOR2, @LINEA_INFERIOR3, @LINEA_INFERIOR4, @ULT_CIERRE, @FECHA, @ABONO_APRT_VENCIDO, @NIVEL_PRECIO, @MONEDA_NIVEL, @CADENA, @CONSECUTIVO_CI, @CONSEC_CIERRE, @NCF_UNICO
		END
		CLOSE C_MODIFIED
		DEALLOCATE C_MODIFIED
	END
	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para modificar la tabla GRUPO.',16,1 )
	END
END;






CREATE TRIGGER $$Compania$$.GRUPO_CAJA_POS_INS
ON $$Compania$$.GRUPO_CAJA
FOR INSERT
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @GRUPO VARCHAR(6)
	DECLARE @CAJA VARCHAR(6)
	DECLARE @TIPO_SITIO_LOCAL VARCHAR(1)
	
	SELECT @PUBLICADOR = SITIO_LOCAL,
		@USUARIO_POS_WSQM = USUARIO_WSQM,
		@TIPO_SITIO_LOCAL = TIPO_SITIO_LOCAL
  	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM) AND @TIPO_SITIO_LOCAL = 'C'
	BEGIN
		DECLARE C_INSERTED CURSOR LOCAL FOR
		SELECT GRUPO, CAJA
		FROM INSERTED i
		WHERE 0 = (
				SELECT COUNT('n')
				FROM DELETED d
				WHERE i.GRUPO = d.GRUPO AND i.CAJA = d.CAJA
			   )
			
		OPEN C_INSERTED	
		FETCH NEXT FROM C_INSERTED INTO
		@GRUPO, @CAJA
		SET @ERROR = 0
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS =
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<GRUPO_CAJA>' +
				'<GRUPO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@GRUPO) + '</GRUPO>' +
				'<CAJA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CAJA) + '</CAJA>' +
				'</GRUPO_CAJA>'
			-- Inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'GRUPOCAJAPOS600', 'INSERTA', @PARAMETROS, 0, ''
			FETCH NEXT FROM C_INSERTED INTO
			@GRUPO, @CAJA
		END
		CLOSE C_INSERTED
    		DEALLOCATE C_INSERTED
	END
	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla GRUPO_CAJA.',16,1 )
	END
END
;




CREATE TRIGGER $$Compania$$.GRUPO_CAJA_POS_DEL
ON $$Compania$$.GRUPO_CAJA
FOR DELETE
AS
BEGIN   	
                DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @GRUPO VARCHAR(6)
	DECLARE @CAJA VARCHAR(6)
	DECLARE @TIPO_SITIO_LOCAL VARCHAR(1)
	
	SELECT @PUBLICADOR = SITIO_LOCAL,
		@USUARIO_POS_WSQM = USUARIO_WSQM,
		@TIPO_SITIO_LOCAL = TIPO_SITIO_LOCAL
  	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM) AND @TIPO_SITIO_LOCAL = 'C'
	BEGIN
		DECLARE C_DELETED CURSOR LOCAL FOR
			SELECT GRUPO, CAJA
			FROM DELETED d
			WHERE 0 = (
				SELECT COUNT('n')
				FROM INSERTED i
				WHERE d.GRUPO = i.GRUPO AND d.CAJA = i.CAJA
			   )
		OPEN C_DELETED
		FETCH NEXT FROM C_DELETED INTO
		@GRUPO, @CAJA -- VARIABLES
		
		SET @ERROR = 0
		
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS =
								'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<GRUPO_CAJA>' +
				'<GRUPO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@GRUPO) + '</GRUPO>' +
				'<CAJA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CAJA) + '</CAJA>' +
				'</GRUPO_CAJA>'
 -- XML
			
			-- inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'GRUPOCAJAPOS600', 'ELIMINA', @PARAMETROS, 0, ''
			
			FETCH NEXT FROM C_DELETED INTO
			@GRUPO, @CAJA -- VARIABLES
		END
		CLOSE C_DELETED
		DEALLOCATE C_DELETED
	END
	
	IF (@@ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para eliminar de la tabla GRUPO_CAJA.',16,1 )
	END
END
;





CREATE TRIGGER $$Compania$$.GRUPO_CAJA_POS_MOD
ON $$Compania$$.GRUPO_CAJA
FOR UPDATE
AS
BEGIN   	
	DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @COL_ROWPOINTER VARCHAR(36)
	DECLARE @HAY_CAMPOS_PARA_POS BIT
	DECLARE @ACTUALIZAR_SOLICITUD BIT
	DECLARE @GRUPO VARCHAR(6)
	DECLARE @CAJA VARCHAR(6)
	DECLARE @TIPO_SITIO_LOCAL VARCHAR(1)
	
	SELECT @PUBLICADOR = SITIO_LOCAL,
		@USUARIO_POS_WSQM = USUARIO_WSQM,
		@TIPO_SITIO_LOCAL = TIPO_SITIO_LOCAL
  	FROM $$Compania$$.GLOBALES_POS
	SET @ERROR = 0
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM) AND @TIPO_SITIO_LOCAL = 'C'
	BEGIN
		DECLARE C_MODIFIED CURSOR LOCAL FOR
			SELECT GRUPO, CAJA -- Columnas
			FROM INSERTED I
		SET @ACTUALIZAR_SOLICITUD = 1
		OPEN C_MODIFIED
		FETCH NEXT FROM C_MODIFIED
		INTO @GRUPO, @CAJA
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			IF ( NOT UPDATE(RECORDDATE) AND ( UPDATE(GRUPO) OR UPDATE(CAJA) ) )
			BEGIN
				SELECT @COL_ROWPOINTER = ROWPOINTER
				FROM $$Compania$$.GRUPO_CAJA
				WHERE GRUPO = @GRUPO AND CAJA = @CAJA
				SET @PARAMETROS =
					'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<GRUPO_CAJA>' +
				'<GRUPO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@GRUPO) + '</GRUPO>' +
				'<CAJA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CAJA) + '</CAJA>' +
				'</GRUPO_CAJA>'
				-- inserta la solicitud correspondiente
				EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'GRUPOCAJAPOS600', 'MODIFICA', @PARAMETROS, @ACTUALIZAR_SOLICITUD, @COL_ROWPOINTER
			END
			FETCH NEXT FROM C_MODIFIED
			INTO @GRUPO, @CAJA
		END
		CLOSE C_MODIFIED
		DEALLOCATE C_MODIFIED
	END
	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para modificar la tabla GRUPO_CAJA.',16,1 )
	END
END;


CREATE TRIGGER $$Compania$$.MEMBRESIA_POS_POS_INS
ON $$Compania$$.MEMBRESIA_POS
FOR INSERT
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @TIPO_SITIO_LOCAL VARCHAR(1)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @MEMBRESIA VARCHAR(25)
	DECLARE @CLIENTE VARCHAR(20)
	DECLARE @FECHA_EMISION DATETIME
	DECLARE @USUARIO_EMISION VARCHAR(25)
	DECLARE @FECHA_VENCE DATETIME
	DECLARE @FECHA_VENCE_ANT DATETIME
	DECLARE @ESTADO VARCHAR(1)
	DECLARE @APLICA_DESC_VENTA VARCHAR(1)
	DECLARE @APLICA_DESC_RENOVACION VARCHAR(1)
	DECLARE @ES_EXTERIOR VARCHAR(1)
	DECLARE @PAIS_ORIGEN VARCHAR(4)
	DECLARE @USUARIO_AUTORIZA_ING VARCHAR(25)
	DECLARE @FECHA_RENOVACION DATETIME
	DECLARE @USUARIO_RENOVACION VARCHAR(25)
	DECLARE @FECHA_REPOSICION DATETIME
	DECLARE @USUARIO_REPOSICION VARCHAR(25)
	DECLARE @MEMBRESIA_REPUESTA VARCHAR(25)
	DECLARE @OBSERVACIONES VARCHAR(254)


	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM,
	       @TIPO_SITIO_LOCAL = TIPO_SITIO_LOCAL 
	FROM $$Compania$$.GLOBALES_POS
	
	IF NOT (SYSTEM_USER = @USUARIO_POS_WSQM AND @TIPO_SITIO_LOCAL = 'T')
	BEGIN

		DECLARE C_INSERTED CURSOR LOCAL FOR
		SELECT MEMBRESIA, CLIENTE, FECHA_EMISION, USUARIO_EMISION, FECHA_VENCE, FECHA_VENCE_ANT, ESTADO, APLICA_DESC_VENTA, APLICA_DESC_RENOVACION, ES_EXTERIOR, PAIS_ORIGEN, USUARIO_AUTORIZA_ING, FECHA_RENOVACION, USUARIO_RENOVACION, FECHA_REPOSICION, USUARIO_REPOSICION, MEMBRESIA_REPUESTA, OBSERVACIONES
		FROM INSERTED
			
		OPEN C_INSERTED	
		FETCH NEXT FROM C_INSERTED INTO
		@MEMBRESIA, @CLIENTE, @FECHA_EMISION, @USUARIO_EMISION, @FECHA_VENCE, @FECHA_VENCE_ANT, @ESTADO, @APLICA_DESC_VENTA, @APLICA_DESC_RENOVACION, @ES_EXTERIOR, @PAIS_ORIGEN, @USUARIO_AUTORIZA_ING, @FECHA_RENOVACION, @USUARIO_RENOVACION, @FECHA_REPOSICION, @USUARIO_REPOSICION, @MEMBRESIA_REPUESTA, @OBSERVACIONES

		SET @ERROR = 0
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS = 
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<MEMBRESIA_POS>' + 
				'<MEMBRESIA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@MEMBRESIA) + '</MEMBRESIA>' + 
				'<CLIENTE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CLIENTE) + '</CLIENTE>' + 
				'<FECHA_EMISION Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_EMISION) + '</FECHA_EMISION>' + 
				'<USUARIO_EMISION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USUARIO_EMISION) + '</USUARIO_EMISION>' + 
				'<FECHA_VENCE Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_VENCE) + '</FECHA_VENCE>' + 
				'<FECHA_VENCE_ANT Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_VENCE_ANT) + '</FECHA_VENCE_ANT>' + 
				'<ESTADO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ESTADO) + '</ESTADO>' + 
				'<APLICA_DESC_VENTA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@APLICA_DESC_VENTA) + '</APLICA_DESC_VENTA>' + 
				'<APLICA_DESC_RENOVACION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@APLICA_DESC_RENOVACION) + '</APLICA_DESC_RENOVACION>' + 
				'<ES_EXTERIOR Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ES_EXTERIOR) + '</ES_EXTERIOR>' + 
				'<PAIS_ORIGEN Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@PAIS_ORIGEN) + '</PAIS_ORIGEN>' + 
				'<USUARIO_AUTORIZA_ING Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USUARIO_AUTORIZA_ING) + '</USUARIO_AUTORIZA_ING>' + 
				'<FECHA_RENOVACION Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_RENOVACION) + '</FECHA_RENOVACION>' + 
				'<USUARIO_RENOVACION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USUARIO_RENOVACION) + '</USUARIO_RENOVACION>' + 
				'<FECHA_REPOSICION Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_REPOSICION) + '</FECHA_REPOSICION>' + 
				'<USUARIO_REPOSICION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USUARIO_REPOSICION) + '</USUARIO_REPOSICION>' + 
				'<MEMBRESIA_REPUESTA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@MEMBRESIA_REPUESTA) + '</MEMBRESIA_REPUESTA>' + 
				'<OBSERVACIONES Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@OBSERVACIONES) + '</OBSERVACIONES>' + 
				'</MEMBRESIA_POS>'


			-- Inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'MEMBRESIAPOSPOS600', 'INSERTA', @PARAMETROS, 0, ''

			FETCH NEXT FROM C_INSERTED INTO
			@MEMBRESIA, @CLIENTE, @FECHA_EMISION, @USUARIO_EMISION, @FECHA_VENCE, @FECHA_VENCE_ANT, @ESTADO, @APLICA_DESC_VENTA, @APLICA_DESC_RENOVACION, @ES_EXTERIOR, @PAIS_ORIGEN, @USUARIO_AUTORIZA_ING, @FECHA_RENOVACION, @USUARIO_RENOVACION, @FECHA_REPOSICION, @USUARIO_REPOSICION, @MEMBRESIA_REPUESTA, @OBSERVACIONES
		END

		CLOSE C_INSERTED
    		DEALLOCATE C_INSERTED
	END
	
	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla MEMBRESIA_POS.',16,1 )
	END
END;





CREATE TRIGGER $$Compania$$.MEMBRESIA_POS_POS_DEL
ON $$Compania$$.MEMBRESIA_POS
FOR DELETE  
AS 
BEGIN   	
    DECLARE @ERROR  int
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @TIPO_SITIO_LOCAL VARCHAR(1)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @MEMBRESIA VARCHAR(25)
	
	 -- Declaraciones	
    SET @ERROR = 0
	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM,
	       @TIPO_SITIO_LOCAL = TIPO_SITIO_LOCAL 
	FROM $$Compania$$.GLOBALES_POS
	
	IF NOT (SYSTEM_USER = @USUARIO_POS_WSQM AND @TIPO_SITIO_LOCAL = 'T')
	BEGIN
		DECLARE C_DELETED CURSOR LOCAL FOR
			SELECT MEMBRESIA
			FROM DELETED

		OPEN C_DELETED
		FETCH NEXT FROM C_DELETED INTO 
		@MEMBRESIA
		
		SET @ERROR = 0
		
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS = 
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<MEMBRESIA_POS>' + 
				'<MEMBRESIA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@MEMBRESIA) + '</MEMBRESIA>' + 
				'</MEMBRESIA_POS>'
 
			
			-- inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'MEMBRESIAPOSPOS600', 'ELIMINA', @PARAMETROS, 0, ''
			
			FETCH NEXT FROM C_DELETED INTO 
			@MEMBRESIA
		END

		CLOSE C_DELETED
		DEALLOCATE C_DELETED
	END
	
	IF (@@ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para eliminar de la tabla MEMBRESIA_POS.',16,1 )
	END
END;




CREATE TRIGGER $$Compania$$.MEMBRESIA_POS_POS_MOD
ON $$Compania$$.MEMBRESIA_POS
FOR UPDATE
AS 
BEGIN   	
	DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @TIPO_SITIO_LOCAL VARCHAR(1)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @COL_ROWPOINTER VARCHAR(36)
	DECLARE @HAY_CAMPOS_PARA_POS BIT
	DECLARE @ACTUALIZAR_SOLICITUD BIT
	DECLARE @MEMBRESIA VARCHAR(25)
	DECLARE @CLIENTE VARCHAR(20)
	DECLARE @FECHA_EMISION DATETIME
	DECLARE @USUARIO_EMISION VARCHAR(25)
	DECLARE @FECHA_VENCE DATETIME
	DECLARE @FECHA_VENCE_ANT DATETIME
	DECLARE @ESTADO VARCHAR(1)
	DECLARE @APLICA_DESC_VENTA VARCHAR(1)
	DECLARE @APLICA_DESC_RENOVACION VARCHAR(1)
	DECLARE @ES_EXTERIOR VARCHAR(1)
	DECLARE @PAIS_ORIGEN VARCHAR(4)
	DECLARE @USUARIO_AUTORIZA_ING VARCHAR(25)
	DECLARE @FECHA_RENOVACION DATETIME
	DECLARE @USUARIO_RENOVACION VARCHAR(25)
	DECLARE @FECHA_REPOSICION DATETIME
	DECLARE @USUARIO_REPOSICION VARCHAR(25)
	DECLARE @MEMBRESIA_REPUESTA VARCHAR(25)
	DECLARE @OBSERVACIONES VARCHAR(254)
	 -- Declaraciones

	SET @ERROR = 0

	SELECT @PUBLICADOR = SITIO_LOCAL, @USUARIO_POS_WSQM = USUARIO_WSQM, @TIPO_SITIO_LOCAL = TIPO_SITIO_LOCAL
	FROM $$Compania$$.GLOBALES_POS

	IF NOT (SYSTEM_USER = @USUARIO_POS_WSQM AND @TIPO_SITIO_LOCAL = 'T')
	BEGIN
		DECLARE C_MODIFIED CURSOR LOCAL FOR
			SELECT MEMBRESIA, CLIENTE, FECHA_EMISION, USUARIO_EMISION, FECHA_VENCE, FECHA_VENCE_ANT, ESTADO, APLICA_DESC_VENTA, APLICA_DESC_RENOVACION, ES_EXTERIOR, PAIS_ORIGEN, USUARIO_AUTORIZA_ING, FECHA_RENOVACION, USUARIO_RENOVACION, FECHA_REPOSICION, USUARIO_REPOSICION, MEMBRESIA_REPUESTA, OBSERVACIONES -- Columnas
			FROM INSERTED 

		SET @ACTUALIZAR_SOLICITUD = 1

		OPEN C_MODIFIED

		FETCH NEXT FROM C_MODIFIED
		INTO @MEMBRESIA, @CLIENTE, @FECHA_EMISION, @USUARIO_EMISION, @FECHA_VENCE, @FECHA_VENCE_ANT, @ESTADO, @APLICA_DESC_VENTA, @APLICA_DESC_RENOVACION, @ES_EXTERIOR, @PAIS_ORIGEN, @USUARIO_AUTORIZA_ING, @FECHA_RENOVACION, @USUARIO_RENOVACION, @FECHA_REPOSICION, @USUARIO_REPOSICION, @MEMBRESIA_REPUESTA, @OBSERVACIONES

		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			IF ( NOT UPDATE(RECORDDATE) AND ( UPDATE(MEMBRESIA) OR UPDATE(CLIENTE) OR UPDATE(FECHA_EMISION) OR UPDATE(USUARIO_EMISION) OR UPDATE(FECHA_VENCE) OR UPDATE(FECHA_VENCE_ANT) OR UPDATE(ESTADO) OR UPDATE(APLICA_DESC_VENTA) OR UPDATE(APLICA_DESC_RENOVACION) OR UPDATE(ES_EXTERIOR) OR UPDATE(PAIS_ORIGEN) OR UPDATE(USUARIO_AUTORIZA_ING) OR UPDATE(FECHA_RENOVACION) OR UPDATE(USUARIO_RENOVACION) OR UPDATE(FECHA_REPOSICION) OR UPDATE(USUARIO_REPOSICION) OR UPDATE(MEMBRESIA_REPUESTA) OR UPDATE(OBSERVACIONES) ) )
			BEGIN

				SELECT @COL_ROWPOINTER = ROWPOINTER 
				FROM $$Compania$$.MEMBRESIA_POS
				WHERE MEMBRESIA = @MEMBRESIA 

				SET @PARAMETROS =
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<MEMBRESIA_POS>' + 
				'<MEMBRESIA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@MEMBRESIA) + '</MEMBRESIA>' + 
				'<CLIENTE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CLIENTE) + '</CLIENTE>' + 
				'<FECHA_EMISION Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_EMISION) + '</FECHA_EMISION>' + 
				'<USUARIO_EMISION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USUARIO_EMISION) + '</USUARIO_EMISION>' + 
				'<FECHA_VENCE Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_VENCE) + '</FECHA_VENCE>' + 
				'<FECHA_VENCE_ANT Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_VENCE_ANT) + '</FECHA_VENCE_ANT>' + 
				'<ESTADO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ESTADO) + '</ESTADO>' + 
				'<APLICA_DESC_VENTA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@APLICA_DESC_VENTA) + '</APLICA_DESC_VENTA>' + 
				'<APLICA_DESC_RENOVACION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@APLICA_DESC_RENOVACION) + '</APLICA_DESC_RENOVACION>' + 
				'<ES_EXTERIOR Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ES_EXTERIOR) + '</ES_EXTERIOR>' + 
				'<PAIS_ORIGEN Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@PAIS_ORIGEN) + '</PAIS_ORIGEN>' + 
				'<USUARIO_AUTORIZA_ING Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USUARIO_AUTORIZA_ING) + '</USUARIO_AUTORIZA_ING>' + 
				'<FECHA_RENOVACION Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_RENOVACION) + '</FECHA_RENOVACION>' + 
				'<USUARIO_RENOVACION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USUARIO_RENOVACION) + '</USUARIO_RENOVACION>' + 
				'<FECHA_REPOSICION Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_REPOSICION) + '</FECHA_REPOSICION>' + 
				'<USUARIO_REPOSICION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USUARIO_REPOSICION) + '</USUARIO_REPOSICION>' + 
				'<MEMBRESIA_REPUESTA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@MEMBRESIA_REPUESTA) + '</MEMBRESIA_REPUESTA>' + 
				'<OBSERVACIONES Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@OBSERVACIONES) + '</OBSERVACIONES>' + 
				'</MEMBRESIA_POS>'


				-- inserta la solicitud correspondiente
				EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'MEMBRESIAPOSPOS600', 'MODIFICA', @PARAMETROS, @ACTUALIZAR_SOLICITUD, @COL_ROWPOINTER
			END

			FETCH NEXT FROM C_MODIFIED
			INTO @MEMBRESIA, @CLIENTE, @FECHA_EMISION, @USUARIO_EMISION, @FECHA_VENCE, @FECHA_VENCE_ANT, @ESTADO, @APLICA_DESC_VENTA, @APLICA_DESC_RENOVACION, @ES_EXTERIOR, @PAIS_ORIGEN, @USUARIO_AUTORIZA_ING, @FECHA_RENOVACION, @USUARIO_RENOVACION, @FECHA_REPOSICION, @USUARIO_REPOSICION, @MEMBRESIA_REPUESTA, @OBSERVACIONES
		END

		CLOSE C_MODIFIED
		DEALLOCATE C_MODIFIED
	END
	
	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para modificar la tabla MEMBRESIA_POS.',16,1 )
	END
END;





CREATE TRIGGER $$Compania$$.HIST_MEMBRESIA_POS_POS_INS
ON $$Compania$$.HIST_MEMBRESIA_POS
FOR INSERT
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @TIPO_SITIO_LOCAL VARCHAR(1)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @MEMBRESIA VARCHAR(25)
	DECLARE @DOCUMENTO VARCHAR(50)
	DECLARE @TIPO VARCHAR(1)
	DECLARE @CAJA VARCHAR(6)
	DECLARE @TIPO_OPERACION VARCHAR(1)
	

	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM 
	FROM $$Compania$$.GLOBALES_POS

	IF NOT (SYSTEM_USER = @USUARIO_POS_WSQM AND @TIPO_SITIO_LOCAL = 'T')
	BEGIN

		DECLARE C_INSERTED CURSOR LOCAL FOR
		SELECT MEMBRESIA, DOCUMENTO, TIPO, CAJA, TIPO_OPERACION
		FROM INSERTED 
			
		OPEN C_INSERTED	
		FETCH NEXT FROM C_INSERTED INTO
		@MEMBRESIA, @DOCUMENTO, @TIPO, @CAJA, @TIPO_OPERACION

		SET @ERROR = 0
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS = 
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<HIST_MEMBRESIA_POS>' + 
				'<MEMBRESIA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@MEMBRESIA) + '</MEMBRESIA>' + 
				'<DOCUMENTO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@DOCUMENTO) + '</DOCUMENTO>' + 
				'<TIPO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO) + '</TIPO>' + 
				'<CAJA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CAJA) + '</CAJA>' + 
				'<TIPO_OPERACION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_OPERACION) + '</TIPO_OPERACION>' + 
				'</HIST_MEMBRESIA_POS>'


			-- Inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'HISTMEMBRESIAPOSPOS600', 'INSERTA', @PARAMETROS, 0, ''

			FETCH NEXT FROM C_INSERTED INTO
			@MEMBRESIA, @DOCUMENTO, @TIPO, @CAJA, @TIPO_OPERACION
		END

		CLOSE C_INSERTED
    		DEALLOCATE C_INSERTED
	END
	
	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla HIST_MEMBRESIA_POS.',16,1 )
	END
END;

CREATE TRIGGER $$Compania$$.HIST_MEMBRESIA_POS_POS_DEL
ON $$Compania$$.HIST_MEMBRESIA_POS
FOR DELETE  
AS 
BEGIN   	
    DECLARE @ERROR  int
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @TIPO_SITIO_LOCAL VARCHAR(1)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @MEMBRESIA VARCHAR(25)
	DECLARE @DOCUMENTO VARCHAR(50)
	DECLARE @TIPO VARCHAR(1)
	DECLARE @CAJA VARCHAR(6)
	
	 -- Declaraciones	
	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM,
	       @TIPO_SITIO_LOCAL = TIPO_SITIO_LOCAL 
	FROM $$Compania$$.GLOBALES_POS
	
	IF NOT (SYSTEM_USER = @USUARIO_POS_WSQM AND @TIPO_SITIO_LOCAL = 'T')
	BEGIN
		DECLARE C_DELETED CURSOR LOCAL FOR
			SELECT MEMBRESIA, DOCUMENTO, TIPO, CAJA
			FROM DELETED

		OPEN C_DELETED
		FETCH NEXT FROM C_DELETED INTO 
		@MEMBRESIA, @DOCUMENTO, @TIPO, @CAJA -- VARIABLES
		
		SET @ERROR = 0
		
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS = 
								'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<HIST_MEMBRESIA_POS>' + 
				'<MEMBRESIA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@MEMBRESIA) + '</MEMBRESIA>' + 
				'<DOCUMENTO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@DOCUMENTO) + '</DOCUMENTO>' + 
				'<TIPO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO) + '</TIPO>' + 
				'<CAJA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CAJA) + '</CAJA>' + 
				'</HIST_MEMBRESIA_POS>'
 
			
			-- inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'HISTMEMBRESIAPOSPOS600', 'ELIMINA', @PARAMETROS, 0, ''
			
			FETCH NEXT FROM C_DELETED INTO 
			@MEMBRESIA, @DOCUMENTO, @TIPO, @CAJA -- VARIABLES
		END

		CLOSE C_DELETED
		DEALLOCATE C_DELETED
	END
	
	IF (@@ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para eliminar de la tabla HIST_MEMBRESIA_POS.',16,1 )
	END
END;

CREATE TRIGGER $$Compania$$.HIST_MEMBRESIA_POS_POS_MOD
ON $$Compania$$.HIST_MEMBRESIA_POS
FOR UPDATE
AS 
BEGIN   	
	DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @TIPO_SITIO_LOCAL VARCHAR(1)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @COL_ROWPOINTER VARCHAR(36)
	DECLARE @HAY_CAMPOS_PARA_POS BIT
	DECLARE @ACTUALIZAR_SOLICITUD BIT
	DECLARE @MEMBRESIA VARCHAR(25)
	DECLARE @DOCUMENTO VARCHAR(50)
	DECLARE @TIPO VARCHAR(1)
	DECLARE @CAJA VARCHAR(6)
	DECLARE @TIPO_OPERACION VARCHAR(1)

	 -- Declaraciones

	SET @ERROR = 0

	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM,
	       @TIPO_SITIO_LOCAL = TIPO_SITIO_LOCAL 
	FROM $$Compania$$.GLOBALES_POS
	
	IF NOT (SYSTEM_USER = @USUARIO_POS_WSQM AND @TIPO_SITIO_LOCAL = 'T')
	BEGIN
		DECLARE C_MODIFIED CURSOR LOCAL FOR
			SELECT MEMBRESIA, DOCUMENTO, TIPO, CAJA, TIPO_OPERACION -- Columnas
			FROM INSERTED

		SET @ACTUALIZAR_SOLICITUD = 1

		OPEN C_MODIFIED

		FETCH NEXT FROM C_MODIFIED
		INTO @MEMBRESIA, @DOCUMENTO, @TIPO, @CAJA, @TIPO_OPERACION

		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			IF ( NOT UPDATE(RECORDDATE) AND ( UPDATE(MEMBRESIA) OR UPDATE(DOCUMENTO) OR UPDATE(TIPO) OR UPDATE(CAJA) OR UPDATE(TIPO_OPERACION)  ) )
			BEGIN

				SELECT @COL_ROWPOINTER = ROWPOINTER 
				FROM $$Compania$$.HIST_MEMBRESIA_POS
				WHERE MEMBRESIA = @MEMBRESIA AND DOCUMENTO = @DOCUMENTO AND TIPO = @TIPO AND CAJA = @CAJA 

				SET @PARAMETROS =
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<HIST_MEMBRESIA_POS>' + 
				'<MEMBRESIA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@MEMBRESIA) + '</MEMBRESIA>' + 
				'<DOCUMENTO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@DOCUMENTO) + '</DOCUMENTO>' + 
				'<TIPO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO) + '</TIPO>' + 
				'<CAJA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CAJA) + '</CAJA>' + 
				'<TIPO_OPERACION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_OPERACION) + '</TIPO_OPERACION>' + 
				'</HIST_MEMBRESIA_POS>'


				-- inserta la solicitud correspondiente
				EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'HISTMEMBRESIAPOSPOS600', 'MODIFICA', @PARAMETROS, @ACTUALIZAR_SOLICITUD, @COL_ROWPOINTER
			END

			FETCH NEXT FROM C_MODIFIED
			INTO @MEMBRESIA, @DOCUMENTO, @TIPO, @CAJA, @TIPO_OPERACION
		END

		CLOSE C_MODIFIED
		DEALLOCATE C_MODIFIED
	END
	
	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para modificar la tabla HIST_MEMBRESIA_POS.',16,1 )
	END
END;




CREATE TRIGGER $$Compania$$.IMPUESTO_POS_INS
ON $$Compania$$.IMPUESTO
FOR INSERT
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @IMPUESTO VARCHAR(4)
	DECLARE @DESCRIPCION VARCHAR(40)
	DECLARE @IMPUESTO1 DECIMAL(28,8)
	DECLARE @IMPUESTO2 DECIMAL(28,8)
	DECLARE @USA_IMPUESTO2_CANTIDAD VARCHAR(1)
	DECLARE @IMPUESTO2_CANTIDAD DECIMAL(28,8)
	DECLARE @CALCULO_IMP2 VARCHAR(1)
	DECLARE @TIPO_CONTAB_IMP1 VARCHAR(1)
	DECLARE @TIPO_CONTAB_IMP2 VARCHAR(1)
	DECLARE @CONTAB_DEV_IMP1 VARCHAR(1)
	DECLARE @CONTAB_DEV_IMP2 VARCHAR(1)
	DECLARE @CTR_IMP1_GEN VARCHAR(25)
	DECLARE @CTA_IMP1_GEN VARCHAR(25)
	DECLARE @CTR_IMP2_GEN VARCHAR(25)
	DECLARE @CTA_IMP2_GEN VARCHAR(25)
	DECLARE @CTR_IMP1_GEN_VTS VARCHAR(25)
	DECLARE @CTA_IMP1_GEN_VTS VARCHAR(25)
	DECLARE @CTR_IMP2_GEN_VTS VARCHAR(25)
	DECLARE @CTA_IMP2_GEN_VTS VARCHAR(25)
	DECLARE @CTR_IMP1_DESC_CMPS VARCHAR(25)
	DECLARE @CTA_IMP1_DESC_CMPS VARCHAR(25)
	DECLARE @CTR_IMP2_DESC_CMPS VARCHAR(25)
	DECLARE @CTA_IMP2_DESC_CMPS VARCHAR(25)
	DECLARE @CTR_IMP1_DEV_CMPS VARCHAR(25)
	DECLARE @CTA_IMP1_DEV_CMPS VARCHAR(25)
	DECLARE @CTR_IMP2_DEV_CMPS VARCHAR(25)
	DECLARE @CTA_IMP2_DEV_CMPS VARCHAR(25)
	DECLARE @CTR_IMP1_DEV_VTS VARCHAR(25)
	DECLARE @CTA_IMP1_DEV_VTS VARCHAR(25)
	DECLARE @CTR_IMP2_DEV_VTS VARCHAR(25)
	DECLARE @CTA_IMP2_DEV_VTS VARCHAR(25)
	

	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM 
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_INSERTED CURSOR LOCAL FOR
		SELECT IMPUESTO, DESCRIPCION, IMPUESTO1, IMPUESTO2, USA_IMPUESTO2_CANTIDAD, IMPUESTO2_CANTIDAD, CALCULO_IMP2, TIPO_CONTAB_IMP1, TIPO_CONTAB_IMP2, CONTAB_DEV_IMP1, CONTAB_DEV_IMP2, CTR_IMP1_GEN, CTA_IMP1_GEN, CTR_IMP2_GEN, CTA_IMP2_GEN, CTR_IMP1_GEN_VTS, CTA_IMP1_GEN_VTS, CTR_IMP2_GEN_VTS, CTA_IMP2_GEN_VTS, CTR_IMP1_DESC_CMPS, CTA_IMP1_DESC_CMPS, CTR_IMP2_DESC_CMPS, CTA_IMP2_DESC_CMPS, CTR_IMP1_DEV_CMPS, CTA_IMP1_DEV_CMPS, CTR_IMP2_DEV_CMPS, CTA_IMP2_DEV_CMPS, CTR_IMP1_DEV_VTS, CTA_IMP1_DEV_VTS, CTR_IMP2_DEV_VTS, CTA_IMP2_DEV_VTS
		FROM INSERTED i
		WHERE 0 = (
				SELECT COUNT('n')
				FROM DELETED d
				WHERE i.IMPUESTO = d.IMPUESTO
			   )
			
		OPEN C_INSERTED	
		FETCH NEXT FROM C_INSERTED INTO
		@IMPUESTO, @DESCRIPCION, @IMPUESTO1, @IMPUESTO2, @USA_IMPUESTO2_CANTIDAD, @IMPUESTO2_CANTIDAD, @CALCULO_IMP2, @TIPO_CONTAB_IMP1, @TIPO_CONTAB_IMP2, @CONTAB_DEV_IMP1, @CONTAB_DEV_IMP2, @CTR_IMP1_GEN, @CTA_IMP1_GEN, @CTR_IMP2_GEN, @CTA_IMP2_GEN, @CTR_IMP1_GEN_VTS, @CTA_IMP1_GEN_VTS, @CTR_IMP2_GEN_VTS, @CTA_IMP2_GEN_VTS, @CTR_IMP1_DESC_CMPS, @CTA_IMP1_DESC_CMPS, @CTR_IMP2_DESC_CMPS, @CTA_IMP2_DESC_CMPS, @CTR_IMP1_DEV_CMPS, @CTA_IMP1_DEV_CMPS, @CTR_IMP2_DEV_CMPS, @CTA_IMP2_DEV_CMPS, @CTR_IMP1_DEV_VTS, @CTA_IMP1_DEV_VTS, @CTR_IMP2_DEV_VTS, @CTA_IMP2_DEV_VTS

		SET @ERROR = 0
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS = 
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<IMPUESTO>' + 
				'<IMPUESTO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@IMPUESTO) + '</IMPUESTO>' + 
				'<DESCRIPCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DESCRIPCION) + '</DESCRIPCION>' + 
				'<IMPUESTO1 Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@IMPUESTO1) + '</IMPUESTO1>' + 
				'<IMPUESTO2 Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@IMPUESTO2) + '</IMPUESTO2>' + 
				'<USA_IMPUESTO2_CANTIDAD Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USA_IMPUESTO2_CANTIDAD) + '</USA_IMPUESTO2_CANTIDAD>' + 
				'<IMPUESTO2_CANTIDAD Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@IMPUESTO2_CANTIDAD) + '</IMPUESTO2_CANTIDAD>' + 
				'<CALCULO_IMP2 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CALCULO_IMP2) + '</CALCULO_IMP2>' + 
				'<TIPO_CONTAB_IMP1 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_CONTAB_IMP1) + '</TIPO_CONTAB_IMP1>' + 
				'<TIPO_CONTAB_IMP2 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_CONTAB_IMP2) + '</TIPO_CONTAB_IMP2>' + 
				'<CONTAB_DEV_IMP1 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CONTAB_DEV_IMP1) + '</CONTAB_DEV_IMP1>' + 
				'<CONTAB_DEV_IMP2 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CONTAB_DEV_IMP2) + '</CONTAB_DEV_IMP2>' + 
				'<CTR_IMP1_GEN Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_IMP1_GEN) + '</CTR_IMP1_GEN>' + 
				'<CTA_IMP1_GEN Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_IMP1_GEN) + '</CTA_IMP1_GEN>' + 
				'<CTR_IMP2_GEN Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_IMP2_GEN) + '</CTR_IMP2_GEN>' + 
				'<CTA_IMP2_GEN Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_IMP2_GEN) + '</CTA_IMP2_GEN>' + 
				'<CTR_IMP1_GEN_VTS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_IMP1_GEN_VTS) + '</CTR_IMP1_GEN_VTS>' + 
				'<CTA_IMP1_GEN_VTS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_IMP1_GEN_VTS) + '</CTA_IMP1_GEN_VTS>' + 
				'<CTR_IMP2_GEN_VTS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_IMP2_GEN_VTS) + '</CTR_IMP2_GEN_VTS>' + 
				'<CTA_IMP2_GEN_VTS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_IMP2_GEN_VTS) + '</CTA_IMP2_GEN_VTS>' + 
				'<CTR_IMP1_DESC_CMPS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_IMP1_DESC_CMPS) + '</CTR_IMP1_DESC_CMPS>' + 
				'<CTA_IMP1_DESC_CMPS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_IMP1_DESC_CMPS) + '</CTA_IMP1_DESC_CMPS>' + 
				'<CTR_IMP2_DESC_CMPS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_IMP2_DESC_CMPS) + '</CTR_IMP2_DESC_CMPS>' + 
				'<CTA_IMP2_DESC_CMPS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_IMP2_DESC_CMPS) + '</CTA_IMP2_DESC_CMPS>' + 
				'<CTR_IMP1_DEV_CMPS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_IMP1_DEV_CMPS) + '</CTR_IMP1_DEV_CMPS>' + 
				'<CTA_IMP1_DEV_CMPS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_IMP1_DEV_CMPS) + '</CTA_IMP1_DEV_CMPS>' + 
				'<CTR_IMP2_DEV_CMPS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_IMP2_DEV_CMPS) + '</CTR_IMP2_DEV_CMPS>' + 
				'<CTA_IMP2_DEV_CMPS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_IMP2_DEV_CMPS) + '</CTA_IMP2_DEV_CMPS>' + 
				'<CTR_IMP1_DEV_VTS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_IMP1_DEV_VTS) + '</CTR_IMP1_DEV_VTS>' + 
				'<CTA_IMP1_DEV_VTS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_IMP1_DEV_VTS) + '</CTA_IMP1_DEV_VTS>' + 
				'<CTR_IMP2_DEV_VTS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_IMP2_DEV_VTS) + '</CTR_IMP2_DEV_VTS>' + 
				'<CTA_IMP2_DEV_VTS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_IMP2_DEV_VTS) + '</CTA_IMP2_DEV_VTS>' + 
				'</IMPUESTO>'


			-- Inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'IMPUESTOPOS600', 'INSERTA', @PARAMETROS, 0, ''

			FETCH NEXT FROM C_INSERTED INTO
			@IMPUESTO, @DESCRIPCION, @IMPUESTO1, @IMPUESTO2, @USA_IMPUESTO2_CANTIDAD, @IMPUESTO2_CANTIDAD, @CALCULO_IMP2, @TIPO_CONTAB_IMP1, @TIPO_CONTAB_IMP2, @CONTAB_DEV_IMP1, @CONTAB_DEV_IMP2, @CTR_IMP1_GEN, @CTA_IMP1_GEN, @CTR_IMP2_GEN, @CTA_IMP2_GEN, @CTR_IMP1_GEN_VTS, @CTA_IMP1_GEN_VTS, @CTR_IMP2_GEN_VTS, @CTA_IMP2_GEN_VTS, @CTR_IMP1_DESC_CMPS, @CTA_IMP1_DESC_CMPS, @CTR_IMP2_DESC_CMPS, @CTA_IMP2_DESC_CMPS, @CTR_IMP1_DEV_CMPS, @CTA_IMP1_DEV_CMPS, @CTR_IMP2_DEV_CMPS, @CTA_IMP2_DEV_CMPS, @CTR_IMP1_DEV_VTS, @CTA_IMP1_DEV_VTS, @CTR_IMP2_DEV_VTS, @CTA_IMP2_DEV_VTS
		END

		CLOSE C_INSERTED
    		DEALLOCATE C_INSERTED
	END

	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla IMPUESTO.',16,1 )
	END
END
;





CREATE TRIGGER $$Compania$$.IMPUESTO_POS_DEL
ON $$Compania$$.IMPUESTO
FOR DELETE
AS
BEGIN   	
                DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @IMPUESTO VARCHAR(4)
	 -- Declaraciones	
	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_DELETED CURSOR LOCAL FOR
			SELECT IMPUESTO
			FROM DELETED d
			WHERE 0 = (
				SELECT COUNT('n')
				FROM INSERTED i
				WHERE d.IMPUESTO = i.IMPUESTO
			   )
		OPEN C_DELETED
		FETCH NEXT FROM C_DELETED INTO
		@IMPUESTO
		
		SET @ERROR = 0
		
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS =
								'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<IMPUESTO>' +
				'<IMPUESTO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@IMPUESTO) + '</IMPUESTO>' +
				'</IMPUESTO>'
 -- XML
			
			-- inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'IMPUESTOPOS600', 'ELIMINA', @PARAMETROS, 0, ''
			
			FETCH NEXT FROM C_DELETED INTO
			@IMPUESTO
		END
		CLOSE C_DELETED
		DEALLOCATE C_DELETED
	END
	
	IF (@@ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para eliminar de la tabla IMPUESTO.',16,1 )
	END
END
;




CREATE TRIGGER $$Compania$$.IMPUESTO_POS_MOD
ON $$Compania$$.IMPUESTO
FOR UPDATE
AS 
BEGIN   	
	DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @COL_ROWPOINTER VARCHAR(36)
	DECLARE @HAY_CAMPOS_PARA_POS BIT
	DECLARE @ACTUALIZAR_SOLICITUD BIT
	DECLARE @IMPUESTO VARCHAR(4)
	DECLARE @DESCRIPCION VARCHAR(40)
	DECLARE @IMPUESTO1 DECIMAL(28,8)
	DECLARE @IMPUESTO2 DECIMAL(28,8)
	DECLARE @USA_IMPUESTO2_CANTIDAD VARCHAR(1)
	DECLARE @IMPUESTO2_CANTIDAD DECIMAL(28,8)
	DECLARE @CALCULO_IMP2 VARCHAR(1)
	DECLARE @TIPO_CONTAB_IMP1 VARCHAR(1)
	DECLARE @TIPO_CONTAB_IMP2 VARCHAR(1)
	DECLARE @CONTAB_DEV_IMP1 VARCHAR(1)
	DECLARE @CONTAB_DEV_IMP2 VARCHAR(1)
	DECLARE @CTR_IMP1_GEN VARCHAR(25)
	DECLARE @CTA_IMP1_GEN VARCHAR(25)
	DECLARE @CTR_IMP2_GEN VARCHAR(25)
	DECLARE @CTA_IMP2_GEN VARCHAR(25)
	DECLARE @CTR_IMP1_GEN_VTS VARCHAR(25)
	DECLARE @CTA_IMP1_GEN_VTS VARCHAR(25)
	DECLARE @CTR_IMP2_GEN_VTS VARCHAR(25)
	DECLARE @CTA_IMP2_GEN_VTS VARCHAR(25)
	DECLARE @CTR_IMP1_DESC_CMPS VARCHAR(25)
	DECLARE @CTA_IMP1_DESC_CMPS VARCHAR(25)
	DECLARE @CTR_IMP2_DESC_CMPS VARCHAR(25)
	DECLARE @CTA_IMP2_DESC_CMPS VARCHAR(25)
	DECLARE @CTR_IMP1_DEV_CMPS VARCHAR(25)
	DECLARE @CTA_IMP1_DEV_CMPS VARCHAR(25)
	DECLARE @CTR_IMP2_DEV_CMPS VARCHAR(25)
	DECLARE @CTA_IMP2_DEV_CMPS VARCHAR(25)
	DECLARE @CTR_IMP1_DEV_VTS VARCHAR(25)
	DECLARE @CTA_IMP1_DEV_VTS VARCHAR(25)
	DECLARE @CTR_IMP2_DEV_VTS VARCHAR(25)
	DECLARE @CTA_IMP2_DEV_VTS VARCHAR(25)
	 -- Declaraciones

	SET @ERROR = 0

	SELECT @PUBLICADOR = SITIO_LOCAL, @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_MODIFIED CURSOR LOCAL FOR
			SELECT IMPUESTO, DESCRIPCION, IMPUESTO1, IMPUESTO2, USA_IMPUESTO2_CANTIDAD, IMPUESTO2_CANTIDAD, CALCULO_IMP2, TIPO_CONTAB_IMP1, TIPO_CONTAB_IMP2, CONTAB_DEV_IMP1, CONTAB_DEV_IMP2, CTR_IMP1_GEN, CTA_IMP1_GEN, CTR_IMP2_GEN, CTA_IMP2_GEN, CTR_IMP1_GEN_VTS, CTA_IMP1_GEN_VTS, CTR_IMP2_GEN_VTS, CTA_IMP2_GEN_VTS, CTR_IMP1_DESC_CMPS, CTA_IMP1_DESC_CMPS, CTR_IMP2_DESC_CMPS, CTA_IMP2_DESC_CMPS, CTR_IMP1_DEV_CMPS, CTA_IMP1_DEV_CMPS, CTR_IMP2_DEV_CMPS, CTA_IMP2_DEV_CMPS, CTR_IMP1_DEV_VTS, CTA_IMP1_DEV_VTS, CTR_IMP2_DEV_VTS, CTA_IMP2_DEV_VTS -- Columnas
			FROM INSERTED I

		SET @ACTUALIZAR_SOLICITUD = 1

		OPEN C_MODIFIED

		FETCH NEXT FROM C_MODIFIED
		INTO @IMPUESTO, @DESCRIPCION, @IMPUESTO1, @IMPUESTO2, @USA_IMPUESTO2_CANTIDAD, @IMPUESTO2_CANTIDAD, @CALCULO_IMP2, @TIPO_CONTAB_IMP1, @TIPO_CONTAB_IMP2, @CONTAB_DEV_IMP1, @CONTAB_DEV_IMP2, @CTR_IMP1_GEN, @CTA_IMP1_GEN, @CTR_IMP2_GEN, @CTA_IMP2_GEN, @CTR_IMP1_GEN_VTS, @CTA_IMP1_GEN_VTS, @CTR_IMP2_GEN_VTS, @CTA_IMP2_GEN_VTS, @CTR_IMP1_DESC_CMPS, @CTA_IMP1_DESC_CMPS, @CTR_IMP2_DESC_CMPS, @CTA_IMP2_DESC_CMPS, @CTR_IMP1_DEV_CMPS, @CTA_IMP1_DEV_CMPS, @CTR_IMP2_DEV_CMPS, @CTA_IMP2_DEV_CMPS, @CTR_IMP1_DEV_VTS, @CTA_IMP1_DEV_VTS, @CTR_IMP2_DEV_VTS, @CTA_IMP2_DEV_VTS

		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			IF ( NOT UPDATE(RECORDDATE) AND ( UPDATE(IMPUESTO) OR UPDATE(DESCRIPCION) OR UPDATE(IMPUESTO1) OR UPDATE(IMPUESTO2) OR UPDATE(USA_IMPUESTO2_CANTIDAD) OR UPDATE(IMPUESTO2_CANTIDAD) OR UPDATE(CALCULO_IMP2) OR UPDATE(TIPO_CONTAB_IMP1) OR UPDATE(TIPO_CONTAB_IMP2) OR UPDATE(CONTAB_DEV_IMP1) OR UPDATE(CONTAB_DEV_IMP2) OR UPDATE(CTR_IMP1_GEN) OR UPDATE(CTA_IMP1_GEN) OR UPDATE(CTR_IMP2_GEN) OR UPDATE(CTA_IMP2_GEN) OR UPDATE(CTR_IMP1_GEN_VTS) OR UPDATE(CTA_IMP1_GEN_VTS) OR UPDATE(CTR_IMP2_GEN_VTS) OR UPDATE(CTA_IMP2_GEN_VTS) OR UPDATE(CTR_IMP1_DESC_CMPS) OR UPDATE(CTA_IMP1_DESC_CMPS) OR UPDATE(CTR_IMP2_DESC_CMPS) OR UPDATE(CTA_IMP2_DESC_CMPS) OR UPDATE(CTR_IMP1_DEV_CMPS) OR UPDATE(CTA_IMP1_DEV_CMPS) OR UPDATE(CTR_IMP2_DEV_CMPS) OR UPDATE(CTA_IMP2_DEV_CMPS) OR UPDATE(CTR_IMP1_DEV_VTS) OR UPDATE(CTA_IMP1_DEV_VTS) OR UPDATE(CTR_IMP2_DEV_VTS) OR UPDATE(CTA_IMP2_DEV_VTS) ) )
			BEGIN

				SELECT @COL_ROWPOINTER = ROWPOINTER 
				FROM $$Compania$$.IMPUESTO
				WHERE IMPUESTO = @IMPUESTO 

				SET @PARAMETROS =
					'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<IMPUESTO>' + 
				'<IMPUESTO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@IMPUESTO) + '</IMPUESTO>' + 
				'<DESCRIPCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DESCRIPCION) + '</DESCRIPCION>' + 
				'<IMPUESTO1 Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@IMPUESTO1) + '</IMPUESTO1>' + 
				'<IMPUESTO2 Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@IMPUESTO2) + '</IMPUESTO2>' + 
				'<USA_IMPUESTO2_CANTIDAD Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USA_IMPUESTO2_CANTIDAD) + '</USA_IMPUESTO2_CANTIDAD>' + 
				'<IMPUESTO2_CANTIDAD Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@IMPUESTO2_CANTIDAD) + '</IMPUESTO2_CANTIDAD>' + 
				'<CALCULO_IMP2 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CALCULO_IMP2) + '</CALCULO_IMP2>' + 
				'<TIPO_CONTAB_IMP1 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_CONTAB_IMP1) + '</TIPO_CONTAB_IMP1>' + 
				'<TIPO_CONTAB_IMP2 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_CONTAB_IMP2) + '</TIPO_CONTAB_IMP2>' + 
				'<CONTAB_DEV_IMP1 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CONTAB_DEV_IMP1) + '</CONTAB_DEV_IMP1>' + 
				'<CONTAB_DEV_IMP2 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CONTAB_DEV_IMP2) + '</CONTAB_DEV_IMP2>' + 
				'<CTR_IMP1_GEN Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_IMP1_GEN) + '</CTR_IMP1_GEN>' + 
				'<CTA_IMP1_GEN Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_IMP1_GEN) + '</CTA_IMP1_GEN>' + 
				'<CTR_IMP2_GEN Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_IMP2_GEN) + '</CTR_IMP2_GEN>' + 
				'<CTA_IMP2_GEN Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_IMP2_GEN) + '</CTA_IMP2_GEN>' + 
				'<CTR_IMP1_GEN_VTS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_IMP1_GEN_VTS) + '</CTR_IMP1_GEN_VTS>' + 
				'<CTA_IMP1_GEN_VTS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_IMP1_GEN_VTS) + '</CTA_IMP1_GEN_VTS>' + 
				'<CTR_IMP2_GEN_VTS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_IMP2_GEN_VTS) + '</CTR_IMP2_GEN_VTS>' + 
				'<CTA_IMP2_GEN_VTS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_IMP2_GEN_VTS) + '</CTA_IMP2_GEN_VTS>' + 
				'<CTR_IMP1_DESC_CMPS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_IMP1_DESC_CMPS) + '</CTR_IMP1_DESC_CMPS>' + 
				'<CTA_IMP1_DESC_CMPS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_IMP1_DESC_CMPS) + '</CTA_IMP1_DESC_CMPS>' + 
				'<CTR_IMP2_DESC_CMPS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_IMP2_DESC_CMPS) + '</CTR_IMP2_DESC_CMPS>' + 
				'<CTA_IMP2_DESC_CMPS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_IMP2_DESC_CMPS) + '</CTA_IMP2_DESC_CMPS>' + 
				'<CTR_IMP1_DEV_CMPS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_IMP1_DEV_CMPS) + '</CTR_IMP1_DEV_CMPS>' + 
				'<CTA_IMP1_DEV_CMPS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_IMP1_DEV_CMPS) + '</CTA_IMP1_DEV_CMPS>' + 
				'<CTR_IMP2_DEV_CMPS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_IMP2_DEV_CMPS) + '</CTR_IMP2_DEV_CMPS>' + 
				'<CTA_IMP2_DEV_CMPS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_IMP2_DEV_CMPS) + '</CTA_IMP2_DEV_CMPS>' + 
				'<CTR_IMP1_DEV_VTS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_IMP1_DEV_VTS) + '</CTR_IMP1_DEV_VTS>' + 
				'<CTA_IMP1_DEV_VTS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_IMP1_DEV_VTS) + '</CTA_IMP1_DEV_VTS>' + 
				'<CTR_IMP2_DEV_VTS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_IMP2_DEV_VTS) + '</CTR_IMP2_DEV_VTS>' + 
				'<CTA_IMP2_DEV_VTS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_IMP2_DEV_VTS) + '</CTA_IMP2_DEV_VTS>' + 
				'</IMPUESTO>'


				-- inserta la solicitud correspondiente
				EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'IMPUESTOPOS600', 'MODIFICA', @PARAMETROS, @ACTUALIZAR_SOLICITUD, @COL_ROWPOINTER
			END

			FETCH NEXT FROM C_MODIFIED
			INTO @IMPUESTO, @DESCRIPCION, @IMPUESTO1, @IMPUESTO2, @USA_IMPUESTO2_CANTIDAD, @IMPUESTO2_CANTIDAD, @CALCULO_IMP2, @TIPO_CONTAB_IMP1, @TIPO_CONTAB_IMP2, @CONTAB_DEV_IMP1, @CONTAB_DEV_IMP2, @CTR_IMP1_GEN, @CTA_IMP1_GEN, @CTR_IMP2_GEN, @CTA_IMP2_GEN, @CTR_IMP1_GEN_VTS, @CTA_IMP1_GEN_VTS, @CTR_IMP2_GEN_VTS, @CTA_IMP2_GEN_VTS, @CTR_IMP1_DESC_CMPS, @CTA_IMP1_DESC_CMPS, @CTR_IMP2_DESC_CMPS, @CTA_IMP2_DESC_CMPS, @CTR_IMP1_DEV_CMPS, @CTA_IMP1_DEV_CMPS, @CTR_IMP2_DEV_CMPS, @CTA_IMP2_DEV_CMPS, @CTR_IMP1_DEV_VTS, @CTA_IMP1_DEV_VTS, @CTR_IMP2_DEV_VTS, @CTA_IMP2_DEV_VTS
		END

		CLOSE C_MODIFIED
		DEALLOCATE C_MODIFIED
	END

	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para modificar la tabla IMPUESTO.',16,1 )
	END
END
;


CREATE TRIGGER $$Compania$$.INFO_DOC_SEGURO_POS_INS
ON $$Compania$$.INFO_DOC_SEGURO
FOR INSERT
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @ASEGURADORA VARCHAR(20)
	DECLARE @AFILIADO VARCHAR(20)
	DECLARE @DOCUMENTO VARCHAR(50)
	DECLARE @CAJA VARCHAR(6)
	DECLARE @TIPO VARCHAR(1)
	DECLARE @PAGO VARCHAR(4)
	DECLARE @CENTRO_MEDICO VARCHAR(80)
	DECLARE @DIAGNOSTICO VARCHAR(254)
	DECLARE @MEDICO VARCHAR(80)
	DECLARE @ESPECIALIDAD VARCHAR(80)
	DECLARE @CONTRATO VARCHAR(80)
	

	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM 
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_INSERTED CURSOR LOCAL FOR
		SELECT ASEGURADORA, AFILIADO, DOCUMENTO, CAJA, TIPO, PAGO, CENTRO_MEDICO, DIAGNOSTICO, MEDICO, ESPECIALIDAD, CONTRATO
		FROM INSERTED i
			
		OPEN C_INSERTED	
		FETCH NEXT FROM C_INSERTED INTO
		@ASEGURADORA, @AFILIADO, @DOCUMENTO, @CAJA, @TIPO, @PAGO, @CENTRO_MEDICO, @DIAGNOSTICO, @MEDICO, @ESPECIALIDAD, @CONTRATO

		SET @ERROR = 0
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS = 
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<INFO_DOC_SEGURO>' + 
				'<ASEGURADORA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@ASEGURADORA) + '</ASEGURADORA>' + 
				'<AFILIADO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@AFILIADO) + '</AFILIADO>' + 
				'<DOCUMENTO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DOCUMENTO) + '</DOCUMENTO>' + 
				'<CAJA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CAJA) + '</CAJA>' + 
				'<TIPO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO) + '</TIPO>' + 
				'<PAGO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@PAGO) + '</PAGO>' + 
				'<CENTRO_MEDICO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CENTRO_MEDICO) + '</CENTRO_MEDICO>' + 
				'<DIAGNOSTICO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DIAGNOSTICO) + '</DIAGNOSTICO>' + 
				'<MEDICO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@MEDICO) + '</MEDICO>' + 
				'<ESPECIALIDAD Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ESPECIALIDAD) + '</ESPECIALIDAD>' + 
				'<CONTRATO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CONTRATO) + '</CONTRATO>' + 
				'</INFO_DOC_SEGURO>'


			-- Inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'INFODOCSEGUROPOS600', 'INSERTA', @PARAMETROS, 0, ''

			FETCH NEXT FROM C_INSERTED INTO
			@ASEGURADORA, @AFILIADO, @DOCUMENTO, @CAJA, @TIPO, @PAGO, @CENTRO_MEDICO, @DIAGNOSTICO, @MEDICO, @ESPECIALIDAD, @CONTRATO
		END

		CLOSE C_INSERTED
    		DEALLOCATE C_INSERTED
	END

	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla INFO_DOC_SEGURO.',16,1 )
	END
END;



CREATE TRIGGER $$Compania$$.INFO_DOC_SEGURO_POS_MOD
ON $$Compania$$.INFO_DOC_SEGURO
FOR UPDATE
AS 
BEGIN   	
	DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @COL_ROWPOINTER VARCHAR(36)
	DECLARE @HAY_CAMPOS_PARA_POS BIT
	DECLARE @ACTUALIZAR_SOLICITUD BIT
	DECLARE @ASEGURADORA VARCHAR(20)
	DECLARE @AFILIADO VARCHAR(20)
	DECLARE @DOCUMENTO VARCHAR(50)
	DECLARE @CAJA VARCHAR(6)
	DECLARE @TIPO VARCHAR(1)
	DECLARE @PAGO VARCHAR(4)
	DECLARE @CENTRO_MEDICO VARCHAR(80)
	DECLARE @DIAGNOSTICO VARCHAR(254)
	DECLARE @MEDICO VARCHAR(80)
	DECLARE @ESPECIALIDAD VARCHAR(80)
	DECLARE @CONTRATO VARCHAR(80)
	 -- Declaraciones

	SET @ERROR = 0

	SELECT @PUBLICADOR = SITIO_LOCAL, @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_MODIFIED CURSOR LOCAL FOR
			SELECT ASEGURADORA, AFILIADO, DOCUMENTO, CAJA, TIPO, PAGO, CENTRO_MEDICO, DIAGNOSTICO, MEDICO, ESPECIALIDAD, CONTRATO -- Columnas
			FROM INSERTED I

		SET @ACTUALIZAR_SOLICITUD = 1

		OPEN C_MODIFIED

		FETCH NEXT FROM C_MODIFIED
		INTO @ASEGURADORA, @AFILIADO, @DOCUMENTO, @CAJA, @TIPO, @PAGO, @CENTRO_MEDICO, @DIAGNOSTICO, @MEDICO, @ESPECIALIDAD, @CONTRATO

		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			IF ( NOT UPDATE(RECORDDATE) AND ( UPDATE(ASEGURADORA) OR UPDATE(AFILIADO) OR UPDATE(DOCUMENTO) OR UPDATE(CAJA) OR UPDATE(TIPO) OR UPDATE(PAGO) OR UPDATE(CENTRO_MEDICO) OR UPDATE(DIAGNOSTICO) OR UPDATE(MEDICO) OR UPDATE(ESPECIALIDAD) OR UPDATE(CONTRATO) ) )
			BEGIN

				SELECT @COL_ROWPOINTER = ROWPOINTER 
				FROM INFO_DOC_SEGURO
				WHERE ASEGURADORA = @ASEGURADORA AND AFILIADO = @AFILIADO 

				SET @PARAMETROS =
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<INFO_DOC_SEGURO>' + 
				'<ASEGURADORA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@ASEGURADORA) + '</ASEGURADORA>' + 
				'<AFILIADO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@AFILIADO) + '</AFILIADO>' + 
				'<DOCUMENTO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DOCUMENTO) + '</DOCUMENTO>' + 
				'<CAJA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CAJA) + '</CAJA>' + 
				'<TIPO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO) + '</TIPO>' + 
				'<PAGO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@PAGO) + '</PAGO>' + 
				'<CENTRO_MEDICO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CENTRO_MEDICO) + '</CENTRO_MEDICO>' + 
				'<DIAGNOSTICO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DIAGNOSTICO) + '</DIAGNOSTICO>' + 
				'<MEDICO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@MEDICO) + '</MEDICO>' + 
				'<ESPECIALIDAD Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ESPECIALIDAD) + '</ESPECIALIDAD>' + 
				'<CONTRATO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CONTRATO) + '</CONTRATO>' + 
				'</INFO_DOC_SEGURO>'


				-- inserta la solicitud correspondiente
				EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'INFODOCSEGUROPOS600', 'MODIFICA', @PARAMETROS, @ACTUALIZAR_SOLICITUD, @COL_ROWPOINTER
			END

			FETCH NEXT FROM C_MODIFIED
			INTO @ASEGURADORA, @AFILIADO, @DOCUMENTO, @CAJA, @TIPO, @PAGO, @CENTRO_MEDICO, @DIAGNOSTICO, @MEDICO, @ESPECIALIDAD, @CONTRATO
		END

		CLOSE C_MODIFIED
		DEALLOCATE C_MODIFIED
	END

	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para modificar la tabla INFO_DOC_SEGURO.',16,1 )
	END
END;



CREATE TRIGGER $$Compania$$.INFO_DOC_SEGURO_POS_DEL
ON $$Compania$$.INFO_DOC_SEGURO
FOR DELETE  
AS 
BEGIN   	
        DECLARE @ERROR  int
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @ASEGURADORA VARCHAR(20)
	DECLARE @AFILIADO VARCHAR(20)
	 -- Declaraciones	

	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM 
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_DELETED CURSOR LOCAL FOR
			SELECT ASEGURADORA, AFILIADO
			FROM DELETED d

		OPEN C_DELETED
		FETCH NEXT FROM C_DELETED INTO 
		@ASEGURADORA, @AFILIADO
		
		SET @ERROR = 0
		
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS = 
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<INFO_DOC_SEGURO>' + 
				'<ASEGURADORA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@ASEGURADORA) + '</ASEGURADORA>' + 
				'<AFILIADO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@AFILIADO) + '</AFILIADO>' + 
				'</INFO_DOC_SEGURO>'
			
			-- inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'INFODOCSEGUROPOS600', 'ELIMINA', @PARAMETROS, 0, ''
			
			FETCH NEXT FROM C_DELETED INTO 
			@ASEGURADORA, @AFILIADO
		END

		CLOSE C_DELETED
		DEALLOCATE C_DELETED
	END
	
	IF (@@ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para eliminar de la tabla INFO_DOC_SEGURO.',16,1 )
	END
END;





CREATE TRIGGER $$Compania$$.INFO_REG_BILLETE_POS_INS
ON $$Compania$$.INFO_REG_BILLETE
FOR INSERT
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @DOCUMENTO VARCHAR(20)
	DECLARE @CAJA VARCHAR(6)
	DECLARE @TIPO VARCHAR(1)
	DECLARE @PAGO VARCHAR(4)
	DECLARE @IDENTIFICACION VARCHAR(80)
	DECLARE @CLIENTE VARCHAR(80)
	DECLARE @TELEFONO VARCHAR(15)
	

	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM 
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_INSERTED CURSOR LOCAL FOR
		SELECT DOCUMENTO, CAJA, TIPO, PAGO, IDENTIFICACION, CLIENTE, TELEFONO
		FROM INSERTED
			
		OPEN C_INSERTED	
		FETCH NEXT FROM C_INSERTED INTO
		@DOCUMENTO, @CAJA, @TIPO, @PAGO, @IDENTIFICACION, @CLIENTE, @TELEFONO

		SET @ERROR = 0
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS = 
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<INFO_REG_BILLETE>' + 
				'<DOCUMENTO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@DOCUMENTO) + '</DOCUMENTO>' + 
				'<CAJA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CAJA) + '</CAJA>' + 
				'<TIPO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO) + '</TIPO>' + 
				'<PAGO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@PAGO) + '</PAGO>' + 
				'<IDENTIFICACION Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@IDENTIFICACION) + '</IDENTIFICACION>' + 
				'<CLIENTE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CLIENTE) + '</CLIENTE>' + 
				'<TELEFONO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TELEFONO) + '</TELEFONO>' + 
				'</INFO_REG_BILLETE>'


			-- Inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'INFOREGBILLETEPOS600', 'INSERTA', @PARAMETROS, 0, ''

			FETCH NEXT FROM C_INSERTED INTO
			@DOCUMENTO, @CAJA, @TIPO, @PAGO, @IDENTIFICACION, @CLIENTE, @TELEFONO
		END

		CLOSE C_INSERTED
    		DEALLOCATE C_INSERTED
	END

	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla INFO_REG_BILLETE.',16,1 )
	END
END;




CREATE TRIGGER $$Compania$$.INFO_REG_BILLETE_POS_MOD
ON $$Compania$$.INFO_REG_BILLETE
FOR UPDATE
AS 
BEGIN   	
	DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @COL_ROWPOINTER VARCHAR(36)
	DECLARE @HAY_CAMPOS_PARA_POS BIT
	DECLARE @ACTUALIZAR_SOLICITUD BIT
	DECLARE @DOCUMENTO VARCHAR(20)
	DECLARE @CAJA VARCHAR(6)
	DECLARE @TIPO VARCHAR(1)
	DECLARE @PAGO VARCHAR(4)
	DECLARE @IDENTIFICACION VARCHAR(80)
	DECLARE @CLIENTE VARCHAR(80)
	DECLARE @TELEFONO VARCHAR(15)
	 -- Declaraciones

	SET @ERROR = 0

	SELECT @PUBLICADOR = SITIO_LOCAL, @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_MODIFIED CURSOR LOCAL FOR
			SELECT DOCUMENTO, CAJA, TIPO, PAGO, IDENTIFICACION, CLIENTE, TELEFONO -- Columnas
			FROM INSERTED 

		SET @ACTUALIZAR_SOLICITUD = 1

		OPEN C_MODIFIED

		FETCH NEXT FROM C_MODIFIED
		INTO @DOCUMENTO, @CAJA, @TIPO, @PAGO, @IDENTIFICACION, @CLIENTE, @TELEFONO

		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			IF ( NOT UPDATE(RECORDDATE) AND ( UPDATE(DOCUMENTO) OR UPDATE(CAJA) OR UPDATE(TIPO) OR UPDATE(PAGO) OR UPDATE(IDENTIFICACION) OR UPDATE(CLIENTE) OR UPDATE(TELEFONO) ) )
			BEGIN

				SELECT @COL_ROWPOINTER = ROWPOINTER 
				FROM $$Compania$$.INFO_REG_BILLETE
				WHERE DOCUMENTO = @DOCUMENTO AND CAJA = @CAJA AND TIPO = @TIPO AND PAGO = @PAGO AND IDENTIFICACION = @IDENTIFICACION 

				SET @PARAMETROS =
					'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<INFO_REG_BILLETE>' + 
				'<DOCUMENTO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@DOCUMENTO) + '</DOCUMENTO>' + 
				'<CAJA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CAJA) + '</CAJA>' + 
				'<TIPO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO) + '</TIPO>' + 
				'<PAGO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@PAGO) + '</PAGO>' + 
				'<IDENTIFICACION Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@IDENTIFICACION) + '</IDENTIFICACION>' + 
				'<CLIENTE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CLIENTE) + '</CLIENTE>' + 
				'<TELEFONO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TELEFONO) + '</TELEFONO>' + 
				'</INFO_REG_BILLETE>'


				-- inserta la solicitud correspondiente
				EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'INFOREGBILLETEPOS600', 'MODIFICA', @PARAMETROS, @ACTUALIZAR_SOLICITUD, @COL_ROWPOINTER
			END

			FETCH NEXT FROM C_MODIFIED
			INTO @DOCUMENTO, @CAJA, @TIPO, @PAGO, @IDENTIFICACION, @CLIENTE, @TELEFONO
		END

		CLOSE C_MODIFIED
		DEALLOCATE C_MODIFIED
	END

	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para modificar la tabla INFO_REG_BILLETE.',16,1 )
	END
END;





CREATE TRIGGER $$Compania$$.INFO_REG_BILLETE_POS_DEL
ON $$Compania$$.INFO_REG_BILLETE
FOR DELETE  
AS 
BEGIN   	
                DECLARE @ERROR  int
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @DOCUMENTO VARCHAR(20)
	DECLARE @CAJA VARCHAR(6)
	DECLARE @TIPO VARCHAR(1)
	DECLARE @PAGO VARCHAR(4)
	DECLARE @IDENTIFICACION VARCHAR(80)
	 -- Declaraciones	

	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM 
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_DELETED CURSOR LOCAL FOR
			SELECT DOCUMENTO, CAJA, TIPO, PAGO, IDENTIFICACION
			FROM DELETED

		OPEN C_DELETED
		FETCH NEXT FROM C_DELETED INTO 
		@DOCUMENTO, @CAJA, @TIPO, @PAGO, @IDENTIFICACION -- VARIABLES
		
		SET @ERROR = 0
		
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS = 
								'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<INFO_REG_BILLETE>' + 
				'<DOCUMENTO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@DOCUMENTO) + '</DOCUMENTO>' + 
				'<CAJA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CAJA) + '</CAJA>' + 
				'<TIPO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO) + '</TIPO>' + 
				'<PAGO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@PAGO) + '</PAGO>' + 
				'<IDENTIFICACION Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@IDENTIFICACION) + '</IDENTIFICACION>' + 
				'</INFO_REG_BILLETE>'
 
			
			-- inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'INFOREGBILLETEPOS600', 'ELIMINA', @PARAMETROS, 0, ''
			
			FETCH NEXT FROM C_DELETED INTO 
			@DOCUMENTO, @CAJA, @TIPO, @PAGO, @IDENTIFICACION -- VARIABLES
		END

		CLOSE C_DELETED
		DEALLOCATE C_DELETED
	END
	
	IF (@@ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para eliminar de la tabla INFO_REG_BILLETE.',16,1 )
	END
END;





CREATE TRIGGER $$Compania$$.LOCALIZACION_POS_INS
ON $$Compania$$.LOCALIZACION
FOR INSERT
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @BODEGA VARCHAR(4)
	DECLARE @LOCALIZACION VARCHAR(8)
	DECLARE @DESCRIPCION VARCHAR(40)
	DECLARE @VOLUMEN DECIMAL(28,8)
	DECLARE @PESO_MAXIMO DECIMAL(28,8)
	
	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_INSERTED CURSOR LOCAL FOR
		SELECT BODEGA, LOCALIZACION, DESCRIPCION, VOLUMEN, PESO_MAXIMO
		FROM INSERTED i
		WHERE 0 = (
				SELECT COUNT('n')
				FROM DELETED d
				WHERE i.BODEGA = d.BODEGA AND i.LOCALIZACION = d.LOCALIZACION
			   )
			
		OPEN C_INSERTED	
		FETCH NEXT FROM C_INSERTED INTO
		@BODEGA, @LOCALIZACION, @DESCRIPCION, @VOLUMEN, @PESO_MAXIMO
		SET @ERROR = 0
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS =
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<LOCALIZACION>' +
				'<BODEGA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@BODEGA) + '</BODEGA>' +
				'<LOCALIZACION Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@LOCALIZACION) + '</LOCALIZACION>' +
				'<DESCRIPCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DESCRIPCION) + '</DESCRIPCION>' +
				'<VOLUMEN Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@VOLUMEN) + '</VOLUMEN>' +
				'<PESO_MAXIMO Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@PESO_MAXIMO) + '</PESO_MAXIMO>' +
				'</LOCALIZACION>'
			-- Inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'LOCALIZACIONPOS600', 'INSERTA', @PARAMETROS, 0, ''
			FETCH NEXT FROM C_INSERTED INTO
			@BODEGA, @LOCALIZACION, @DESCRIPCION, @VOLUMEN, @PESO_MAXIMO
		END
		CLOSE C_INSERTED
    		DEALLOCATE C_INSERTED
	END
	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla LOCALIZACION.',16,1 )
	END
END
;





CREATE TRIGGER $$Compania$$.LOCALIZACION_POS_DEL
ON $$Compania$$.LOCALIZACION
FOR DELETE
AS
BEGIN   	
                DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @BODEGA VARCHAR(4)
	DECLARE @LOCALIZACION VARCHAR(8)
	 -- Declaraciones	
	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_DELETED CURSOR LOCAL FOR
			SELECT BODEGA, LOCALIZACION
			FROM DELETED d
			WHERE 0 = (
				SELECT COUNT('n')
				FROM INSERTED i
				WHERE d.BODEGA = i.BODEGA AND d.LOCALIZACION = i.LOCALIZACION
			   )
		OPEN C_DELETED
		FETCH NEXT FROM C_DELETED INTO
		@BODEGA, @LOCALIZACION
		
		SET @ERROR = 0
		
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS =
								'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<LOCALIZACION>' +
				'<BODEGA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@BODEGA) + '</BODEGA>' +
				'<LOCALIZACION Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@LOCALIZACION) + '</LOCALIZACION>' +
				'</LOCALIZACION>'
 -- XML
			
			-- inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'LOCALIZACIONPOS600', 'ELIMINA', @PARAMETROS, 0, ''
			
			FETCH NEXT FROM C_DELETED INTO
			@BODEGA, @LOCALIZACION
		END
		CLOSE C_DELETED
		DEALLOCATE C_DELETED
	END
	
	IF (@@ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para eliminar de la tabla LOCALIZACION.',16,1 )
	END
END
;




CREATE TRIGGER $$Compania$$.LOCALIZACION_POS_MOD
ON $$Compania$$.LOCALIZACION
FOR UPDATE
AS
BEGIN   	
	DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @COL_ROWPOINTER VARCHAR(36)
	DECLARE @HAY_CAMPOS_PARA_POS BIT
	DECLARE @ACTUALIZAR_SOLICITUD BIT
	DECLARE @BODEGA VARCHAR(4)
	DECLARE @LOCALIZACION VARCHAR(8)
	DECLARE @DESCRIPCION VARCHAR(40)
	 -- Declaraciones
	SET @ERROR = 0
	SELECT @PUBLICADOR = SITIO_LOCAL, @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_MODIFIED CURSOR LOCAL FOR
			SELECT BODEGA, LOCALIZACION, DESCRIPCION -- Columnas
			FROM INSERTED I
		SET @ACTUALIZAR_SOLICITUD = 1
		OPEN C_MODIFIED
		FETCH NEXT FROM C_MODIFIED
		INTO @BODEGA, @LOCALIZACION, @DESCRIPCION
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			IF ( NOT UPDATE(RECORDDATE) AND ( UPDATE(BODEGA) OR UPDATE(LOCALIZACION) OR UPDATE(DESCRIPCION)) )
			BEGIN
				SELECT @COL_ROWPOINTER = ROWPOINTER
				FROM $$Compania$$.LOCALIZACION
				WHERE BODEGA = @BODEGA AND LOCALIZACION = @LOCALIZACION
				SET @PARAMETROS =
					'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<LOCALIZACION>' +
				'<BODEGA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@BODEGA) + '</BODEGA>' +
				'<LOCALIZACION Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@LOCALIZACION) + '</LOCALIZACION>' +
				'<DESCRIPCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DESCRIPCION) + '</DESCRIPCION>' +
				'</LOCALIZACION>'
				-- inserta la solicitud correspondiente
				EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'LOCALIZACIONPOS600', 'MODIFICA', @PARAMETROS, @ACTUALIZAR_SOLICITUD, @COL_ROWPOINTER
			END
			FETCH NEXT FROM C_MODIFIED
			INTO @BODEGA, @LOCALIZACION, @DESCRIPCION
		END
		CLOSE C_MODIFIED
		DEALLOCATE C_MODIFIED
	END
	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para modificar la tabla LOCALIZACION.',16,1 )
	END
END
;




CREATE TRIGGER $$Compania$$.LOTE_POS_INS
ON $$Compania$$.LOTE
FOR INSERT
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @LOTE VARCHAR(15)
	DECLARE @ARTICULO VARCHAR(20)
	DECLARE @PROVEEDOR VARCHAR(20)
	DECLARE @LOTE_DEL_PROVEEDOR VARCHAR(15)
	DECLARE @FECHA_ENTRADA DATETIME
	DECLARE @FECHA_VENCIMIENTO DATETIME
	DECLARE @FECHA_CUARENTENA DATETIME
	DECLARE @CANTIDAD_INGRESADA DECIMAL(28,8)
	DECLARE @ESTADO VARCHAR(1)
	DECLARE @TIPO_INGRESO VARCHAR(1)
	DECLARE @ULTIMO_INGRESO INT
	
	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_INSERTED CURSOR LOCAL FOR
		SELECT LOTE, ARTICULO, PROVEEDOR, LOTE_DEL_PROVEEDOR, FECHA_ENTRADA, FECHA_VENCIMIENTO, FECHA_CUARENTENA, CANTIDAD_INGRESADA, ESTADO, TIPO_INGRESO, ULTIMO_INGRESO
		FROM INSERTED i
		WHERE 0 = (
				SELECT COUNT('n')
				FROM DELETED d
				WHERE i.LOTE = d.LOTE AND i.ARTICULO = d.ARTICULO
			   )
			
		OPEN C_INSERTED	
		FETCH NEXT FROM C_INSERTED INTO
		@LOTE, @ARTICULO, @PROVEEDOR, @LOTE_DEL_PROVEEDOR, @FECHA_ENTRADA, @FECHA_VENCIMIENTO, @FECHA_CUARENTENA, @CANTIDAD_INGRESADA, @ESTADO, @TIPO_INGRESO, @ULTIMO_INGRESO
		SET @ERROR = 0
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS =
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<LOTE>' +
				'<LOTE Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@LOTE) + '</LOTE>' +
				'<ARTICULO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@ARTICULO) + '</ARTICULO>' +
				'<PROVEEDOR Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@PROVEEDOR) + '</PROVEEDOR>' +
				'<LOTE_DEL_PROVEEDOR Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@LOTE_DEL_PROVEEDOR) + '</LOTE_DEL_PROVEEDOR>' +
				'<FECHA_ENTRADA Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_ENTRADA) + '</FECHA_ENTRADA>' +
				'<FECHA_VENCIMIENTO Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_VENCIMIENTO) + '</FECHA_VENCIMIENTO>' +
				'<FECHA_CUARENTENA Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_CUARENTENA) + '</FECHA_CUARENTENA>' +
				'<CANTIDAD_INGRESADA Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@CANTIDAD_INGRESADA) + '</CANTIDAD_INGRESADA>' +
				'<ESTADO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ESTADO) + '</ESTADO>' +
				'<TIPO_INGRESO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_INGRESO) + '</TIPO_INGRESO>' +
				'<ULTIMO_INGRESO Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@ULTIMO_INGRESO) + '</ULTIMO_INGRESO>' +
				'</LOTE>'
			-- Inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'LOTEPOS600', 'INSERTA', @PARAMETROS, 0, ''
			FETCH NEXT FROM C_INSERTED INTO
			@LOTE, @ARTICULO, @PROVEEDOR, @LOTE_DEL_PROVEEDOR, @FECHA_ENTRADA, @FECHA_VENCIMIENTO, @FECHA_CUARENTENA, @CANTIDAD_INGRESADA, @ESTADO, @TIPO_INGRESO, @ULTIMO_INGRESO
		END
		CLOSE C_INSERTED
    		DEALLOCATE C_INSERTED
	END
	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla LOTE.',16,1 )
	END
END
;




CREATE TRIGGER $$Compania$$.LOTE_POS_DEL
ON $$Compania$$.LOTE
FOR DELETE
AS
BEGIN   	
                DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @LOTE VARCHAR(15)
	DECLARE @ARTICULO VARCHAR(20)
	 -- Declaraciones	
	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_DELETED CURSOR LOCAL FOR
			SELECT LOTE, ARTICULO
			FROM DELETED d
			WHERE 0 = (
				SELECT COUNT('n')
				FROM INSERTED i
				WHERE d.LOTE = i.LOTE AND d.ARTICULO = i.ARTICULO
			   )
		OPEN C_DELETED
		FETCH NEXT FROM C_DELETED INTO
		@LOTE, @ARTICULO
		
		SET @ERROR = 0
		
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS =
								'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<LOTE>' +
				'<LOTE Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@LOTE) + '</LOTE>' +
				'<ARTICULO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@ARTICULO) + '</ARTICULO>' +
				'</LOTE>'
 -- XML
			
			-- inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'LOTEPOS600', 'ELIMINA', @PARAMETROS, 0, ''
			
			FETCH NEXT FROM C_DELETED INTO
			@LOTE, @ARTICULO
		END
		CLOSE C_DELETED
		DEALLOCATE C_DELETED
	END
	
	IF (@@ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para eliminar de la tabla LOTE.',16,1 )
	END
END
;



CREATE TRIGGER $$Compania$$.LOTE_POS_MOD
ON $$Compania$$.LOTE
FOR UPDATE
AS 
BEGIN   	
	DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @COL_ROWPOINTER VARCHAR(36)
	DECLARE @HAY_CAMPOS_PARA_POS BIT
	DECLARE @ACTUALIZAR_SOLICITUD BIT
	DECLARE @LOTE VARCHAR(15)
	DECLARE @ARTICULO VARCHAR(20)
	DECLARE @PROVEEDOR VARCHAR(20)
	DECLARE @LOTE_DEL_PROVEEDOR VARCHAR(15)
	DECLARE @FECHA_ENTRADA DATETIME
	DECLARE @FECHA_VENCIMIENTO DATETIME
	DECLARE @FECHA_CUARENTENA DATETIME
	DECLARE @CANTIDAD_INGRESADA DECIMAL(28,8)
	DECLARE @ESTADO VARCHAR(1)
	DECLARE @TIPO_INGRESO VARCHAR(1)
	DECLARE @ULTIMO_INGRESO INT
	 -- Declaraciones

	SET @ERROR = 0

	SELECT @PUBLICADOR = SITIO_LOCAL, @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_MODIFIED CURSOR LOCAL FOR
			SELECT LOTE, ARTICULO, PROVEEDOR, LOTE_DEL_PROVEEDOR, FECHA_ENTRADA, FECHA_VENCIMIENTO, FECHA_CUARENTENA, CANTIDAD_INGRESADA, ESTADO, TIPO_INGRESO, ULTIMO_INGRESO -- Columnas
			FROM INSERTED I

		SET @ACTUALIZAR_SOLICITUD = 1

		OPEN C_MODIFIED

		FETCH NEXT FROM C_MODIFIED
		INTO @LOTE, @ARTICULO, @PROVEEDOR, @LOTE_DEL_PROVEEDOR, @FECHA_ENTRADA, @FECHA_VENCIMIENTO, @FECHA_CUARENTENA, @CANTIDAD_INGRESADA, @ESTADO, @TIPO_INGRESO, @ULTIMO_INGRESO

		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			IF ( NOT UPDATE(RECORDDATE) AND ( UPDATE(LOTE) OR UPDATE(ARTICULO) OR UPDATE(PROVEEDOR) OR UPDATE(LOTE_DEL_PROVEEDOR) OR UPDATE(FECHA_ENTRADA) OR UPDATE(FECHA_VENCIMIENTO) OR UPDATE(FECHA_CUARENTENA) OR UPDATE(CANTIDAD_INGRESADA) OR UPDATE(ESTADO) OR UPDATE(TIPO_INGRESO) OR UPDATE(ULTIMO_INGRESO) ) )
			BEGIN

				SELECT @COL_ROWPOINTER = ROWPOINTER 
				FROM $$Compania$$.LOTE
				WHERE LOTE = @LOTE AND ARTICULO = @ARTICULO 

				SET @PARAMETROS =
					'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<LOTE>' + 
				'<LOTE Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@LOTE) + '</LOTE>' + 
				'<ARTICULO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@ARTICULO) + '</ARTICULO>' + 
				'<PROVEEDOR Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@PROVEEDOR) + '</PROVEEDOR>' + 
				'<LOTE_DEL_PROVEEDOR Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@LOTE_DEL_PROVEEDOR) + '</LOTE_DEL_PROVEEDOR>' + 
				'<FECHA_ENTRADA Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_ENTRADA) + '</FECHA_ENTRADA>' + 
				'<FECHA_VENCIMIENTO Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_VENCIMIENTO) + '</FECHA_VENCIMIENTO>' + 
				'<FECHA_CUARENTENA Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_CUARENTENA) + '</FECHA_CUARENTENA>' + 
				'<CANTIDAD_INGRESADA Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@CANTIDAD_INGRESADA) + '</CANTIDAD_INGRESADA>' + 
				'<ESTADO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ESTADO) + '</ESTADO>' + 
				'<TIPO_INGRESO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_INGRESO) + '</TIPO_INGRESO>' + 
				'<ULTIMO_INGRESO Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@ULTIMO_INGRESO) + '</ULTIMO_INGRESO>' + 
				'</LOTE>'


				-- inserta la solicitud correspondiente
				EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'LOTEPOS600', 'MODIFICA', @PARAMETROS, @ACTUALIZAR_SOLICITUD, @COL_ROWPOINTER
			END

			FETCH NEXT FROM C_MODIFIED
			INTO @LOTE, @ARTICULO, @PROVEEDOR, @LOTE_DEL_PROVEEDOR, @FECHA_ENTRADA, @FECHA_VENCIMIENTO, @FECHA_CUARENTENA, @CANTIDAD_INGRESADA, @ESTADO, @TIPO_INGRESO, @ULTIMO_INGRESO
		END

		CLOSE C_MODIFIED
		DEALLOCATE C_MODIFIED
	END

	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para modificar la tabla LOTE.',16,1 )
	END
END;


CREATE TRIGGER $$Compania$$.MODELO_RETENCION_POS_INS
ON $$Compania$$.MODELO_RETENCION
FOR INSERT
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @MODULO_OFFLINE INT
	DECLARE @MODELO_RETENCION VARCHAR(4)
	DECLARE @DESCRIPCION VARCHAR(40)
	
	
	SELECT @MODULO_OFFLINE = COUNT(0)
	FROM ERPADMIN.MODULO_INSTALADO
	WHERE CONJUNTO = '$$Compania$$'
	AND ACCION = 3159

	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM 
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF @MODULO_OFFLINE  = 1 AND NOT (SYSTEM_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_INSERTED CURSOR LOCAL FOR
		SELECT MODELO_RETENCION, DESCRIPCION
		FROM INSERTED
				
		OPEN C_INSERTED	
		FETCH NEXT FROM C_INSERTED INTO
		@MODELO_RETENCION, @DESCRIPCION

		SET @ERROR = 0
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS = 
			'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<MODELO_RETENCION>' + 
				'<MODELO_RETENCION Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@MODELO_RETENCION) + '</MODELO_RETENCION>' + 
				'<DESCRIPCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DESCRIPCION) + '</DESCRIPCION>' + 
				'</MODELO_RETENCION>'


			-- Inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'MODELORETENCIONPOS600', 'INSERTA', @PARAMETROS, 0, ''

			FETCH NEXT FROM C_INSERTED INTO
			@MODELO_RETENCION, @DESCRIPCION
		END

		CLOSE C_INSERTED
    		DEALLOCATE C_INSERTED
	END

	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla MODELO_RETENCION.',16,1 )
	END
END;


CREATE TRIGGER $$Compania$$.MODELO_RETENCION_POS_DEL
ON $$Compania$$.MODELO_RETENCION
FOR DELETE  
AS 
BEGIN   	
        DECLARE @ERROR  int
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @MODULO_OFFLINE INT
	DECLARE @MODELO_RETENCION VARCHAR(4)
	 -- Declaraciones	
	
	SELECT @MODULO_OFFLINE = COUNT(0)
	FROM ERPADMIN.MODULO_INSTALADO
	WHERE CONJUNTO = '$$Compania$$'
	AND ACCION = 3159

	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM 
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF @MODULO_OFFLINE  = 1 AND NOT (SYSTEM_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_DELETED CURSOR LOCAL FOR
			SELECT MODELO_RETENCION
			FROM DELETED

		OPEN C_DELETED
		FETCH NEXT FROM C_DELETED INTO 
		@MODELO_RETENCION -- VARIABLES
		
		SET @ERROR = 0
		
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS = 
							'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<MODELO_RETENCION>' + 
				'<MODELO_RETENCION Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@MODELO_RETENCION) + '</MODELO_RETENCION>' + 
				'</MODELO_RETENCION>'
 
			
			-- inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'MODELORETENCIONPOS600', 'ELIMINA', @PARAMETROS, 0, ''
			
			FETCH NEXT FROM C_DELETED INTO 
			@MODELO_RETENCION -- VARIABLES
		END

		CLOSE C_DELETED
		DEALLOCATE C_DELETED
	END
	
	IF (@@ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para eliminar de la tabla MODELO_RETENCION.',16,1 )
	END
END;



CREATE TRIGGER $$Compania$$.MODELO_RETENCION_POS_MOD
ON $$Compania$$.MODELO_RETENCION
FOR UPDATE
AS 
BEGIN   	
	DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @COL_ROWPOINTER VARCHAR(36)
	DECLARE @HAY_CAMPOS_PARA_POS BIT
	DECLARE @ACTUALIZAR_SOLICITUD BIT
	DECLARE @MODULO_OFFLINE INT
	DECLARE @MODELO_RETENCION VARCHAR(4)
	DECLARE @DESCRIPCION VARCHAR(40)
	 -- Declaraciones

	SET @ERROR = 0
	
	SELECT @MODULO_OFFLINE = COUNT(0)
	FROM ERPADMIN.MODULO_INSTALADO
	WHERE CONJUNTO = '$$Compania$$'
	AND ACCION = 3159

	SELECT @PUBLICADOR = SITIO_LOCAL, @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF @MODULO_OFFLINE  = 1 AND NOT (SYSTEM_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_MODIFIED CURSOR LOCAL FOR
			SELECT MODELO_RETENCION, DESCRIPCION -- Columnas
			FROM INSERTED I

		SET @ACTUALIZAR_SOLICITUD = 1

		OPEN C_MODIFIED

		FETCH NEXT FROM C_MODIFIED
		INTO @MODELO_RETENCION, @DESCRIPCION

		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			IF ( NOT UPDATE(RECORDDATE) AND ( UPDATE(MODELO_RETENCION) OR UPDATE(DESCRIPCION) ) )
			BEGIN

				SELECT @COL_ROWPOINTER = ROWPOINTER 
				FROM $$Compania$$.MODELO_RETENCION
				WHERE MODELO_RETENCION = @MODELO_RETENCION 

				SET @PARAMETROS =
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<MODELO_RETENCION>' + 
				'<MODELO_RETENCION Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@MODELO_RETENCION) + '</MODELO_RETENCION>' + 
				'<DESCRIPCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DESCRIPCION) + '</DESCRIPCION>' + 
				'</MODELO_RETENCION>'

				-- inserta la solicitud correspondiente
				EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'MODELORETENCIONPOS600', 'MODIFICA', @PARAMETROS, @ACTUALIZAR_SOLICITUD, @COL_ROWPOINTER
			END

			FETCH NEXT FROM C_MODIFIED
			INTO @MODELO_RETENCION, @DESCRIPCION
		END
		
		CLOSE C_MODIFIED
		DEALLOCATE C_MODIFIED
	END

	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para modificar la tabla MODELO_RETENCION.',16,1 )
	END
END;




CREATE TRIGGER $$Compania$$.MONEDA_POS_INS
ON $$Compania$$.MONEDA
FOR INSERT
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @MONEDA VARCHAR(4)
	DECLARE @NOMBRE VARCHAR(40)
	DECLARE @CODIGO_ISO VARCHAR(4)
	
	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_INSERTED CURSOR LOCAL FOR
		SELECT MONEDA, NOMBRE, CODIGO_ISO
		FROM INSERTED i
		WHERE 0 = (
				SELECT COUNT('n')
				FROM DELETED d
				WHERE i.MONEDA = d.MONEDA
			   )
			
		OPEN C_INSERTED	
		FETCH NEXT FROM C_INSERTED INTO
		@MONEDA, @NOMBRE, @CODIGO_ISO
		SET @ERROR = 0
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS =
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<MONEDA>' +
				'<MONEDA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@MONEDA) + '</MONEDA>' +
				'<NOMBRE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOMBRE) + '</NOMBRE>' +
				'<CODIGO_ISO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CODIGO_ISO) + '</CODIGO_ISO>' +
				'</MONEDA>'
			-- Inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'MONEDAPOS600', 'INSERTA', @PARAMETROS, 0, ''
			FETCH NEXT FROM C_INSERTED INTO
			@MONEDA, @NOMBRE, @CODIGO_ISO
		END
		CLOSE C_INSERTED
    		DEALLOCATE C_INSERTED
	END
	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla MONEDA.',16,1 )
	END
END
;




CREATE TRIGGER $$Compania$$.MONEDA_POS_DEL
ON $$Compania$$.MONEDA
FOR DELETE
AS
BEGIN   	
                DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @MONEDA VARCHAR(4)
	 -- Declaraciones	
	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_DELETED CURSOR LOCAL FOR
			SELECT MONEDA
			FROM DELETED d
			WHERE 0 = (
				SELECT COUNT('n')
				FROM INSERTED i
				WHERE d.MONEDA = i.MONEDA
			   )
		OPEN C_DELETED
		FETCH NEXT FROM C_DELETED INTO
		@MONEDA
		
		SET @ERROR = 0
		
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS =
								'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<MONEDA>' +
				'<MONEDA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@MONEDA) + '</MONEDA>' +
				'</MONEDA>'
 -- XML
			
			-- inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'MONEDAPOS600', 'ELIMINA', @PARAMETROS, 0, ''
			
			FETCH NEXT FROM C_DELETED INTO
			@MONEDA
		END
		CLOSE C_DELETED
		DEALLOCATE C_DELETED
	END
	
	IF (@@ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para eliminar de la tabla MONEDA.',16,1 )
	END
END
;




CREATE TRIGGER $$Compania$$.MONEDA_POS_MOD
ON $$Compania$$.MONEDA
FOR UPDATE
AS
BEGIN   	
	DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @COL_ROWPOINTER VARCHAR(36)
	DECLARE @HAY_CAMPOS_PARA_POS BIT
	DECLARE @ACTUALIZAR_SOLICITUD BIT
	DECLARE @MONEDA VARCHAR(4)
	DECLARE @NOMBRE VARCHAR(40)
	 -- Declaraciones
	SET @ERROR = 0
	SELECT @PUBLICADOR = SITIO_LOCAL, @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_MODIFIED CURSOR LOCAL FOR
			SELECT MONEDA, NOMBRE -- Columnas
			FROM INSERTED I
		SET @ACTUALIZAR_SOLICITUD = 1
		OPEN C_MODIFIED
		FETCH NEXT FROM C_MODIFIED
		INTO @MONEDA, @NOMBRE
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			IF ( NOT UPDATE(RECORDDATE) AND ( UPDATE(MONEDA) OR UPDATE(NOMBRE)  ) )
			BEGIN
				SELECT @COL_ROWPOINTER = ROWPOINTER
				FROM $$Compania$$.MONEDA
				WHERE MONEDA = @MONEDA
				SET @PARAMETROS =
					'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<MONEDA>' +
				'<MONEDA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@MONEDA) + '</MONEDA>' +
				'<NOMBRE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOMBRE) + '</NOMBRE>' +
				'</MONEDA>'
				-- inserta la solicitud correspondiente
				EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'MONEDAPOS600', 'MODIFICA', @PARAMETROS, @ACTUALIZAR_SOLICITUD, @COL_ROWPOINTER
			END
			FETCH NEXT FROM C_MODIFIED
			INTO @MONEDA, @NOMBRE
		END
		CLOSE C_MODIFIED
		DEALLOCATE C_MODIFIED
	END
	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para modificar la tabla MONEDA.',16,1 )
	END
END
;




CREATE TRIGGER $$Compania$$.NIT_POS_INS
ON $$Compania$$.NIT
FOR INSERT
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @NIT VARCHAR(20)
	DECLARE @RAZON_SOCIAL VARCHAR(80)
	DECLARE @ALIAS VARCHAR(80)
	
	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_INSERTED CURSOR LOCAL FOR
		SELECT NIT, RAZON_SOCIAL, ALIAS
		FROM INSERTED i
		WHERE 0 = (
				SELECT COUNT('n')
				FROM DELETED d
				WHERE i.NIT = d.NIT
			   )
			
		OPEN C_INSERTED	
		FETCH NEXT FROM C_INSERTED INTO
		@NIT, @RAZON_SOCIAL, @ALIAS
		SET @ERROR = 0
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS =
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<NIT>' +
				'<NIT Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@NIT) + '</NIT>' +
				'<RAZON_SOCIAL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@RAZON_SOCIAL) + '</RAZON_SOCIAL>' +
				'<ALIAS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ALIAS) + '</ALIAS>' +
				'</NIT>'
			-- Inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'NITPOS600', 'INSERTA', @PARAMETROS, 0, ''
			FETCH NEXT FROM C_INSERTED INTO
			@NIT, @RAZON_SOCIAL, @ALIAS
		END
		CLOSE C_INSERTED
    		DEALLOCATE C_INSERTED
	END
	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla NIT.',16,1 )
	END
END
;




CREATE TRIGGER $$Compania$$.NIT_POS_DEL
ON $$Compania$$.NIT
FOR DELETE
AS
BEGIN   	
                DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @NIT VARCHAR(20)
	 -- Declaraciones	
	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_DELETED CURSOR LOCAL FOR
			SELECT NIT
			FROM DELETED d
			WHERE 0 = (
				SELECT COUNT('n')
				FROM INSERTED i
				WHERE d.NIT = i.NIT
			   )
		OPEN C_DELETED
		FETCH NEXT FROM C_DELETED INTO
		@NIT
		
		SET @ERROR = 0
		
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS =
								'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<NIT>' +
				'<NIT Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@NIT) + '</NIT>' +
				'</NIT>'
 -- XML
			
			-- inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'NITPOS600', 'ELIMINA', @PARAMETROS, 0, ''
			
			FETCH NEXT FROM C_DELETED INTO
			@NIT
		END
		CLOSE C_DELETED
		DEALLOCATE C_DELETED
	END
	
	IF (@@ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para eliminar de la tabla NIT.',16,1 )
	END
END
;




CREATE TRIGGER $$Compania$$.NIT_POS_MOD
ON $$Compania$$.NIT
FOR UPDATE
AS
BEGIN   	
	DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @COL_ROWPOINTER VARCHAR(36)
	DECLARE @HAY_CAMPOS_PARA_POS BIT
	DECLARE @ACTUALIZAR_SOLICITUD BIT
	DECLARE @NIT VARCHAR(20)
	DECLARE @RAZON_SOCIAL VARCHAR(80)
	DECLARE @ALIAS VARCHAR(80)
	 -- Declaraciones
	SET @ERROR = 0
	SELECT @PUBLICADOR = SITIO_LOCAL, @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_MODIFIED CURSOR LOCAL FOR
			SELECT NIT, RAZON_SOCIAL, ALIAS -- Columnas
			FROM INSERTED I
		SET @ACTUALIZAR_SOLICITUD = 1
		OPEN C_MODIFIED
		FETCH NEXT FROM C_MODIFIED
		INTO @NIT, @RAZON_SOCIAL, @ALIAS
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			IF ( NOT UPDATE(RECORDDATE) AND ( UPDATE(NIT) OR UPDATE(RAZON_SOCIAL) OR UPDATE(ALIAS) ) )
			BEGIN
				SELECT @COL_ROWPOINTER = ROWPOINTER
				FROM $$Compania$$.NIT
				WHERE NIT = @NIT
				SET @PARAMETROS =
					'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<NIT>' +
				'<NIT Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@NIT) + '</NIT>' +
				'<RAZON_SOCIAL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@RAZON_SOCIAL) + '</RAZON_SOCIAL>' +
				'<ALIAS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ALIAS) + '</ALIAS>' +
				'</NIT>'
				-- inserta la solicitud correspondiente
				EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'NITPOS600', 'MODIFICA', @PARAMETROS, @ACTUALIZAR_SOLICITUD, @COL_ROWPOINTER
			END
			FETCH NEXT FROM C_MODIFIED
			INTO @NIT, @RAZON_SOCIAL, @ALIAS
		END
		CLOSE C_MODIFIED
		DEALLOCATE C_MODIFIED
	END
	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para modificar la tabla NIT.',16,1 )
	END
END
;





CREATE TRIGGER $$Compania$$.NIVEL_PRECIO_POS_INS
ON $$Compania$$.NIVEL_PRECIO
FOR INSERT
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @NIVEL_PRECIO VARCHAR(12)
	DECLARE @MONEDA VARCHAR(1)
	DECLARE @CONDICION_PAGO VARCHAR(4)
	DECLARE @ESQUEMA_TRABAJO VARCHAR(1)
	DECLARE @SUGERIR_DESCUENTO VARCHAR(1)
	DECLARE @DESCUENTOS VARCHAR(1)
	
	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_INSERTED CURSOR LOCAL FOR
		SELECT NIVEL_PRECIO, MONEDA, CONDICION_PAGO, ESQUEMA_TRABAJO, DESCUENTOS, SUGERIR_DESCUENTO
		FROM INSERTED i
		WHERE 0 = (
				SELECT COUNT('n')
				FROM DELETED d
				WHERE i.NIVEL_PRECIO = d.NIVEL_PRECIO AND i.MONEDA = d.MONEDA
			   )
			
		OPEN C_INSERTED	
		FETCH NEXT FROM C_INSERTED INTO
		@NIVEL_PRECIO, @MONEDA, @CONDICION_PAGO, @ESQUEMA_TRABAJO, @DESCUENTOS, @SUGERIR_DESCUENTO
		SET @ERROR = 0
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS =
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<NIVEL_PRECIO>' +
				'<NIVEL_PRECIO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@NIVEL_PRECIO) + '</NIVEL_PRECIO>' +
				'<MONEDA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@MONEDA) + '</MONEDA>' +
				'<CONDICION_PAGO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CONDICION_PAGO) + '</CONDICION_PAGO>' +
				'<ESQUEMA_TRABAJO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ESQUEMA_TRABAJO) + '</ESQUEMA_TRABAJO>' +
				'<DESCUENTOS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DESCUENTOS) + '</DESCUENTOS>' +
				'<SUGERIR_DESCUENTO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@SUGERIR_DESCUENTO) + '</SUGERIR_DESCUENTO>' +
				'</NIVEL_PRECIO>'
			-- Inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'NIVELPRECIOPOS600', 'INSERTA', @PARAMETROS, 0, ''
			FETCH NEXT FROM C_INSERTED INTO
			@NIVEL_PRECIO, @MONEDA, @CONDICION_PAGO, @ESQUEMA_TRABAJO, @DESCUENTOS, @SUGERIR_DESCUENTO
		END
		CLOSE C_INSERTED
    		DEALLOCATE C_INSERTED
	END
	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla NIVEL_PRECIO.',16,1 )
	END
END
;




CREATE TRIGGER $$Compania$$.NIVEL_PRECIO_POS_DEL
ON $$Compania$$.NIVEL_PRECIO
FOR DELETE
AS
BEGIN   	
                DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @NIVEL_PRECIO VARCHAR(12)
	DECLARE @MONEDA VARCHAR(1)
	 -- Declaraciones	
	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_DELETED CURSOR LOCAL FOR
			SELECT NIVEL_PRECIO, MONEDA
			FROM DELETED d
			WHERE 0 = (
				SELECT COUNT('n')
				FROM INSERTED i
				WHERE d.NIVEL_PRECIO = i.NIVEL_PRECIO AND d.MONEDA = i.MONEDA
			   )
		OPEN C_DELETED
		FETCH NEXT FROM C_DELETED INTO
		@NIVEL_PRECIO, @MONEDA
		
		SET @ERROR = 0
		
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS =
								'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<NIVEL_PRECIO>' +
				'<NIVEL_PRECIO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@NIVEL_PRECIO) + '</NIVEL_PRECIO>' +
				'<MONEDA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@MONEDA) + '</MONEDA>' +
				'</NIVEL_PRECIO>'
 -- XML
			
			-- inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'NIVELPRECIOPOS600', 'ELIMINA', @PARAMETROS, 0, ''
			
			FETCH NEXT FROM C_DELETED INTO
			@NIVEL_PRECIO, @MONEDA
		END
		CLOSE C_DELETED
		DEALLOCATE C_DELETED
	END
	
	IF (@@ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para eliminar de la tabla NIVEL_PRECIO.',16,1 )
	END
END
;



CREATE TRIGGER $$Compania$$.NIVEL_PRECIO_POS_MOD
ON $$Compania$$.NIVEL_PRECIO
FOR UPDATE
AS
BEGIN   	
	DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @COL_ROWPOINTER VARCHAR(36)
	DECLARE @HAY_CAMPOS_PARA_POS BIT
	DECLARE @ACTUALIZAR_SOLICITUD BIT
	DECLARE @NIVEL_PRECIO VARCHAR(12)
	DECLARE @MONEDA VARCHAR(1)
	DECLARE @CONDICION_PAGO VARCHAR(4)
	DECLARE @ESQUEMA_TRABAJO VARCHAR(1)
	DECLARE @DESCUENTOS VARCHAR(1)
	DECLARE @SUGERIR_DESCUENTO VARCHAR(1)
	 -- Declaraciones
	SET @ERROR = 0
	SELECT @PUBLICADOR = SITIO_LOCAL, @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_MODIFIED CURSOR LOCAL FOR
			SELECT NIVEL_PRECIO, MONEDA, CONDICION_PAGO, ESQUEMA_TRABAJO, DESCUENTOS, SUGERIR_DESCUENTO -- Columnas
			FROM INSERTED I
		SET @ACTUALIZAR_SOLICITUD = 1
		OPEN C_MODIFIED
		FETCH NEXT FROM C_MODIFIED
		INTO @NIVEL_PRECIO, @MONEDA, @CONDICION_PAGO, @ESQUEMA_TRABAJO, @DESCUENTOS, @SUGERIR_DESCUENTO
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			IF ( NOT UPDATE(RECORDDATE) AND ( UPDATE(NIVEL_PRECIO) OR UPDATE(MONEDA) OR UPDATE(CONDICION_PAGO) OR UPDATE(ESQUEMA_TRABAJO) OR UPDATE(DESCUENTOS) OR UPDATE(SUGERIR_DESCUENTO)) )
			BEGIN
				SELECT @COL_ROWPOINTER = ROWPOINTER
				FROM $$Compania$$.NIVEL_PRECIO
				WHERE NIVEL_PRECIO = @NIVEL_PRECIO AND MONEDA = @MONEDA
				SET @PARAMETROS =
					'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<NIVEL_PRECIO>' +
				'<NIVEL_PRECIO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@NIVEL_PRECIO) + '</NIVEL_PRECIO>' +
				'<MONEDA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@MONEDA) + '</MONEDA>' +
				'<CONDICION_PAGO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CONDICION_PAGO) + '</CONDICION_PAGO>' +
				'<ESQUEMA_TRABAJO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ESQUEMA_TRABAJO) + '</ESQUEMA_TRABAJO>' +
				'<DESCUENTOS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DESCUENTOS) + '</DESCUENTOS>' +
				'<SUGERIR_DESCUENTO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@SUGERIR_DESCUENTO) + '</SUGERIR_DESCUENTO>' +
				'</NIVEL_PRECIO>'
				-- inserta la solicitud correspondiente
				EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'NIVELPRECIOPOS600', 'MODIFICA', @PARAMETROS, @ACTUALIZAR_SOLICITUD, @COL_ROWPOINTER
			END
			FETCH NEXT FROM C_MODIFIED
			INTO @NIVEL_PRECIO, @MONEDA, @CONDICION_PAGO, @ESQUEMA_TRABAJO, @DESCUENTOS, @SUGERIR_DESCUENTO
		END
		CLOSE C_MODIFIED
		DEALLOCATE C_MODIFIED
	END
	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para modificar la tabla NIVEL_PRECIO.',16,1 )
	END
END
;


CREATE TRIGGER $$Compania$$.PAGO_POS_POS_INS
ON $$Compania$$.PAGO_POS
FOR INSERT
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @TIPO_SITIO_LOCAL VARCHAR(1)
	DECLARE @PAGO VARCHAR(4)
	DECLARE @CAJA VARCHAR(6)
	DECLARE @DOCUMENTO VARCHAR(50)
	DECLARE @TIPO VARCHAR(1)
	DECLARE @CONDICION_PAGO VARCHAR(4)
	DECLARE @ENTIDAD_FINANCIERA VARCHAR(8)
	DECLARE @TIPO_TARJETA VARCHAR(12)
	DECLARE @FORMA_PAGO VARCHAR(4)
	DECLARE @NUMERO VARCHAR(80)
	DECLARE @MONTO_LOCAL DECIMAL(28,8)
	DECLARE @MONTO_DOLAR DECIMAL(28,8)
	DECLARE @AUTORIZACION VARCHAR(80)
	DECLARE @FECHA_EXPIRACION VARCHAR(5)
	DECLARE @COBRO INT
	DECLARE @CLIENTE_LIQUIDADOR VARCHAR(20)
	DECLARE @TIPO_COBRO VARCHAR(1)
	
	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM ,
		@TIPO_SITIO_LOCAL = TIPO_SITIO_LOCAL
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM) AND @TIPO_SITIO_LOCAL = 'T'
	BEGIN
		DECLARE C_INSERTED CURSOR LOCAL FOR
		SELECT PAGO, CAJA, DOCUMENTO, TIPO, CONDICION_PAGO, ENTIDAD_FINANCIERA, TIPO_TARJETA, FORMA_PAGO, NUMERO, MONTO_LOCAL, MONTO_DOLAR, AUTORIZACION, FECHA_EXPIRACION, COBRO, CLIENTE_LIQUIDADOR, TIPO_COBRO
		FROM INSERTED i
		WHERE 0 = (
				SELECT COUNT('n')
				FROM DELETED d
				WHERE i.PAGO = d.PAGO AND i.CAJA = d.CAJA AND i.DOCUMENTO = d.DOCUMENTO AND i.TIPO = d.TIPO
			   )
			
		OPEN C_INSERTED	
		FETCH NEXT FROM C_INSERTED INTO
		@PAGO, @CAJA, @DOCUMENTO, @TIPO, @CONDICION_PAGO, @ENTIDAD_FINANCIERA, @TIPO_TARJETA, @FORMA_PAGO, @NUMERO, @MONTO_LOCAL, @MONTO_DOLAR, @AUTORIZACION, @FECHA_EXPIRACION, @COBRO, @CLIENTE_LIQUIDADOR, @TIPO_COBRO
		SET @ERROR = 0
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS =
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<PAGO_POS>' +
				'<PAGO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@PAGO) + '</PAGO>' +
				'<CAJA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CAJA) + '</CAJA>' +
				'<DOCUMENTO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@DOCUMENTO) + '</DOCUMENTO>' +
				'<TIPO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO) + '</TIPO>' +
				'<CONDICION_PAGO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CONDICION_PAGO) + '</CONDICION_PAGO>' +
				'<ENTIDAD_FINANCIERA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ENTIDAD_FINANCIERA) + '</ENTIDAD_FINANCIERA>' +
				'<TIPO_TARJETA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_TARJETA) + '</TIPO_TARJETA>' +
				'<FORMA_PAGO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@FORMA_PAGO) + '</FORMA_PAGO>' +
				'<NUMERO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NUMERO) + '</NUMERO>' +
				'<MONTO_LOCAL Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@MONTO_LOCAL) + '</MONTO_LOCAL>' +
				'<MONTO_DOLAR Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@MONTO_DOLAR) + '</MONTO_DOLAR>' +
				'<AUTORIZACION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@AUTORIZACION) + '</AUTORIZACION>' +
				'<FECHA_EXPIRACION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@FECHA_EXPIRACION) + '</FECHA_EXPIRACION>' +
				'<COBRO Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@COBRO) + '</COBRO>' +
				'<CLIENTE_LIQUIDADOR Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CLIENTE_LIQUIDADOR) + '</CLIENTE_LIQUIDADOR>' + 
				'<TIPO_COBRO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_COBRO) + '</TIPO_COBRO>' + 
				'</PAGO_POS>'
			-- Inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'PAGOPOSPOS600', 'INSERTA', @PARAMETROS, 0, ''
			FETCH NEXT FROM C_INSERTED INTO
			@PAGO, @CAJA, @DOCUMENTO, @TIPO, @CONDICION_PAGO, @ENTIDAD_FINANCIERA, @TIPO_TARJETA, @FORMA_PAGO, @NUMERO, @MONTO_LOCAL, @MONTO_DOLAR, @AUTORIZACION, @FECHA_EXPIRACION, @COBRO, @CLIENTE_LIQUIDADOR, @TIPO_COBRO
		END
		CLOSE C_INSERTED
    		DEALLOCATE C_INSERTED
	END
	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla PAGO_POS.',16,1 )
	END
END;




CREATE TRIGGER $$Compania$$.PAGO_POS_POS_DEL
ON $$Compania$$.PAGO_POS
FOR DELETE
AS
BEGIN   	
                DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @TIPO_SITIO_LOCAL VARCHAR(1)
	DECLARE @PAGO VARCHAR(4)
	DECLARE @CAJA VARCHAR(6)
	DECLARE @DOCUMENTO VARCHAR(50)
	DECLARE @TIPO VARCHAR(1)
	 -- Declaraciones	
	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM ,
		@TIPO_SITIO_LOCAL = TIPO_SITIO_LOCAL
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM) AND @TIPO_SITIO_LOCAL = 'T'
	BEGIN
		DECLARE C_DELETED CURSOR LOCAL FOR
			SELECT PAGO, CAJA, DOCUMENTO, TIPO
			FROM DELETED d
			WHERE 0 = (
				SELECT COUNT('n')
				FROM INSERTED i
				WHERE d.PAGO = i.PAGO AND d.CAJA = i.CAJA AND d.DOCUMENTO = i.DOCUMENTO AND d.TIPO = i.TIPO
			   )
		OPEN C_DELETED
		FETCH NEXT FROM C_DELETED INTO
		@PAGO, @CAJA, @DOCUMENTO, @TIPO
		
		SET @ERROR = 0
		
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS =
								'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<PAGO_POS>' +
				'<PAGO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@PAGO) + '</PAGO>' +
				'<CAJA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CAJA) + '</CAJA>' +
				'<DOCUMENTO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@DOCUMENTO) + '</DOCUMENTO>' +
				'<TIPO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO) + '</TIPO>' +
				'</PAGO_POS>'
 -- XML
			
			-- inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'PAGOPOSPOS600', 'ELIMINA', @PARAMETROS, 0, ''
			
			FETCH NEXT FROM C_DELETED INTO
			@PAGO, @CAJA, @DOCUMENTO, @TIPO
		END
		CLOSE C_DELETED
		DEALLOCATE C_DELETED
	END
	
	IF (@@ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para eliminar de la tabla PAGO_POS.',16,1 )
	END
END;





CREATE TRIGGER $$Compania$$.PAGO_POS_POS_MOD
ON $$Compania$$.PAGO_POS
FOR UPDATE
AS
BEGIN   	
	DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @TIPO_SITIO_LOCAL VARCHAR(1)
	DECLARE @COL_ROWPOINTER VARCHAR(36)
	DECLARE @HAY_CAMPOS_PARA_POS BIT
	DECLARE @ACTUALIZAR_SOLICITUD BIT
	DECLARE @PAGO VARCHAR(4)
	DECLARE @CAJA VARCHAR(6)
	DECLARE @DOCUMENTO VARCHAR(50)
	DECLARE @TIPO VARCHAR(1)
	DECLARE @CONDICION_PAGO VARCHAR(4)
	DECLARE @ENTIDAD_FINANCIERA VARCHAR(8)
	DECLARE @TIPO_TARJETA VARCHAR(12)
	DECLARE @FORMA_PAGO VARCHAR(4)
	DECLARE @NUMERO VARCHAR(80)
	DECLARE @MONTO_LOCAL DECIMAL(28,8)
	DECLARE @MONTO_DOLAR DECIMAL(28,8)
	DECLARE @AUTORIZACION VARCHAR(80)
	DECLARE @FECHA_EXPIRACION VARCHAR(5)
	DECLARE @COBRO INT
	DECLARE @CLIENTE_LIQUIDADOR VARCHAR(20)
	DECLARE @TIPO_COBRO VARCHAR(1)
	 -- Declaraciones
	SET @ERROR = 0
	SELECT @PUBLICADOR = SITIO_LOCAL, @USUARIO_POS_WSQM = USUARIO_WSQM,
		@TIPO_SITIO_LOCAL = TIPO_SITIO_LOCAL
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM) AND @TIPO_SITIO_LOCAL = 'T'
	BEGIN
		DECLARE C_MODIFIED CURSOR LOCAL FOR
			SELECT PAGO, CAJA, DOCUMENTO, TIPO, CONDICION_PAGO, ENTIDAD_FINANCIERA, TIPO_TARJETA, FORMA_PAGO, NUMERO, MONTO_LOCAL, MONTO_DOLAR, AUTORIZACION, FECHA_EXPIRACION, COBRO, CLIENTE_LIQUIDADOR, TIPO_COBRO -- Columnas
			FROM INSERTED I
		SET @ACTUALIZAR_SOLICITUD = 1
		OPEN C_MODIFIED
		FETCH NEXT FROM C_MODIFIED
		INTO @PAGO, @CAJA, @DOCUMENTO, @TIPO, @CONDICION_PAGO, @ENTIDAD_FINANCIERA, @TIPO_TARJETA, @FORMA_PAGO, @NUMERO, @MONTO_LOCAL, @MONTO_DOLAR, @AUTORIZACION, @FECHA_EXPIRACION, @COBRO, @CLIENTE_LIQUIDADOR, @TIPO_COBRO
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			IF ( NOT UPDATE(RECORDDATE) AND ( UPDATE(PAGO) OR UPDATE(CAJA) OR UPDATE(DOCUMENTO) OR UPDATE(TIPO) OR UPDATE(CONDICION_PAGO) OR UPDATE(ENTIDAD_FINANCIERA) OR UPDATE(TIPO_TARJETA) OR UPDATE(FORMA_PAGO) OR UPDATE(NUMERO) OR UPDATE(MONTO_LOCAL) OR UPDATE(MONTO_DOLAR) OR UPDATE(AUTORIZACION) OR UPDATE(FECHA_EXPIRACION) OR UPDATE(COBRO) OR UPDATE(CLIENTE_LIQUIDADOR) OR UPDATE(TIPO_COBRO) ) )
			BEGIN
				SELECT @COL_ROWPOINTER = ROWPOINTER
				FROM $$Compania$$.PAGO_POS
				WHERE PAGO = @PAGO AND CAJA = @CAJA AND DOCUMENTO = @DOCUMENTO AND TIPO = @TIPO
				SET @PARAMETROS =
					'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<PAGO_POS>' +
				'<PAGO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@PAGO) + '</PAGO>' +
				'<CAJA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CAJA) + '</CAJA>' +
				'<DOCUMENTO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@DOCUMENTO) + '</DOCUMENTO>' +
				'<TIPO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO) + '</TIPO>' +
				'<CONDICION_PAGO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CONDICION_PAGO) + '</CONDICION_PAGO>' +
				'<ENTIDAD_FINANCIERA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ENTIDAD_FINANCIERA) + '</ENTIDAD_FINANCIERA>' +
				'<TIPO_TARJETA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_TARJETA) + '</TIPO_TARJETA>' +
				'<FORMA_PAGO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@FORMA_PAGO) + '</FORMA_PAGO>' +
				'<NUMERO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NUMERO) + '</NUMERO>' +
				'<MONTO_LOCAL Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@MONTO_LOCAL) + '</MONTO_LOCAL>' +
				'<MONTO_DOLAR Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@MONTO_DOLAR) + '</MONTO_DOLAR>' +
				'<AUTORIZACION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@AUTORIZACION) + '</AUTORIZACION>' +
				'<FECHA_EXPIRACION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@FECHA_EXPIRACION) + '</FECHA_EXPIRACION>' +
				'<COBRO Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@COBRO) + '</COBRO>' +
				'<CLIENTE_LIQUIDADOR Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CLIENTE_LIQUIDADOR) + '</CLIENTE_LIQUIDADOR>' + 
				'<TIPO_COBRO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_COBRO) + '</TIPO_COBRO>' + 
				'</PAGO_POS>'
				-- inserta la solicitud correspondiente
				EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'PAGOPOSPOS600', 'MODIFICA', @PARAMETROS, @ACTUALIZAR_SOLICITUD, @COL_ROWPOINTER
			END
			FETCH NEXT FROM C_MODIFIED
			INTO @PAGO, @CAJA, @DOCUMENTO, @TIPO, @CONDICION_PAGO, @ENTIDAD_FINANCIERA, @TIPO_TARJETA, @FORMA_PAGO, @NUMERO, @MONTO_LOCAL, @MONTO_DOLAR, @AUTORIZACION, @FECHA_EXPIRACION, @COBRO, @CLIENTE_LIQUIDADOR, @TIPO_COBRO
		END
		CLOSE C_MODIFIED
		DEALLOCATE C_MODIFIED
	END
	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para modificar la tabla PAGO_POS.',16,1 )
	END
END;






CREATE TRIGGER $$Compania$$.PAIS_POS_INS
ON $$Compania$$.PAIS
FOR INSERT
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @PAIS VARCHAR(4)
	DECLARE @DIRECCION VARCHAR(10)
	DECLARE @NOMBRE VARCHAR(40)
	DECLARE @CTR_VENTAS VARCHAR(25)
	DECLARE @CTA_VENTAS VARCHAR(25)
	DECLARE @CTR_DESC_GRAL VARCHAR(25)
	DECLARE @CTA_DESC_GRAL VARCHAR(25)
	DECLARE @CTR_COST_VENT VARCHAR(25)
	DECLARE @CTA_COST_VENT VARCHAR(25)
	DECLARE @CTR_DESC_LIN VARCHAR(25)
	DECLARE @CTA_DESC_LIN VARCHAR(25)
	DECLARE @CTR_COST_LIN VARCHAR(25)
	DECLARE @CTA_COST_LIN VARCHAR(25)
	DECLARE @CTR_GAST_COM VARCHAR(25)
	DECLARE @CTA_GAST_COM VARCHAR(25)
	DECLARE @CTR_CONTADO VARCHAR(25)
	DECLARE @CTA_CONTADO VARCHAR(25)
	DECLARE @CTR_CXC VARCHAR(25)
	DECLARE @CTA_CXC VARCHAR(25)
	DECLARE @CTR_LXC VARCHAR(25)
	DECLARE @CTA_LXC VARCHAR(25)
	DECLARE @CTR_PRONTO_PAG_CXC VARCHAR(25)
	DECLARE @CTA_PRONTO_PAG_CXC VARCHAR(25)
	DECLARE @CTR_INT_MORA_CXC VARCHAR(25)
	DECLARE @CTA_INT_MORA_CXC VARCHAR(25)
	DECLARE @CTR_RECIBOS_CXC VARCHAR(25)
	DECLARE @CTA_RECIBOS_CXC VARCHAR(25)
	DECLARE @CTR_DEBITO_CXC VARCHAR(25)
	DECLARE @CTA_DEBITO_CXC VARCHAR(25)
	DECLARE @CTR_CREDITO_CXC VARCHAR(25)
	DECLARE @CTA_CREDITO_CXC VARCHAR(25)
	DECLARE @CTR_IMPUESTO1_CXC VARCHAR(25)
	DECLARE @CTA_IMPUESTO1_CXC VARCHAR(25)
	DECLARE @CTR_IMPUESTO2_CXC VARCHAR(25)
	DECLARE @CTA_IMPUESTO2_CXC VARCHAR(25)
	DECLARE @CTR_RUBRO1_CXC VARCHAR(25)
	DECLARE @CTA_RUBRO1_CXC VARCHAR(25)
	DECLARE @CTR_RUBRO2_CXC VARCHAR(25)
	DECLARE @CTA_RUBRO2_CXC VARCHAR(25)
	DECLARE @CTR_ANTICIPO_CXC VARCHAR(25)
	DECLARE @CTA_ANTICIPO_CXC VARCHAR(25)
	DECLARE @CTR_LXP VARCHAR(25)
	DECLARE @CTA_LXP VARCHAR(25)
	DECLARE @CTR_CREDITO_CXP VARCHAR(25)
	DECLARE @CTA_CREDITO_CXP VARCHAR(25)
	DECLARE @CTR_DEBITO_CXP VARCHAR(25)
	DECLARE @CTA_DEBITO_CXP VARCHAR(25)
	DECLARE @CTR_CXP VARCHAR(25)
	DECLARE @CTA_CXP VARCHAR(25)
	DECLARE @CTR_PRONTO_PAG_CXP VARCHAR(25)
	DECLARE @CTA_PRONTO_PAG_CXP VARCHAR(25)
	DECLARE @CTR_COMISION_CXP VARCHAR(25)
	DECLARE @CTA_COMISION_CXP VARCHAR(25)
	DECLARE @CTR_IMPUESTO1_CXP VARCHAR(25)
	DECLARE @CTA_IMPUESTO1_CXP VARCHAR(25)
	DECLARE @CTR_IMPUESTO2_CXP VARCHAR(25)
	DECLARE @CTA_IMPUESTO2_CXP VARCHAR(25)
	DECLARE @CTR_RUBRO1_CXP VARCHAR(25)
	DECLARE @CTA_RUBRO1_CXP VARCHAR(25)
	DECLARE @CTR_RUBRO2_CXP VARCHAR(25)
	DECLARE @CTA_RUBRO2_CXP VARCHAR(25)
	DECLARE @CTR_ANTICIPO_CXP VARCHAR(25)
	DECLARE @CTA_ANTICIPO_CXP VARCHAR(25)
	DECLARE @CTR_DESC_BONIF VARCHAR(25)
	DECLARE @CTA_DESC_BONIF VARCHAR(25)
	DECLARE @CTR_DEV_VENTAS VARCHAR(25)
	DECLARE @CTA_DEV_VENTAS VARCHAR(25)
	DECLARE @CTR_INT_CORRIENTE VARCHAR(25)
	DECLARE @CTA_INT_CORRIENTE VARCHAR(25)
	DECLARE @CODIGO_ISO VARCHAR(4)
	DECLARE @ETIQUETA_DIV_GEO1 VARCHAR(20)
	DECLARE @ETIQUETA_DIV_GEO2 VARCHAR(20)
	DECLARE @MONEDA VARCHAR(4)
	
	
	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS
	
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (SYSTEM_USER  = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_INSERTED CURSOR LOCAL FOR
		SELECT PAIS, DIRECCION, NOMBRE, CTR_VENTAS, CTA_VENTAS, CTR_DESC_GRAL, CTA_DESC_GRAL, CTR_COST_VENT, CTA_COST_VENT, CTR_DESC_LIN, CTA_DESC_LIN, CTR_COST_LIN, CTA_COST_LIN, CTR_GAST_COM, CTA_GAST_COM, CTR_CONTADO, CTA_CONTADO, CTR_CXC, CTA_CXC, CTR_LXC, CTA_LXC, CTR_PRONTO_PAG_CXC, CTA_PRONTO_PAG_CXC, CTR_INT_MORA_CXC, CTA_INT_MORA_CXC, CTR_RECIBOS_CXC, CTA_RECIBOS_CXC, CTR_DEBITO_CXC, CTA_DEBITO_CXC, CTR_CREDITO_CXC, CTA_CREDITO_CXC, CTR_IMPUESTO1_CXC, CTA_IMPUESTO1_CXC, CTR_IMPUESTO2_CXC, CTA_IMPUESTO2_CXC, CTR_RUBRO1_CXC, CTA_RUBRO1_CXC, CTR_RUBRO2_CXC, CTA_RUBRO2_CXC, CTR_ANTICIPO_CXC, CTA_ANTICIPO_CXC, CTR_LXP, CTA_LXP, CTR_CREDITO_CXP, CTA_CREDITO_CXP, CTR_DEBITO_CXP, CTA_DEBITO_CXP, CTR_CXP, CTA_CXP, CTR_PRONTO_PAG_CXP, CTA_PRONTO_PAG_CXP, CTR_COMISION_CXP, CTA_COMISION_CXP, CTR_IMPUESTO1_CXP, CTA_IMPUESTO1_CXP, CTR_IMPUESTO2_CXP, CTA_IMPUESTO2_CXP, CTR_RUBRO1_CXP, CTA_RUBRO1_CXP, CTR_RUBRO2_CXP, CTA_RUBRO2_CXP, CTR_ANTICIPO_CXP, CTA_ANTICIPO_CXP, CTR_DESC_BONIF, CTA_DESC_BONIF, CTR_DEV_VENTAS, CTA_DEV_VENTAS, CTR_INT_CORRIENTE, CTA_INT_CORRIENTE, CODIGO_ISO, ETIQUETA_DIV_GEO1, ETIQUETA_DIV_GEO2, MONEDA
		FROM INSERTED 
			
		OPEN C_INSERTED	
		FETCH NEXT FROM C_INSERTED INTO
		@PAIS, @DIRECCION, @NOMBRE, @CTR_VENTAS, @CTA_VENTAS, @CTR_DESC_GRAL, @CTA_DESC_GRAL, @CTR_COST_VENT, @CTA_COST_VENT, @CTR_DESC_LIN, @CTA_DESC_LIN, @CTR_COST_LIN, @CTA_COST_LIN, @CTR_GAST_COM, @CTA_GAST_COM, @CTR_CONTADO, @CTA_CONTADO, @CTR_CXC, @CTA_CXC, @CTR_LXC, @CTA_LXC, @CTR_PRONTO_PAG_CXC, @CTA_PRONTO_PAG_CXC, @CTR_INT_MORA_CXC, @CTA_INT_MORA_CXC, @CTR_RECIBOS_CXC, @CTA_RECIBOS_CXC, @CTR_DEBITO_CXC, @CTA_DEBITO_CXC, @CTR_CREDITO_CXC, @CTA_CREDITO_CXC, @CTR_IMPUESTO1_CXC, @CTA_IMPUESTO1_CXC, @CTR_IMPUESTO2_CXC, @CTA_IMPUESTO2_CXC, @CTR_RUBRO1_CXC, @CTA_RUBRO1_CXC, @CTR_RUBRO2_CXC, @CTA_RUBRO2_CXC, @CTR_ANTICIPO_CXC, @CTA_ANTICIPO_CXC, @CTR_LXP, @CTA_LXP, @CTR_CREDITO_CXP, @CTA_CREDITO_CXP, @CTR_DEBITO_CXP, @CTA_DEBITO_CXP, @CTR_CXP, @CTA_CXP, @CTR_PRONTO_PAG_CXP, @CTA_PRONTO_PAG_CXP, @CTR_COMISION_CXP, @CTA_COMISION_CXP, @CTR_IMPUESTO1_CXP, @CTA_IMPUESTO1_CXP, @CTR_IMPUESTO2_CXP, @CTA_IMPUESTO2_CXP, @CTR_RUBRO1_CXP, @CTA_RUBRO1_CXP, @CTR_RUBRO2_CXP, @CTA_RUBRO2_CXP, @CTR_ANTICIPO_CXP, @CTA_ANTICIPO_CXP, @CTR_DESC_BONIF, @CTA_DESC_BONIF, @CTR_DEV_VENTAS, @CTA_DEV_VENTAS, @CTR_INT_CORRIENTE, @CTA_INT_CORRIENTE, @CODIGO_ISO, @ETIQUETA_DIV_GEO1, @ETIQUETA_DIV_GEO2, @MONEDA
		SET @ERROR = 0
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS =
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<PAIS>' +
				'<PAIS Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@PAIS) + '</PAIS>' +
				'<DIRECCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DIRECCION) + '</DIRECCION>' +
				'<NOMBRE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOMBRE) + '</NOMBRE>' +
				'<CTR_VENTAS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_VENTAS) + '</CTR_VENTAS>' +
				'<CTA_VENTAS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_VENTAS) + '</CTA_VENTAS>' +
				'<CTR_DESC_GRAL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_DESC_GRAL) + '</CTR_DESC_GRAL>' +
				'<CTA_DESC_GRAL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_DESC_GRAL) + '</CTA_DESC_GRAL>' +
				'<CTR_COST_VENT Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_COST_VENT) + '</CTR_COST_VENT>' +
				'<CTA_COST_VENT Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_COST_VENT) + '</CTA_COST_VENT>' +
				'<CTR_DESC_LIN Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_DESC_LIN) + '</CTR_DESC_LIN>' +
				'<CTA_DESC_LIN Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_DESC_LIN) + '</CTA_DESC_LIN>' +
				'<CTR_COST_LIN Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_COST_LIN) + '</CTR_COST_LIN>' +
				'<CTA_COST_LIN Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_COST_LIN) + '</CTA_COST_LIN>' +
				'<CTR_GAST_COM Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_GAST_COM) + '</CTR_GAST_COM>' +
				'<CTA_GAST_COM Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_GAST_COM) + '</CTA_GAST_COM>' +
				'<CTR_CONTADO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_CONTADO) + '</CTR_CONTADO>' +
				'<CTA_CONTADO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_CONTADO) + '</CTA_CONTADO>' +
				'<CTR_CXC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_CXC) + '</CTR_CXC>' +
				'<CTA_CXC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_CXC) + '</CTA_CXC>' +
				'<CTR_LXC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_LXC) + '</CTR_LXC>' +
				'<CTA_LXC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_LXC) + '</CTA_LXC>' +
				'<CTR_PRONTO_PAG_CXC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_PRONTO_PAG_CXC) + '</CTR_PRONTO_PAG_CXC>' +
				'<CTA_PRONTO_PAG_CXC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_PRONTO_PAG_CXC) + '</CTA_PRONTO_PAG_CXC>' +
				'<CTR_INT_MORA_CXC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_INT_MORA_CXC) + '</CTR_INT_MORA_CXC>' +
				'<CTA_INT_MORA_CXC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_INT_MORA_CXC) + '</CTA_INT_MORA_CXC>' +
				'<CTR_RECIBOS_CXC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_RECIBOS_CXC) + '</CTR_RECIBOS_CXC>' +
				'<CTA_RECIBOS_CXC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_RECIBOS_CXC) + '</CTA_RECIBOS_CXC>' +
				'<CTR_DEBITO_CXC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_DEBITO_CXC) + '</CTR_DEBITO_CXC>' +
				'<CTA_DEBITO_CXC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_DEBITO_CXC) + '</CTA_DEBITO_CXC>' +
				'<CTR_CREDITO_CXC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_CREDITO_CXC) + '</CTR_CREDITO_CXC>' +
				'<CTA_CREDITO_CXC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_CREDITO_CXC) + '</CTA_CREDITO_CXC>' +
				'<CTR_IMPUESTO1_CXC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_IMPUESTO1_CXC) + '</CTR_IMPUESTO1_CXC>' +
				'<CTA_IMPUESTO1_CXC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_IMPUESTO1_CXC) + '</CTA_IMPUESTO1_CXC>' +
				'<CTR_IMPUESTO2_CXC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_IMPUESTO2_CXC) + '</CTR_IMPUESTO2_CXC>' +
				'<CTA_IMPUESTO2_CXC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_IMPUESTO2_CXC) + '</CTA_IMPUESTO2_CXC>' +
				'<CTR_RUBRO1_CXC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_RUBRO1_CXC) + '</CTR_RUBRO1_CXC>' +
				'<CTA_RUBRO1_CXC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_RUBRO1_CXC) + '</CTA_RUBRO1_CXC>' +
				'<CTR_RUBRO2_CXC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_RUBRO2_CXC) + '</CTR_RUBRO2_CXC>' +
				'<CTA_RUBRO2_CXC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_RUBRO2_CXC) + '</CTA_RUBRO2_CXC>' +
				'<CTR_ANTICIPO_CXC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_ANTICIPO_CXC) + '</CTR_ANTICIPO_CXC>' +
				'<CTA_ANTICIPO_CXC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_ANTICIPO_CXC) + '</CTA_ANTICIPO_CXC>' +
				'<CTR_LXP Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_LXP) + '</CTR_LXP>' +
				'<CTA_LXP Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_LXP) + '</CTA_LXP>' +
				'<CTR_CREDITO_CXP Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_CREDITO_CXP) + '</CTR_CREDITO_CXP>' +
				'<CTA_CREDITO_CXP Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_CREDITO_CXP) + '</CTA_CREDITO_CXP>' +
				'<CTR_DEBITO_CXP Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_DEBITO_CXP) + '</CTR_DEBITO_CXP>' +
				'<CTA_DEBITO_CXP Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_DEBITO_CXP) + '</CTA_DEBITO_CXP>' +
				'<CTR_CXP Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_CXP) + '</CTR_CXP>' +
				'<CTA_CXP Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_CXP) + '</CTA_CXP>' +
				'<CTR_PRONTO_PAG_CXP Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_PRONTO_PAG_CXP) + '</CTR_PRONTO_PAG_CXP>' +
				'<CTA_PRONTO_PAG_CXP Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_PRONTO_PAG_CXP) + '</CTA_PRONTO_PAG_CXP>' +
				'<CTR_COMISION_CXP Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_COMISION_CXP) + '</CTR_COMISION_CXP>' +
				'<CTA_COMISION_CXP Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_COMISION_CXP) + '</CTA_COMISION_CXP>' +
				'<CTR_IMPUESTO1_CXP Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_IMPUESTO1_CXP) + '</CTR_IMPUESTO1_CXP>' +
				'<CTA_IMPUESTO1_CXP Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_IMPUESTO1_CXP) + '</CTA_IMPUESTO1_CXP>' +
				'<CTR_IMPUESTO2_CXP Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_IMPUESTO2_CXP) + '</CTR_IMPUESTO2_CXP>' +
				'<CTA_IMPUESTO2_CXP Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_IMPUESTO2_CXP) + '</CTA_IMPUESTO2_CXP>' +
				'<CTR_RUBRO1_CXP Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_RUBRO1_CXP) + '</CTR_RUBRO1_CXP>' +
				'<CTA_RUBRO1_CXP Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_RUBRO1_CXP) + '</CTA_RUBRO1_CXP>' +
				'<CTR_RUBRO2_CXP Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_RUBRO2_CXP) + '</CTR_RUBRO2_CXP>' +
				'<CTA_RUBRO2_CXP Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_RUBRO2_CXP) + '</CTA_RUBRO2_CXP>' +
				'<CTR_ANTICIPO_CXP Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_ANTICIPO_CXP) + '</CTR_ANTICIPO_CXP>' +
				'<CTA_ANTICIPO_CXP Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_ANTICIPO_CXP) + '</CTA_ANTICIPO_CXP>' +
				'<CTR_DESC_BONIF Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_DESC_BONIF) + '</CTR_DESC_BONIF>' +
				'<CTA_DESC_BONIF Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_DESC_BONIF) + '</CTA_DESC_BONIF>' +
				'<CTR_DEV_VENTAS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_DEV_VENTAS) + '</CTR_DEV_VENTAS>' +
				'<CTA_DEV_VENTAS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_DEV_VENTAS) + '</CTA_DEV_VENTAS>' +
				'<CTR_INT_CORRIENTE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_INT_CORRIENTE) + '</CTR_INT_CORRIENTE>' +
				'<CTA_INT_CORRIENTE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_INT_CORRIENTE) + '</CTA_INT_CORRIENTE>' +
				'<CODIGO_ISO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CODIGO_ISO) + '</CODIGO_ISO>' +
				'<ETIQUETA_DIV_GEO1 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ETIQUETA_DIV_GEO1) + '</ETIQUETA_DIV_GEO1>' + 
				'<ETIQUETA_DIV_GEO2 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ETIQUETA_DIV_GEO2) + '</ETIQUETA_DIV_GEO2>' + 
				'<MONEDA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@MONEDA) + '</MONEDA>' + 
				'</PAIS>'
			-- Inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'PAISPOS600', 'INSERTA', @PARAMETROS, 0, ''
			FETCH NEXT FROM C_INSERTED INTO
			@PAIS, @DIRECCION, @NOMBRE, @CTR_VENTAS, @CTA_VENTAS, @CTR_DESC_GRAL, @CTA_DESC_GRAL, @CTR_COST_VENT, @CTA_COST_VENT, @CTR_DESC_LIN, @CTA_DESC_LIN, @CTR_COST_LIN, @CTA_COST_LIN, @CTR_GAST_COM, @CTA_GAST_COM, @CTR_CONTADO, @CTA_CONTADO, @CTR_CXC, @CTA_CXC, @CTR_LXC, @CTA_LXC, @CTR_PRONTO_PAG_CXC, @CTA_PRONTO_PAG_CXC, @CTR_INT_MORA_CXC, @CTA_INT_MORA_CXC, @CTR_RECIBOS_CXC, @CTA_RECIBOS_CXC, @CTR_DEBITO_CXC, @CTA_DEBITO_CXC, @CTR_CREDITO_CXC, @CTA_CREDITO_CXC, @CTR_IMPUESTO1_CXC, @CTA_IMPUESTO1_CXC, @CTR_IMPUESTO2_CXC, @CTA_IMPUESTO2_CXC, @CTR_RUBRO1_CXC, @CTA_RUBRO1_CXC, @CTR_RUBRO2_CXC, @CTA_RUBRO2_CXC, @CTR_ANTICIPO_CXC, @CTA_ANTICIPO_CXC, @CTR_LXP, @CTA_LXP, @CTR_CREDITO_CXP, @CTA_CREDITO_CXP, @CTR_DEBITO_CXP, @CTA_DEBITO_CXP, @CTR_CXP, @CTA_CXP, @CTR_PRONTO_PAG_CXP, @CTA_PRONTO_PAG_CXP, @CTR_COMISION_CXP, @CTA_COMISION_CXP, @CTR_IMPUESTO1_CXP, @CTA_IMPUESTO1_CXP, @CTR_IMPUESTO2_CXP, @CTA_IMPUESTO2_CXP, @CTR_RUBRO1_CXP, @CTA_RUBRO1_CXP, @CTR_RUBRO2_CXP, @CTA_RUBRO2_CXP, @CTR_ANTICIPO_CXP, @CTA_ANTICIPO_CXP, @CTR_DESC_BONIF, @CTA_DESC_BONIF, @CTR_DEV_VENTAS, @CTA_DEV_VENTAS, @CTR_INT_CORRIENTE, @CTA_INT_CORRIENTE, @CODIGO_ISO, @ETIQUETA_DIV_GEO1, @ETIQUETA_DIV_GEO2, @MONEDA
		END
		CLOSE C_INSERTED
    		DEALLOCATE C_INSERTED
	END
	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla PAIS.',16,1 )
	END
END;




CREATE TRIGGER $$Compania$$.PAIS_POS_DEL
ON $$Compania$$.PAIS
FOR DELETE
AS
BEGIN   	
                DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @PAIS VARCHAR(4)
	 -- Declaraciones	
	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_DELETED CURSOR LOCAL FOR
			SELECT PAIS
			FROM DELETED d
			WHERE 0 = (
				SELECT COUNT('n')
				FROM INSERTED i
				WHERE d.PAIS = i.PAIS
			   )
		OPEN C_DELETED
		FETCH NEXT FROM C_DELETED INTO
		@PAIS
		
		SET @ERROR = 0
		
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS =
								'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<PAIS>' +
				'<PAIS Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@PAIS) + '</PAIS>' +
				'</PAIS>'
 -- XML
			
			-- inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'PAISPOS600', 'ELIMINA', @PARAMETROS, 0, ''
			
			FETCH NEXT FROM C_DELETED INTO
			@PAIS
		END
		CLOSE C_DELETED
		DEALLOCATE C_DELETED
	END
	
	IF (@@ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para eliminar de la tabla PAIS.',16,1 )
	END
END
;




CREATE TRIGGER $$Compania$$.PAIS_POS_MOD
ON $$Compania$$.PAIS
FOR UPDATE
AS
BEGIN   	
	DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @COL_ROWPOINTER VARCHAR(36)
	DECLARE @HAY_CAMPOS_PARA_POS BIT
	DECLARE @ACTUALIZAR_SOLICITUD BIT
	DECLARE @PAIS VARCHAR(4)
	DECLARE @NOMBRE VARCHAR(40)
	DECLARE @DIRECCION VARCHAR(10)
	DECLARE @CODIGO_ISO VARCHAR(4)
	DECLARE @ETIQUETA_DIV_GEO1 VARCHAR(20)
	DECLARE @ETIQUETA_DIV_GEO2 VARCHAR(20)
	DECLARE @MONEDA VARCHAR(4)

	 -- Declaraciones
	SET @ERROR = 0
	SELECT @PUBLICADOR = SITIO_LOCAL, @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS
	
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (SYSTEM_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_MODIFIED CURSOR LOCAL FOR
			SELECT PAIS, NOMBRE, DIRECCION, CODIGO_ISO, ETIQUETA_DIV_GEO1, ETIQUETA_DIV_GEO2, MONEDA -- Columnas
			FROM INSERTED I
		SET @ACTUALIZAR_SOLICITUD = 1
		OPEN C_MODIFIED
		FETCH NEXT FROM C_MODIFIED
		INTO @PAIS, @NOMBRE, @DIRECCION, @CODIGO_ISO, @ETIQUETA_DIV_GEO1, @ETIQUETA_DIV_GEO2, @MONEDA
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			IF ( NOT UPDATE(RECORDDATE) AND ( UPDATE(PAIS) OR UPDATE(NOMBRE) OR UPDATE(DIRECCION) OR UPDATE(CODIGO_ISO) OR UPDATE(ETIQUETA_DIV_GEO1) OR UPDATE(ETIQUETA_DIV_GEO2) OR UPDATE(MONEDA) ) )
			BEGIN
				SELECT @COL_ROWPOINTER = ROWPOINTER
				FROM $$Compania$$.PAIS
				WHERE PAIS = @PAIS
				SET @PARAMETROS =
					'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<PAIS>' +
				'<PAIS Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@PAIS) + '</PAIS>' +
				'<NOMBRE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOMBRE) + '</NOMBRE>' +
				'<DIRECCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DIRECCION) + '</DIRECCION>' + 
				'<CODIGO_ISO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CODIGO_ISO) + '</CODIGO_ISO>' + 
				'<ETIQUETA_DIV_GEO1 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ETIQUETA_DIV_GEO1) + '</ETIQUETA_DIV_GEO1>' + 
				'<ETIQUETA_DIV_GEO2 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ETIQUETA_DIV_GEO2) + '</ETIQUETA_DIV_GEO2>' + 
				'<MONEDA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@MONEDA) + '</MONEDA>' + 
				'</PAIS>'
				-- inserta la solicitud correspondiente
				EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'PAISPOS600', 'MODIFICA', @PARAMETROS, @ACTUALIZAR_SOLICITUD, @COL_ROWPOINTER
			END
			FETCH NEXT FROM C_MODIFIED
			INTO @PAIS, @NOMBRE, @DIRECCION, @CODIGO_ISO, @ETIQUETA_DIV_GEO1, @ETIQUETA_DIV_GEO2, @MONEDA
		END
		CLOSE C_MODIFIED
		DEALLOCATE C_MODIFIED
	END
	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para modificar la tabla PAIS.',16,1 )
	END
END;



CREATE TRIGGER $$Compania$$.PAQUETE_POS_INS
ON $$Compania$$.PAQUETE
FOR INSERT
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @PAQUETE VARCHAR(4)
	DECLARE @DESCRIPCION VARCHAR(40)
	DECLARE @USUARIO_CREADOR VARCHAR(25)
	DECLARE @ULTIMO_USUARIO VARCHAR(25)
	DECLARE @FECHA_ULT_ACCESO DATETIME
	DECLARE @ULTIMO_ASIENTO VARCHAR(10)
	DECLARE @DOBLE_ASIENTO VARCHAR(1)
	DECLARE @MARCADO VARCHAR(1)
	

	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM 
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_INSERTED CURSOR LOCAL FOR
		SELECT PAQUETE, DESCRIPCION, USUARIO_CREADOR, ULTIMO_USUARIO, FECHA_ULT_ACCESO, ULTIMO_ASIENTO, DOBLE_ASIENTO, MARCADO
		FROM INSERTED i
		WHERE 0 = (
				SELECT COUNT('n')
				FROM DELETED d
				WHERE i.PAQUETE = d.PAQUETE
			   )
			
		OPEN C_INSERTED	
		FETCH NEXT FROM C_INSERTED INTO
		@PAQUETE, @DESCRIPCION, @USUARIO_CREADOR, @ULTIMO_USUARIO, @FECHA_ULT_ACCESO, @ULTIMO_ASIENTO, @DOBLE_ASIENTO, @MARCADO

		SET @ERROR = 0
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS = 
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<PAQUETE>' + 
				'<PAQUETE Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@PAQUETE) + '</PAQUETE>' + 
				'<DESCRIPCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DESCRIPCION) + '</DESCRIPCION>' + 
				'<USUARIO_CREADOR Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USUARIO_CREADOR) + '</USUARIO_CREADOR>' + 
				'<ULTIMO_USUARIO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ULTIMO_USUARIO) + '</ULTIMO_USUARIO>' + 
				'<FECHA_ULT_ACCESO Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_ULT_ACCESO) + '</FECHA_ULT_ACCESO>' + 
				'<ULTIMO_ASIENTO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ULTIMO_ASIENTO) + '</ULTIMO_ASIENTO>' + 
				'<DOBLE_ASIENTO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DOBLE_ASIENTO) + '</DOBLE_ASIENTO>' + 
				'<MARCADO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@MARCADO) + '</MARCADO>' + 
				'</PAQUETE>'


			-- Inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'PAQUETEPOS600', 'INSERTA', @PARAMETROS, 0, ''

			FETCH NEXT FROM C_INSERTED INTO
			@PAQUETE, @DESCRIPCION, @USUARIO_CREADOR, @ULTIMO_USUARIO, @FECHA_ULT_ACCESO, @ULTIMO_ASIENTO, @DOBLE_ASIENTO, @MARCADO
		END

		CLOSE C_INSERTED
    		DEALLOCATE C_INSERTED
	END

	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla PAQUETE.',16,1 )
	END
END;


CREATE TRIGGER $$Compania$$.PAQUETE_POS_MOD
ON $$Compania$$.PAQUETE
FOR UPDATE
AS 
BEGIN   	
	DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @COL_ROWPOINTER VARCHAR(36)
	DECLARE @HAY_CAMPOS_PARA_POS BIT
	DECLARE @ACTUALIZAR_SOLICITUD BIT
	DECLARE @PAQUETE VARCHAR(4)
	DECLARE @DESCRIPCION VARCHAR(40)
	DECLARE @USUARIO_CREADOR VARCHAR(25)
	DECLARE @ULTIMO_USUARIO VARCHAR(25)
	DECLARE @FECHA_ULT_ACCESO DATETIME
	DECLARE @ULTIMO_ASIENTO VARCHAR(10)
	DECLARE @DOBLE_ASIENTO VARCHAR(1)
	DECLARE @MARCADO VARCHAR(1)
	 -- Declaraciones

	SET @ERROR = 0

	SELECT @PUBLICADOR = SITIO_LOCAL, @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_MODIFIED CURSOR LOCAL FOR
			SELECT PAQUETE, DESCRIPCION, USUARIO_CREADOR, ULTIMO_USUARIO, FECHA_ULT_ACCESO, ULTIMO_ASIENTO, DOBLE_ASIENTO, MARCADO -- Columnas
			FROM INSERTED I

		SET @ACTUALIZAR_SOLICITUD = 1

		OPEN C_MODIFIED

		FETCH NEXT FROM C_MODIFIED
		INTO @PAQUETE, @DESCRIPCION, @USUARIO_CREADOR, @ULTIMO_USUARIO, @FECHA_ULT_ACCESO, @ULTIMO_ASIENTO, @DOBLE_ASIENTO, @MARCADO

		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			IF ( NOT UPDATE(RECORDDATE) AND ( UPDATE(PAQUETE) OR UPDATE(DESCRIPCION) OR UPDATE(USUARIO_CREADOR) OR UPDATE(ULTIMO_USUARIO) OR UPDATE(FECHA_ULT_ACCESO) OR UPDATE(ULTIMO_ASIENTO) OR UPDATE(DOBLE_ASIENTO) OR UPDATE(MARCADO) ) )
			BEGIN

				SELECT @COL_ROWPOINTER = ROWPOINTER 
				FROM $$Compania$$.PAQUETE
				WHERE PAQUETE = @PAQUETE 

				SET @PARAMETROS =
					'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<PAQUETE>' + 
				'<PAQUETE Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@PAQUETE) + '</PAQUETE>' + 
				'<DESCRIPCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DESCRIPCION) + '</DESCRIPCION>' + 
				'<USUARIO_CREADOR Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USUARIO_CREADOR) + '</USUARIO_CREADOR>' + 
				'<ULTIMO_USUARIO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ULTIMO_USUARIO) + '</ULTIMO_USUARIO>' + 
				'<FECHA_ULT_ACCESO Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_ULT_ACCESO) + '</FECHA_ULT_ACCESO>' + 
				'<ULTIMO_ASIENTO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ULTIMO_ASIENTO) + '</ULTIMO_ASIENTO>' + 
				'<DOBLE_ASIENTO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DOBLE_ASIENTO) + '</DOBLE_ASIENTO>' + 
				'<MARCADO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@MARCADO) + '</MARCADO>' + 
				'</PAQUETE>'


				-- inserta la solicitud correspondiente
				EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'PAQUETEPOS600', 'MODIFICA', @PARAMETROS, @ACTUALIZAR_SOLICITUD, @COL_ROWPOINTER
			END

			FETCH NEXT FROM C_MODIFIED
			INTO @PAQUETE, @DESCRIPCION, @USUARIO_CREADOR, @ULTIMO_USUARIO, @FECHA_ULT_ACCESO, @ULTIMO_ASIENTO, @DOBLE_ASIENTO, @MARCADO
		END

		CLOSE C_MODIFIED
		DEALLOCATE C_MODIFIED
	END

	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para modificar la tabla PAQUETE.',16,1 )
	END
END;


CREATE TRIGGER $$COMPANIA$$.PAQUETE_POS_DEL
ON $$COMPANIA$$.PAQUETE
FOR DELETE  
AS 
BEGIN   	
    DECLARE @ERROR  int
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @PAQUETE VARCHAR(4)
	-- Declaraciones	

	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM 
	FROM $$COMPANIA$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_DELETED CURSOR LOCAL FOR
			SELECT PAQUETE
			FROM DELETED d
			WHERE 0 = (
				SELECT COUNT('n')
				FROM INSERTED i
				WHERE d.PAQUETE = i.PAQUETE
			   )

		OPEN C_DELETED
		FETCH NEXT FROM C_DELETED INTO 
		@PAQUETE	-- VARIABLES
		
		SET @ERROR = 0
		
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS = 
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<PAQUETE>' + 
				'<PAQUETE Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@PAQUETE) + '</PAQUETE>' + 
				'</PAQUETE>'
			
			-- inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'PAQUETEPOS600', 'ELIMINA', @PARAMETROS, 0, ''
			
			FETCH NEXT FROM C_DELETED INTO 
			@PAQUETE	-- VARIABLES
		END

		CLOSE C_DELETED
		DEALLOCATE C_DELETED
	END
	
	IF (@@ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para eliminar de la tabla PAQUETE.',16,1 )
	END
END;




CREATE TRIGGER $$Compania$$.PAQUETE_DESCUENTO_POS_INS
ON $$Compania$$.PAQUETE_DESCUENTO
FOR INSERT
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @PAQUETE_DESCUENTO VARCHAR(12)
	DECLARE @DESCRIPCION VARCHAR(254)
	DECLARE @ACTIVO VARCHAR(1)
	DECLARE @TODA_TIENDA VARCHAR(1)
	DECLARE @FECHA_RIGE DATETIME
	DECLARE @FECHA_VENCE DATETIME
	DECLARE @FECHA_HORA_INICIO DATETIME
	DECLARE @FECHA_HORA_FIN DATETIME
	
	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_INSERTED CURSOR LOCAL FOR
		SELECT PAQUETE_DESCUENTO, DESCRIPCION, ACTIVO, TODA_TIENDA, FECHA_RIGE, FECHA_VENCE, FECHA_HORA_INICIO, FECHA_HORA_FIN
		FROM INSERTED i
		WHERE 0 = (
				SELECT COUNT('n')
				FROM DELETED d
				WHERE i.PAQUETE_DESCUENTO = d.PAQUETE_DESCUENTO
			   )
			
		OPEN C_INSERTED	
		FETCH NEXT FROM C_INSERTED INTO
		@PAQUETE_DESCUENTO, @DESCRIPCION, @ACTIVO, @TODA_TIENDA, @FECHA_RIGE, @FECHA_VENCE, @FECHA_HORA_INICIO, @FECHA_HORA_FIN
		SET @ERROR = 0
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS =
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<PAQUETE_DESCUENTO>' +
				'<PAQUETE_DESCUENTO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@PAQUETE_DESCUENTO) + '</PAQUETE_DESCUENTO>' +
				'<DESCRIPCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DESCRIPCION) + '</DESCRIPCION>' +
				'<ACTIVO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ACTIVO) + '</ACTIVO>' +
				'<TODA_TIENDA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TODA_TIENDA) + '</TODA_TIENDA>' +
				'<FECHA_RIGE Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_RIGE) + '</FECHA_RIGE>' +
				'<FECHA_VENCE Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_VENCE) + '</FECHA_VENCE>' +
				'<FECHA_HORA_INICIO Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_HORA_INICIO) + '</FECHA_HORA_INICIO>' +
				'<FECHA_HORA_FIN Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_HORA_FIN) + '</FECHA_HORA_FIN>' +
				'</PAQUETE_DESCUENTO>'
			-- Inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'PAQUETEDESCUENTOPOS600', 'INSERTA', @PARAMETROS, 0, ''
			FETCH NEXT FROM C_INSERTED INTO
			@PAQUETE_DESCUENTO, @DESCRIPCION, @ACTIVO, @TODA_TIENDA, @FECHA_RIGE, @FECHA_VENCE, @FECHA_HORA_INICIO, @FECHA_HORA_FIN
		END
		CLOSE C_INSERTED
    		DEALLOCATE C_INSERTED
	END
	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla PAQUETE_DESCUENTO.',16,1 )
	END
END
;




CREATE TRIGGER $$Compania$$.PAQUETE_DESCUENTO_POS_DEL
ON $$Compania$$.PAQUETE_DESCUENTO
FOR DELETE
AS
BEGIN   	
                DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @PAQUETE_DESCUENTO VARCHAR(12)
	 -- Declaraciones	
	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_DELETED CURSOR LOCAL FOR
			SELECT PAQUETE_DESCUENTO
			FROM DELETED d
			WHERE 0 = (
				SELECT COUNT('n')
				FROM INSERTED i
				WHERE d.PAQUETE_DESCUENTO = i.PAQUETE_DESCUENTO
			   )
		OPEN C_DELETED
		FETCH NEXT FROM C_DELETED INTO
		@PAQUETE_DESCUENTO
		
		SET @ERROR = 0
		
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS =
								'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<PAQUETE_DESCUENTO>' +
				'<PAQUETE_DESCUENTO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@PAQUETE_DESCUENTO) + '</PAQUETE_DESCUENTO>' +
				'</PAQUETE_DESCUENTO>'
 -- XML
			
			-- inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'PAQUETEDESCUENTOPOS600', 'ELIMINA', @PARAMETROS, 0, ''
			
			FETCH NEXT FROM C_DELETED INTO
			@PAQUETE_DESCUENTO
		END
		CLOSE C_DELETED
		DEALLOCATE C_DELETED
	END
	
	IF (@@ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para eliminar de la tabla PAQUETE_DESCUENTO.',16,1 )
	END
END
;
CREATE TRIGGER $$Compania$$.PAQUETE_DESCUENTO_POS_MOD
ON $$Compania$$.PAQUETE_DESCUENTO
FOR UPDATE
AS
BEGIN   	
	DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @COL_ROWPOINTER VARCHAR(36)
	DECLARE @HAY_CAMPOS_PARA_POS BIT
	DECLARE @ACTUALIZAR_SOLICITUD BIT
	DECLARE @PAQUETE_DESCUENTO VARCHAR(12)
	DECLARE @DESCRIPCION VARCHAR(254)
	DECLARE @ACTIVO VARCHAR(1)
	DECLARE @TODA_TIENDA VARCHAR(1)
	DECLARE @FECHA_RIGE DATETIME
	DECLARE @FECHA_VENCE DATETIME
	DECLARE @FECHA_HORA_INICIO DATETIME
	DECLARE @FECHA_HORA_FIN DATETIME
	 -- Declaraciones
	SET @ERROR = 0
	SELECT @PUBLICADOR = SITIO_LOCAL, @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_MODIFIED CURSOR LOCAL FOR
			SELECT PAQUETE_DESCUENTO, DESCRIPCION, ACTIVO, TODA_TIENDA, FECHA_RIGE, FECHA_VENCE, FECHA_HORA_INICIO, FECHA_HORA_FIN -- Columnas
			FROM INSERTED I
		SET @ACTUALIZAR_SOLICITUD = 1
		OPEN C_MODIFIED
		FETCH NEXT FROM C_MODIFIED
		INTO @PAQUETE_DESCUENTO, @DESCRIPCION, @ACTIVO, @TODA_TIENDA, @FECHA_RIGE, @FECHA_VENCE, @FECHA_HORA_INICIO, @FECHA_HORA_FIN
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			IF ( NOT UPDATE(RECORDDATE) AND ( UPDATE(PAQUETE_DESCUENTO) OR UPDATE(DESCRIPCION) OR UPDATE(ACTIVO) OR UPDATE(TODA_TIENDA) OR UPDATE(FECHA_RIGE) OR UPDATE(FECHA_VENCE) OR UPDATE(FECHA_HORA_INICIO) OR UPDATE(FECHA_HORA_FIN)) )
			BEGIN
				SELECT @COL_ROWPOINTER = ROWPOINTER
				FROM $$Compania$$.PAQUETE_DESCUENTO
				WHERE PAQUETE_DESCUENTO = @PAQUETE_DESCUENTO
				SET @PARAMETROS =
					'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<PAQUETE_DESCUENTO>' +
				'<PAQUETE_DESCUENTO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@PAQUETE_DESCUENTO) + '</PAQUETE_DESCUENTO>' +
				'<DESCRIPCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DESCRIPCION) + '</DESCRIPCION>' +
				'<ACTIVO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ACTIVO) + '</ACTIVO>' +
				'<TODA_TIENDA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TODA_TIENDA) + '</TODA_TIENDA>' +
				'<FECHA_RIGE Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_RIGE) + '</FECHA_RIGE>' +
				'<FECHA_VENCE Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_VENCE) + '</FECHA_VENCE>' +
				'<FECHA_HORA_INICIO Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_HORA_INICIO) + '</FECHA_HORA_INICIO>' +
				'<FECHA_HORA_FIN Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_HORA_FIN) + '</FECHA_HORA_FIN>' +
				'</PAQUETE_DESCUENTO>'
				-- inserta la solicitud correspondiente
				EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'PAQUETEDESCUENTOPOS600', 'MODIFICA', @PARAMETROS, @ACTUALIZAR_SOLICITUD, @COL_ROWPOINTER
			END
			FETCH NEXT FROM C_MODIFIED
			INTO @PAQUETE_DESCUENTO, @DESCRIPCION, @ACTIVO, @TODA_TIENDA, @FECHA_RIGE, @FECHA_VENCE, @FECHA_HORA_INICIO, @FECHA_HORA_FIN
		END
		CLOSE C_MODIFIED
		DEALLOCATE C_MODIFIED
	END
	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para modificar la tabla PAQUETE_DESCUENTO.',16,1 )
	END
END
;




CREATE TRIGGER $$Compania$$.PAQUETE_INVENTARIO_POS_INS
ON $$Compania$$.PAQUETE_INVENTARIO
FOR INSERT
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @PAQUETE_INVENTARIO VARCHAR(4)
	DECLARE @DESCRIPCION VARCHAR(40)
	DECLARE @ULTIMO_USUARIO VARCHAR(25)
	DECLARE @USUARIO_CREADOR VARCHAR(25)
	DECLARE @FECHA_ULT_ACCESO DATETIME
	
	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_INSERTED CURSOR LOCAL FOR
		SELECT PAQUETE_INVENTARIO, DESCRIPCION, ULTIMO_USUARIO, USUARIO_CREADOR, FECHA_ULT_ACCESO
		FROM INSERTED i
		WHERE 0 = (
				SELECT COUNT('n')
				FROM DELETED d
				WHERE i.PAQUETE_INVENTARIO = d.PAQUETE_INVENTARIO
			   )
			
		OPEN C_INSERTED	
		FETCH NEXT FROM C_INSERTED INTO
		@PAQUETE_INVENTARIO, @DESCRIPCION, @ULTIMO_USUARIO, @USUARIO_CREADOR, @FECHA_ULT_ACCESO
		SET @ERROR = 0
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS =
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<PAQUETE_INVENTARIO>' +
				'<PAQUETE_INVENTARIO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@PAQUETE_INVENTARIO) + '</PAQUETE_INVENTARIO>' +
				'<DESCRIPCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DESCRIPCION) + '</DESCRIPCION>' +
				'<ULTIMO_USUARIO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ULTIMO_USUARIO) + '</ULTIMO_USUARIO>' +
				'<USUARIO_CREADOR Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USUARIO_CREADOR) + '</USUARIO_CREADOR>' +
				'<FECHA_ULT_ACCESO Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_ULT_ACCESO) + '</FECHA_ULT_ACCESO>' +
				'</PAQUETE_INVENTARIO>'
			-- Inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'PAQUETEINVENTARIOPOS600', 'INSERTA', @PARAMETROS, 0, ''
			FETCH NEXT FROM C_INSERTED INTO
			@PAQUETE_INVENTARIO, @DESCRIPCION, @ULTIMO_USUARIO, @USUARIO_CREADOR, @FECHA_ULT_ACCESO
		END
		CLOSE C_INSERTED
    		DEALLOCATE C_INSERTED
	END
	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla PAQUETE_INVENTARIO.',16,1 )
	END
END
;




CREATE TRIGGER $$Compania$$.PAQUETE_INVENTARIO_POS_DEL
ON $$Compania$$.PAQUETE_INVENTARIO
FOR DELETE
AS
BEGIN   	
                DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @PAQUETE_INVENTARIO VARCHAR(4)
	 -- Declaraciones	
	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_DELETED CURSOR LOCAL FOR
			SELECT PAQUETE_INVENTARIO
			FROM DELETED d
			WHERE 0 = (
				SELECT COUNT('n')
				FROM INSERTED i
				WHERE d.PAQUETE_INVENTARIO = i.PAQUETE_INVENTARIO
			   )
		OPEN C_DELETED
		FETCH NEXT FROM C_DELETED INTO
		@PAQUETE_INVENTARIO
		
		SET @ERROR = 0
		
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS =
								'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<PAQUETE_INVENTARIO>' +
				'<PAQUETE_INVENTARIO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@PAQUETE_INVENTARIO) + '</PAQUETE_INVENTARIO>' +
				'</PAQUETE_INVENTARIO>'
 -- XML
			
			-- inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'PAQUETEINVENTARIOPOS600', 'ELIMINA', @PARAMETROS, 0, ''
			
			FETCH NEXT FROM C_DELETED INTO
			@PAQUETE_INVENTARIO
		END
		CLOSE C_DELETED
		DEALLOCATE C_DELETED
	END
	
	IF (@@ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para eliminar de la tabla PAQUETE_INVENTARIO.',16,1 )
	END
END
;




CREATE TRIGGER $$Compania$$.PAQUETE_INVENTARIO_POS_MOD
ON $$Compania$$.PAQUETE_INVENTARIO
FOR UPDATE
AS
BEGIN   	
	DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @COL_ROWPOINTER VARCHAR(36)
	DECLARE @HAY_CAMPOS_PARA_POS BIT
	DECLARE @ACTUALIZAR_SOLICITUD BIT
	DECLARE @PAQUETE_INVENTARIO VARCHAR(4)
	DECLARE @DESCRIPCION VARCHAR(40)
	DECLARE @ULTIMO_USUARIO VARCHAR(25)
	DECLARE @USUARIO_CREADOR VARCHAR(25)
	DECLARE @FECHA_ULT_ACCESO DATETIME
	 -- Declaraciones
	SET @ERROR = 0
	SELECT @PUBLICADOR = SITIO_LOCAL, @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_MODIFIED CURSOR LOCAL FOR
			SELECT PAQUETE_INVENTARIO, DESCRIPCION, ULTIMO_USUARIO, USUARIO_CREADOR, FECHA_ULT_ACCESO -- Columnas
			FROM INSERTED I
		SET @ACTUALIZAR_SOLICITUD = 1
		OPEN C_MODIFIED
		FETCH NEXT FROM C_MODIFIED
		INTO @PAQUETE_INVENTARIO, @DESCRIPCION, @ULTIMO_USUARIO, @USUARIO_CREADOR, @FECHA_ULT_ACCESO
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			IF ( NOT UPDATE(RECORDDATE) AND ( UPDATE(PAQUETE_INVENTARIO) OR UPDATE(DESCRIPCION) OR UPDATE(ULTIMO_USUARIO) OR UPDATE(USUARIO_CREADOR) OR UPDATE(FECHA_ULT_ACCESO) ) )
			BEGIN
				SELECT @COL_ROWPOINTER = ROWPOINTER
				FROM $$Compania$$.PAQUETE_INVENTARIO
				WHERE PAQUETE_INVENTARIO = @PAQUETE_INVENTARIO
				SET @PARAMETROS =
					'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<PAQUETE_INVENTARIO>' +
				'<PAQUETE_INVENTARIO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@PAQUETE_INVENTARIO) + '</PAQUETE_INVENTARIO>' +
				'<DESCRIPCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DESCRIPCION) + '</DESCRIPCION>' +
				'<ULTIMO_USUARIO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ULTIMO_USUARIO) + '</ULTIMO_USUARIO>' +
				'<USUARIO_CREADOR Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USUARIO_CREADOR) + '</USUARIO_CREADOR>' +
				'<FECHA_ULT_ACCESO Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_ULT_ACCESO) + '</FECHA_ULT_ACCESO>' +
				'</PAQUETE_INVENTARIO>'
				-- inserta la solicitud correspondiente
				EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'PAQUETEINVENTARIOPOS600', 'MODIFICA', @PARAMETROS, @ACTUALIZAR_SOLICITUD, @COL_ROWPOINTER
			END
			FETCH NEXT FROM C_MODIFIED
			INTO @PAQUETE_INVENTARIO, @DESCRIPCION, @ULTIMO_USUARIO, @USUARIO_CREADOR, @FECHA_ULT_ACCESO
		END
		CLOSE C_MODIFIED
		DEALLOCATE C_MODIFIED
	END
	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para modificar la tabla PAQUETE_INVENTARIO.',16,1 )
	END
END
;



CREATE TRIGGER $$Compania$$.PAQ_DESC_GRUPO_POS_INS
ON $$Compania$$.PAQ_DESC_GRUPO
FOR INSERT
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @PAQUETE_DESCUENTO VARCHAR(12)
	DECLARE @GRUPO VARCHAR(6)
	
	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_INSERTED CURSOR LOCAL FOR
		SELECT PAQUETE_DESCUENTO, GRUPO
		FROM INSERTED i
		WHERE 0 = (
				SELECT COUNT('n')
				FROM DELETED d
				WHERE i.PAQUETE_DESCUENTO = d.PAQUETE_DESCUENTO AND i.GRUPO = d.GRUPO
			   )
			
		OPEN C_INSERTED	
		FETCH NEXT FROM C_INSERTED INTO
		@PAQUETE_DESCUENTO, @GRUPO
		SET @ERROR = 0
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS =
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<PAQ_DESC_GRUPO>' +
				'<PAQUETE_DESCUENTO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@PAQUETE_DESCUENTO) + '</PAQUETE_DESCUENTO>' +
				'<GRUPO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@GRUPO) + '</GRUPO>' +
				'</PAQ_DESC_GRUPO>'
			-- Inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'PAQDESCGRUPOPOS600', 'INSERTA', @PARAMETROS, 0, ''
			FETCH NEXT FROM C_INSERTED INTO
			@PAQUETE_DESCUENTO, @GRUPO
		END
		CLOSE C_INSERTED
    		DEALLOCATE C_INSERTED
	END
	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla PAQ_DESC_GRUPO.',16,1 )
	END
END
;




CREATE TRIGGER $$Compania$$.PAQ_DESC_GRUPO_POS_DEL
ON $$Compania$$.PAQ_DESC_GRUPO
FOR DELETE
AS
BEGIN   	
    DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @PAQUETE_DESCUENTO VARCHAR(12)
	DECLARE @GRUPO VARCHAR(6)
	DECLARE @TIPO_SITIO_LOCAL VARCHAR(1)
	 -- Declaraciones	
	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM,
		   @TIPO_SITIO_LOCAL = TIPO_SITIO_LOCAL
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF ( NOT (CURRENT_USER = @USUARIO_POS_WSQM) ) AND @TIPO_SITIO_LOCAL = 'C'
	BEGIN
		DECLARE C_DELETED CURSOR LOCAL FOR
			SELECT PAQUETE_DESCUENTO, GRUPO
			FROM DELETED d
			WHERE 0 = (
				SELECT COUNT('n')
				FROM INSERTED i
				WHERE d.PAQUETE_DESCUENTO = i.PAQUETE_DESCUENTO AND d.GRUPO = i.GRUPO
			   )
		OPEN C_DELETED
		FETCH NEXT FROM C_DELETED INTO
		@PAQUETE_DESCUENTO, @GRUPO -- VARIABLES
		
		SET @ERROR = 0
		
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS =
								'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<PAQ_DESC_GRUPO>' +
				'<PAQUETE_DESCUENTO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@PAQUETE_DESCUENTO) + '</PAQUETE_DESCUENTO>' +
				'<GRUPO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@GRUPO) + '</GRUPO>' +
				'</PAQ_DESC_GRUPO>'
 -- XML
			
			-- inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'PAQDESCGRUPOPOS600', 'ELIMINA', @PARAMETROS, 0, ''
			
			FETCH NEXT FROM C_DELETED INTO
			@PAQUETE_DESCUENTO, @GRUPO -- VARIABLES
		END
		CLOSE C_DELETED
		DEALLOCATE C_DELETED
	END
	
	IF (@@ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para eliminar de la tabla PAQ_DESC_GRUPO.',16,1 )
	END
END
;




CREATE TRIGGER $$Compania$$.PAQ_DESC_GRUPO_POS_MOD
ON $$Compania$$.PAQ_DESC_GRUPO
FOR UPDATE
AS
BEGIN   	
	DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @COL_ROWPOINTER VARCHAR(36)
	DECLARE @HAY_CAMPOS_PARA_POS BIT
	DECLARE @ACTUALIZAR_SOLICITUD BIT
	DECLARE @PAQUETE_DESCUENTO VARCHAR(12)
	DECLARE @GRUPO VARCHAR(6)
	 -- Declaraciones
	SET @ERROR = 0
	SELECT @PUBLICADOR = SITIO_LOCAL, @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_MODIFIED CURSOR LOCAL FOR
			SELECT PAQUETE_DESCUENTO, GRUPO -- Columnas
			FROM INSERTED I
		SET @ACTUALIZAR_SOLICITUD = 1
		OPEN C_MODIFIED
		FETCH NEXT FROM C_MODIFIED
		INTO @PAQUETE_DESCUENTO, @GRUPO
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			IF ( NOT UPDATE(RECORDDATE) AND ( UPDATE(PAQUETE_DESCUENTO) OR UPDATE(GRUPO) ) )
			BEGIN
				SELECT @COL_ROWPOINTER = ROWPOINTER
				FROM $$Compania$$.PAQ_DESC_GRUPO
				WHERE PAQUETE_DESCUENTO = @PAQUETE_DESCUENTO AND GRUPO = @GRUPO
				SET @PARAMETROS =
					'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<PAQ_DESC_GRUPO>' +
				'<PAQUETE_DESCUENTO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@PAQUETE_DESCUENTO) + '</PAQUETE_DESCUENTO>' +
				'<GRUPO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@GRUPO) + '</GRUPO>' +
				'</PAQ_DESC_GRUPO>'
				-- inserta la solicitud correspondiente
				EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'PAQDESCGRUPOPOS600', 'MODIFICA', @PARAMETROS, @ACTUALIZAR_SOLICITUD, @COL_ROWPOINTER
			END
			FETCH NEXT FROM C_MODIFIED
			INTO @PAQUETE_DESCUENTO, @GRUPO
		END
		CLOSE C_MODIFIED
		DEALLOCATE C_MODIFIED
	END
	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para modificar la tabla PAQ_DESC_GRUPO.',16,1 )
	END
END
;





CREATE TRIGGER $$Compania$$.PAQ_DESC_REG_DESC_POS_INS
ON $$Compania$$.PAQ_DESC_REG_DESC
FOR INSERT
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @PAQUETE_DESCUENTO VARCHAR(12)
	DECLARE @REGLA_DESCUENTO INT
	
	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_INSERTED CURSOR LOCAL FOR
		SELECT PAQUETE_DESCUENTO, REGLA_DESCUENTO
		FROM INSERTED i
		WHERE 0 = (
				SELECT COUNT('n')
				FROM DELETED d
				WHERE i.PAQUETE_DESCUENTO = d.PAQUETE_DESCUENTO AND i.REGLA_DESCUENTO = d.REGLA_DESCUENTO
			   )
			
		OPEN C_INSERTED	
		FETCH NEXT FROM C_INSERTED INTO
		@PAQUETE_DESCUENTO, @REGLA_DESCUENTO
		SET @ERROR = 0
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS =
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<PAQ_DESC_REG_DESC>' +
				'<PAQUETE_DESCUENTO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@PAQUETE_DESCUENTO) + '</PAQUETE_DESCUENTO>' +
				'<REGLA_DESCUENTO Type="INT" PrimaryKey="True">' + ERPADMIN.POS_NumberToVarchar(@REGLA_DESCUENTO) + '</REGLA_DESCUENTO>' +
				'</PAQ_DESC_REG_DESC>'
			-- Inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'PAQDESREGDESCPOS600', 'INSERTA', @PARAMETROS, 0, ''
			FETCH NEXT FROM C_INSERTED INTO
			@PAQUETE_DESCUENTO, @REGLA_DESCUENTO
		END
		CLOSE C_INSERTED
    		DEALLOCATE C_INSERTED
	END
	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla PAQ_DESC_REG_DESC.',16,1 )
	END
END
;



CREATE TRIGGER $$Compania$$.PAQ_DESC_REG_DESC_POS_DEL
ON $$Compania$$.PAQ_DESC_REG_DESC
FOR DELETE
AS
BEGIN   	
                DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @PAQUETE_DESCUENTO VARCHAR(12)
	DECLARE @REGLA_DESCUENTO INT
	 -- Declaraciones	
	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_DELETED CURSOR LOCAL FOR
			SELECT PAQUETE_DESCUENTO, REGLA_DESCUENTO
			FROM DELETED d
			WHERE 0 = (
				SELECT COUNT('n')
				FROM INSERTED i
				WHERE d.PAQUETE_DESCUENTO = i.PAQUETE_DESCUENTO AND d.REGLA_DESCUENTO = i.REGLA_DESCUENTO
			   )
		OPEN C_DELETED
		FETCH NEXT FROM C_DELETED INTO
		@PAQUETE_DESCUENTO, @REGLA_DESCUENTO -- VARIABLES
		
		SET @ERROR = 0
		
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS =
								'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<PAQ_DESC_REG_DESC>' +
				'<PAQUETE_DESCUENTO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@PAQUETE_DESCUENTO) + '</PAQUETE_DESCUENTO>' +
				'<REGLA_DESCUENTO Type="INT" PrimaryKey="True">' + ERPADMIN.POS_NumberToVarchar(@REGLA_DESCUENTO) + '</REGLA_DESCUENTO>' +
				'</PAQ_DESC_REG_DESC>'
 -- XML
			
			-- inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'PAQDESREGDESCPOS600', 'ELIMINA', @PARAMETROS, 0, ''
			
			FETCH NEXT FROM C_DELETED INTO
			@PAQUETE_DESCUENTO, @REGLA_DESCUENTO -- VARIABLES
		END
		CLOSE C_DELETED
		DEALLOCATE C_DELETED
	END
	
	IF (@@ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para eliminar de la tabla PAQ_DESC_REG_DESC.',16,1 )
	END
END
;



CREATE TRIGGER $$Compania$$.PAQ_DESC_REG_DESC_POS_MOD
ON $$Compania$$.PAQ_DESC_REG_DESC
FOR UPDATE
AS
BEGIN   	
	DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @COL_ROWPOINTER VARCHAR(36)
	DECLARE @HAY_CAMPOS_PARA_POS BIT
	DECLARE @ACTUALIZAR_SOLICITUD BIT
	DECLARE @PAQUETE_DESCUENTO VARCHAR(12)
	DECLARE @REGLA_DESCUENTO INT
	 -- Declaraciones
	SET @ERROR = 0
	SELECT @PUBLICADOR = SITIO_LOCAL, @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_MODIFIED CURSOR LOCAL FOR
			SELECT PAQUETE_DESCUENTO, REGLA_DESCUENTO -- Columnas
			FROM INSERTED I
		SET @ACTUALIZAR_SOLICITUD = 1
		OPEN C_MODIFIED
		FETCH NEXT FROM C_MODIFIED
		INTO @PAQUETE_DESCUENTO, @REGLA_DESCUENTO
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			IF ( NOT UPDATE(RECORDDATE) AND ( UPDATE(PAQUETE_DESCUENTO) OR UPDATE(REGLA_DESCUENTO) ) )
			BEGIN
				SELECT @COL_ROWPOINTER = ROWPOINTER
				FROM $$Compania$$.PAQ_DESC_REG_DESC
				WHERE PAQUETE_DESCUENTO = @PAQUETE_DESCUENTO AND REGLA_DESCUENTO = @REGLA_DESCUENTO
				SET @PARAMETROS =
					'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<PAQ_DESC_REG_DESC>' +
				'<PAQUETE_DESCUENTO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@PAQUETE_DESCUENTO) + '</PAQUETE_DESCUENTO>' +
				'<REGLA_DESCUENTO Type="INT" PrimaryKey="True">' + ERPADMIN.POS_NumberToVarchar(@REGLA_DESCUENTO) + '</REGLA_DESCUENTO>' +
				'</PAQ_DESC_REG_DESC>'
				-- inserta la solicitud correspondiente
				EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'PAQDESREGDESCPOS600', 'MODIFICA', @PARAMETROS, @ACTUALIZAR_SOLICITUD, @COL_ROWPOINTER
			END
			FETCH NEXT FROM C_MODIFIED
			INTO @PAQUETE_DESCUENTO, @REGLA_DESCUENTO
		END
		CLOSE C_MODIFIED
		DEALLOCATE C_MODIFIED
	END
	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para modificar la tabla PAQ_DESC_REG_DESC.',16,1 )
	END
END
;





CREATE TRIGGER $$Compania$$.PERIODO_CONTABLE_POS_INS
ON $$Compania$$.PERIODO_CONTABLE
FOR INSERT
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @FECHA_FINAL DATETIME
	DECLARE @DESCRIPCION VARCHAR(40)
	DECLARE @CONTABILIDAD VARCHAR(1)
	DECLARE @FIN_PERIODO_ANUAL VARCHAR(1)
	DECLARE @ESTADO VARCHAR(1)
	
	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_INSERTED CURSOR LOCAL FOR
		SELECT FECHA_FINAL, DESCRIPCION, CONTABILIDAD, FIN_PERIODO_ANUAL, ESTADO
		FROM INSERTED i
		WHERE 0 = (
				SELECT COUNT('n')
				FROM DELETED d
				WHERE i.FECHA_FINAL = d.FECHA_FINAL AND i.CONTABILIDAD = d.CONTABILIDAD
			   )
			
		OPEN C_INSERTED	
		FETCH NEXT FROM C_INSERTED INTO
		@FECHA_FINAL, @DESCRIPCION, @CONTABILIDAD, @FIN_PERIODO_ANUAL, @ESTADO
		SET @ERROR = 0
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS =
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<PERIODO_CONTABLE>' +
				'<FECHA_FINAL Type="DATETIME" PrimaryKey="True">' + ERPADMIN.POS_FormatoFecha(@FECHA_FINAL) + '</FECHA_FINAL>' +
				'<DESCRIPCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DESCRIPCION) + '</DESCRIPCION>' +
				'<CONTABILIDAD Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CONTABILIDAD) + '</CONTABILIDAD>' +
				'<FIN_PERIODO_ANUAL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@FIN_PERIODO_ANUAL) + '</FIN_PERIODO_ANUAL>' +
				'<ESTADO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ESTADO) + '</ESTADO>' +
				'</PERIODO_CONTABLE>'
			-- Inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'PERIODOCONTABLEPOS600', 'INSERTA', @PARAMETROS, 0, ''
			FETCH NEXT FROM C_INSERTED INTO
			@FECHA_FINAL, @DESCRIPCION, @CONTABILIDAD, @FIN_PERIODO_ANUAL, @ESTADO
		END
		CLOSE C_INSERTED
    		DEALLOCATE C_INSERTED
	END
	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla PERIODO_CONTABLE.',16,1 )
	END
END
;





CREATE TRIGGER $$Compania$$.PERIODO_CONTABLE_POS_DEL
ON $$Compania$$.PERIODO_CONTABLE
FOR DELETE
AS
BEGIN   	
                DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @FECHA_FINAL DATETIME
	DECLARE @CONTABILIDAD VARCHAR(1)
	 -- Declaraciones	
	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_DELETED CURSOR LOCAL FOR
			SELECT FECHA_FINAL, CONTABILIDAD
			FROM DELETED d
			WHERE 0 = (
				SELECT COUNT('n')
				FROM INSERTED i
				WHERE d.FECHA_FINAL = i.FECHA_FINAL AND d.CONTABILIDAD = i.CONTABILIDAD
			   )
		OPEN C_DELETED
		FETCH NEXT FROM C_DELETED INTO
		@FECHA_FINAL, @CONTABILIDAD
		
		SET @ERROR = 0
		
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS =
								'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<PERIODO_CONTABLE>' +
				'<FECHA_FINAL Type="DATETIME" PrimaryKey="True">' + ERPADMIN.POS_FormatoFecha(@FECHA_FINAL) + '</FECHA_FINAL>' +
				'<CONTABILIDAD Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CONTABILIDAD) + '</CONTABILIDAD>' +
				'</PERIODO_CONTABLE>'
 -- XML
			
			-- inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'PERIODOCONTABLEPOS600', 'ELIMINA', @PARAMETROS, 0, ''
			
			FETCH NEXT FROM C_DELETED INTO
			@FECHA_FINAL, @CONTABILIDAD
		END
		CLOSE C_DELETED
		DEALLOCATE C_DELETED
	END
	
	IF (@@ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para eliminar de la tabla PERIODO_CONTABLE.',16,1 )
	END
END
;





CREATE TRIGGER $$Compania$$.PERIODO_CONTABLE_POS_MOD
ON $$Compania$$.PERIODO_CONTABLE
FOR UPDATE
AS
BEGIN   	
	DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @COL_ROWPOINTER VARCHAR(36)
	DECLARE @HAY_CAMPOS_PARA_POS BIT
	DECLARE @ACTUALIZAR_SOLICITUD BIT
	DECLARE @FECHA_FINAL DATETIME
	DECLARE @DESCRIPCION VARCHAR(40)
	DECLARE @CONTABILIDAD VARCHAR(1)
	DECLARE @FIN_PERIODO_ANUAL VARCHAR(1)
	DECLARE @ESTADO VARCHAR(1)
	 -- Declaraciones
	SET @ERROR = 0
	SELECT @PUBLICADOR = SITIO_LOCAL, @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_MODIFIED CURSOR LOCAL FOR
			SELECT FECHA_FINAL, DESCRIPCION, CONTABILIDAD, FIN_PERIODO_ANUAL, ESTADO -- Columnas
			FROM INSERTED I
		SET @ACTUALIZAR_SOLICITUD = 1
		OPEN C_MODIFIED
		FETCH NEXT FROM C_MODIFIED
		INTO @FECHA_FINAL, @DESCRIPCION, @CONTABILIDAD, @FIN_PERIODO_ANUAL, @ESTADO
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			IF ( NOT UPDATE(RECORDDATE) AND ( UPDATE(FECHA_FINAL) OR UPDATE(DESCRIPCION) OR UPDATE(CONTABILIDAD) OR UPDATE(FIN_PERIODO_ANUAL) OR UPDATE(ESTADO) ) )
			BEGIN
				SELECT @COL_ROWPOINTER = ROWPOINTER
				FROM $$Compania$$.PERIODO_CONTABLE
				WHERE FECHA_FINAL = @FECHA_FINAL AND CONTABILIDAD = @CONTABILIDAD
				SET @PARAMETROS =
					'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<PERIODO_CONTABLE>' +
				'<FECHA_FINAL Type="DATETIME" PrimaryKey="True">' + ERPADMIN.POS_FormatoFecha(@FECHA_FINAL) + '</FECHA_FINAL>' +
				'<DESCRIPCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DESCRIPCION) + '</DESCRIPCION>' +
				'<CONTABILIDAD Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CONTABILIDAD) + '</CONTABILIDAD>' +
				'<FIN_PERIODO_ANUAL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@FIN_PERIODO_ANUAL) + '</FIN_PERIODO_ANUAL>' +
				'<ESTADO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ESTADO) + '</ESTADO>' +
				'</PERIODO_CONTABLE>'
				-- inserta la solicitud correspondiente
				EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'PERIODOCONTABLEPOS600', 'MODIFICA', @PARAMETROS, @ACTUALIZAR_SOLICITUD, @COL_ROWPOINTER
			END
			FETCH NEXT FROM C_MODIFIED
			INTO @FECHA_FINAL, @DESCRIPCION, @CONTABILIDAD, @FIN_PERIODO_ANUAL, @ESTADO
		END
		CLOSE C_MODIFIED
		DEALLOCATE C_MODIFIED
	END
	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para modificar la tabla PERIODO_CONTABLE.',16,1 )
	END
END
;


CREATE TRIGGER $$Compania$$.REGIMENES_POS_INS
ON $$Compania$$.REGIMENES
FOR INSERT
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @MODULO_OFFLINE INT
	DECLARE @REGIMEN VARCHAR(12)
	DECLARE @DESCRIPCION VARCHAR(40)
	DECLARE @MODELO_RETENCION VARCHAR(4)
	DECLARE @IMP1_ASUMIDO_COMPRAS VARCHAR(1)
	DECLARE @CENTRO_COSTO VARCHAR(25)
	DECLARE @CUENTA_CONTABLE VARCHAR(25)
	DECLARE @CONSECUTIVO VARCHAR(10)
	
	
	SELECT @MODULO_OFFLINE = COUNT(0)
	FROM ERPADMIN.MODULO_INSTALADO
	WHERE CONJUNTO = '$$Compania$$'
	AND ACCION = 3159

	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM 
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF @MODULO_OFFLINE  = 1 AND NOT (SYSTEM_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_INSERTED CURSOR LOCAL FOR
		SELECT REGIMEN, DESCRIPCION, MODELO_RETENCION, IMP1_ASUMIDO_COMPRAS, CENTRO_COSTO, CUENTA_CONTABLE, CONSECUTIVO
		FROM INSERTED
				
		OPEN C_INSERTED	
		FETCH NEXT FROM C_INSERTED INTO
		@REGIMEN, @DESCRIPCION, @MODELO_RETENCION, @IMP1_ASUMIDO_COMPRAS, @CENTRO_COSTO, @CUENTA_CONTABLE, @CONSECUTIVO

		SET @ERROR = 0
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS = 
			'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<REGIMENES>' + 
				'<REGIMEN Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@REGIMEN) + '</REGIMEN>' + 
				'<DESCRIPCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DESCRIPCION) + '</DESCRIPCION>' + 
				'<MODELO_RETENCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@MODELO_RETENCION) + '</MODELO_RETENCION>' + 
				'<IMP1_ASUMIDO_COMPRAS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@IMP1_ASUMIDO_COMPRAS) + '</IMP1_ASUMIDO_COMPRAS>' + 
				'<CENTRO_COSTO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CENTRO_COSTO) + '</CENTRO_COSTO>' + 
				'<CUENTA_CONTABLE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CUENTA_CONTABLE) + '</CUENTA_CONTABLE>' + 
				'<CONSECUTIVO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CONSECUTIVO) + '</CONSECUTIVO>' + 
				'</REGIMENES>'

			-- Inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'REGIMENESPOS600', 'INSERTA', @PARAMETROS, 0, ''

			FETCH NEXT FROM C_INSERTED INTO
			@REGIMEN, @DESCRIPCION, @MODELO_RETENCION, @IMP1_ASUMIDO_COMPRAS, @CENTRO_COSTO, @CUENTA_CONTABLE, @CONSECUTIVO
		END

		CLOSE C_INSERTED
    		DEALLOCATE C_INSERTED
	END

	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla REGIMENES.',16,1 )
	END
END;




CREATE TRIGGER $$Compania$$.REGIMENES_POS_DEL
ON $$Compania$$.REGIMENES
FOR DELETE  
AS 
BEGIN   	
        DECLARE @ERROR  int
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @MODULO_OFFLINE INT
	DECLARE @REGIMEN VARCHAR(12)
	 -- Declaraciones	
	
	SELECT @MODULO_OFFLINE = COUNT(0)
	FROM ERPADMIN.MODULO_INSTALADO
	WHERE CONJUNTO = '$$Compania$$'
	AND ACCION = 3159

	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM 
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF @MODULO_OFFLINE  = 1 AND NOT (SYSTEM_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_DELETED CURSOR LOCAL FOR
			SELECT REGIMEN
			FROM DELETED

		OPEN C_DELETED
		FETCH NEXT FROM C_DELETED INTO 
		@REGIMEN -- VARIABLES
		
		SET @ERROR = 0
		
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS = 
							'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<REGIMENES>' + 
				'<REGIMEN Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@REGIMEN) + '</REGIMEN>' + 
				'</REGIMENES>'
 			
			-- inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'REGIMENESPOS600', 'ELIMINA', @PARAMETROS, 0, ''
			
			FETCH NEXT FROM C_DELETED INTO 
			@REGIMEN -- VARIABLES
		END

		CLOSE C_DELETED
		DEALLOCATE C_DELETED
	END
	
	IF (@@ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para eliminar de la tabla REGIMENES.',16,1 )
	END
END;





CREATE TRIGGER $$Compania$$.REGIMENES_POS_MOD
ON $$Compania$$.REGIMENES
FOR UPDATE
AS 
BEGIN   	
	DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @COL_ROWPOINTER VARCHAR(36)
	DECLARE @HAY_CAMPOS_PARA_POS BIT
	DECLARE @ACTUALIZAR_SOLICITUD BIT
	DECLARE @MODULO_OFFLINE INT
	DECLARE @REGIMEN VARCHAR(12)
	DECLARE @DESCRIPCION VARCHAR(40)
	DECLARE @MODELO_RETENCION VARCHAR(4)
	DECLARE @IMP1_ASUMIDO_COMPRAS VARCHAR(1)
	DECLARE @CENTRO_COSTO VARCHAR(25)
	DECLARE @CUENTA_CONTABLE VARCHAR(25)
	DECLARE @CONSECUTIVO VARCHAR(10)
	 -- Declaraciones

	SET @ERROR = 0
	
	SELECT @MODULO_OFFLINE = COUNT(0)
	FROM ERPADMIN.MODULO_INSTALADO
	WHERE CONJUNTO = '$$Compania$$'
	AND ACCION = 3159

	SELECT @PUBLICADOR = SITIO_LOCAL, @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF @MODULO_OFFLINE  = 1 AND NOT (SYSTEM_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_MODIFIED CURSOR LOCAL FOR
			SELECT REGIMEN, DESCRIPCION, MODELO_RETENCION, IMP1_ASUMIDO_COMPRAS, CENTRO_COSTO, CUENTA_CONTABLE, CONSECUTIVO -- Columnas
			FROM INSERTED I

		SET @ACTUALIZAR_SOLICITUD = 1

		OPEN C_MODIFIED

		FETCH NEXT FROM C_MODIFIED
		INTO @REGIMEN, @DESCRIPCION, @MODELO_RETENCION, @IMP1_ASUMIDO_COMPRAS, @CENTRO_COSTO, @CUENTA_CONTABLE, @CONSECUTIVO

		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			IF ( NOT UPDATE(RECORDDATE) AND ( UPDATE(REGIMEN) OR UPDATE(DESCRIPCION) OR UPDATE(MODELO_RETENCION) OR UPDATE(IMP1_ASUMIDO_COMPRAS) OR UPDATE(CENTRO_COSTO) OR UPDATE(CUENTA_CONTABLE) OR UPDATE(CONSECUTIVO) ) )
			BEGIN

				SELECT @COL_ROWPOINTER = ROWPOINTER 
				FROM $$Compania$$.REGIMENES
				WHERE REGIMEN = @REGIMEN 

				SET @PARAMETROS =
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<REGIMENES>' + 
				'<REGIMEN Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@REGIMEN) + '</REGIMEN>' + 
				'<DESCRIPCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DESCRIPCION) + '</DESCRIPCION>' + 
				'<MODELO_RETENCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@MODELO_RETENCION) + '</MODELO_RETENCION>' + 
				'<IMP1_ASUMIDO_COMPRAS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@IMP1_ASUMIDO_COMPRAS) + '</IMP1_ASUMIDO_COMPRAS>' + 
				'<CENTRO_COSTO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CENTRO_COSTO) + '</CENTRO_COSTO>' + 
				'<CUENTA_CONTABLE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CUENTA_CONTABLE) + '</CUENTA_CONTABLE>' + 
				'<CONSECUTIVO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CONSECUTIVO) + '</CONSECUTIVO>' + 
				'</REGIMENES>'

				-- inserta la solicitud correspondiente
				EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'REGIMENESPOS600', 'MODIFICA', @PARAMETROS, @ACTUALIZAR_SOLICITUD, @COL_ROWPOINTER
			END

			FETCH NEXT FROM C_MODIFIED
			INTO @REGIMEN, @DESCRIPCION, @MODELO_RETENCION, @IMP1_ASUMIDO_COMPRAS, @CENTRO_COSTO, @CUENTA_CONTABLE, @CONSECUTIVO
		END

		CLOSE C_MODIFIED
		DEALLOCATE C_MODIFIED
	END

	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para modificar la tabla REGIMENES.',16,1 )
	END
END;





CREATE TRIGGER $$Compania$$.REGLA_DESCUENTO_POS_INS
ON $$Compania$$.REGLA_DESCUENTO
FOR INSERT
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @REGLA_DESCUENTO INT
	DECLARE @DESCRIPCION VARCHAR(254)
	DECLARE @ACTIVO VARCHAR(1)
	DECLARE @DESCUENTO DECIMAL(28,8)
	DECLARE @PRIORIDAD INT
	DECLARE @TIPO_DESCUENTO VARCHAR(1)
	DECLARE @CATEGORIA_CLIENTE VARCHAR(8)
	DECLARE @CLIENTE VARCHAR(20)
	DECLARE @CLASIFICACION VARCHAR(12)
	DECLARE @CLASIFICACION2 VARCHAR(12)
	DECLARE @CLASIFICACION3 VARCHAR(12)
	DECLARE @CLASIFICACION4 VARCHAR(12)
	DECLARE @CLASIFICACION5 VARCHAR(12)
	DECLARE @CLASIFICACION6 VARCHAR(12)
	DECLARE @ARTICULO VARCHAR(20)
	DECLARE @ARTICULO_PATRON VARCHAR(20)
	DECLARE @CANTIDAD_COMPRA DECIMAL(28,8)
	DECLARE @CANTIDAD_FACTURAR DECIMAL(28,8)
	DECLARE	@REQUIERE_AUTORIZACION	VARCHAR(1) 
	DECLARE @FORMA_PAGO		VARCHAR(4) 
	DECLARE @DETALLE_FORMA_PAGO	VARCHAR(20)
	DECLARE @MINIMO_DOCUMENTO	DECIMAL(28,8)
	DECLARE @MINIMO_PAGO		DECIMAL(28,8)
	DECLARE @DESC_FORMA_PAGO	DECIMAL(28,8)
	
	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_INSERTED CURSOR LOCAL FOR
		SELECT REGLA_DESCUENTO, DESCRIPCION, ACTIVO, DESCUENTO, PRIORIDAD, TIPO_DESCUENTO, CATEGORIA_CLIENTE, CLIENTE, CLASIFICACION, CLASIFICACION2, CLASIFICACION3, CLASIFICACION4, CLASIFICACION5, CLASIFICACION6, ARTICULO, ARTICULO_PATRON, CANTIDAD_COMPRA, CANTIDAD_FACTURAR, REQUIERE_AUTORIZACION, FORMA_PAGO, DETALLE_FORMA_PAGO, MINIMO_DOCUMENTO, MINIMO_PAGO, DESC_FORMA_PAGO
		FROM INSERTED i
		WHERE 0 = (
				SELECT COUNT('n')
				FROM DELETED d
				WHERE i.REGLA_DESCUENTO = d.REGLA_DESCUENTO
			   )
			
		OPEN C_INSERTED	
		FETCH NEXT FROM C_INSERTED INTO
		@REGLA_DESCUENTO, @DESCRIPCION, @ACTIVO, @DESCUENTO, @PRIORIDAD, @TIPO_DESCUENTO, @CATEGORIA_CLIENTE, @CLIENTE, @CLASIFICACION, @CLASIFICACION2, @CLASIFICACION3, @CLASIFICACION4, @CLASIFICACION5, @CLASIFICACION6, @ARTICULO, @ARTICULO_PATRON, @CANTIDAD_COMPRA, @CANTIDAD_FACTURAR, @REQUIERE_AUTORIZACION, @FORMA_PAGO, @DETALLE_FORMA_PAGO, @MINIMO_DOCUMENTO, @MINIMO_PAGO, @DESC_FORMA_PAGO
		SET @ERROR = 0
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS =
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<REGLA_DESCUENTO>' +
				'<REGLA_DESCUENTO Type="INT" PrimaryKey="True">' + ERPADMIN.POS_NumberToVarchar(@REGLA_DESCUENTO) + '</REGLA_DESCUENTO>' +
				'<DESCRIPCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DESCRIPCION) + '</DESCRIPCION>' +
				'<ACTIVO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ACTIVO) + '</ACTIVO>' +
				'<DESCUENTO Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@DESCUENTO) + '</DESCUENTO>' +
				'<PRIORIDAD Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@PRIORIDAD) + '</PRIORIDAD>' +
				'<TIPO_DESCUENTO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_DESCUENTO) + '</TIPO_DESCUENTO>' +
				'<CATEGORIA_CLIENTE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CATEGORIA_CLIENTE) + '</CATEGORIA_CLIENTE>' +
				'<CLIENTE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CLIENTE) + '</CLIENTE>' +
				'<CLASIFICACION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CLASIFICACION) + '</CLASIFICACION>' +
				'<CLASIFICACION2 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CLASIFICACION2) + '</CLASIFICACION2>' +
				'<CLASIFICACION3 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CLASIFICACION3) + '</CLASIFICACION3>' +
				'<CLASIFICACION4 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CLASIFICACION4) + '</CLASIFICACION4>' +
				'<CLASIFICACION5 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CLASIFICACION5) + '</CLASIFICACION5>' +
				'<CLASIFICACION6 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CLASIFICACION6) + '</CLASIFICACION6>' +
				'<ARTICULO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ARTICULO) + '</ARTICULO>' +
				'<ARTICULO_PATRON Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ARTICULO_PATRON) + '</ARTICULO_PATRON>' +
				'<CANTIDAD_COMPRA Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@CANTIDAD_COMPRA) + '</CANTIDAD_COMPRA>' +
				'<CANTIDAD_FACTURAR Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@CANTIDAD_FACTURAR) + '</CANTIDAD_FACTURAR>' +
				'<REQUIERE_AUTORIZACION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@REQUIERE_AUTORIZACION) + '</REQUIERE_AUTORIZACION>' +
				'<FORMA_PAGO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@FORMA_PAGO) + '</FORMA_PAGO>' +
				'<DETALLE_FORMA_PAGO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DETALLE_FORMA_PAGO) + '</DETALLE_FORMA_PAGO>' +
				'<MINIMO_DOCUMENTO Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@MINIMO_DOCUMENTO) + '</MINIMO_DOCUMENTO>' +
				'<MINIMO_PAGO Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@MINIMO_PAGO) + '</MINIMO_PAGO>' +
				'<DESC_FORMA_PAGO Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@DESC_FORMA_PAGO) + '</DESC_FORMA_PAGO>' +
				'</REGLA_DESCUENTO>'
			-- Inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'REGLADESCUENTOPOS600', 'INSERTA', @PARAMETROS, 0, ''
			FETCH NEXT FROM C_INSERTED INTO
			@REGLA_DESCUENTO, @DESCRIPCION, @ACTIVO, @DESCUENTO, @PRIORIDAD, @TIPO_DESCUENTO, @CATEGORIA_CLIENTE, @CLIENTE, @CLASIFICACION, @CLASIFICACION2, @CLASIFICACION3, @CLASIFICACION4, @CLASIFICACION5, @CLASIFICACION6, @ARTICULO, @ARTICULO_PATRON, @CANTIDAD_COMPRA, @CANTIDAD_FACTURAR, @REQUIERE_AUTORIZACION, @FORMA_PAGO, @DETALLE_FORMA_PAGO, @MINIMO_DOCUMENTO, @MINIMO_PAGO, @DESC_FORMA_PAGO
		END
		CLOSE C_INSERTED
    		DEALLOCATE C_INSERTED
	END
	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla REGLA_DESCUENTO.',16,1 )
	END
END;






CREATE TRIGGER $$Compania$$.REGLA_DESCUENTO_POS_DEL
ON $$Compania$$.REGLA_DESCUENTO
FOR DELETE
AS
BEGIN   	
                DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @REGLA_DESCUENTO INT
	 -- Declaraciones	
	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_DELETED CURSOR LOCAL FOR
			SELECT REGLA_DESCUENTO
			FROM DELETED d
			WHERE 0 = (
				SELECT COUNT('n')
				FROM INSERTED i
				WHERE d.REGLA_DESCUENTO = i.REGLA_DESCUENTO
			   )
		OPEN C_DELETED
		FETCH NEXT FROM C_DELETED INTO
		@REGLA_DESCUENTO
		
		SET @ERROR = 0
		
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS =
								'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<REGLA_DESCUENTO>' +
				'<REGLA_DESCUENTO Type="INT" PrimaryKey="True">' + ERPADMIN.POS_NumberToVarchar(@REGLA_DESCUENTO) + '</REGLA_DESCUENTO>' +
				'</REGLA_DESCUENTO>'
 -- XML
			
			-- inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'REGLADESCUENTOPOS600', 'ELIMINA', @PARAMETROS, 0, ''
			
			FETCH NEXT FROM C_DELETED INTO
			@REGLA_DESCUENTO
		END
		CLOSE C_DELETED
		DEALLOCATE C_DELETED
	END
	
	IF (@@ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para eliminar de la tabla REGLA_DESCUENTO.',16,1 )
	END
END
;





CREATE TRIGGER $$Compania$$.REGLA_DESCUENTO_POS_MOD
ON $$Compania$$.REGLA_DESCUENTO
FOR UPDATE
AS
BEGIN   	
	DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @COL_ROWPOINTER VARCHAR(36)
	DECLARE @HAY_CAMPOS_PARA_POS BIT
	DECLARE @ACTUALIZAR_SOLICITUD BIT
	DECLARE @REGLA_DESCUENTO INT
	DECLARE @DESCRIPCION VARCHAR(254)
	DECLARE @ACTIVO VARCHAR(1)
	DECLARE @DESCUENTO DECIMAL(28,8)
	DECLARE @PRIORIDAD INT
	DECLARE @TIPO_DESCUENTO VARCHAR(1)
	DECLARE @CATEGORIA_CLIENTE VARCHAR(8)
	DECLARE @CLIENTE VARCHAR(20)
	DECLARE @CLASIFICACION VARCHAR(12)
	DECLARE @CLASIFICACION2 VARCHAR(12)
	DECLARE @CLASIFICACION3 VARCHAR(12)
	DECLARE @CLASIFICACION4 VARCHAR(12)
	DECLARE @CLASIFICACION5 VARCHAR(12)
	DECLARE @CLASIFICACION6 VARCHAR(12)
	DECLARE @ARTICULO VARCHAR(20)
	DECLARE @ARTICULO_PATRON VARCHAR(20)
	DECLARE @CANTIDAD_COMPRA DECIMAL(28,8)
	DECLARE @CANTIDAD_FACTURAR DECIMAL(28,8)
	DECLARE	@REQUIERE_AUTORIZACION	VARCHAR(1) 
	DECLARE @FORMA_PAGO		VARCHAR(4) 
	DECLARE @DETALLE_FORMA_PAGO	VARCHAR(20)
	DECLARE @MINIMO_DOCUMENTO	DECIMAL(28,8)
	DECLARE @MINIMO_PAGO		DECIMAL(28,8)
	DECLARE @DESC_FORMA_PAGO	DECIMAL(28,8)
	
	 -- Declaraciones
	SET @ERROR = 0
	SELECT @PUBLICADOR = SITIO_LOCAL, @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_MODIFIED CURSOR LOCAL FOR
			SELECT REGLA_DESCUENTO, DESCRIPCION, ACTIVO, DESCUENTO, PRIORIDAD, TIPO_DESCUENTO, CATEGORIA_CLIENTE, CLIENTE, CLASIFICACION, CLASIFICACION2, CLASIFICACION3, CLASIFICACION4, CLASIFICACION5, CLASIFICACION6, ARTICULO, ARTICULO_PATRON, CANTIDAD_COMPRA, CANTIDAD_FACTURAR, REQUIERE_AUTORIZACION, FORMA_PAGO, DETALLE_FORMA_PAGO, MINIMO_DOCUMENTO,MINIMO_PAGO, DESC_FORMA_PAGO -- Columnas
			FROM INSERTED I
		SET @ACTUALIZAR_SOLICITUD = 1
		OPEN C_MODIFIED
		FETCH NEXT FROM C_MODIFIED
		INTO @REGLA_DESCUENTO, @DESCRIPCION, @ACTIVO, @DESCUENTO, @PRIORIDAD, @TIPO_DESCUENTO, @CATEGORIA_CLIENTE, @CLIENTE, @CLASIFICACION,  @CLASIFICACION2, @CLASIFICACION3, @CLASIFICACION4, @CLASIFICACION5, @CLASIFICACION6, @ARTICULO, @ARTICULO_PATRON, @CANTIDAD_COMPRA, @CANTIDAD_FACTURAR, @REQUIERE_AUTORIZACION, @FORMA_PAGO, @DETALLE_FORMA_PAGO, @MINIMO_DOCUMENTO, @MINIMO_PAGO, @DESC_FORMA_PAGO
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			IF ( NOT UPDATE(RECORDDATE) AND ( UPDATE(REGLA_DESCUENTO) OR UPDATE(DESCRIPCION) OR UPDATE(ACTIVO) OR UPDATE(DESCUENTO) OR UPDATE(PRIORIDAD) OR UPDATE(TIPO_DESCUENTO) OR UPDATE(CATEGORIA_CLIENTE) OR UPDATE(CLIENTE) OR UPDATE(CLASIFICACION) OR UPDATE(CLASIFICACION2) OR UPDATE(CLASIFICACION3) OR UPDATE(CLASIFICACION4) OR UPDATE(CLASIFICACION5) OR UPDATE(CLASIFICACION6) OR UPDATE(ARTICULO) OR UPDATE(ARTICULO_PATRON) OR UPDATE(CANTIDAD_COMPRA) OR UPDATE(CANTIDAD_FACTURAR) OR UPDATE(REQUIERE_AUTORIZACION) OR UPDATE(FORMA_PAGO) OR UPDATE(DETALLE_FORMA_PAGO) OR UPDATE (MINIMO_DOCUMENTO) OR UPDATE (MINIMO_PAGO) OR UPDATE(DESC_FORMA_PAGO)) )
			BEGIN
				SELECT @COL_ROWPOINTER = ROWPOINTER
				FROM $$Compania$$.REGLA_DESCUENTO
				WHERE REGLA_DESCUENTO = @REGLA_DESCUENTO
				SET @PARAMETROS =
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<REGLA_DESCUENTO>' +
				'<REGLA_DESCUENTO Type="INT" PrimaryKey="True">' + ERPADMIN.POS_NumberToVarchar(@REGLA_DESCUENTO) + '</REGLA_DESCUENTO>' +
				'<DESCRIPCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DESCRIPCION) + '</DESCRIPCION>' +
				'<ACTIVO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ACTIVO) + '</ACTIVO>' +
				'<DESCUENTO Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@DESCUENTO) + '</DESCUENTO>' +
				'<PRIORIDAD Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@PRIORIDAD) + '</PRIORIDAD>' +
				'<TIPO_DESCUENTO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_DESCUENTO) + '</TIPO_DESCUENTO>' +
				'<CATEGORIA_CLIENTE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CATEGORIA_CLIENTE) + '</CATEGORIA_CLIENTE>' +
				'<CLIENTE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CLIENTE) + '</CLIENTE>' +
				'<CLASIFICACION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CLASIFICACION) + '</CLASIFICACION>' +
				'<CLASIFICACION2 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CLASIFICACION2) + '</CLASIFICACION2>' +
				'<CLASIFICACION3 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CLASIFICACION3) + '</CLASIFICACION3>' +
				'<CLASIFICACION4 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CLASIFICACION4) + '</CLASIFICACION4>' +
				'<CLASIFICACION5 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CLASIFICACION5) + '</CLASIFICACION5>' +
				'<CLASIFICACION6 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CLASIFICACION6) + '</CLASIFICACION6>' +
				'<ARTICULO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ARTICULO) + '</ARTICULO>' +
				'<ARTICULO_PATRON Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ARTICULO_PATRON) + '</ARTICULO_PATRON>' +
				'<CANTIDAD_COMPRA Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@CANTIDAD_COMPRA) + '</CANTIDAD_COMPRA>' +
				'<CANTIDAD_FACTURAR Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@CANTIDAD_FACTURAR) + '</CANTIDAD_FACTURAR>' +
				'<REQUIERE_AUTORIZACION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@REQUIERE_AUTORIZACION) + '</REQUIERE_AUTORIZACION>' +
				'<FORMA_PAGO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@FORMA_PAGO) + '</FORMA_PAGO>' +
				'<DETALLE_FORMA_PAGO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DETALLE_FORMA_PAGO) + '</DETALLE_FORMA_PAGO>' +
				'<MINIMO_DOCUMENTO Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@MINIMO_DOCUMENTO) + '</MINIMO_DOCUMENTO>' +
				'<MINIMO_PAGO Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@MINIMO_PAGO) + '</MINIMO_PAGO>' +
				'<DESC_FORMA_PAGO Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@DESC_FORMA_PAGO) + '</DESC_FORMA_PAGO>' +
				'</REGLA_DESCUENTO>'
				-- inserta la solicitud correspondiente
				EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'REGLADESCUENTOPOS600', 'MODIFICA', @PARAMETROS, @ACTUALIZAR_SOLICITUD, @COL_ROWPOINTER
			END
			FETCH NEXT FROM C_MODIFIED
			INTO @REGLA_DESCUENTO, @DESCRIPCION, @ACTIVO, @DESCUENTO, @PRIORIDAD, @TIPO_DESCUENTO, @CATEGORIA_CLIENTE, @CLIENTE, @CLASIFICACION,  @CLASIFICACION2, @CLASIFICACION3, @CLASIFICACION4, @CLASIFICACION5, @CLASIFICACION6, @ARTICULO, @ARTICULO_PATRON, @CANTIDAD_COMPRA, @CANTIDAD_FACTURAR, @REQUIERE_AUTORIZACION, @FORMA_PAGO, @DETALLE_FORMA_PAGO, @MINIMO_DOCUMENTO, @MINIMO_PAGO, @DESC_FORMA_PAGO
		END
		CLOSE C_MODIFIED
		DEALLOCATE C_MODIFIED
	END
	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para modificar la tabla REGLA_DESCUENTO.',16,1 )
	END
END;



CREATE TRIGGER $$Compania$$.RETENCIONES_POS_INS
ON $$Compania$$.RETENCIONES
FOR INSERT
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @MODULO_OFFLINE INT
	DECLARE @CODIGO_RETENCION VARCHAR(4)
	DECLARE @DESCRIPCION VARCHAR(40)
	DECLARE @PORCENTAJE DECIMAL(28,8)
	DECLARE @TIPO VARCHAR(1)
	DECLARE @APLICA_MONTO VARCHAR(1)
	DECLARE @APLICA_SUBTOTAL VARCHAR(1)
	DECLARE @APLICA_SUB_DESC VARCHAR(1)
	DECLARE @APLICA_IMPUESTO1 VARCHAR(1)
	DECLARE @APLICA_IMPUESTO2 VARCHAR(1)
	DECLARE @APLICA_RUBRO1 VARCHAR(1)
	DECLARE @APLICA_RUBRO2 VARCHAR(1)
	DECLARE @ESTADO VARCHAR(1)
	DECLARE @MONTO_MINIMO DECIMAL(28,8)
	DECLARE @CTR_RETENCION VARCHAR(25)
	DECLARE @CTA_RETENCION VARCHAR(25)
	DECLARE @RET_POR_ARTICULO VARCHAR(1)
	DECLARE @ES_AUTORETENEDOR VARCHAR(1)
	DECLARE @CLASIFICACION_ART VARCHAR(12)
	DECLARE @CTR_AUTORETENCION VARCHAR(25)
	DECLARE @CTA_AUTORETENCION VARCHAR(25)
	DECLARE @TIPO_EXCEPCION VARCHAR(1)
	DECLARE @NOAPLICA_PROV_AUTO VARCHAR(1)
	DECLARE @APLICA_RETENCION VARCHAR(1)
	DECLARE @RETENCION_BASE VARCHAR(4)
	DECLARE @APLICA_IMP1_DESC VARCHAR(1)
	DECLARE @APLICA_IMP1_NODESC VARCHAR(1)
	DECLARE @TIPO_DOC_CC_CREDITO VARCHAR(4000)
	DECLARE @TIPO_DOC_CC_DEBITO VARCHAR(4000)
	DECLARE @TIPO_DOC_CP_CREDITO VARCHAR(4000)
	DECLARE @TIPO_DOC_CP_DEBITO VARCHAR(4000)
	DECLARE @UTILIZA_TARIFA_UVT VARCHAR(1)
	
	
	SELECT @MODULO_OFFLINE = COUNT(0)
	FROM ERPADMIN.MODULO_INSTALADO
	WHERE CONJUNTO = '$$Compania$$'
	AND ACCION = 3159

	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM 
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF @MODULO_OFFLINE  = 1 AND NOT (SYSTEM_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_INSERTED CURSOR LOCAL FOR
		SELECT CODIGO_RETENCION, DESCRIPCION, PORCENTAJE, TIPO, APLICA_MONTO, APLICA_SUBTOTAL, APLICA_SUB_DESC, APLICA_IMPUESTO1, APLICA_IMPUESTO2, APLICA_RUBRO1, APLICA_RUBRO2, ESTADO, MONTO_MINIMO, CTR_RETENCION, CTA_RETENCION, RET_POR_ARTICULO, ES_AUTORETENEDOR, CLASIFICACION_ART, CTR_AUTORETENCION, CTA_AUTORETENCION, TIPO_EXCEPCION, NOAPLICA_PROV_AUTO, APLICA_RETENCION, RETENCION_BASE, APLICA_IMP1_DESC, APLICA_IMP1_NODESC, TIPO_DOC_CC_CREDITO, TIPO_DOC_CC_DEBITO, TIPO_DOC_CP_CREDITO, TIPO_DOC_CP_DEBITO, UTILIZA_TARIFA_UVT
		FROM INSERTED
				
		OPEN C_INSERTED	
		FETCH NEXT FROM C_INSERTED INTO
		@CODIGO_RETENCION, @DESCRIPCION, @PORCENTAJE, @TIPO, @APLICA_MONTO, @APLICA_SUBTOTAL, @APLICA_SUB_DESC, @APLICA_IMPUESTO1, @APLICA_IMPUESTO2, @APLICA_RUBRO1, @APLICA_RUBRO2, @ESTADO, @MONTO_MINIMO, @CTR_RETENCION, @CTA_RETENCION, @RET_POR_ARTICULO, @ES_AUTORETENEDOR, @CLASIFICACION_ART, @CTR_AUTORETENCION, @CTA_AUTORETENCION, @TIPO_EXCEPCION, @NOAPLICA_PROV_AUTO, @APLICA_RETENCION, @RETENCION_BASE, @APLICA_IMP1_DESC, @APLICA_IMP1_NODESC, @TIPO_DOC_CC_CREDITO, @TIPO_DOC_CC_DEBITO, @TIPO_DOC_CP_CREDITO, @TIPO_DOC_CP_DEBITO, @UTILIZA_TARIFA_UVT

		SET @ERROR = 0
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS = 
			'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<RETENCIONES>' + 
				'<CODIGO_RETENCION Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CODIGO_RETENCION) + '</CODIGO_RETENCION>' + 
				'<DESCRIPCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DESCRIPCION) + '</DESCRIPCION>' + 
				'<PORCENTAJE Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@PORCENTAJE) + '</PORCENTAJE>' + 
				'<TIPO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO) + '</TIPO>' + 
				'<APLICA_MONTO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@APLICA_MONTO) + '</APLICA_MONTO>' + 
				'<APLICA_SUBTOTAL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@APLICA_SUBTOTAL) + '</APLICA_SUBTOTAL>' + 
				'<APLICA_SUB_DESC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@APLICA_SUB_DESC) + '</APLICA_SUB_DESC>' + 
				'<APLICA_IMPUESTO1 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@APLICA_IMPUESTO1) + '</APLICA_IMPUESTO1>' + 
				'<APLICA_IMPUESTO2 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@APLICA_IMPUESTO2) + '</APLICA_IMPUESTO2>' + 
				'<APLICA_RUBRO1 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@APLICA_RUBRO1) + '</APLICA_RUBRO1>' + 
				'<APLICA_RUBRO2 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@APLICA_RUBRO2) + '</APLICA_RUBRO2>' + 
				'<ESTADO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ESTADO) + '</ESTADO>' + 
				'<MONTO_MINIMO Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@MONTO_MINIMO) + '</MONTO_MINIMO>' + 
				'<CTR_RETENCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_RETENCION) + '</CTR_RETENCION>' + 
				'<CTA_RETENCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_RETENCION) + '</CTA_RETENCION>' + 
				'<RET_POR_ARTICULO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@RET_POR_ARTICULO) + '</RET_POR_ARTICULO>' + 
				'<ES_AUTORETENEDOR Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ES_AUTORETENEDOR) + '</ES_AUTORETENEDOR>' + 
				'<CLASIFICACION_ART Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CLASIFICACION_ART) + '</CLASIFICACION_ART>' + 
				'<CTR_AUTORETENCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_AUTORETENCION) + '</CTR_AUTORETENCION>' + 
				'<CTA_AUTORETENCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_AUTORETENCION) + '</CTA_AUTORETENCION>' + 
				'<TIPO_EXCEPCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_EXCEPCION) + '</TIPO_EXCEPCION>' + 
				'<NOAPLICA_PROV_AUTO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOAPLICA_PROV_AUTO) + '</NOAPLICA_PROV_AUTO>' + 
				'<APLICA_RETENCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@APLICA_RETENCION) + '</APLICA_RETENCION>' + 
				'<RETENCION_BASE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@RETENCION_BASE) + '</RETENCION_BASE>' + 
				'<APLICA_IMP1_DESC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@APLICA_IMP1_DESC) + '</APLICA_IMP1_DESC>' + 
				'<APLICA_IMP1_NODESC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@APLICA_IMP1_NODESC) + '</APLICA_IMP1_NODESC>' + 
				'<TIPO_DOC_CC_CREDITO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_DOC_CC_CREDITO) + '</TIPO_DOC_CC_CREDITO>' + 
				'<TIPO_DOC_CC_DEBITO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_DOC_CC_DEBITO) + '</TIPO_DOC_CC_DEBITO>' + 
				'<TIPO_DOC_CP_CREDITO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_DOC_CP_CREDITO) + '</TIPO_DOC_CP_CREDITO>' + 
				'<TIPO_DOC_CP_DEBITO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_DOC_CP_DEBITO) + '</TIPO_DOC_CP_DEBITO>' + 
				'<UTILIZA_TARIFA_UVT Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@UTILIZA_TARIFA_UVT) + '</UTILIZA_TARIFA_UVT>' + 
				'</RETENCIONES>'

			-- Inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'RETENCIONESPOS600', 'INSERTA', @PARAMETROS, 0, ''

			FETCH NEXT FROM C_INSERTED INTO
			@CODIGO_RETENCION, @DESCRIPCION, @PORCENTAJE, @TIPO, @APLICA_MONTO, @APLICA_SUBTOTAL, @APLICA_SUB_DESC, @APLICA_IMPUESTO1, @APLICA_IMPUESTO2, @APLICA_RUBRO1, @APLICA_RUBRO2, @ESTADO, @MONTO_MINIMO, @CTR_RETENCION, @CTA_RETENCION, @RET_POR_ARTICULO, @ES_AUTORETENEDOR, @CLASIFICACION_ART, @CTR_AUTORETENCION, @CTA_AUTORETENCION, @TIPO_EXCEPCION, @NOAPLICA_PROV_AUTO, @APLICA_RETENCION, @RETENCION_BASE, @APLICA_IMP1_DESC, @APLICA_IMP1_NODESC, @TIPO_DOC_CC_CREDITO, @TIPO_DOC_CC_DEBITO, @TIPO_DOC_CP_CREDITO, @TIPO_DOC_CP_DEBITO, @UTILIZA_TARIFA_UVT
		END

		CLOSE C_INSERTED
    		DEALLOCATE C_INSERTED
	END

	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla RETENCIONES.',16,1 )
	END
END;



CREATE TRIGGER $$Compania$$.RETENCIONES_POS_DEL
ON $$Compania$$.RETENCIONES
FOR DELETE  
AS 
BEGIN   	
        DECLARE @ERROR  int
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @MODULO_OFFLINE INT
	DECLARE @CODIGO_RETENCION VARCHAR(4)
	 -- Declaraciones	
	
	SELECT @MODULO_OFFLINE = COUNT(0)
	FROM ERPADMIN.MODULO_INSTALADO
	WHERE CONJUNTO = '$$Compania$$'
	AND ACCION = 3159

	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM 
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF @MODULO_OFFLINE  = 1 AND NOT (SYSTEM_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_DELETED CURSOR LOCAL FOR
			SELECT CODIGO_RETENCION
			FROM DELETED

		OPEN C_DELETED
		FETCH NEXT FROM C_DELETED INTO 
		@CODIGO_RETENCION -- VARIABLES
		
		SET @ERROR = 0
		
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS = 
							'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<RETENCIONES>' + 
				'<CODIGO_RETENCION Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CODIGO_RETENCION) + '</CODIGO_RETENCION>' + 
				'</RETENCIONES>'
			
			-- inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'RETENCIONESPOS600', 'ELIMINA', @PARAMETROS, 0, ''
			
			FETCH NEXT FROM C_DELETED INTO 
			@CODIGO_RETENCION -- VARIABLES
		END

		CLOSE C_DELETED
		DEALLOCATE C_DELETED
	END
	
	IF (@@ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para eliminar de la tabla RETENCIONES.',16,1 )
	END
END;



CREATE TRIGGER $$Compania$$.RETENCIONES_POS_MOD
ON $$Compania$$.RETENCIONES
FOR UPDATE
AS 
BEGIN   	
	DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @COL_ROWPOINTER VARCHAR(36)
	DECLARE @HAY_CAMPOS_PARA_POS BIT
	DECLARE @ACTUALIZAR_SOLICITUD BIT
	DECLARE @MODULO_OFFLINE INT
	DECLARE @CODIGO_RETENCION VARCHAR(4)
	DECLARE @DESCRIPCION VARCHAR(40)
	DECLARE @PORCENTAJE DECIMAL(28,8)
	DECLARE @TIPO VARCHAR(1)
	DECLARE @APLICA_MONTO VARCHAR(1)
	DECLARE @APLICA_SUBTOTAL VARCHAR(1)
	DECLARE @APLICA_SUB_DESC VARCHAR(1)
	DECLARE @APLICA_IMPUESTO1 VARCHAR(1)
	DECLARE @APLICA_IMPUESTO2 VARCHAR(1)
	DECLARE @APLICA_RUBRO1 VARCHAR(1)
	DECLARE @APLICA_RUBRO2 VARCHAR(1)
	DECLARE @ESTADO VARCHAR(1)
	DECLARE @MONTO_MINIMO DECIMAL(28,8)
	DECLARE @CTR_RETENCION VARCHAR(25)
	DECLARE @CTA_RETENCION VARCHAR(25)
	DECLARE @RET_POR_ARTICULO VARCHAR(1)
	DECLARE @ES_AUTORETENEDOR VARCHAR(1)
	DECLARE @CLASIFICACION_ART VARCHAR(12)
	DECLARE @CTR_AUTORETENCION VARCHAR(25)
	DECLARE @CTA_AUTORETENCION VARCHAR(25)
	DECLARE @TIPO_EXCEPCION VARCHAR(1)
	DECLARE @NOAPLICA_PROV_AUTO VARCHAR(1)
	DECLARE @APLICA_RETENCION VARCHAR(1)
	DECLARE @RETENCION_BASE VARCHAR(4)
	DECLARE @APLICA_IMP1_DESC VARCHAR(1)
	DECLARE @APLICA_IMP1_NODESC VARCHAR(1)
	DECLARE @TIPO_DOC_CC_CREDITO VARCHAR(4000)
	DECLARE @TIPO_DOC_CC_DEBITO VARCHAR(4000)
	DECLARE @TIPO_DOC_CP_CREDITO VARCHAR(4000)
	DECLARE @TIPO_DOC_CP_DEBITO VARCHAR(4000)
	DECLARE @UTILIZA_TARIFA_UVT VARCHAR(1)
	 -- Declaraciones

	SET @ERROR = 0
	
	SELECT @MODULO_OFFLINE = COUNT(0)
	FROM ERPADMIN.MODULO_INSTALADO
	WHERE CONJUNTO = '$$Compania$$'
	AND ACCION = 3159

	SELECT @PUBLICADOR = SITIO_LOCAL, @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF @MODULO_OFFLINE  = 1 AND NOT (SYSTEM_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_MODIFIED CURSOR LOCAL FOR
			SELECT CODIGO_RETENCION, DESCRIPCION, PORCENTAJE, TIPO, APLICA_MONTO, APLICA_SUBTOTAL, APLICA_SUB_DESC, APLICA_IMPUESTO1, APLICA_IMPUESTO2, APLICA_RUBRO1, APLICA_RUBRO2, ESTADO, MONTO_MINIMO, CTR_RETENCION, CTA_RETENCION, RET_POR_ARTICULO, ES_AUTORETENEDOR, CLASIFICACION_ART, CTR_AUTORETENCION, CTA_AUTORETENCION, TIPO_EXCEPCION, NOAPLICA_PROV_AUTO, APLICA_RETENCION, RETENCION_BASE, APLICA_IMP1_DESC, APLICA_IMP1_NODESC, TIPO_DOC_CC_CREDITO, TIPO_DOC_CC_DEBITO, TIPO_DOC_CP_CREDITO, TIPO_DOC_CP_DEBITO, UTILIZA_TARIFA_UVT -- Columnas
			FROM INSERTED I

		SET @ACTUALIZAR_SOLICITUD = 1

		OPEN C_MODIFIED

		FETCH NEXT FROM C_MODIFIED
		INTO @CODIGO_RETENCION, @DESCRIPCION, @PORCENTAJE, @TIPO, @APLICA_MONTO, @APLICA_SUBTOTAL, @APLICA_SUB_DESC, @APLICA_IMPUESTO1, @APLICA_IMPUESTO2, @APLICA_RUBRO1, @APLICA_RUBRO2, @ESTADO, @MONTO_MINIMO, @CTR_RETENCION, @CTA_RETENCION, @RET_POR_ARTICULO, @ES_AUTORETENEDOR, @CLASIFICACION_ART, @CTR_AUTORETENCION, @CTA_AUTORETENCION, @TIPO_EXCEPCION, @NOAPLICA_PROV_AUTO, @APLICA_RETENCION, @RETENCION_BASE, @APLICA_IMP1_DESC, @APLICA_IMP1_NODESC, @TIPO_DOC_CC_CREDITO, @TIPO_DOC_CC_DEBITO, @TIPO_DOC_CP_CREDITO, @TIPO_DOC_CP_DEBITO, @UTILIZA_TARIFA_UVT

		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			IF ( NOT UPDATE(RECORDDATE) AND ( UPDATE(CODIGO_RETENCION) OR UPDATE(DESCRIPCION) OR UPDATE(PORCENTAJE) OR UPDATE(TIPO) OR UPDATE(APLICA_MONTO) OR UPDATE(APLICA_SUBTOTAL) OR UPDATE(APLICA_SUB_DESC) OR UPDATE(APLICA_IMPUESTO1) OR UPDATE(APLICA_IMPUESTO2) OR UPDATE(APLICA_RUBRO1) OR UPDATE(APLICA_RUBRO2) OR UPDATE(ESTADO) OR UPDATE(MONTO_MINIMO) OR UPDATE(CTR_RETENCION) OR UPDATE(CTA_RETENCION) OR UPDATE(RET_POR_ARTICULO) OR UPDATE(ES_AUTORETENEDOR) OR UPDATE(CLASIFICACION_ART) OR UPDATE(CTR_AUTORETENCION) OR UPDATE(CTA_AUTORETENCION) OR UPDATE(TIPO_EXCEPCION) OR UPDATE(NOAPLICA_PROV_AUTO) OR UPDATE(APLICA_RETENCION) OR UPDATE(RETENCION_BASE) OR UPDATE(APLICA_IMP1_DESC) OR UPDATE(APLICA_IMP1_NODESC) OR UPDATE(TIPO_DOC_CC_CREDITO) OR UPDATE(TIPO_DOC_CC_DEBITO) OR UPDATE(TIPO_DOC_CP_CREDITO) OR UPDATE(TIPO_DOC_CP_DEBITO) OR UPDATE(UTILIZA_TARIFA_UVT) ) )
			BEGIN

				SELECT @COL_ROWPOINTER = ROWPOINTER 
				FROM $$Compania$$.RETENCIONES
				WHERE CODIGO_RETENCION = @CODIGO_RETENCION 

				SET @PARAMETROS =
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<RETENCIONES>' + 
				'<CODIGO_RETENCION Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CODIGO_RETENCION) + '</CODIGO_RETENCION>' + 
				'<DESCRIPCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DESCRIPCION) + '</DESCRIPCION>' + 
				'<PORCENTAJE Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@PORCENTAJE) + '</PORCENTAJE>' + 
				'<TIPO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO) + '</TIPO>' + 
				'<APLICA_MONTO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@APLICA_MONTO) + '</APLICA_MONTO>' + 
				'<APLICA_SUBTOTAL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@APLICA_SUBTOTAL) + '</APLICA_SUBTOTAL>' + 
				'<APLICA_SUB_DESC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@APLICA_SUB_DESC) + '</APLICA_SUB_DESC>' + 
				'<APLICA_IMPUESTO1 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@APLICA_IMPUESTO1) + '</APLICA_IMPUESTO1>' + 
				'<APLICA_IMPUESTO2 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@APLICA_IMPUESTO2) + '</APLICA_IMPUESTO2>' + 
				'<APLICA_RUBRO1 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@APLICA_RUBRO1) + '</APLICA_RUBRO1>' + 
				'<APLICA_RUBRO2 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@APLICA_RUBRO2) + '</APLICA_RUBRO2>' + 
				'<ESTADO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ESTADO) + '</ESTADO>' + 
				'<MONTO_MINIMO Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@MONTO_MINIMO) + '</MONTO_MINIMO>' + 
				'<CTR_RETENCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_RETENCION) + '</CTR_RETENCION>' + 
				'<CTA_RETENCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_RETENCION) + '</CTA_RETENCION>' + 
				'<RET_POR_ARTICULO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@RET_POR_ARTICULO) + '</RET_POR_ARTICULO>' + 
				'<ES_AUTORETENEDOR Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ES_AUTORETENEDOR) + '</ES_AUTORETENEDOR>' + 
				'<CLASIFICACION_ART Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CLASIFICACION_ART) + '</CLASIFICACION_ART>' + 
				'<CTR_AUTORETENCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_AUTORETENCION) + '</CTR_AUTORETENCION>' + 
				'<CTA_AUTORETENCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_AUTORETENCION) + '</CTA_AUTORETENCION>' + 
				'<TIPO_EXCEPCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_EXCEPCION) + '</TIPO_EXCEPCION>' + 
				'<NOAPLICA_PROV_AUTO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOAPLICA_PROV_AUTO) + '</NOAPLICA_PROV_AUTO>' + 
				'<APLICA_RETENCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@APLICA_RETENCION) + '</APLICA_RETENCION>' + 
				'<RETENCION_BASE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@RETENCION_BASE) + '</RETENCION_BASE>' + 
				'<APLICA_IMP1_DESC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@APLICA_IMP1_DESC) + '</APLICA_IMP1_DESC>' + 
				'<APLICA_IMP1_NODESC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@APLICA_IMP1_NODESC) + '</APLICA_IMP1_NODESC>' + 
				'<TIPO_DOC_CC_CREDITO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_DOC_CC_CREDITO) + '</TIPO_DOC_CC_CREDITO>' + 
				'<TIPO_DOC_CC_DEBITO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_DOC_CC_DEBITO) + '</TIPO_DOC_CC_DEBITO>' + 
				'<TIPO_DOC_CP_CREDITO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_DOC_CP_CREDITO) + '</TIPO_DOC_CP_CREDITO>' + 
				'<TIPO_DOC_CP_DEBITO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_DOC_CP_DEBITO) + '</TIPO_DOC_CP_DEBITO>' + 
				'<UTILIZA_TARIFA_UVT Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@UTILIZA_TARIFA_UVT) + '</UTILIZA_TARIFA_UVT>' + 
				'</RETENCIONES>'

				-- inserta la solicitud correspondiente
				EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'RETENCIONESPOS600', 'MODIFICA', @PARAMETROS, @ACTUALIZAR_SOLICITUD, @COL_ROWPOINTER
			END

			FETCH NEXT FROM C_MODIFIED
			INTO @CODIGO_RETENCION, @DESCRIPCION, @PORCENTAJE, @TIPO, @APLICA_MONTO, @APLICA_SUBTOTAL, @APLICA_SUB_DESC, @APLICA_IMPUESTO1, @APLICA_IMPUESTO2, @APLICA_RUBRO1, @APLICA_RUBRO2, @ESTADO, @MONTO_MINIMO, @CTR_RETENCION, @CTA_RETENCION, @RET_POR_ARTICULO, @ES_AUTORETENEDOR, @CLASIFICACION_ART, @CTR_AUTORETENCION, @CTA_AUTORETENCION, @TIPO_EXCEPCION, @NOAPLICA_PROV_AUTO, @APLICA_RETENCION, @RETENCION_BASE, @APLICA_IMP1_DESC, @APLICA_IMP1_NODESC, @TIPO_DOC_CC_CREDITO, @TIPO_DOC_CC_DEBITO, @TIPO_DOC_CP_CREDITO, @TIPO_DOC_CP_DEBITO, @UTILIZA_TARIFA_UVT
		END

		CLOSE C_MODIFIED
		DEALLOCATE C_MODIFIED
	END

	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para modificar la tabla RETENCIONES.',16,1 )
	END
END;



CREATE TRIGGER $$Compania$$.RUTA_POS_INS
ON $$Compania$$.RUTA
FOR INSERT
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @RUTA VARCHAR(4)
	DECLARE @DESCRIPCION VARCHAR(40)
	
	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM 
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_INSERTED CURSOR LOCAL FOR
		SELECT RUTA, DESCRIPCION
		FROM INSERTED i
		WHERE 0 = (
				SELECT COUNT('n')
				FROM DELETED d
				WHERE i.RUTA = d.RUTA
			   )
		OPEN C_INSERTED	
		FETCH NEXT FROM C_INSERTED INTO
		@RUTA, @DESCRIPCION

		SET @ERROR = 0
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS = 
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<RUTA>' + 
				'<RUTA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@RUTA) + '</RUTA>' + 
				'<DESCRIPCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DESCRIPCION) + '</DESCRIPCION>' + 
				'</RUTA>'
			-- Inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'RUTAPOS600', 'INSERTA', @PARAMETROS, 0, ''

			FETCH NEXT FROM C_INSERTED INTO
			@RUTA, @DESCRIPCION
		END
		CLOSE C_INSERTED
    		DEALLOCATE C_INSERTED
	END
	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla RUTA.',16,1 )
	END
END
;




CREATE TRIGGER $$Compania$$.RUTA_POS_DEL
 ON $$Compania$$.RUTA
 FOR DELETE  
 AS 
 BEGIN   	
                 DECLARE @ERROR  INT
 	DECLARE @PUBLICADOR VARCHAR(20)
 	DECLARE @PARAMETROS VARCHAR(8000)
 	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
 	DECLARE @RUTA VARCHAR(4)
 	DECLARE @DESCRIPCION VARCHAR(40)
 	 -- Declaraciones	
 	SELECT @PUBLICADOR = SITIO_LOCAL,
 	       @USUARIO_POS_WSQM = USUARIO_WSQM 
 	FROM $$Compania$$.GLOBALES_POS
 	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
 	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
 	BEGIN
 		DECLARE C_DELETED CURSOR LOCAL FOR
 			SELECT RUTA, DESCRIPCION
 			FROM DELETED d
 			WHERE 0 = (
 				SELECT COUNT('n')
 				FROM INSERTED i
 				WHERE d.RUTA = i.RUTA
 			   )
 		OPEN C_DELETED
 		FETCH NEXT FROM C_DELETED INTO 
 		@RUTA, @DESCRIPCION -- VARIABLES
 		
 		SET @ERROR = 0
 		
 		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
 		BEGIN
 			SET @PARAMETROS = 
 				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
 				'<RUTA>' + 
 				'<RUTA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@RUTA) + '</RUTA>' + 
 				'<DESCRIPCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DESCRIPCION) + '</DESCRIPCION>' + 
 				'</RUTA>'
  -- XML
 			-- inserta la solicitud correspondiente
 			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'RUTAPOS600', 'ELIMINA', @PARAMETROS, 0, ''
 			
 			FETCH NEXT FROM C_DELETED INTO 
 			@RUTA, @DESCRIPCION -- VARIABLES
 		END
 		CLOSE C_DELETED
 		DEALLOCATE C_DELETED
 	END
 	IF (@@ERROR <> 0) 
 	BEGIN
 		RAISERROR( 'Error generando la solicitud de servicio para eliminar de la tabla RUTA.',16,1 )
 	END
END
;




CREATE TRIGGER $$Compania$$.RUTA_POS_MOD
ON $$Compania$$.RUTA
FOR UPDATE
AS 
BEGIN   	
	DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @COL_ROWPOINTER VARCHAR(36)
	DECLARE @HAY_CAMPOS_PARA_POS BIT
	DECLARE @ACTUALIZAR_SOLICITUD BIT
	DECLARE @RUTA VARCHAR(4)
	DECLARE @DESCRIPCION VARCHAR(40)
	 -- Declaraciones

	SET @ERROR = 0

	SELECT @PUBLICADOR = SITIO_LOCAL, @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_MODIFIED CURSOR LOCAL FOR
			SELECT RUTA, DESCRIPCION -- Columnas
			FROM INSERTED I

		SET @ACTUALIZAR_SOLICITUD = 1

		OPEN C_MODIFIED

		FETCH NEXT FROM C_MODIFIED
		INTO @RUTA, @DESCRIPCION

		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			IF ( NOT UPDATE(RECORDDATE) AND ( UPDATE(RUTA) OR UPDATE(DESCRIPCION) ) )
			BEGIN
				SELECT @COL_ROWPOINTER = ROWPOINTER 
				FROM $$Compania$$.RUTA
				WHERE RUTA = @RUTA 

				SET @PARAMETROS =
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<RUTA>' + 
				'<RUTA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@RUTA) + '</RUTA>' + 
				'<DESCRIPCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DESCRIPCION) + '</DESCRIPCION>' + 
				'</RUTA>'
				-- inserta la solicitud correspondiente
				EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'RUTAPOS600', 'MODIFICA', @PARAMETROS, @ACTUALIZAR_SOLICITUD, @COL_ROWPOINTER
			END

			FETCH NEXT FROM C_MODIFIED
			INTO @RUTA, @DESCRIPCION
		END
		CLOSE C_MODIFIED
		DEALLOCATE C_MODIFIED
	END
	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para modificar la tabla RUTA.',16,1 )
	END
END
;


CREATE TRIGGER $$Compania$$.SERIE_PLANTILLA_POS_INS
ON $$Compania$$.SERIE_PLANTILLA
FOR INSERT
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @SERIE_PLANTILLA VARCHAR(4)
	DECLARE @DESCRIPCION VARCHAR(40)
	DECLARE @TIPO_SERIE VARCHAR(1)
	DECLARE @MASCARA VARCHAR(20)
	DECLARE @SERIE_MINIMA VARCHAR(20)
	DECLARE @SERIE_MAXIMA VARCHAR(20)
	
	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_INSERTED CURSOR LOCAL FOR
		SELECT SERIE_PLANTILLA, DESCRIPCION, TIPO_SERIE, MASCARA, SERIE_MINIMA, SERIE_MAXIMA
		FROM INSERTED i
		WHERE 0 = (
				SELECT COUNT('n')
				FROM DELETED d
				WHERE i.SERIE_PLANTILLA = d.SERIE_PLANTILLA
			   )
			
		OPEN C_INSERTED	
		FETCH NEXT FROM C_INSERTED INTO
		@SERIE_PLANTILLA, @DESCRIPCION, @TIPO_SERIE, @MASCARA, @SERIE_MINIMA, @SERIE_MAXIMA
		SET @ERROR = 0
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS =
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<SERIE_PLANTILLA>' +
				'<SERIE_PLANTILLA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@SERIE_PLANTILLA) + '</SERIE_PLANTILLA>' +
				'<DESCRIPCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DESCRIPCION) + '</DESCRIPCION>' +
				'<TIPO_SERIE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_SERIE) + '</TIPO_SERIE>' +
				'<MASCARA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@MASCARA) + '</MASCARA>' +
				'<SERIE_MINIMA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@SERIE_MINIMA) + '</SERIE_MINIMA>' +
				'<SERIE_MAXIMA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@SERIE_MAXIMA) + '</SERIE_MAXIMA>' +
				'</SERIE_PLANTILLA>'
			-- Inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'SERIEPLANTILLAPOS600', 'INSERTA', @PARAMETROS, 0, ''
			FETCH NEXT FROM C_INSERTED INTO
			@SERIE_PLANTILLA, @DESCRIPCION, @TIPO_SERIE, @MASCARA, @SERIE_MINIMA, @SERIE_MAXIMA
		END
		CLOSE C_INSERTED
    		DEALLOCATE C_INSERTED
	END
	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla SERIE_PLANTILLA.',16,1 )
	END
END
;




CREATE TRIGGER $$Compania$$.SERIE_PLANTILLA_POS_DEL
ON $$Compania$$.SERIE_PLANTILLA
FOR DELETE
AS
BEGIN   	
                DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @SERIE_PLANTILLA VARCHAR(4)
	 -- Declaraciones	
	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_DELETED CURSOR LOCAL FOR
			SELECT SERIE_PLANTILLA
			FROM DELETED d
			WHERE 0 = (
				SELECT COUNT('n')
				FROM INSERTED i
				WHERE d.SERIE_PLANTILLA = i.SERIE_PLANTILLA
			   )
		OPEN C_DELETED
		FETCH NEXT FROM C_DELETED INTO
		@SERIE_PLANTILLA
		
		SET @ERROR = 0
		
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS =
								'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<SERIE_PLANTILLA>' +
				'<SERIE_PLANTILLA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@SERIE_PLANTILLA) + '</SERIE_PLANTILLA>' +
				'</SERIE_PLANTILLA>'
 -- XML
			
			-- inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'SERIEPLANTILLAPOS600', 'ELIMINA', @PARAMETROS, 0, ''
			
			FETCH NEXT FROM C_DELETED INTO
			@SERIE_PLANTILLA
		END
		CLOSE C_DELETED
		DEALLOCATE C_DELETED
	END
	
	IF (@@ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para eliminar de la tabla SERIE_PLANTILLA.',16,1 )
	END
END
;





CREATE TRIGGER $$Compania$$.SERIE_PLANTILLA_POS_MOD
ON $$Compania$$.SERIE_PLANTILLA
FOR UPDATE
AS
BEGIN   	
	DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @COL_ROWPOINTER VARCHAR(36)
	DECLARE @HAY_CAMPOS_PARA_POS BIT
	DECLARE @ACTUALIZAR_SOLICITUD BIT
	DECLARE @SERIE_PLANTILLA VARCHAR(4)
	DECLARE @DESCRIPCION VARCHAR(40)
	DECLARE @TIPO_SERIE VARCHAR(1)
	DECLARE @MASCARA VARCHAR(20)
	DECLARE @SERIE_MINIMA VARCHAR(20)
	DECLARE @SERIE_MAXIMA VARCHAR(20)
	 -- Declaraciones
	SET @ERROR = 0
	SELECT @PUBLICADOR = SITIO_LOCAL, @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_MODIFIED CURSOR LOCAL FOR
			SELECT SERIE_PLANTILLA, DESCRIPCION, TIPO_SERIE, MASCARA, SERIE_MINIMA, SERIE_MAXIMA -- Columnas
			FROM INSERTED I
		SET @ACTUALIZAR_SOLICITUD = 1
		OPEN C_MODIFIED
		FETCH NEXT FROM C_MODIFIED
		INTO @SERIE_PLANTILLA, @DESCRIPCION, @TIPO_SERIE, @MASCARA, @SERIE_MINIMA, @SERIE_MAXIMA
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			IF ( NOT UPDATE(RECORDDATE) AND ( UPDATE(SERIE_PLANTILLA) OR UPDATE(DESCRIPCION) OR UPDATE(TIPO_SERIE) OR UPDATE(MASCARA) OR UPDATE(SERIE_MINIMA) OR UPDATE(SERIE_MAXIMA) ) )
			BEGIN
				SELECT @COL_ROWPOINTER = ROWPOINTER
				FROM $$Compania$$.SERIE_PLANTILLA
				WHERE SERIE_PLANTILLA = @SERIE_PLANTILLA
				SET @PARAMETROS =
					'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<SERIE_PLANTILLA>' +
				'<SERIE_PLANTILLA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@SERIE_PLANTILLA) + '</SERIE_PLANTILLA>' +
				'<DESCRIPCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DESCRIPCION) + '</DESCRIPCION>' +
				'<TIPO_SERIE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_SERIE) + '</TIPO_SERIE>' +
				'<MASCARA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@MASCARA) + '</MASCARA>' +
				'<SERIE_MINIMA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@SERIE_MINIMA) + '</SERIE_MINIMA>' +
				'<SERIE_MAXIMA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@SERIE_MAXIMA) + '</SERIE_MAXIMA>' +
				'</SERIE_PLANTILLA>'
				-- inserta la solicitud correspondiente
				EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'SERIEPLANTILLAPOS600', 'MODIFICA', @PARAMETROS, @ACTUALIZAR_SOLICITUD, @COL_ROWPOINTER
			END
			FETCH NEXT FROM C_MODIFIED
			INTO @SERIE_PLANTILLA, @DESCRIPCION, @TIPO_SERIE, @MASCARA, @SERIE_MINIMA, @SERIE_MAXIMA
		END
		CLOSE C_MODIFIED
		DEALLOCATE C_MODIFIED
	END
	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para modificar la tabla SERIE_PLANTILLA.',16,1 )
	END
END
;




CREATE TRIGGER $$Compania$$.SITIO_TIENDA_POS_INS
ON $$Compania$$.SITIO_TIENDA
FOR INSERT
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @TIENDA VARCHAR(20)
	DECLARE @SITIO VARCHAR(20)
	
	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_INSERTED CURSOR LOCAL FOR
		SELECT TIENDA, SITIO
		FROM INSERTED i
		WHERE 0 = (
				SELECT COUNT('n')
				FROM DELETED d
				WHERE i.TIENDA = d.TIENDA AND i.SITIO = d.SITIO
			   )
			
		OPEN C_INSERTED	
		FETCH NEXT FROM C_INSERTED INTO
		@TIENDA, @SITIO
		SET @ERROR = 0
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS =
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<SITIO_TIENDA>' +
				'<TIENDA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@TIENDA) + '</TIENDA>' +
				'<SITIO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@SITIO) + '</SITIO>' +
				'</SITIO_TIENDA>'
			-- Inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'SITIOTIENDAPOS600', 'INSERTA', @PARAMETROS, 0, ''
			FETCH NEXT FROM C_INSERTED INTO
			@TIENDA, @SITIO
		END
		CLOSE C_INSERTED
    		DEALLOCATE C_INSERTED
	END
	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla SITIO_TIENDA.',16,1 )
	END
END
;




CREATE TRIGGER $$Compania$$.SITIO_TIENDA_POS_DEL
ON $$Compania$$.SITIO_TIENDA
FOR DELETE
AS
BEGIN   	
                DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @TIENDA VARCHAR(20)
	DECLARE @SITIO VARCHAR(20)
	 -- Declaraciones	
	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_DELETED CURSOR LOCAL FOR
			SELECT TIENDA, SITIO
			FROM DELETED d
			WHERE 0 = (
				SELECT COUNT('n')
				FROM INSERTED i
				WHERE d.TIENDA = i.TIENDA AND d.SITIO = i.SITIO
			   )
		OPEN C_DELETED
		FETCH NEXT FROM C_DELETED INTO
		@TIENDA, @SITIO -- VARIABLES
		
		SET @ERROR = 0
		
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS =
								'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<SITIO_TIENDA>' +
				'<TIENDA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@TIENDA) + '</TIENDA>' +
				'<SITIO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@SITIO) + '</SITIO>' +
				'</SITIO_TIENDA>'
 -- XML
			
			-- inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'SITIOTIENDAPOS600', 'ELIMINA', @PARAMETROS, 0, ''
			
			FETCH NEXT FROM C_DELETED INTO
			@TIENDA, @SITIO -- VARIABLES
		END
		CLOSE C_DELETED
		DEALLOCATE C_DELETED
	END
	
	IF (@@ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para eliminar de la tabla SITIO_TIENDA.',16,1 )
	END
END
;





CREATE TRIGGER $$Compania$$.SITIO_TIENDA_POS_MOD
ON $$Compania$$.SITIO_TIENDA
FOR UPDATE
AS
BEGIN   	
	DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @COL_ROWPOINTER VARCHAR(36)
	DECLARE @HAY_CAMPOS_PARA_POS BIT
	DECLARE @ACTUALIZAR_SOLICITUD BIT
	DECLARE @TIENDA VARCHAR(20)
	DECLARE @SITIO VARCHAR(20)
	 -- Declaraciones
	SET @ERROR = 0
	SELECT @PUBLICADOR = SITIO_LOCAL, @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_MODIFIED CURSOR LOCAL FOR
			SELECT TIENDA, SITIO -- Columnas
			FROM INSERTED I
		SET @ACTUALIZAR_SOLICITUD = 1
		OPEN C_MODIFIED
		FETCH NEXT FROM C_MODIFIED
		INTO @TIENDA, @SITIO
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			IF ( NOT UPDATE(RECORDDATE) AND ( UPDATE(TIENDA) OR UPDATE(SITIO) ) )
			BEGIN
				SELECT @COL_ROWPOINTER = ROWPOINTER
				FROM $$Compania$$.SITIO_TIENDA
				WHERE TIENDA = @TIENDA AND SITIO = @SITIO
				SET @PARAMETROS =
					'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<SITIO_TIENDA>' +
				'<TIENDA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@TIENDA) + '</TIENDA>' +
				'<SITIO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@SITIO) + '</SITIO>' +
				'</SITIO_TIENDA>'
				-- inserta la solicitud correspondiente
				EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'SITIOTIENDAPOS600', 'MODIFICA', @PARAMETROS, @ACTUALIZAR_SOLICITUD, @COL_ROWPOINTER
			END
			FETCH NEXT FROM C_MODIFIED
			INTO @TIENDA, @SITIO
		END
		CLOSE C_MODIFIED
		DEALLOCATE C_MODIFIED
	END
	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para modificar la tabla SITIO_TIENDA.',16,1 )
	END
END
;





CREATE TRIGGER $$Compania$$.SUPERVISOR_POS_INS
ON $$Compania$$.SUPERVISOR
FOR INSERT
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @SUPERVISOR VARCHAR(25)
	DECLARE @GRUPO VARCHAR(6)
	DECLARE @SUPERUSUARIO VARCHAR(1)
	DECLARE @TIPO_SITIO_LOCAL VARCHAR(1)
	
	SELECT @PUBLICADOR = SITIO_LOCAL,
		@USUARIO_POS_WSQM = USUARIO_WSQM,
		@TIPO_SITIO_LOCAL = TIPO_SITIO_LOCAL
  	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM) AND @TIPO_SITIO_LOCAL = 'C'
	BEGIN
		DECLARE C_INSERTED CURSOR LOCAL FOR
		SELECT SUPERVISOR, GRUPO, SUPERUSUARIO
		FROM INSERTED i
		WHERE 0 = (
				SELECT COUNT('n')
				FROM DELETED d
				WHERE i.SUPERVISOR = d.SUPERVISOR
			   )
			
		OPEN C_INSERTED	
		FETCH NEXT FROM C_INSERTED INTO
		@SUPERVISOR, @GRUPO, @SUPERUSUARIO
		SET @ERROR = 0
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS =
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<SUPERVISOR>' +
				'<SUPERVISOR Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@SUPERVISOR) + '</SUPERVISOR>' +
				'<GRUPO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@GRUPO) + '</GRUPO>' +
				'<SUPERUSUARIO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@SUPERUSUARIO) + '</SUPERUSUARIO>' +
				'</SUPERVISOR>'
			-- Inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'SUPERVISORPOS600', 'INSERTA', @PARAMETROS, 0, ''
			FETCH NEXT FROM C_INSERTED INTO
			@SUPERVISOR, @GRUPO, @SUPERUSUARIO
		END
		CLOSE C_INSERTED
    		DEALLOCATE C_INSERTED
	END
	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla SUPERVISOR.',16,1 )
	END
END
;




CREATE TRIGGER $$Compania$$.SUPERVISOR_POS_DEL
ON $$Compania$$.SUPERVISOR
FOR DELETE
AS
BEGIN   	
                DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @SUPERVISOR VARCHAR(25)
	DECLARE @TIPO_SITIO_LOCAL VARCHAR(1)
	 -- Declaraciones	
	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM ,
		@TIPO_SITIO_LOCAL = TIPO_SITIO_LOCAL
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM) AND @TIPO_SITIO_LOCAL = 'C'
	BEGIN
		DECLARE C_DELETED CURSOR LOCAL FOR
			SELECT SUPERVISOR
			FROM DELETED d
			WHERE 0 = (
				SELECT COUNT('n')
				FROM INSERTED i
				WHERE d.SUPERVISOR = i.SUPERVISOR
			   )
		OPEN C_DELETED
		FETCH NEXT FROM C_DELETED INTO
		@SUPERVISOR
		
		SET @ERROR = 0
		
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS =
								'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<SUPERVISOR>' +
				'<SUPERVISOR Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@SUPERVISOR) + '</SUPERVISOR>' +
				'</SUPERVISOR>'
 -- XML
			
			-- inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'SUPERVISORPOS600', 'ELIMINA', @PARAMETROS, 0, ''
			
			FETCH NEXT FROM C_DELETED INTO
			@SUPERVISOR
		END
		CLOSE C_DELETED
		DEALLOCATE C_DELETED
	END
	
	IF (@@ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para eliminar de la tabla SUPERVISOR.',16,1 )
	END
END
;




CREATE TRIGGER $$Compania$$.SUPERVISOR_POS_MOD
ON $$Compania$$.SUPERVISOR
FOR UPDATE
AS
BEGIN   	
	DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @COL_ROWPOINTER VARCHAR(36)
	DECLARE @HAY_CAMPOS_PARA_POS BIT
	DECLARE @ACTUALIZAR_SOLICITUD BIT
	DECLARE @SUPERVISOR VARCHAR(25)
	DECLARE @GRUPO VARCHAR(6)
	DECLARE @SUPERUSUARIO VARCHAR(1)
	DECLARE @TIPO_SITIO_LOCAL VARCHAR(1)
	
	SELECT @PUBLICADOR = SITIO_LOCAL,
		@USUARIO_POS_WSQM = USUARIO_WSQM,
		@TIPO_SITIO_LOCAL = TIPO_SITIO_LOCAL
  	FROM $$Compania$$.GLOBALES_POS
	
	SET @ERROR = 0
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM) AND @TIPO_SITIO_LOCAL = 'C'
	BEGIN
		DECLARE C_MODIFIED CURSOR LOCAL FOR
			SELECT SUPERVISOR, GRUPO, SUPERUSUARIO -- Columnas
			FROM INSERTED I
		SET @ACTUALIZAR_SOLICITUD = 1
		OPEN C_MODIFIED
		FETCH NEXT FROM C_MODIFIED
		INTO @SUPERVISOR, @GRUPO, @SUPERUSUARIO
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			IF ( NOT UPDATE(RECORDDATE) AND ( UPDATE(SUPERVISOR) OR UPDATE(GRUPO) OR UPDATE(SUPERUSUARIO) ) )
			BEGIN
				SELECT @COL_ROWPOINTER = ROWPOINTER
				FROM $$Compania$$.SUPERVISOR
				WHERE SUPERVISOR = @SUPERVISOR
				SET @PARAMETROS =
					'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<SUPERVISOR>' +
				'<SUPERVISOR Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@SUPERVISOR) + '</SUPERVISOR>' +
				'<GRUPO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@GRUPO) + '</GRUPO>' +
				'<SUPERUSUARIO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@SUPERUSUARIO) + '</SUPERUSUARIO>' +
				'</SUPERVISOR>'
				-- inserta la solicitud correspondiente
				EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'SUPERVISORPOS600', 'MODIFICA', @PARAMETROS, @ACTUALIZAR_SOLICITUD, @COL_ROWPOINTER
			END
			FETCH NEXT FROM C_MODIFIED
			INTO @SUPERVISOR, @GRUPO, @SUPERUSUARIO
		END
		CLOSE C_MODIFIED
		DEALLOCATE C_MODIFIED
	END
	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para modificar la tabla SUPERVISOR.',16,1 )
	END
END
;




CREATE TRIGGER $$Compania$$.TIPO_CAMBIO_POS_INS
ON $$Compania$$.TIPO_CAMBIO
FOR INSERT
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @TIPO_CAMBIO VARCHAR(4)
	DECLARE @DESCRIPCION VARCHAR(40)
	
	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_INSERTED CURSOR LOCAL FOR
		SELECT TIPO_CAMBIO, DESCRIPCION
		FROM INSERTED i
		WHERE 0 = (
				SELECT COUNT('n')
				FROM DELETED d
				WHERE i.TIPO_CAMBIO = d.TIPO_CAMBIO
			   )
			
		OPEN C_INSERTED	
		FETCH NEXT FROM C_INSERTED INTO
		@TIPO_CAMBIO, @DESCRIPCION
		SET @ERROR = 0
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS =
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<TIPO_CAMBIO>' +
				'<TIPO_CAMBIO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_CAMBIO) + '</TIPO_CAMBIO>' +
				'<DESCRIPCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DESCRIPCION) + '</DESCRIPCION>' +
				'</TIPO_CAMBIO>'
			-- Inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'TIPOCAMBIOPOS600', 'INSERTA', @PARAMETROS, 0, ''
			FETCH NEXT FROM C_INSERTED INTO
			@TIPO_CAMBIO, @DESCRIPCION
		END
		CLOSE C_INSERTED
    		DEALLOCATE C_INSERTED
	END
	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla TIPO_CAMBIO.',16,1 )
	END
END
;




CREATE TRIGGER $$Compania$$.TIPO_CAMBIO_POS_DEL
ON $$Compania$$.TIPO_CAMBIO
FOR DELETE
AS
BEGIN   	
                DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @TIPO_CAMBIO VARCHAR(4)
	 -- Declaraciones	
	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_DELETED CURSOR LOCAL FOR
			SELECT TIPO_CAMBIO
			FROM DELETED d
			WHERE 0 = (
				SELECT COUNT('n')
				FROM INSERTED i
				WHERE d.TIPO_CAMBIO = i.TIPO_CAMBIO
			   )
		OPEN C_DELETED
		FETCH NEXT FROM C_DELETED INTO
		@TIPO_CAMBIO
		
		SET @ERROR = 0
		
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS =
								'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<TIPO_CAMBIO>' +
				'<TIPO_CAMBIO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_CAMBIO) + '</TIPO_CAMBIO>' +
				'</TIPO_CAMBIO>'
 -- XML
			
			-- inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'TIPOCAMBIOPOS600', 'ELIMINA', @PARAMETROS, 0, ''
			
			FETCH NEXT FROM C_DELETED INTO
			@TIPO_CAMBIO
		END
		CLOSE C_DELETED
		DEALLOCATE C_DELETED
	END
	
	IF (@@ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para eliminar de la tabla TIPO_CAMBIO.',16,1 )
	END
END
;




CREATE TRIGGER $$Compania$$.TIPO_CAMBIO_POS_MOD
ON $$Compania$$.TIPO_CAMBIO
FOR UPDATE
AS
BEGIN   	
	DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @COL_ROWPOINTER VARCHAR(36)
	DECLARE @HAY_CAMPOS_PARA_POS BIT
	DECLARE @ACTUALIZAR_SOLICITUD BIT
	DECLARE @TIPO_CAMBIO VARCHAR(4)
	DECLARE @DESCRIPCION VARCHAR(40)
	 -- Declaraciones
	SET @ERROR = 0
	SELECT @PUBLICADOR = SITIO_LOCAL, @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_MODIFIED CURSOR LOCAL FOR
			SELECT TIPO_CAMBIO, DESCRIPCION -- Columnas
			FROM INSERTED I
		SET @ACTUALIZAR_SOLICITUD = 1
		OPEN C_MODIFIED
		FETCH NEXT FROM C_MODIFIED
		INTO @TIPO_CAMBIO, @DESCRIPCION
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			IF ( NOT UPDATE(RECORDDATE) AND ( UPDATE(TIPO_CAMBIO) OR UPDATE(DESCRIPCION) ) )
			BEGIN
				SELECT @COL_ROWPOINTER = ROWPOINTER
				FROM $$Compania$$.TIPO_CAMBIO
				WHERE TIPO_CAMBIO = @TIPO_CAMBIO
				SET @PARAMETROS =
					'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<TIPO_CAMBIO>' +
				'<TIPO_CAMBIO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_CAMBIO) + '</TIPO_CAMBIO>' +
				'<DESCRIPCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DESCRIPCION) + '</DESCRIPCION>' +
				'</TIPO_CAMBIO>'
				-- inserta la solicitud correspondiente
				EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'TIPOCAMBIOPOS600', 'MODIFICA', @PARAMETROS, @ACTUALIZAR_SOLICITUD, @COL_ROWPOINTER
			END
			FETCH NEXT FROM C_MODIFIED
			INTO @TIPO_CAMBIO, @DESCRIPCION
		END
		CLOSE C_MODIFIED
		DEALLOCATE C_MODIFIED
	END
	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para modificar la tabla TIPO_CAMBIO.',16,1 )
	END
END
;





CREATE TRIGGER $$Compania$$.TIPO_CAMBIO_HIST_POS_INS
ON $$Compania$$.TIPO_CAMBIO_HIST
FOR INSERT
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @TIPO_CAMBIO VARCHAR(4)
	DECLARE @FECHA DATETIME
	DECLARE @USUARIO VARCHAR(25)
	DECLARE @MONTO DECIMAL(28,8)
	
	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_INSERTED CURSOR LOCAL FOR
		SELECT TIPO_CAMBIO, FECHA, USUARIO, MONTO
		FROM INSERTED i
		WHERE 0 = (
				SELECT COUNT('n')
				FROM DELETED d
				WHERE i.TIPO_CAMBIO = d.TIPO_CAMBIO AND i.FECHA = d.FECHA
			   )
			
		OPEN C_INSERTED	
		FETCH NEXT FROM C_INSERTED INTO
		@TIPO_CAMBIO, @FECHA, @USUARIO, @MONTO
		SET @ERROR = 0
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS =
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<TIPO_CAMBIO_HIST>' +
				'<TIPO_CAMBIO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_CAMBIO) + '</TIPO_CAMBIO>' +
				'<FECHA Type="DATETIME" PrimaryKey="True">' + ERPADMIN.POS_FormatoFecha(@FECHA) + '</FECHA>' +
				'<USUARIO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USUARIO) + '</USUARIO>' +
				'<MONTO Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@MONTO) + '</MONTO>' +
				'</TIPO_CAMBIO_HIST>'
			-- Inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'TIPOCAMBIOHISTPOS600', 'INSERTA', @PARAMETROS, 0, ''
			FETCH NEXT FROM C_INSERTED INTO
			@TIPO_CAMBIO, @FECHA, @USUARIO, @MONTO
		END
		CLOSE C_INSERTED
    		DEALLOCATE C_INSERTED
	END
	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla TIPO_CAMBIO_HIST.',16,1 )
	END
END
;





CREATE TRIGGER $$Compania$$.TIPO_CAMBIO_HIST_POS_DEL
ON $$Compania$$.TIPO_CAMBIO_HIST
FOR DELETE
AS
BEGIN   	
                DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @TIPO_CAMBIO VARCHAR(4)
	DECLARE @FECHA DATETIME
	 -- Declaraciones	
	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_DELETED CURSOR LOCAL FOR
			SELECT TIPO_CAMBIO, FECHA
			FROM DELETED d
			WHERE 0 = (
				SELECT COUNT('n')
				FROM INSERTED i
				WHERE d.TIPO_CAMBIO = i.TIPO_CAMBIO AND d.FECHA = i.FECHA
			   )
		OPEN C_DELETED
		FETCH NEXT FROM C_DELETED INTO
		@TIPO_CAMBIO, @FECHA
		
		SET @ERROR = 0
		
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS =
								'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<TIPO_CAMBIO_HIST>' +
				'<TIPO_CAMBIO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_CAMBIO) + '</TIPO_CAMBIO>' +
				'<FECHA Type="DATETIME" PrimaryKey="True">' + ERPADMIN.POS_FormatoFecha(@FECHA) + '</FECHA>' +
				'</TIPO_CAMBIO_HIST>'
 -- XML
			
			-- inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'TIPOCAMBIOHISTPOS600', 'ELIMINA', @PARAMETROS, 0, ''
			
			FETCH NEXT FROM C_DELETED INTO
			@TIPO_CAMBIO, @FECHA
		END
		CLOSE C_DELETED
		DEALLOCATE C_DELETED
	END
	
	IF (@@ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para eliminar de la tabla TIPO_CAMBIO_HIST.',16,1 )
	END
END;





CREATE TRIGGER $$Compania$$.TIPO_CAMBIO_HIST_POS_MOD
ON $$Compania$$.TIPO_CAMBIO_HIST
FOR UPDATE
AS
BEGIN   	
	DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @COL_ROWPOINTER VARCHAR(36)
	DECLARE @HAY_CAMPOS_PARA_POS BIT
	DECLARE @ACTUALIZAR_SOLICITUD BIT
	DECLARE @TIPO_CAMBIO VARCHAR(4)
	DECLARE @FECHA DATETIME
	DECLARE @USUARIO VARCHAR(25)
	DECLARE @MONTO DECIMAL(28,8)
	 -- Declaraciones
	SET @ERROR = 0
	SELECT @PUBLICADOR = SITIO_LOCAL, @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_MODIFIED CURSOR LOCAL FOR
			SELECT TIPO_CAMBIO, FECHA, USUARIO, MONTO -- Columnas
			FROM INSERTED I
		SET @ACTUALIZAR_SOLICITUD = 1
		OPEN C_MODIFIED
		FETCH NEXT FROM C_MODIFIED
		INTO @TIPO_CAMBIO, @FECHA, @USUARIO, @MONTO
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			IF ( NOT UPDATE(RECORDDATE) AND ( UPDATE(TIPO_CAMBIO) OR UPDATE(FECHA) OR UPDATE(USUARIO) OR UPDATE(MONTO) ) )
			BEGIN
				SELECT @COL_ROWPOINTER = ROWPOINTER
				FROM $$Compania$$.TIPO_CAMBIO_HIST
				WHERE TIPO_CAMBIO = @TIPO_CAMBIO AND FECHA = @FECHA
				SET @PARAMETROS =
					'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<TIPO_CAMBIO_HIST>' +
				'<TIPO_CAMBIO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_CAMBIO) + '</TIPO_CAMBIO>' +
				'<FECHA Type="DATETIME" PrimaryKey="True">' + ERPADMIN.POS_FormatoFecha(@FECHA) + '</FECHA>' +
				'<USUARIO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USUARIO) + '</USUARIO>' +
				'<MONTO Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@MONTO) + '</MONTO>' +
				'</TIPO_CAMBIO_HIST>'
				-- inserta la solicitud correspondiente
				EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'TIPOCAMBIOHISTPOS600', 'MODIFICA', @PARAMETROS, @ACTUALIZAR_SOLICITUD, @COL_ROWPOINTER
			END
			FETCH NEXT FROM C_MODIFIED
			INTO @TIPO_CAMBIO, @FECHA, @USUARIO, @MONTO
		END
		CLOSE C_MODIFIED
		DEALLOCATE C_MODIFIED
	END
	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para modificar la tabla TIPO_CAMBIO_HIST.',16,1 )
	END
END;





CREATE TRIGGER $$Compania$$.TIPO_TARJETA_POS_INS
ON $$Compania$$.TIPO_TARJETA
FOR INSERT
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @TIPO_TARJETA VARCHAR(12)
	
	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_INSERTED CURSOR LOCAL FOR
		SELECT TIPO_TARJETA
		FROM INSERTED i
		WHERE 0 = (
				SELECT COUNT('n')
				FROM DELETED d
				WHERE i.TIPO_TARJETA = d.TIPO_TARJETA
			   )
			
		OPEN C_INSERTED	
		FETCH NEXT FROM C_INSERTED INTO
		@TIPO_TARJETA
		SET @ERROR = 0
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS =
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<TIPO_TARJETA>' +
				'<TIPO_TARJETA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_TARJETA) + '</TIPO_TARJETA>' +
				'</TIPO_TARJETA>'
			-- Inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'TIPOTARJETAPOS600', 'INSERTA', @PARAMETROS, 0, ''
			FETCH NEXT FROM C_INSERTED INTO
			@TIPO_TARJETA
		END
		CLOSE C_INSERTED
    		DEALLOCATE C_INSERTED
	END
	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla TIPO_TARJETA.',16,1 )
	END
END;




CREATE TRIGGER $$Compania$$.TIPO_TARJETA_POS_DEL
ON $$Compania$$.TIPO_TARJETA
FOR DELETE
AS
BEGIN   	
                DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @TIPO_TARJETA VARCHAR(12)
	 -- Declaraciones	
	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_DELETED CURSOR LOCAL FOR
			SELECT TIPO_TARJETA
			FROM DELETED d
			WHERE 0 = (
				SELECT COUNT('n')
				FROM INSERTED i
				WHERE d.TIPO_TARJETA = i.TIPO_TARJETA
			   )
		OPEN C_DELETED
		FETCH NEXT FROM C_DELETED INTO
		@TIPO_TARJETA -- VARIABLES
		
		SET @ERROR = 0
		
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS =
								'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<TIPO_TARJETA>' +
				'<TIPO_TARJETA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_TARJETA) + '</TIPO_TARJETA>' +
				'</TIPO_TARJETA>'
 -- XML
			
			-- inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'TIPOTARJETAPOS600', 'ELIMINA', @PARAMETROS, 0, ''
			
			FETCH NEXT FROM C_DELETED INTO
			@TIPO_TARJETA -- VARIABLES
		END
		CLOSE C_DELETED
		DEALLOCATE C_DELETED
	END
	
	IF (@@ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para eliminar de la tabla TIPO_TARJETA.',16,1 )
	END
END;





CREATE TRIGGER $$Compania$$.TIPO_TARJETA_POS_MOD
ON $$Compania$$.TIPO_TARJETA
FOR UPDATE
AS
BEGIN   	
	DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @COL_ROWPOINTER VARCHAR(36)
	DECLARE @HAY_CAMPOS_PARA_POS BIT
	DECLARE @ACTUALIZAR_SOLICITUD BIT
	DECLARE @TIPO_TARJETA VARCHAR(12)
	DECLARE @TIPO_SITIO_LOCAL VARCHAR(1)
	
	SELECT @PUBLICADOR = SITIO_LOCAL,
		@USUARIO_POS_WSQM = USUARIO_WSQM,
		@TIPO_SITIO_LOCAL = TIPO_SITIO_LOCAL
  	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_MODIFIED CURSOR LOCAL FOR
			SELECT TIPO_TARJETA -- Columnas
			FROM INSERTED I
		SET @ACTUALIZAR_SOLICITUD = 1
		OPEN C_MODIFIED
		FETCH NEXT FROM C_MODIFIED
		INTO @TIPO_TARJETA
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			IF ( NOT UPDATE(RECORDDATE) AND ( UPDATE(TIPO_TARJETA) ) )
			BEGIN
				SELECT @COL_ROWPOINTER = ROWPOINTER
				FROM $$Compania$$.TIPO_TARJETA
				WHERE TIPO_TARJETA = @TIPO_TARJETA
				SET @PARAMETROS =
					'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<TIPO_TARJETA>' +
				'<TIPO_TARJETA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_TARJETA) + '</TIPO_TARJETA>' +
				'</TIPO_TARJETA>'
				-- inserta la solicitud correspondiente
				EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'TIPOTARJETAPOS600', 'MODIFICA', @PARAMETROS, @ACTUALIZAR_SOLICITUD, @COL_ROWPOINTER
			END
			FETCH NEXT FROM C_MODIFIED
			INTO @TIPO_TARJETA
		END
		CLOSE C_MODIFIED
		DEALLOCATE C_MODIFIED
	END
	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para modificar la tabla TIPO_TARJETA.',16,1 )
	END
END;






CREATE TRIGGER $$Compania$$.TIPO_TARJETA_POS_POS_INS
ON $$Compania$$.TIPO_TARJETA_POS
FOR INSERT
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @TIPO_TARJETA VARCHAR(12)
	DECLARE @CLIENTE VARCHAR(20)
	DECLARE @COMISION DECIMAL(28,8)
	DECLARE @CTR_AUTORIZADOR VARCHAR(25)
	DECLARE @CTA_AUTORIZADOR VARCHAR(25)
	DECLARE @CTR_COMISION VARCHAR(25)
	DECLARE @CTA_COMISION VARCHAR(25)
	DECLARE @TIPO_SITIO_LOCAL VARCHAR(1)
	DECLARE @TIPO_COBRO VARCHAR(1)
	DECLARE @CONFIGURACION_PAGO VARCHAR(1)
	DECLARE @PORCENTAJE_PAGO DECIMAL(28,8)
	DECLARE @PORCENTAJE_FIJO VARCHAR(1)
	DECLARE @NCF_FACTURA VARCHAR(20)
	DECLARE @NCF_DEVOLUCION VARCHAR(20)
	DECLARE @CONFIGURACION_COBRO VARCHAR(1)
	DECLARE @TIPO_CONF_COBRO_CLIENTE VARCHAR(1)
	DECLARE @GENERAR_COBRO VARCHAR(1)
	DECLARE @TIPO_DOC_CXC VARCHAR(3)
	DECLARE @SUBTIPO_DOC_CXC INT
	DECLARE @TIPO_DOC_COMISION VARCHAR(3)
	DECLARE @SUBTIPO_DOC_COMISION INT
	
	SELECT @PUBLICADOR = SITIO_LOCAL,
		@USUARIO_POS_WSQM = USUARIO_WSQM,
		@TIPO_SITIO_LOCAL = TIPO_SITIO_LOCAL
  	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM) AND @TIPO_SITIO_LOCAL = 'C'
	BEGIN
		DECLARE C_INSERTED CURSOR LOCAL FOR
		SELECT TIPO_TARJETA, CLIENTE, TIPO_COBRO, COMISION, CTR_AUTORIZADOR, CTA_AUTORIZADOR, CTR_COMISION, CTA_COMISION, CONFIGURACION_PAGO, PORCENTAJE_PAGO, PORCENTAJE_FIJO, NCF_FACTURA, NCF_DEVOLUCION, CONFIGURACION_COBRO, TIPO_CONF_COBRO_CLIENTE, GENERAR_COBRO, TIPO_DOC_CXC, SUBTIPO_DOC_CXC, TIPO_DOC_COMISION, SUBTIPO_DOC_COMISION
		FROM INSERTED i
		WHERE 0 = (
				SELECT COUNT('n')
				FROM DELETED d
				WHERE i.TIPO_TARJETA = d.TIPO_TARJETA AND i.CLIENTE = d.CLIENTE AND i.TIPO_COBRO = d.TIPO_COBRO
			   )
			
		OPEN C_INSERTED	
		FETCH NEXT FROM C_INSERTED INTO
		@TIPO_TARJETA, @CLIENTE, @TIPO_COBRO, @COMISION, @CTR_AUTORIZADOR, @CTA_AUTORIZADOR, @CTR_COMISION, @CTA_COMISION, @CONFIGURACION_PAGO, @PORCENTAJE_PAGO, @PORCENTAJE_FIJO, @NCF_FACTURA, @NCF_DEVOLUCION, @CONFIGURACION_COBRO, @TIPO_CONF_COBRO_CLIENTE, @GENERAR_COBRO, @TIPO_DOC_CXC, @SUBTIPO_DOC_CXC, @TIPO_DOC_COMISION, @SUBTIPO_DOC_COMISION
		SET @ERROR = 0
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS =
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<TIPO_TARJETA_POS>' +
				'<TIPO_TARJETA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_TARJETA) + '</TIPO_TARJETA>' +
				'<CLIENTE Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CLIENTE) + '</CLIENTE>' +
				'<TIPO_COBRO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_COBRO) + '</TIPO_COBRO>' + 
				'<COMISION Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@COMISION) + '</COMISION>' +
				'<CTR_AUTORIZADOR Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_AUTORIZADOR) + '</CTR_AUTORIZADOR>' +
				'<CTA_AUTORIZADOR Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_AUTORIZADOR) + '</CTA_AUTORIZADOR>' +
				'<CTR_COMISION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_COMISION) + '</CTR_COMISION>' +
				'<CTA_COMISION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_COMISION) + '</CTA_COMISION>' +
				'<CONFIGURACION_PAGO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CONFIGURACION_PAGO) + '</CONFIGURACION_PAGO>' + 
				'<PORCENTAJE_PAGO Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@PORCENTAJE_PAGO) + '</PORCENTAJE_PAGO>' + 
				'<PORCENTAJE_FIJO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@PORCENTAJE_FIJO) + '</PORCENTAJE_FIJO>' + 
				'<NCF_FACTURA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NCF_FACTURA) + '</NCF_FACTURA>' + 
				'<NCF_DEVOLUCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NCF_DEVOLUCION) + '</NCF_DEVOLUCION>' + 
				'<CONFIGURACION_COBRO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CONFIGURACION_COBRO) + '</CONFIGURACION_COBRO>' + 
				'<TIPO_CONF_COBRO_CLIENTE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_CONF_COBRO_CLIENTE) + '</TIPO_CONF_COBRO_CLIENTE>' + 
				'<GENERAR_COBRO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@GENERAR_COBRO) + '</GENERAR_COBRO>' + 
				'<TIPO_DOC_CXC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_DOC_CXC) + '</TIPO_DOC_CXC>' + 
				'<SUBTIPO_DOC_CXC Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@SUBTIPO_DOC_CXC) + '</SUBTIPO_DOC_CXC>' + 
				'<TIPO_DOC_COMISION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_DOC_COMISION) + '</TIPO_DOC_COMISION>' + 
				'<SUBTIPO_DOC_COMISION Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@SUBTIPO_DOC_COMISION) + '</SUBTIPO_DOC_COMISION>' + 
				'</TIPO_TARJETA_POS>'
			-- Inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'TIPOTARJETAPOSPOS600', 'INSERTA', @PARAMETROS, 0, ''
			FETCH NEXT FROM C_INSERTED INTO
			@TIPO_TARJETA, @CLIENTE, @TIPO_COBRO, @COMISION, @CTR_AUTORIZADOR, @CTA_AUTORIZADOR, @CTR_COMISION, @CTA_COMISION, @CONFIGURACION_PAGO, @PORCENTAJE_PAGO, @PORCENTAJE_FIJO, @NCF_FACTURA, @NCF_DEVOLUCION, @CONFIGURACION_COBRO, @TIPO_CONF_COBRO_CLIENTE, @GENERAR_COBRO, @TIPO_DOC_CXC, @SUBTIPO_DOC_CXC, @TIPO_DOC_COMISION, @SUBTIPO_DOC_COMISION
		END
		CLOSE C_INSERTED
    		DEALLOCATE C_INSERTED
	END
	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla TIPO_TARJETA_POS.',16,1 )
	END
END;



CREATE TRIGGER $$Compania$$.TIPO_TARJETA_POS_POS_DEL
ON $$Compania$$.TIPO_TARJETA_POS
FOR DELETE
AS
BEGIN   	
    DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @TIPO_SITIO_LOCAL VARCHAR(1)
	DECLARE @TIPO_TARJETA VARCHAR(12)
	DECLARE @CLIENTE VARCHAR(20)
	DECLARE @TIPO_COBRO VARCHAR(1)

	SELECT @PUBLICADOR = SITIO_LOCAL,
		@USUARIO_POS_WSQM = USUARIO_WSQM,
		@TIPO_SITIO_LOCAL = TIPO_SITIO_LOCAL
  	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM) AND @TIPO_SITIO_LOCAL = 'C'
	BEGIN
		DECLARE C_DELETED CURSOR LOCAL FOR
			SELECT TIPO_TARJETA, CLIENTE, TIPO_COBRO
			FROM DELETED d
			WHERE 0 = (
				SELECT COUNT('n')
				FROM INSERTED i
				WHERE d.TIPO_TARJETA = i.TIPO_TARJETA AND d.CLIENTE = i.CLIENTE AND d.TIPO_COBRO = i.TIPO_COBRO
			   )
		OPEN C_DELETED
		FETCH NEXT FROM C_DELETED INTO
		@TIPO_TARJETA, @CLIENTE, @TIPO_COBRO -- VARIABLES
		
		SET @ERROR = 0
		
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS =
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<TIPO_TARJETA_POS>' +
				'<TIPO_TARJETA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_TARJETA) + '</TIPO_TARJETA>' +
				'<CLIENTE Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CLIENTE) + '</CLIENTE>' + 
				'<TIPO_COBRO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_COBRO) + '</TIPO_COBRO>' + 
				'</TIPO_TARJETA_POS>'

			-- inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'TIPOTARJETAPOSPOS600', 'ELIMINA', @PARAMETROS, 0, ''
			
			FETCH NEXT FROM C_DELETED INTO
			@TIPO_TARJETA, @CLIENTE, @TIPO_COBRO -- VARIABLES
		END
		CLOSE C_DELETED
		DEALLOCATE C_DELETED
	END
	
	IF (@@ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para eliminar de la tabla TIPO_TARJETA_POS.',16,1 )
	END
END;







CREATE TRIGGER $$Compania$$.TIPO_TARJETA_POS_POS_MOD
ON $$Compania$$.TIPO_TARJETA_POS
FOR UPDATE
AS
BEGIN   	
	DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @COL_ROWPOINTER VARCHAR(36)
	DECLARE @TIPO_SITIO_LOCAL VARCHAR(1)
	DECLARE @HAY_CAMPOS_PARA_POS BIT
	DECLARE @ACTUALIZAR_SOLICITUD BIT
	DECLARE @TIPO_TARJETA VARCHAR(12)
	DECLARE @CLIENTE VARCHAR(20)
	DECLARE @COMISION DECIMAL(28,8)
	DECLARE @CTR_AUTORIZADOR VARCHAR(25)
	DECLARE @CTA_AUTORIZADOR VARCHAR(25)
	DECLARE @CTR_COMISION VARCHAR(25)
	DECLARE @CTA_COMISION VARCHAR(25)
	DECLARE @TIPO_COBRO VARCHAR(1)
	DECLARE @CONFIGURACION_PAGO VARCHAR(1)
	DECLARE @PORCENTAJE_PAGO DECIMAL(28,8)
	DECLARE @PORCENTAJE_FIJO VARCHAR(1)
	DECLARE @NCF_FACTURA VARCHAR(20)
	DECLARE @NCF_DEVOLUCION VARCHAR(20)
	DECLARE @CONFIGURACION_COBRO VARCHAR(1)
	DECLARE @TIPO_CONF_COBRO_CLIENTE VARCHAR(1)
	DECLARE @GENERAR_COBRO VARCHAR(1)
	DECLARE @TIPO_DOC_CXC VARCHAR(3)
	DECLARE @SUBTIPO_DOC_CXC INT
	DECLARE @TIPO_DOC_COMISION VARCHAR(3)
	DECLARE @SUBTIPO_DOC_COMISION INT
	
	 -- Declaraciones
	SET @ERROR = 0
	SELECT @PUBLICADOR = SITIO_LOCAL, @USUARIO_POS_WSQM = USUARIO_WSQM,
		@TIPO_SITIO_LOCAL = TIPO_SITIO_LOCAL
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM) AND @TIPO_SITIO_LOCAL = 'C'
	BEGIN
		DECLARE C_MODIFIED CURSOR LOCAL FOR
			SELECT TIPO_TARJETA, CLIENTE, TIPO_COBRO, COMISION, CTR_AUTORIZADOR, CTA_AUTORIZADOR, CTR_COMISION, CTA_COMISION, CONFIGURACION_PAGO, PORCENTAJE_PAGO, PORCENTAJE_FIJO, NCF_FACTURA, NCF_DEVOLUCION, CONFIGURACION_COBRO, TIPO_CONF_COBRO_CLIENTE, GENERAR_COBRO, TIPO_DOC_CXC, SUBTIPO_DOC_CXC, TIPO_DOC_COMISION, SUBTIPO_DOC_COMISION -- Columnas
			FROM INSERTED I
		SET @ACTUALIZAR_SOLICITUD = 1
		OPEN C_MODIFIED
		FETCH NEXT FROM C_MODIFIED
		INTO @TIPO_TARJETA, @CLIENTE, @TIPO_COBRO, @COMISION, @CTR_AUTORIZADOR, @CTA_AUTORIZADOR, @CTR_COMISION, @CTA_COMISION, @CONFIGURACION_PAGO, @PORCENTAJE_PAGO, @PORCENTAJE_FIJO, @NCF_FACTURA, @NCF_DEVOLUCION, @CONFIGURACION_COBRO, @TIPO_CONF_COBRO_CLIENTE, @GENERAR_COBRO, @TIPO_DOC_CXC, @SUBTIPO_DOC_CXC, @TIPO_DOC_COMISION, @SUBTIPO_DOC_COMISION
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			
			IF ( NOT UPDATE(RECORDDATE) AND ( UPDATE(TIPO_TARJETA) OR UPDATE(CLIENTE) OR UPDATE(COMISION) OR UPDATE(CTR_AUTORIZADOR) OR UPDATE(CTA_AUTORIZADOR) OR UPDATE(CTR_COMISION) OR UPDATE(CTA_COMISION) OR UPDATE(TIPO_COBRO) OR UPDATE(CONFIGURACION_PAGO) OR UPDATE(PORCENTAJE_PAGO) OR UPDATE(PORCENTAJE_FIJO) OR UPDATE(NCF_FACTURA) OR UPDATE(NCF_DEVOLUCION) OR UPDATE(CONFIGURACION_COBRO) OR UPDATE(TIPO_CONF_COBRO_CLIENTE) OR UPDATE(GENERAR_COBRO) OR UPDATE(TIPO_DOC_CXC) OR UPDATE(SUBTIPO_DOC_CXC)OR UPDATE(TIPO_DOC_COMISION) OR UPDATE(SUBTIPO_DOC_COMISION)) )
			BEGIN
				SELECT @COL_ROWPOINTER = ROWPOINTER
				FROM $$Compania$$.TIPO_TARJETA_POS
				WHERE TIPO_TARJETA = @TIPO_TARJETA AND CLIENTE = @CLIENTE AND TIPO_COBRO = @TIPO_COBRO 
				SET @PARAMETROS =
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<TIPO_TARJETA_POS>' +
				'<TIPO_TARJETA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_TARJETA) + '</TIPO_TARJETA>' +
				'<CLIENTE Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CLIENTE) + '</CLIENTE>' +
				'<TIPO_COBRO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_COBRO) + '</TIPO_COBRO>' + 
				'<COMISION Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@COMISION) + '</COMISION>' +
				'<CTR_AUTORIZADOR Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_AUTORIZADOR) + '</CTR_AUTORIZADOR>' +
				'<CTA_AUTORIZADOR Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_AUTORIZADOR) + '</CTA_AUTORIZADOR>' +
				'<CTR_COMISION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_COMISION) + '</CTR_COMISION>' +
				'<CTA_COMISION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_COMISION) + '</CTA_COMISION>' +
				'<CONFIGURACION_PAGO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CONFIGURACION_PAGO) + '</CONFIGURACION_PAGO>' + 
				'<PORCENTAJE_PAGO Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@PORCENTAJE_PAGO) + '</PORCENTAJE_PAGO>' + 
				'<PORCENTAJE_FIJO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@PORCENTAJE_FIJO) + '</PORCENTAJE_FIJO>' + 
				'<NCF_FACTURA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NCF_FACTURA) + '</NCF_FACTURA>' + 
				'<NCF_DEVOLUCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NCF_DEVOLUCION) + '</NCF_DEVOLUCION>' + 
				'<CONFIGURACION_COBRO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CONFIGURACION_COBRO) + '</CONFIGURACION_COBRO>' + 
				'<TIPO_CONF_COBRO_CLIENTE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_CONF_COBRO_CLIENTE) + '</TIPO_CONF_COBRO_CLIENTE>' + 
				'<GENERAR_COBRO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@GENERAR_COBRO) + '</GENERAR_COBRO>' + 
				'<TIPO_DOC_CXC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_DOC_CXC) + '</TIPO_DOC_CXC>' + 
				'<SUBTIPO_DOC_CXC Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@SUBTIPO_DOC_CXC) + '</SUBTIPO_DOC_CXC>' + 
				'<TIPO_DOC_COMISION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_DOC_COMISION) + '</TIPO_DOC_COMISION>' + 
				'<SUBTIPO_DOC_COMISION Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@SUBTIPO_DOC_COMISION) + '</SUBTIPO_DOC_COMISION>' + 
				'</TIPO_TARJETA_POS>'
				-- inserta la solicitud correspondiente
				EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'TIPOTARJETAPOSPOS600', 'MODIFICA', @PARAMETROS, @ACTUALIZAR_SOLICITUD, @COL_ROWPOINTER
			END
			FETCH NEXT FROM C_MODIFIED
			INTO @TIPO_TARJETA, @CLIENTE, @TIPO_COBRO, @COMISION, @CTR_AUTORIZADOR, @CTA_AUTORIZADOR, @CTR_COMISION, @CTA_COMISION, @CONFIGURACION_PAGO, @PORCENTAJE_PAGO, @PORCENTAJE_FIJO, @NCF_FACTURA, @NCF_DEVOLUCION, @CONFIGURACION_COBRO, @TIPO_CONF_COBRO_CLIENTE, @GENERAR_COBRO, @TIPO_DOC_CXC, @SUBTIPO_DOC_CXC, @TIPO_DOC_COMISION, @SUBTIPO_DOC_COMISION
		END
		CLOSE C_MODIFIED
		DEALLOCATE C_MODIFIED
	END
	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para modificar la tabla TIPO_TARJETA_POS.',16,1 )
	END
END;







CREATE TRIGGER $$Compania$$.UNIDAD_DE_MEDIDA_POS_INS
ON $$Compania$$.UNIDAD_DE_MEDIDA
FOR INSERT
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @TIPO_SITIO_LOCAL VARCHAR(1)
	DECLARE @UNIDAD_MEDIDA VARCHAR(6)
	DECLARE @DESCRIPCION VARCHAR(40)
	
	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM ,
		@TIPO_SITIO_LOCAL = TIPO_SITIO_LOCAL
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM) AND @TIPO_SITIO_LOCAL = 'C'
	BEGIN
		DECLARE C_INSERTED CURSOR LOCAL FOR
		SELECT UNIDAD_MEDIDA, DESCRIPCION
		FROM INSERTED i
		WHERE 0 = (
				SELECT COUNT('n')
				FROM DELETED d
				WHERE i.UNIDAD_MEDIDA = d.UNIDAD_MEDIDA
			   )
			
		OPEN C_INSERTED	
		FETCH NEXT FROM C_INSERTED INTO
		@UNIDAD_MEDIDA, @DESCRIPCION
		SET @ERROR = 0
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS =
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<UNIDAD_DE_MEDIDA>' +
				'<UNIDAD_MEDIDA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@UNIDAD_MEDIDA) + '</UNIDAD_MEDIDA>' +
				'<DESCRIPCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DESCRIPCION) + '</DESCRIPCION>' +
				'</UNIDAD_DE_MEDIDA>'
			-- Inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'UNIDADDEMEDIDAPOS600', 'INSERTA', @PARAMETROS, 0, ''
			FETCH NEXT FROM C_INSERTED INTO
			@UNIDAD_MEDIDA, @DESCRIPCION
		END
		CLOSE C_INSERTED
    		DEALLOCATE C_INSERTED
	END
	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla UNIDAD_DE_MEDIDA.',16,1 )
	END
END
;




CREATE TRIGGER $$Compania$$.UNIDAD_DE_MEDIDA_POS_DEL
ON $$Compania$$.UNIDAD_DE_MEDIDA
FOR DELETE
AS
BEGIN   	
                DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @TIPO_SITIO_LOCAL VARCHAR(1)
	DECLARE @UNIDAD_MEDIDA VARCHAR(6)
	 -- Declaraciones	
	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM ,
		@TIPO_SITIO_LOCAL = TIPO_SITIO_LOCAL
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)  AND @TIPO_SITIO_LOCAL = 'C'
	BEGIN
		DECLARE C_DELETED CURSOR LOCAL FOR
			SELECT UNIDAD_MEDIDA
			FROM DELETED d
			WHERE 0 = (
				SELECT COUNT('n')
				FROM INSERTED i
				WHERE d.UNIDAD_MEDIDA = i.UNIDAD_MEDIDA
			   )
		OPEN C_DELETED
		FETCH NEXT FROM C_DELETED INTO
		@UNIDAD_MEDIDA
		
		SET @ERROR = 0
		
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS =
								'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<UNIDAD_DE_MEDIDA>' +
				'<UNIDAD_MEDIDA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@UNIDAD_MEDIDA) + '</UNIDAD_MEDIDA>' +
				'</UNIDAD_DE_MEDIDA>'
 -- XML
			
			-- inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'UNIDADDEMEDIDAPOS600', 'ELIMINA', @PARAMETROS, 0, ''
			
			FETCH NEXT FROM C_DELETED INTO
			@UNIDAD_MEDIDA
		END
		CLOSE C_DELETED
		DEALLOCATE C_DELETED
	END
	
	IF (@@ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para eliminar de la tabla UNIDAD_DE_MEDIDA.',16,1 )
	END
END
;




CREATE TRIGGER $$Compania$$.UNIDAD_DE_MEDIDA_POS_MOD
ON $$Compania$$.UNIDAD_DE_MEDIDA
FOR UPDATE
AS
BEGIN   	
	DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @TIPO_SITIO_LOCAL VARCHAR(1)
	DECLARE @COL_ROWPOINTER VARCHAR(36)
	DECLARE @HAY_CAMPOS_PARA_POS BIT
	DECLARE @ACTUALIZAR_SOLICITUD BIT
	DECLARE @UNIDAD_MEDIDA VARCHAR(6)
	DECLARE @DESCRIPCION VARCHAR(40)
	 -- Declaraciones
	SET @ERROR = 0
	SELECT @PUBLICADOR = SITIO_LOCAL, @USUARIO_POS_WSQM = USUARIO_WSQM,
		@TIPO_SITIO_LOCAL = TIPO_SITIO_LOCAL
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)  AND @TIPO_SITIO_LOCAL = 'C'
	BEGIN
		DECLARE C_MODIFIED CURSOR LOCAL FOR
			SELECT UNIDAD_MEDIDA, DESCRIPCION -- Columnas
			FROM INSERTED I
		SET @ACTUALIZAR_SOLICITUD = 1
		OPEN C_MODIFIED
		FETCH NEXT FROM C_MODIFIED
		INTO @UNIDAD_MEDIDA, @DESCRIPCION
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			IF ( NOT UPDATE(RECORDDATE) AND ( UPDATE(UNIDAD_MEDIDA) OR UPDATE(DESCRIPCION) ) )
			BEGIN
				SELECT @COL_ROWPOINTER = ROWPOINTER
				FROM $$Compania$$.UNIDAD_DE_MEDIDA
				WHERE UNIDAD_MEDIDA = @UNIDAD_MEDIDA
				SET @PARAMETROS =
					'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<UNIDAD_DE_MEDIDA>' +
				'<UNIDAD_MEDIDA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@UNIDAD_MEDIDA) + '</UNIDAD_MEDIDA>' +
				'<DESCRIPCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DESCRIPCION) + '</DESCRIPCION>' +
				'</UNIDAD_DE_MEDIDA>'
				-- inserta la solicitud correspondiente
				EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'UNIDADDEMEDIDAPOS600', 'MODIFICA', @PARAMETROS, @ACTUALIZAR_SOLICITUD, @COL_ROWPOINTER
			END
			FETCH NEXT FROM C_MODIFIED
			INTO @UNIDAD_MEDIDA, @DESCRIPCION
		END
		CLOSE C_MODIFIED
		DEALLOCATE C_MODIFIED
	END
	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para modificar la tabla UNIDAD_DE_MEDIDA.',16,1 )
	END
END;




CREATE TRIGGER $$Compania$$.UNIDAD_FRACCION_POS_INS
ON $$Compania$$.UNIDAD_FRACCION
FOR INSERT
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @UNIDAD_MEDIDA VARCHAR(6)
	DECLARE @FRACCION VARCHAR(1)
	DECLARE @TIPO_SITIO_LOCAL VARCHAR(1)
	DECLARE @BALANZA_ELECTRONICA VARCHAR(1) 
	
	SELECT @PUBLICADOR = SITIO_LOCAL,
		@USUARIO_POS_WSQM = USUARIO_WSQM,
		@TIPO_SITIO_LOCAL = TIPO_SITIO_LOCAL
  	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM) AND @TIPO_SITIO_LOCAL = 'C'
	BEGIN
		DECLARE C_INSERTED CURSOR LOCAL FOR
		SELECT UNIDAD_MEDIDA, FRACCION, BALANZA_ELECTRONICA
		FROM INSERTED i
		WHERE 0 = (
				SELECT COUNT('n')
				FROM DELETED d
				WHERE i.UNIDAD_MEDIDA = d.UNIDAD_MEDIDA
			   )
			
		OPEN C_INSERTED	
		FETCH NEXT FROM C_INSERTED INTO
		@UNIDAD_MEDIDA, @FRACCION, @BALANZA_ELECTRONICA
		SET @ERROR = 0
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS =
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<UNIDAD_FRACCION>' +
				'<UNIDAD_MEDIDA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@UNIDAD_MEDIDA) + '</UNIDAD_MEDIDA>' +
				'<FRACCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@FRACCION) + '</FRACCION>' +
				'<BALANZA_ELECTRONICA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@BALANZA_ELECTRONICA) + '</BALANZA_ELECTRONICA>' +
				'</UNIDAD_FRACCION>'
			-- Inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'UNIDADFRACCIONPOS600', 'INSERTA', @PARAMETROS, 0, ''
			FETCH NEXT FROM C_INSERTED INTO
			@UNIDAD_MEDIDA, @FRACCION, @BALANZA_ELECTRONICA
		END
		CLOSE C_INSERTED
    		DEALLOCATE C_INSERTED
	END
	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla UNIDAD_FRACCION.',16,1 )
	END
END;




CREATE TRIGGER $$Compania$$.UNIDAD_FRACCION_POS_DEL
ON $$Compania$$.UNIDAD_FRACCION
FOR DELETE
AS
BEGIN   	
                DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @UNIDAD_MEDIDA VARCHAR(6)
	DECLARE @TIPO_SITIO_LOCAL VARCHAR(1)
	
	SELECT @PUBLICADOR = SITIO_LOCAL,
		@USUARIO_POS_WSQM = USUARIO_WSQM,
		@TIPO_SITIO_LOCAL = TIPO_SITIO_LOCAL
  	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM) AND @TIPO_SITIO_LOCAL = 'C'
	BEGIN
		DECLARE C_DELETED CURSOR LOCAL FOR
			SELECT UNIDAD_MEDIDA
			FROM DELETED d
			WHERE 0 = (
				SELECT COUNT('n')
				FROM INSERTED i
				WHERE d.UNIDAD_MEDIDA = i.UNIDAD_MEDIDA
			   )
		OPEN C_DELETED
		FETCH NEXT FROM C_DELETED INTO
		@UNIDAD_MEDIDA
		
		SET @ERROR = 0
		
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS =
								'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<UNIDAD_FRACCION>' +
				'<UNIDAD_MEDIDA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@UNIDAD_MEDIDA) + '</UNIDAD_MEDIDA>' +
				'</UNIDAD_FRACCION>'
 -- XML
			
			-- inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'UNIDADFRACCIONPOS600', 'ELIMINA', @PARAMETROS, 0, ''
			
			FETCH NEXT FROM C_DELETED INTO
			@UNIDAD_MEDIDA
		END
		CLOSE C_DELETED
		DEALLOCATE C_DELETED
	END
	
	IF (@@ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para eliminar de la tabla UNIDAD_FRACCION.',16,1 )
	END
END;





CREATE TRIGGER $$Compania$$.UNIDAD_FRACCION_POS_MOD
ON $$Compania$$.UNIDAD_FRACCION
FOR UPDATE
AS
BEGIN   	
	DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @COL_ROWPOINTER VARCHAR(36)
	DECLARE @HAY_CAMPOS_PARA_POS BIT
	DECLARE @ACTUALIZAR_SOLICITUD BIT
	DECLARE @UNIDAD_MEDIDA VARCHAR(6)
	DECLARE @FRACCION VARCHAR(1)
	DECLARE @TIPO_SITIO_LOCAL VARCHAR(1)
	DECLARE @BALANZA_ELECTRONICA VARCHAR(1) 

	SELECT @PUBLICADOR = SITIO_LOCAL,
		@USUARIO_POS_WSQM = USUARIO_WSQM,
		@TIPO_SITIO_LOCAL = TIPO_SITIO_LOCAL
  	FROM $$Compania$$.GLOBALES_POS
	SET @ERROR = 0
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM) AND @TIPO_SITIO_LOCAL = 'C'
	BEGIN
		DECLARE C_MODIFIED CURSOR LOCAL FOR
			SELECT UNIDAD_MEDIDA, FRACCION, BALANZA_ELECTRONICA -- Columnas
			FROM INSERTED I
		SET @ACTUALIZAR_SOLICITUD = 1
		OPEN C_MODIFIED
		FETCH NEXT FROM C_MODIFIED
		INTO @UNIDAD_MEDIDA, @FRACCION, @BALANZA_ELECTRONICA
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			IF ( NOT UPDATE(RECORDDATE) AND ( UPDATE(UNIDAD_MEDIDA) OR UPDATE(FRACCION) OR UPDATE(BALANZA_ELECTRONICA)) )
			BEGIN
				SELECT @COL_ROWPOINTER = ROWPOINTER
				FROM $$Compania$$.UNIDAD_FRACCION
				WHERE UNIDAD_MEDIDA = @UNIDAD_MEDIDA
				SET @PARAMETROS =
					'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<UNIDAD_FRACCION>' +
				'<UNIDAD_MEDIDA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@UNIDAD_MEDIDA) + '</UNIDAD_MEDIDA>' +
				'<FRACCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@FRACCION) + '</FRACCION>' +
				'<BALANZA_ELECTRONICA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@BALANZA_ELECTRONICA) + '</BALANZA_ELECTRONICA>' +
				'</UNIDAD_FRACCION>'
				-- inserta la solicitud correspondiente
				EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'UNIDADFRACCIONPOS600', 'MODIFICA', @PARAMETROS, @ACTUALIZAR_SOLICITUD, @COL_ROWPOINTER
			END
			FETCH NEXT FROM C_MODIFIED
			INTO @UNIDAD_MEDIDA, @FRACCION, @BALANZA_ELECTRONICA
		END
		CLOSE C_MODIFIED
		DEALLOCATE C_MODIFIED
	END
	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para modificar la tabla UNIDAD_FRACCION.',16,1 )
	END
END;




CREATE TRIGGER $$Compania$$.USUARIO_BODEGA_POS_INS
ON $$Compania$$.USUARIO_BODEGA
FOR INSERT
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @BODEGA VARCHAR(4)
	DECLARE @USUARIO VARCHAR(25)
	
	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM 
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_INSERTED CURSOR LOCAL FOR
		SELECT BODEGA, USUARIO
		FROM INSERTED i
		WHERE 0 = (
				SELECT COUNT('n')
				FROM DELETED d
				WHERE i.BODEGA = d.BODEGA AND i.USUARIO = d.USUARIO
			   )
			
		OPEN C_INSERTED	
		FETCH NEXT FROM C_INSERTED INTO
		@BODEGA, @USUARIO
		SET @ERROR = 0
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS = 
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<USUARIO_BODEGA>' + 
				'<BODEGA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@BODEGA) + '</BODEGA>' + 
				'<USUARIO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@USUARIO) + '</USUARIO>' + 
				'</USUARIO_BODEGA>'
			-- Inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'USUARIOBODEGAPOS600', 'INSERTA', @PARAMETROS, 0, ''
			FETCH NEXT FROM C_INSERTED INTO
			@BODEGA, @USUARIO
		END
		CLOSE C_INSERTED
    		DEALLOCATE C_INSERTED
	END
	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla USUARIO_BODEGA.',16,1 )
	END
END;




CREATE TRIGGER $$Compania$$.USUARIO_BODEGA_POS_DEL
ON $$Compania$$.USUARIO_BODEGA
FOR DELETE  
AS 
BEGIN   	
                DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @BODEGA VARCHAR(4)
	DECLARE @USUARIO VARCHAR(25)
	 -- Declaraciones	
	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM 
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_DELETED CURSOR LOCAL FOR
			SELECT BODEGA, USUARIO
			FROM DELETED d
			WHERE 0 = (
				SELECT COUNT('n')
				FROM INSERTED i
				WHERE d.BODEGA = i.BODEGA AND d.USUARIO = i.USUARIO
			   )
		OPEN C_DELETED
		FETCH NEXT FROM C_DELETED INTO 
		@BODEGA, @USUARIO -- VARIABLES
		
		SET @ERROR = 0
		
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS = 
								'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<USUARIO_BODEGA>' + 
				'<BODEGA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@BODEGA) + '</BODEGA>' + 
				'<USUARIO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@USUARIO) + '</USUARIO>' + 
				'</USUARIO_BODEGA>'
 -- XML
			
			-- inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'USUARIOBODEGAPOS600', 'ELIMINA', @PARAMETROS, 0, ''
			
			FETCH NEXT FROM C_DELETED INTO 
			@BODEGA, @USUARIO -- VARIABLES
		END
		CLOSE C_DELETED
		DEALLOCATE C_DELETED
	END
	
	IF (@@ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para eliminar de la tabla USUARIO_BODEGA.',16,1 )
	END
END;





CREATE TRIGGER $$Compania$$.USUARIO_BODEGA_POS_MOD
ON $$Compania$$.USUARIO_BODEGA
FOR UPDATE
AS 
BEGIN   	
	DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @COL_ROWPOINTER VARCHAR(36)
	DECLARE @HAY_CAMPOS_PARA_POS BIT
	DECLARE @ACTUALIZAR_SOLICITUD BIT
	DECLARE @BODEGA VARCHAR(4)
	DECLARE @USUARIO VARCHAR(25)
	 -- Declaraciones
	SET @ERROR = 0
	SELECT @PUBLICADOR = SITIO_LOCAL, @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_MODIFIED CURSOR LOCAL FOR
			SELECT BODEGA, USUARIO -- Columnas
			FROM INSERTED I
		SET @ACTUALIZAR_SOLICITUD = 1
		OPEN C_MODIFIED
		FETCH NEXT FROM C_MODIFIED
		INTO @BODEGA, @USUARIO
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			IF ( NOT UPDATE(RECORDDATE) AND ( UPDATE(BODEGA) OR UPDATE(USUARIO) ) )
			BEGIN
				SELECT @COL_ROWPOINTER = ROWPOINTER 
				FROM $$Compania$$.USUARIO_BODEGA
				WHERE BODEGA = @BODEGA AND USUARIO = @USUARIO 
				SET @PARAMETROS =
					'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<USUARIO_BODEGA>' + 
				'<BODEGA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@BODEGA) + '</BODEGA>' + 
				'<USUARIO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@USUARIO) + '</USUARIO>' + 
				'</USUARIO_BODEGA>'
				-- inserta la solicitud correspondiente
				EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'USUARIOBODEGAPOS600', 'MODIFICA', @PARAMETROS, @ACTUALIZAR_SOLICITUD, @COL_ROWPOINTER
			END
			FETCH NEXT FROM C_MODIFIED
			INTO @BODEGA, @USUARIO
		END
		CLOSE C_MODIFIED
		DEALLOCATE C_MODIFIED
	END
	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para modificar la tabla USUARIO_BODEGA.',16,1 )
	END
END;




CREATE TRIGGER $$Compania$$.VENDEDOR_POS_INS
ON $$Compania$$.VENDEDOR
FOR INSERT
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @VENDEDOR VARCHAR(4)
	DECLARE @NOMBRE VARCHAR(40)
	DECLARE @EMPLEADO VARCHAR(25)
	DECLARE @COMISION DECIMAL(28,8)
	DECLARE @CTR_COMISION VARCHAR(25)
	DECLARE @CTA_COMISION VARCHAR(25)
	DECLARE @E_MAIL VARCHAR(40)
	DECLARE @ACTIVO VARCHAR(1)

	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM 
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_INSERTED CURSOR LOCAL FOR
		SELECT VENDEDOR, NOMBRE, EMPLEADO, COMISION, CTR_COMISION, CTA_COMISION, E_MAIL, ACTIVO
		FROM INSERTED i
		WHERE 0 = (
				SELECT COUNT('n')
				FROM DELETED d
				WHERE i.VENDEDOR = d.VENDEDOR
			   )
		OPEN C_INSERTED	
		FETCH NEXT FROM C_INSERTED INTO
		@VENDEDOR, @NOMBRE, @EMPLEADO, @COMISION, @CTR_COMISION, @CTA_COMISION, @E_MAIL, @ACTIVO
		SET @ERROR = 0
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS = 
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<VENDEDOR>' + 
				'<VENDEDOR Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@VENDEDOR) + '</VENDEDOR>' + 
				'<NOMBRE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOMBRE) + '</NOMBRE>' + 
				'<EMPLEADO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@EMPLEADO) + '</EMPLEADO>' + 
				'<COMISION Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@COMISION) + '</COMISION>' + 
				'<CTR_COMISION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_COMISION) + '</CTR_COMISION>' + 
				'<CTA_COMISION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_COMISION) + '</CTA_COMISION>' + 
				'<E_MAIL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@E_MAIL) + '</E_MAIL>' + 
				'<ACTIVO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ACTIVO) + '</ACTIVO>' + 
				'</VENDEDOR>'
			-- Inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'VENDEDORPOS600', 'INSERTA', @PARAMETROS, 0, ''
			FETCH NEXT FROM C_INSERTED INTO
			@VENDEDOR, @NOMBRE, @EMPLEADO, @COMISION, @CTR_COMISION, @CTA_COMISION, @E_MAIL, @ACTIVO
		END
		CLOSE C_INSERTED
    		DEALLOCATE C_INSERTED
	END
	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla VENDEDOR.',16,1 )
	END
END;





CREATE TRIGGER $$Compania$$.VENDEDOR_POS_DEL
ON $$Compania$$.VENDEDOR
FOR DELETE  
AS 
BEGIN   	
	DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @VENDEDOR VARCHAR(4)
	 -- Declaraciones	
	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM 
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_DELETED CURSOR LOCAL FOR
			SELECT VENDEDOR
			FROM DELETED d
			WHERE 0 = (
				SELECT COUNT('n')
				FROM INSERTED i
				WHERE d.VENDEDOR = i.VENDEDOR
			   )
		OPEN C_DELETED
		FETCH NEXT FROM C_DELETED INTO 
		@VENDEDOR
		SET @ERROR = 0
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS = 
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<VENDEDOR>' + 
				'<VENDEDOR Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@VENDEDOR) + '</VENDEDOR>' + 
				'</VENDEDOR>'
			-- inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'VENDEDORPOS600', 'ELIMINA', @PARAMETROS, 0, ''
			FETCH NEXT FROM C_DELETED INTO 
			@VENDEDOR
		END
		CLOSE C_DELETED
		DEALLOCATE C_DELETED
	END
	IF (@@ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para eliminar de la tabla VENDEDOR.',16,1 )
	END
END;



CREATE TRIGGER $$Compania$$.VENDEDOR_POS_MOD
ON $$Compania$$.VENDEDOR
FOR UPDATE
AS 
BEGIN   	
	DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @COL_ROWPOINTER VARCHAR(36)
	DECLARE @HAY_CAMPOS_PARA_POS BIT
	DECLARE @ACTUALIZAR_SOLICITUD BIT
	DECLARE @VENDEDOR VARCHAR(4)
	DECLARE @NOMBRE VARCHAR(40)
	DECLARE @EMPLEADO VARCHAR(20)
	DECLARE @COMISION DECIMAL(28,8)
	DECLARE @CTR_COMISION VARCHAR(25)
	DECLARE @CTA_COMISION VARCHAR(25)
	DECLARE @E_MAIL VARCHAR(249)
	DECLARE @ACTIVO VARCHAR(1)
	 -- Declaraciones

	SET @ERROR = 0

	SELECT @PUBLICADOR = SITIO_LOCAL, @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_MODIFIED CURSOR LOCAL FOR
			SELECT VENDEDOR, NOMBRE, EMPLEADO, COMISION, CTR_COMISION, CTA_COMISION, E_MAIL, ACTIVO -- Columnas
			FROM INSERTED I

		SET @ACTUALIZAR_SOLICITUD = 1

		OPEN C_MODIFIED

		FETCH NEXT FROM C_MODIFIED
		INTO @VENDEDOR, @NOMBRE, @EMPLEADO, @COMISION, @CTR_COMISION, @CTA_COMISION, @E_MAIL, @ACTIVO

		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			IF ( NOT UPDATE(RECORDDATE) AND ( UPDATE(VENDEDOR) OR UPDATE(NOMBRE) OR UPDATE(EMPLEADO) OR UPDATE(COMISION) OR UPDATE(CTR_COMISION) OR UPDATE(CTA_COMISION) OR UPDATE(E_MAIL) OR UPDATE(ACTIVO) ) )
			BEGIN

				SELECT @COL_ROWPOINTER = ROWPOINTER 
				FROM $$Compania$$.VENDEDOR
				WHERE VENDEDOR = @VENDEDOR 

				SET @PARAMETROS =
					'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<VENDEDOR>' + 
				'<VENDEDOR Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@VENDEDOR) + '</VENDEDOR>' + 
				'<NOMBRE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOMBRE) + '</NOMBRE>' + 
				'<EMPLEADO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@EMPLEADO) + '</EMPLEADO>' + 
				'<COMISION Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@COMISION) + '</COMISION>' + 
				'<CTR_COMISION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTR_COMISION) + '</CTR_COMISION>' + 
				'<CTA_COMISION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CTA_COMISION) + '</CTA_COMISION>' + 
				'<E_MAIL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@E_MAIL) + '</E_MAIL>' + 
				'<ACTIVO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ACTIVO) + '</ACTIVO>' + 
				'</VENDEDOR>'


				-- inserta la solicitud correspondiente
				EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'VENDEDORPOS600', 'MODIFICA', @PARAMETROS, @ACTUALIZAR_SOLICITUD, @COL_ROWPOINTER
			END

			FETCH NEXT FROM C_MODIFIED
			INTO @VENDEDOR, @NOMBRE, @EMPLEADO, @COMISION, @CTR_COMISION, @CTA_COMISION, @E_MAIL, @ACTIVO
		END

		CLOSE C_MODIFIED
		DEALLOCATE C_MODIFIED
	END

	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para modificar la tabla VENDEDOR.',16,1 )
	END
END;



CREATE TRIGGER $$Compania$$.VERSION_NIVEL_POS_INS
ON $$Compania$$.VERSION_NIVEL
FOR INSERT
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @MODULO_OFFLINE INT
	DECLARE @NIVEL_PRECIO VARCHAR(12)
	DECLARE @MONEDA VARCHAR(1)
	DECLARE @VERSION INT
	DECLARE @FECHA_INICIO DATETIME
	DECLARE @FECHA_CORTE DATETIME
	DECLARE @ESTADO VARCHAR(1)
	DECLARE @USUARIO_CREACION VARCHAR(25)
	DECLARE @FCH_HORA_CREACION DATETIME
	DECLARE @USUARIO_ULT_MODIF VARCHAR(25)
	DECLARE @FCH_HORA_ULT_MODIF DATETIME
	DECLARE @USUARIO_APROBACION VARCHAR(25)
	DECLARE @FCH_HORA_APROBACIO DATETIME
	DECLARE @USUARIO_ANULACION VARCHAR(25)
	DECLARE @FCH_HORA_ANULACION DATETIME
	DECLARE @IDENTIFICADOR VARCHAR(10)
	DECLARE @IMPUESTO1_INCLUIDO VARCHAR(1)
	
	
	SELECT @MODULO_OFFLINE = COUNT(0)
	FROM ERPADMIN.MODULO_INSTALADO
	WHERE UPPER(CONJUNTO) = UPPER('$$Compania$$')
	AND ACCION = 3159

	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM 
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF @MODULO_OFFLINE  = 1 AND NOT (SYSTEM_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_INSERTED CURSOR LOCAL FOR
		SELECT NIVEL_PRECIO, MONEDA, VERSION, FECHA_INICIO, FECHA_CORTE, ESTADO, USUARIO_CREACION, FCH_HORA_CREACION, USUARIO_ULT_MODIF, FCH_HORA_ULT_MODIF, USUARIO_APROBACION, FCH_HORA_APROBACIO, USUARIO_ANULACION, FCH_HORA_ANULACION, IDENTIFICADOR, IMPUESTO1_INCLUIDO
		FROM INSERTED
				
		OPEN C_INSERTED	
		FETCH NEXT FROM C_INSERTED INTO
		@NIVEL_PRECIO, @MONEDA, @VERSION, @FECHA_INICIO, @FECHA_CORTE, @ESTADO, @USUARIO_CREACION, @FCH_HORA_CREACION, @USUARIO_ULT_MODIF, @FCH_HORA_ULT_MODIF, @USUARIO_APROBACION, @FCH_HORA_APROBACIO, @USUARIO_ANULACION, @FCH_HORA_ANULACION, @IDENTIFICADOR, @IMPUESTO1_INCLUIDO

		SET @ERROR = 0
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS = 
			'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<VERSION_NIVEL>' + 
				'<NIVEL_PRECIO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@NIVEL_PRECIO) + '</NIVEL_PRECIO>' + 
				'<MONEDA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@MONEDA) + '</MONEDA>' + 
				'<VERSION Type="INT" PrimaryKey="True">' + ERPADMIN.POS_NumberToVarchar(@VERSION) + '</VERSION>' + 
				'<FECHA_INICIO Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_INICIO) + '</FECHA_INICIO>' + 
				'<FECHA_CORTE Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_CORTE) + '</FECHA_CORTE>' + 
				'<ESTADO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ESTADO) + '</ESTADO>' + 
				'<USUARIO_CREACION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USUARIO_CREACION) + '</USUARIO_CREACION>' + 
				'<FCH_HORA_CREACION Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FCH_HORA_CREACION) + '</FCH_HORA_CREACION>' + 
				'<USUARIO_ULT_MODIF Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USUARIO_ULT_MODIF) + '</USUARIO_ULT_MODIF>' + 
				'<FCH_HORA_ULT_MODIF Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FCH_HORA_ULT_MODIF) + '</FCH_HORA_ULT_MODIF>' + 
				'<USUARIO_APROBACION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USUARIO_APROBACION) + '</USUARIO_APROBACION>' + 
				'<FCH_HORA_APROBACIO Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FCH_HORA_APROBACIO) + '</FCH_HORA_APROBACIO>' + 
				'<USUARIO_ANULACION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USUARIO_ANULACION) + '</USUARIO_ANULACION>' + 
				'<FCH_HORA_ANULACION Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FCH_HORA_ANULACION) + '</FCH_HORA_ANULACION>' + 
				'<IDENTIFICADOR Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@IDENTIFICADOR) + '</IDENTIFICADOR>' + 
				'<IMPUESTO1_INCLUIDO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@IMPUESTO1_INCLUIDO) + '</IMPUESTO1_INCLUIDO>' + 
				'</VERSION_NIVEL>'


			-- Inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'VERSIONNIVELPOS600', 'INSERTA', @PARAMETROS, 0, ''

			FETCH NEXT FROM C_INSERTED INTO
			@NIVEL_PRECIO, @MONEDA, @VERSION, @FECHA_INICIO, @FECHA_CORTE, @ESTADO, @USUARIO_CREACION, @FCH_HORA_CREACION, @USUARIO_ULT_MODIF, @FCH_HORA_ULT_MODIF, @USUARIO_APROBACION, @FCH_HORA_APROBACIO, @USUARIO_ANULACION, @FCH_HORA_ANULACION, @IDENTIFICADOR, @IMPUESTO1_INCLUIDO
		END

		CLOSE C_INSERTED
    		DEALLOCATE C_INSERTED
	END

	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla VERSION_NIVEL.',16,1 )
	END
END;






CREATE TRIGGER $$Compania$$.VERSION_NIVEL_POS_DEL
ON $$Compania$$.VERSION_NIVEL
FOR DELETE  
AS 
BEGIN   	
                DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @NIVEL_PRECIO VARCHAR(12)
	DECLARE @MONEDA VARCHAR(1)
	DECLARE @VERSION INT
	 -- Declaraciones	
	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM 
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_DELETED CURSOR LOCAL FOR
			SELECT NIVEL_PRECIO, MONEDA, VERSION
			FROM DELETED d
			WHERE 0 = (
				SELECT COUNT('n')
				FROM INSERTED i
				WHERE d.NIVEL_PRECIO = i.NIVEL_PRECIO AND d.MONEDA = i.MONEDA AND d.VERSION = i.VERSION
			   )
		OPEN C_DELETED
		FETCH NEXT FROM C_DELETED INTO 
		@NIVEL_PRECIO, @MONEDA, @VERSION
		SET @ERROR = 0
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS = 
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<VERSION_NIVEL>' + 
				'<NIVEL_PRECIO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@NIVEL_PRECIO) + '</NIVEL_PRECIO>' + 
				'<MONEDA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@MONEDA) + '</MONEDA>' + 
				'<VERSION Type="INT" PrimaryKey="True">' + ERPADMIN.POS_NumberToVarchar(@VERSION) + '</VERSION>' + 
				'</VERSION_NIVEL>'
			-- inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'VERSIONNIVELPOS600', 'ELIMINA', @PARAMETROS, 0, ''
			FETCH NEXT FROM C_DELETED INTO 
			@NIVEL_PRECIO, @MONEDA, @VERSION
		END
		CLOSE C_DELETED
		DEALLOCATE C_DELETED
	END
	IF (@@ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para eliminar de la tabla VERSION_NIVEL.',16,1 )
	END
END;



CREATE TRIGGER $$Compania$$.VERSION_NIVEL_POS_MOD
ON $$Compania$$.VERSION_NIVEL
FOR UPDATE
AS 
BEGIN   	
	DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @COL_ROWPOINTER VARCHAR(36)
	DECLARE @HAY_CAMPOS_PARA_POS BIT
	DECLARE @ACTUALIZAR_SOLICITUD BIT
	DECLARE @MODULO_OFFLINE INT
	DECLARE @NIVEL_PRECIO VARCHAR(12)
	DECLARE @MONEDA VARCHAR(1)
	DECLARE @VERSION INT
	DECLARE @FECHA_INICIO DATETIME
	DECLARE @FECHA_CORTE DATETIME
	DECLARE @ESTADO VARCHAR(1)
	DECLARE @USUARIO_CREACION VARCHAR(25)
	DECLARE @FCH_HORA_CREACION DATETIME
	DECLARE @USUARIO_ULT_MODIF VARCHAR(25)
	DECLARE @FCH_HORA_ULT_MODIF DATETIME
	DECLARE @USUARIO_APROBACION VARCHAR(25)
	DECLARE @FCH_HORA_APROBACIO DATETIME
	DECLARE @USUARIO_ANULACION VARCHAR(25)
	DECLARE @FCH_HORA_ANULACION DATETIME
	DECLARE @IDENTIFICADOR VARCHAR(10)
	DECLARE @IMPUESTO1_INCLUIDO VARCHAR(1)
	 -- Declaraciones

	SET @ERROR = 0
	
	SELECT @MODULO_OFFLINE = COUNT(0)
	FROM ERPADMIN.MODULO_INSTALADO
	WHERE UPPER(CONJUNTO) = UPPER('$$Compania$$')
	AND ACCION = 3159

	SELECT @PUBLICADOR = SITIO_LOCAL, @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF @MODULO_OFFLINE  = 1 AND NOT (SYSTEM_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_MODIFIED CURSOR LOCAL FOR
			SELECT NIVEL_PRECIO, MONEDA, VERSION, FECHA_INICIO, FECHA_CORTE, ESTADO, USUARIO_CREACION, FCH_HORA_CREACION, USUARIO_ULT_MODIF, FCH_HORA_ULT_MODIF, USUARIO_APROBACION, FCH_HORA_APROBACIO, USUARIO_ANULACION, FCH_HORA_ANULACION, IDENTIFICADOR, IMPUESTO1_INCLUIDO -- Columnas
			FROM INSERTED I

		SET @ACTUALIZAR_SOLICITUD = 1

		OPEN C_MODIFIED

		FETCH NEXT FROM C_MODIFIED
		INTO @NIVEL_PRECIO, @MONEDA, @VERSION, @FECHA_INICIO, @FECHA_CORTE, @ESTADO, @USUARIO_CREACION, @FCH_HORA_CREACION, @USUARIO_ULT_MODIF, @FCH_HORA_ULT_MODIF, @USUARIO_APROBACION, @FCH_HORA_APROBACIO, @USUARIO_ANULACION, @FCH_HORA_ANULACION, @IDENTIFICADOR, @IMPUESTO1_INCLUIDO

		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			IF ( NOT UPDATE(RECORDDATE) AND ( UPDATE(NIVEL_PRECIO) OR UPDATE(MONEDA) OR UPDATE(VERSION) OR UPDATE(FECHA_INICIO) OR UPDATE(FECHA_CORTE) OR UPDATE(ESTADO) OR UPDATE(USUARIO_CREACION) OR UPDATE(FCH_HORA_CREACION) OR UPDATE(USUARIO_ULT_MODIF) OR UPDATE(FCH_HORA_ULT_MODIF) OR UPDATE(USUARIO_APROBACION) OR UPDATE(FCH_HORA_APROBACIO) OR UPDATE(USUARIO_ANULACION) OR UPDATE(FCH_HORA_ANULACION) OR UPDATE(IDENTIFICADOR) OR UPDATE(IMPUESTO1_INCLUIDO) ) )
			BEGIN

				SELECT @COL_ROWPOINTER = ROWPOINTER 
				FROM $$Compania$$.VERSION_NIVEL
				WHERE NIVEL_PRECIO = @NIVEL_PRECIO AND MONEDA = @MONEDA AND VERSION = @VERSION 

				SET @PARAMETROS =
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<VERSION_NIVEL>' + 
				'<NIVEL_PRECIO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@NIVEL_PRECIO) + '</NIVEL_PRECIO>' + 
				'<MONEDA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@MONEDA) + '</MONEDA>' + 
				'<VERSION Type="INT" PrimaryKey="True">' + ERPADMIN.POS_NumberToVarchar(@VERSION) + '</VERSION>' + 
				'<FECHA_INICIO Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_INICIO) + '</FECHA_INICIO>' + 
				'<FECHA_CORTE Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_CORTE) + '</FECHA_CORTE>' + 
				'<ESTADO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ESTADO) + '</ESTADO>' + 
				'<USUARIO_CREACION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USUARIO_CREACION) + '</USUARIO_CREACION>' + 
				'<FCH_HORA_CREACION Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FCH_HORA_CREACION) + '</FCH_HORA_CREACION>' + 
				'<USUARIO_ULT_MODIF Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USUARIO_ULT_MODIF) + '</USUARIO_ULT_MODIF>' + 
				'<FCH_HORA_ULT_MODIF Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FCH_HORA_ULT_MODIF) + '</FCH_HORA_ULT_MODIF>' + 
				'<USUARIO_APROBACION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USUARIO_APROBACION) + '</USUARIO_APROBACION>' + 
				'<FCH_HORA_APROBACIO Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FCH_HORA_APROBACIO) + '</FCH_HORA_APROBACIO>' + 
				'<USUARIO_ANULACION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USUARIO_ANULACION) + '</USUARIO_ANULACION>' + 
				'<FCH_HORA_ANULACION Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FCH_HORA_ANULACION) + '</FCH_HORA_ANULACION>' + 
				'<IDENTIFICADOR Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@IDENTIFICADOR) + '</IDENTIFICADOR>' + 
				'<IMPUESTO1_INCLUIDO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@IMPUESTO1_INCLUIDO) + '</IMPUESTO1_INCLUIDO>' + 
				'</VERSION_NIVEL>'


				-- inserta la solicitud correspondiente
				EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'VERSIONNIVELPOS600', 'MODIFICA', @PARAMETROS, @ACTUALIZAR_SOLICITUD, @COL_ROWPOINTER
			END

			FETCH NEXT FROM C_MODIFIED
			INTO @NIVEL_PRECIO, @MONEDA, @VERSION, @FECHA_INICIO, @FECHA_CORTE, @ESTADO, @USUARIO_CREACION, @FCH_HORA_CREACION, @USUARIO_ULT_MODIF, @FCH_HORA_ULT_MODIF, @USUARIO_APROBACION, @FCH_HORA_APROBACIO, @USUARIO_ANULACION, @FCH_HORA_ANULACION, @IDENTIFICADOR, @IMPUESTO1_INCLUIDO
		END

		CLOSE C_MODIFIED
		DEALLOCATE C_MODIFIED
	END

	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para modificar la tabla VERSION_NIVEL.',16,1 )
	END
END;




CREATE TRIGGER $$Compania$$.ERROR_CAJA_POS_INS
ON $$Compania$$.ERROR_CAJA
FOR INSERT
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @CAJA VARCHAR(6)
	DECLARE @ERROR_CAJA INT
	DECLARE @TIPO VARCHAR(1)
	DECLARE @CAJERO VARCHAR(25)
	DECLARE @FECHA_HORA DATETIME
	DECLARE @MENSAJE VARCHAR(4000)
	DECLARE @ESTADO VARCHAR(1)
	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM 
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_INSERTED CURSOR LOCAL FOR
		SELECT CAJA, ERROR_CAJA, TIPO, CAJERO, FECHA_HORA, MENSAJE, ESTADO
		FROM INSERTED i
		WHERE 0 = (
				SELECT COUNT('n')
				FROM DELETED d
				WHERE i.CAJA = d.CAJA AND i.ERROR_CAJA = d.ERROR_CAJA
			   )
		OPEN C_INSERTED	
		FETCH NEXT FROM C_INSERTED INTO
		@CAJA, @ERROR_CAJA, @TIPO, @CAJERO, @FECHA_HORA, @MENSAJE, @ESTADO
		SET @ERROR = 0
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS = 
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<ERROR_CAJA>' + 
				'<CAJA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CAJA) + '</CAJA>' + 
				'<ERROR_CAJA Type="INT" PrimaryKey="True">' + ERPADMIN.POS_NumberToVarchar(@ERROR_CAJA) + '</ERROR_CAJA>' + 
				'<TIPO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO) + '</TIPO>' + 
				'<CAJERO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CAJERO) + '</CAJERO>' + 
				'<FECHA_HORA Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_HORA) + '</FECHA_HORA>' + 
				'<MENSAJE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@MENSAJE) + '</MENSAJE>' + 
				'<ESTADO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ESTADO) + '</ESTADO>' + 
				'</ERROR_CAJA>'
			-- Inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'ERRORCAJAPOS600', 'INSERTA', @PARAMETROS, 0, ''
			FETCH NEXT FROM C_INSERTED INTO
			@CAJA, @ERROR_CAJA, @TIPO, @CAJERO, @FECHA_HORA, @MENSAJE, @ESTADO
		END
		CLOSE C_INSERTED
    		DEALLOCATE C_INSERTED
	END
	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla ERROR_CAJA.',16,1 )
	END
END;




CREATE TRIGGER $$Compania$$.ERROR_CAJA_POS_MOD
ON $$Compania$$.ERROR_CAJA
FOR UPDATE
AS 
BEGIN   	
	DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @COL_ROWPOINTER VARCHAR(36)
	DECLARE @HAY_CAMPOS_PARA_POS BIT
	DECLARE @ACTUALIZAR_SOLICITUD BIT
	DECLARE @CAJA VARCHAR(6)
	DECLARE @ERROR_CAJA INT
	DECLARE @TIPO VARCHAR(1)
	DECLARE @CAJERO VARCHAR(25)
	DECLARE @FECHA_HORA DATETIME
	DECLARE @MENSAJE VARCHAR(4000)
	DECLARE @ESTADO VARCHAR(1)
	 -- Declaraciones
	SET @ERROR = 0
	SELECT @PUBLICADOR = SITIO_LOCAL, @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS
	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_MODIFIED CURSOR LOCAL FOR
			SELECT CAJA, ERROR_CAJA, TIPO, CAJERO, FECHA_HORA, MENSAJE, ESTADO -- Columnas
			FROM INSERTED I
		SET @ACTUALIZAR_SOLICITUD = 1
		OPEN C_MODIFIED
		FETCH NEXT FROM C_MODIFIED
		INTO @CAJA, @ERROR_CAJA, @TIPO, @CAJERO, @FECHA_HORA, @MENSAJE, @ESTADO
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			IF ( NOT UPDATE(RECORDDATE)  )
			BEGIN
				SELECT @COL_ROWPOINTER = ROWPOINTER 
				FROM $$Compania$$.ERROR_CAJA
				WHERE CAJA = @CAJA AND ERROR_CAJA = @ERROR_CAJA 
				SET @PARAMETROS =
					'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<ERROR_CAJA>' + 
				'<CAJA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CAJA) + '</CAJA>' + 
				'<ERROR_CAJA Type="INT" PrimaryKey="True">' + ERPADMIN.POS_NumberToVarchar(@ERROR_CAJA) + '</ERROR_CAJA>' + 
				'<TIPO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO) + '</TIPO>' + 
				'<CAJERO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CAJERO) + '</CAJERO>' + 
				'<FECHA_HORA Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_HORA) + '</FECHA_HORA>' + 
				'<MENSAJE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@MENSAJE) + '</MENSAJE>' + 
				'<ESTADO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ESTADO) + '</ESTADO>' + 
				'</ERROR_CAJA>'
				-- inserta la solicitud correspondiente
				EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'ERRORCAJAPOS600', 'MODIFICA', @PARAMETROS, @ACTUALIZAR_SOLICITUD, @COL_ROWPOINTER
			END
			FETCH NEXT FROM C_MODIFIED
			INTO @CAJA, @ERROR_CAJA, @TIPO, @CAJERO, @FECHA_HORA, @MENSAJE, @ESTADO
		END
		CLOSE C_MODIFIED
		DEALLOCATE C_MODIFIED
	END
	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para modificar la tabla ERROR_CAJA.',16,1 )
	END
END
;


CREATE TRIGGER $$Compania$$.ERROR_CAJA_POS_DEL
ON $$Compania$$.ERROR_CAJA
FOR DELETE  
AS 
BEGIN   	
        DECLARE @ERROR  int
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @CAJA VARCHAR(6)
	DECLARE @ERROR_CAJA INT
	DECLARE @TIPO VARCHAR(1)
	DECLARE @CAJERO VARCHAR(25)
	DECLARE @FECHA_HORA DATETIME
	DECLARE @MENSAJE VARCHAR(4000)
	DECLARE @ESTADO VARCHAR(1)
	 -- Declaraciones	

	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM 
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_DELETED CURSOR LOCAL FOR
			SELECT CAJA, ERROR_CAJA
			FROM DELETED d

		OPEN C_DELETED
		FETCH NEXT FROM C_DELETED INTO 
		@CAJA, @ERROR_CAJA -- VARIABLES
		
		SET @ERROR = 0
		
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS = 
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<ERROR_CAJA>' + 
				'<CAJA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CAJA) + '</CAJA>' + 
				'<ERROR_CAJA Type="INT" PrimaryKey="True">' + ERPADMIN.POS_NumberToVarchar(@ERROR_CAJA) + '</ERROR_CAJA>' + 
				'</ERROR_CAJA>'
 
			
			-- inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'ERRORCAJAPOS600', 'ELIMINA', @PARAMETROS, 0, ''
			
			FETCH NEXT FROM C_DELETED INTO 
			@CAJA, @ERROR_CAJA -- VARIABLES
		END

		CLOSE C_DELETED
		DEALLOCATE C_DELETED
	END
	
	IF (@@ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para eliminar de la tabla ERROR_CAJA.',16,1 )
	END
END;



CREATE TRIGGER $$Compania$$.GLOBALES_POS_INS
ON $$Compania$$.GLOBALES
FOR INSERT
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @MODULO VARCHAR(20)
	DECLARE @NOMBRE VARCHAR(30)
	DECLARE @TIPO VARCHAR(1)
	DECLARE @VALOR VARCHAR(250)
	DECLARE @TIPO_SITIO_LOCAL VARCHAR(1)
	

	SELECT	@PUBLICADOR = SITIO_LOCAL,
		@USUARIO_POS_WSQM = USUARIO_WSQM ,
		@TIPO_SITIO_LOCAL = TIPO_SITIO_LOCAL
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM) AND @TIPO_SITIO_LOCAL = 'C'
	BEGIN
		DECLARE C_INSERTED CURSOR LOCAL FOR
		SELECT MODULO, NOMBRE, TIPO, VALOR
		FROM INSERTED i
		WHERE 0 = (
				SELECT COUNT('n')
				FROM DELETED d
				WHERE i.RowPointer = d.RowPointer
			   )
			
		OPEN C_INSERTED	
		FETCH NEXT FROM C_INSERTED INTO
		@MODULO, @NOMBRE, @TIPO, @VALOR

		SET @ERROR = 0
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS = 
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<GLOBALES>' + 
				'<MODULO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@MODULO) + '</MODULO>' + 
				'<NOMBRE Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@NOMBRE) + '</NOMBRE>' + 
				'<TIPO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO) + '</TIPO>' + 
				'<VALOR Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@VALOR) + '</VALOR>' + 
				'</GLOBALES>'


			-- Inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'GLOBALESPOS600', 'INSERTA', @PARAMETROS, 0, ''

			FETCH NEXT FROM C_INSERTED INTO
			@MODULO, @NOMBRE, @TIPO, @VALOR
		END

		CLOSE C_INSERTED
    		DEALLOCATE C_INSERTED
	END

	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla GLOBALES.',16,1 )
	END
END;




CREATE TRIGGER $$Compania$$.GLOBALES_POS_DEL
ON $$Compania$$.GLOBALES
FOR DELETE  
AS 
BEGIN   	
                DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @MODULO VARCHAR(20)
	DECLARE @NOMBRE VARCHAR(30)
	DECLARE @TIPO_SITIO_LOCAL VARCHAR(1)
	 -- Declaraciones	

	SELECT	@PUBLICADOR = SITIO_LOCAL,
		@USUARIO_POS_WSQM = USUARIO_WSQM,
		@TIPO_SITIO_LOCAL = TIPO_SITIO_LOCAL
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM) AND @TIPO_SITIO_LOCAL = 'C'
	BEGIN
		DECLARE C_DELETED CURSOR LOCAL FOR
			SELECT MODULO, NOMBRE
			FROM DELETED d
			WHERE 0 = (
				SELECT COUNT('n')
				FROM INSERTED i
				WHERE d.RowPointer = i.RowPointer
			   )

		OPEN C_DELETED
		FETCH NEXT FROM C_DELETED INTO 
		@MODULO, @NOMBRE   -- VARIABLES
		
		SET @ERROR = 0
		
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS = 
								'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<GLOBALES>' + 
				'<MODULO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@MODULO) + '</MODULO>' + 
				'<NOMBRE Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@NOMBRE) + '</NOMBRE>' + 
				'</GLOBALES>'
 -- XML
			
			-- inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'GLOBALESPOS600', 'ELIMINA', @PARAMETROS, 0, ''
			
			FETCH NEXT FROM C_DELETED INTO 
			@MODULO, @NOMBRE  -- VARIABLES
		END

		CLOSE C_DELETED
		DEALLOCATE C_DELETED
	END
	
	IF (@@ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para eliminar de la tabla GLOBALES.',16,1 )
	END
END;




CREATE TRIGGER $$Compania$$.GLOBALES_POS_MOD
ON $$Compania$$.GLOBALES
FOR UPDATE
AS 
BEGIN   	
	DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @COL_ROWPOINTER VARCHAR(36)
	DECLARE @HAY_CAMPOS_PARA_POS BIT
	DECLARE @ACTUALIZAR_SOLICITUD BIT
	DECLARE @MODULO VARCHAR(20)
	DECLARE @NOMBRE VARCHAR(30)
	DECLARE @TIPO VARCHAR(1)
	DECLARE @VALOR VARCHAR(250)
	DECLARE @TIPO_SITIO_LOCAL VARCHAR(1)
	 -- Declaraciones

	SET @ERROR = 0

	SELECT	@PUBLICADOR = SITIO_LOCAL,
		@USUARIO_POS_WSQM = USUARIO_WSQM,
		@TIPO_SITIO_LOCAL = TIPO_SITIO_LOCAL
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)  AND @TIPO_SITIO_LOCAL = 'C'
	BEGIN
		DECLARE C_MODIFIED CURSOR LOCAL FOR
			SELECT MODULO, NOMBRE, TIPO, VALOR -- Columnas
			FROM INSERTED I

		SET @ACTUALIZAR_SOLICITUD = 0

		OPEN C_MODIFIED

		FETCH NEXT FROM C_MODIFIED
		INTO @MODULO, @NOMBRE, @TIPO, @VALOR

		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			IF ( NOT UPDATE(RECORDDATE) AND ( UPDATE(MODULO) OR UPDATE(NOMBRE) OR UPDATE(TIPO) OR UPDATE(VALOR) ) )
			BEGIN
				SET @PARAMETROS =
					'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<GLOBALES>' + 
				'<MODULO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@MODULO) + '</MODULO>' + 
				'<NOMBRE Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@NOMBRE) + '</NOMBRE>' + 
				'<TIPO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO) + '</TIPO>' + 
				'<VALOR Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@VALOR) + '</VALOR>' + 
				'</GLOBALES>'


				-- inserta la solicitud correspondiente
				EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'GLOBALESPOS600', 'MODIFICA', @PARAMETROS, @ACTUALIZAR_SOLICITUD, @COL_ROWPOINTER
			END

			FETCH NEXT FROM C_MODIFIED
			INTO @MODULO, @NOMBRE, @TIPO, @VALOR
		END

		CLOSE C_MODIFIED
		DEALLOCATE C_MODIFIED
	END

	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para modificar la tabla GLOBALES.',16,1 )
	END
END;


CREATE TRIGGER $$Compania$$.NCF_CAJA_POS_POS_INS
ON $$Compania$$.NCF_CAJA_POS
FOR INSERT
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @CAJA VARCHAR(6)
	DECLARE @PREFIJO VARCHAR(20)
	DECLARE @TIPO VARCHAR(6)
	DECLARE @TIPO_DOC_POS VARCHAR(1)
	DECLARE @TIPO_SITIO_LOCAL VARCHAR(1)
	

	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM,
		@TIPO_SITIO_LOCAL = TIPO_SITIO_LOCAL
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)  AND @TIPO_SITIO_LOCAL = 'C'
	BEGIN
		DECLARE C_INSERTED CURSOR LOCAL FOR
		SELECT CAJA, PREFIJO, TIPO, TIPO_DOC_POS
		FROM INSERTED i
		WHERE 0 = (
				SELECT COUNT('n')
				FROM DELETED d
				WHERE i.CAJA = d.CAJA AND i.TIPO = d.TIPO
			   )
			
		OPEN C_INSERTED	
		FETCH NEXT FROM C_INSERTED INTO
		@CAJA, @PREFIJO, @TIPO, @TIPO_DOC_POS

		SET @ERROR = 0
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS = 
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<NCF_CAJA_POS>' + 
				'<CAJA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CAJA) + '</CAJA>' + 
				'<PREFIJO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@PREFIJO) + '</PREFIJO>' + 
				'<TIPO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO) + '</TIPO>' + 
				'<TIPO_DOC_POS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_DOC_POS) + '</TIPO_DOC_POS>' + 
				'</NCF_CAJA_POS>'


			-- Inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'NCFCAJAPOSPOS600', 'INSERTA', @PARAMETROS, 0, ''

			FETCH NEXT FROM C_INSERTED INTO
			@CAJA, @PREFIJO, @TIPO, @TIPO_DOC_POS
		END

		CLOSE C_INSERTED
    		DEALLOCATE C_INSERTED
	END

	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla NCF_CAJA_POS.',16,1 )
	END
END
;





CREATE TRIGGER $$Compania$$.NCF_CAJA_POS_POS_DEL
ON $$Compania$$.NCF_CAJA_POS
FOR DELETE  
AS 
BEGIN   	
                DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @CAJA VARCHAR(6)
	DECLARE @PREFIJO VARCHAR(20)
	DECLARE @TIPO VARCHAR(6)
	DECLARE @TIPO_DOC_POS VARCHAR(1)
	DECLARE @TIPO_SITIO_LOCAL VARCHAR(1)
	 -- Declaraciones	

	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM,
		@TIPO_SITIO_LOCAL = TIPO_SITIO_LOCAL
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)  AND @TIPO_SITIO_LOCAL = 'C'
	BEGIN
		DECLARE C_DELETED CURSOR LOCAL FOR
			SELECT CAJA, PREFIJO, TIPO, TIPO_DOC_POS
			FROM DELETED d
			WHERE 0 = (
				SELECT COUNT('n')
				FROM INSERTED i
				WHERE d.CAJA = i.CAJA AND d.TIPO = i.TIPO
			   )

		OPEN C_DELETED
		FETCH NEXT FROM C_DELETED INTO 
		@CAJA, @PREFIJO, @TIPO, @TIPO_DOC_POS -- VARIABLES
		
		SET @ERROR = 0
		
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS = 
								'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<NCF_CAJA_POS>' + 
				'<CAJA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CAJA) + '</CAJA>' + 
				'<PREFIJO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@PREFIJO) + '</PREFIJO>' + 
				'<TIPO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO) + '</TIPO>' + 
				'<TIPO_DOC_POS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_DOC_POS) + '</TIPO_DOC_POS>' + 
				'</NCF_CAJA_POS>'
 -- XML
			
			-- inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'NCFCAJAPOSPOS600', 'ELIMINA', @PARAMETROS, 0, ''
			
			FETCH NEXT FROM C_DELETED INTO 
			@CAJA, @PREFIJO, @TIPO, @TIPO_DOC_POS -- VARIABLES
		END

		CLOSE C_DELETED
		DEALLOCATE C_DELETED
	END
	
	IF (@@ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para eliminar de la tabla NCF_CAJA_POS.',16,1 )
	END
END
;





CREATE TRIGGER $$Compania$$.NCF_CAJA_POS_POS_MOD
ON $$Compania$$.NCF_CAJA_POS
FOR UPDATE
AS 
BEGIN   	
	DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @COL_ROWPOINTER VARCHAR(36)
	DECLARE @HAY_CAMPOS_PARA_POS BIT
	DECLARE @ACTUALIZAR_SOLICITUD BIT
	DECLARE @CAJA VARCHAR(6)
	DECLARE @PREFIJO VARCHAR(20)
	DECLARE @TIPO VARCHAR(6)
	DECLARE @TIPO_DOC_POS VARCHAR(1)
	DECLARE @TIPO_SITIO_LOCAL VARCHAR(1)
	 -- Declaraciones

	SET @ERROR = 0

	SELECT @PUBLICADOR = SITIO_LOCAL,
		@USUARIO_POS_WSQM = USUARIO_WSQM,
		@TIPO_SITIO_LOCAL = TIPO_SITIO_LOCAL
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)  AND @TIPO_SITIO_LOCAL = 'C'
	BEGIN
		DECLARE C_MODIFIED CURSOR LOCAL FOR
			SELECT CAJA, PREFIJO, TIPO, TIPO_DOC_POS -- Columnas
			FROM INSERTED I

		SET @ACTUALIZAR_SOLICITUD = 1

		OPEN C_MODIFIED

		FETCH NEXT FROM C_MODIFIED
		INTO @CAJA, @PREFIJO, @TIPO, @TIPO_DOC_POS

		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			IF ( NOT UPDATE(RECORDDATE) AND ( UPDATE(CAJA) OR UPDATE(PREFIJO) OR UPDATE(TIPO) OR UPDATE(TIPO_DOC_POS) ) )
			BEGIN

				SELECT @COL_ROWPOINTER = ROWPOINTER 
				FROM $$Compania$$.NCF_CAJA_POS
				WHERE CAJA = @CAJA AND TIPO = @TIPO 

				SET @PARAMETROS =
					'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<NCF_CAJA_POS>' + 
				'<CAJA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CAJA) + '</CAJA>' + 
				'<PREFIJO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@PREFIJO) + '</PREFIJO>' + 
				'<TIPO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO) + '</TIPO>' + 
				'<TIPO_DOC_POS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_DOC_POS) + '</TIPO_DOC_POS>' + 
				'</NCF_CAJA_POS>'


				-- inserta la solicitud correspondiente
				EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'NCFCAJAPOSPOS600', 'MODIFICA', @PARAMETROS, @ACTUALIZAR_SOLICITUD, @COL_ROWPOINTER
			END

			FETCH NEXT FROM C_MODIFIED
			INTO @CAJA, @PREFIJO, @TIPO, @TIPO_DOC_POS
		END

		CLOSE C_MODIFIED
		DEALLOCATE C_MODIFIED
	END

	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para modificar la tabla NCF_CAJA_POS.',16,1 )
	END
END
;




CREATE TRIGGER $$Compania$$.NCF_CONSECUTIVO_POS_INS
ON $$Compania$$.NCF_CONSECUTIVO
FOR INSERT
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @PREFIJO VARCHAR(20)
	DECLARE @DESCRIPCION VARCHAR(70)
	DECLARE @ULTIMO_VALOR VARCHAR(20)
	DECLARE @SECUENCIA_INICIAL VARCHAR(20)
	DECLARE @SECUENCIA_FINAL VARCHAR(20)
	DECLARE @ACTIVO VARCHAR(1)
	DECLARE @TIPO VARCHAR(6)
	DECLARE @USUARIO_CREACION VARCHAR(25)
	DECLARE @USUARIO_MODIFICA VARCHAR(25)
	DECLARE @USUARIO_AJUSTE VARCHAR(25)
	DECLARE @FECHAHORA_CREACION DATETIME
	DECLARE @FECHAHORA_MODIFICA DATETIME
	DECLARE @FECHAHORA_AJUSTE DATETIME
	DECLARE @TIPO_SITIO_LOCAL VARCHAR(1)
	DECLARE @TIPO_DOC VARCHAR(3)
	DECLARE @TIPO_CONTRIBUYENTE VARCHAR(1)
	DECLARE @SUGERIR VARCHAR(1)
	DECLARE @NCF_UNICO VARCHAR(1)

	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM,
		@TIPO_SITIO_LOCAL = TIPO_SITIO_LOCAL
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)  AND @TIPO_SITIO_LOCAL = 'C'
	BEGIN
		DECLARE C_INSERTED CURSOR LOCAL FOR
		SELECT PREFIJO, DESCRIPCION, ULTIMO_VALOR, SECUENCIA_INICIAL, SECUENCIA_FINAL, ACTIVO, TIPO, USUARIO_CREACION, USUARIO_MODIFICA, USUARIO_AJUSTE, FECHAHORA_CREACION, FECHAHORA_MODIFICA, FECHAHORA_AJUSTE, TIPO_DOC, TIPO_CONTRIBUYENTE, SUGERIR, NCF_UNICO
		FROM INSERTED i
		WHERE 0 = (
				SELECT COUNT('n')
				FROM DELETED d
				WHERE i.PREFIJO = d.PREFIJO
			   )
			
		OPEN C_INSERTED	
		FETCH NEXT FROM C_INSERTED INTO
		@PREFIJO, @DESCRIPCION, @ULTIMO_VALOR, @SECUENCIA_INICIAL, @SECUENCIA_FINAL, @ACTIVO, @TIPO, @USUARIO_CREACION, @USUARIO_MODIFICA, @USUARIO_AJUSTE, @FECHAHORA_CREACION, @FECHAHORA_MODIFICA, @FECHAHORA_AJUSTE, @TIPO_DOC, @TIPO_CONTRIBUYENTE, @SUGERIR, @NCF_UNICO

		SET @ERROR = 0
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS = 
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<NCF_CONSECUTIVO>' + 
				'<PREFIJO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@PREFIJO) + '</PREFIJO>' + 
				'<DESCRIPCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DESCRIPCION) + '</DESCRIPCION>' + 
				'<ULTIMO_VALOR Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ULTIMO_VALOR) + '</ULTIMO_VALOR>' + 
				'<SECUENCIA_INICIAL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@SECUENCIA_INICIAL) + '</SECUENCIA_INICIAL>' + 
				'<SECUENCIA_FINAL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@SECUENCIA_FINAL) + '</SECUENCIA_FINAL>' + 
				'<ACTIVO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ACTIVO) + '</ACTIVO>' + 
				'<TIPO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO) + '</TIPO>' + 
				'<USUARIO_CREACION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USUARIO_CREACION) + '</USUARIO_CREACION>' + 
				'<USUARIO_MODIFICA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USUARIO_MODIFICA) + '</USUARIO_MODIFICA>' + 
				'<USUARIO_AJUSTE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USUARIO_AJUSTE) + '</USUARIO_AJUSTE>' + 
				'<FECHAHORA_CREACION Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHAHORA_CREACION) + '</FECHAHORA_CREACION>' + 
				'<FECHAHORA_MODIFICA Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHAHORA_MODIFICA) + '</FECHAHORA_MODIFICA>' + 
				'<FECHAHORA_AJUSTE Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHAHORA_AJUSTE) + '</FECHAHORA_AJUSTE>' + 
				'<TIPO_DOC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_DOC) + '</TIPO_DOC>' + 
				'<TIPO_CONTRIBUYENTE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_CONTRIBUYENTE) + '</TIPO_CONTRIBUYENTE>' + 
				'<SUGERIR Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@SUGERIR) + '</SUGERIR>' + 
				'<NCF_UNICO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NCF_UNICO) + '</NCF_UNICO>' + 
				'</NCF_CONSECUTIVO>'

			-- Inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'NCFCONSECUTIVOPOS600', 'INSERTA', @PARAMETROS, 0, ''

			FETCH NEXT FROM C_INSERTED INTO
			@PREFIJO, @DESCRIPCION, @ULTIMO_VALOR, @SECUENCIA_INICIAL, @SECUENCIA_FINAL, @ACTIVO, @TIPO, @USUARIO_CREACION, @USUARIO_MODIFICA, @USUARIO_AJUSTE, @FECHAHORA_CREACION, @FECHAHORA_MODIFICA, @FECHAHORA_AJUSTE, @TIPO_DOC, @TIPO_CONTRIBUYENTE, @SUGERIR, @NCF_UNICO
		END

		CLOSE C_INSERTED
    		DEALLOCATE C_INSERTED
	END

	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla NCF_CONSECUTIVO.',16,1 )
	END
END;



CREATE TRIGGER $$Compania$$.NCF_CONSECUTIVO_POS_DEL
ON $$Compania$$.NCF_CONSECUTIVO
FOR DELETE  
AS 
BEGIN   	
        DECLARE @ERROR  int
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @PREFIJO VARCHAR(20)
	 -- Declaraciones	

	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM 
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_DELETED CURSOR LOCAL FOR
			SELECT PREFIJO
			FROM DELETED d

		OPEN C_DELETED
		FETCH NEXT FROM C_DELETED INTO 
		@PREFIJO -- VARIABLES
		
		SET @ERROR = 0
		
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS = 
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<NCF_CONSECUTIVO>' + 
				'<PREFIJO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@PREFIJO) + '</PREFIJO>' + 
				'</NCF_CONSECUTIVO>'
 
			-- inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'NCFCONSECUTIVOPOS600', 'ELIMINA', @PARAMETROS, 0, ''
			
			FETCH NEXT FROM C_DELETED INTO 
			@PREFIJO -- VARIABLES
		END

		CLOSE C_DELETED
		DEALLOCATE C_DELETED
	END
	
	IF (@@ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para eliminar de la tabla NCF_CONSECUTIVO.',16,1 )
	END
END;




CREATE TRIGGER $$Compania$$.NCF_CONSECUTIVO_POS_MOD
ON $$Compania$$.NCF_CONSECUTIVO
FOR UPDATE
AS 
BEGIN   	
	DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @COL_ROWPOINTER VARCHAR(36)
	DECLARE @HAY_CAMPOS_PARA_POS BIT
	DECLARE @ACTUALIZAR_SOLICITUD BIT
	DECLARE @PREFIJO VARCHAR(20)
	DECLARE @DESCRIPCION VARCHAR(70)
	DECLARE @ULTIMO_VALOR VARCHAR(20)
	DECLARE @SECUENCIA_INICIAL VARCHAR(20)
	DECLARE @SECUENCIA_FINAL VARCHAR(20)
	DECLARE @ACTIVO VARCHAR(1)
	DECLARE @TIPO VARCHAR(6)
	DECLARE @USUARIO_CREACION VARCHAR(25)
	DECLARE @USUARIO_MODIFICA VARCHAR(25)
	DECLARE @USUARIO_AJUSTE VARCHAR(25)
	DECLARE @FECHAHORA_CREACION DATETIME
	DECLARE @FECHAHORA_MODIFICA DATETIME
	DECLARE @FECHAHORA_AJUSTE DATETIME
	DECLARE @TIPO_SITIO_LOCAL VARCHAR(1)
	DECLARE @TIPO_DOC VARCHAR(3)
	DECLARE @TIPO_CONTRIBUYENTE VARCHAR(1)
	DECLARE @SUGERIR VARCHAR(1)
	DECLARE @NCF_UNICO VARCHAR(1)
	
	 -- Declaraciones

	SET @ERROR = 0

	SELECT @PUBLICADOR = SITIO_LOCAL, @USUARIO_POS_WSQM = USUARIO_WSQM,
		@TIPO_SITIO_LOCAL = TIPO_SITIO_LOCAL
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_MODIFIED CURSOR LOCAL FOR
			SELECT PREFIJO, DESCRIPCION, ULTIMO_VALOR, SECUENCIA_INICIAL, SECUENCIA_FINAL, ACTIVO, TIPO, USUARIO_CREACION, USUARIO_MODIFICA, USUARIO_AJUSTE, FECHAHORA_CREACION, FECHAHORA_MODIFICA, FECHAHORA_AJUSTE, TIPO_DOC, TIPO_CONTRIBUYENTE, SUGERIR, NCF_UNICO -- Columnas
			FROM INSERTED I

		SET @ACTUALIZAR_SOLICITUD = 0

		OPEN C_MODIFIED

		FETCH NEXT FROM C_MODIFIED
		INTO @PREFIJO, @DESCRIPCION, @ULTIMO_VALOR, @SECUENCIA_INICIAL, @SECUENCIA_FINAL, @ACTIVO, @TIPO, @USUARIO_CREACION, @USUARIO_MODIFICA, @USUARIO_AJUSTE, @FECHAHORA_CREACION, @FECHAHORA_MODIFICA, @FECHAHORA_AJUSTE, @TIPO_DOC, @TIPO_CONTRIBUYENTE, @SUGERIR, @NCF_UNICO

		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			IF ( NOT UPDATE(RECORDDATE) AND ( UPDATE(PREFIJO) OR UPDATE(DESCRIPCION) OR UPDATE(ULTIMO_VALOR) OR UPDATE(SECUENCIA_INICIAL) OR UPDATE(SECUENCIA_FINAL) OR UPDATE(ACTIVO) OR UPDATE(TIPO) OR UPDATE(USUARIO_CREACION) OR UPDATE(USUARIO_MODIFICA) OR UPDATE(USUARIO_AJUSTE) OR UPDATE(FECHAHORA_CREACION) OR UPDATE(FECHAHORA_MODIFICA) OR UPDATE(FECHAHORA_AJUSTE) OR UPDATE(TIPO_DOC) OR UPDATE(TIPO_CONTRIBUYENTE) OR UPDATE(SUGERIR) OR UPDATE(NCF_UNICO)) )
			BEGIN

				SELECT @COL_ROWPOINTER = ROWPOINTER 
				FROM $$Compania$$.NCF_CONSECUTIVO
				WHERE PREFIJO = @PREFIJO 

				SET @PARAMETROS =
					'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<NCF_CONSECUTIVO>' + 
				'<PREFIJO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@PREFIJO) + '</PREFIJO>' + 
				'<DESCRIPCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DESCRIPCION) + '</DESCRIPCION>'
				IF UPDATE(ULTIMO_VALOR)
				BEGIN
					SET @PARAMETROS = @PARAMETROS + 
					'<ULTIMO_VALOR Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ULTIMO_VALOR) + '</ULTIMO_VALOR>'
				END
				SET @PARAMETROS = @PARAMETROS + 
				'<SECUENCIA_INICIAL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@SECUENCIA_INICIAL) + '</SECUENCIA_INICIAL>' + 
				'<SECUENCIA_FINAL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@SECUENCIA_FINAL) + '</SECUENCIA_FINAL>' + 
				'<ACTIVO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ACTIVO) + '</ACTIVO>' + 
				'<TIPO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO) + '</TIPO>' + 
				'<USUARIO_CREACION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USUARIO_CREACION) + '</USUARIO_CREACION>' + 
				'<USUARIO_MODIFICA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USUARIO_MODIFICA) + '</USUARIO_MODIFICA>' + 
				'<USUARIO_AJUSTE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USUARIO_AJUSTE) + '</USUARIO_AJUSTE>' + 
				'<FECHAHORA_CREACION Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHAHORA_CREACION) + '</FECHAHORA_CREACION>' + 
				'<FECHAHORA_MODIFICA Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHAHORA_MODIFICA) + '</FECHAHORA_MODIFICA>' + 
				'<FECHAHORA_AJUSTE Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHAHORA_AJUSTE) + '</FECHAHORA_AJUSTE>' + 
				'<TIPO_DOC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_DOC) + '</TIPO_DOC>' + 
				'<TIPO_CONTRIBUYENTE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_CONTRIBUYENTE) + '</TIPO_CONTRIBUYENTE>' + 
				'<SUGERIR Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@SUGERIR) + '</SUGERIR>' + 
				'<NCF_UNICO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NCF_UNICO) + '</NCF_UNICO>' + 
				'</NCF_CONSECUTIVO>'

				-- inserta la solicitud correspondiente
				EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'NCFCONSECUTIVOPOS600', 'MODIFICA', @PARAMETROS, @ACTUALIZAR_SOLICITUD, @COL_ROWPOINTER
			END

			FETCH NEXT FROM C_MODIFIED
			INTO @PREFIJO, @DESCRIPCION, @ULTIMO_VALOR, @SECUENCIA_INICIAL, @SECUENCIA_FINAL, @ACTIVO, @TIPO, @USUARIO_CREACION, @USUARIO_MODIFICA, @USUARIO_AJUSTE, @FECHAHORA_CREACION, @FECHAHORA_MODIFICA, @FECHAHORA_AJUSTE, @TIPO_DOC, @TIPO_CONTRIBUYENTE, @SUGERIR, @NCF_UNICO
		END

		CLOSE C_MODIFIED
		DEALLOCATE C_MODIFIED
	END

	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para modificar la tabla NCF_CONSECUTIVO.',16,1 )
	END
END;





CREATE TRIGGER $$Compania$$.CIERRE_POS_POS_INS
ON $$Compania$$.CIERRE_POS
FOR INSERT
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @CAJA VARCHAR(6)
	DECLARE @TIPO_CIERRE VARCHAR(1)
	DECLARE @CAJERO VARCHAR(25)
	DECLARE @NOMBRE_VENDEDOR VARCHAR(40)
	DECLARE @FECHA_HORA DATETIME
	DECLARE @TIPO_CAMBIO DECIMAL(28,8)
	DECLARE @MONTO_APERTURA DECIMAL(28,8)
	DECLARE @TOTAL_DIFERENCIA DECIMAL(28,8)
	DECLARE @DOCUMENTO_AJUSTE VARCHAR(50)
	DECLARE @TOTAL_LOCAL DECIMAL(28,8)
	DECLARE @TOTAL_DOLAR DECIMAL(28,8)
	DECLARE @VENTAS_EFECTIVO DECIMAL(28,8)
	DECLARE @ESTADO VARCHAR(1)
	DECLARE @NUM_CIERRE VARCHAR(20)
	DECLARE @FECHA_HORA_INICIO DATETIME
	DECLARE @NOTAS VARCHAR(4000)
	DECLARE @TIPO_SITIO_LOCAL VARCHAR(1)
	DECLARE @NUM_CIERRE_CAJA VARCHAR(20)
	DECLARE @COBRO_EFECTIVO_REP DECIMAL(28, 8) 
	DECLARE @DOC_FISCAL VARCHAR(50)

	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM,
		@TIPO_SITIO_LOCAL = TIPO_SITIO_LOCAL
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM) AND @TIPO_SITIO_LOCAL = 'T'
	BEGIN
		DECLARE C_INSERTED CURSOR LOCAL FOR
		SELECT CAJA, TIPO_CIERRE, CAJERO, NOMBRE_VENDEDOR, FECHA_HORA, TIPO_CAMBIO, MONTO_APERTURA, TOTAL_DIFERENCIA, DOCUMENTO_AJUSTE, TOTAL_LOCAL, TOTAL_DOLAR, VENTAS_EFECTIVO, ESTADO, NUM_CIERRE, FECHA_HORA_INICIO, NOTAS, NUM_CIERRE_CAJA, COBRO_EFECTIVO_REP,DOC_FISCAL
		FROM INSERTED i
		WHERE 0 = (
				SELECT COUNT('n')
				FROM DELETED d
				WHERE i.CAJA = d.CAJA AND i.CAJERO = d.CAJERO AND i.NUM_CIERRE = d.NUM_CIERRE
			   )
			
		OPEN C_INSERTED	
		FETCH NEXT FROM C_INSERTED INTO
		@CAJA, @TIPO_CIERRE, @CAJERO, @NOMBRE_VENDEDOR, @FECHA_HORA, @TIPO_CAMBIO, @MONTO_APERTURA, @TOTAL_DIFERENCIA, @DOCUMENTO_AJUSTE, @TOTAL_LOCAL, @TOTAL_DOLAR, @VENTAS_EFECTIVO, @ESTADO, @NUM_CIERRE, @FECHA_HORA_INICIO, @NOTAS, @NUM_CIERRE_CAJA, @COBRO_EFECTIVO_REP,@DOC_FISCAL

		SET @ERROR = 0
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS = 
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<CIERRE_POS>' + 
				'<CAJA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CAJA) + '</CAJA>' + 
				'<TIPO_CIERRE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_CIERRE) + '</TIPO_CIERRE>' + 
				'<CAJERO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CAJERO) + '</CAJERO>' + 
				'<NOMBRE_VENDEDOR Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOMBRE_VENDEDOR) + '</NOMBRE_VENDEDOR>' + 
				'<FECHA_HORA Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_HORA) + '</FECHA_HORA>' + 
				'<TIPO_CAMBIO Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@TIPO_CAMBIO) + '</TIPO_CAMBIO>' + 
				'<MONTO_APERTURA Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@MONTO_APERTURA) + '</MONTO_APERTURA>' + 
				'<TOTAL_DIFERENCIA Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@TOTAL_DIFERENCIA) + '</TOTAL_DIFERENCIA>' + 
				'<DOCUMENTO_AJUSTE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DOCUMENTO_AJUSTE) + '</DOCUMENTO_AJUSTE>' + 
				'<TOTAL_LOCAL Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@TOTAL_LOCAL) + '</TOTAL_LOCAL>' + 
				'<TOTAL_DOLAR Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@TOTAL_DOLAR) + '</TOTAL_DOLAR>' + 
				'<VENTAS_EFECTIVO Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@VENTAS_EFECTIVO) + '</VENTAS_EFECTIVO>' + 
				'<ESTADO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ESTADO) + '</ESTADO>' + 
				'<NUM_CIERRE Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@NUM_CIERRE) + '</NUM_CIERRE>' + 
				'<FECHA_HORA_INICIO Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_HORA_INICIO) + '</FECHA_HORA_INICIO>' + 
				'<NOTAS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOTAS) + '</NOTAS>' + 
				'<NUM_CIERRE_CAJA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NUM_CIERRE_CAJA) + '</NUM_CIERRE_CAJA>' + 
				'<COBRO_EFECTIVO_REP Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@COBRO_EFECTIVO_REP) + '</COBRO_EFECTIVO_REP>' + 
				'<DOC_FISCAL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DOC_FISCAL) + '</DOC_FISCAL>' + 
				'</CIERRE_POS>'


			-- Inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'CIERREPOSPOS600', 'INSERTA', @PARAMETROS, 0, ''

			FETCH NEXT FROM C_INSERTED INTO
			@CAJA, @TIPO_CIERRE, @CAJERO, @NOMBRE_VENDEDOR, @FECHA_HORA, @TIPO_CAMBIO, @MONTO_APERTURA, @TOTAL_DIFERENCIA, @DOCUMENTO_AJUSTE, @TOTAL_LOCAL, @TOTAL_DOLAR, @VENTAS_EFECTIVO, @ESTADO, @NUM_CIERRE, @FECHA_HORA_INICIO, @NOTAS, @NUM_CIERRE_CAJA, @COBRO_EFECTIVO_REP,@DOC_FISCAL
		END

		CLOSE C_INSERTED
    		DEALLOCATE C_INSERTED
	END

	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla CIERRE_POS.',16,1 )
	END
END;




CREATE TRIGGER $$Compania$$.CIERRE_POS_POS_DEL
ON $$Compania$$.CIERRE_POS
FOR DELETE  
AS 
BEGIN   	
                DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @CAJA VARCHAR(6)
	DECLARE @CAJERO VARCHAR(25)
	DECLARE @NUM_CIERRE VARCHAR(20)
	DECLARE @TIPO_SITIO_LOCAL VARCHAR(1)
	-- Declaraciones	

	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM,
		@TIPO_SITIO_LOCAL = TIPO_SITIO_LOCAL
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM) AND @TIPO_SITIO_LOCAL = 'T'
	BEGIN
		DECLARE C_DELETED CURSOR LOCAL FOR
			SELECT CAJA, CAJERO, NUM_CIERRE
			FROM DELETED d
			WHERE 0 = (
				SELECT COUNT('n')
				FROM INSERTED i
				WHERE d.CAJA = i.CAJA AND d.CAJERO = i.CAJERO AND d.NUM_CIERRE = i.NUM_CIERRE
			   )

		OPEN C_DELETED
		FETCH NEXT FROM C_DELETED INTO 
		@CAJA, @CAJERO, @NUM_CIERRE -- VARIABLES
		
		SET @ERROR = 0
		
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS = 
								'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<CIERRE_POS>' + 
				'<CAJA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CAJA) + '</CAJA>' + 
				'<CAJERO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CAJERO) + '</CAJERO>' + 
				'<NUM_CIERRE Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@NUM_CIERRE) + '</NUM_CIERRE>' + 
				'</CIERRE_POS>'
 -- XML
			
			-- inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'CIERREPOSPOS600', 'ELIMINA', @PARAMETROS, 0, ''
			
			FETCH NEXT FROM C_DELETED INTO 
			@CAJA, @CAJERO, @NUM_CIERRE -- VARIABLES
		END

		CLOSE C_DELETED
		DEALLOCATE C_DELETED
	END
	
	IF (@@ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para eliminar de la tabla CIERRE_POS.',16,1 )
	END
END
;



CREATE TRIGGER $$Compania$$.CIERRE_POS_POS_MOD
ON $$Compania$$.CIERRE_POS
FOR UPDATE
AS 
BEGIN   	
	DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @COL_ROWPOINTER VARCHAR(36)
	DECLARE @HAY_CAMPOS_PARA_POS BIT
	DECLARE @ACTUALIZAR_SOLICITUD BIT
	DECLARE @CAJA VARCHAR(6)
	DECLARE @TIPO_CIERRE VARCHAR(1)
	DECLARE @CAJERO VARCHAR(25)
	DECLARE @NOMBRE_VENDEDOR VARCHAR(40)
	DECLARE @FECHA_HORA DATETIME
	DECLARE @TIPO_CAMBIO DECIMAL(28,8)
	DECLARE @MONTO_APERTURA DECIMAL(28,8)
	DECLARE @TOTAL_DIFERENCIA DECIMAL(28,8)
	DECLARE @DOCUMENTO_AJUSTE VARCHAR(50)
	DECLARE @TOTAL_LOCAL DECIMAL(28,8)
	DECLARE @TOTAL_DOLAR DECIMAL(28,8)
	DECLARE @VENTAS_EFECTIVO DECIMAL(28,8)
	DECLARE @ESTADO VARCHAR(1)
	DECLARE @NUM_CIERRE VARCHAR(20)
	DECLARE @FECHA_HORA_INICIO DATETIME
	DECLARE @NOTAS VARCHAR(4000)
	DECLARE @NUM_CIERRE_CAJA VARCHAR(20)
	DECLARE @TIPO_SITIO_LOCAL VARCHAR(1)
	DECLARE @COBRO_EFECTIVO_REP DECIMAL(28, 8) 	 
	DECLARE @DOC_FISCAL VARCHAR(50)
		-- Declaraciones

	SET @ERROR = 0

	SELECT @PUBLICADOR = SITIO_LOCAL,
		@USUARIO_POS_WSQM = USUARIO_WSQM,
		@TIPO_SITIO_LOCAL = TIPO_SITIO_LOCAL
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM) AND @TIPO_SITIO_LOCAL = 'T'
	BEGIN
		DECLARE C_MODIFIED CURSOR LOCAL FOR
			SELECT CAJA, TIPO_CIERRE, CAJERO, NOMBRE_VENDEDOR, FECHA_HORA, TIPO_CAMBIO, MONTO_APERTURA, TOTAL_DIFERENCIA, DOCUMENTO_AJUSTE, TOTAL_LOCAL, TOTAL_DOLAR, VENTAS_EFECTIVO, ESTADO, NUM_CIERRE, FECHA_HORA_INICIO, NOTAS, NUM_CIERRE_CAJA, COBRO_EFECTIVO_REP, DOC_FISCAL -- Columnas
			FROM INSERTED I

		SET @ACTUALIZAR_SOLICITUD = 1

		OPEN C_MODIFIED

		FETCH NEXT FROM C_MODIFIED
		INTO @CAJA, @TIPO_CIERRE, @CAJERO, @NOMBRE_VENDEDOR, @FECHA_HORA, @TIPO_CAMBIO, @MONTO_APERTURA, @TOTAL_DIFERENCIA, @DOCUMENTO_AJUSTE, @TOTAL_LOCAL, @TOTAL_DOLAR, @VENTAS_EFECTIVO, @ESTADO, @NUM_CIERRE, @FECHA_HORA_INICIO, @NOTAS, @NUM_CIERRE_CAJA, @COBRO_EFECTIVO_REP, @DOC_FISCAL

		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			IF ( NOT UPDATE(RECORDDATE) AND ( UPDATE(CAJA) OR UPDATE(TIPO_CIERRE) OR UPDATE(CAJERO) OR UPDATE(NOMBRE_VENDEDOR) OR UPDATE(FECHA_HORA) OR UPDATE(TIPO_CAMBIO) OR UPDATE(MONTO_APERTURA) OR UPDATE(TOTAL_DIFERENCIA) OR UPDATE(DOCUMENTO_AJUSTE) OR UPDATE(TOTAL_LOCAL) OR UPDATE(TOTAL_DOLAR) OR UPDATE(VENTAS_EFECTIVO) OR UPDATE(ESTADO) OR UPDATE(NUM_CIERRE) OR UPDATE(FECHA_HORA_INICIO) OR UPDATE(NOTAS) OR UPDATE(NUM_CIERRE_CAJA) OR UPDATE(COBRO_EFECTIVO_REP) OR UPDATE(DOC_FISCAL)) )
			BEGIN

				SELECT @COL_ROWPOINTER = ROWPOINTER 
				FROM $$Compania$$.CIERRE_POS
				WHERE CAJA = @CAJA AND CAJERO = @CAJERO AND NUM_CIERRE = @NUM_CIERRE 

				SET @PARAMETROS =
					'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<CIERRE_POS>' + 
				'<CAJA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CAJA) + '</CAJA>' + 
				'<TIPO_CIERRE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_CIERRE) + '</TIPO_CIERRE>' + 
				'<CAJERO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CAJERO) + '</CAJERO>' + 
				'<NOMBRE_VENDEDOR Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOMBRE_VENDEDOR) + '</NOMBRE_VENDEDOR>' + 
				'<FECHA_HORA Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_HORA) + '</FECHA_HORA>' + 
				'<TIPO_CAMBIO Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@TIPO_CAMBIO) + '</TIPO_CAMBIO>' + 
				'<MONTO_APERTURA Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@MONTO_APERTURA) + '</MONTO_APERTURA>' + 
				'<TOTAL_DIFERENCIA Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@TOTAL_DIFERENCIA) + '</TOTAL_DIFERENCIA>' + 
				'<DOCUMENTO_AJUSTE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DOCUMENTO_AJUSTE) + '</DOCUMENTO_AJUSTE>' + 
				'<TOTAL_LOCAL Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@TOTAL_LOCAL) + '</TOTAL_LOCAL>' + 
				'<TOTAL_DOLAR Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@TOTAL_DOLAR) + '</TOTAL_DOLAR>' + 
				'<VENTAS_EFECTIVO Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@VENTAS_EFECTIVO) + '</VENTAS_EFECTIVO>' + 
				'<ESTADO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ESTADO) + '</ESTADO>' + 
				'<NUM_CIERRE Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@NUM_CIERRE) + '</NUM_CIERRE>' + 
				'<FECHA_HORA_INICIO Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_HORA_INICIO) + '</FECHA_HORA_INICIO>' + 
				'<NOTAS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOTAS) + '</NOTAS>' + 
				'<NUM_CIERRE_CAJA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NUM_CIERRE_CAJA) + '</NUM_CIERRE_CAJA>' + 
				'<COBRO_EFECTIVO_REP Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@COBRO_EFECTIVO_REP) + '</COBRO_EFECTIVO_REP>' + 
				'<DOC_FISCAL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DOC_FISCAL) + '</DOC_FISCAL>' + 
				'</CIERRE_POS>'


				-- inserta la solicitud correspondiente
				EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'CIERREPOSPOS600', 'MODIFICA', @PARAMETROS, @ACTUALIZAR_SOLICITUD, @COL_ROWPOINTER
			END

			FETCH NEXT FROM C_MODIFIED
			INTO @CAJA, @TIPO_CIERRE, @CAJERO, @NOMBRE_VENDEDOR, @FECHA_HORA, @TIPO_CAMBIO, @MONTO_APERTURA, @TOTAL_DIFERENCIA, @DOCUMENTO_AJUSTE, @TOTAL_LOCAL, @TOTAL_DOLAR, @VENTAS_EFECTIVO, @ESTADO, @NUM_CIERRE, @FECHA_HORA_INICIO, @NOTAS, @NUM_CIERRE_CAJA, @COBRO_EFECTIVO_REP, @DOC_FISCAL
		END

		CLOSE C_MODIFIED
		DEALLOCATE C_MODIFIED
	END

	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para modificar la tabla CIERRE_POS.',16,1 )
	END
END;




CREATE TRIGGER $$Compania$$.CIERRE_DESG_TARJ_POS_INS
ON $$Compania$$.CIERRE_DESG_TARJ
FOR INSERT
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @CONSECUTIVO INT
	DECLARE @CAJA VARCHAR(6)
	DECLARE @TIPO_TARJETA VARCHAR(12)
	DECLARE @DOCUMENTO VARCHAR(50)
	DECLARE @TIPO VARCHAR(1)
	DECLARE @AUTORIZACION VARCHAR(16)
	DECLARE @MONTO DECIMAL(28,8)
	DECLARE @NUM_CIERRE VARCHAR(20)
	DECLARE @CAJERO VARCHAR(25)
	DECLARE @TIPO_SITIO_LOCAL VARCHAR(1)
	

	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM,
		@TIPO_SITIO_LOCAL = TIPO_SITIO_LOCAL
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM) AND @TIPO_SITIO_LOCAL = 'T'
	BEGIN
		DECLARE C_INSERTED CURSOR LOCAL FOR
		SELECT CONSECUTIVO, CAJA, TIPO_TARJETA, DOCUMENTO, TIPO, AUTORIZACION, MONTO, NUM_CIERRE, CAJERO
		FROM INSERTED i
		WHERE 0 = (
				SELECT COUNT('n')
				FROM DELETED d
				WHERE i.CONSECUTIVO = d.CONSECUTIVO
			   )
			
		OPEN C_INSERTED	
		FETCH NEXT FROM C_INSERTED INTO
		@CONSECUTIVO, @CAJA, @TIPO_TARJETA, @DOCUMENTO, @TIPO, @AUTORIZACION, @MONTO, @NUM_CIERRE, @CAJERO

		SET @ERROR = 0
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS = 
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<CIERRE_DESG_TARJ>' + 
				'<CONSECUTIVO Type="INT" PrimaryKey="True">' + ERPADMIN.POS_NumberToVarchar(@CONSECUTIVO) + '</CONSECUTIVO>' + 
				'<CAJA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CAJA) + '</CAJA>' + 
				'<TIPO_TARJETA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_TARJETA) + '</TIPO_TARJETA>' + 
				'<DOCUMENTO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DOCUMENTO) + '</DOCUMENTO>' + 
				'<TIPO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO) + '</TIPO>' + 
				'<AUTORIZACION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@AUTORIZACION) + '</AUTORIZACION>' + 
				'<MONTO Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@MONTO) + '</MONTO>' + 
				'<NUM_CIERRE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NUM_CIERRE) + '</NUM_CIERRE>' + 
				'<CAJERO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CAJERO) + '</CAJERO>' + 
				'</CIERRE_DESG_TARJ>'


			-- Inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'CIERREDESGTARJPOS600', 'INSERTA', @PARAMETROS, 0, ''

			FETCH NEXT FROM C_INSERTED INTO
			@CONSECUTIVO, @CAJA, @TIPO_TARJETA, @DOCUMENTO, @TIPO, @AUTORIZACION, @MONTO, @NUM_CIERRE, @CAJERO
		END

		CLOSE C_INSERTED
    		DEALLOCATE C_INSERTED
	END

	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla CIERRE_DESG_TARJ.',16,1 )
	END
END
;




CREATE TRIGGER $$Compania$$.CIERRE_DESG_TARJ_POS_DEL
ON $$Compania$$.CIERRE_DESG_TARJ
FOR DELETE  
AS 
BEGIN   	
                DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @CONSECUTIVO INT
	DECLARE @TIPO_SITIO_LOCAL VARCHAR(1)
	 -- Declaraciones	

	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM,
		@TIPO_SITIO_LOCAL = TIPO_SITIO_LOCAL
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM) AND @TIPO_SITIO_LOCAL = 'T'
	BEGIN
		DECLARE C_DELETED CURSOR LOCAL FOR
			SELECT CONSECUTIVO
			FROM DELETED d
			WHERE 0 = (
				SELECT COUNT('n')
				FROM INSERTED i
				WHERE d.CONSECUTIVO = i.CONSECUTIVO
			   )

		OPEN C_DELETED
		FETCH NEXT FROM C_DELETED INTO 
		@CONSECUTIVO
		
		SET @ERROR = 0
		
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS = 
								'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<CIERRE_DESG_TARJ>' + 
				'<CONSECUTIVO Type="INT" PrimaryKey="True">' + ERPADMIN.POS_NumberToVarchar(@CONSECUTIVO) + '</CONSECUTIVO>' + 
				'</CIERRE_DESG_TARJ>'
 -- XML
			
			-- inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'CIERREDESGTARJPOS600', 'ELIMINA', @PARAMETROS, 0, ''
			
			FETCH NEXT FROM C_DELETED INTO 
			@CONSECUTIVO -- VARIABLES
		END

		CLOSE C_DELETED
		DEALLOCATE C_DELETED
	END
	
	IF (@@ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para eliminar de la tabla CIERRE_DESG_TARJ.',16,1 )
	END
END
;





CREATE TRIGGER $$Compania$$.CIERRE_DESG_TARJ_POS_MOD
ON $$Compania$$.CIERRE_DESG_TARJ
FOR UPDATE
AS 
BEGIN   	
	DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @COL_ROWPOINTER VARCHAR(36)
	DECLARE @HAY_CAMPOS_PARA_POS BIT
	DECLARE @ACTUALIZAR_SOLICITUD BIT
	DECLARE @CONSECUTIVO INT
	DECLARE @CAJA VARCHAR(6)
	DECLARE @TIPO_TARJETA VARCHAR(12)
	DECLARE @DOCUMENTO VARCHAR(50)
	DECLARE @TIPO VARCHAR(1)
	DECLARE @AUTORIZACION VARCHAR(16)
	DECLARE @MONTO DECIMAL(28,8)
	DECLARE @NUM_CIERRE VARCHAR(20)
	DECLARE @CAJERO VARCHAR(25)
	DECLARE @TIPO_SITIO_LOCAL VARCHAR(1)
	 -- Declaraciones

	SET @ERROR = 0

	SELECT @PUBLICADOR = SITIO_LOCAL, @USUARIO_POS_WSQM = USUARIO_WSQM,
		@TIPO_SITIO_LOCAL = TIPO_SITIO_LOCAL
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM) AND @TIPO_SITIO_LOCAL = 'T'
	BEGIN
		DECLARE C_MODIFIED CURSOR LOCAL FOR
			SELECT CONSECUTIVO, CAJA, TIPO_TARJETA, DOCUMENTO, TIPO, AUTORIZACION, MONTO, NUM_CIERRE, CAJERO -- Columnas
			FROM INSERTED I

		SET @ACTUALIZAR_SOLICITUD = 1

		OPEN C_MODIFIED

		FETCH NEXT FROM C_MODIFIED
		INTO @CONSECUTIVO, @CAJA, @TIPO_TARJETA, @DOCUMENTO, @TIPO, @AUTORIZACION, @MONTO, @NUM_CIERRE, @CAJERO

		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			IF ( NOT UPDATE(RECORDDATE) AND ( UPDATE(CONSECUTIVO) OR UPDATE(CAJA) OR UPDATE(TIPO_TARJETA) OR UPDATE(DOCUMENTO) OR UPDATE(TIPO) OR UPDATE(AUTORIZACION) OR UPDATE(MONTO) OR UPDATE(NUM_CIERRE) OR UPDATE(CAJERO) ) )
			BEGIN

				SELECT @COL_ROWPOINTER = ROWPOINTER 
				FROM $$Compania$$.CIERRE_DESG_TARJ
				WHERE CONSECUTIVO = @CONSECUTIVO 

				SET @PARAMETROS =
					'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<CIERRE_DESG_TARJ>' + 
				'<CONSECUTIVO Type="INT" PrimaryKey="True">' + ERPADMIN.POS_NumberToVarchar(@CONSECUTIVO) + '</CONSECUTIVO>' + 
				'<CAJA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CAJA) + '</CAJA>' + 
				'<TIPO_TARJETA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_TARJETA) + '</TIPO_TARJETA>' + 
				'<DOCUMENTO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DOCUMENTO) + '</DOCUMENTO>' + 
				'<TIPO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO) + '</TIPO>' + 
				'<AUTORIZACION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@AUTORIZACION) + '</AUTORIZACION>' + 
				'<MONTO Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@MONTO) + '</MONTO>' + 
				'<NUM_CIERRE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NUM_CIERRE) + '</NUM_CIERRE>' + 
				'<CAJERO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CAJERO) + '</CAJERO>' + 
				'</CIERRE_DESG_TARJ>'


				-- inserta la solicitud correspondiente
				EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'CIERREDESGTARJPOS600', 'MODIFICA', @PARAMETROS, @ACTUALIZAR_SOLICITUD, @COL_ROWPOINTER
			END

			FETCH NEXT FROM C_MODIFIED
			INTO @CONSECUTIVO, @CAJA, @TIPO_TARJETA, @DOCUMENTO, @TIPO, @AUTORIZACION, @MONTO, @NUM_CIERRE, @CAJERO
		END

		CLOSE C_MODIFIED
		DEALLOCATE C_MODIFIED
	END

	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para modificar la tabla CIERRE_DESG_TARJ.',16,1 )
	END
END;




CREATE TRIGGER $$Compania$$.CIERRE_DET_PAGO_POS_INS
ON $$Compania$$.CIERRE_DET_PAGO
FOR INSERT
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @CAJA VARCHAR(6)
	DECLARE @TIPO_PAGO VARCHAR(40)
	DECLARE @TOTAL_SISTEMA DECIMAL(28,8)
	DECLARE @TOTAL_USUARIO DECIMAL(28,8)
	DECLARE @DIFERENCIA DECIMAL(28,8)
	DECLARE @ORDEN INT
	DECLARE @NUM_CIERRE VARCHAR(20)
	DECLARE @CAJERO VARCHAR(25)
	DECLARE @TIPO_SITIO_LOCAL VARCHAR(1)
	

	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM,
		@TIPO_SITIO_LOCAL = TIPO_SITIO_LOCAL
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM) AND @TIPO_SITIO_LOCAL = 'T'
	BEGIN
		DECLARE C_INSERTED CURSOR LOCAL FOR
		SELECT CAJA, TIPO_PAGO, TOTAL_SISTEMA, TOTAL_USUARIO, DIFERENCIA, ORDEN, NUM_CIERRE, CAJERO
		FROM INSERTED i
		WHERE 0 = (
				SELECT COUNT('n')
				FROM DELETED d
				WHERE i.CAJA = d.CAJA AND i.TIPO_PAGO = d.TIPO_PAGO AND i.NUM_CIERRE = d.NUM_CIERRE AND i.CAJERO = d.CAJERO
			   )
			
		OPEN C_INSERTED	
		FETCH NEXT FROM C_INSERTED INTO
		@CAJA, @TIPO_PAGO, @TOTAL_SISTEMA, @TOTAL_USUARIO, @DIFERENCIA, @ORDEN, @NUM_CIERRE, @CAJERO

		SET @ERROR = 0
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS = 
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<CIERRE_DET_PAGO>' + 
				'<CAJA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CAJA) + '</CAJA>' + 
				'<TIPO_PAGO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_PAGO) + '</TIPO_PAGO>' + 
				'<TOTAL_SISTEMA Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@TOTAL_SISTEMA) + '</TOTAL_SISTEMA>' + 
				'<TOTAL_USUARIO Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@TOTAL_USUARIO) + '</TOTAL_USUARIO>' + 
				'<DIFERENCIA Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@DIFERENCIA) + '</DIFERENCIA>' + 
				'<ORDEN Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@ORDEN) + '</ORDEN>' + 
				'<NUM_CIERRE Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@NUM_CIERRE) + '</NUM_CIERRE>' + 
				'<CAJERO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CAJERO) + '</CAJERO>' + 
				'</CIERRE_DET_PAGO>'


			-- Inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'CIERREDETPAGOPOS600', 'INSERTA', @PARAMETROS, 0, ''

			FETCH NEXT FROM C_INSERTED INTO
			@CAJA, @TIPO_PAGO, @TOTAL_SISTEMA, @TOTAL_USUARIO, @DIFERENCIA, @ORDEN, @NUM_CIERRE, @CAJERO
		END

		CLOSE C_INSERTED
    		DEALLOCATE C_INSERTED
	END

	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla CIERRE_DET_PAGO.',16,1 )
	END
END
;




CREATE TRIGGER $$Compania$$.CIERRE_DET_PAGO_POS_DEL
ON $$Compania$$.CIERRE_DET_PAGO
FOR DELETE  
AS 
BEGIN   	
                DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @CAJA VARCHAR(6)
	DECLARE @TIPO_PAGO VARCHAR(40)
	DECLARE @NUM_CIERRE VARCHAR(20)
	DECLARE @CAJERO VARCHAR(25)
	DECLARE @TIPO_SITIO_LOCAL VARCHAR(1)
	 -- Declaraciones	

	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM,
		@TIPO_SITIO_LOCAL = TIPO_SITIO_LOCAL
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM) AND @TIPO_SITIO_LOCAL = 'T'
	BEGIN
		DECLARE C_DELETED CURSOR LOCAL FOR
			SELECT CAJA, TIPO_PAGO, NUM_CIERRE, CAJERO
			FROM DELETED d
			WHERE 0 = (
				SELECT COUNT('n')
				FROM INSERTED i
				WHERE d.CAJA = i.CAJA AND d.TIPO_PAGO = i.TIPO_PAGO AND d.NUM_CIERRE = i.NUM_CIERRE AND d.CAJERO = i.CAJERO
			   )

		OPEN C_DELETED
		FETCH NEXT FROM C_DELETED INTO 
		@CAJA, @TIPO_PAGO, @NUM_CIERRE, @CAJERO -- VARIABLES
		
		SET @ERROR = 0
		
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS = 
								'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<CIERRE_DET_PAGO>' + 
				'<CAJA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CAJA) + '</CAJA>' + 
				'<TIPO_PAGO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_PAGO) + '</TIPO_PAGO>' + 
				'<NUM_CIERRE Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@NUM_CIERRE) + '</NUM_CIERRE>' + 
				'<CAJERO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CAJERO) + '</CAJERO>' + 
				'</CIERRE_DET_PAGO>'
 -- XML
			
			-- inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'CIERREDETPAGOPOS600', 'ELIMINA', @PARAMETROS, 0, ''
			
			FETCH NEXT FROM C_DELETED INTO 
			@CAJA, @TIPO_PAGO, @NUM_CIERRE, @CAJERO -- VARIABLES
		END

		CLOSE C_DELETED
		DEALLOCATE C_DELETED
	END
	
	IF (@@ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para eliminar de la tabla CIERRE_DET_PAGO.',16,1 )
	END
END
;




CREATE TRIGGER $$Compania$$.CIERRE_DET_PAGO_POS_MOD
ON $$Compania$$.CIERRE_DET_PAGO
FOR UPDATE
AS 
BEGIN   	
	DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @COL_ROWPOINTER VARCHAR(36)
	DECLARE @HAY_CAMPOS_PARA_POS BIT
	DECLARE @ACTUALIZAR_SOLICITUD BIT
	DECLARE @CAJA VARCHAR(6)
	DECLARE @TIPO_PAGO VARCHAR(40)
	DECLARE @TOTAL_SISTEMA DECIMAL(28,8)
	DECLARE @TOTAL_USUARIO DECIMAL(28,8)
	DECLARE @DIFERENCIA DECIMAL(28,8)
	DECLARE @ORDEN INT
	DECLARE @NUM_CIERRE VARCHAR(20)
	DECLARE @CAJERO VARCHAR(25)
	DECLARE @TIPO_SITIO_LOCAL VARCHAR(1)
	 -- Declaraciones

	SET @ERROR = 0

	SELECT @PUBLICADOR = SITIO_LOCAL, @USUARIO_POS_WSQM = USUARIO_WSQM,
		@TIPO_SITIO_LOCAL = TIPO_SITIO_LOCAL
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM) AND @TIPO_SITIO_LOCAL = 'T'
	BEGIN
		DECLARE C_MODIFIED CURSOR LOCAL FOR
			SELECT CAJA, TIPO_PAGO, TOTAL_SISTEMA, TOTAL_USUARIO, DIFERENCIA, ORDEN, NUM_CIERRE, CAJERO -- Columnas
			FROM INSERTED I

		SET @ACTUALIZAR_SOLICITUD = 1

		OPEN C_MODIFIED

		FETCH NEXT FROM C_MODIFIED
		INTO @CAJA, @TIPO_PAGO, @TOTAL_SISTEMA, @TOTAL_USUARIO, @DIFERENCIA, @ORDEN, @NUM_CIERRE, @CAJERO

		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			IF ( NOT UPDATE(RECORDDATE) AND ( UPDATE(CAJA) OR UPDATE(TIPO_PAGO) OR UPDATE(TOTAL_SISTEMA) OR UPDATE(TOTAL_USUARIO) OR UPDATE(DIFERENCIA) OR UPDATE(ORDEN) OR UPDATE(NUM_CIERRE) OR UPDATE(CAJERO) ) )
			BEGIN

				SELECT @COL_ROWPOINTER = ROWPOINTER 
				FROM $$Compania$$.CIERRE_DET_PAGO
				WHERE CAJA = @CAJA AND TIPO_PAGO = @TIPO_PAGO AND NUM_CIERRE = @NUM_CIERRE AND CAJERO = @CAJERO 

				SET @PARAMETROS =
					'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<CIERRE_DET_PAGO>' + 
				'<CAJA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CAJA) + '</CAJA>' + 
				'<TIPO_PAGO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_PAGO) + '</TIPO_PAGO>' + 
				'<TOTAL_SISTEMA Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@TOTAL_SISTEMA) + '</TOTAL_SISTEMA>' + 
				'<TOTAL_USUARIO Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@TOTAL_USUARIO) + '</TOTAL_USUARIO>' + 
				'<DIFERENCIA Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@DIFERENCIA) + '</DIFERENCIA>' + 
				'<ORDEN Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@ORDEN) + '</ORDEN>' + 
				'<NUM_CIERRE Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@NUM_CIERRE) + '</NUM_CIERRE>' + 
				'<CAJERO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CAJERO) + '</CAJERO>' + 
				'</CIERRE_DET_PAGO>'


				-- inserta la solicitud correspondiente
				EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'CIERREDETPAGOPOS600', 'MODIFICA', @PARAMETROS, @ACTUALIZAR_SOLICITUD, @COL_ROWPOINTER
			END

			FETCH NEXT FROM C_MODIFIED
			INTO @CAJA, @TIPO_PAGO, @TOTAL_SISTEMA, @TOTAL_USUARIO, @DIFERENCIA, @ORDEN, @NUM_CIERRE, @CAJERO
		END

		CLOSE C_MODIFIED
		DEALLOCATE C_MODIFIED
	END

	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para modificar la tabla CIERRE_DET_PAGO.',16,1 )
	END
END
;


  

CREATE TRIGGER $$Compania$$.AJUSTE_CONFIG_POS_INS
ON $$Compania$$.AJUSTE_CONFIG
FOR INSERT
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @AJUSTE_CONFIG VARCHAR(4)
	DECLARE @DESCRIPCION VARCHAR(15)
	DECLARE @AJUSTE_BASE VARCHAR(1)
	DECLARE @ACTIVA VARCHAR(1)
	DECLARE @INGRESO VARCHAR(1)
	

	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM 
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_INSERTED CURSOR LOCAL FOR
		SELECT AJUSTE_CONFIG, DESCRIPCION, AJUSTE_BASE, ACTIVA, INGRESO
		FROM INSERTED i
		WHERE 0 = (
				SELECT COUNT('n')
				FROM DELETED d
				WHERE i.AJUSTE_CONFIG = d.AJUSTE_CONFIG
			   )
			
		OPEN C_INSERTED	
		FETCH NEXT FROM C_INSERTED INTO
		@AJUSTE_CONFIG, @DESCRIPCION, @AJUSTE_BASE, @ACTIVA, @INGRESO

		SET @ERROR = 0
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS = 
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<AJUSTE_CONFIG>' + 
				'<AJUSTE_CONFIG Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@AJUSTE_CONFIG) + '</AJUSTE_CONFIG>' + 
				'<DESCRIPCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DESCRIPCION) + '</DESCRIPCION>' + 
				'<AJUSTE_BASE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@AJUSTE_BASE) + '</AJUSTE_BASE>' + 
				'<ACTIVA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ACTIVA) + '</ACTIVA>' + 
				'<INGRESO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@INGRESO) + '</INGRESO>' + 
				'</AJUSTE_CONFIG>'


			-- Inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'AJUSTECONFIGPOS600', 'INSERTA', @PARAMETROS, 0, ''

			FETCH NEXT FROM C_INSERTED INTO
			@AJUSTE_CONFIG, @DESCRIPCION, @AJUSTE_BASE, @ACTIVA, @INGRESO
		END

		CLOSE C_INSERTED
    		DEALLOCATE C_INSERTED
	END

	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla AJUSTE_CONFIG.',16,1 )
	END
END
;




CREATE TRIGGER $$Compania$$.AJUSTE_CONFIG_POS_MOD
ON $$Compania$$.AJUSTE_CONFIG
FOR UPDATE
AS 
BEGIN   	
	DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @COL_ROWPOINTER VARCHAR(36)
	DECLARE @HAY_CAMPOS_PARA_POS BIT
	DECLARE @ACTUALIZAR_SOLICITUD BIT
	DECLARE @AJUSTE_CONFIG VARCHAR(4)
	DECLARE @DESCRIPCION VARCHAR(15)
	DECLARE @AJUSTE_BASE VARCHAR(1)
	DECLARE @ACTIVA VARCHAR(1)
	DECLARE @INGRESO VARCHAR(1)
	 -- Declaraciones

	SET @ERROR = 0

	SELECT @PUBLICADOR = SITIO_LOCAL, @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_MODIFIED CURSOR LOCAL FOR
			SELECT AJUSTE_CONFIG, DESCRIPCION, AJUSTE_BASE, ACTIVA, INGRESO -- Columnas
			FROM INSERTED I

		SET @ACTUALIZAR_SOLICITUD = 1

		OPEN C_MODIFIED

		FETCH NEXT FROM C_MODIFIED
		INTO @AJUSTE_CONFIG, @DESCRIPCION, @AJUSTE_BASE, @ACTIVA, @INGRESO

		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			IF ( NOT UPDATE(RECORDDATE) AND ( UPDATE(AJUSTE_CONFIG) OR UPDATE(DESCRIPCION) OR UPDATE(AJUSTE_BASE) OR UPDATE(ACTIVA) OR UPDATE(INGRESO) ) )
			BEGIN

				SELECT @COL_ROWPOINTER = ROWPOINTER 
				FROM $$Compania$$.AJUSTE_CONFIG
				WHERE AJUSTE_CONFIG = @AJUSTE_CONFIG 

				SET @PARAMETROS =
					'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<AJUSTE_CONFIG>' + 
				'<AJUSTE_CONFIG Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@AJUSTE_CONFIG) + '</AJUSTE_CONFIG>' + 
				'<DESCRIPCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DESCRIPCION) + '</DESCRIPCION>' + 
				'<AJUSTE_BASE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@AJUSTE_BASE) + '</AJUSTE_BASE>' + 
				'<ACTIVA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ACTIVA) + '</ACTIVA>' + 
				'<INGRESO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@INGRESO) + '</INGRESO>' + 
				'</AJUSTE_CONFIG>'


				-- inserta la solicitud correspondiente
				EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'AJUSTECONFIGPOS600', 'MODIFICA', @PARAMETROS, @ACTUALIZAR_SOLICITUD, @COL_ROWPOINTER
			END

			FETCH NEXT FROM C_MODIFIED
			INTO @AJUSTE_CONFIG, @DESCRIPCION, @AJUSTE_BASE, @ACTIVA, @INGRESO
		END

		CLOSE C_MODIFIED
		DEALLOCATE C_MODIFIED
	END

	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para modificar la tabla AJUSTE_CONFIG.',16,1 )
	END
END
;




CREATE TRIGGER $$Compania$$.AJUSTE_CONFIG_POS_DEL
ON $$Compania$$.AJUSTE_CONFIG
FOR DELETE  
AS 
BEGIN   	
        DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @AJUSTE_CONFIG VARCHAR(4)
	DECLARE @DESCRIPCION VARCHAR(15)
	DECLARE @AJUSTE_BASE VARCHAR(1)
	DECLARE @ACTIVA VARCHAR(1)
	DECLARE @INGRESO VARCHAR(1)
	 -- Declaraciones	

	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM 
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_DELETED CURSOR LOCAL FOR
			SELECT AJUSTE_CONFIG, DESCRIPCION, AJUSTE_BASE, ACTIVA, INGRESO
			FROM DELETED d
			WHERE 0 = (
				SELECT COUNT('n')
				FROM INSERTED i
				WHERE d.AJUSTE_CONFIG = i.AJUSTE_CONFIG
			   )

		OPEN C_DELETED
		FETCH NEXT FROM C_DELETED INTO 
		@AJUSTE_CONFIG, @DESCRIPCION, @AJUSTE_BASE, @ACTIVA, @INGRESO -- VARIABLES
		
		SET @ERROR = 0
		
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS = 
								'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<AJUSTE_CONFIG>' + 
				'<AJUSTE_CONFIG Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@AJUSTE_CONFIG) + '</AJUSTE_CONFIG>' + 
				'</AJUSTE_CONFIG>'
 
			
			-- inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'AJUSTECONFIGPOS600', 'ELIMINA', @PARAMETROS, 0, ''
			
			FETCH NEXT FROM C_DELETED INTO 
			@AJUSTE_CONFIG, @DESCRIPCION, @AJUSTE_BASE, @ACTIVA, @INGRESO -- VARIABLES
		END

		CLOSE C_DELETED
		DEALLOCATE C_DELETED
	END
	
	IF (@@ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para eliminar de la tabla AJUSTE_CONFIG.',16,1 )
	END
END
;



CREATE TRIGGER $$Compania$$.ALIAS_PRODUCCION_POS_INS
ON $$Compania$$.ALIAS_PRODUCCION
FOR INSERT
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @ALIAS_PRODUCCION VARCHAR(25)
	DECLARE @ARTICULO VARCHAR(20)
	DECLARE @DESCRIPCION VARCHAR(50)
	

	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM 
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_INSERTED CURSOR LOCAL FOR
		SELECT ALIAS_PRODUCCION, ARTICULO, DESCRIPCION
		FROM INSERTED i
		WHERE 0 = (
				SELECT COUNT('n')
				FROM DELETED d
				WHERE i.ALIAS_PRODUCCION = d.ALIAS_PRODUCCION
			   )
			
		OPEN C_INSERTED	
		FETCH NEXT FROM C_INSERTED INTO
		@ALIAS_PRODUCCION, @ARTICULO, @DESCRIPCION

		SET @ERROR = 0
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS = 
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<ALIAS_PRODUCCION>' + 
				'<ALIAS_PRODUCCION Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@ALIAS_PRODUCCION) + '</ALIAS_PRODUCCION>' + 
				'<ARTICULO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ARTICULO) + '</ARTICULO>' + 
				'<DESCRIPCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DESCRIPCION) + '</DESCRIPCION>' + 				
				'</ALIAS_PRODUCCION>'

			-- Inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'ALIASPRODUCCIONPOS600', 'INSERTA', @PARAMETROS, 0, ''

			FETCH NEXT FROM C_INSERTED INTO
			@ALIAS_PRODUCCION, @ARTICULO, @DESCRIPCION
		END

		CLOSE C_INSERTED
    		DEALLOCATE C_INSERTED
	END

	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla ALIAS_PRODUCCION.',16,1 )
	END
END
;




CREATE TRIGGER $$Compania$$.ALIAS_PRODUCCION_POS_MOD
ON $$Compania$$.ALIAS_PRODUCCION
FOR UPDATE
AS 
BEGIN   	
	DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @COL_ROWPOINTER VARCHAR(36)
	DECLARE @HAY_CAMPOS_PARA_POS BIT
	DECLARE @ACTUALIZAR_SOLICITUD BIT
	DECLARE @ALIAS_PRODUCCION VARCHAR(25)
	DECLARE @ARTICULO VARCHAR(20)
	DECLARE @DESCRIPCION VARCHAR(50)
	 -- Declaraciones

	SET @ERROR = 0

	SELECT @PUBLICADOR = SITIO_LOCAL, @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_MODIFIED CURSOR LOCAL FOR
			SELECT ALIAS_PRODUCCION, ARTICULO, DESCRIPCION-- Columnas
			FROM INSERTED I

		SET @ACTUALIZAR_SOLICITUD = 1

		OPEN C_MODIFIED

		FETCH NEXT FROM C_MODIFIED
		INTO @ALIAS_PRODUCCION, @ARTICULO, @DESCRIPCION

		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			IF ( NOT UPDATE(RECORDDATE) AND ( UPDATE(ALIAS_PRODUCCION) OR UPDATE(ARTICULO) OR UPDATE(DESCRIPCION) ) )
			BEGIN

				SELECT @COL_ROWPOINTER = ROWPOINTER 
				FROM $$Compania$$.ALIAS_PRODUCCION
				WHERE ALIAS_PRODUCCION = @ALIAS_PRODUCCION 

				SET @PARAMETROS =
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<ALIAS_PRODUCCION>' + 
				'<ALIAS_PRODUCCION Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@ALIAS_PRODUCCION) + '</ALIAS_PRODUCCION>' + 
				'<ARTICULO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ARTICULO) + '</ARTICULO>' + 
				'<DESCRIPCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DESCRIPCION) + '</DESCRIPCION>' + 
				'</ALIAS_PRODUCCION>'


				-- inserta la solicitud correspondiente
				EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'ALIASPRODUCCIONPOS600', 'MODIFICA', @PARAMETROS, @ACTUALIZAR_SOLICITUD, @COL_ROWPOINTER
			END

			FETCH NEXT FROM C_MODIFIED
			INTO @ALIAS_PRODUCCION, @ARTICULO, @DESCRIPCION
		END

		CLOSE C_MODIFIED
		DEALLOCATE C_MODIFIED
	END

	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para modificar la tabla ALIAS_PRODUCCION.',16,1 )
	END
END
;





CREATE TRIGGER $$Compania$$.ALIAS_PRODUCCION_POS_DEL
ON $$Compania$$.ALIAS_PRODUCCION
FOR DELETE  
AS 
BEGIN   	
                DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @ALIAS_PRODUCCION VARCHAR(25)
	DECLARE @ARTICULO VARCHAR(20)
	DECLARE @DESCRIPCION VARCHAR(50)	
	 -- Declaraciones	

	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM 
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_DELETED CURSOR LOCAL FOR
			SELECT ALIAS_PRODUCCION, ARTICULO, DESCRIPCION
			FROM DELETED d
			WHERE 0 = (
				SELECT COUNT('n')
				FROM INSERTED i
				WHERE d.ALIAS_PRODUCCION = i.ALIAS_PRODUCCION
			   )

		OPEN C_DELETED
		FETCH NEXT FROM C_DELETED INTO 
		@ALIAS_PRODUCCION, @ARTICULO, @DESCRIPCION
		
		SET @ERROR = 0
		
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS = 
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<ALIAS_PRODUCCION>' + 
				'<ALIAS_PRODUCCION Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@ALIAS_PRODUCCION) + '</ALIAS_PRODUCCION>' + 
				'<ARTICULO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ARTICULO) + '</ARTICULO>' + 
				'<DESCRIPCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DESCRIPCION) + '</DESCRIPCION>' + 				
				'</ALIAS_PRODUCCION>'
 
			
			-- inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'ALIASPRODUCCIONPOS600', 'ELIMINA', @PARAMETROS, 0, ''
			
			FETCH NEXT FROM C_DELETED INTO 
			@ALIAS_PRODUCCION, @ARTICULO, @DESCRIPCION -- VARIABLES
		END

		CLOSE C_DELETED
		DEALLOCATE C_DELETED
	END
	
	IF (@@ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para eliminar de la tabla ALIAS_PRODUCCION.',16,1 )
	END
END
;



CREATE TRIGGER $$Compania$$.SUBTIPO_DOC_CC_POS_INS
ON $$Compania$$.SUBTIPO_DOC_CC
FOR INSERT
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @TIPO VARCHAR(3)
	DECLARE @SUBTIPO INT
	DECLARE @TIPO_CB VARCHAR(3)
	DECLARE @SUBTIPO_CB INT
	DECLARE @DESCRIPCION VARCHAR(25)
	DECLARE @CALCULA_IMP2 VARCHAR(1)
	

	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM 
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_INSERTED CURSOR LOCAL FOR
		SELECT TIPO, SUBTIPO, TIPO_CB, SUBTIPO_CB, DESCRIPCION, CALCULA_IMP2
		FROM INSERTED i
		WHERE 0 = (
				SELECT COUNT('n')
				FROM DELETED d
				WHERE i.TIPO = d.TIPO AND i.SUBTIPO = d.SUBTIPO
			   )
			
		OPEN C_INSERTED	
		FETCH NEXT FROM C_INSERTED INTO
		@TIPO, @SUBTIPO, @TIPO_CB, @SUBTIPO_CB, @DESCRIPCION, @CALCULA_IMP2

		SET @ERROR = 0
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS = 
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<SUBTIPO_DOC_CC>' + 
				'<TIPO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO) + '</TIPO>' + 
				'<SUBTIPO Type="INT" PrimaryKey="True">' + ERPADMIN.POS_NumberToVarchar(@SUBTIPO) + '</SUBTIPO>' + 
				'<TIPO_CB Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_CB) + '</TIPO_CB>' + 
				'<SUBTIPO_CB Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@SUBTIPO_CB) + '</SUBTIPO_CB>' + 
				'<DESCRIPCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DESCRIPCION) + '</DESCRIPCION>' + 
				'<CALCULA_IMP2 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CALCULA_IMP2) + '</CALCULA_IMP2>' + 
				'</SUBTIPO_DOC_CC>'


			-- Inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'SUBTIPODOCCCPOS600', 'INSERTA', @PARAMETROS, 0, ''

			FETCH NEXT FROM C_INSERTED INTO
			@TIPO, @SUBTIPO, @TIPO_CB, @SUBTIPO_CB, @DESCRIPCION, @CALCULA_IMP2
		END

		CLOSE C_INSERTED
    		DEALLOCATE C_INSERTED
	END

	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla SUBTIPO_DOC_CC.',16,1 )
	END
END
;




CREATE TRIGGER $$Compania$$.SUBTIPO_DOC_CC_POS_MOD
ON $$Compania$$.SUBTIPO_DOC_CC
FOR UPDATE
AS 
BEGIN   	
	DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @COL_ROWPOINTER VARCHAR(36)
	DECLARE @HAY_CAMPOS_PARA_POS BIT
	DECLARE @ACTUALIZAR_SOLICITUD BIT
	DECLARE @TIPO VARCHAR(3)
	DECLARE @SUBTIPO INT
	DECLARE @TIPO_CB VARCHAR(3)
	DECLARE @SUBTIPO_CB INT
	DECLARE @DESCRIPCION VARCHAR(25)
	DECLARE @CALCULA_IMP2 VARCHAR(1)
	 -- Declaraciones

	SET @ERROR = 0

	SELECT @PUBLICADOR = SITIO_LOCAL, @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_MODIFIED CURSOR LOCAL FOR
			SELECT TIPO, SUBTIPO, TIPO_CB, SUBTIPO_CB, DESCRIPCION, CALCULA_IMP2 -- Columnas
			FROM INSERTED I

		SET @ACTUALIZAR_SOLICITUD = 1

		OPEN C_MODIFIED

		FETCH NEXT FROM C_MODIFIED
		INTO @TIPO, @SUBTIPO, @TIPO_CB, @SUBTIPO_CB, @DESCRIPCION, @CALCULA_IMP2

		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			IF ( NOT UPDATE(RECORDDATE) AND ( UPDATE(TIPO) OR UPDATE(SUBTIPO) OR UPDATE(TIPO_CB) OR UPDATE(SUBTIPO_CB) OR UPDATE(DESCRIPCION) OR UPDATE(CALCULA_IMP2) ) )
			BEGIN

				SELECT @COL_ROWPOINTER = ROWPOINTER 
				FROM $$Compania$$.SUBTIPO_DOC_CC
				WHERE TIPO = @TIPO AND SUBTIPO = @SUBTIPO 

				SET @PARAMETROS =
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<SUBTIPO_DOC_CC>' + 
				'<TIPO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO) + '</TIPO>' + 
				'<SUBTIPO Type="INT" PrimaryKey="True">' + ERPADMIN.POS_NumberToVarchar(@SUBTIPO) + '</SUBTIPO>' + 
				'<TIPO_CB Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_CB) + '</TIPO_CB>' + 
				'<SUBTIPO_CB Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@SUBTIPO_CB) + '</SUBTIPO_CB>' + 
				'<DESCRIPCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DESCRIPCION) + '</DESCRIPCION>' + 
				'<CALCULA_IMP2 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CALCULA_IMP2) + '</CALCULA_IMP2>' + 
				'</SUBTIPO_DOC_CC>'

				-- inserta la solicitud correspondiente
				EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'SUBTIPODOCCCPOS600', 'MODIFICA', @PARAMETROS, @ACTUALIZAR_SOLICITUD, @COL_ROWPOINTER
			END

			FETCH NEXT FROM C_MODIFIED
			INTO @TIPO, @SUBTIPO, @TIPO_CB, @SUBTIPO_CB, @DESCRIPCION, @CALCULA_IMP2
		END

		CLOSE C_MODIFIED
		DEALLOCATE C_MODIFIED
	END

	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para modificar la tabla SUBTIPO_DOC_CC.',16,1 )
	END
END
;




CREATE TRIGGER $$Compania$$.SUBTIPO_DOC_CC_POS_DEL
ON $$Compania$$.SUBTIPO_DOC_CC
FOR DELETE  
AS 
BEGIN   	
                DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @TIPO VARCHAR(3)
	DECLARE @SUBTIPO INT
	DECLARE @TIPO_CB VARCHAR(3)
	DECLARE @SUBTIPO_CB INT
	DECLARE @DESCRIPCION VARCHAR(25)
	 -- Declaraciones	

	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM 
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_DELETED CURSOR LOCAL FOR
			SELECT TIPO, SUBTIPO, TIPO_CB, SUBTIPO_CB, DESCRIPCION
			FROM DELETED d
			WHERE 0 = (
				SELECT COUNT('n')
				FROM INSERTED i
				WHERE d.TIPO = i.TIPO AND d.SUBTIPO = i.SUBTIPO
			   )

		OPEN C_DELETED
		FETCH NEXT FROM C_DELETED INTO 
		@TIPO, @SUBTIPO, @TIPO_CB, @SUBTIPO_CB, @DESCRIPCION -- VARIABLES
		
		SET @ERROR = 0
		
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS = 
								'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<SUBTIPO_DOC_CC>' + 
				'<TIPO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO) + '</TIPO>' + 
				'<SUBTIPO Type="INT" PrimaryKey="True">' + ERPADMIN.POS_NumberToVarchar(@SUBTIPO) + '</SUBTIPO>' + 
				'<TIPO_CB Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_CB) + '</TIPO_CB>' + 
				'<SUBTIPO_CB Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@SUBTIPO_CB) + '</SUBTIPO_CB>' + 
				'<DESCRIPCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DESCRIPCION) + '</DESCRIPCION>' + 
				'</SUBTIPO_DOC_CC>'
 
			
			-- inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'SUBTIPODOCCCPOS600', 'ELIMINA', @PARAMETROS, 0, ''
			
			FETCH NEXT FROM C_DELETED INTO 
			@TIPO, @SUBTIPO, @TIPO_CB, @SUBTIPO_CB, @DESCRIPCION -- VARIABLES
		END

		CLOSE C_DELETED
		DEALLOCATE C_DELETED
	END
	
	IF (@@ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para eliminar de la tabla SUBTIPO_DOC_CC.',16,1 )
	END
END
;


CREATE TRIGGER $$Compania$$.CONSEC_CAJA_POS_POS_INS
ON $$Compania$$.CONSEC_CAJA_POS
FOR INSERT
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @CODIGO VARCHAR(10)
	DECLARE @CAJA VARCHAR(6)
	DECLARE @DESCRIPCION VARCHAR(60)
	DECLARE @TIPO_DOCUMENTO VARCHAR(1)
	DECLARE @MASCARA VARCHAR(50)
	DECLARE @VALOR VARCHAR(50)
	DECLARE @CREDITO_FISCAL VARCHAR(1)
	DECLARE @FORMATO_IMPRESION VARCHAR(30)
	DECLARE @CONSEC_FAC_DEV VARCHAR(20)
	DECLARE @RESOLUCION VARCHAR(20)
	DECLARE @ACTIVO VARCHAR(1)
	DECLARE	@CLASE_DOCUMENTO VARCHAR(10)
	
	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM 
	FROM $$Compania$$.GLOBALES_POS

	-- Aqu se hace la validacin del usuario de conexin para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_INSERTED CURSOR LOCAL FOR
		SELECT CODIGO, CAJA, DESCRIPCION, TIPO_DOCUMENTO, MASCARA, VALOR, CREDITO_FISCAL, FORMATO_IMPRESION, CONSEC_FAC_DEV, RESOLUCION, ACTIVO, CLASE_DOCUMENTO
		FROM INSERTED i
		WHERE 0 = (
				SELECT COUNT('n')
				FROM DELETED d
				WHERE i.CODIGO = d.CODIGO AND i.CAJA = d.CAJA
			   )
			
		OPEN C_INSERTED	
		FETCH NEXT FROM C_INSERTED INTO
		@CODIGO, @CAJA, @DESCRIPCION, @TIPO_DOCUMENTO, @MASCARA, @VALOR, @CREDITO_FISCAL, @FORMATO_IMPRESION, @CONSEC_FAC_DEV, @RESOLUCION, @ACTIVO, @CLASE_DOCUMENTO

		SET @ERROR = 0
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS = 
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<CONSEC_CAJA_POS>' + 
				'<CODIGO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CODIGO) + '</CODIGO>' + 
				'<CAJA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CAJA) + '</CAJA>' + 
				'<DESCRIPCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DESCRIPCION) + '</DESCRIPCION>' + 
				'<TIPO_DOCUMENTO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_DOCUMENTO) + '</TIPO_DOCUMENTO>' + 
				'<MASCARA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@MASCARA) + '</MASCARA>' + 
				'<VALOR Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@VALOR) + '</VALOR>' + 
				'<CREDITO_FISCAL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CREDITO_FISCAL) + '</CREDITO_FISCAL>' + 
				'<FORMATO_IMPRESION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@FORMATO_IMPRESION) + '</FORMATO_IMPRESION>' + 
				'<CONSEC_FAC_DEV Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CONSEC_FAC_DEV) + '</CONSEC_FAC_DEV>' + 
				'<RESOLUCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@RESOLUCION) + '</RESOLUCION>' + 
				'<ACTIVO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ACTIVO) + '</ACTIVO>' + 
				'<CLASE_DOCUMENTO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CLASE_DOCUMENTO) + '</CLASE_DOCUMENTO>' +
				'</CONSEC_CAJA_POS>'


			-- Inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'CONSECCAJAPOSPOS600', 'INSERTA', @PARAMETROS, 0, ''

			FETCH NEXT FROM C_INSERTED INTO
			@CODIGO, @CAJA, @DESCRIPCION, @TIPO_DOCUMENTO, @MASCARA, @VALOR, @CREDITO_FISCAL, @FORMATO_IMPRESION, @CONSEC_FAC_DEV,@RESOLUCION,@ACTIVO, @CLASE_DOCUMENTO
		END

		CLOSE C_INSERTED
    		DEALLOCATE C_INSERTED
	END

	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla CONSEC_CAJA_POS.',16,1 )
	END
END;




CREATE TRIGGER $$Compania$$.CONSEC_CAJA_POS_POS_MOD
ON $$Compania$$.CONSEC_CAJA_POS
FOR UPDATE
AS 
BEGIN   	
	DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @COL_ROWPOINTER VARCHAR(36)
	DECLARE @HAY_CAMPOS_PARA_POS BIT
	DECLARE @ACTUALIZAR_SOLICITUD BIT
	DECLARE @CODIGO VARCHAR(10)
	DECLARE @CAJA VARCHAR(6)
	DECLARE @DESCRIPCION VARCHAR(60)
	DECLARE @TIPO_DOCUMENTO VARCHAR(1)
	DECLARE @MASCARA VARCHAR(50)
	DECLARE @VALOR VARCHAR(50)
	DECLARE @CREDITO_FISCAL VARCHAR(1)
	DECLARE @FORMATO_IMPRESION VARCHAR(30)
	DECLARE @CONSEC_FAC_DEV VARCHAR(20)
	DECLARE @RESOLUCION VARCHAR(20)
	DECLARE @ACTIVO VARCHAR(1)
	DECLARE	@CLASE_DOCUMENTO VARCHAR(10)
	
	 -- Declaraciones

	SET @ERROR = 0

	SELECT @PUBLICADOR = SITIO_LOCAL, @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS

	-- Aqu se hace la validacin del usuario de conexin para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_MODIFIED CURSOR LOCAL FOR
			SELECT CODIGO, CAJA, DESCRIPCION, TIPO_DOCUMENTO, MASCARA, VALOR, CREDITO_FISCAL, FORMATO_IMPRESION, CONSEC_FAC_DEV, RESOLUCION, ACTIVO, CLASE_DOCUMENTO  -- Columnas
			FROM INSERTED I

		SET @ACTUALIZAR_SOLICITUD = 1

		OPEN C_MODIFIED

		FETCH NEXT FROM C_MODIFIED
		INTO @CODIGO, @CAJA, @DESCRIPCION, @TIPO_DOCUMENTO, @MASCARA, @VALOR, @CREDITO_FISCAL, @FORMATO_IMPRESION, @CONSEC_FAC_DEV, @RESOLUCION, @ACTIVO, @CLASE_DOCUMENTO

		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			IF ( NOT UPDATE(RECORDDATE) AND ( UPDATE(CODIGO) OR UPDATE(CAJA) OR UPDATE(DESCRIPCION) OR UPDATE(TIPO_DOCUMENTO) OR UPDATE(MASCARA) OR UPDATE(VALOR) OR UPDATE(CREDITO_FISCAL) OR UPDATE(FORMATO_IMPRESION) OR UPDATE(CONSEC_FAC_DEV) OR UPDATE(RESOLUCION) OR UPDATE(ACTIVO) OR UPDATE(CLASE_DOCUMENTO)))
			BEGIN

				SELECT @COL_ROWPOINTER = ROWPOINTER 
				FROM $$Compania$$.CONSEC_CAJA_POS
				WHERE CODIGO = @CODIGO AND CAJA = @CAJA 

				SET @PARAMETROS =
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<CONSEC_CAJA_POS>' + 
				'<CODIGO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CODIGO) + '</CODIGO>' + 
				'<CAJA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CAJA) + '</CAJA>' + 
				'<DESCRIPCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DESCRIPCION) + '</DESCRIPCION>' + 
				'<TIPO_DOCUMENTO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_DOCUMENTO) + '</TIPO_DOCUMENTO>' + 
				'<MASCARA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@MASCARA) + '</MASCARA>' + 
				'<VALOR Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@VALOR) + '</VALOR>' + 
				'<CREDITO_FISCAL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CREDITO_FISCAL) + '</CREDITO_FISCAL>' + 
				'<FORMATO_IMPRESION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@FORMATO_IMPRESION) + '</FORMATO_IMPRESION>' + 
				'<CONSEC_FAC_DEV Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CONSEC_FAC_DEV) + '</CONSEC_FAC_DEV>' + 
				'<RESOLUCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@RESOLUCION) + '</RESOLUCION>' + 
				'<ACTIVO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ACTIVO) + '</ACTIVO>' + 
				'<CLASE_DOCUMENTO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CLASE_DOCUMENTO) + '</CLASE_DOCUMENTO>' + 
				'</CONSEC_CAJA_POS>'

				-- inserta la solicitud correspondiente
				EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'CONSECCAJAPOSPOS600', 'MODIFICA', @PARAMETROS, @ACTUALIZAR_SOLICITUD, @COL_ROWPOINTER
			END

			FETCH NEXT FROM C_MODIFIED
			INTO @CODIGO, @CAJA, @DESCRIPCION, @TIPO_DOCUMENTO, @MASCARA, @VALOR, @CREDITO_FISCAL, @FORMATO_IMPRESION, @CONSEC_FAC_DEV, @RESOLUCION, @ACTIVO, @CLASE_DOCUMENTO
		END

		CLOSE C_MODIFIED
		DEALLOCATE C_MODIFIED
	END

	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para modificar la tabla CONSEC_CAJA_POS.',16,1 )
	END
END;






CREATE TRIGGER $$Compania$$.CONSEC_CAJA_POS_POS_DEL
ON $$Compania$$.CONSEC_CAJA_POS
FOR DELETE  
AS 
BEGIN   	
    DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @CODIGO VARCHAR(10)
	DECLARE @CAJA VARCHAR(6)
	DECLARE @DESCRIPCION VARCHAR(60)
	DECLARE @TIPO_DOCUMENTO VARCHAR(1)
	DECLARE @MASCARA VARCHAR(50)
	DECLARE @VALOR VARCHAR(50)
	DECLARE @CREDITO_FISCAL VARCHAR(1)
	DECLARE @FORMATO_IMPRESION VARCHAR(30)
	DECLARE @CONSEC_FAC_DEV VARCHAR(20)
	 -- Declaraciones	

	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM 
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_DELETED CURSOR LOCAL FOR
			SELECT CODIGO, CAJA
			FROM DELETED d
			WHERE 0 = (
				SELECT COUNT('n')
				FROM INSERTED i
				WHERE d.CODIGO = i.CODIGO AND d.CAJA = i.CAJA
			   )

		OPEN C_DELETED
		FETCH NEXT FROM C_DELETED INTO 
		@CODIGO, @CAJA -- VARIABLES
		
		SET @ERROR = 0
		
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS = 
								'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<CONSEC_CAJA_POS>' + 
				'<CODIGO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CODIGO) + '</CODIGO>' + 
				'<CAJA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CAJA) + '</CAJA>' + 
				'</CONSEC_CAJA_POS>'
 
			
			-- inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'CONSECCAJAPOSPOS600', 'ELIMINA', @PARAMETROS, 0, ''
			
			FETCH NEXT FROM C_DELETED INTO 
			@CODIGO, @CAJA -- VARIABLES
		END

		CLOSE C_DELETED
		DEALLOCATE C_DELETED
	END
	
	IF (@@ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para eliminar de la tabla CONSEC_CAJA_POS.',16,1 )
	END	
END;



CREATE TRIGGER $$Compania$$.DETALLE_DIRECCION_POS_MOD
ON $$Compania$$.DETALLE_DIRECCION
FOR UPDATE
AS
BEGIN   	
DECLARE @ERROR  INT
DECLARE	@PUBLICADOR VARCHAR(20)
DECLARE	@PARAMETROS VARCHAR(8000)
DECLARE @USUARIO_POS_WSQM VARCHAR(100)
DECLARE @TIPO_SITIO_LOCAL VARCHAR(1)
DECLARE @COL_ROWPOINTER VARCHAR(36)
DECLARE @HAY_CAMPOS_PARA_POS BIT
DECLARE @ACTUALIZAR_SOLICITUD BIT
DECLARE @DETALLE_DIRECCION INT
DECLARE @DIRECCION VARCHAR(10)
DECLARE @CAMPO_1 VARCHAR(250)
DECLARE @CAMPO_2 VARCHAR(250)
DECLARE @CAMPO_3 VARCHAR(250)
DECLARE @CAMPO_4 VARCHAR(250)
DECLARE @CAMPO_5 VARCHAR(250)
DECLARE @CAMPO_6 VARCHAR(250)
DECLARE @CAMPO_7 VARCHAR(250)
DECLARE @CAMPO_8 VARCHAR(250)
DECLARE @CAMPO_9 VARCHAR(250)
DECLARE @CAMPO_10 VARCHAR(250)

DECLARE	@CLIENTE VARCHAR(20)
DECLARE	@NOMBRE_CAMPO1 VARCHAR(60)
DECLARE	@NOMBRE_CAMPO2 VARCHAR(60)
DECLARE	@NOMBRE_CAMPO3 VARCHAR(60)
DECLARE	@NOMBRE_CAMPO4 VARCHAR(60)
DECLARE	@NOMBRE_CAMPO5 VARCHAR(60)
DECLARE	@NOMBRE_CAMPO6 VARCHAR(60)
DECLARE	@NOMBRE_CAMPO7 VARCHAR(60)
DECLARE	@NOMBRE_CAMPO8 VARCHAR(60)
DECLARE	@NOMBRE_CAMPO9 VARCHAR(60)	
DECLARE	@NOMBRE_CAMPO10 VARCHAR(60)
DECLARE	@DIRECCION_CLIENTE VARCHAR(4000)	
	 
SET @ERROR = 0

  
	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM,
	       @TIPO_SITIO_LOCAL = TIPO_SITIO_LOCAL
	FROM $$Compania$$.GLOBALES_POS

  
-- Aquí se hace la validación del usuario de conexión para evitar ping-pong

 IF NOT (SYSTEM_USER = @USUARIO_POS_WSQM AND @TIPO_SITIO_LOCAL = 'T')
  BEGIN
        DECLARE C_MODIFIED CURSOR LOCAL FOR
        SELECT DETALLE_DIRECCION, DIRECCION, CAMPO_1, CAMPO_2, CAMPO_3, CAMPO_4, CAMPO_5, CAMPO_6, CAMPO_7, CAMPO_8, CAMPO_9, CAMPO_10 -- Columnas
          FROM INSERTED I
          
        SET @ACTUALIZAR_SOLICITUD = 1
    
    	OPEN C_MODIFIED
    	
	FETCH NEXT FROM C_MODIFIED
	INTO @DETALLE_DIRECCION, @DIRECCION, @CAMPO_1, @CAMPO_2, @CAMPO_3, @CAMPO_4, @CAMPO_5, @CAMPO_6, @CAMPO_7, @CAMPO_8, @CAMPO_9, @CAMPO_10

	WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
	BEGIN
		IF ( NOT UPDATE(RECORDDATE) AND ( UPDATE(DETALLE_DIRECCION) OR UPDATE(DIRECCION) OR UPDATE(CAMPO_1) OR UPDATE(CAMPO_2) OR UPDATE(CAMPO_3) OR UPDATE(CAMPO_4) OR UPDATE(CAMPO_5) OR UPDATE(CAMPO_6) OR UPDATE(CAMPO_7) OR UPDATE(CAMPO_8) OR UPDATE(CAMPO_9) OR UPDATE(CAMPO_10) ) )
		BEGIN
		
			SELECT @COL_ROWPOINTER = ROWPOINTER 
			FROM $$Compania$$.DETALLE_DIRECCION
			WHERE DETALLE_DIRECCION = @DETALLE_DIRECCION 

		
			SET @PARAMETROS = ''
			SET @DIRECCION_CLIENTE = ''
			
			--OBTIENE EL CODIGO DEL CLIENTE ASOCIADO AL DETALLE DE LA DIRECCION
			SELECT @CLIENTE  = CLIENTE 
			FROM $$Compania$$.CLIENTE (nolock) 
			WHERE detalle_direccion = @DETALLE_DIRECCION


			IF ISNULL(@CLIENTE,'') != '' 
			BEGIN
				--OBTIENE LOS NOMBRE DE LOS CAMPOS UTILIZADOS DEACUERDO AL TIPO DE DIRECCION 	

				SELECT @NOMBRE_CAMPO1 = NOMBRE_CAMPO_1,
					@NOMBRE_CAMPO2 = NOMBRE_CAMPO_2, 
					@NOMBRE_CAMPO3 = NOMBRE_CAMPO_3, 
					@NOMBRE_CAMPO4 = NOMBRE_CAMPO_4, 
					@NOMBRE_CAMPO5 = NOMBRE_CAMPO_5, 
					@NOMBRE_CAMPO6 = NOMBRE_CAMPO_6, 
					@NOMBRE_CAMPO7 = NOMBRE_CAMPO_7, 
					@NOMBRE_CAMPO8 = NOMBRE_CAMPO_8, 
					@NOMBRE_CAMPO9 = NOMBRE_CAMPO_9,
					@NOMBRE_CAMPO10 = NOMBRE_CAMPO_10
				FROM $$Compania$$.DIRECCION 
				WHERE DIRECCION = @DIRECCION

				--SE ARMA LA DIRECCION
				IF ISNULL(@CAMPO_1,'') != ''
				BEGIN
					SET @DIRECCION_CLIENTE = @NOMBRE_CAMPO1 + ': ' + @CAMPO_1 + ' '
				END

				IF ISNULL(@CAMPO_2,'') != ''
				BEGIN
					SET @DIRECCION_CLIENTE = @DIRECCION_CLIENTE + @NOMBRE_CAMPO2+': '+@CAMPO_2 +' '	
				END

				IF ISNULL(@CAMPO_3,'') != ''
				BEGIN
					SET @DIRECCION_CLIENTE = @DIRECCION_CLIENTE + @NOMBRE_CAMPO3+': '+@CAMPO_3+' '
				END

				IF ISNULL(@CAMPO_4,'') != ''
				BEGIN
					SET @DIRECCION_CLIENTE = @DIRECCION_CLIENTE + @NOMBRE_CAMPO4+': '+@CAMPO_4+' '
				END

				IF ISNULL(@CAMPO_5,'') != ''
				BEGIN
					SET @DIRECCION_CLIENTE = @DIRECCION_CLIENTE + @NOMBRE_CAMPO5+': '+@CAMPO_5+' '
				END

				IF ISNULL(@CAMPO_6,'') != ''
				BEGIN
					SET @DIRECCION_CLIENTE = @DIRECCION_CLIENTE + @NOMBRE_CAMPO6+': '+@CAMPO_6+' ' 
				END

				IF ISNULL(@CAMPO_7,'') != ''
				BEGIN
					SET @DIRECCION_CLIENTE = @DIRECCION_CLIENTE + @NOMBRE_CAMPO7+': '+@CAMPO_7+' ' 
				END

				IF ISNULL(@CAMPO_8,'') != ''
				BEGIN
					SET @DIRECCION_CLIENTE = @DIRECCION_CLIENTE + @NOMBRE_CAMPO8+': '+@CAMPO_8+' ' 
				END

				IF ISNULL(@CAMPO_9,'') != ''
				BEGIN
					SET @DIRECCION_CLIENTE = @DIRECCION_CLIENTE + @NOMBRE_CAMPO9+': '+@CAMPO_9+' '
				END

				IF ISNULL(@CAMPO_10,'') != ''
				BEGIN
					SET @DIRECCION_CLIENTE = @DIRECCION_CLIENTE + @NOMBRE_CAMPO10+': '+@CAMPO_10 
				END
				
				IF @DIRECCION_CLIENTE = ''
				BEGIN
					SET @DIRECCION_CLIENTE = '@$NULL$@'
				END

				SET @PARAMETROS =
					'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
					'<CLIENTE>' +
					'<CLIENTE Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CLIENTE) + '</CLIENTE>' +
					'<DIRECCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DIRECCION_CLIENTE) + '</DIRECCION>' +
					'</CLIENTE>'

				-- inserta la solicitud correspondiente
				EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR,'CLIENTEPOS600','MODIFICA',@PARAMETROS,0, ''
			END
			
			SET @PARAMETROS =
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
			'<DETALLE_DIRECCION>' + 
			'<DETALLE_DIRECCION Type="INT" PrimaryKey="True">' + ERPADMIN.POS_NumberToVarchar(@DETALLE_DIRECCION) + '</DETALLE_DIRECCION>' + 
			'<DIRECCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DIRECCION) + '</DIRECCION>' + 
			'<CAMPO_1 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CAMPO_1) + '</CAMPO_1>' + 
			'<CAMPO_2 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CAMPO_2) + '</CAMPO_2>' + 
			'<CAMPO_3 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CAMPO_3) + '</CAMPO_3>' + 
			'<CAMPO_4 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CAMPO_4) + '</CAMPO_4>' + 
			'<CAMPO_5 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CAMPO_5) + '</CAMPO_5>' + 
			'<CAMPO_6 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CAMPO_6) + '</CAMPO_6>' + 
			'<CAMPO_7 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CAMPO_7) + '</CAMPO_7>' + 
			'<CAMPO_8 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CAMPO_8) + '</CAMPO_8>' + 
			'<CAMPO_9 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CAMPO_9) + '</CAMPO_9>' + 
			'<CAMPO_10 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CAMPO_10) + '</CAMPO_10>' + 
			'</DETALLE_DIRECCION>'


			-- inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'DETALLEDIRECCIONPOS600', 'MODIFICA', @PARAMETROS, @ACTUALIZAR_SOLICITUD, @COL_ROWPOINTER

		END

		FETCH NEXT FROM C_MODIFIED
		INTO @DETALLE_DIRECCION, @DIRECCION, @CAMPO_1, @CAMPO_2, @CAMPO_3, @CAMPO_4, @CAMPO_5, @CAMPO_6, @CAMPO_7, @CAMPO_8, @CAMPO_9, @CAMPO_10
    	END

	CLOSE C_MODIFIED
	DEALLOCATE C_MODIFIED
  END

  IF (@@ERROR <> 0 OR @ERROR <> 0)
   BEGIN
     RAISERROR( 'Error generando la solicitud de servicio para modificar la tabla DETALLE_DIRECCION.',16,1 )
   END
END;




CREATE TRIGGER $$Compania$$.DETALLE_DIRECCION_POS_INS
ON $$Compania$$.DETALLE_DIRECCION
FOR INSERT
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @TIPO_SITIO_LOCAL VARCHAR(1)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @DETALLE_DIRECCION INT
	DECLARE @DIRECCION VARCHAR(10)
	DECLARE @CAMPO_1 VARCHAR(250)
	DECLARE @CAMPO_2 VARCHAR(250)
	DECLARE @CAMPO_3 VARCHAR(250)
	DECLARE @CAMPO_4 VARCHAR(250)
	DECLARE @CAMPO_5 VARCHAR(250)
	DECLARE @CAMPO_6 VARCHAR(250)
	DECLARE @CAMPO_7 VARCHAR(250)
	DECLARE @CAMPO_8 VARCHAR(250)
	DECLARE @CAMPO_9 VARCHAR(250)
	DECLARE @CAMPO_10 VARCHAR(250)

	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM,
	       @TIPO_SITIO_LOCAL = TIPO_SITIO_LOCAL
	FROM $$Compania$$.GLOBALES_POS


	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (SYSTEM_USER = @USUARIO_POS_WSQM AND @TIPO_SITIO_LOCAL = 'T')
	BEGIN
		DECLARE C_INSERTED CURSOR LOCAL FOR
		SELECT DETALLE_DIRECCION, DIRECCION, CAMPO_1, CAMPO_2, CAMPO_3, CAMPO_4, CAMPO_5, CAMPO_6, CAMPO_7, CAMPO_8, CAMPO_9, CAMPO_10
		FROM INSERTED i
			
		OPEN C_INSERTED	
		FETCH NEXT FROM C_INSERTED INTO
		@DETALLE_DIRECCION, @DIRECCION, @CAMPO_1, @CAMPO_2, @CAMPO_3, @CAMPO_4, @CAMPO_5, @CAMPO_6, @CAMPO_7, @CAMPO_8, @CAMPO_9, @CAMPO_10

		SET @ERROR = 0
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS = 
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<DETALLE_DIRECCION>' + 
				'<DETALLE_DIRECCION Type="INT" PrimaryKey="True">' + ERPADMIN.POS_NumberToVarchar(@DETALLE_DIRECCION) + '</DETALLE_DIRECCION>' + 
				'<DIRECCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DIRECCION) + '</DIRECCION>' + 
				'<CAMPO_1 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CAMPO_1) + '</CAMPO_1>' + 
				'<CAMPO_2 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CAMPO_2) + '</CAMPO_2>' + 
				'<CAMPO_3 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CAMPO_3) + '</CAMPO_3>' + 
				'<CAMPO_4 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CAMPO_4) + '</CAMPO_4>' + 
				'<CAMPO_5 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CAMPO_5) + '</CAMPO_5>' + 
				'<CAMPO_6 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CAMPO_6) + '</CAMPO_6>' + 
				'<CAMPO_7 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CAMPO_7) + '</CAMPO_7>' + 
				'<CAMPO_8 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CAMPO_8) + '</CAMPO_8>' + 
				'<CAMPO_9 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CAMPO_9) + '</CAMPO_9>' + 
				'<CAMPO_10 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CAMPO_10) + '</CAMPO_10>' + 
				'</DETALLE_DIRECCION>'

			-- Inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'DETALLEDIRECCIONPOS600', 'INSERTA', @PARAMETROS, 0, ''
			FETCH NEXT FROM C_INSERTED INTO
			@DETALLE_DIRECCION, @DIRECCION, @CAMPO_1, @CAMPO_2, @CAMPO_3, @CAMPO_4, @CAMPO_5, @CAMPO_6, @CAMPO_7, @CAMPO_8, @CAMPO_9, @CAMPO_10
		END
		CLOSE C_INSERTED
    		DEALLOCATE C_INSERTED
	END
	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla DETALLE_DIRECCION.',16,1 )
	END
END;



CREATE TRIGGER $$Compania$$.DETALLE_DIRECCION_POS_DEL
ON $$Compania$$.DETALLE_DIRECCION
FOR DELETE  
AS 
BEGIN   	
    DECLARE @ERROR  int
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @TIPO_SITIO_LOCAL VARCHAR(1)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @DETALLE_DIRECCION INT
	 -- Declaraciones	

	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM,
	       @TIPO_SITIO_LOCAL = TIPO_SITIO_LOCAL
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (SYSTEM_USER = @USUARIO_POS_WSQM AND @TIPO_SITIO_LOCAL = 'T')
	BEGIN
		DECLARE C_DELETED CURSOR LOCAL FOR
			SELECT DETALLE_DIRECCION
			FROM DELETED d

		OPEN C_DELETED
		FETCH NEXT FROM C_DELETED INTO 
		@DETALLE_DIRECCION -- VARIABLES
		
		SET @ERROR = 0
		
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS = 
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<DETALLE_DIRECCION>' + 
				'<DETALLE_DIRECCION Type="INT" PrimaryKey="True">' + ERPADMIN.POS_NumberToVarchar(@DETALLE_DIRECCION) + '</DETALLE_DIRECCION>' + 
				'</DETALLE_DIRECCION>'
			
			-- inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'DETALLEDIRECCIONPOS600', 'ELIMINA', @PARAMETROS, 0, ''
			
			FETCH NEXT FROM C_DELETED INTO 
			@DETALLE_DIRECCION -- VARIABLES
		END

		CLOSE C_DELETED
		DEALLOCATE C_DELETED
	END
	
	IF (@@ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para eliminar de la tabla DETALLE_DIRECCION.',16,1 )
	END
END;	
	




CREATE TRIGGER $$Compania$$.CONSECUTIVO_CI_POS_INS
ON $$Compania$$.CONSECUTIVO_CI
FOR INSERT
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @CONSECUTIVO VARCHAR(10)
	DECLARE @ULTIMO_USUARIO VARCHAR(25)
	DECLARE @DESCRIPCION VARCHAR(40)
	DECLARE @MASCARA VARCHAR(20)
	DECLARE @SIGUIENTE_CONSEC VARCHAR(20)
	DECLARE @EDITABLE VARCHAR(1)
	DECLARE @MULTIPLES_TRANS VARCHAR(1)
	DECLARE @FORMATO_IMP VARCHAR(254)
	DECLARE @ULT_FECHA_HORA DATETIME
	DECLARE @TODAS_TRANS VARCHAR(1)
	DECLARE @TIPO VARCHAR(4)
	

	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM 
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_INSERTED CURSOR LOCAL FOR
		SELECT CONSECUTIVO, ULTIMO_USUARIO, DESCRIPCION, MASCARA, SIGUIENTE_CONSEC, EDITABLE, MULTIPLES_TRANS, FORMATO_IMP, ULT_FECHA_HORA, TODAS_TRANS, TIPO
		FROM INSERTED i
		WHERE 0 = (
				SELECT COUNT('n')
				FROM DELETED d
				WHERE i.CONSECUTIVO = d.CONSECUTIVO
			   )
			
		OPEN C_INSERTED	
		FETCH NEXT FROM C_INSERTED INTO
		@CONSECUTIVO, @ULTIMO_USUARIO, @DESCRIPCION, @MASCARA, @SIGUIENTE_CONSEC, @EDITABLE, @MULTIPLES_TRANS, @FORMATO_IMP, @ULT_FECHA_HORA, @TODAS_TRANS, @TIPO

		SET @ERROR = 0
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS = 
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<CONSECUTIVO_CI>' + 
				'<CONSECUTIVO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CONSECUTIVO) + '</CONSECUTIVO>' + 
				'<ULTIMO_USUARIO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ULTIMO_USUARIO) + '</ULTIMO_USUARIO>' + 
				'<DESCRIPCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DESCRIPCION) + '</DESCRIPCION>' + 
				'<MASCARA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@MASCARA) + '</MASCARA>' + 
				'<SIGUIENTE_CONSEC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@SIGUIENTE_CONSEC) + '</SIGUIENTE_CONSEC>' + 
				'<EDITABLE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@EDITABLE) + '</EDITABLE>' + 
				'<MULTIPLES_TRANS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@MULTIPLES_TRANS) + '</MULTIPLES_TRANS>' + 
				'<FORMATO_IMP Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@FORMATO_IMP) + '</FORMATO_IMP>' + 
				'<ULT_FECHA_HORA Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@ULT_FECHA_HORA) + '</ULT_FECHA_HORA>' + 
				'<TODAS_TRANS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TODAS_TRANS) + '</TODAS_TRANS>' + 
				'<TIPO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO) + '</TIPO>' + 
				'</CONSECUTIVO_CI>'


			-- Inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'CONSECUTIVOCIPOS600', 'INSERTA', @PARAMETROS, 0, ''

			FETCH NEXT FROM C_INSERTED INTO
			@CONSECUTIVO, @ULTIMO_USUARIO, @DESCRIPCION, @MASCARA, @SIGUIENTE_CONSEC, @EDITABLE, @MULTIPLES_TRANS, @FORMATO_IMP, @ULT_FECHA_HORA, @TODAS_TRANS, @TIPO
		END

		CLOSE C_INSERTED
    		DEALLOCATE C_INSERTED
	END

	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla CONSECUTIVO_CI.',16,1 )
	END
END
;




CREATE TRIGGER $$Compania$$.CONSECUTIVO_CI_POS_DEL
ON $$Compania$$.CONSECUTIVO_CI
FOR DELETE  
AS 
BEGIN   	
                DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @CONSECUTIVO VARCHAR(10)
	 -- Declaraciones	

	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM 
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_DELETED CURSOR LOCAL FOR
			SELECT CONSECUTIVO
			FROM DELETED d
			WHERE 0 = (
				SELECT COUNT('n')
				FROM INSERTED i
				WHERE d.CONSECUTIVO = i.CONSECUTIVO
			   )

		OPEN C_DELETED
		FETCH NEXT FROM C_DELETED INTO 
		@CONSECUTIVO
		
		SET @ERROR = 0
		
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS = 
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<CONSECUTIVO_CI>' + 
				'<CONSECUTIVO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CONSECUTIVO) + '</CONSECUTIVO>' + 
				'</CONSECUTIVO_CI>'
 
			
			-- inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'CONSECUTIVOCIPOS600', 'ELIMINA', @PARAMETROS, 0, ''
			
			FETCH NEXT FROM C_DELETED INTO 
			@CONSECUTIVO
		END

		CLOSE C_DELETED
		DEALLOCATE C_DELETED
	END
	
	IF (@@ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para eliminar de la tabla CONSECUTIVO_CI.',16,1 )
	END
END
;




CREATE TRIGGER $$Compania$$.CONSECUTIVO_CI_POS_MOD
ON $$Compania$$.CONSECUTIVO_CI
FOR UPDATE
AS 
BEGIN   	
	DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @COL_ROWPOINTER VARCHAR(36)
	DECLARE @HAY_CAMPOS_PARA_POS BIT
	DECLARE @ACTUALIZAR_SOLICITUD BIT
	DECLARE @CONSECUTIVO VARCHAR(10)
	DECLARE @ULTIMO_USUARIO VARCHAR(25)
	DECLARE @DESCRIPCION VARCHAR(40)
	DECLARE @MASCARA VARCHAR(20)
	DECLARE @SIGUIENTE_CONSEC VARCHAR(20)
	DECLARE @EDITABLE VARCHAR(1)
	DECLARE @MULTIPLES_TRANS VARCHAR(1)
	DECLARE @FORMATO_IMP VARCHAR(254)
	DECLARE @ULT_FECHA_HORA DATETIME
	DECLARE @TODAS_TRANS VARCHAR(1)
	DECLARE @TIPO VARCHAR(4)
	 -- Declaraciones

	SET @ERROR = 0

	SELECT @PUBLICADOR = SITIO_LOCAL, @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_MODIFIED CURSOR LOCAL FOR
			SELECT CONSECUTIVO, ULTIMO_USUARIO, DESCRIPCION, MASCARA, SIGUIENTE_CONSEC, EDITABLE, MULTIPLES_TRANS, FORMATO_IMP, ULT_FECHA_HORA, TODAS_TRANS, TIPO -- Columnas
			FROM INSERTED I

		SET @ACTUALIZAR_SOLICITUD = 1

		OPEN C_MODIFIED

		FETCH NEXT FROM C_MODIFIED
		INTO @CONSECUTIVO, @ULTIMO_USUARIO, @DESCRIPCION, @MASCARA, @SIGUIENTE_CONSEC, @EDITABLE, @MULTIPLES_TRANS, @FORMATO_IMP, @ULT_FECHA_HORA, @TODAS_TRANS, @TIPO

		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			IF ( NOT UPDATE(RECORDDATE) AND ( UPDATE(CONSECUTIVO) OR UPDATE(ULTIMO_USUARIO) OR UPDATE(DESCRIPCION) OR UPDATE(MASCARA) OR UPDATE(EDITABLE) OR UPDATE(MULTIPLES_TRANS) OR UPDATE(FORMATO_IMP) OR UPDATE(ULT_FECHA_HORA) OR UPDATE(TODAS_TRANS) OR UPDATE(TIPO) ) )
			BEGIN

				SELECT @COL_ROWPOINTER = ROWPOINTER 
				FROM $$Compania$$.CONSECUTIVO_CI
				WHERE CONSECUTIVO = @CONSECUTIVO 

				SET @PARAMETROS =
					'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<CONSECUTIVO_CI>' + 
				'<CONSECUTIVO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CONSECUTIVO) + '</CONSECUTIVO>' + 
				'<ULTIMO_USUARIO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ULTIMO_USUARIO) + '</ULTIMO_USUARIO>' + 
				'<DESCRIPCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DESCRIPCION) + '</DESCRIPCION>' + 
				'<MASCARA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@MASCARA) + '</MASCARA>' + 
				'<SIGUIENTE_CONSEC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@SIGUIENTE_CONSEC) + '</SIGUIENTE_CONSEC>' + 
				'<EDITABLE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@EDITABLE) + '</EDITABLE>' + 
				'<MULTIPLES_TRANS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@MULTIPLES_TRANS) + '</MULTIPLES_TRANS>' + 
				'<FORMATO_IMP Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@FORMATO_IMP) + '</FORMATO_IMP>' + 
				'<ULT_FECHA_HORA Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@ULT_FECHA_HORA) + '</ULT_FECHA_HORA>' + 
				'<TODAS_TRANS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TODAS_TRANS) + '</TODAS_TRANS>' + 
				'<TIPO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO) + '</TIPO>' + 
				'</CONSECUTIVO_CI>'


				-- inserta la solicitud correspondiente
				EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'CONSECUTIVOCIPOS600', 'MODIFICA', @PARAMETROS, @ACTUALIZAR_SOLICITUD, @COL_ROWPOINTER
			END

			FETCH NEXT FROM C_MODIFIED
			INTO @CONSECUTIVO, @ULTIMO_USUARIO, @DESCRIPCION, @MASCARA, @SIGUIENTE_CONSEC, @EDITABLE, @MULTIPLES_TRANS, @FORMATO_IMP, @ULT_FECHA_HORA, @TODAS_TRANS, @TIPO
		END

		CLOSE C_MODIFIED
		DEALLOCATE C_MODIFIED
	END

	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para modificar la tabla CONSECUTIVO_CI.',16,1 )
	END
END
;




CREATE TRIGGER $$Compania$$.BONO_PAGO_POS_INS
ON $$Compania$$.BONO_PAGO
FOR INSERT
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @CODIGO VARCHAR(20)
	DECLARE @DESCRIPCION VARCHAR(60)
	DECLARE @ESTADO VARCHAR(1)
	DECLARE @FECHA_INI DATETIME
	DECLARE @FECHA_FIN DATETIME
	DECLARE @MONTO_MINIMO DECIMAL(28,8)
	DECLARE @TIPO_DESCUENTO VARCHAR(1)
	DECLARE @VALOR DECIMAL(28,8)
	DECLARE @TODA_TIENDA VARCHAR(1)
	DECLARE @TODA_CATEGORIA VARCHAR(1)
	DECLARE @APLICAR_SUBTOTAL VARCHAR(1)
	

	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM 
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_INSERTED CURSOR LOCAL FOR
		SELECT CODIGO, DESCRIPCION, ESTADO, FECHA_INI, FECHA_FIN, MONTO_MINIMO, TIPO_DESCUENTO, VALOR, TODA_TIENDA, TODA_CATEGORIA, APLICAR_SUBTOTAL
		FROM INSERTED i
		WHERE 0 = (
				SELECT COUNT('n')
				FROM DELETED d
				WHERE i.CODIGO = d.CODIGO
			   )
			
		OPEN C_INSERTED	
		FETCH NEXT FROM C_INSERTED INTO
		@CODIGO, @DESCRIPCION, @ESTADO, @FECHA_INI, @FECHA_FIN, @MONTO_MINIMO, @TIPO_DESCUENTO, @VALOR, @TODA_TIENDA, @TODA_CATEGORIA, @APLICAR_SUBTOTAL

		SET @ERROR = 0
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS = 
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<BONO_PAGO>' + 
				'<CODIGO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CODIGO) + '</CODIGO>' + 
				'<DESCRIPCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DESCRIPCION) + '</DESCRIPCION>' + 
				'<ESTADO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ESTADO) + '</ESTADO>' + 
				'<FECHA_INI Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_INI) + '</FECHA_INI>' + 
				'<FECHA_FIN Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_FIN) + '</FECHA_FIN>' + 
				'<MONTO_MINIMO Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@MONTO_MINIMO) + '</MONTO_MINIMO>' + 
				'<TIPO_DESCUENTO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_DESCUENTO) + '</TIPO_DESCUENTO>' + 
				'<VALOR Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@VALOR) + '</VALOR>' + 
				'<TODA_TIENDA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TODA_TIENDA) + '</TODA_TIENDA>' + 
				'<TODA_CATEGORIA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TODA_CATEGORIA) + '</TODA_CATEGORIA>' + 
				'<APLICAR_SUBTOTAL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@APLICAR_SUBTOTAL) + '</APLICAR_SUBTOTAL>' + 
				'</BONO_PAGO>'


			-- Inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'BONOPAGOPOS600', 'INSERTA', @PARAMETROS, 0, ''

			FETCH NEXT FROM C_INSERTED INTO
			@CODIGO, @DESCRIPCION, @ESTADO, @FECHA_INI, @FECHA_FIN, @MONTO_MINIMO, @TIPO_DESCUENTO, @VALOR, @TODA_TIENDA, @TODA_CATEGORIA, @APLICAR_SUBTOTAL
		END

		CLOSE C_INSERTED
    		DEALLOCATE C_INSERTED
	END

	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla BONO_PAGO.',16,1 )
	END
END
;
CREATE TRIGGER $$Compania$$.BONO_PAGO_POS_MOD
ON $$Compania$$.BONO_PAGO
FOR UPDATE
AS 
BEGIN   	
	DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @COL_ROWPOINTER VARCHAR(36)
	DECLARE @HAY_CAMPOS_PARA_POS BIT
	DECLARE @ACTUALIZAR_SOLICITUD BIT
	DECLARE @CODIGO VARCHAR(20)
	DECLARE @DESCRIPCION VARCHAR(60)
	DECLARE @ESTADO VARCHAR(1)
	DECLARE @FECHA_INI DATETIME
	DECLARE @FECHA_FIN DATETIME
	DECLARE @MONTO_MINIMO DECIMAL(28,8)
	DECLARE @TIPO_DESCUENTO VARCHAR(1)
	DECLARE @VALOR DECIMAL(28,8)
	DECLARE @TODA_TIENDA VARCHAR(1)
	DECLARE @TODA_CATEGORIA VARCHAR(1)
	DECLARE @APLICAR_SUBTOTAL VARCHAR(1)
	 -- Declaraciones

	SET @ERROR = 0

	SELECT @PUBLICADOR = SITIO_LOCAL, @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_MODIFIED CURSOR LOCAL FOR
			SELECT CODIGO, DESCRIPCION, ESTADO, FECHA_INI, FECHA_FIN, MONTO_MINIMO, TIPO_DESCUENTO, VALOR, TODA_TIENDA, TODA_CATEGORIA, APLICAR_SUBTOTAL -- Columnas
			FROM INSERTED I

		SET @ACTUALIZAR_SOLICITUD = 1

		OPEN C_MODIFIED

		FETCH NEXT FROM C_MODIFIED
		INTO @CODIGO, @DESCRIPCION, @ESTADO, @FECHA_INI, @FECHA_FIN, @MONTO_MINIMO, @TIPO_DESCUENTO, @VALOR, @TODA_TIENDA, @TODA_CATEGORIA, @APLICAR_SUBTOTAL

		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			IF ( NOT UPDATE(RECORDDATE) AND ( UPDATE(CODIGO) OR UPDATE(DESCRIPCION) OR UPDATE(ESTADO) OR UPDATE(FECHA_INI) OR UPDATE(FECHA_FIN) OR UPDATE(MONTO_MINIMO) OR UPDATE(TIPO_DESCUENTO) OR UPDATE(VALOR) OR UPDATE(TODA_TIENDA) OR UPDATE(TODA_CATEGORIA) OR UPDATE(APLICAR_SUBTOTAL) ) )
			BEGIN

				SELECT @COL_ROWPOINTER = ROWPOINTER 
				FROM $$Compania$$.BONO_PAGO
				WHERE CODIGO = @CODIGO 

				SET @PARAMETROS =
					'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<BONO_PAGO>' + 
				'<CODIGO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CODIGO) + '</CODIGO>' + 
				'<DESCRIPCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DESCRIPCION) + '</DESCRIPCION>' + 
				'<ESTADO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ESTADO) + '</ESTADO>' + 
				'<FECHA_INI Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_INI) + '</FECHA_INI>' + 
				'<FECHA_FIN Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_FIN) + '</FECHA_FIN>' + 
				'<MONTO_MINIMO Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@MONTO_MINIMO) + '</MONTO_MINIMO>' + 
				'<TIPO_DESCUENTO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_DESCUENTO) + '</TIPO_DESCUENTO>' + 
				'<VALOR Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@VALOR) + '</VALOR>' + 
				'<TODA_TIENDA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TODA_TIENDA) + '</TODA_TIENDA>' + 
				'<TODA_CATEGORIA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TODA_CATEGORIA) + '</TODA_CATEGORIA>' + 
				'<APLICAR_SUBTOTAL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@APLICAR_SUBTOTAL) + '</APLICAR_SUBTOTAL>' + 
				'</BONO_PAGO>'


				-- inserta la solicitud correspondiente
				EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'BONOPAGOPOS600', 'MODIFICA', @PARAMETROS, @ACTUALIZAR_SOLICITUD, @COL_ROWPOINTER
			END

			FETCH NEXT FROM C_MODIFIED
			INTO @CODIGO, @DESCRIPCION, @ESTADO, @FECHA_INI, @FECHA_FIN, @MONTO_MINIMO, @TIPO_DESCUENTO, @VALOR, @TODA_TIENDA, @TODA_CATEGORIA, @APLICAR_SUBTOTAL
		END

		CLOSE C_MODIFIED
		DEALLOCATE C_MODIFIED
	END

	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para modificar la tabla BONO_PAGO.',16,1 )
	END
END
;




CREATE TRIGGER $$Compania$$.BONO_PAGO_POS_DEL
ON $$Compania$$.BONO_PAGO
FOR DELETE  
AS 
BEGIN   	
        DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @CODIGO VARCHAR(20)
	DECLARE @DESCRIPCION VARCHAR(60)
	DECLARE @ESTADO VARCHAR(1)
	DECLARE @FECHA_INI DATETIME
	DECLARE @FECHA_FIN DATETIME
	DECLARE @MONTO_MINIMO DECIMAL(28,8)
	DECLARE @TIPO_DESCUENTO VARCHAR(1)
	DECLARE @VALOR DECIMAL(28,8)
	DECLARE @TODA_TIENDA VARCHAR(1)
	DECLARE @TODA_CATEGORIA VARCHAR(1)
	DECLARE @APLICAR_SUBTOTAL VARCHAR(1)
	 -- Declaraciones	

	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM 
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_DELETED CURSOR LOCAL FOR
			SELECT CODIGO
			FROM DELETED d
			WHERE 0 = (
				SELECT COUNT('n')
				FROM INSERTED i
				WHERE d.CODIGO = i.CODIGO
			   )

		OPEN C_DELETED
		FETCH NEXT FROM C_DELETED INTO 
		@CODIGO
		
		SET @ERROR = 0
		
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS = 
								'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<BONO_PAGO>' + 
				'<CODIGO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CODIGO) + '</CODIGO>' +
				'</BONO_PAGO>'
 
			
			-- inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'BONOPAGOPOS600', 'ELIMINA', @PARAMETROS, 0, ''
			
			FETCH NEXT FROM C_DELETED INTO 
			@CODIGO -- VARIABLES
		END

		CLOSE C_DELETED
		DEALLOCATE C_DELETED
	END
	
	IF (@@ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para eliminar de la tabla BONO_PAGO.',16,1 )
	END
END
;





CREATE TRIGGER $$Compania$$.BONO_TIENDA_POS_INS
ON $$Compania$$.BONO_TIENDA
FOR INSERT
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @CODIGO VARCHAR(20)
	DECLARE @TIENDA VARCHAR(6)
	

	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM 
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_INSERTED CURSOR LOCAL FOR
		SELECT CODIGO, TIENDA
		FROM INSERTED i
		WHERE 0 = (
				SELECT COUNT('n')
				FROM DELETED d
				WHERE i.CODIGO = d.CODIGO AND i.TIENDA = d.TIENDA
			   )
			
		OPEN C_INSERTED	
		FETCH NEXT FROM C_INSERTED INTO
		@CODIGO, @TIENDA

		SET @ERROR = 0
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS = 
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<BONO_TIENDA>' + 
				'<CODIGO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CODIGO) + '</CODIGO>' + 
				'<TIENDA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@TIENDA) + '</TIENDA>' + 
				'</BONO_TIENDA>'


			-- Inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'BONOTIENDAPOS600', 'INSERTA', @PARAMETROS, 0, ''

			FETCH NEXT FROM C_INSERTED INTO
			@CODIGO, @TIENDA
		END

		CLOSE C_INSERTED
    		DEALLOCATE C_INSERTED
	END

	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla BONO_TIENDA.',16,1 )
	END
END
;




CREATE TRIGGER $$Compania$$.BONO_TIENDA_POS_MOD
ON $$Compania$$.BONO_TIENDA
FOR UPDATE
AS 
BEGIN   	
	DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @COL_ROWPOINTER VARCHAR(36)
	DECLARE @HAY_CAMPOS_PARA_POS BIT
	DECLARE @ACTUALIZAR_SOLICITUD BIT
	DECLARE @CODIGO VARCHAR(20)
	DECLARE @TIENDA VARCHAR(6)
	 -- Declaraciones

	SET @ERROR = 0

	SELECT @PUBLICADOR = SITIO_LOCAL, @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_MODIFIED CURSOR LOCAL FOR
			SELECT CODIGO, TIENDA -- Columnas
			FROM INSERTED I

		SET @ACTUALIZAR_SOLICITUD = 1

		OPEN C_MODIFIED

		FETCH NEXT FROM C_MODIFIED
		INTO @CODIGO, @TIENDA

		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			IF ( NOT UPDATE(RECORDDATE) AND ( UPDATE(CODIGO) OR UPDATE(TIENDA) ) )
			BEGIN

				SELECT @COL_ROWPOINTER = ROWPOINTER 
				FROM $$Compania$$.BONO_TIENDA
				WHERE CODIGO = @CODIGO AND TIENDA = @TIENDA 

				SET @PARAMETROS =
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<BONO_TIENDA>' + 
				'<CODIGO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CODIGO) + '</CODIGO>' + 
				'<TIENDA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@TIENDA) + '</TIENDA>' + 
				'</BONO_TIENDA>'


				-- inserta la solicitud correspondiente
				EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'BONOTIENDAPOS600', 'MODIFICA', @PARAMETROS, @ACTUALIZAR_SOLICITUD, @COL_ROWPOINTER
			END

			FETCH NEXT FROM C_MODIFIED
			INTO @CODIGO, @TIENDA
		END

		CLOSE C_MODIFIED
		DEALLOCATE C_MODIFIED
	END

	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para modificar la tabla BONO_TIENDA.',16,1 )
	END
END
;






CREATE TRIGGER $$Compania$$.BONO_TIENDA_POS_DEL
ON $$Compania$$.BONO_TIENDA
FOR DELETE  
AS 
BEGIN   	
                DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @CODIGO VARCHAR(20)
	DECLARE @TIENDA VARCHAR(6)
	 -- Declaraciones	

	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM 
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_DELETED CURSOR LOCAL FOR
			SELECT CODIGO, TIENDA
			FROM DELETED d
			WHERE 0 = (
				SELECT COUNT('n')
				FROM INSERTED i
				WHERE d.CODIGO = i.CODIGO AND d.TIENDA = i.TIENDA
			   )

		OPEN C_DELETED
		FETCH NEXT FROM C_DELETED INTO 
		@CODIGO, @TIENDA -- VARIABLES
		
		SET @ERROR = 0
		
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS = 
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<BONO_TIENDA>' + 
				'<CODIGO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CODIGO) + '</CODIGO>' + 
				'<TIENDA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@TIENDA) + '</TIENDA>' + 
				'</BONO_TIENDA>'
 
			
			-- inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'BONOTIENDAPOS600', 'ELIMINA', @PARAMETROS, 0, ''
			
			FETCH NEXT FROM C_DELETED INTO 
			@CODIGO, @TIENDA -- VARIABLES
		END

		CLOSE C_DELETED
		DEALLOCATE C_DELETED
	END
	
	IF (@@ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para eliminar de la tabla BONO_TIENDA.',16,1 )
	END
END
;




CREATE TRIGGER $$Compania$$.BONO_CATEGORIA_POS_INS
ON $$Compania$$.BONO_CATEGORIA
FOR INSERT
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @CODIGO VARCHAR(20)
	DECLARE @CATEGORIA_CLIENTE VARCHAR(8)
	

	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM 
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_INSERTED CURSOR LOCAL FOR
		SELECT CODIGO, CATEGORIA_CLIENTE
		FROM INSERTED i
		WHERE 0 = (
				SELECT COUNT('n')
				FROM DELETED d
				WHERE i.CODIGO = d.CODIGO AND i.CATEGORIA_CLIENTE = d.CATEGORIA_CLIENTE
			   )
			
		OPEN C_INSERTED	
		FETCH NEXT FROM C_INSERTED INTO
		@CODIGO, @CATEGORIA_CLIENTE

		SET @ERROR = 0
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS = 
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<BONO_CATEGORIA>' + 
				'<CODIGO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CODIGO) + '</CODIGO>' + 
				'<CATEGORIA_CLIENTE Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CATEGORIA_CLIENTE) + '</CATEGORIA_CLIENTE>' + 
				'</BONO_CATEGORIA>'


			-- Inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'BONOCATEGORIAPOS600', 'INSERTA', @PARAMETROS, 0, ''

			FETCH NEXT FROM C_INSERTED INTO
			@CODIGO, @CATEGORIA_CLIENTE
		END

		CLOSE C_INSERTED
    		DEALLOCATE C_INSERTED
	END

	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla BONO_CATEGORIA.',16,1 )
	END
END
;





CREATE TRIGGER $$Compania$$.BONO_CATEGORIA_POS_MOD
ON $$Compania$$.BONO_CATEGORIA
FOR UPDATE
AS 
BEGIN   	
	DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @COL_ROWPOINTER VARCHAR(36)
	DECLARE @HAY_CAMPOS_PARA_POS BIT
	DECLARE @ACTUALIZAR_SOLICITUD BIT
	DECLARE @CODIGO VARCHAR(20)
	DECLARE @CATEGORIA_CLIENTE VARCHAR(8)
	 -- Declaraciones

	SET @ERROR = 0

	SELECT @PUBLICADOR = SITIO_LOCAL, @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_MODIFIED CURSOR LOCAL FOR
			SELECT CODIGO, CATEGORIA_CLIENTE -- Columnas
			FROM INSERTED I

		SET @ACTUALIZAR_SOLICITUD = 1

		OPEN C_MODIFIED

		FETCH NEXT FROM C_MODIFIED
		INTO @CODIGO, @CATEGORIA_CLIENTE

		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			IF ( NOT UPDATE(RECORDDATE) AND ( UPDATE(CODIGO) OR UPDATE(CATEGORIA_CLIENTE) ) )
			BEGIN

				SELECT @COL_ROWPOINTER = ROWPOINTER 
				FROM $$Compania$$.BONO_CATEGORIA
				WHERE CODIGO = @CODIGO AND CATEGORIA_CLIENTE = @CATEGORIA_CLIENTE 

				SET @PARAMETROS =
					'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<BONO_CATEGORIA>' + 
				'<CODIGO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CODIGO) + '</CODIGO>' + 
				'<CATEGORIA_CLIENTE Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CATEGORIA_CLIENTE) + '</CATEGORIA_CLIENTE>' + 
				'</BONO_CATEGORIA>'


				-- inserta la solicitud correspondiente
				EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'BONOCATEGORIAPOS600', 'MODIFICA', @PARAMETROS, @ACTUALIZAR_SOLICITUD, @COL_ROWPOINTER
			END

			FETCH NEXT FROM C_MODIFIED
			INTO @CODIGO, @CATEGORIA_CLIENTE
		END

		CLOSE C_MODIFIED
		DEALLOCATE C_MODIFIED
	END

	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para modificar la tabla BONO_CATEGORIA.',16,1 )
	END
END
;





CREATE TRIGGER $$Compania$$.BONO_CATEGORIA_POS_DEL
ON $$Compania$$.BONO_CATEGORIA
FOR DELETE  
AS 
BEGIN   	
                DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @CODIGO VARCHAR(20)
	DECLARE @CATEGORIA_CLIENTE VARCHAR(8)
	 -- Declaraciones	

	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM 
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_DELETED CURSOR LOCAL FOR
			SELECT CODIGO, CATEGORIA_CLIENTE
			FROM DELETED d
			WHERE 0 = (
				SELECT COUNT('n')
				FROM INSERTED i
				WHERE d.CODIGO = i.CODIGO AND d.CATEGORIA_CLIENTE = i.CATEGORIA_CLIENTE
			   )

		OPEN C_DELETED
		FETCH NEXT FROM C_DELETED INTO 
		@CODIGO, @CATEGORIA_CLIENTE -- VARIABLES
		
		SET @ERROR = 0
		
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS = 
								'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<BONO_CATEGORIA>' + 
				'<CODIGO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CODIGO) + '</CODIGO>' + 
				'<CATEGORIA_CLIENTE Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CATEGORIA_CLIENTE) + '</CATEGORIA_CLIENTE>' + 
				'</BONO_CATEGORIA>'
 
			
			-- inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'BONOCATEGORIAPOS600', 'ELIMINA', @PARAMETROS, 0, ''
			
			FETCH NEXT FROM C_DELETED INTO 
			@CODIGO, @CATEGORIA_CLIENTE -- VARIABLES
		END

		CLOSE C_DELETED
		DEALLOCATE C_DELETED
	END
	
	IF (@@ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para eliminar de la tabla BONO_CATEGORIA.',16,1 )
	END
END
;


CREATE TRIGGER $$Compania$$.GLOBALES_CC_POS_INS
ON $$Compania$$.GLOBALES_CC
FOR INSERT
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @PARAMETROS2 VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @ULT_NOTA_CREDITO VARCHAR(20)
	DECLARE @ULT_NOTA_DEBITO VARCHAR(20)
	DECLARE @ULT_INTERES_MORA VARCHAR(20)
	DECLARE @ULT_RECIBO_DINERO VARCHAR(20)
	DECLARE @ULT_FACTURA VARCHAR(20)
	DECLARE @ULT_OTRO_CREDITO VARCHAR(20)
	DECLARE @ULT_OTRO_DEBITO VARCHAR(20)
	DECLARE @ULT_RETENCION VARCHAR(50)
	DECLARE @FECHA_ULT_COMPRIME DATETIME
	DECLARE @LIMPIAR_APLICACION VARCHAR(1)
	DECLARE @INTRO_FACTURAS VARCHAR(1)
	DECLARE @TIPO_ASIENTO_DEB VARCHAR(4)
	DECLARE @PAQUETE_DEB VARCHAR(4)
	DECLARE @TIPO_ASIENTO_CRE VARCHAR(4)
	DECLARE @PAQUETE_CRE VARCHAR(4)
	DECLARE @VENC_PERIODO1 INT
	DECLARE @VENC_PERIODO2 INT
	DECLARE @VENC_PERIODO3 INT
	DECLARE @VENC_PERIODO4 INT
	DECLARE @ANT_PERIODO1 INT
	DECLARE @ANT_PERIODO2 INT
	DECLARE @ANT_PERIODO3 INT
	DECLARE @ANT_PERIODO4 INT
	DECLARE @ASIENTO_FAC VARCHAR(1)
	DECLARE @ASIENTO_INT VARCHAR(1)
	DECLARE @ASIENTO_ND VARCHAR(1)
	DECLARE @ASIENTO_OD VARCHAR(1)
	DECLARE @ASIENTO_LC VARCHAR(1)
	DECLARE @ASIENTO_REC VARCHAR(1)
	DECLARE @ASIENTO_NC VARCHAR(1)
	DECLARE @ASIENTO_OC VARCHAR(1)
	DECLARE @ASIENTO_DEP VARCHAR(1)
	DECLARE @ASIENTO_TEF VARCHAR(1)
	DECLARE @ASIENTOS_CTA_PAIS VARCHAR(1)
	DECLARE @TIPO_CONTA_OMISION VARCHAR(1)
	DECLARE @INTEGRACION_CONTA VARCHAR(1)
	DECLARE @MOD_APLIC_ASIENTO INT
	DECLARE @NIT_DUPLICADO VARCHAR(1)
	DECLARE @REFRESCA_AUTO VARCHAR(1)
	DECLARE @DOC_PRONTO_PAGO VARCHAR(3)
	DECLARE @DETALLE_OBLIGAT VARCHAR(1)
	DECLARE @USAR_RUBROS VARCHAR(1)
	DECLARE @RUBRO1_NOMBRE VARCHAR(15)
	DECLARE @RUBRO2_NOMBRE VARCHAR(15)
	DECLARE @IMPUESTO_X_OMISION VARCHAR(4)
	DECLARE @USAR_RUBROS_CLI VARCHAR(1)
	DECLARE @RUBRO1_CLI_NOMBRE VARCHAR(15)
	DECLARE @RUBRO2_CLI_NOMBRE VARCHAR(15)
	DECLARE @RUBRO3_CLI_NOMBRE VARCHAR(15)
	DECLARE @RUBRO4_CLI_NOMBRE VARCHAR(15)
	DECLARE @RUBRO5_CLI_NOMBRE VARCHAR(15)
	DECLARE @COPIARNOTASENASNT VARCHAR(1)
	DECLARE @ASOCOBLIGCONTFACT VARCHAR(1)
	DECLARE @VENC_PERIODO5 INT
	DECLARE @VENC_PERIODO6 INT
	DECLARE @ANT_PERIODO5 INT
	DECLARE @ANT_PERIODO6 INT
	DECLARE @ASOCIACION_DE_DOCS VARCHAR(1)
	DECLARE @NOM_RUBRO1_CLI VARCHAR(60)
	DECLARE @NOM_RUBRO2_CLI VARCHAR(60)
	DECLARE @NOM_RUBRO3_CLI VARCHAR(60)
	DECLARE @NOM_RUBRO4_CLI VARCHAR(60)
	DECLARE @NOM_RUBRO5_CLI VARCHAR(60)
	DECLARE @USAR_RUBROS_VAL VARCHAR(1)
	DECLARE @FORMA_CREACION VARCHAR(1)
	DECLARE @RUBROS_DIAS_REV INT
	DECLARE @ASIENTO_INTC VARCHAR(1)
	DECLARE @ULT_INTERES_CTE VARCHAR(20)
	DECLARE @FECHA_ULT_DIFCAMB DATETIME
	DECLARE @ULT_LETRACAMBIO VARCHAR(20)
	DECLARE @ULT_DEPOSITO VARCHAR(20)
	DECLARE @ULT_TEF VARCHAR(20)
	DECLARE @ULT_RETDEBITO VARCHAR(50)
	DECLARE @NOM_RUBRO11_CLI VARCHAR(60)
	DECLARE @NOM_RUBRO12_CLI VARCHAR(60)
	DECLARE @NOM_RUBRO13_CLI VARCHAR(60)
	DECLARE @NOM_RUBRO14_CLI VARCHAR(60)
	DECLARE @NOM_RUBRO15_CLI VARCHAR(60)
	

	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM 
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_INSERTED CURSOR LOCAL FOR
		SELECT ULT_NOTA_CREDITO, ULT_NOTA_DEBITO, ULT_INTERES_MORA, ULT_RECIBO_DINERO, ULT_FACTURA, ULT_OTRO_CREDITO, ULT_OTRO_DEBITO, ULT_RETENCION, FECHA_ULT_COMPRIME, LIMPIAR_APLICACION, INTRO_FACTURAS, TIPO_ASIENTO_DEB, PAQUETE_DEB, TIPO_ASIENTO_CRE, PAQUETE_CRE, VENC_PERIODO1, VENC_PERIODO2, VENC_PERIODO3, VENC_PERIODO4, ANT_PERIODO1, ANT_PERIODO2, ANT_PERIODO3, ANT_PERIODO4, ASIENTO_FAC, ASIENTO_INT, ASIENTO_ND, ASIENTO_OD, ASIENTO_LC, ASIENTO_REC, ASIENTO_NC, ASIENTO_OC, ASIENTO_DEP, ASIENTO_TEF, ASIENTOS_CTA_PAIS, TIPO_CONTA_OMISION, INTEGRACION_CONTA, MOD_APLIC_ASIENTO, NIT_DUPLICADO, REFRESCA_AUTO, DOC_PRONTO_PAGO, DETALLE_OBLIGAT, USAR_RUBROS, RUBRO1_NOMBRE, RUBRO2_NOMBRE, IMPUESTO_X_OMISION, USAR_RUBROS_CLI, RUBRO1_CLI_NOMBRE, RUBRO2_CLI_NOMBRE, RUBRO3_CLI_NOMBRE, RUBRO4_CLI_NOMBRE, RUBRO5_CLI_NOMBRE, COPIARNOTASENASNT, ASOCOBLIGCONTFACT, VENC_PERIODO5, VENC_PERIODO6, ANT_PERIODO5, ANT_PERIODO6, ASOCIACION_DE_DOCS, NOM_RUBRO1_CLI, NOM_RUBRO2_CLI, NOM_RUBRO3_CLI, NOM_RUBRO4_CLI, NOM_RUBRO5_CLI, USAR_RUBROS_VAL, FORMA_CREACION, RUBROS_DIAS_REV, ASIENTO_INTC, ULT_INTERES_CTE, FECHA_ULT_DIFCAMB, ULT_LETRACAMBIO, ULT_DEPOSITO, ULT_TEF, ULT_RETDEBITO, NOM_RUBRO11_CLI, NOM_RUBRO12_CLI, NOM_RUBRO13_CLI, NOM_RUBRO14_CLI, NOM_RUBRO15_CLI
		FROM INSERTED i
			
		OPEN C_INSERTED	
		FETCH NEXT FROM C_INSERTED INTO
		@ULT_NOTA_CREDITO, @ULT_NOTA_DEBITO, @ULT_INTERES_MORA, @ULT_RECIBO_DINERO, @ULT_FACTURA, @ULT_OTRO_CREDITO, @ULT_OTRO_DEBITO, @ULT_RETENCION, @FECHA_ULT_COMPRIME, @LIMPIAR_APLICACION, @INTRO_FACTURAS, @TIPO_ASIENTO_DEB, @PAQUETE_DEB, @TIPO_ASIENTO_CRE, @PAQUETE_CRE, @VENC_PERIODO1, @VENC_PERIODO2, @VENC_PERIODO3, @VENC_PERIODO4, @ANT_PERIODO1, @ANT_PERIODO2, @ANT_PERIODO3, @ANT_PERIODO4, @ASIENTO_FAC, @ASIENTO_INT, @ASIENTO_ND, @ASIENTO_OD, @ASIENTO_LC, @ASIENTO_REC, @ASIENTO_NC, @ASIENTO_OC, @ASIENTO_DEP, @ASIENTO_TEF, @ASIENTOS_CTA_PAIS, @TIPO_CONTA_OMISION, @INTEGRACION_CONTA, @MOD_APLIC_ASIENTO, @NIT_DUPLICADO, @REFRESCA_AUTO, @DOC_PRONTO_PAGO, @DETALLE_OBLIGAT, @USAR_RUBROS, @RUBRO1_NOMBRE, @RUBRO2_NOMBRE, @IMPUESTO_X_OMISION, @USAR_RUBROS_CLI, @RUBRO1_CLI_NOMBRE, @RUBRO2_CLI_NOMBRE, @RUBRO3_CLI_NOMBRE, @RUBRO4_CLI_NOMBRE, @RUBRO5_CLI_NOMBRE, @COPIARNOTASENASNT, @ASOCOBLIGCONTFACT, @VENC_PERIODO5, @VENC_PERIODO6, @ANT_PERIODO5, @ANT_PERIODO6, @ASOCIACION_DE_DOCS, @NOM_RUBRO1_CLI, @NOM_RUBRO2_CLI, @NOM_RUBRO3_CLI, @NOM_RUBRO4_CLI, @NOM_RUBRO5_CLI, @USAR_RUBROS_VAL, @FORMA_CREACION, @RUBROS_DIAS_REV, @ASIENTO_INTC, @ULT_INTERES_CTE, @FECHA_ULT_DIFCAMB, @ULT_LETRACAMBIO, @ULT_DEPOSITO, @ULT_TEF, @ULT_RETDEBITO, @NOM_RUBRO11_CLI, @NOM_RUBRO12_CLI, @NOM_RUBRO13_CLI, @NOM_RUBRO14_CLI, @NOM_RUBRO15_CLI

		SET @ERROR = 0
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS = 
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<GLOBALES_CC>' + 
				'<ULT_NOTA_CREDITO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ULT_NOTA_CREDITO) + '</ULT_NOTA_CREDITO>' + 
				'<ULT_NOTA_DEBITO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ULT_NOTA_DEBITO) + '</ULT_NOTA_DEBITO>' + 
				'<ULT_INTERES_MORA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ULT_INTERES_MORA) + '</ULT_INTERES_MORA>' + 
				'<ULT_RECIBO_DINERO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ULT_RECIBO_DINERO) + '</ULT_RECIBO_DINERO>' + 
				'<ULT_FACTURA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ULT_FACTURA) + '</ULT_FACTURA>' + 
				'<ULT_OTRO_CREDITO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ULT_OTRO_CREDITO) + '</ULT_OTRO_CREDITO>' + 
				'<ULT_OTRO_DEBITO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ULT_OTRO_DEBITO) + '</ULT_OTRO_DEBITO>' + 
				'<ULT_RETENCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ULT_RETENCION) + '</ULT_RETENCION>' + 
				'<FECHA_ULT_COMPRIME Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_ULT_COMPRIME) + '</FECHA_ULT_COMPRIME>' + 
				'<LIMPIAR_APLICACION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@LIMPIAR_APLICACION) + '</LIMPIAR_APLICACION>' + 
				'<INTRO_FACTURAS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@INTRO_FACTURAS) + '</INTRO_FACTURAS>' + 
				'<TIPO_ASIENTO_DEB Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_ASIENTO_DEB) + '</TIPO_ASIENTO_DEB>' + 
				'<PAQUETE_DEB Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@PAQUETE_DEB) + '</PAQUETE_DEB>' + 
				'<TIPO_ASIENTO_CRE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_ASIENTO_CRE) + '</TIPO_ASIENTO_CRE>' + 
				'<PAQUETE_CRE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@PAQUETE_CRE) + '</PAQUETE_CRE>' + 
				'<VENC_PERIODO1 Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@VENC_PERIODO1) + '</VENC_PERIODO1>' + 
				'<VENC_PERIODO2 Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@VENC_PERIODO2) + '</VENC_PERIODO2>' + 
				'<VENC_PERIODO3 Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@VENC_PERIODO3) + '</VENC_PERIODO3>' + 
				'<VENC_PERIODO4 Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@VENC_PERIODO4) + '</VENC_PERIODO4>' + 
				'<ANT_PERIODO1 Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@ANT_PERIODO1) + '</ANT_PERIODO1>' + 
				'<ANT_PERIODO2 Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@ANT_PERIODO2) + '</ANT_PERIODO2>' + 
				'<ANT_PERIODO3 Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@ANT_PERIODO3) + '</ANT_PERIODO3>' + 
				'<ANT_PERIODO4 Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@ANT_PERIODO4) + '</ANT_PERIODO4>' + 
				'<ASIENTO_FAC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ASIENTO_FAC) + '</ASIENTO_FAC>' + 
				'<ASIENTO_INT Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ASIENTO_INT) + '</ASIENTO_INT>' + 
				'<ASIENTO_ND Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ASIENTO_ND) + '</ASIENTO_ND>' + 
				'<ASIENTO_OD Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ASIENTO_OD) + '</ASIENTO_OD>' + 
				'<ASIENTO_LC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ASIENTO_LC) + '</ASIENTO_LC>' + 
				'<ASIENTO_REC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ASIENTO_REC) + '</ASIENTO_REC>' + 
				'<ASIENTO_NC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ASIENTO_NC) + '</ASIENTO_NC>' + 
				'<ASIENTO_OC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ASIENTO_OC) + '</ASIENTO_OC>' + 
				'<ASIENTO_DEP Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ASIENTO_DEP) + '</ASIENTO_DEP>' +
				'<ASIENTO_TEF Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ASIENTO_TEF) + '</ASIENTO_TEF>' + 
				'<ASIENTOS_CTA_PAIS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ASIENTOS_CTA_PAIS) + '</ASIENTOS_CTA_PAIS>' + 
				'<TIPO_CONTA_OMISION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_CONTA_OMISION) + '</TIPO_CONTA_OMISION>' + 
				'<INTEGRACION_CONTA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@INTEGRACION_CONTA) + '</INTEGRACION_CONTA>' + 
				'<MOD_APLIC_ASIENTO Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@MOD_APLIC_ASIENTO) + '</MOD_APLIC_ASIENTO>'
			
			SET @PARAMETROS2 =				
				'<NIT_DUPLICADO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NIT_DUPLICADO) + '</NIT_DUPLICADO>' + 
				'<REFRESCA_AUTO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@REFRESCA_AUTO) + '</REFRESCA_AUTO>' + 
				'<DOC_PRONTO_PAGO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DOC_PRONTO_PAGO) + '</DOC_PRONTO_PAGO>' + 
				'<DETALLE_OBLIGAT Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DETALLE_OBLIGAT) + '</DETALLE_OBLIGAT>' + 
				'<USAR_RUBROS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USAR_RUBROS) + '</USAR_RUBROS>' + 
				'<RUBRO1_NOMBRE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@RUBRO1_NOMBRE) + '</RUBRO1_NOMBRE>' + 
				'<RUBRO2_NOMBRE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@RUBRO2_NOMBRE) + '</RUBRO2_NOMBRE>' + 
				'<IMPUESTO_X_OMISION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@IMPUESTO_X_OMISION) + '</IMPUESTO_X_OMISION>' + 
				'<USAR_RUBROS_CLI Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USAR_RUBROS_CLI) + '</USAR_RUBROS_CLI>' + 
				'<RUBRO1_CLI_NOMBRE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@RUBRO1_CLI_NOMBRE) + '</RUBRO1_CLI_NOMBRE>' + 
				'<RUBRO2_CLI_NOMBRE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@RUBRO2_CLI_NOMBRE) + '</RUBRO2_CLI_NOMBRE>' + 
				'<RUBRO3_CLI_NOMBRE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@RUBRO3_CLI_NOMBRE) + '</RUBRO3_CLI_NOMBRE>' + 
				'<RUBRO4_CLI_NOMBRE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@RUBRO4_CLI_NOMBRE) + '</RUBRO4_CLI_NOMBRE>' + 
				'<RUBRO5_CLI_NOMBRE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@RUBRO5_CLI_NOMBRE) + '</RUBRO5_CLI_NOMBRE>' + 
				'<COPIARNOTASENASNT Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@COPIARNOTASENASNT) + '</COPIARNOTASENASNT>' + 
				'<ASOCOBLIGCONTFACT Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ASOCOBLIGCONTFACT) + '</ASOCOBLIGCONTFACT>' + 
				'<VENC_PERIODO5 Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@VENC_PERIODO5) + '</VENC_PERIODO5>' + 
				'<VENC_PERIODO6 Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@VENC_PERIODO6) + '</VENC_PERIODO6>' + 
				'<ANT_PERIODO5 Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@ANT_PERIODO5) + '</ANT_PERIODO5>' + 
				'<ANT_PERIODO6 Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@ANT_PERIODO6) + '</ANT_PERIODO6>' + 
				'<ASOCIACION_DE_DOCS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ASOCIACION_DE_DOCS) + '</ASOCIACION_DE_DOCS>' + 
				'<NOM_RUBRO1_CLI Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOM_RUBRO1_CLI) + '</NOM_RUBRO1_CLI>' + 
				'<NOM_RUBRO2_CLI Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOM_RUBRO2_CLI) + '</NOM_RUBRO2_CLI>' + 
				'<NOM_RUBRO3_CLI Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOM_RUBRO3_CLI) + '</NOM_RUBRO3_CLI>' + 
				'<NOM_RUBRO4_CLI Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOM_RUBRO4_CLI) + '</NOM_RUBRO4_CLI>' + 
				'<NOM_RUBRO5_CLI Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOM_RUBRO5_CLI) + '</NOM_RUBRO5_CLI>' + 
				'<USAR_RUBROS_VAL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USAR_RUBROS_VAL) + '</USAR_RUBROS_VAL>' + 
				'<FORMA_CREACION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@FORMA_CREACION) + '</FORMA_CREACION>' + 
				'<RUBROS_DIAS_REV Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@RUBROS_DIAS_REV) + '</RUBROS_DIAS_REV>' + 
				'<ASIENTO_INTC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ASIENTO_INTC) + '</ASIENTO_INTC>' + 
				'<ULT_INTERES_CTE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ULT_INTERES_CTE) + '</ULT_INTERES_CTE>' + 
				'<FECHA_ULT_DIFCAMB Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_ULT_DIFCAMB) + '</FECHA_ULT_DIFCAMB>' + 
				'<ULT_LETRACAMBIO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ULT_LETRACAMBIO) + '</ULT_LETRACAMBIO>' + 
				'<ULT_DEPOSITO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ULT_DEPOSITO) + '</ULT_DEPOSITO>' + 
				'<ULT_TEF Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ULT_TEF) + '</ULT_TEF>' + 
				'<ULT_RETDEBITO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ULT_RETDEBITO) + '</ULT_RETDEBITO>' + 
				'<NOM_RUBRO11_CLI Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOM_RUBRO11_CLI) + '</NOM_RUBRO11_CLI>' + 
				'<NOM_RUBRO12_CLI Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOM_RUBRO12_CLI) + '</NOM_RUBRO12_CLI>' + 
				'<NOM_RUBRO13_CLI Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOM_RUBRO13_CLI) + '</NOM_RUBRO13_CLI>' + 
				'<NOM_RUBRO14_CLI Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOM_RUBRO14_CLI) + '</NOM_RUBRO14_CLI>' + 
				'<NOM_RUBRO15_CLI Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOM_RUBRO15_CLI) + '</NOM_RUBRO15_CLI>' + 
				'</GLOBALES_CC>'


			-- Inserta la solicitud correspondiente			
			EXECUTE  ('ERPADMIN.POS_InsertarSolicitud ''' + @PUBLICADOR + ''', ''GLOBALESCCPOS600'', ''INSERTA'', ''' + @PARAMETROS + @PARAMETROS2 + ''', 0, ''''')

			FETCH NEXT FROM C_INSERTED INTO
			@ULT_NOTA_CREDITO, @ULT_NOTA_DEBITO, @ULT_INTERES_MORA, @ULT_RECIBO_DINERO, @ULT_FACTURA, @ULT_OTRO_CREDITO, @ULT_OTRO_DEBITO, @ULT_RETENCION, @FECHA_ULT_COMPRIME, @LIMPIAR_APLICACION, @INTRO_FACTURAS, @TIPO_ASIENTO_DEB, @PAQUETE_DEB, @TIPO_ASIENTO_CRE, @PAQUETE_CRE, @VENC_PERIODO1, @VENC_PERIODO2, @VENC_PERIODO3, @VENC_PERIODO4, @ANT_PERIODO1, @ANT_PERIODO2, @ANT_PERIODO3, @ANT_PERIODO4, @ASIENTO_FAC, @ASIENTO_INT, @ASIENTO_ND, @ASIENTO_OD, @ASIENTO_LC, @ASIENTO_REC, @ASIENTO_NC, @ASIENTO_OC, @ASIENTO_DEP, @ASIENTO_TEF, @ASIENTOS_CTA_PAIS, @TIPO_CONTA_OMISION, @INTEGRACION_CONTA, @MOD_APLIC_ASIENTO, @NIT_DUPLICADO, @REFRESCA_AUTO, @DOC_PRONTO_PAGO, @DETALLE_OBLIGAT, @USAR_RUBROS, @RUBRO1_NOMBRE, @RUBRO2_NOMBRE, @IMPUESTO_X_OMISION, @USAR_RUBROS_CLI, @RUBRO1_CLI_NOMBRE, @RUBRO2_CLI_NOMBRE, @RUBRO3_CLI_NOMBRE, @RUBRO4_CLI_NOMBRE, @RUBRO5_CLI_NOMBRE, @COPIARNOTASENASNT, @ASOCOBLIGCONTFACT, @VENC_PERIODO5, @VENC_PERIODO6, @ANT_PERIODO5, @ANT_PERIODO6, @ASOCIACION_DE_DOCS, @NOM_RUBRO1_CLI, @NOM_RUBRO2_CLI, @NOM_RUBRO3_CLI, @NOM_RUBRO4_CLI, @NOM_RUBRO5_CLI, @USAR_RUBROS_VAL, @FORMA_CREACION, @RUBROS_DIAS_REV, @ASIENTO_INTC, @ULT_INTERES_CTE, @FECHA_ULT_DIFCAMB, @ULT_LETRACAMBIO, @ULT_DEPOSITO, @ULT_TEF, @ULT_RETDEBITO, @NOM_RUBRO11_CLI, @NOM_RUBRO12_CLI, @NOM_RUBRO13_CLI, @NOM_RUBRO14_CLI, @NOM_RUBRO15_CLI
		END

		CLOSE C_INSERTED
    		DEALLOCATE C_INSERTED
	END

	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla GLOBALES_CC.',16,1 )
	END
END;



CREATE TRIGGER $$Compania$$.GLOBALES_CC_POS_DEL
ON $$Compania$$.GLOBALES_CC
FOR DELETE  
AS 
BEGIN   	
        DECLARE @ERROR  int
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @PARAMETROS2 VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @ULT_NOTA_CREDITO VARCHAR(20)
	DECLARE @ULT_NOTA_DEBITO VARCHAR(20)
	DECLARE @ULT_INTERES_MORA VARCHAR(20)
	DECLARE @ULT_RECIBO_DINERO VARCHAR(20)
	DECLARE @ULT_FACTURA VARCHAR(20)
	DECLARE @ULT_OTRO_CREDITO VARCHAR(20)
	DECLARE @ULT_OTRO_DEBITO VARCHAR(20)
	DECLARE @ULT_RETENCION VARCHAR(50)
	DECLARE @FECHA_ULT_COMPRIME DATETIME
	DECLARE @LIMPIAR_APLICACION VARCHAR(1)
	DECLARE @INTRO_FACTURAS VARCHAR(1)
	DECLARE @TIPO_ASIENTO_DEB VARCHAR(4)
	DECLARE @PAQUETE_DEB VARCHAR(4)
	DECLARE @TIPO_ASIENTO_CRE VARCHAR(4)
	DECLARE @PAQUETE_CRE VARCHAR(4)
	DECLARE @VENC_PERIODO1 INT
	DECLARE @VENC_PERIODO2 INT
	DECLARE @VENC_PERIODO3 INT
	DECLARE @VENC_PERIODO4 INT
	DECLARE @ANT_PERIODO1 INT
	DECLARE @ANT_PERIODO2 INT
	DECLARE @ANT_PERIODO3 INT
	DECLARE @ANT_PERIODO4 INT
	DECLARE @ASIENTO_FAC VARCHAR(1)
	DECLARE @ASIENTO_INT VARCHAR(1)
	DECLARE @ASIENTO_ND VARCHAR(1)
	DECLARE @ASIENTO_OD VARCHAR(1)
	DECLARE @ASIENTO_LC VARCHAR(1)
	DECLARE @ASIENTO_REC VARCHAR(1)
	DECLARE @ASIENTO_NC VARCHAR(1)
	DECLARE @ASIENTO_OC VARCHAR(1)
	DECLARE @ASIENTO_DEP VARCHAR(1)
	DECLARE @ASIENTO_TEF VARCHAR(1)
	DECLARE @ASIENTOS_CTA_PAIS VARCHAR(1)
	DECLARE @TIPO_CONTA_OMISION VARCHAR(1)
	DECLARE @INTEGRACION_CONTA VARCHAR(1)
	DECLARE @MOD_APLIC_ASIENTO INT
	DECLARE @NIT_DUPLICADO VARCHAR(1)
	DECLARE @REFRESCA_AUTO VARCHAR(1)
	DECLARE @DOC_PRONTO_PAGO VARCHAR(3)
	DECLARE @DETALLE_OBLIGAT VARCHAR(1)
	DECLARE @USAR_RUBROS VARCHAR(1)
	DECLARE @RUBRO1_NOMBRE VARCHAR(15)
	DECLARE @RUBRO2_NOMBRE VARCHAR(15)
	DECLARE @IMPUESTO_X_OMISION VARCHAR(4)
	DECLARE @USAR_RUBROS_CLI VARCHAR(1)
	DECLARE @RUBRO1_CLI_NOMBRE VARCHAR(15)
	DECLARE @RUBRO2_CLI_NOMBRE VARCHAR(15)
	DECLARE @RUBRO3_CLI_NOMBRE VARCHAR(15)
	DECLARE @RUBRO4_CLI_NOMBRE VARCHAR(15)
	DECLARE @RUBRO5_CLI_NOMBRE VARCHAR(15)
	DECLARE @COPIARNOTASENASNT VARCHAR(1)
	DECLARE @ASOCOBLIGCONTFACT VARCHAR(1)
	DECLARE @VENC_PERIODO5 INT
	DECLARE @VENC_PERIODO6 INT
	DECLARE @ANT_PERIODO5 INT
	DECLARE @ANT_PERIODO6 INT
	DECLARE @ASOCIACION_DE_DOCS VARCHAR(1)
	DECLARE @NOM_RUBRO1_CLI VARCHAR(60)
	DECLARE @NOM_RUBRO2_CLI VARCHAR(60)
	DECLARE @NOM_RUBRO3_CLI VARCHAR(60)
	DECLARE @NOM_RUBRO4_CLI VARCHAR(60)
	DECLARE @NOM_RUBRO5_CLI VARCHAR(60)
	DECLARE @USAR_RUBROS_VAL VARCHAR(1)
	DECLARE @FORMA_CREACION VARCHAR(1)
	DECLARE @RUBROS_DIAS_REV INT
	DECLARE @ASIENTO_INTC VARCHAR(1)
	DECLARE @ULT_INTERES_CTE VARCHAR(20)
	DECLARE @FECHA_ULT_DIFCAMB DATETIME
	DECLARE @ULT_LETRACAMBIO VARCHAR(20)
	DECLARE @ULT_DEPOSITO VARCHAR(20)
	DECLARE @ULT_TEF VARCHAR(20)
	DECLARE @ULT_RETDEBITO VARCHAR(50)
	DECLARE @NOM_RUBRO11_CLI VARCHAR(60)
	DECLARE @NOM_RUBRO12_CLI VARCHAR(60)
	DECLARE @NOM_RUBRO13_CLI VARCHAR(60)
	DECLARE @NOM_RUBRO14_CLI VARCHAR(60)
	DECLARE @NOM_RUBRO15_CLI VARCHAR(60)
	 -- Declaraciones	

	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM 
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_DELETED CURSOR LOCAL FOR
			SELECT ULT_NOTA_CREDITO, ULT_NOTA_DEBITO, ULT_INTERES_MORA, ULT_RECIBO_DINERO, ULT_FACTURA, ULT_OTRO_CREDITO, ULT_OTRO_DEBITO, ULT_RETENCION, FECHA_ULT_COMPRIME, LIMPIAR_APLICACION, INTRO_FACTURAS, TIPO_ASIENTO_DEB, PAQUETE_DEB, TIPO_ASIENTO_CRE, PAQUETE_CRE, VENC_PERIODO1, VENC_PERIODO2, VENC_PERIODO3, VENC_PERIODO4, ANT_PERIODO1, ANT_PERIODO2, ANT_PERIODO3, ANT_PERIODO4, ASIENTO_FAC, ASIENTO_INT, ASIENTO_ND, ASIENTO_OD, ASIENTO_LC, ASIENTO_REC, ASIENTO_NC, ASIENTO_OC, ASIENTO_DEP, ASIENTO_TEF, ASIENTOS_CTA_PAIS, TIPO_CONTA_OMISION, INTEGRACION_CONTA, MOD_APLIC_ASIENTO, NIT_DUPLICADO, REFRESCA_AUTO, DOC_PRONTO_PAGO, DETALLE_OBLIGAT, USAR_RUBROS, RUBRO1_NOMBRE, RUBRO2_NOMBRE, IMPUESTO_X_OMISION, USAR_RUBROS_CLI, RUBRO1_CLI_NOMBRE, RUBRO2_CLI_NOMBRE, RUBRO3_CLI_NOMBRE, RUBRO4_CLI_NOMBRE, RUBRO5_CLI_NOMBRE, COPIARNOTASENASNT, ASOCOBLIGCONTFACT, VENC_PERIODO5, VENC_PERIODO6, ANT_PERIODO5, ANT_PERIODO6, ASOCIACION_DE_DOCS, NOM_RUBRO1_CLI, NOM_RUBRO2_CLI, NOM_RUBRO3_CLI, NOM_RUBRO4_CLI, NOM_RUBRO5_CLI, USAR_RUBROS_VAL, FORMA_CREACION, RUBROS_DIAS_REV, ASIENTO_INTC, ULT_INTERES_CTE, FECHA_ULT_DIFCAMB, ULT_LETRACAMBIO, ULT_DEPOSITO, ULT_TEF, ULT_RETDEBITO, NOM_RUBRO11_CLI, NOM_RUBRO12_CLI, NOM_RUBRO13_CLI, NOM_RUBRO14_CLI, NOM_RUBRO15_CLI
			FROM DELETED d

		OPEN C_DELETED
		FETCH NEXT FROM C_DELETED INTO 
		@ULT_NOTA_CREDITO, @ULT_NOTA_DEBITO, @ULT_INTERES_MORA, @ULT_RECIBO_DINERO, @ULT_FACTURA, @ULT_OTRO_CREDITO, @ULT_OTRO_DEBITO, @ULT_RETENCION, @FECHA_ULT_COMPRIME, @LIMPIAR_APLICACION, @INTRO_FACTURAS, @TIPO_ASIENTO_DEB, @PAQUETE_DEB, @TIPO_ASIENTO_CRE, @PAQUETE_CRE, @VENC_PERIODO1, @VENC_PERIODO2, @VENC_PERIODO3, @VENC_PERIODO4, @ANT_PERIODO1, @ANT_PERIODO2, @ANT_PERIODO3, @ANT_PERIODO4, @ASIENTO_FAC, @ASIENTO_INT, @ASIENTO_ND, @ASIENTO_OD, @ASIENTO_LC, @ASIENTO_REC, @ASIENTO_NC, @ASIENTO_OC, @ASIENTO_DEP, @ASIENTO_TEF, @ASIENTOS_CTA_PAIS, @TIPO_CONTA_OMISION, @INTEGRACION_CONTA, @MOD_APLIC_ASIENTO, @NIT_DUPLICADO, @REFRESCA_AUTO, @DOC_PRONTO_PAGO, @DETALLE_OBLIGAT, @USAR_RUBROS, @RUBRO1_NOMBRE, @RUBRO2_NOMBRE, @IMPUESTO_X_OMISION, @USAR_RUBROS_CLI, @RUBRO1_CLI_NOMBRE, @RUBRO2_CLI_NOMBRE, @RUBRO3_CLI_NOMBRE, @RUBRO4_CLI_NOMBRE, @RUBRO5_CLI_NOMBRE, @COPIARNOTASENASNT, @ASOCOBLIGCONTFACT, @VENC_PERIODO5, @VENC_PERIODO6, @ANT_PERIODO5, @ANT_PERIODO6, @ASOCIACION_DE_DOCS, @NOM_RUBRO1_CLI, @NOM_RUBRO2_CLI, @NOM_RUBRO3_CLI, @NOM_RUBRO4_CLI, @NOM_RUBRO5_CLI, @USAR_RUBROS_VAL, @FORMA_CREACION, @RUBROS_DIAS_REV, @ASIENTO_INTC, @ULT_INTERES_CTE, @FECHA_ULT_DIFCAMB, @ULT_LETRACAMBIO, @ULT_DEPOSITO, @ULT_TEF, @ULT_RETDEBITO, @NOM_RUBRO11_CLI, @NOM_RUBRO12_CLI, @NOM_RUBRO13_CLI, @NOM_RUBRO14_CLI, @NOM_RUBRO15_CLI -- VARIABLES
		
		SET @ERROR = 0
		
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS = 
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<GLOBALES_CC>' + 
				'<ULT_NOTA_CREDITO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ULT_NOTA_CREDITO) + '</ULT_NOTA_CREDITO>' + 
				'<ULT_NOTA_DEBITO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ULT_NOTA_DEBITO) + '</ULT_NOTA_DEBITO>' + 
				'<ULT_INTERES_MORA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ULT_INTERES_MORA) + '</ULT_INTERES_MORA>' + 
				'<ULT_RECIBO_DINERO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ULT_RECIBO_DINERO) + '</ULT_RECIBO_DINERO>' + 
				'<ULT_FACTURA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ULT_FACTURA) + '</ULT_FACTURA>' + 
				'<ULT_OTRO_CREDITO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ULT_OTRO_CREDITO) + '</ULT_OTRO_CREDITO>' + 
				'<ULT_OTRO_DEBITO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ULT_OTRO_DEBITO) + '</ULT_OTRO_DEBITO>' + 
				'<ULT_RETENCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ULT_RETENCION) + '</ULT_RETENCION>' + 
				'<FECHA_ULT_COMPRIME Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_ULT_COMPRIME) + '</FECHA_ULT_COMPRIME>' + 
				'<LIMPIAR_APLICACION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@LIMPIAR_APLICACION) + '</LIMPIAR_APLICACION>' + 
				'<INTRO_FACTURAS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@INTRO_FACTURAS) + '</INTRO_FACTURAS>' + 
				'<TIPO_ASIENTO_DEB Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_ASIENTO_DEB) + '</TIPO_ASIENTO_DEB>' + 
				'<PAQUETE_DEB Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@PAQUETE_DEB) + '</PAQUETE_DEB>' + 
				'<TIPO_ASIENTO_CRE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_ASIENTO_CRE) + '</TIPO_ASIENTO_CRE>' + 
				'<PAQUETE_CRE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@PAQUETE_CRE) + '</PAQUETE_CRE>' + 
				'<VENC_PERIODO1 Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@VENC_PERIODO1) + '</VENC_PERIODO1>' + 
				'<VENC_PERIODO2 Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@VENC_PERIODO2) + '</VENC_PERIODO2>' + 
				'<VENC_PERIODO3 Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@VENC_PERIODO3) + '</VENC_PERIODO3>' + 
				'<VENC_PERIODO4 Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@VENC_PERIODO4) + '</VENC_PERIODO4>' + 
				'<ANT_PERIODO1 Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@ANT_PERIODO1) + '</ANT_PERIODO1>' + 
				'<ANT_PERIODO2 Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@ANT_PERIODO2) + '</ANT_PERIODO2>' + 
				'<ANT_PERIODO3 Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@ANT_PERIODO3) + '</ANT_PERIODO3>' + 
				'<ANT_PERIODO4 Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@ANT_PERIODO4) + '</ANT_PERIODO4>' + 
				'<ASIENTO_FAC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ASIENTO_FAC) + '</ASIENTO_FAC>' + 
				'<ASIENTO_INT Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ASIENTO_INT) + '</ASIENTO_INT>' + 
				'<ASIENTO_ND Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ASIENTO_ND) + '</ASIENTO_ND>' + 
				'<ASIENTO_OD Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ASIENTO_OD) + '</ASIENTO_OD>' + 
				'<ASIENTO_LC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ASIENTO_LC) + '</ASIENTO_LC>' + 
				'<ASIENTO_REC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ASIENTO_REC) + '</ASIENTO_REC>' + 
				'<ASIENTO_NC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ASIENTO_NC) + '</ASIENTO_NC>' + 
				'<ASIENTO_OC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ASIENTO_OC) + '</ASIENTO_OC>' + 
				'<ASIENTO_DEP Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ASIENTO_DEP) + '</ASIENTO_DEP>' +
				'<ASIENTO_TEF Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ASIENTO_TEF) + '</ASIENTO_TEF>' + 
				'<ASIENTOS_CTA_PAIS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ASIENTOS_CTA_PAIS) + '</ASIENTOS_CTA_PAIS>' + 
				'<TIPO_CONTA_OMISION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_CONTA_OMISION) + '</TIPO_CONTA_OMISION>' + 
				'<INTEGRACION_CONTA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@INTEGRACION_CONTA) + '</INTEGRACION_CONTA>' + 
				'<MOD_APLIC_ASIENTO Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@MOD_APLIC_ASIENTO) + '</MOD_APLIC_ASIENTO>'
			
			SET @PARAMETROS2 =				
				'<NIT_DUPLICADO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NIT_DUPLICADO) + '</NIT_DUPLICADO>' + 
				'<REFRESCA_AUTO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@REFRESCA_AUTO) + '</REFRESCA_AUTO>' + 
				'<DOC_PRONTO_PAGO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DOC_PRONTO_PAGO) + '</DOC_PRONTO_PAGO>' + 
				'<DETALLE_OBLIGAT Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DETALLE_OBLIGAT) + '</DETALLE_OBLIGAT>' + 
				'<USAR_RUBROS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USAR_RUBROS) + '</USAR_RUBROS>' + 
				'<RUBRO1_NOMBRE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@RUBRO1_NOMBRE) + '</RUBRO1_NOMBRE>' + 
				'<RUBRO2_NOMBRE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@RUBRO2_NOMBRE) + '</RUBRO2_NOMBRE>' + 
				'<IMPUESTO_X_OMISION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@IMPUESTO_X_OMISION) + '</IMPUESTO_X_OMISION>' + 
				'<USAR_RUBROS_CLI Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USAR_RUBROS_CLI) + '</USAR_RUBROS_CLI>' + 
				'<RUBRO1_CLI_NOMBRE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@RUBRO1_CLI_NOMBRE) + '</RUBRO1_CLI_NOMBRE>' + 
				'<RUBRO2_CLI_NOMBRE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@RUBRO2_CLI_NOMBRE) + '</RUBRO2_CLI_NOMBRE>' + 
				'<RUBRO3_CLI_NOMBRE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@RUBRO3_CLI_NOMBRE) + '</RUBRO3_CLI_NOMBRE>' + 
				'<RUBRO4_CLI_NOMBRE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@RUBRO4_CLI_NOMBRE) + '</RUBRO4_CLI_NOMBRE>' + 
				'<RUBRO5_CLI_NOMBRE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@RUBRO5_CLI_NOMBRE) + '</RUBRO5_CLI_NOMBRE>' + 
				'<COPIARNOTASENASNT Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@COPIARNOTASENASNT) + '</COPIARNOTASENASNT>' + 
				'<ASOCOBLIGCONTFACT Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ASOCOBLIGCONTFACT) + '</ASOCOBLIGCONTFACT>' + 
				'<VENC_PERIODO5 Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@VENC_PERIODO5) + '</VENC_PERIODO5>' + 
				'<VENC_PERIODO6 Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@VENC_PERIODO6) + '</VENC_PERIODO6>' + 
				'<ANT_PERIODO5 Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@ANT_PERIODO5) + '</ANT_PERIODO5>' + 
				'<ANT_PERIODO6 Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@ANT_PERIODO6) + '</ANT_PERIODO6>' + 
				'<ASOCIACION_DE_DOCS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ASOCIACION_DE_DOCS) + '</ASOCIACION_DE_DOCS>' + 
				'<NOM_RUBRO1_CLI Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOM_RUBRO1_CLI) + '</NOM_RUBRO1_CLI>' + 
				'<NOM_RUBRO2_CLI Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOM_RUBRO2_CLI) + '</NOM_RUBRO2_CLI>' + 
				'<NOM_RUBRO3_CLI Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOM_RUBRO3_CLI) + '</NOM_RUBRO3_CLI>' + 
				'<NOM_RUBRO4_CLI Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOM_RUBRO4_CLI) + '</NOM_RUBRO4_CLI>' + 
				'<NOM_RUBRO5_CLI Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOM_RUBRO5_CLI) + '</NOM_RUBRO5_CLI>' + 
				'<USAR_RUBROS_VAL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USAR_RUBROS_VAL) + '</USAR_RUBROS_VAL>' + 
				'<FORMA_CREACION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@FORMA_CREACION) + '</FORMA_CREACION>' + 
				'<RUBROS_DIAS_REV Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@RUBROS_DIAS_REV) + '</RUBROS_DIAS_REV>' + 
				'<ASIENTO_INTC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ASIENTO_INTC) + '</ASIENTO_INTC>' + 
				'<ULT_INTERES_CTE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ULT_INTERES_CTE) + '</ULT_INTERES_CTE>' + 
				'<FECHA_ULT_DIFCAMB Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_ULT_DIFCAMB) + '</FECHA_ULT_DIFCAMB>' + 
				'<ULT_LETRACAMBIO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ULT_LETRACAMBIO) + '</ULT_LETRACAMBIO>' + 
				'<ULT_DEPOSITO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ULT_DEPOSITO) + '</ULT_DEPOSITO>' + 
				'<ULT_TEF Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ULT_TEF) + '</ULT_TEF>' + 
				'<ULT_RETDEBITO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ULT_RETDEBITO) + '</ULT_RETDEBITO>' + 
				'<NOM_RUBRO11_CLI Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOM_RUBRO11_CLI) + '</NOM_RUBRO11_CLI>' + 
				'<NOM_RUBRO12_CLI Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOM_RUBRO12_CLI) + '</NOM_RUBRO12_CLI>' + 
				'<NOM_RUBRO13_CLI Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOM_RUBRO13_CLI) + '</NOM_RUBRO13_CLI>' + 
				'<NOM_RUBRO14_CLI Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOM_RUBRO14_CLI) + '</NOM_RUBRO14_CLI>' + 
				'<NOM_RUBRO15_CLI Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOM_RUBRO15_CLI) + '</NOM_RUBRO15_CLI>' + 
				'</GLOBALES_CC>'

 
			
			-- inserta la solicitud correspondiente
			EXECUTE  ('ERPADMIN.POS_InsertarSolicitud ''' + @PUBLICADOR + ''', ''GLOBALESCCPOS600'', ''ELIMINA'', ''' + @PARAMETROS + @PARAMETROS2 + ''', 0, ''''')
			
			FETCH NEXT FROM C_DELETED INTO 
			@ULT_NOTA_CREDITO, @ULT_NOTA_DEBITO, @ULT_INTERES_MORA, @ULT_RECIBO_DINERO, @ULT_FACTURA, @ULT_OTRO_CREDITO, @ULT_OTRO_DEBITO, @ULT_RETENCION, @FECHA_ULT_COMPRIME, @LIMPIAR_APLICACION, @INTRO_FACTURAS, @TIPO_ASIENTO_DEB, @PAQUETE_DEB, @TIPO_ASIENTO_CRE, @PAQUETE_CRE, @VENC_PERIODO1, @VENC_PERIODO2, @VENC_PERIODO3, @VENC_PERIODO4, @ANT_PERIODO1, @ANT_PERIODO2, @ANT_PERIODO3, @ANT_PERIODO4, @ASIENTO_FAC, @ASIENTO_INT, @ASIENTO_ND, @ASIENTO_OD, @ASIENTO_LC, @ASIENTO_REC, @ASIENTO_NC, @ASIENTO_OC, @ASIENTO_DEP, @ASIENTO_TEF, @ASIENTOS_CTA_PAIS, @TIPO_CONTA_OMISION, @INTEGRACION_CONTA, @MOD_APLIC_ASIENTO, @NIT_DUPLICADO, @REFRESCA_AUTO, @DOC_PRONTO_PAGO, @DETALLE_OBLIGAT, @USAR_RUBROS, @RUBRO1_NOMBRE, @RUBRO2_NOMBRE, @IMPUESTO_X_OMISION, @USAR_RUBROS_CLI, @RUBRO1_CLI_NOMBRE, @RUBRO2_CLI_NOMBRE, @RUBRO3_CLI_NOMBRE, @RUBRO4_CLI_NOMBRE, @RUBRO5_CLI_NOMBRE, @COPIARNOTASENASNT, @ASOCOBLIGCONTFACT, @VENC_PERIODO5, @VENC_PERIODO6, @ANT_PERIODO5, @ANT_PERIODO6, @ASOCIACION_DE_DOCS, @NOM_RUBRO1_CLI, @NOM_RUBRO2_CLI, @NOM_RUBRO3_CLI, @NOM_RUBRO4_CLI, @NOM_RUBRO5_CLI, @USAR_RUBROS_VAL, @FORMA_CREACION, @RUBROS_DIAS_REV, @ASIENTO_INTC, @ULT_INTERES_CTE, @FECHA_ULT_DIFCAMB, @ULT_LETRACAMBIO, @ULT_DEPOSITO, @ULT_TEF, @ULT_RETDEBITO, @NOM_RUBRO11_CLI, @NOM_RUBRO12_CLI, @NOM_RUBRO13_CLI, @NOM_RUBRO14_CLI, @NOM_RUBRO15_CLI -- VARIABLES
		END

		CLOSE C_DELETED
		DEALLOCATE C_DELETED
	END
	
	IF (@@ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para eliminar de la tabla GLOBALES_CC.',16,1 )
	END
END;



CREATE TRIGGER $$Compania$$.GLOBALES_CC_POS_MOD
ON $$Compania$$.GLOBALES_CC
FOR UPDATE
AS 
BEGIN   	
	DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @PARAMETROS2 VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @COL_ROWPOINTER VARCHAR(36)
	DECLARE @HAY_CAMPOS_PARA_POS BIT
	DECLARE @ACTUALIZAR_SOLICITUD BIT
	DECLARE @ULT_NOTA_CREDITO VARCHAR(20)
	DECLARE @ULT_NOTA_DEBITO VARCHAR(20)
	DECLARE @ULT_INTERES_MORA VARCHAR(20)
	DECLARE @ULT_RECIBO_DINERO VARCHAR(20)
	DECLARE @ULT_FACTURA VARCHAR(20)
	DECLARE @ULT_OTRO_CREDITO VARCHAR(20)
	DECLARE @ULT_OTRO_DEBITO VARCHAR(20)
	DECLARE @ULT_RETENCION VARCHAR(50)
	DECLARE @FECHA_ULT_COMPRIME DATETIME
	DECLARE @LIMPIAR_APLICACION VARCHAR(1)
	DECLARE @INTRO_FACTURAS VARCHAR(1)
	DECLARE @TIPO_ASIENTO_DEB VARCHAR(4)
	DECLARE @PAQUETE_DEB VARCHAR(4)
	DECLARE @TIPO_ASIENTO_CRE VARCHAR(4)
	DECLARE @PAQUETE_CRE VARCHAR(4)
	DECLARE @VENC_PERIODO1 INT
	DECLARE @VENC_PERIODO2 INT
	DECLARE @VENC_PERIODO3 INT
	DECLARE @VENC_PERIODO4 INT
	DECLARE @ANT_PERIODO1 INT
	DECLARE @ANT_PERIODO2 INT
	DECLARE @ANT_PERIODO3 INT
	DECLARE @ANT_PERIODO4 INT
	DECLARE @ASIENTO_FAC VARCHAR(1)
	DECLARE @ASIENTO_INT VARCHAR(1)
	DECLARE @ASIENTO_ND VARCHAR(1)
	DECLARE @ASIENTO_OD VARCHAR(1)
	DECLARE @ASIENTO_LC VARCHAR(1)
	DECLARE @ASIENTO_REC VARCHAR(1)
	DECLARE @ASIENTO_NC VARCHAR(1)
	DECLARE @ASIENTO_OC VARCHAR(1)
	DECLARE @ASIENTO_DEP VARCHAR(1)
	DECLARE @ASIENTO_TEF VARCHAR(1)
	DECLARE @ASIENTOS_CTA_PAIS VARCHAR(1)
	DECLARE @TIPO_CONTA_OMISION VARCHAR(1)
	DECLARE @INTEGRACION_CONTA VARCHAR(1)
	DECLARE @MOD_APLIC_ASIENTO INT
	DECLARE @NIT_DUPLICADO VARCHAR(1)
	DECLARE @REFRESCA_AUTO VARCHAR(1)
	DECLARE @DOC_PRONTO_PAGO VARCHAR(3)
	DECLARE @DETALLE_OBLIGAT VARCHAR(1)
	DECLARE @USAR_RUBROS VARCHAR(1)
	DECLARE @RUBRO1_NOMBRE VARCHAR(15)
	DECLARE @RUBRO2_NOMBRE VARCHAR(15)
	DECLARE @IMPUESTO_X_OMISION VARCHAR(4)
	DECLARE @USAR_RUBROS_CLI VARCHAR(1)
	DECLARE @RUBRO1_CLI_NOMBRE VARCHAR(15)
	DECLARE @RUBRO2_CLI_NOMBRE VARCHAR(15)
	DECLARE @RUBRO3_CLI_NOMBRE VARCHAR(15)
	DECLARE @RUBRO4_CLI_NOMBRE VARCHAR(15)
	DECLARE @RUBRO5_CLI_NOMBRE VARCHAR(15)
	DECLARE @COPIARNOTASENASNT VARCHAR(1)
	DECLARE @ASOCOBLIGCONTFACT VARCHAR(1)
	DECLARE @VENC_PERIODO5 INT
	DECLARE @VENC_PERIODO6 INT
	DECLARE @ANT_PERIODO5 INT
	DECLARE @ANT_PERIODO6 INT
	DECLARE @ASOCIACION_DE_DOCS VARCHAR(1)
	DECLARE @NOM_RUBRO1_CLI VARCHAR(60)
	DECLARE @NOM_RUBRO2_CLI VARCHAR(60)
	DECLARE @NOM_RUBRO3_CLI VARCHAR(60)
	DECLARE @NOM_RUBRO4_CLI VARCHAR(60)
	DECLARE @NOM_RUBRO5_CLI VARCHAR(60)
	DECLARE @USAR_RUBROS_VAL VARCHAR(1)
	DECLARE @FORMA_CREACION VARCHAR(1)
	DECLARE @RUBROS_DIAS_REV INT
	DECLARE @ASIENTO_INTC VARCHAR(1)
	DECLARE @ULT_INTERES_CTE VARCHAR(20)
	DECLARE @FECHA_ULT_DIFCAMB DATETIME
	DECLARE @ULT_LETRACAMBIO VARCHAR(20)
	DECLARE @ULT_DEPOSITO VARCHAR(20)
	DECLARE @ULT_TEF VARCHAR(20)
	DECLARE @ULT_RETDEBITO VARCHAR(50)
	DECLARE @NOM_RUBRO11_CLI VARCHAR(60)
	DECLARE @NOM_RUBRO12_CLI VARCHAR(60)
	DECLARE @NOM_RUBRO13_CLI VARCHAR(60)
	DECLARE @NOM_RUBRO14_CLI VARCHAR(60)
	DECLARE @NOM_RUBRO15_CLI VARCHAR(60)
	 -- Declaraciones

	SET @ERROR = 0

	SELECT @PUBLICADOR = SITIO_LOCAL, @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_MODIFIED CURSOR LOCAL FOR
			SELECT ULT_NOTA_CREDITO, ULT_NOTA_DEBITO, ULT_INTERES_MORA, ULT_RECIBO_DINERO, ULT_FACTURA, ULT_OTRO_CREDITO, ULT_OTRO_DEBITO, ULT_RETENCION, FECHA_ULT_COMPRIME, LIMPIAR_APLICACION, INTRO_FACTURAS, TIPO_ASIENTO_DEB, PAQUETE_DEB, TIPO_ASIENTO_CRE, PAQUETE_CRE, VENC_PERIODO1, VENC_PERIODO2, VENC_PERIODO3, VENC_PERIODO4, ANT_PERIODO1, ANT_PERIODO2, ANT_PERIODO3, ANT_PERIODO4, ASIENTO_FAC, ASIENTO_INT, ASIENTO_ND, ASIENTO_OD, ASIENTO_LC, ASIENTO_REC, ASIENTO_NC, ASIENTO_OC, ASIENTO_DEP, ASIENTO_TEF, ASIENTOS_CTA_PAIS, TIPO_CONTA_OMISION, INTEGRACION_CONTA, MOD_APLIC_ASIENTO, NIT_DUPLICADO, REFRESCA_AUTO, DOC_PRONTO_PAGO, DETALLE_OBLIGAT, USAR_RUBROS, RUBRO1_NOMBRE, RUBRO2_NOMBRE, IMPUESTO_X_OMISION, USAR_RUBROS_CLI, RUBRO1_CLI_NOMBRE, RUBRO2_CLI_NOMBRE, RUBRO3_CLI_NOMBRE, RUBRO4_CLI_NOMBRE, RUBRO5_CLI_NOMBRE, COPIARNOTASENASNT, ASOCOBLIGCONTFACT, VENC_PERIODO5, VENC_PERIODO6, ANT_PERIODO5, ANT_PERIODO6, ASOCIACION_DE_DOCS, NOM_RUBRO1_CLI, NOM_RUBRO2_CLI, NOM_RUBRO3_CLI, NOM_RUBRO4_CLI, NOM_RUBRO5_CLI, USAR_RUBROS_VAL, FORMA_CREACION, RUBROS_DIAS_REV, ASIENTO_INTC, ULT_INTERES_CTE, FECHA_ULT_DIFCAMB, ULT_LETRACAMBIO, ULT_DEPOSITO, ULT_TEF, ULT_RETDEBITO, NOM_RUBRO11_CLI, NOM_RUBRO12_CLI, NOM_RUBRO13_CLI, NOM_RUBRO14_CLI, NOM_RUBRO15_CLI-- Columnas
			FROM INSERTED I

		SET @ACTUALIZAR_SOLICITUD = 1

		OPEN C_MODIFIED

		FETCH NEXT FROM C_MODIFIED
		INTO @ULT_NOTA_CREDITO, @ULT_NOTA_DEBITO, @ULT_INTERES_MORA, @ULT_RECIBO_DINERO, @ULT_FACTURA, @ULT_OTRO_CREDITO, @ULT_OTRO_DEBITO, @ULT_RETENCION, @FECHA_ULT_COMPRIME, @LIMPIAR_APLICACION, @INTRO_FACTURAS, @TIPO_ASIENTO_DEB, @PAQUETE_DEB, @TIPO_ASIENTO_CRE, @PAQUETE_CRE, @VENC_PERIODO1, @VENC_PERIODO2, @VENC_PERIODO3, @VENC_PERIODO4, @ANT_PERIODO1, @ANT_PERIODO2, @ANT_PERIODO3, @ANT_PERIODO4, @ASIENTO_FAC, @ASIENTO_INT, @ASIENTO_ND, @ASIENTO_OD, @ASIENTO_LC, @ASIENTO_REC, @ASIENTO_NC, @ASIENTO_OC, @ASIENTO_DEP, @ASIENTO_TEF, @ASIENTOS_CTA_PAIS, @TIPO_CONTA_OMISION, @INTEGRACION_CONTA, @MOD_APLIC_ASIENTO, @NIT_DUPLICADO, @REFRESCA_AUTO, @DOC_PRONTO_PAGO, @DETALLE_OBLIGAT, @USAR_RUBROS, @RUBRO1_NOMBRE, @RUBRO2_NOMBRE, @IMPUESTO_X_OMISION, @USAR_RUBROS_CLI, @RUBRO1_CLI_NOMBRE, @RUBRO2_CLI_NOMBRE, @RUBRO3_CLI_NOMBRE, @RUBRO4_CLI_NOMBRE, @RUBRO5_CLI_NOMBRE, @COPIARNOTASENASNT, @ASOCOBLIGCONTFACT, @VENC_PERIODO5, @VENC_PERIODO6, @ANT_PERIODO5, @ANT_PERIODO6, @ASOCIACION_DE_DOCS, @NOM_RUBRO1_CLI, @NOM_RUBRO2_CLI, @NOM_RUBRO3_CLI, @NOM_RUBRO4_CLI, @NOM_RUBRO5_CLI, @USAR_RUBROS_VAL, @FORMA_CREACION, @RUBROS_DIAS_REV, @ASIENTO_INTC, @ULT_INTERES_CTE, @FECHA_ULT_DIFCAMB, @ULT_LETRACAMBIO, @ULT_DEPOSITO, @ULT_TEF, @ULT_RETDEBITO, @NOM_RUBRO11_CLI, @NOM_RUBRO12_CLI, @NOM_RUBRO13_CLI, @NOM_RUBRO14_CLI, @NOM_RUBRO15_CLI

		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			IF ( NOT UPDATE(RECORDDATE) AND ( UPDATE(ULT_NOTA_CREDITO) OR UPDATE(ULT_NOTA_DEBITO) OR UPDATE(ULT_INTERES_MORA) OR UPDATE(ULT_RECIBO_DINERO) OR UPDATE(ULT_FACTURA) OR UPDATE(ULT_OTRO_CREDITO) OR UPDATE(ULT_OTRO_DEBITO) OR UPDATE(ULT_RETENCION) OR UPDATE(FECHA_ULT_COMPRIME) OR UPDATE(LIMPIAR_APLICACION) OR UPDATE(INTRO_FACTURAS) OR UPDATE(TIPO_ASIENTO_DEB) OR UPDATE(PAQUETE_DEB) OR UPDATE(TIPO_ASIENTO_CRE) OR UPDATE(PAQUETE_CRE) OR UPDATE(VENC_PERIODO1) OR UPDATE(VENC_PERIODO2) OR UPDATE(VENC_PERIODO3) OR UPDATE(VENC_PERIODO4) OR UPDATE(ANT_PERIODO1) OR UPDATE(ANT_PERIODO2) OR UPDATE(ANT_PERIODO3) OR UPDATE(ANT_PERIODO4) OR UPDATE(ASIENTO_FAC) OR UPDATE(ASIENTO_INT) OR UPDATE(ASIENTO_ND) OR UPDATE(ASIENTO_OD) OR UPDATE(ASIENTO_LC) OR UPDATE(ASIENTO_REC) OR UPDATE(ASIENTO_NC) OR UPDATE(ASIENTO_OC) OR UPDATE(ASIENTO_DEP) OR UPDATE(ASIENTO_TEF) OR UPDATE(ASIENTOS_CTA_PAIS) OR UPDATE(TIPO_CONTA_OMISION) OR UPDATE(INTEGRACION_CONTA) OR UPDATE(MOD_APLIC_ASIENTO) OR UPDATE(NIT_DUPLICADO) OR UPDATE(REFRESCA_AUTO) OR UPDATE(DOC_PRONTO_PAGO) OR UPDATE(DETALLE_OBLIGAT) OR UPDATE(USAR_RUBROS) OR UPDATE(RUBRO1_NOMBRE) OR UPDATE(RUBRO2_NOMBRE) OR UPDATE(IMPUESTO_X_OMISION) OR UPDATE(USAR_RUBROS_CLI) OR UPDATE(RUBRO1_CLI_NOMBRE) OR UPDATE(RUBRO2_CLI_NOMBRE) OR UPDATE(RUBRO3_CLI_NOMBRE) OR UPDATE(RUBRO4_CLI_NOMBRE) OR UPDATE(RUBRO5_CLI_NOMBRE) OR UPDATE(COPIARNOTASENASNT) OR UPDATE(ASOCOBLIGCONTFACT) OR UPDATE(VENC_PERIODO5) OR UPDATE(VENC_PERIODO6) OR UPDATE(ANT_PERIODO5) OR UPDATE(ANT_PERIODO6) OR UPDATE(ASOCIACION_DE_DOCS) OR UPDATE(NOM_RUBRO1_CLI) OR UPDATE(NOM_RUBRO2_CLI) OR UPDATE(NOM_RUBRO3_CLI) OR UPDATE(NOM_RUBRO4_CLI) OR UPDATE(NOM_RUBRO5_CLI) OR UPDATE(USAR_RUBROS_VAL) OR UPDATE(FORMA_CREACION) OR UPDATE(RUBROS_DIAS_REV) OR UPDATE(ASIENTO_INTC) OR UPDATE(ULT_INTERES_CTE) OR UPDATE(FECHA_ULT_DIFCAMB) OR UPDATE(ULT_LETRACAMBIO) OR UPDATE(ULT_DEPOSITO) OR UPDATE(ULT_TEF) OR UPDATE(ULT_RETDEBITO) OR UPDATE(NOM_RUBRO11_CLI) OR UPDATE(NOM_RUBRO12_CLI) OR UPDATE(NOM_RUBRO13_CLI) OR UPDATE(NOM_RUBRO14_CLI) OR UPDATE(NOM_RUBRO15_CLI) ) )
			BEGIN

				SELECT @COL_ROWPOINTER = ROWPOINTER 
				FROM $$Compania$$.GLOBALES_CC

			SET @PARAMETROS = 
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<GLOBALES_CC>' + 
				'<ULT_NOTA_CREDITO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ULT_NOTA_CREDITO) + '</ULT_NOTA_CREDITO>' + 
				'<ULT_NOTA_DEBITO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ULT_NOTA_DEBITO) + '</ULT_NOTA_DEBITO>' + 
				'<ULT_INTERES_MORA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ULT_INTERES_MORA) + '</ULT_INTERES_MORA>' + 
				'<ULT_RECIBO_DINERO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ULT_RECIBO_DINERO) + '</ULT_RECIBO_DINERO>' + 
				'<ULT_FACTURA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ULT_FACTURA) + '</ULT_FACTURA>' + 
				'<ULT_OTRO_CREDITO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ULT_OTRO_CREDITO) + '</ULT_OTRO_CREDITO>' + 
				'<ULT_OTRO_DEBITO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ULT_OTRO_DEBITO) + '</ULT_OTRO_DEBITO>' + 
				'<ULT_RETENCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ULT_RETENCION) + '</ULT_RETENCION>' + 
				'<FECHA_ULT_COMPRIME Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_ULT_COMPRIME) + '</FECHA_ULT_COMPRIME>' + 
				'<LIMPIAR_APLICACION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@LIMPIAR_APLICACION) + '</LIMPIAR_APLICACION>' + 
				'<INTRO_FACTURAS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@INTRO_FACTURAS) + '</INTRO_FACTURAS>' + 
				'<TIPO_ASIENTO_DEB Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_ASIENTO_DEB) + '</TIPO_ASIENTO_DEB>' + 
				'<PAQUETE_DEB Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@PAQUETE_DEB) + '</PAQUETE_DEB>' + 
				'<TIPO_ASIENTO_CRE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_ASIENTO_CRE) + '</TIPO_ASIENTO_CRE>' + 
				'<PAQUETE_CRE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@PAQUETE_CRE) + '</PAQUETE_CRE>' + 
				'<VENC_PERIODO1 Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@VENC_PERIODO1) + '</VENC_PERIODO1>' + 
				'<VENC_PERIODO2 Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@VENC_PERIODO2) + '</VENC_PERIODO2>' + 
				'<VENC_PERIODO3 Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@VENC_PERIODO3) + '</VENC_PERIODO3>' + 
				'<VENC_PERIODO4 Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@VENC_PERIODO4) + '</VENC_PERIODO4>' + 
				'<ANT_PERIODO1 Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@ANT_PERIODO1) + '</ANT_PERIODO1>' + 
				'<ANT_PERIODO2 Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@ANT_PERIODO2) + '</ANT_PERIODO2>' + 
				'<ANT_PERIODO3 Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@ANT_PERIODO3) + '</ANT_PERIODO3>' + 
				'<ANT_PERIODO4 Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@ANT_PERIODO4) + '</ANT_PERIODO4>' + 
				'<ASIENTO_FAC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ASIENTO_FAC) + '</ASIENTO_FAC>' + 
				'<ASIENTO_INT Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ASIENTO_INT) + '</ASIENTO_INT>' + 
				'<ASIENTO_ND Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ASIENTO_ND) + '</ASIENTO_ND>' + 
				'<ASIENTO_OD Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ASIENTO_OD) + '</ASIENTO_OD>' + 
				'<ASIENTO_LC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ASIENTO_LC) + '</ASIENTO_LC>' + 
				'<ASIENTO_REC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ASIENTO_REC) + '</ASIENTO_REC>' + 
				'<ASIENTO_NC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ASIENTO_NC) + '</ASIENTO_NC>' + 
				'<ASIENTO_OC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ASIENTO_OC) + '</ASIENTO_OC>' + 
				'<ASIENTO_DEP Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ASIENTO_DEP) + '</ASIENTO_DEP>' +
				'<ASIENTO_TEF Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ASIENTO_TEF) + '</ASIENTO_TEF>' + 
				'<ASIENTOS_CTA_PAIS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ASIENTOS_CTA_PAIS) + '</ASIENTOS_CTA_PAIS>' + 
				'<TIPO_CONTA_OMISION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_CONTA_OMISION) + '</TIPO_CONTA_OMISION>' + 
				'<INTEGRACION_CONTA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@INTEGRACION_CONTA) + '</INTEGRACION_CONTA>' + 
				'<MOD_APLIC_ASIENTO Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@MOD_APLIC_ASIENTO) + '</MOD_APLIC_ASIENTO>'
			
			SET @PARAMETROS2 =				
				'<NIT_DUPLICADO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NIT_DUPLICADO) + '</NIT_DUPLICADO>' + 
				'<REFRESCA_AUTO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@REFRESCA_AUTO) + '</REFRESCA_AUTO>' + 
				'<DOC_PRONTO_PAGO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DOC_PRONTO_PAGO) + '</DOC_PRONTO_PAGO>' + 
				'<DETALLE_OBLIGAT Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DETALLE_OBLIGAT) + '</DETALLE_OBLIGAT>' + 
				'<USAR_RUBROS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USAR_RUBROS) + '</USAR_RUBROS>' + 
				'<RUBRO1_NOMBRE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@RUBRO1_NOMBRE) + '</RUBRO1_NOMBRE>' + 
				'<RUBRO2_NOMBRE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@RUBRO2_NOMBRE) + '</RUBRO2_NOMBRE>' + 
				'<IMPUESTO_X_OMISION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@IMPUESTO_X_OMISION) + '</IMPUESTO_X_OMISION>' + 
				'<USAR_RUBROS_CLI Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USAR_RUBROS_CLI) + '</USAR_RUBROS_CLI>' + 
				'<RUBRO1_CLI_NOMBRE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@RUBRO1_CLI_NOMBRE) + '</RUBRO1_CLI_NOMBRE>' + 
				'<RUBRO2_CLI_NOMBRE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@RUBRO2_CLI_NOMBRE) + '</RUBRO2_CLI_NOMBRE>' + 
				'<RUBRO3_CLI_NOMBRE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@RUBRO3_CLI_NOMBRE) + '</RUBRO3_CLI_NOMBRE>' + 
				'<RUBRO4_CLI_NOMBRE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@RUBRO4_CLI_NOMBRE) + '</RUBRO4_CLI_NOMBRE>' + 
				'<RUBRO5_CLI_NOMBRE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@RUBRO5_CLI_NOMBRE) + '</RUBRO5_CLI_NOMBRE>' + 
				'<COPIARNOTASENASNT Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@COPIARNOTASENASNT) + '</COPIARNOTASENASNT>' + 
				'<ASOCOBLIGCONTFACT Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ASOCOBLIGCONTFACT) + '</ASOCOBLIGCONTFACT>' + 
				'<VENC_PERIODO5 Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@VENC_PERIODO5) + '</VENC_PERIODO5>' + 
				'<VENC_PERIODO6 Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@VENC_PERIODO6) + '</VENC_PERIODO6>' + 
				'<ANT_PERIODO5 Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@ANT_PERIODO5) + '</ANT_PERIODO5>' + 
				'<ANT_PERIODO6 Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@ANT_PERIODO6) + '</ANT_PERIODO6>' + 
				'<ASOCIACION_DE_DOCS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ASOCIACION_DE_DOCS) + '</ASOCIACION_DE_DOCS>' + 
				'<NOM_RUBRO1_CLI Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOM_RUBRO1_CLI) + '</NOM_RUBRO1_CLI>' + 
				'<NOM_RUBRO2_CLI Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOM_RUBRO2_CLI) + '</NOM_RUBRO2_CLI>' + 
				'<NOM_RUBRO3_CLI Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOM_RUBRO3_CLI) + '</NOM_RUBRO3_CLI>' + 
				'<NOM_RUBRO4_CLI Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOM_RUBRO4_CLI) + '</NOM_RUBRO4_CLI>' + 
				'<NOM_RUBRO5_CLI Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOM_RUBRO5_CLI) + '</NOM_RUBRO5_CLI>' + 
				'<USAR_RUBROS_VAL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USAR_RUBROS_VAL) + '</USAR_RUBROS_VAL>' + 
				'<FORMA_CREACION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@FORMA_CREACION) + '</FORMA_CREACION>' + 
				'<RUBROS_DIAS_REV Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@RUBROS_DIAS_REV) + '</RUBROS_DIAS_REV>' + 
				'<ASIENTO_INTC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ASIENTO_INTC) + '</ASIENTO_INTC>' + 
				'<ULT_INTERES_CTE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ULT_INTERES_CTE) + '</ULT_INTERES_CTE>' + 
				'<FECHA_ULT_DIFCAMB Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_ULT_DIFCAMB) + '</FECHA_ULT_DIFCAMB>' + 
				'<ULT_LETRACAMBIO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ULT_LETRACAMBIO) + '</ULT_LETRACAMBIO>' + 
				'<ULT_DEPOSITO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ULT_DEPOSITO) + '</ULT_DEPOSITO>' + 
				'<ULT_TEF Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ULT_TEF) + '</ULT_TEF>' + 
				'<ULT_RETDEBITO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ULT_RETDEBITO) + '</ULT_RETDEBITO>' + 
				'<NOM_RUBRO11_CLI Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOM_RUBRO11_CLI) + '</NOM_RUBRO11_CLI>' + 
				'<NOM_RUBRO12_CLI Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOM_RUBRO12_CLI) + '</NOM_RUBRO12_CLI>' + 
				'<NOM_RUBRO13_CLI Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOM_RUBRO13_CLI) + '</NOM_RUBRO13_CLI>' + 
				'<NOM_RUBRO14_CLI Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOM_RUBRO14_CLI) + '</NOM_RUBRO14_CLI>' + 
				'<NOM_RUBRO15_CLI Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOM_RUBRO15_CLI) + '</NOM_RUBRO15_CLI>' + 
				'</GLOBALES_CC>'


				-- inserta la solicitud correspondiente
				EXECUTE  ('ERPADMIN.POS_InsertarSolicitud ''' + @PUBLICADOR + ''', ''GLOBALESCCPOS600'', ''MODIFICA'', ''' + @PARAMETROS + @PARAMETROS2 + ''', ' + @ACTUALIZAR_SOLICITUD + ', ''' + @COL_ROWPOINTER + '''')
			END

			FETCH NEXT FROM C_MODIFIED
			INTO @ULT_NOTA_CREDITO, @ULT_NOTA_DEBITO, @ULT_INTERES_MORA, @ULT_RECIBO_DINERO, @ULT_FACTURA, @ULT_OTRO_CREDITO, @ULT_OTRO_DEBITO, @ULT_RETENCION, @FECHA_ULT_COMPRIME, @LIMPIAR_APLICACION, @INTRO_FACTURAS, @TIPO_ASIENTO_DEB, @PAQUETE_DEB, @TIPO_ASIENTO_CRE, @PAQUETE_CRE, @VENC_PERIODO1, @VENC_PERIODO2, @VENC_PERIODO3, @VENC_PERIODO4, @ANT_PERIODO1, @ANT_PERIODO2, @ANT_PERIODO3, @ANT_PERIODO4, @ASIENTO_FAC, @ASIENTO_INT, @ASIENTO_ND, @ASIENTO_OD, @ASIENTO_LC, @ASIENTO_REC, @ASIENTO_NC, @ASIENTO_OC, @ASIENTO_DEP, @ASIENTO_TEF, @ASIENTOS_CTA_PAIS, @TIPO_CONTA_OMISION, @INTEGRACION_CONTA, @MOD_APLIC_ASIENTO, @NIT_DUPLICADO, @REFRESCA_AUTO, @DOC_PRONTO_PAGO, @DETALLE_OBLIGAT, @USAR_RUBROS, @RUBRO1_NOMBRE, @RUBRO2_NOMBRE, @IMPUESTO_X_OMISION, @USAR_RUBROS_CLI, @RUBRO1_CLI_NOMBRE, @RUBRO2_CLI_NOMBRE, @RUBRO3_CLI_NOMBRE, @RUBRO4_CLI_NOMBRE, @RUBRO5_CLI_NOMBRE, @COPIARNOTASENASNT, @ASOCOBLIGCONTFACT, @VENC_PERIODO5, @VENC_PERIODO6, @ANT_PERIODO5, @ANT_PERIODO6, @ASOCIACION_DE_DOCS, @NOM_RUBRO1_CLI, @NOM_RUBRO2_CLI, @NOM_RUBRO3_CLI, @NOM_RUBRO4_CLI, @NOM_RUBRO5_CLI, @USAR_RUBROS_VAL, @FORMA_CREACION, @RUBROS_DIAS_REV, @ASIENTO_INTC, @ULT_INTERES_CTE, @FECHA_ULT_DIFCAMB, @ULT_LETRACAMBIO, @ULT_DEPOSITO, @ULT_TEF, @ULT_RETDEBITO, @NOM_RUBRO11_CLI, @NOM_RUBRO12_CLI, @NOM_RUBRO13_CLI, @NOM_RUBRO14_CLI, @NOM_RUBRO15_CLI
		END

		CLOSE C_MODIFIED
		DEALLOCATE C_MODIFIED
	END

	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para modificar la tabla GLOBALES_CC.',16,1 )
	END
END;




CREATE TRIGGER $$Compania$$.CUPON_POS_INS
ON $$Compania$$.CUPON
FOR INSERT
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @CUPON VARCHAR(20)
	DECLARE @DESCRIPCION VARCHAR(60)
	DECLARE @ESTADO VARCHAR(1)
	DECLARE @CLIENTE VARCHAR(20)
	DECLARE @MONEDA VARCHAR(1)
	DECLARE @MONTO DECIMAL(28,8)
	DECLARE @SALDO DECIMAL(28,8)
	DECLARE @FECHA_VENCE DATETIME
	DECLARE @FCH_HORA_BLOQUEO DATETIME
	DECLARE @CAJERO_BLOQUEO VARCHAR(20)
	DECLARE @TIPO_CUPON VARCHAR(1)
	

	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM 
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_INSERTED CURSOR LOCAL FOR
		SELECT CUPON, DESCRIPCION, ESTADO, CLIENTE, MONEDA, MONTO, SALDO, FECHA_VENCE, FCH_HORA_BLOQUEO, CAJERO_BLOQUEO, TIPO_CUPON
		FROM INSERTED i
		WHERE 0 = (
				SELECT COUNT('n')
				FROM DELETED d
				WHERE i.CUPON = d.CUPON
			   )
			
		OPEN C_INSERTED	
		FETCH NEXT FROM C_INSERTED INTO
		@CUPON, @DESCRIPCION, @ESTADO, @CLIENTE, @MONEDA, @MONTO, @SALDO, @FECHA_VENCE, @FCH_HORA_BLOQUEO, @CAJERO_BLOQUEO, @TIPO_CUPON

		SET @ERROR = 0
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS = 
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<CUPON>' + 
				'<CUPON Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CUPON) + '</CUPON>' + 
				'<DESCRIPCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DESCRIPCION) + '</DESCRIPCION>' + 
				'<ESTADO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ESTADO) + '</ESTADO>' + 
				'<CLIENTE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CLIENTE) + '</CLIENTE>' + 
				'<MONEDA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@MONEDA) + '</MONEDA>' + 
				'<MONTO Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@MONTO) + '</MONTO>' + 
				'<SALDO Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@SALDO) + '</SALDO>' + 
				'<FECHA_VENCE Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_VENCE) + '</FECHA_VENCE>' + 
				'<FCH_HORA_BLOQUEO Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FCH_HORA_BLOQUEO) + '</FCH_HORA_BLOQUEO>' + 
				'<CAJERO_BLOQUEO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CAJERO_BLOQUEO) + '</CAJERO_BLOQUEO>' + 
				'<TIPO_CUPON Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_CUPON) + '</TIPO_CUPON>' + 
				'</CUPON>'


			-- Inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'CUPONPOS600', 'INSERTA', @PARAMETROS, 0, ''

			FETCH NEXT FROM C_INSERTED INTO
			@CUPON, @DESCRIPCION, @ESTADO, @CLIENTE, @MONEDA, @MONTO, @SALDO, @FECHA_VENCE, @FCH_HORA_BLOQUEO, @CAJERO_BLOQUEO, @TIPO_CUPON
		END

		CLOSE C_INSERTED
    		DEALLOCATE C_INSERTED
	END

	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla CUPON.',16,1 )
	END
END
;




CREATE TRIGGER $$Compania$$.CUPON_POS_MOD
ON $$Compania$$.CUPON
FOR UPDATE
AS 
BEGIN   	
	DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @COL_ROWPOINTER VARCHAR(36)
	DECLARE @HAY_CAMPOS_PARA_POS BIT
	DECLARE @ACTUALIZAR_SOLICITUD BIT
	DECLARE @CUPON VARCHAR(20)
	DECLARE @DESCRIPCION VARCHAR(60)
	DECLARE @ESTADO VARCHAR(1)
	DECLARE @CLIENTE VARCHAR(20)
	DECLARE @MONEDA VARCHAR(1)
	DECLARE @MONTO DECIMAL(28,8)
	DECLARE @SALDO DECIMAL(28,8)
	DECLARE @FECHA_VENCE DATETIME
	DECLARE @FCH_HORA_BLOQUEO DATETIME
	DECLARE @CAJERO_BLOQUEO VARCHAR(20)
	DECLARE @TIPO_CUPON VARCHAR(1)
	 -- Declaraciones

	SET @ERROR = 0

	SELECT @PUBLICADOR = SITIO_LOCAL, @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_MODIFIED CURSOR LOCAL FOR
			SELECT CUPON, DESCRIPCION, ESTADO, CLIENTE, MONEDA, MONTO, SALDO, FECHA_VENCE, FCH_HORA_BLOQUEO, CAJERO_BLOQUEO, TIPO_CUPON -- Columnas
			FROM INSERTED I

		SET @ACTUALIZAR_SOLICITUD = 0

		OPEN C_MODIFIED

		FETCH NEXT FROM C_MODIFIED
		INTO @CUPON, @DESCRIPCION, @ESTADO, @CLIENTE, @MONEDA, @MONTO, @SALDO, @FECHA_VENCE, @FCH_HORA_BLOQUEO, @CAJERO_BLOQUEO, @TIPO_CUPON

		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			IF ( NOT UPDATE(RECORDDATE) AND ( UPDATE(CUPON) OR UPDATE(DESCRIPCION) OR UPDATE(ESTADO) OR UPDATE(CLIENTE) OR UPDATE(MONEDA) OR UPDATE(MONTO) OR UPDATE(SALDO) OR UPDATE(FECHA_VENCE) OR UPDATE(FCH_HORA_BLOQUEO) OR UPDATE(CAJERO_BLOQUEO) OR UPDATE(TIPO_CUPON) ) )
			BEGIN

				SELECT @COL_ROWPOINTER = ROWPOINTER 
				FROM $$Compania$$.CUPON
				WHERE CUPON = @CUPON 

				SET @PARAMETROS =
					'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<CUPON>' + 
				'<CUPON Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CUPON) + '</CUPON>' + 
				'<DESCRIPCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DESCRIPCION) + '</DESCRIPCION>' + 
				'<ESTADO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ESTADO) + '</ESTADO>' + 
				'<CLIENTE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CLIENTE) + '</CLIENTE>' + 
				'<MONEDA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@MONEDA) + '</MONEDA>' + 
				'<MONTO Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@MONTO) + '</MONTO>' + 
				'<SALDO Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@SALDO) + '</SALDO>' + 
				'<FECHA_VENCE Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_VENCE) + '</FECHA_VENCE>' + 
				'<FCH_HORA_BLOQUEO Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FCH_HORA_BLOQUEO) + '</FCH_HORA_BLOQUEO>' + 
				'<CAJERO_BLOQUEO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CAJERO_BLOQUEO) + '</CAJERO_BLOQUEO>' + 
				'<TIPO_CUPON Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_CUPON) + '</TIPO_CUPON>' + 
				'</CUPON>'


				-- inserta la solicitud correspondiente
				EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'CUPONPOS600', 'MODIFICA', @PARAMETROS, @ACTUALIZAR_SOLICITUD, @COL_ROWPOINTER
			END

			FETCH NEXT FROM C_MODIFIED
			INTO @CUPON, @DESCRIPCION, @ESTADO, @CLIENTE, @MONEDA, @MONTO, @SALDO, @FECHA_VENCE, @FCH_HORA_BLOQUEO, @CAJERO_BLOQUEO, @TIPO_CUPON
		END

		CLOSE C_MODIFIED
		DEALLOCATE C_MODIFIED
	END

	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para modificar la tabla CUPON.',16,1 )
	END
END
;





CREATE TRIGGER $$Compania$$.CUPON_POS_DEL
ON $$Compania$$.CUPON
FOR DELETE  
AS 
BEGIN   	
    DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @CUPON VARCHAR(20)
	DECLARE @DESCRIPCION VARCHAR(60)
	DECLARE @ESTADO VARCHAR(1)
	DECLARE @CLIENTE VARCHAR(20)
	DECLARE @MONEDA VARCHAR(1)
	DECLARE @MONTO DECIMAL(28,8)
	DECLARE @SALDO DECIMAL(28,8)
	DECLARE @FECHA_VENCE DATETIME
	DECLARE @FCH_HORA_BLOQUEO DATETIME
	DECLARE @CAJERO_BLOQUEO VARCHAR(20)
	DECLARE @TIPO_CUPON VARCHAR(1)
	 -- Declaraciones	

	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM 
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_DELETED CURSOR LOCAL FOR
			SELECT CUPON, DESCRIPCION, ESTADO, CLIENTE, MONEDA, MONTO, SALDO, FECHA_VENCE, FCH_HORA_BLOQUEO, CAJERO_BLOQUEO, TIPO_CUPON
			FROM DELETED d
			WHERE 0 = (
				SELECT COUNT('n')
				FROM INSERTED i
				WHERE d.CUPON = i.CUPON
			   )

		OPEN C_DELETED
		FETCH NEXT FROM C_DELETED INTO 
		@CUPON, @DESCRIPCION, @ESTADO, @CLIENTE, @MONEDA, @MONTO, @SALDO, @FECHA_VENCE, @FCH_HORA_BLOQUEO, @CAJERO_BLOQUEO, @TIPO_CUPON -- VARIABLES
		
		SET @ERROR = 0
		
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS = 
								'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<CUPON>' + 
				'<CUPON Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CUPON) + '</CUPON>' + 
				'<DESCRIPCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DESCRIPCION) + '</DESCRIPCION>' + 
				'<ESTADO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ESTADO) + '</ESTADO>' + 
				'<CLIENTE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CLIENTE) + '</CLIENTE>' + 
				'<MONEDA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@MONEDA) + '</MONEDA>' + 
				'<MONTO Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@MONTO) + '</MONTO>' + 
				'<SALDO Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@SALDO) + '</SALDO>' + 
				'<FECHA_VENCE Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_VENCE) + '</FECHA_VENCE>' + 
				'<FCH_HORA_BLOQUEO Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FCH_HORA_BLOQUEO) + '</FCH_HORA_BLOQUEO>' + 
				'<CAJERO_BLOQUEO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CAJERO_BLOQUEO) + '</CAJERO_BLOQUEO>' + 
				'<TIPO_CUPON Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_CUPON) + '</TIPO_CUPON>' + 
				'</CUPON>'
 
			
			-- inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'CUPONPOS600', 'ELIMINA', @PARAMETROS, 0, ''
			
			FETCH NEXT FROM C_DELETED INTO 
			@CUPON, @DESCRIPCION, @ESTADO, @CLIENTE, @MONEDA, @MONTO, @SALDO, @FECHA_VENCE, @FCH_HORA_BLOQUEO, @CAJERO_BLOQUEO, @TIPO_CUPON -- VARIABLES
		END

		CLOSE C_DELETED
		DEALLOCATE C_DELETED
	END
	
	IF (@@ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para eliminar de la tabla CUPON.',16,1 )
	END
END
;




CREATE TRIGGER $$Compania$$.AUDIT_CUPON_POS_INS
ON $$Compania$$.AUDIT_CUPON
FOR INSERT
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @CUPON VARCHAR(20)
	DECLARE @TIENDA VARCHAR(6)
	DECLARE @CAJA VARCHAR(6)
	DECLARE @FECHA_APLICA DATETIME
	DECLARE @CAJERO VARCHAR(25)
	DECLARE @DOCUMENTO VARCHAR(50)
	DECLARE @TIPO VARCHAR(1)
	DECLARE @MONTO_APLICA DECIMAL(28,8)
	

	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM 
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_INSERTED CURSOR LOCAL FOR
		SELECT CUPON, TIENDA, CAJA, FECHA_APLICA, CAJERO, DOCUMENTO, TIPO, MONTO_APLICA
		FROM INSERTED i
		WHERE 0 = (
				SELECT COUNT('n')
				FROM DELETED d
				WHERE i.CUPON = d.CUPON AND i.CAJA = d.CAJA AND i.DOCUMENTO = d.DOCUMENTO AND i.TIPO = d.TIPO
			   )
			
		OPEN C_INSERTED	
		FETCH NEXT FROM C_INSERTED INTO
		@CUPON, @TIENDA, @CAJA, @FECHA_APLICA, @CAJERO, @DOCUMENTO, @TIPO, @MONTO_APLICA

		SET @ERROR = 0
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS = 
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<AUDIT_CUPON>' + 
				'<CUPON Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CUPON) + '</CUPON>' + 
				'<TIENDA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIENDA) + '</TIENDA>' + 
				'<CAJA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CAJA) + '</CAJA>' + 
				'<FECHA_APLICA Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_APLICA) + '</FECHA_APLICA>' + 
				'<CAJERO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CAJERO) + '</CAJERO>' + 
				'<DOCUMENTO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@DOCUMENTO) + '</DOCUMENTO>' + 
				'<TIPO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO) + '</TIPO>' + 
				'<MONTO_APLICA Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@MONTO_APLICA) + '</MONTO_APLICA>' + 
				'</AUDIT_CUPON>'


			-- Inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'AUDITCUPONPOS600', 'INSERTA', @PARAMETROS, 0, ''

			FETCH NEXT FROM C_INSERTED INTO
			@CUPON, @TIENDA, @CAJA, @FECHA_APLICA, @CAJERO, @DOCUMENTO, @TIPO, @MONTO_APLICA
		END

		CLOSE C_INSERTED
    		DEALLOCATE C_INSERTED
	END

	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla AUDIT_CUPON.',16,1 )
	END
END
;




CREATE TRIGGER $$Compania$$.AUDIT_CUPON_POS_MOD
ON $$Compania$$.AUDIT_CUPON
FOR UPDATE
AS 
BEGIN   	
	DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @COL_ROWPOINTER VARCHAR(36)
	DECLARE @HAY_CAMPOS_PARA_POS BIT
	DECLARE @ACTUALIZAR_SOLICITUD BIT
	DECLARE @CUPON VARCHAR(20)
	DECLARE @TIENDA VARCHAR(6)
	DECLARE @CAJA VARCHAR(6)
	DECLARE @FECHA_APLICA DATETIME
	DECLARE @CAJERO VARCHAR(25)
	DECLARE @DOCUMENTO VARCHAR(50)
	DECLARE @TIPO VARCHAR(1)
	DECLARE @MONTO_APLICA DECIMAL(28,8)
	 -- Declaraciones

	SET @ERROR = 0

	SELECT @PUBLICADOR = SITIO_LOCAL, @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_MODIFIED CURSOR LOCAL FOR
			SELECT CUPON, TIENDA, CAJA, FECHA_APLICA, CAJERO, DOCUMENTO, TIPO, MONTO_APLICA -- Columnas
			FROM INSERTED I

		SET @ACTUALIZAR_SOLICITUD = 1

		OPEN C_MODIFIED

		FETCH NEXT FROM C_MODIFIED
		INTO @CUPON, @TIENDA, @CAJA, @FECHA_APLICA, @CAJERO, @DOCUMENTO, @TIPO, @MONTO_APLICA

		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			IF ( NOT UPDATE(RECORDDATE) AND ( UPDATE(CUPON) OR UPDATE(TIENDA) OR UPDATE(CAJA) OR UPDATE(FECHA_APLICA) OR UPDATE(CAJERO) OR UPDATE(DOCUMENTO) OR UPDATE(TIPO) OR UPDATE(MONTO_APLICA) ) )
			BEGIN

				SELECT @COL_ROWPOINTER = ROWPOINTER 
				FROM $$Compania$$.AUDIT_CUPON
				WHERE CUPON = @CUPON AND CAJA = @CAJA AND DOCUMENTO = @DOCUMENTO AND TIPO = @TIPO 

				SET @PARAMETROS =
					'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<AUDIT_CUPON>' + 
				'<CUPON Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CUPON) + '</CUPON>' + 
				'<TIENDA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIENDA) + '</TIENDA>' + 
				'<CAJA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CAJA) + '</CAJA>' + 
				'<FECHA_APLICA Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_APLICA) + '</FECHA_APLICA>' + 
				'<CAJERO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CAJERO) + '</CAJERO>' + 
				'<DOCUMENTO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@DOCUMENTO) + '</DOCUMENTO>' + 
				'<TIPO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO) + '</TIPO>' + 
				'<MONTO_APLICA Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@MONTO_APLICA) + '</MONTO_APLICA>' + 
				'</AUDIT_CUPON>'


				-- inserta la solicitud correspondiente
				EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'AUDITCUPONPOS600', 'MODIFICA', @PARAMETROS, @ACTUALIZAR_SOLICITUD, @COL_ROWPOINTER
			END

			FETCH NEXT FROM C_MODIFIED
			INTO @CUPON, @TIENDA, @CAJA, @FECHA_APLICA, @CAJERO, @DOCUMENTO, @TIPO, @MONTO_APLICA
		END

		CLOSE C_MODIFIED
		DEALLOCATE C_MODIFIED
	END

	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para modificar la tabla AUDIT_CUPON.',16,1 )
	END
END
;



CREATE TRIGGER $$Compania$$.AUDIT_CUPON_POS_DEL
ON $$Compania$$.AUDIT_CUPON
FOR DELETE  
AS 
BEGIN   	
                DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @CUPON VARCHAR(20)
	DECLARE @TIENDA VARCHAR(6)
	DECLARE @CAJA VARCHAR(6)
	DECLARE @FECHA_APLICA DATETIME
	DECLARE @CAJERO VARCHAR(25)
	DECLARE @DOCUMENTO VARCHAR(50)
	DECLARE @TIPO VARCHAR(1)
	DECLARE @MONTO_APLICA DECIMAL(28,8)
	 -- Declaraciones	

	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM 
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_DELETED CURSOR LOCAL FOR
			SELECT CUPON, TIENDA, CAJA, FECHA_APLICA, CAJERO, DOCUMENTO, TIPO, MONTO_APLICA
			FROM DELETED d
			WHERE 0 = (
				SELECT COUNT('n')
				FROM INSERTED i
				WHERE d.CUPON = i.CUPON AND d.CAJA = i.CAJA AND d.DOCUMENTO = i.DOCUMENTO AND d.TIPO = i.TIPO
			   )

		OPEN C_DELETED
		FETCH NEXT FROM C_DELETED INTO 
		@CUPON, @TIENDA, @CAJA, @FECHA_APLICA, @CAJERO, @DOCUMENTO, @TIPO, @MONTO_APLICA -- VARIABLES
		
		SET @ERROR = 0
		
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS = 
								'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<AUDIT_CUPON>' + 
				'<CUPON Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CUPON) + '</CUPON>' + 
				'<TIENDA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIENDA) + '</TIENDA>' + 
				'<CAJA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CAJA) + '</CAJA>' + 
				'<FECHA_APLICA Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_APLICA) + '</FECHA_APLICA>' + 
				'<CAJERO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CAJERO) + '</CAJERO>' + 
				'<DOCUMENTO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@DOCUMENTO) + '</DOCUMENTO>' + 
				'<TIPO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO) + '</TIPO>' + 
				'<MONTO_APLICA Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@MONTO_APLICA) + '</MONTO_APLICA>' + 
				'</AUDIT_CUPON>'
 
			
			-- inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'AUDITCUPONPOS600', 'ELIMINA', @PARAMETROS, 0, ''
			
			FETCH NEXT FROM C_DELETED INTO 
			@CUPON, @TIENDA, @CAJA, @FECHA_APLICA, @CAJERO, @DOCUMENTO, @TIPO, @MONTO_APLICA -- VARIABLES
		END

		CLOSE C_DELETED
		DEALLOCATE C_DELETED
	END
	
	IF (@@ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para eliminar de la tabla AUDIT_CUPON.',16,1 )
	END
END
;




CREATE TRIGGER $$Compania$$.REGLA_ARTICULO_POS_INS
ON $$Compania$$.REGLA_ARTICULO
FOR INSERT
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @REGLA_DESCUENTO INT
	DECLARE @ARTICULO VARCHAR(20)
	

	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM 
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_INSERTED CURSOR LOCAL FOR
		SELECT REGLA_DESCUENTO, ARTICULO
		FROM INSERTED i
		WHERE 0 = (
				SELECT COUNT('n')
				FROM DELETED d
				WHERE i.REGLA_DESCUENTO = d.REGLA_DESCUENTO AND i.ARTICULO = d.ARTICULO
			   )
			
		OPEN C_INSERTED	
		FETCH NEXT FROM C_INSERTED INTO
		@REGLA_DESCUENTO, @ARTICULO

		SET @ERROR = 0
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS = 
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<REGLA_ARTICULO>' + 
				'<REGLA_DESCUENTO Type="INT" PrimaryKey="True">' + ERPADMIN.POS_NumberToVarchar(@REGLA_DESCUENTO) + '</REGLA_DESCUENTO>' + 
				'<ARTICULO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@ARTICULO) + '</ARTICULO>' + 
				'</REGLA_ARTICULO>'


			-- Inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'REGLAARTICULOPOS600', 'INSERTA', @PARAMETROS, 0, ''

			FETCH NEXT FROM C_INSERTED INTO
			@REGLA_DESCUENTO, @ARTICULO
		END

		CLOSE C_INSERTED
    		DEALLOCATE C_INSERTED
	END

	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla REGLA_ARTICULO.',16,1 )
	END
END
;




CREATE TRIGGER $$Compania$$.REGLA_ARTICULO_POS_MOD
ON $$Compania$$.REGLA_ARTICULO
FOR UPDATE
AS 
BEGIN   	
	DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @COL_ROWPOINTER VARCHAR(36)
	DECLARE @HAY_CAMPOS_PARA_POS BIT
	DECLARE @ACTUALIZAR_SOLICITUD BIT
	DECLARE @REGLA_DESCUENTO INT
	DECLARE @ARTICULO VARCHAR(20)
	 -- Declaraciones

	SET @ERROR = 0

	SELECT @PUBLICADOR = SITIO_LOCAL, @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_MODIFIED CURSOR LOCAL FOR
			SELECT REGLA_DESCUENTO, ARTICULO -- Columnas
			FROM INSERTED I

		SET @ACTUALIZAR_SOLICITUD = 1

		OPEN C_MODIFIED

		FETCH NEXT FROM C_MODIFIED
		INTO @REGLA_DESCUENTO, @ARTICULO

		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			IF ( NOT UPDATE(RECORDDATE) AND ( UPDATE(REGLA_DESCUENTO) OR UPDATE(ARTICULO) ) )
			BEGIN

				SELECT @COL_ROWPOINTER = ROWPOINTER 
				FROM $$Compania$$.REGLA_ARTICULO
				WHERE REGLA_DESCUENTO = @REGLA_DESCUENTO AND ARTICULO = @ARTICULO 

				SET @PARAMETROS =
					'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<REGLA_ARTICULO>' + 
				'<REGLA_DESCUENTO Type="INT" PrimaryKey="True">' + ERPADMIN.POS_NumberToVarchar(@REGLA_DESCUENTO) + '</REGLA_DESCUENTO>' + 
				'<ARTICULO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@ARTICULO) + '</ARTICULO>' + 
				'</REGLA_ARTICULO>'


				-- inserta la solicitud correspondiente
				EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'REGLAARTICULOPOS600', 'MODIFICA', @PARAMETROS, @ACTUALIZAR_SOLICITUD, @COL_ROWPOINTER
			END

			FETCH NEXT FROM C_MODIFIED
			INTO @REGLA_DESCUENTO, @ARTICULO
		END

		CLOSE C_MODIFIED
		DEALLOCATE C_MODIFIED
	END

	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para modificar la tabla REGLA_ARTICULO.',16,1 )
	END
END
;




CREATE TRIGGER $$Compania$$.REGLA_ARTICULO_POS_DEL
ON $$Compania$$.REGLA_ARTICULO
FOR DELETE  
AS 
BEGIN   	
                DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @REGLA_DESCUENTO INT
	DECLARE @ARTICULO VARCHAR(20)
	 -- Declaraciones	

	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM 
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_DELETED CURSOR LOCAL FOR
			SELECT REGLA_DESCUENTO, ARTICULO
			FROM DELETED d
			WHERE 0 = (
				SELECT COUNT('n')
				FROM INSERTED i
				WHERE d.REGLA_DESCUENTO = i.REGLA_DESCUENTO AND d.ARTICULO = i.ARTICULO
			   )

		OPEN C_DELETED
		FETCH NEXT FROM C_DELETED INTO 
		@REGLA_DESCUENTO, @ARTICULO -- VARIABLES
		
		SET @ERROR = 0
		
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS = 
								'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<REGLA_ARTICULO>' + 
				'<REGLA_DESCUENTO Type="INT" PrimaryKey="True">' + ERPADMIN.POS_NumberToVarchar(@REGLA_DESCUENTO) + '</REGLA_DESCUENTO>' + 
				'<ARTICULO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@ARTICULO) + '</ARTICULO>' + 
				'</REGLA_ARTICULO>'
 
			
			-- inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'REGLAARTICULOPOS600', 'ELIMINA', @PARAMETROS, 0, ''
			
			FETCH NEXT FROM C_DELETED INTO 
			@REGLA_DESCUENTO, @ARTICULO -- VARIABLES
		END

		CLOSE C_DELETED
		DEALLOCATE C_DELETED
	END
	
	IF (@@ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para eliminar de la tabla REGLA_ARTICULO.',16,1 )
	END
END
;



CREATE TRIGGER $$Compania$$.RESOLUCION_POS_POS_INS
ON $$Compania$$.RESOLUCION_POS
FOR INSERT
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @RESOLUCION VARCHAR(20)
	DECLARE @TIPO_DOCUMENTO VARCHAR(1)
	DECLARE @FECHA_RESOLUCION DATETIME
	DECLARE @FECHA_AUTORIZACION DATETIME
	DECLARE @FECHA_CREACION DATETIME
	DECLARE @SERIE VARCHAR(3)
	DECLARE @MASCARA VARCHAR(50)
	DECLARE @CONSEC_INICIAL VARCHAR(50)
	DECLARE @CONSEC_FINAL VARCHAR(50)
	DECLARE @VALOR VARCHAR(50)
	DECLARE @ESTADO VARCHAR(1)
	DECLARE @USUARIO_CREACION VARCHAR(20)
	DECLARE @CAJA VARCHAR(6)
	

	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM 
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_INSERTED CURSOR LOCAL FOR
		SELECT RESOLUCION, TIPO_DOCUMENTO, FECHA_RESOLUCION, FECHA_AUTORIZACION, FECHA_CREACION, SERIE, MASCARA, CONSEC_INICIAL, CONSEC_FINAL, VALOR, ESTADO, USUARIO_CREACION, CAJA 
		FROM INSERTED i
		
			
		OPEN C_INSERTED	
		FETCH NEXT FROM C_INSERTED INTO
		@RESOLUCION, @TIPO_DOCUMENTO, @FECHA_RESOLUCION, @FECHA_AUTORIZACION, @FECHA_CREACION, @SERIE, @MASCARA, @CONSEC_INICIAL, @CONSEC_FINAL, @VALOR, @ESTADO, @USUARIO_CREACION, @CAJA 

		SET @ERROR = 0
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS = 
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<RESOLUCION_POS>' + 
				'<RESOLUCION Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@RESOLUCION) + '</RESOLUCION>' + 
				'<TIPO_DOCUMENTO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_DOCUMENTO) + '</TIPO_DOCUMENTO>' + 
				'<FECHA_RESOLUCION Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_RESOLUCION) + '</FECHA_RESOLUCION>' + 
				'<FECHA_AUTORIZACION Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_AUTORIZACION) + '</FECHA_AUTORIZACION>' + 
				'<FECHA_CREACION Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_CREACION) + '</FECHA_CREACION>' + 
				'<SERIE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@SERIE) + '</SERIE>' + 
				'<MASCARA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@MASCARA) + '</MASCARA>' + 
				'<CONSEC_INICIAL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CONSEC_INICIAL) + '</CONSEC_INICIAL>' + 
				'<CONSEC_FINAL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CONSEC_FINAL) + '</CONSEC_FINAL>' + 
				'<VALOR Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@VALOR) + '</VALOR>' + 
				'<ESTADO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ESTADO) + '</ESTADO>' + 
				'<USUARIO_CREACION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USUARIO_CREACION) + '</USUARIO_CREACION>' + 
				'<CAJA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CAJA) + '</CAJA>' + 
				'</RESOLUCION_POS>'


			-- Inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'RESOLUCIONPOSPOS600', 'INSERTA', @PARAMETROS, 0, ''

			FETCH NEXT FROM C_INSERTED INTO
			@RESOLUCION, @TIPO_DOCUMENTO, @FECHA_RESOLUCION, @FECHA_AUTORIZACION, @FECHA_CREACION, @SERIE, @MASCARA, @CONSEC_INICIAL, @CONSEC_FINAL, @VALOR, @ESTADO, @USUARIO_CREACION, @CAJA
		END

		CLOSE C_INSERTED
    		DEALLOCATE C_INSERTED
	END

	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla RESOLUCION_POS.',16,1 )
	END
END;




CREATE TRIGGER $$Compania$$.RESOLUCION_POS_POS_MOD
ON $$Compania$$.RESOLUCION_POS
FOR UPDATE
AS 
BEGIN   	
	DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @COL_ROWPOINTER VARCHAR(36)
	DECLARE @HAY_CAMPOS_PARA_POS BIT
	DECLARE @ACTUALIZAR_SOLICITUD BIT
	DECLARE @RESOLUCION VARCHAR(20)
	DECLARE @TIPO_DOCUMENTO VARCHAR(1)
	DECLARE @FECHA_RESOLUCION DATETIME
	DECLARE @FECHA_AUTORIZACION DATETIME
	DECLARE @FECHA_CREACION DATETIME
	DECLARE @SERIE VARCHAR(3)
	DECLARE @MASCARA VARCHAR(50)
	DECLARE @CONSEC_INICIAL VARCHAR(50)
	DECLARE @CONSEC_FINAL VARCHAR(50)
	DECLARE @VALOR VARCHAR(50)
	DECLARE @ESTADO VARCHAR(1)
	DECLARE @USUARIO_CREACION VARCHAR(20)
	DECLARE @CAJA VARCHAR(6)
	 -- Declaraciones

	SET @ERROR = 0

	SELECT @PUBLICADOR = SITIO_LOCAL, @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_MODIFIED CURSOR LOCAL FOR
			SELECT RESOLUCION, TIPO_DOCUMENTO, FECHA_RESOLUCION, FECHA_AUTORIZACION, FECHA_CREACION, SERIE, MASCARA, CONSEC_INICIAL, CONSEC_FINAL, VALOR, ESTADO, USUARIO_CREACION, CAJA -- Columnas
			FROM INSERTED I

		SET @ACTUALIZAR_SOLICITUD = 1

		OPEN C_MODIFIED

		FETCH NEXT FROM C_MODIFIED
		INTO @RESOLUCION, @TIPO_DOCUMENTO, @FECHA_RESOLUCION, @FECHA_AUTORIZACION, @FECHA_CREACION, @SERIE, @MASCARA, @CONSEC_INICIAL, @CONSEC_FINAL, @VALOR, @ESTADO, @USUARIO_CREACION, @CAJA 

		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			IF ( NOT UPDATE(RECORDDATE) AND ( UPDATE(RESOLUCION) OR UPDATE(TIPO_DOCUMENTO) OR UPDATE(FECHA_RESOLUCION) OR UPDATE(FECHA_AUTORIZACION) OR UPDATE(FECHA_CREACION) OR UPDATE(SERIE) OR UPDATE(MASCARA) OR UPDATE(CONSEC_INICIAL) OR UPDATE(CONSEC_FINAL) OR UPDATE(VALOR) OR UPDATE(ESTADO) OR UPDATE(USUARIO_CREACION) OR UPDATE(CAJA) ) )
			BEGIN

				SELECT @COL_ROWPOINTER = ROWPOINTER 
				FROM $$Compania$$.RESOLUCION_POS
				 

				SET @PARAMETROS =
					'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<RESOLUCION_POS>' + 
				'<RESOLUCION Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@RESOLUCION) + '</RESOLUCION>' + 
				'<TIPO_DOCUMENTO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_DOCUMENTO) + '</TIPO_DOCUMENTO>' + 
				'<FECHA_RESOLUCION Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_RESOLUCION) + '</FECHA_RESOLUCION>' + 
				'<FECHA_AUTORIZACION Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_AUTORIZACION) + '</FECHA_AUTORIZACION>' + 
				'<FECHA_CREACION Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_CREACION) + '</FECHA_CREACION>' + 
				'<SERIE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@SERIE) + '</SERIE>' + 
				'<MASCARA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@MASCARA) + '</MASCARA>' + 
				'<CONSEC_INICIAL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CONSEC_INICIAL) + '</CONSEC_INICIAL>' + 
				'<CONSEC_FINAL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CONSEC_FINAL) + '</CONSEC_FINAL>' + 
				'<VALOR Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@VALOR) + '</VALOR>' + 
				'<ESTADO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ESTADO) + '</ESTADO>' + 
				'<USUARIO_CREACION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USUARIO_CREACION) + '</USUARIO_CREACION>' + 
				'<CAJA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CAJA) + '</CAJA>' + 
				'</RESOLUCION_POS>'


				-- inserta la solicitud correspondiente
				EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'RESOLUCIONPOSPOS600', 'MODIFICA', @PARAMETROS, @ACTUALIZAR_SOLICITUD, @COL_ROWPOINTER
			END

			FETCH NEXT FROM C_MODIFIED
			INTO @RESOLUCION, @TIPO_DOCUMENTO, @FECHA_RESOLUCION, @FECHA_AUTORIZACION, @FECHA_CREACION, @SERIE, @MASCARA, @CONSEC_INICIAL, @CONSEC_FINAL, @VALOR, @ESTADO, @USUARIO_CREACION, @CAJA
		END

		CLOSE C_MODIFIED
		DEALLOCATE C_MODIFIED
	END

	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para modificar la tabla RESOLUCION_POS.',16,1 )
	END
END;





CREATE TRIGGER $$Compania$$.RESOLUCION_POS_POS_DEL
ON $$Compania$$.RESOLUCION_POS
FOR DELETE  
AS 
BEGIN   	
    DECLARE @ERROR  int
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @RESOLUCION VARCHAR(20)	
	 -- Declaraciones	

	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM 
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_DELETED CURSOR LOCAL FOR
			SELECT RESOLUCION
			FROM DELETED d
			
		OPEN C_DELETED
		FETCH NEXT FROM C_DELETED INTO 
		@RESOLUCION -- VARIABLES
		
		SET @ERROR = 0
		
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS = 
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<RESOLUCION_POS>' + 
				'<RESOLUCION Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@RESOLUCION) + '</RESOLUCION>' + 				
				'</RESOLUCION_POS>'
 			
			-- inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'RESOLUCIONPOSPOS600', 'ELIMINA', @PARAMETROS, 0, ''
			
			FETCH NEXT FROM C_DELETED INTO 
			@RESOLUCION -- VARIABLES
		END

		CLOSE C_DELETED
		DEALLOCATE C_DELETED
	END
	
	IF (@@ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para eliminar de la tabla RESOLUCION_POS.',16,1 )
	END
END;



CREATE TRIGGER $$Compania$$.CIERRE_CAJA_POS_INS
ON $$Compania$$.CIERRE_CAJA
FOR INSERT
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @NUM_CIERRE_CAJA VARCHAR(20)
	DECLARE @CAJA VARCHAR(6)
	DECLARE @FECHA_APERTURA DATETIME
	DECLARE @CAJERO_CIERRE VARCHAR(25)
	DECLARE @FECHA_CIERRE DATETIME
	DECLARE @ESTADO VARCHAR(1)
	DECLARE @FECHA_ANULACION DATETIME
	DECLARE @CAJERO_APERTURA VARCHAR(25)
	DECLARE @DOC_FISCAL VARCHAR(50)
	

	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM 
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_INSERTED CURSOR LOCAL FOR
		SELECT NUM_CIERRE_CAJA, CAJA, FECHA_APERTURA, CAJERO_CIERRE, FECHA_CIERRE, ESTADO, FECHA_ANULACION, CAJERO_APERTURA, DOC_FISCAL
		FROM INSERTED i
		WHERE 0 = (
				SELECT COUNT('n')
				FROM DELETED d
				WHERE i.NUM_CIERRE_CAJA = d.NUM_CIERRE_CAJA AND i.CAJA = d.CAJA
			   )
			
		OPEN C_INSERTED	
		FETCH NEXT FROM C_INSERTED INTO
		@NUM_CIERRE_CAJA, @CAJA, @FECHA_APERTURA, @CAJERO_CIERRE, @FECHA_CIERRE, @ESTADO, @FECHA_ANULACION, @CAJERO_APERTURA, @DOC_FISCAL 

		SET @ERROR = 0
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS = 
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<CIERRE_CAJA>' + 
				'<NUM_CIERRE_CAJA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@NUM_CIERRE_CAJA) + '</NUM_CIERRE_CAJA>' + 
				'<CAJA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CAJA) + '</CAJA>' + 
				'<FECHA_APERTURA Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_APERTURA) + '</FECHA_APERTURA>' + 
				'<CAJERO_CIERRE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CAJERO_CIERRE) + '</CAJERO_CIERRE>' + 
				'<FECHA_CIERRE Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_CIERRE) + '</FECHA_CIERRE>' + 
				'<ESTADO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ESTADO) + '</ESTADO>' + 
				'<FECHA_ANULACION Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_ANULACION) + '</FECHA_ANULACION>' + 
				'<CAJERO_APERTURA  Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CAJERO_APERTURA ) + '</CAJERO_APERTURA>' + 
				'<DOC_FISCAL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DOC_FISCAL) + '</DOC_FISCAL>' + 
				'</CIERRE_CAJA>'


			-- Inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'CIERRECAJAPOS600', 'INSERTA', @PARAMETROS, 0, ''

			FETCH NEXT FROM C_INSERTED INTO
			@NUM_CIERRE_CAJA, @CAJA, @FECHA_APERTURA, @CAJERO_CIERRE, @FECHA_CIERRE, @ESTADO, @FECHA_ANULACION, @CAJERO_APERTURA, @DOC_FISCAL 
		END

		CLOSE C_INSERTED
    		DEALLOCATE C_INSERTED
	END

	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla CIERRE_CAJA.',16,1 )
	END
END;




CREATE TRIGGER $$Compania$$.CIERRE_CAJA_POS_MOD
ON $$Compania$$.CIERRE_CAJA
FOR UPDATE
AS 
BEGIN   	
	DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @COL_ROWPOINTER VARCHAR(36)
	DECLARE @HAY_CAMPOS_PARA_POS BIT
	DECLARE @ACTUALIZAR_SOLICITUD BIT
	DECLARE @NUM_CIERRE_CAJA VARCHAR(20)
	DECLARE @CAJA VARCHAR(6)
	DECLARE @FECHA_APERTURA DATETIME
	DECLARE @CAJERO_CIERRE VARCHAR(25)
	DECLARE @FECHA_CIERRE DATETIME
	DECLARE @ESTADO VARCHAR(1)
	DECLARE @FECHA_ANULACION DATETIME
	DECLARE @CAJERO_APERTURA VARCHAR(25)
	DECLARE @DOC_FISCAL VARCHAR(50)
	 -- Declaraciones

	SET @ERROR = 0

	SELECT @PUBLICADOR = SITIO_LOCAL, @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_MODIFIED CURSOR LOCAL FOR
			SELECT NUM_CIERRE_CAJA, CAJA, FECHA_APERTURA, CAJERO_CIERRE, FECHA_CIERRE, ESTADO, FECHA_ANULACION, CAJERO_APERTURA, DOC_FISCAL -- Columnas
			FROM INSERTED I

		SET @ACTUALIZAR_SOLICITUD = 1

		OPEN C_MODIFIED

		FETCH NEXT FROM C_MODIFIED
		INTO @NUM_CIERRE_CAJA, @CAJA, @FECHA_APERTURA, @CAJERO_CIERRE, @FECHA_CIERRE, @ESTADO, @FECHA_ANULACION, @CAJERO_APERTURA, @DOC_FISCAL

		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			IF ( NOT UPDATE(RECORDDATE) AND ( UPDATE(NUM_CIERRE_CAJA) OR UPDATE(CAJA) OR UPDATE(FECHA_APERTURA) OR UPDATE(CAJERO_CIERRE) OR UPDATE(FECHA_CIERRE) OR UPDATE(ESTADO) OR UPDATE(FECHA_ANULACION) OR UPDATE(CAJERO_APERTURA) OR UPDATE(DOC_FISCAL)) )
			BEGIN

				SELECT @COL_ROWPOINTER = ROWPOINTER 
				FROM $$Compania$$.CIERRE_CAJA
				WHERE NUM_CIERRE_CAJA = @NUM_CIERRE_CAJA AND CAJA = @CAJA 

				SET @PARAMETROS =
					'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<CIERRE_CAJA>' + 
				'<NUM_CIERRE_CAJA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@NUM_CIERRE_CAJA) + '</NUM_CIERRE_CAJA>' + 
				'<CAJA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CAJA) + '</CAJA>' + 
				'<FECHA_APERTURA Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_APERTURA) + '</FECHA_APERTURA>' + 
				'<CAJERO_CIERRE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CAJERO_CIERRE) + '</CAJERO_CIERRE>' + 
				'<FECHA_CIERRE Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_CIERRE) + '</FECHA_CIERRE>' + 
				'<ESTADO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ESTADO) + '</ESTADO>' + 
				'<FECHA_ANULACION Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_ANULACION) + '</FECHA_ANULACION>' + 
				'<CAJERO_APERTURA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CAJERO_APERTURA) + '</CAJERO_APERTURA>' + 
				'<DOC_FISCAL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DOC_FISCAL) + '</DOC_FISCAL>' + 
				'</CIERRE_CAJA>'


				-- inserta la solicitud correspondiente
				EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'CIERRECAJAPOS600', 'MODIFICA', @PARAMETROS, @ACTUALIZAR_SOLICITUD, @COL_ROWPOINTER
			END

			FETCH NEXT FROM C_MODIFIED
			INTO @NUM_CIERRE_CAJA, @CAJA, @FECHA_APERTURA, @CAJERO_CIERRE, @FECHA_CIERRE, @ESTADO, @FECHA_ANULACION, @CAJERO_APERTURA, @DOC_FISCAL
		END

		CLOSE C_MODIFIED
		DEALLOCATE C_MODIFIED
	END

	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para modificar la tabla CIERRE_CAJA.',16,1 )
	END
END;






CREATE TRIGGER $$Compania$$.CIERRE_CAJA_POS_DEL
ON $$Compania$$.CIERRE_CAJA
FOR DELETE  
AS 
BEGIN   	
    DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @NUM_CIERRE_CAJA VARCHAR(20)
	DECLARE @CAJA VARCHAR(6)
	
	 -- Declaraciones	

	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM 
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_DELETED CURSOR LOCAL FOR
			SELECT NUM_CIERRE_CAJA, CAJA
			FROM DELETED d
			WHERE 0 = (
				SELECT COUNT('n')
				FROM INSERTED i
				WHERE d.NUM_CIERRE_CAJA = i.NUM_CIERRE_CAJA AND d.CAJA = i.CAJA
			   )

		OPEN C_DELETED
		FETCH NEXT FROM C_DELETED INTO 
		@NUM_CIERRE_CAJA, @CAJA -- VARIABLES
		
		SET @ERROR = 0
		
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS = 
								'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<CIERRE_CAJA>' + 
				'<NUM_CIERRE_CAJA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@NUM_CIERRE_CAJA) + '</NUM_CIERRE_CAJA>' + 
				'<CAJA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CAJA) + '</CAJA>' +  
				'</CIERRE_CAJA>'
 
			
			-- inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'CIERRECAJAPOS600', 'ELIMINA', @PARAMETROS, 0, ''
			
			FETCH NEXT FROM C_DELETED INTO 
			@NUM_CIERRE_CAJA, @CAJA -- VARIABLES
		END

		CLOSE C_DELETED
		DEALLOCATE C_DELETED
	END
	
	IF (@@ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para eliminar de la tabla CIERRE_CAJA.',16,1 )
	END
END
;




CREATE TRIGGER $$Compania$$.CLASE_DOC_POS_POS_INS
ON $$Compania$$.CLASE_DOC_POS
FOR INSERT
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @CODIGO VARCHAR(10)
	DECLARE @CLASE_DOC VARCHAR(1)
	DECLARE @TIPO VARCHAR(3)
	DECLARE @SUBTIPO INT
	DECLARE @DESCRIPCION VARCHAR(80)
	DECLARE @APLICA_MONTO_MIN_FISCAL VARCHAR(1)
	

	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM 
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_INSERTED CURSOR LOCAL FOR
		SELECT CODIGO, CLASE_DOC, TIPO, SUBTIPO, DESCRIPCION, APLICA_MONTO_MIN_FISCAL
		FROM INSERTED i
		WHERE 0 = (
				SELECT COUNT('n')
				FROM DELETED d
				WHERE i.CODIGO = d.CODIGO
			   )
			
		OPEN C_INSERTED	
		FETCH NEXT FROM C_INSERTED INTO
		@CODIGO, @CLASE_DOC, @TIPO, @SUBTIPO, @DESCRIPCION, @APLICA_MONTO_MIN_FISCAL

		SET @ERROR = 0
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS = 
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<CLASE_DOC_POS>' + 
				'<CODIGO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CODIGO) + '</CODIGO>' + 
				'<CLASE_DOC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CLASE_DOC) + '</CLASE_DOC>' + 
				'<TIPO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO) + '</TIPO>' + 
				'<SUBTIPO Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@SUBTIPO) + '</SUBTIPO>' + 
				'<DESCRIPCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DESCRIPCION) + '</DESCRIPCION>' + 
				'<APLICA_MONTO_MIN_FISCAL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@APLICA_MONTO_MIN_FISCAL) + '</APLICA_MONTO_MIN_FISCAL>' + 
				'</CLASE_DOC_POS>'


			-- Inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'CLASEDOCPOSPOS600', 'INSERTA', @PARAMETROS, 0, ''

			FETCH NEXT FROM C_INSERTED INTO
			@CODIGO, @CLASE_DOC, @TIPO, @SUBTIPO, @DESCRIPCION, @APLICA_MONTO_MIN_FISCAL
		END

		CLOSE C_INSERTED
    		DEALLOCATE C_INSERTED
	END

	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla CLASE_DOC_POS.',16,1 )
	END
END
;




CREATE TRIGGER $$Compania$$.CLASE_DOC_POS_POS_MOD
ON $$Compania$$.CLASE_DOC_POS
FOR UPDATE
AS 
BEGIN   	
	DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @COL_ROWPOINTER VARCHAR(36)
	DECLARE @HAY_CAMPOS_PARA_POS BIT
	DECLARE @ACTUALIZAR_SOLICITUD BIT
	DECLARE @CODIGO VARCHAR(10)
	DECLARE @CLASE_DOC VARCHAR(1)
	DECLARE @TIPO VARCHAR(3)
	DECLARE @SUBTIPO INT
	DECLARE @DESCRIPCION VARCHAR(80)
	DECLARE @APLICA_MONTO_MIN_FISCAL VARCHAR(1)
	 -- Declaraciones

	SET @ERROR = 0

	SELECT @PUBLICADOR = SITIO_LOCAL, @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_MODIFIED CURSOR LOCAL FOR
			SELECT CODIGO, CLASE_DOC, TIPO, SUBTIPO, DESCRIPCION, APLICA_MONTO_MIN_FISCAL -- Columnas
			FROM INSERTED I

		SET @ACTUALIZAR_SOLICITUD = 1

		OPEN C_MODIFIED

		FETCH NEXT FROM C_MODIFIED
		INTO @CODIGO, @CLASE_DOC, @TIPO, @SUBTIPO, @DESCRIPCION, @APLICA_MONTO_MIN_FISCAL

		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			IF ( NOT UPDATE(RECORDDATE) AND ( UPDATE(CODIGO) OR UPDATE(CLASE_DOC) OR UPDATE(TIPO) OR UPDATE(SUBTIPO) OR UPDATE(DESCRIPCION) OR UPDATE(APLICA_MONTO_MIN_FISCAL) ) )
			BEGIN

				SELECT @COL_ROWPOINTER = ROWPOINTER 
				FROM $$Compania$$.CLASE_DOC_POS
				WHERE CODIGO = @CODIGO 

				SET @PARAMETROS =
					'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<CLASE_DOC_POS>' + 
				'<CODIGO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CODIGO) + '</CODIGO>' + 
				'<CLASE_DOC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CLASE_DOC) + '</CLASE_DOC>' + 
				'<TIPO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO) + '</TIPO>' + 
				'<SUBTIPO Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@SUBTIPO) + '</SUBTIPO>' + 
				'<DESCRIPCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DESCRIPCION) + '</DESCRIPCION>' + 
				'<APLICA_MONTO_MIN_FISCAL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@APLICA_MONTO_MIN_FISCAL) + '</APLICA_MONTO_MIN_FISCAL>' + 
				'</CLASE_DOC_POS>'


				-- inserta la solicitud correspondiente
				EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'CLASEDOCPOSPOS600', 'MODIFICA', @PARAMETROS, @ACTUALIZAR_SOLICITUD, @COL_ROWPOINTER
			END

			FETCH NEXT FROM C_MODIFIED
			INTO @CODIGO, @CLASE_DOC, @TIPO, @SUBTIPO, @DESCRIPCION, @APLICA_MONTO_MIN_FISCAL
		END

		CLOSE C_MODIFIED
		DEALLOCATE C_MODIFIED
	END

	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para modificar la tabla CLASE_DOC_POS.',16,1 )
	END
END;





CREATE TRIGGER $$Compania$$.CLASE_DOC_POS_POS_DEL
ON $$Compania$$.CLASE_DOC_POS
FOR DELETE  
AS 
BEGIN   	
                DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @CODIGO VARCHAR(10)
	 -- Declaraciones	

	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM 
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_DELETED CURSOR LOCAL FOR
			SELECT CODIGO
			FROM DELETED d
			WHERE 0 = (
				SELECT COUNT('n')
				FROM INSERTED i
				WHERE d.CODIGO = i.CODIGO
			   )

		OPEN C_DELETED
		FETCH NEXT FROM C_DELETED INTO 
		@CODIGO -- VARIABLES
		
		SET @ERROR = 0
		
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS = 
								'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<CLASE_DOC_POS>' + 
				'<CODIGO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CODIGO) + '</CODIGO>' + 
				'</CLASE_DOC_POS>'
 
			
			-- inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'CLASEDOCPOSPOS600', 'ELIMINA', @PARAMETROS, 0, ''
			
			FETCH NEXT FROM C_DELETED INTO 
			@CODIGO -- VARIABLES
		END

		CLOSE C_DELETED
		DEALLOCATE C_DELETED
	END
	
	IF (@@ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para eliminar de la tabla CLASE_DOC_POS.',16,1 )
	END
END
;




CREATE TRIGGER $$Compania$$.TIPO_DOC_DEFAULT_POS_INS
ON $$Compania$$.TIPO_DOC_DEFAULT
FOR INSERT
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @CAJA VARCHAR(6)
	DECLARE @CONSEC_DEFAULT VARCHAR(10)
	DECLARE @TIPO_DOCUMENTO VARCHAR(1)
	DECLARE @FORMATO_DEFAULT VARCHAR(1)
	

	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM 
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_INSERTED CURSOR LOCAL FOR
		SELECT CAJA, CONSEC_DEFAULT, TIPO_DOCUMENTO, FORMATO_DEFAULT
		FROM INSERTED i
		WHERE 0 = (
				SELECT COUNT('n')
				FROM DELETED d
				WHERE i.CAJA = d.CAJA AND i.CONSEC_DEFAULT = d.CONSEC_DEFAULT AND i.TIPO_DOCUMENTO = d.TIPO_DOCUMENTO
			   )
			
		OPEN C_INSERTED	
		FETCH NEXT FROM C_INSERTED INTO
		@CAJA, @CONSEC_DEFAULT, @TIPO_DOCUMENTO, @FORMATO_DEFAULT

		SET @ERROR = 0
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS = 
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<TIPO_DOC_DEFAULT>' + 
				'<CAJA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CAJA) + '</CAJA>' + 
				'<CONSEC_DEFAULT Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CONSEC_DEFAULT) + '</CONSEC_DEFAULT>' + 
				'<TIPO_DOCUMENTO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_DOCUMENTO) + '</TIPO_DOCUMENTO>' + 
				'<FORMATO_DEFAULT Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@FORMATO_DEFAULT) + '</FORMATO_DEFAULT>' + 
				'</TIPO_DOC_DEFAULT>'


			-- Inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'TIPODOCDEFAULTPOS600', 'INSERTA', @PARAMETROS, 0, ''

			FETCH NEXT FROM C_INSERTED INTO
			@CAJA, @CONSEC_DEFAULT, @TIPO_DOCUMENTO, @FORMATO_DEFAULT
		END

		CLOSE C_INSERTED
    		DEALLOCATE C_INSERTED
	END

	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla TIPO_DOC_DEFAULT.',16,1 )
	END
END
;



CREATE TRIGGER $$Compania$$.TIPO_DOC_DEFAULT_POS_MOD
ON $$Compania$$.TIPO_DOC_DEFAULT
FOR UPDATE
AS 
BEGIN   	
	DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @COL_ROWPOINTER VARCHAR(36)
	DECLARE @HAY_CAMPOS_PARA_POS BIT
	DECLARE @ACTUALIZAR_SOLICITUD BIT
	DECLARE @CAJA VARCHAR(6)
	DECLARE @CONSEC_DEFAULT VARCHAR(10)
	DECLARE @TIPO_DOCUMENTO VARCHAR(1)
	DECLARE @FORMATO_DEFAULT VARCHAR(1)
	 -- Declaraciones

	SET @ERROR = 0

	SELECT @PUBLICADOR = SITIO_LOCAL, @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_MODIFIED CURSOR LOCAL FOR
			SELECT CAJA, CONSEC_DEFAULT, TIPO_DOCUMENTO, FORMATO_DEFAULT -- Columnas
			FROM INSERTED I

		SET @ACTUALIZAR_SOLICITUD = 1

		OPEN C_MODIFIED

		FETCH NEXT FROM C_MODIFIED
		INTO @CAJA, @CONSEC_DEFAULT, @TIPO_DOCUMENTO, @FORMATO_DEFAULT

		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			IF ( NOT UPDATE(RECORDDATE) AND ( UPDATE(CAJA) OR UPDATE(CONSEC_DEFAULT) OR UPDATE(TIPO_DOCUMENTO) OR UPDATE(FORMATO_DEFAULT) ) )
			BEGIN

				SELECT @COL_ROWPOINTER = ROWPOINTER 
				FROM $$Compania$$.TIPO_DOC_DEFAULT
				WHERE CAJA = @CAJA AND CONSEC_DEFAULT = @CONSEC_DEFAULT AND TIPO_DOCUMENTO = @TIPO_DOCUMENTO 

				SET @PARAMETROS =
					'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<TIPO_DOC_DEFAULT>' + 
				'<CAJA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CAJA) + '</CAJA>' + 
				'<CONSEC_DEFAULT Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CONSEC_DEFAULT) + '</CONSEC_DEFAULT>' + 
				'<TIPO_DOCUMENTO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_DOCUMENTO) + '</TIPO_DOCUMENTO>' + 
				'<FORMATO_DEFAULT Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@FORMATO_DEFAULT) + '</FORMATO_DEFAULT>' + 
				'</TIPO_DOC_DEFAULT>'


				-- inserta la solicitud correspondiente
				EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'TIPODOCDEFAULTPOS600', 'MODIFICA', @PARAMETROS, @ACTUALIZAR_SOLICITUD, @COL_ROWPOINTER
			END

			FETCH NEXT FROM C_MODIFIED
			INTO @CAJA, @CONSEC_DEFAULT, @TIPO_DOCUMENTO, @FORMATO_DEFAULT
		END

		CLOSE C_MODIFIED
		DEALLOCATE C_MODIFIED
	END

	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para modificar la tabla TIPO_DOC_DEFAULT.',16,1 )
	END
END
;




CREATE TRIGGER $$Compania$$.TIPO_DOC_DEFAULT_POS_DEL
ON $$Compania$$.TIPO_DOC_DEFAULT
FOR DELETE  
AS 
BEGIN   	
                DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @CAJA VARCHAR(6)
	DECLARE @CONSEC_DEFAULT VARCHAR(10)
	DECLARE @TIPO_DOCUMENTO VARCHAR(1)
	 -- Declaraciones	

	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM 
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_DELETED CURSOR LOCAL FOR
			SELECT CAJA, CONSEC_DEFAULT, TIPO_DOCUMENTO
			FROM DELETED d
			WHERE 0 = (
				SELECT COUNT('n')
				FROM INSERTED i
				WHERE d.CAJA = i.CAJA AND d.CONSEC_DEFAULT = i.CONSEC_DEFAULT AND d.TIPO_DOCUMENTO = i.TIPO_DOCUMENTO
			   )

		OPEN C_DELETED
		FETCH NEXT FROM C_DELETED INTO 
		@CAJA, @CONSEC_DEFAULT, @TIPO_DOCUMENTO -- VARIABLES
		
		SET @ERROR = 0
		
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS = 
								'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<TIPO_DOC_DEFAULT>' + 
				'<CAJA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CAJA) + '</CAJA>' + 
				'<CONSEC_DEFAULT Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CONSEC_DEFAULT) + '</CONSEC_DEFAULT>' + 
				'<TIPO_DOCUMENTO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_DOCUMENTO) + '</TIPO_DOCUMENTO>' + 
				'</TIPO_DOC_DEFAULT>'
 
			
			-- inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'TIPODOCDEFAULTPOS600', 'ELIMINA', @PARAMETROS, 0, ''
			
			FETCH NEXT FROM C_DELETED INTO 
			@CAJA, @CONSEC_DEFAULT, @TIPO_DOCUMENTO -- VARIABLES
		END

		CLOSE C_DELETED
		DEALLOCATE C_DELETED
	END
	
	IF (@@ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para eliminar de la tabla TIPO_DOC_DEFAULT.',16,1 )
	END
END
;




CREATE TRIGGER $$Compania$$.TIPO_ASIENTO_POS_MOD
ON $$Compania$$.TIPO_ASIENTO
FOR UPDATE
AS
BEGIN   	
	DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @COL_ROWPOINTER VARCHAR(36)
	DECLARE @HAY_CAMPOS_PARA_POS BIT
	DECLARE @ACTUALIZAR_SOLICITUD BIT
	DECLARE @TIPO_ASIENTO VARCHAR(4)
	DECLARE @DESCRIPCION VARCHAR(40)
	
	 -- Declaraciones
	SET @ERROR = 0
	SELECT @PUBLICADOR = SITIO_LOCAL, @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_MODIFIED CURSOR LOCAL FOR
			SELECT TIPO_ASIENTO, DESCRIPCION -- Columnas
			FROM INSERTED I
		SET @ACTUALIZAR_SOLICITUD = 1
		OPEN C_MODIFIED
		FETCH NEXT FROM C_MODIFIED
		INTO @TIPO_ASIENTO, @DESCRIPCION
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			IF (NOT UPDATE(RECORDDATE)  AND
      			(UPDATE(TIPO_ASIENTO)
				OR UPDATE(DESCRIPCION)))
      			BEGIN
				SELECT @COL_ROWPOINTER = ROWPOINTER
				FROM $$Compania$$.TIPO_ASIENTO WITH (NOLOCK)
				WHERE TIPO_ASIENTO = @TIPO_ASIENTO
				SET @PARAMETROS =
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<TIPO_ASIENTO>' +
				'<TIPO_ASIENTO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_ASIENTO) + '</TIPO_ASIENTO>' +
				'<DESCRIPCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DESCRIPCION) + '</DESCRIPCION>' +
				'</TIPO_ASIENTO>'
				-- inserta la solicitud correspondiente
				EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'TIPOASIENTOPOS600', 'MODIFICA', @PARAMETROS, @ACTUALIZAR_SOLICITUD, @COL_ROWPOINTER
			END
			FETCH NEXT FROM C_MODIFIED
			INTO @TIPO_ASIENTO, @DESCRIPCION
		END
		CLOSE C_MODIFIED
		DEALLOCATE C_MODIFIED
	END
	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para modificar la tabla TIPO_ASIENTO.',16,1 )
	END
END
;




CREATE TRIGGER $$Compania$$.TIPO_ASIENTO_POS_INS
ON $$Compania$$.TIPO_ASIENTO
FOR INSERT
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @TIPO_ASIENTO VARCHAR(4)
	DECLARE @DESCRIPCION VARCHAR(40)	

	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM 
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_INSERTED CURSOR LOCAL FOR
		SELECT TIPO_ASIENTO, DESCRIPCION
		FROM INSERTED i
		WHERE 0 = (
				SELECT COUNT('n')
				FROM DELETED d
				WHERE i.TIPO_ASIENTO = d.TIPO_ASIENTO
			   )
			
		OPEN C_INSERTED	
		FETCH NEXT FROM C_INSERTED INTO
		@TIPO_ASIENTO, @DESCRIPCION

		SET @ERROR = 0
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS = 
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<TIPO_ASIENTO>' + 
				'<TIPO_ASIENTO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_ASIENTO) + '</TIPO_ASIENTO>' + 
				'<DESCRIPCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DESCRIPCION) + '</DESCRIPCION>' + 
				'</TIPO_ASIENTO>'


			-- Inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'TIPOASIENTOPOS600', 'INSERTA', @PARAMETROS, 0, ''

			FETCH NEXT FROM C_INSERTED INTO
			@TIPO_ASIENTO, @DESCRIPCION
		END

		CLOSE C_INSERTED
    		DEALLOCATE C_INSERTED
	END

	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla TIPO_ASIENTO.',16,1 )
	END
END
;




CREATE TRIGGER $$Compania$$.TIPO_ASIENTO_POS_DEL
ON $$Compania$$.TIPO_ASIENTO
FOR DELETE  
AS 
BEGIN   	
    DECLARE @ERROR  int
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @TIPO_ASIENTO VARCHAR(4)

	 -- Declaraciones	

	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM 
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_DELETED CURSOR LOCAL FOR
			SELECT TIPO_ASIENTO
			FROM DELETED d
			WHERE 0 = (
				SELECT COUNT('n')
				FROM INSERTED i
				WHERE d.TIPO_ASIENTO = i.TIPO_ASIENTO
			   )

		OPEN C_DELETED
		FETCH NEXT FROM C_DELETED INTO 
		@TIPO_ASIENTO -- VARIABLES
		
		SET @ERROR = 0
		
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS = 
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<TIPO_ASIENTO>' + 
				'<TIPO_ASIENTO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_ASIENTO) + '</TIPO_ASIENTO>' + 
				'</TIPO_ASIENTO>'
 
			
			-- inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'TIPOASIENTOPOS600', 'ELIMINA', @PARAMETROS, 0, ''
			
			FETCH NEXT FROM C_DELETED INTO 
			@TIPO_ASIENTO -- VARIABLES
		END

		CLOSE C_DELETED
		DEALLOCATE C_DELETED
	END
	
	IF (@@ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para eliminar de la tabla TIPO_ASIENTO.',16,1 )
	END
END
;



CREATE TRIGGER $$Compania$$.DIRECCION_POS_INS
ON $$Compania$$.DIRECCION
FOR INSERT
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @DIRECCION VARCHAR(10)
	DECLARE @DESCRIPCION VARCHAR(40)
	DECLARE @NOMBRE_CAMPO_1 VARCHAR(60)
	DECLARE @NOMBRE_CAMPO_2 VARCHAR(60)
	DECLARE @NOMBRE_CAMPO_3 VARCHAR(60)
	DECLARE @NOMBRE_CAMPO_4 VARCHAR(60)
	DECLARE @NOMBRE_CAMPO_5 VARCHAR(60)
	DECLARE @NOMBRE_CAMPO_6 VARCHAR(60)
	DECLARE @NOMBRE_CAMPO_7 VARCHAR(60)
	DECLARE @NOMBRE_CAMPO_8 VARCHAR(60)
	DECLARE @NOMBRE_CAMPO_9 VARCHAR(60)
	DECLARE @NOMBRE_CAMPO_10 VARCHAR(60)
	DECLARE @USUARIO_CREACION VARCHAR(25)
	DECLARE @FECHA_CREACION DATETIME
	DECLARE @USUARIO_ULT_MODIF VARCHAR(25)
	DECLARE @FECHA_ULT_MODIF DATETIME
	

	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM 
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_INSERTED CURSOR LOCAL FOR
		SELECT DIRECCION, DESCRIPCION, NOMBRE_CAMPO_1, NOMBRE_CAMPO_2, NOMBRE_CAMPO_3, NOMBRE_CAMPO_4, NOMBRE_CAMPO_5, NOMBRE_CAMPO_6, NOMBRE_CAMPO_7, NOMBRE_CAMPO_8, NOMBRE_CAMPO_9, NOMBRE_CAMPO_10, USUARIO_CREACION, FECHA_CREACION, USUARIO_ULT_MODIF, FECHA_ULT_MODIF
		FROM INSERTED i
		WHERE 0 = (
				SELECT COUNT('n')
				FROM DELETED d
				WHERE i.DIRECCION = d.DIRECCION
			   )
			
		OPEN C_INSERTED	
		FETCH NEXT FROM C_INSERTED INTO
		@DIRECCION, @DESCRIPCION, @NOMBRE_CAMPO_1, @NOMBRE_CAMPO_2, @NOMBRE_CAMPO_3, @NOMBRE_CAMPO_4, @NOMBRE_CAMPO_5, @NOMBRE_CAMPO_6, @NOMBRE_CAMPO_7, @NOMBRE_CAMPO_8, @NOMBRE_CAMPO_9, @NOMBRE_CAMPO_10, @USUARIO_CREACION, @FECHA_CREACION, @USUARIO_ULT_MODIF, @FECHA_ULT_MODIF

		SET @ERROR = 0
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS = 
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<DIRECCION>' + 
				'<DIRECCION Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@DIRECCION) + '</DIRECCION>' + 
				'<DESCRIPCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DESCRIPCION) + '</DESCRIPCION>' + 
				'<NOMBRE_CAMPO_1 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOMBRE_CAMPO_1) + '</NOMBRE_CAMPO_1>' + 
				'<NOMBRE_CAMPO_2 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOMBRE_CAMPO_2) + '</NOMBRE_CAMPO_2>' + 
				'<NOMBRE_CAMPO_3 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOMBRE_CAMPO_3) + '</NOMBRE_CAMPO_3>' + 
				'<NOMBRE_CAMPO_4 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOMBRE_CAMPO_4) + '</NOMBRE_CAMPO_4>' + 
				'<NOMBRE_CAMPO_5 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOMBRE_CAMPO_5) + '</NOMBRE_CAMPO_5>' + 
				'<NOMBRE_CAMPO_6 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOMBRE_CAMPO_6) + '</NOMBRE_CAMPO_6>' + 
				'<NOMBRE_CAMPO_7 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOMBRE_CAMPO_7) + '</NOMBRE_CAMPO_7>' + 
				'<NOMBRE_CAMPO_8 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOMBRE_CAMPO_8) + '</NOMBRE_CAMPO_8>' + 
				'<NOMBRE_CAMPO_9 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOMBRE_CAMPO_9) + '</NOMBRE_CAMPO_9>' + 
				'<NOMBRE_CAMPO_10 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOMBRE_CAMPO_10) + '</NOMBRE_CAMPO_10>' + 
				'<USUARIO_CREACION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USUARIO_CREACION) + '</USUARIO_CREACION>' + 
				'<FECHA_CREACION Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_CREACION) + '</FECHA_CREACION>' + 
				'<USUARIO_ULT_MODIF Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USUARIO_ULT_MODIF) + '</USUARIO_ULT_MODIF>' + 
				'<FECHA_ULT_MODIF Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_ULT_MODIF) + '</FECHA_ULT_MODIF>' + 
				'</DIRECCION>'


			-- Inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'DIRECCIONPOS600', 'INSERTA', @PARAMETROS, 0, ''

			FETCH NEXT FROM C_INSERTED INTO
			@DIRECCION, @DESCRIPCION, @NOMBRE_CAMPO_1, @NOMBRE_CAMPO_2, @NOMBRE_CAMPO_3, @NOMBRE_CAMPO_4, @NOMBRE_CAMPO_5, @NOMBRE_CAMPO_6, @NOMBRE_CAMPO_7, @NOMBRE_CAMPO_8, @NOMBRE_CAMPO_9, @NOMBRE_CAMPO_10, @USUARIO_CREACION, @FECHA_CREACION, @USUARIO_ULT_MODIF, @FECHA_ULT_MODIF
		END

		CLOSE C_INSERTED
    		DEALLOCATE C_INSERTED
	END

	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla DIRECCION.',16,1 )
	END
END
;




CREATE TRIGGER $$Compania$$.DIRECCION_POS_MOD
ON $$Compania$$.DIRECCION
FOR UPDATE
AS 
BEGIN   	
	DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @COL_ROWPOINTER VARCHAR(36)
	DECLARE @HAY_CAMPOS_PARA_POS BIT
	DECLARE @ACTUALIZAR_SOLICITUD BIT
	DECLARE @DIRECCION VARCHAR(10)
	DECLARE @DESCRIPCION VARCHAR(40)
	DECLARE @NOMBRE_CAMPO_1 VARCHAR(60)
	DECLARE @NOMBRE_CAMPO_2 VARCHAR(60)
	DECLARE @NOMBRE_CAMPO_3 VARCHAR(60)
	DECLARE @NOMBRE_CAMPO_4 VARCHAR(60)
	DECLARE @NOMBRE_CAMPO_5 VARCHAR(60)
	DECLARE @NOMBRE_CAMPO_6 VARCHAR(60)
	DECLARE @NOMBRE_CAMPO_7 VARCHAR(60)
	DECLARE @NOMBRE_CAMPO_8 VARCHAR(60)
	DECLARE @NOMBRE_CAMPO_9 VARCHAR(60)
	DECLARE @NOMBRE_CAMPO_10 VARCHAR(60)
	DECLARE @USUARIO_CREACION VARCHAR(25)
	DECLARE @FECHA_CREACION DATETIME
	DECLARE @USUARIO_ULT_MODIF VARCHAR(25)
	DECLARE @FECHA_ULT_MODIF DATETIME
	 -- Declaraciones

	SET @ERROR = 0

	SELECT @PUBLICADOR = SITIO_LOCAL, @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_MODIFIED CURSOR LOCAL FOR
			SELECT DIRECCION, DESCRIPCION, NOMBRE_CAMPO_1, NOMBRE_CAMPO_2, NOMBRE_CAMPO_3, NOMBRE_CAMPO_4, NOMBRE_CAMPO_5, NOMBRE_CAMPO_6, NOMBRE_CAMPO_7, NOMBRE_CAMPO_8, NOMBRE_CAMPO_9, NOMBRE_CAMPO_10, USUARIO_CREACION, FECHA_CREACION, USUARIO_ULT_MODIF, FECHA_ULT_MODIF -- Columnas
			FROM INSERTED I

		SET @ACTUALIZAR_SOLICITUD = 1

		OPEN C_MODIFIED

		FETCH NEXT FROM C_MODIFIED
		INTO @DIRECCION, @DESCRIPCION, @NOMBRE_CAMPO_1, @NOMBRE_CAMPO_2, @NOMBRE_CAMPO_3, @NOMBRE_CAMPO_4, @NOMBRE_CAMPO_5, @NOMBRE_CAMPO_6, @NOMBRE_CAMPO_7, @NOMBRE_CAMPO_8, @NOMBRE_CAMPO_9, @NOMBRE_CAMPO_10, @USUARIO_CREACION, @FECHA_CREACION, @USUARIO_ULT_MODIF, @FECHA_ULT_MODIF

		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			IF ( NOT UPDATE(RECORDDATE) AND ( UPDATE(DIRECCION) OR UPDATE(DESCRIPCION) OR UPDATE(NOMBRE_CAMPO_1) OR UPDATE(NOMBRE_CAMPO_2) OR UPDATE(NOMBRE_CAMPO_3) OR UPDATE(NOMBRE_CAMPO_4) OR UPDATE(NOMBRE_CAMPO_5) OR UPDATE(NOMBRE_CAMPO_6) OR UPDATE(NOMBRE_CAMPO_7) OR UPDATE(NOMBRE_CAMPO_8) OR UPDATE(NOMBRE_CAMPO_9) OR UPDATE(NOMBRE_CAMPO_10) OR UPDATE(USUARIO_CREACION) OR UPDATE(FECHA_CREACION) OR UPDATE(USUARIO_ULT_MODIF) OR UPDATE(FECHA_ULT_MODIF) ) )
			BEGIN

				SELECT @COL_ROWPOINTER = ROWPOINTER 
				FROM $$Compania$$.DIRECCION
				WHERE DIRECCION = @DIRECCION 

				SET @PARAMETROS =
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<DIRECCION>' + 
				'<DIRECCION Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@DIRECCION) + '</DIRECCION>' + 
				'<DESCRIPCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DESCRIPCION) + '</DESCRIPCION>' + 
				'<NOMBRE_CAMPO_1 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOMBRE_CAMPO_1) + '</NOMBRE_CAMPO_1>' + 
				'<NOMBRE_CAMPO_2 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOMBRE_CAMPO_2) + '</NOMBRE_CAMPO_2>' + 
				'<NOMBRE_CAMPO_3 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOMBRE_CAMPO_3) + '</NOMBRE_CAMPO_3>' + 
				'<NOMBRE_CAMPO_4 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOMBRE_CAMPO_4) + '</NOMBRE_CAMPO_4>' + 
				'<NOMBRE_CAMPO_5 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOMBRE_CAMPO_5) + '</NOMBRE_CAMPO_5>' + 
				'<NOMBRE_CAMPO_6 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOMBRE_CAMPO_6) + '</NOMBRE_CAMPO_6>' + 
				'<NOMBRE_CAMPO_7 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOMBRE_CAMPO_7) + '</NOMBRE_CAMPO_7>' + 
				'<NOMBRE_CAMPO_8 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOMBRE_CAMPO_8) + '</NOMBRE_CAMPO_8>' + 
				'<NOMBRE_CAMPO_9 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOMBRE_CAMPO_9) + '</NOMBRE_CAMPO_9>' + 
				'<NOMBRE_CAMPO_10 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOMBRE_CAMPO_10) + '</NOMBRE_CAMPO_10>' + 
				'<USUARIO_CREACION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USUARIO_CREACION) + '</USUARIO_CREACION>' + 
				'<FECHA_CREACION Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_CREACION) + '</FECHA_CREACION>' + 
				'<USUARIO_ULT_MODIF Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USUARIO_ULT_MODIF) + '</USUARIO_ULT_MODIF>' + 
				'<FECHA_ULT_MODIF Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_ULT_MODIF) + '</FECHA_ULT_MODIF>' + 
				'</DIRECCION>'

				-- inserta la solicitud correspondiente
				EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'DIRECCIONPOS600', 'MODIFICA', @PARAMETROS, @ACTUALIZAR_SOLICITUD, @COL_ROWPOINTER
			END

			FETCH NEXT FROM C_MODIFIED
			INTO @DIRECCION, @DESCRIPCION, @NOMBRE_CAMPO_1, @NOMBRE_CAMPO_2, @NOMBRE_CAMPO_3, @NOMBRE_CAMPO_4, @NOMBRE_CAMPO_5, @NOMBRE_CAMPO_6, @NOMBRE_CAMPO_7, @NOMBRE_CAMPO_8, @NOMBRE_CAMPO_9, @NOMBRE_CAMPO_10, @USUARIO_CREACION, @FECHA_CREACION, @USUARIO_ULT_MODIF, @FECHA_ULT_MODIF
		END

		CLOSE C_MODIFIED
		DEALLOCATE C_MODIFIED
	END

	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para modificar la tabla DIRECCION.',16,1 )
	END
END
;





CREATE TRIGGER $$Compania$$.DIRECCION_POS_DEL
ON $$Compania$$.DIRECCION
FOR DELETE  
AS 
BEGIN   	
                DECLARE @ERROR  int
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @DIRECCION VARCHAR(10)
	 -- Declaraciones	

	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM 
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_DELETED CURSOR LOCAL FOR
			SELECT DIRECCION
			FROM DELETED d
			WHERE 0 = (
				SELECT COUNT('n')
				FROM INSERTED i
				WHERE d.DIRECCION = i.DIRECCION
			   )

		OPEN C_DELETED
		FETCH NEXT FROM C_DELETED INTO 
		@DIRECCION
		
		SET @ERROR = 0
		
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS = 
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<DIRECCION>' + 
				'<DIRECCION Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@DIRECCION) + '</DIRECCION>' + 
				'</DIRECCION>'
			
			-- inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'DIRECCIONPOS600', 'ELIMINA', @PARAMETROS, 0, ''
			
			FETCH NEXT FROM C_DELETED INTO 
			@DIRECCION
		END

		CLOSE C_DELETED
		DEALLOCATE C_DELETED
	END
	
	IF (@@ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para eliminar de la tabla DIRECCION.',16,1 )
	END
END
;



CREATE TRIGGER $$Compania$$.COSTO_UEPS_PEPS_POS_INS
ON $$Compania$$.COSTO_UEPS_PEPS
FOR INSERT
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @ARTICULO VARCHAR(20)
	DECLARE @SECUENCIA DATETIME
	DECLARE @CANTIDAD_ORIGINAL DECIMAL(28,8)
	DECLARE @CANTIDAD_RESTANTE DECIMAL(28,8)
	DECLARE @COSTO_LOCAL DECIMAL(28,8)
	DECLARE @COSTO_DOLAR DECIMAL(28,8)
	

	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM 
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_INSERTED CURSOR LOCAL FOR
		SELECT ARTICULO, SECUENCIA, CANTIDAD_ORIGINAL, CANTIDAD_RESTANTE, COSTO_LOCAL, COSTO_DOLAR
		FROM INSERTED i
		WHERE 0 = (
				SELECT COUNT('n')
				FROM DELETED d
				WHERE i.ARTICULO = d.ARTICULO AND i.SECUENCIA = d.SECUENCIA
			   )
			
		OPEN C_INSERTED	
		FETCH NEXT FROM C_INSERTED INTO
		@ARTICULO, @SECUENCIA, @CANTIDAD_ORIGINAL, @CANTIDAD_RESTANTE, @COSTO_LOCAL, @COSTO_DOLAR

		SET @ERROR = 0
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS = 
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<COSTO_UEPS_PEPS>' + 
				'<ARTICULO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@ARTICULO) + '</ARTICULO>' + 
				'<SECUENCIA Type="DATETIME" PrimaryKey="True">' + ERPADMIN.POS_FormatoFecha(@SECUENCIA) + '</SECUENCIA>' + 
				'<CANTIDAD_ORIGINAL Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@CANTIDAD_ORIGINAL) + '</CANTIDAD_ORIGINAL>' + 
				'<CANTIDAD_RESTANTE Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@CANTIDAD_RESTANTE) + '</CANTIDAD_RESTANTE>' + 
				'<COSTO_LOCAL Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@COSTO_LOCAL) + '</COSTO_LOCAL>' + 
				'<COSTO_DOLAR Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@COSTO_DOLAR) + '</COSTO_DOLAR>' + 
				'</COSTO_UEPS_PEPS>'


			-- Inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'COSTOUEPSPEPSPOS600', 'INSERTA', @PARAMETROS, 0, ''

			FETCH NEXT FROM C_INSERTED INTO
			@ARTICULO, @SECUENCIA, @CANTIDAD_ORIGINAL, @CANTIDAD_RESTANTE, @COSTO_LOCAL, @COSTO_DOLAR
		END

		CLOSE C_INSERTED
    		DEALLOCATE C_INSERTED
	END

	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla COSTO_UEPS_PEPS.',16,1 )
	END
END
;




CREATE TRIGGER $$Compania$$.COSTO_UEPS_PEPS_POS_MOD
ON $$Compania$$.COSTO_UEPS_PEPS
FOR UPDATE
AS 
BEGIN   	
	DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @COL_ROWPOINTER VARCHAR(36)
	DECLARE @HAY_CAMPOS_PARA_POS BIT
	DECLARE @ACTUALIZAR_SOLICITUD BIT
	DECLARE @ARTICULO VARCHAR(20)
	DECLARE @SECUENCIA DATETIME
	DECLARE @CANTIDAD_ORIGINAL DECIMAL(28,8)
	DECLARE @CANTIDAD_RESTANTE DECIMAL(28,8)
	DECLARE @COSTO_LOCAL DECIMAL(28,8)
	DECLARE @COSTO_DOLAR DECIMAL(28,8)
	DECLARE @VENDER_POR_DEBAJO_COSTO VARCHAR(1)
	 -- Declaraciones

	SET @ERROR = 0

	SELECT @PUBLICADOR = SITIO_LOCAL, @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS

	 --Se obtiene el valor que indica si se debe actualizar los costos del artículo
	SELECT @VENDER_POR_DEBAJO_COSTO = VALOR 
	FROM $$Compania$$.GLOBALES
	WHERE MODULO = 'PO'
	AND NOMBRE = 'VENDER_POR_DEBAJO_COSTO'
	
	SET @VENDER_POR_DEBAJO_COSTO = ISNULL(@VENDER_POR_DEBAJO_COSTO, 'S')

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM) AND @VENDER_POR_DEBAJO_COSTO = 'N'
	BEGIN
		DECLARE C_MODIFIED CURSOR LOCAL FOR
			SELECT ARTICULO, SECUENCIA, CANTIDAD_ORIGINAL, CANTIDAD_RESTANTE, COSTO_LOCAL, COSTO_DOLAR -- Columnas
			FROM INSERTED I

		SET @ACTUALIZAR_SOLICITUD = 1

		OPEN C_MODIFIED

		FETCH NEXT FROM C_MODIFIED
		INTO @ARTICULO, @SECUENCIA, @CANTIDAD_ORIGINAL, @CANTIDAD_RESTANTE, @COSTO_LOCAL, @COSTO_DOLAR

		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			IF ( NOT UPDATE(RECORDDATE) AND ( UPDATE(ARTICULO) OR UPDATE(SECUENCIA) OR UPDATE(CANTIDAD_ORIGINAL) OR UPDATE(CANTIDAD_RESTANTE) OR UPDATE(COSTO_LOCAL) OR UPDATE(COSTO_DOLAR) ) )
			BEGIN

				SELECT @COL_ROWPOINTER = ROWPOINTER 
				FROM $$Compania$$.COSTO_UEPS_PEPS
				WHERE ARTICULO = @ARTICULO AND SECUENCIA = @SECUENCIA 

				SET @PARAMETROS =
					'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<COSTO_UEPS_PEPS>' + 
				'<ARTICULO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@ARTICULO) + '</ARTICULO>' + 
				'<SECUENCIA Type="DATETIME" PrimaryKey="True">' + ERPADMIN.POS_FormatoFecha(@SECUENCIA) + '</SECUENCIA>' + 
				'<CANTIDAD_ORIGINAL Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@CANTIDAD_ORIGINAL) + '</CANTIDAD_ORIGINAL>' + 
				'<CANTIDAD_RESTANTE Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@CANTIDAD_RESTANTE) + '</CANTIDAD_RESTANTE>' + 
				'<COSTO_LOCAL Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@COSTO_LOCAL) + '</COSTO_LOCAL>' + 
				'<COSTO_DOLAR Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@COSTO_DOLAR) + '</COSTO_DOLAR>' + 
				'</COSTO_UEPS_PEPS>'


				-- inserta la solicitud correspondiente
				EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'COSTOUEPSPEPSPOS600', 'MODIFICA', @PARAMETROS, @ACTUALIZAR_SOLICITUD, @COL_ROWPOINTER
			END

			FETCH NEXT FROM C_MODIFIED
			INTO @ARTICULO, @SECUENCIA, @CANTIDAD_ORIGINAL, @CANTIDAD_RESTANTE, @COSTO_LOCAL, @COSTO_DOLAR
		END

		CLOSE C_MODIFIED
		DEALLOCATE C_MODIFIED
	END

	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para modificar la tabla COSTO_UEPS_PEPS.',16,1 )
	END
END
;




CREATE TRIGGER $$Compania$$.COSTO_UEPS_PEPS_POS_DEL
ON $$Compania$$.COSTO_UEPS_PEPS
FOR DELETE  
AS 
BEGIN   	
    DECLARE @ERROR  int
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @ARTICULO VARCHAR(20)
	DECLARE @SECUENCIA DATETIME

	 -- Declaraciones	

	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM 
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_DELETED CURSOR LOCAL FOR
			SELECT ARTICULO, SECUENCIA
			FROM DELETED d
			WHERE 0 = (
				SELECT COUNT('n')
				FROM INSERTED i
				WHERE d.ARTICULO = i.ARTICULO AND d.SECUENCIA = i.SECUENCIA
			   )

		OPEN C_DELETED
		FETCH NEXT FROM C_DELETED INTO 
		@ARTICULO, @SECUENCIA -- VARIABLES
		
		SET @ERROR = 0
		
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS = 
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<COSTO_UEPS_PEPS>' + 
				'<ARTICULO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@ARTICULO) + '</ARTICULO>' + 
				'<SECUENCIA Type="DATETIME" PrimaryKey="True">' + ERPADMIN.POS_FormatoFecha(@SECUENCIA) + '</SECUENCIA>' + 
				'</COSTO_UEPS_PEPS>'
 
			
			-- inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'COSTOUEPSPEPSPOS600', 'ELIMINA', @PARAMETROS, 0, ''
			
			FETCH NEXT FROM C_DELETED INTO 
			@ARTICULO, @SECUENCIA -- VARIABLES
		END

		CLOSE C_DELETED
		DEALLOCATE C_DELETED
	END
	
	IF (@@ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para eliminar de la tabla COSTO_UEPS_PEPS.',16,1 )
	END
END
;




CREATE TRIGGER $$Compania$$.NCF_CONSECUTIV_USUARIO_POS_INS
ON $$Compania$$.NCF_CONSECUTIVO_USUARIO
FOR INSERT
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @PREFIJO VARCHAR(20)
	DECLARE @USUARIO VARCHAR(25)
	

	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM 
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_INSERTED CURSOR LOCAL FOR
		SELECT PREFIJO, USUARIO
		FROM INSERTED i
		WHERE 0 = (
				SELECT COUNT('n')
				FROM DELETED d
				WHERE i.Prefijo = d.Prefijo AND i.Usuario = d.Usuario
			   )
			
		OPEN C_INSERTED	
		FETCH NEXT FROM C_INSERTED INTO
		@PREFIJO, @USUARIO

		SET @ERROR = 0
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS = 
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<NCF_CONSECUTIVO_USUARIO>' + 
				'<PREFIJO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@PREFIJO) + '</PREFIJO>' + 
				'<USUARIO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USUARIO) + '</USUARIO>' + 
				'</NCF_CONSECUTIVO_USUARIO>'


			-- Inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'NCFCONSECUTIVOUSUARIOPOS600', 'INSERTA', @PARAMETROS, 0, ''

			FETCH NEXT FROM C_INSERTED INTO
			@PREFIJO, @USUARIO
		END

		CLOSE C_INSERTED
    		DEALLOCATE C_INSERTED
	END

	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla NCF_CONSECUTIVO_USUARIO.',16,1 )
	END
END
;



CREATE TRIGGER $$Compania$$.NCF_CONSECUTIV_USUARIO_POS_MOD
ON $$Compania$$.NCF_CONSECUTIVO_USUARIO
FOR UPDATE
AS 
BEGIN   	
	DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @COL_ROWPOINTER VARCHAR(36)
	DECLARE @HAY_CAMPOS_PARA_POS BIT
	DECLARE @ACTUALIZAR_SOLICITUD BIT
	DECLARE @PREFIJO VARCHAR(20)
	DECLARE @USUARIO VARCHAR(25)
	 -- Declaraciones

	SET @ERROR = 0

	SELECT @PUBLICADOR = SITIO_LOCAL, @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_MODIFIED CURSOR LOCAL FOR
			SELECT PREFIJO, USUARIO -- Columnas
			FROM INSERTED I

		SET @ACTUALIZAR_SOLICITUD = 1

		OPEN C_MODIFIED

		FETCH NEXT FROM C_MODIFIED
		INTO @PREFIJO, @USUARIO

		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			IF ( NOT UPDATE(RECORDDATE) AND ( UPDATE(PREFIJO) OR UPDATE(USUARIO) OR UPDATE(RowPointer) ) )
			BEGIN

				SELECT @COL_ROWPOINTER = ROWPOINTER 
				FROM $$Compania$$.NCF_CONSECUTIVO_USUARIO
				WHERE Prefijo = @PREFIJO AND  Usuario = @USUARIO

				SET @PARAMETROS =
					'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<NCF_CONSECUTIVO_USUARIO>' + 
				'<PREFIJO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@PREFIJO) + '</PREFIJO>' + 
				'<USUARIO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USUARIO) + '</USUARIO>' + 
				'</NCF_CONSECUTIVO_USUARIO>'


				-- inserta la solicitud correspondiente
				EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'NCFCONSECUTIVOUSUARIOPOS600', 'MODIFICA', @PARAMETROS, @ACTUALIZAR_SOLICITUD, @COL_ROWPOINTER
			END

			FETCH NEXT FROM C_MODIFIED
			INTO @PREFIJO, @USUARIO
		END

		CLOSE C_MODIFIED
		DEALLOCATE C_MODIFIED
	END

	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para modificar la tabla NCF_CONSECUTIVO_USUARIO.',16,1 )
	END
END
;





CREATE TRIGGER $$Compania$$.NCF_CONSECUTIV_USUARIO_POS_DEL
ON $$Compania$$.NCF_CONSECUTIVO_USUARIO
FOR DELETE  
AS 
BEGIN   	
        DECLARE @ERROR  int
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @PREFIJO VARCHAR(20)
	DECLARE @USUARIO VARCHAR(25)
	 -- Declaraciones	

	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM 
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_DELETED CURSOR LOCAL FOR
			SELECT PREFIJO, USUARIO
			FROM DELETED d
			WHERE 0 = (
				SELECT COUNT('n')
				FROM INSERTED i
				WHERE d.Prefijo = i.Prefijo AND d.Usuario = i.Usuario
			   )

		OPEN C_DELETED
		FETCH NEXT FROM C_DELETED INTO 
		@PREFIJO, @USUARIO     -- VARIABLES
		
		SET @ERROR = 0
		
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS = 
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<NCF_CONSECUTIVO_USUARIO>' + 
				'<PREFIJO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@PREFIJO) + '</PREFIJO>' + 
				'<USUARIO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USUARIO) + '</USUARIO>' + 
				'</NCF_CONSECUTIVO_USUARIO>'
 
			
			-- inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'NCFCONSECUTIVOUSUARIOPOS600', 'ELIMINA', @PARAMETROS, 0, ''
			
			FETCH NEXT FROM C_DELETED INTO 
			@PREFIJO, @USUARIO -- VARIABLES
		END

		CLOSE C_DELETED
		DEALLOCATE C_DELETED
	END
	
	IF (@@ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para eliminar de la tabla NCF_CONSECUTIVO_USUARIO.',16,1 )
	END
END
;





CREATE TRIGGER $$Compania$$.CUENTA_CONTABLE_POS_INS
ON $$Compania$$.CUENTA_CONTABLE
FOR INSERT
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @CUENTA_CONTABLE VARCHAR(25)
	DECLARE @SECCION_CUENTA VARCHAR(4)
	DECLARE @UNIDAD VARCHAR(15)
	DECLARE @DESCRIPCION VARCHAR(60)
	DECLARE @TIPO VARCHAR(1)
	DECLARE @TIPO_DETALLADO VARCHAR(1)
	DECLARE @TIPO_OAF VARCHAR(1)
	DECLARE @SALDO_NORMAL VARCHAR(1)
	DECLARE @CONVERSION VARCHAR(1)
	DECLARE @TIPO_CAMBIO VARCHAR(4)
	DECLARE @ACEPTA_DATOS VARCHAR(1)
	DECLARE @CONSOLIDA VARCHAR(1)
	DECLARE @USA_CENTRO_COSTO VARCHAR(1)
	DECLARE @USUARIO VARCHAR(25)
	DECLARE @FECHA_HORA DATETIME
	DECLARE @USUARIO_ULT_MOD VARCHAR(25)
	DECLARE @FCH_HORA_ULT_MOD DATETIME
	DECLARE @ACEPTA_UNIDADES VARCHAR(1)
	DECLARE @USO_RESTRINGIDO VARCHAR(1)
	DECLARE @ORIGEN_CONVERSION VARCHAR(1)
	

	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM 
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_INSERTED CURSOR LOCAL FOR
		SELECT CUENTA_CONTABLE, SECCION_CUENTA, UNIDAD, DESCRIPCION, TIPO, TIPO_DETALLADO, TIPO_OAF, SALDO_NORMAL, CONVERSION, TIPO_CAMBIO, ACEPTA_DATOS, CONSOLIDA, USA_CENTRO_COSTO, USUARIO, FECHA_HORA, USUARIO_ULT_MOD, FCH_HORA_ULT_MOD, ACEPTA_UNIDADES, USO_RESTRINGIDO, ORIGEN_CONVERSION
		FROM INSERTED i
		WHERE 0 = (
				SELECT COUNT('n')
				FROM DELETED d
				WHERE i.CUENTA_CONTABLE = d.CUENTA_CONTABLE
			   )
			
		OPEN C_INSERTED	
		FETCH NEXT FROM C_INSERTED INTO
		@CUENTA_CONTABLE, @SECCION_CUENTA, @UNIDAD, @DESCRIPCION, @TIPO, @TIPO_DETALLADO, @TIPO_OAF, @SALDO_NORMAL, @CONVERSION, @TIPO_CAMBIO, @ACEPTA_DATOS, @CONSOLIDA, @USA_CENTRO_COSTO, @USUARIO, @FECHA_HORA, @USUARIO_ULT_MOD, @FCH_HORA_ULT_MOD, @ACEPTA_UNIDADES, @USO_RESTRINGIDO, @ORIGEN_CONVERSION

		SET @ERROR = 0
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS = 
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<CUENTA_CONTABLE>' + 
				'<CUENTA_CONTABLE Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CUENTA_CONTABLE) + '</CUENTA_CONTABLE>' + 
				'<SECCION_CUENTA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@SECCION_CUENTA) + '</SECCION_CUENTA>' + 
				'<UNIDAD Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@UNIDAD) + '</UNIDAD>' + 
				'<DESCRIPCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DESCRIPCION) + '</DESCRIPCION>' + 
				'<TIPO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO) + '</TIPO>' + 
				'<TIPO_DETALLADO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_DETALLADO) + '</TIPO_DETALLADO>' + 
				'<TIPO_OAF Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_OAF) + '</TIPO_OAF>' + 
				'<SALDO_NORMAL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@SALDO_NORMAL) + '</SALDO_NORMAL>' + 
				'<CONVERSION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CONVERSION) + '</CONVERSION>' + 
				'<TIPO_CAMBIO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_CAMBIO) + '</TIPO_CAMBIO>' + 
				'<ACEPTA_DATOS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ACEPTA_DATOS) + '</ACEPTA_DATOS>' + 
				'<CONSOLIDA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CONSOLIDA) + '</CONSOLIDA>' + 
				'<USA_CENTRO_COSTO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USA_CENTRO_COSTO) + '</USA_CENTRO_COSTO>' + 
				'<USUARIO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USUARIO) + '</USUARIO>' + 
				'<FECHA_HORA Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_HORA) + '</FECHA_HORA>' + 
				'<USUARIO_ULT_MOD Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USUARIO_ULT_MOD) + '</USUARIO_ULT_MOD>' + 
				'<FCH_HORA_ULT_MOD Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FCH_HORA_ULT_MOD) + '</FCH_HORA_ULT_MOD>' + 
				'<ACEPTA_UNIDADES Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ACEPTA_UNIDADES) + '</ACEPTA_UNIDADES>' + 
				'<USO_RESTRINGIDO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USO_RESTRINGIDO) + '</USO_RESTRINGIDO>' + 
				'<ORIGEN_CONVERSION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ORIGEN_CONVERSION) + '</ORIGEN_CONVERSION>' + 
				'</CUENTA_CONTABLE>'


			-- Inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'CUENTACONTABLEPOS600', 'INSERTA', @PARAMETROS, 0, ''

			FETCH NEXT FROM C_INSERTED INTO
			@CUENTA_CONTABLE, @SECCION_CUENTA, @UNIDAD, @DESCRIPCION, @TIPO, @TIPO_DETALLADO, @TIPO_OAF, @SALDO_NORMAL, @CONVERSION, @TIPO_CAMBIO, @ACEPTA_DATOS, @CONSOLIDA, @USA_CENTRO_COSTO, @USUARIO, @FECHA_HORA, @USUARIO_ULT_MOD, @FCH_HORA_ULT_MOD, @ACEPTA_UNIDADES, @USO_RESTRINGIDO, @ORIGEN_CONVERSION
		END

		CLOSE C_INSERTED
    		DEALLOCATE C_INSERTED
	END

	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla CUENTA_CONTABLE.',16,1 )
	END
END
;
CREATE TRIGGER $$Compania$$.CUENTA_CONTABLE_POS_MOD
ON $$Compania$$.CUENTA_CONTABLE
FOR UPDATE
AS 
BEGIN   	
	DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @COL_ROWPOINTER VARCHAR(36)
	DECLARE @HAY_CAMPOS_PARA_POS BIT
	DECLARE @ACTUALIZAR_SOLICITUD BIT
	DECLARE @CUENTA_CONTABLE VARCHAR(25)
	DECLARE @SECCION_CUENTA VARCHAR(4)
	DECLARE @UNIDAD VARCHAR(15)
	DECLARE @DESCRIPCION VARCHAR(60)
	DECLARE @TIPO VARCHAR(1)
	DECLARE @TIPO_DETALLADO VARCHAR(1)
	DECLARE @TIPO_OAF VARCHAR(1)
	DECLARE @SALDO_NORMAL VARCHAR(1)
	DECLARE @CONVERSION VARCHAR(1)
	DECLARE @TIPO_CAMBIO VARCHAR(4)
	DECLARE @ACEPTA_DATOS VARCHAR(1)
	DECLARE @CONSOLIDA VARCHAR(1)
	DECLARE @USA_CENTRO_COSTO VARCHAR(1)
	DECLARE @USUARIO VARCHAR(25)
	DECLARE @FECHA_HORA DATETIME
	DECLARE @USUARIO_ULT_MOD VARCHAR(25)
	DECLARE @FCH_HORA_ULT_MOD DATETIME
	DECLARE @ACEPTA_UNIDADES VARCHAR(1)
	DECLARE @USO_RESTRINGIDO VARCHAR(1)
	DECLARE @ORIGEN_CONVERSION VARCHAR(1)
	 -- Declaraciones

	SET @ERROR = 0

	SELECT @PUBLICADOR = SITIO_LOCAL, @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_MODIFIED CURSOR LOCAL FOR
			SELECT CUENTA_CONTABLE, SECCION_CUENTA, UNIDAD, DESCRIPCION, TIPO, TIPO_DETALLADO, TIPO_OAF, SALDO_NORMAL, CONVERSION, TIPO_CAMBIO, ACEPTA_DATOS, CONSOLIDA, USA_CENTRO_COSTO, USUARIO, FECHA_HORA, USUARIO_ULT_MOD, FCH_HORA_ULT_MOD, ACEPTA_UNIDADES, USO_RESTRINGIDO, ORIGEN_CONVERSION -- Columnas
			FROM INSERTED I

		SET @ACTUALIZAR_SOLICITUD = 1

		OPEN C_MODIFIED

		FETCH NEXT FROM C_MODIFIED
		INTO @CUENTA_CONTABLE, @SECCION_CUENTA, @UNIDAD, @DESCRIPCION, @TIPO, @TIPO_DETALLADO, @TIPO_OAF, @SALDO_NORMAL, @CONVERSION, @TIPO_CAMBIO, @ACEPTA_DATOS, @CONSOLIDA, @USA_CENTRO_COSTO, @USUARIO, @FECHA_HORA, @USUARIO_ULT_MOD, @FCH_HORA_ULT_MOD, @ACEPTA_UNIDADES, @USO_RESTRINGIDO, @ORIGEN_CONVERSION

		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			IF ( NOT UPDATE(RECORDDATE) AND ( UPDATE(CUENTA_CONTABLE) OR UPDATE(SECCION_CUENTA) OR UPDATE(UNIDAD) OR UPDATE(DESCRIPCION) OR UPDATE(TIPO) OR UPDATE(TIPO_DETALLADO) OR UPDATE(TIPO_OAF) OR UPDATE(SALDO_NORMAL) OR UPDATE(CONVERSION) OR UPDATE(TIPO_CAMBIO) OR UPDATE(ACEPTA_DATOS) OR UPDATE(CONSOLIDA) OR UPDATE(USA_CENTRO_COSTO) OR UPDATE(USUARIO) OR UPDATE(FECHA_HORA) OR UPDATE(USUARIO_ULT_MOD) OR UPDATE(FCH_HORA_ULT_MOD) OR UPDATE(ACEPTA_UNIDADES) OR UPDATE(USO_RESTRINGIDO) OR UPDATE(ORIGEN_CONVERSION) ) )
			BEGIN

				SELECT @COL_ROWPOINTER = ROWPOINTER 
				FROM $$Compania$$.CUENTA_CONTABLE
				WHERE CUENTA_CONTABLE = @CUENTA_CONTABLE 

				SET @PARAMETROS =
					'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<CUENTA_CONTABLE>' + 
				'<CUENTA_CONTABLE Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CUENTA_CONTABLE) + '</CUENTA_CONTABLE>' + 
				'<SECCION_CUENTA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@SECCION_CUENTA) + '</SECCION_CUENTA>' + 
				'<UNIDAD Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@UNIDAD) + '</UNIDAD>' + 
				'<DESCRIPCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DESCRIPCION) + '</DESCRIPCION>' + 
				'<TIPO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO) + '</TIPO>' + 
				'<TIPO_DETALLADO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_DETALLADO) + '</TIPO_DETALLADO>' + 
				'<TIPO_OAF Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_OAF) + '</TIPO_OAF>' + 
				'<SALDO_NORMAL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@SALDO_NORMAL) + '</SALDO_NORMAL>' + 
				'<CONVERSION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CONVERSION) + '</CONVERSION>' + 
				'<TIPO_CAMBIO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_CAMBIO) + '</TIPO_CAMBIO>' + 
				'<ACEPTA_DATOS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ACEPTA_DATOS) + '</ACEPTA_DATOS>' + 
				'<CONSOLIDA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CONSOLIDA) + '</CONSOLIDA>' + 
				'<USA_CENTRO_COSTO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USA_CENTRO_COSTO) + '</USA_CENTRO_COSTO>' + 
				'<USUARIO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USUARIO) + '</USUARIO>' + 
				'<FECHA_HORA Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_HORA) + '</FECHA_HORA>' + 
				'<USUARIO_ULT_MOD Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USUARIO_ULT_MOD) + '</USUARIO_ULT_MOD>' + 
				'<FCH_HORA_ULT_MOD Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FCH_HORA_ULT_MOD) + '</FCH_HORA_ULT_MOD>' + 
				'<ACEPTA_UNIDADES Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ACEPTA_UNIDADES) + '</ACEPTA_UNIDADES>' + 
				'<USO_RESTRINGIDO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USO_RESTRINGIDO) + '</USO_RESTRINGIDO>' + 
				'<ORIGEN_CONVERSION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ORIGEN_CONVERSION) + '</ORIGEN_CONVERSION>' + 
				'</CUENTA_CONTABLE>'


				-- inserta la solicitud correspondiente
				EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'CUENTACONTABLEPOS600', 'MODIFICA', @PARAMETROS, @ACTUALIZAR_SOLICITUD, @COL_ROWPOINTER
			END

			FETCH NEXT FROM C_MODIFIED
			INTO @CUENTA_CONTABLE, @SECCION_CUENTA, @UNIDAD, @DESCRIPCION, @TIPO, @TIPO_DETALLADO, @TIPO_OAF, @SALDO_NORMAL, @CONVERSION, @TIPO_CAMBIO, @ACEPTA_DATOS, @CONSOLIDA, @USA_CENTRO_COSTO, @USUARIO, @FECHA_HORA, @USUARIO_ULT_MOD, @FCH_HORA_ULT_MOD, @ACEPTA_UNIDADES, @USO_RESTRINGIDO, @ORIGEN_CONVERSION
		END

		CLOSE C_MODIFIED
		DEALLOCATE C_MODIFIED
	END

	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para modificar la tabla CUENTA_CONTABLE.',16,1 )
	END
END
;




CREATE TRIGGER $$Compania$$.CUENTA_CONTABLE_POS_DEL
ON $$Compania$$.CUENTA_CONTABLE
FOR DELETE  
AS 
BEGIN   	
        DECLARE @ERROR  int
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @CUENTA_CONTABLE VARCHAR(25)

	 -- Declaraciones	

	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM 
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_DELETED CURSOR LOCAL FOR
			SELECT CUENTA_CONTABLE
			FROM DELETED d
			WHERE 0 = (
				SELECT COUNT('n')
				FROM INSERTED i
				WHERE d.CUENTA_CONTABLE = i.CUENTA_CONTABLE
			   )

		OPEN C_DELETED
		FETCH NEXT FROM C_DELETED INTO 
		@CUENTA_CONTABLE
		
		SET @ERROR = 0
		
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS = 
								'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<CUENTA_CONTABLE>' + 
				'<CUENTA_CONTABLE Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CUENTA_CONTABLE) + '</CUENTA_CONTABLE>' + 
				'</CUENTA_CONTABLE>'
 
			
			-- inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'CUENTACONTABLEPOS600', 'ELIMINA', @PARAMETROS, 0, ''
			
			FETCH NEXT FROM C_DELETED INTO 
			@CUENTA_CONTABLE
		END

		CLOSE C_DELETED
		DEALLOCATE C_DELETED
	END
	
	IF (@@ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para eliminar de la tabla CUENTA_CONTABLE.',16,1 )
	END
END
;




CREATE TRIGGER $$Compania$$.CENTRO_COSTO_POS_INS
ON $$Compania$$.CENTRO_COSTO
FOR INSERT
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @CENTRO_COSTO VARCHAR(25)
	DECLARE @DESCRIPCION VARCHAR(60)
	DECLARE @ACEPTA_DATOS VARCHAR(1)
	DECLARE @TIPO VARCHAR(1)
	

	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM 
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_INSERTED CURSOR LOCAL FOR
		SELECT CENTRO_COSTO, DESCRIPCION, ACEPTA_DATOS, TIPO
		FROM INSERTED i
		WHERE 0 = (
				SELECT COUNT('n')
				FROM DELETED d
				WHERE i.CENTRO_COSTO = d.CENTRO_COSTO
			   )
			
		OPEN C_INSERTED	
		FETCH NEXT FROM C_INSERTED INTO
		@CENTRO_COSTO, @DESCRIPCION, @ACEPTA_DATOS, @TIPO

		SET @ERROR = 0
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS = 
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<CENTRO_COSTO>' + 
				'<CENTRO_COSTO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CENTRO_COSTO) + '</CENTRO_COSTO>' + 
				'<DESCRIPCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DESCRIPCION) + '</DESCRIPCION>' + 
				'<ACEPTA_DATOS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ACEPTA_DATOS) + '</ACEPTA_DATOS>' + 
				'<TIPO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO) + '</TIPO>' + 
				'</CENTRO_COSTO>'


			-- Inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'CENTROCOSTOPOS600', 'INSERTA', @PARAMETROS, 0, ''

			FETCH NEXT FROM C_INSERTED INTO
			@CENTRO_COSTO, @DESCRIPCION, @ACEPTA_DATOS, @TIPO
		END

		CLOSE C_INSERTED
    		DEALLOCATE C_INSERTED
	END

	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla CENTRO_COSTO.',16,1 )
	END
END
;





CREATE TRIGGER $$Compania$$.CENTRO_COSTO_POS_MOD
ON $$Compania$$.CENTRO_COSTO
FOR UPDATE
AS 
BEGIN   	
	DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @COL_ROWPOINTER VARCHAR(36)
	DECLARE @HAY_CAMPOS_PARA_POS BIT
	DECLARE @ACTUALIZAR_SOLICITUD BIT
	DECLARE @CENTRO_COSTO VARCHAR(25)
	DECLARE @DESCRIPCION VARCHAR(60)
	DECLARE @ACEPTA_DATOS VARCHAR(1)
	DECLARE @TIPO VARCHAR(1)
	 -- Declaraciones

	SET @ERROR = 0

	SELECT @PUBLICADOR = SITIO_LOCAL, @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_MODIFIED CURSOR LOCAL FOR
			SELECT CENTRO_COSTO, DESCRIPCION, ACEPTA_DATOS, TIPO -- Columnas
			FROM INSERTED I

		SET @ACTUALIZAR_SOLICITUD = 1

		OPEN C_MODIFIED

		FETCH NEXT FROM C_MODIFIED
		INTO @CENTRO_COSTO, @DESCRIPCION, @ACEPTA_DATOS, @TIPO

		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			IF ( NOT UPDATE(RECORDDATE) AND ( UPDATE(CENTRO_COSTO) OR UPDATE(DESCRIPCION) OR UPDATE(ACEPTA_DATOS) OR UPDATE(TIPO) ) )
			BEGIN

				SELECT @COL_ROWPOINTER = ROWPOINTER 
				FROM $$Compania$$.CENTRO_COSTO
				WHERE CENTRO_COSTO = @CENTRO_COSTO 

				SET @PARAMETROS =
					'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<CENTRO_COSTO>' + 
				'<CENTRO_COSTO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CENTRO_COSTO) + '</CENTRO_COSTO>' + 
				'<DESCRIPCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DESCRIPCION) + '</DESCRIPCION>' + 
				'<ACEPTA_DATOS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ACEPTA_DATOS) + '</ACEPTA_DATOS>' + 
				'<TIPO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO) + '</TIPO>' + 
				'</CENTRO_COSTO>'


				-- inserta la solicitud correspondiente
				EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'CENTROCOSTOPOS600', 'MODIFICA', @PARAMETROS, @ACTUALIZAR_SOLICITUD, @COL_ROWPOINTER
			END

			FETCH NEXT FROM C_MODIFIED
			INTO @CENTRO_COSTO, @DESCRIPCION, @ACEPTA_DATOS, @TIPO
		END

		CLOSE C_MODIFIED
		DEALLOCATE C_MODIFIED
	END

	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para modificar la tabla CENTRO_COSTO.',16,1 )
	END
END
;




CREATE TRIGGER $$Compania$$.CENTRO_COSTO_POS_DEL
ON $$Compania$$.CENTRO_COSTO
FOR DELETE  
AS 
BEGIN   	
                DECLARE @ERROR  int
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @CENTRO_COSTO VARCHAR(25)
	 -- Declaraciones	

	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM 
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_DELETED CURSOR LOCAL FOR
			SELECT CENTRO_COSTO
			FROM DELETED d
			WHERE 0 = (
				SELECT COUNT('n')
				FROM INSERTED i
				WHERE d.CENTRO_COSTO = i.CENTRO_COSTO
			   )

		OPEN C_DELETED
		FETCH NEXT FROM C_DELETED INTO 
		@CENTRO_COSTO
		
		SET @ERROR = 0
		
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS = 
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<CENTRO_COSTO>' + 
				'<CENTRO_COSTO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CENTRO_COSTO) + '</CENTRO_COSTO>' + 
				'</CENTRO_COSTO>'
 
			
			-- inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'CENTROCOSTOPOS600', 'ELIMINA', @PARAMETROS, 0, ''
			
			FETCH NEXT FROM C_DELETED INTO 
			@CENTRO_COSTO
		END

		CLOSE C_DELETED
		DEALLOCATE C_DELETED
	END
	
	IF (@@ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para eliminar de la tabla CENTRO_COSTO.',16,1 )
	END
END
;




CREATE TRIGGER $$Compania$$.CENTRO_CUENTA_POS_INS
ON $$Compania$$.CENTRO_CUENTA
FOR INSERT
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @CENTRO_COSTO VARCHAR(25)
	DECLARE @CUENTA_CONTABLE VARCHAR(25)
	DECLARE @ESTADO VARCHAR(1)
	DECLARE @CENTRO_POZO VARCHAR(25)
	DECLARE @CUENTA_POZO VARCHAR(25)
	DECLARE @CENTRO_GASTO VARCHAR(25)
	DECLARE @CUENTA_GASTO VARCHAR(25)
	DECLARE @CENTRO_CONSOLIDA VARCHAR(25)
	DECLARE @CUENTA_CONSOLIDA VARCHAR(25)
	

	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM 
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_INSERTED CURSOR LOCAL FOR
		SELECT CENTRO_COSTO, CUENTA_CONTABLE, ESTADO, CENTRO_POZO, CUENTA_POZO, CENTRO_GASTO, CUENTA_GASTO, CENTRO_CONSOLIDA, CUENTA_CONSOLIDA
		FROM INSERTED i
		WHERE 0 = (
				SELECT COUNT('n')
				FROM DELETED d
				WHERE i.CENTRO_COSTO = d.CENTRO_COSTO AND i.CUENTA_CONTABLE = d.CUENTA_CONTABLE
			   )
			
		OPEN C_INSERTED	
		FETCH NEXT FROM C_INSERTED INTO
		@CENTRO_COSTO, @CUENTA_CONTABLE, @ESTADO, @CENTRO_POZO, @CUENTA_POZO, @CENTRO_GASTO, @CUENTA_GASTO, @CENTRO_CONSOLIDA, @CUENTA_CONSOLIDA

		SET @ERROR = 0
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS = 
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<CENTRO_CUENTA>' + 
				'<CENTRO_COSTO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CENTRO_COSTO) + '</CENTRO_COSTO>' + 
				'<CUENTA_CONTABLE Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CUENTA_CONTABLE) + '</CUENTA_CONTABLE>' + 
				'<ESTADO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ESTADO) + '</ESTADO>' + 
				'<CENTRO_POZO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CENTRO_POZO) + '</CENTRO_POZO>' + 
				'<CUENTA_POZO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CUENTA_POZO) + '</CUENTA_POZO>' + 
				'<CENTRO_GASTO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CENTRO_GASTO) + '</CENTRO_GASTO>' + 
				'<CUENTA_GASTO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CUENTA_GASTO) + '</CUENTA_GASTO>' + 
				'<CENTRO_CONSOLIDA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CENTRO_CONSOLIDA) + '</CENTRO_CONSOLIDA>' + 
				'<CUENTA_CONSOLIDA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CUENTA_CONSOLIDA) + '</CUENTA_CONSOLIDA>' + 
				'</CENTRO_CUENTA>'


			-- Inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'CENTROCUENTAPOS600', 'INSERTA', @PARAMETROS, 0, ''

			FETCH NEXT FROM C_INSERTED INTO
			@CENTRO_COSTO, @CUENTA_CONTABLE, @ESTADO, @CENTRO_POZO, @CUENTA_POZO, @CENTRO_GASTO, @CUENTA_GASTO, @CENTRO_CONSOLIDA, @CUENTA_CONSOLIDA
		END

		CLOSE C_INSERTED
    		DEALLOCATE C_INSERTED
	END

	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla CENTRO_CUENTA.',16,1 )
	END
END
;




CREATE TRIGGER $$Compania$$.CENTRO_CUENTA_POS_MOD
ON $$Compania$$.CENTRO_CUENTA
FOR UPDATE
AS 
BEGIN   	
	DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @COL_ROWPOINTER VARCHAR(36)
	DECLARE @HAY_CAMPOS_PARA_POS BIT
	DECLARE @ACTUALIZAR_SOLICITUD BIT
	DECLARE @CENTRO_COSTO VARCHAR(25)
	DECLARE @CUENTA_CONTABLE VARCHAR(25)
	DECLARE @ESTADO VARCHAR(1)
	DECLARE @CENTRO_POZO VARCHAR(25)
	DECLARE @CUENTA_POZO VARCHAR(25)
	DECLARE @CENTRO_GASTO VARCHAR(25)
	DECLARE @CUENTA_GASTO VARCHAR(25)
	DECLARE @CENTRO_CONSOLIDA VARCHAR(25)
	DECLARE @CUENTA_CONSOLIDA VARCHAR(25)
	 -- Declaraciones

	SET @ERROR = 0

	SELECT @PUBLICADOR = SITIO_LOCAL, @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_MODIFIED CURSOR LOCAL FOR
			SELECT CENTRO_COSTO, CUENTA_CONTABLE, ESTADO, CENTRO_POZO, CUENTA_POZO, CENTRO_GASTO, CUENTA_GASTO, CENTRO_CONSOLIDA, CUENTA_CONSOLIDA -- Columnas
			FROM INSERTED I

		SET @ACTUALIZAR_SOLICITUD = 1

		OPEN C_MODIFIED

		FETCH NEXT FROM C_MODIFIED
		INTO @CENTRO_COSTO, @CUENTA_CONTABLE, @ESTADO, @CENTRO_POZO, @CUENTA_POZO, @CENTRO_GASTO, @CUENTA_GASTO, @CENTRO_CONSOLIDA, @CUENTA_CONSOLIDA

		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			IF ( NOT UPDATE(RECORDDATE) AND ( UPDATE(CENTRO_COSTO) OR UPDATE(CUENTA_CONTABLE) OR UPDATE(ESTADO) OR UPDATE(CENTRO_POZO) OR UPDATE(CUENTA_POZO) OR UPDATE(CENTRO_GASTO) OR UPDATE(CUENTA_GASTO) OR UPDATE(CENTRO_CONSOLIDA) OR UPDATE(CUENTA_CONSOLIDA) ) )
			BEGIN

				SELECT @COL_ROWPOINTER = ROWPOINTER 
				FROM $$Compania$$.CENTRO_CUENTA
				WHERE CENTRO_COSTO = @CENTRO_COSTO AND CUENTA_CONTABLE = @CUENTA_CONTABLE 

				SET @PARAMETROS =
					'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<CENTRO_CUENTA>' + 
				'<CENTRO_COSTO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CENTRO_COSTO) + '</CENTRO_COSTO>' + 
				'<CUENTA_CONTABLE Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CUENTA_CONTABLE) + '</CUENTA_CONTABLE>' + 
				'<ESTADO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ESTADO) + '</ESTADO>' + 
				'<CENTRO_POZO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CENTRO_POZO) + '</CENTRO_POZO>' + 
				'<CUENTA_POZO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CUENTA_POZO) + '</CUENTA_POZO>' + 
				'<CENTRO_GASTO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CENTRO_GASTO) + '</CENTRO_GASTO>' + 
				'<CUENTA_GASTO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CUENTA_GASTO) + '</CUENTA_GASTO>' + 
				'<CENTRO_CONSOLIDA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CENTRO_CONSOLIDA) + '</CENTRO_CONSOLIDA>' + 
				'<CUENTA_CONSOLIDA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CUENTA_CONSOLIDA) + '</CUENTA_CONSOLIDA>' + 
				'</CENTRO_CUENTA>'


				-- inserta la solicitud correspondiente
				EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'CENTROCUENTAPOS600', 'MODIFICA', @PARAMETROS, @ACTUALIZAR_SOLICITUD, @COL_ROWPOINTER
			END

			FETCH NEXT FROM C_MODIFIED
			INTO @CENTRO_COSTO, @CUENTA_CONTABLE, @ESTADO, @CENTRO_POZO, @CUENTA_POZO, @CENTRO_GASTO, @CUENTA_GASTO, @CENTRO_CONSOLIDA, @CUENTA_CONSOLIDA
		END

		CLOSE C_MODIFIED
		DEALLOCATE C_MODIFIED
	END

	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para modificar la tabla CENTRO_CUENTA.',16,1 )
	END
END
;




CREATE TRIGGER $$Compania$$.CENTRO_CUENTA_POS_DEL
ON $$Compania$$.CENTRO_CUENTA
FOR DELETE  
AS 
BEGIN   	
                DECLARE @ERROR  int
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @CENTRO_COSTO VARCHAR(25)
	DECLARE @CUENTA_CONTABLE VARCHAR(25)

	 -- Declaraciones	

	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM 
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_DELETED CURSOR LOCAL FOR
			SELECT CENTRO_COSTO, CUENTA_CONTABLE
			FROM DELETED d
			WHERE 0 = (
				SELECT COUNT('n')
				FROM INSERTED i
				WHERE d.CENTRO_COSTO = i.CENTRO_COSTO AND d.CUENTA_CONTABLE = i.CUENTA_CONTABLE
			   )

		OPEN C_DELETED
		FETCH NEXT FROM C_DELETED INTO 
		@CENTRO_COSTO, @CUENTA_CONTABLE
		
		SET @ERROR = 0
		
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS = 
								'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<CENTRO_CUENTA>' + 
				'<CENTRO_COSTO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CENTRO_COSTO) + '</CENTRO_COSTO>' + 
				'<CUENTA_CONTABLE Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CUENTA_CONTABLE) + '</CUENTA_CONTABLE>' + 
				'</CENTRO_CUENTA>'
 
			
			-- inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'CENTROCUENTAPOS600', 'ELIMINA', @PARAMETROS, 0, ''
			
			FETCH NEXT FROM C_DELETED INTO 
			@CENTRO_COSTO, @CUENTA_CONTABLE
		END

		CLOSE C_DELETED
		DEALLOCATE C_DELETED
	END
	
	IF (@@ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para eliminar de la tabla CENTRO_CUENTA.',16,1 )
	END
END
;





CREATE TRIGGER $$Compania$$.CLASIFICACION_ADI_POS_INS
ON $$Compania$$.CLASIFICACION_ADI
FOR INSERT
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @CLASIFICACION VARCHAR(12)
	DECLARE @DESCRIPCION VARCHAR(70)
	DECLARE @POSICION INT
	

	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM 
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_INSERTED CURSOR LOCAL FOR
		SELECT CLASIFICACION, DESCRIPCION, POSICION
		FROM INSERTED i
		WHERE 0 = (
				SELECT COUNT('n')
				FROM DELETED d
				WHERE i.CLASIFICACION = d.CLASIFICACION
			   )
			
		OPEN C_INSERTED	
		FETCH NEXT FROM C_INSERTED INTO
		@CLASIFICACION, @DESCRIPCION, @POSICION

		SET @ERROR = 0
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS = 
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<CLASIFICACION_ADI>' + 
				'<CLASIFICACION Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CLASIFICACION) + '</CLASIFICACION>' + 
				'<DESCRIPCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DESCRIPCION) + '</DESCRIPCION>' + 
				'<POSICION Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@POSICION) + '</POSICION>' + 
				'</CLASIFICACION_ADI>'


			-- Inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'CLASIFICACIONADIPOS600', 'INSERTA', @PARAMETROS, 0, ''

			FETCH NEXT FROM C_INSERTED INTO
			@CLASIFICACION, @DESCRIPCION, @POSICION
		END

		CLOSE C_INSERTED
    		DEALLOCATE C_INSERTED
	END

	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla CLASIFICACION_ADI.',16,1 )
	END
END
;




CREATE TRIGGER $$Compania$$.CLASIFICACION_ADI_POS_MOD
ON $$Compania$$.CLASIFICACION_ADI
FOR UPDATE
AS 
BEGIN   	
	DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @COL_ROWPOINTER VARCHAR(36)
	DECLARE @HAY_CAMPOS_PARA_POS BIT
	DECLARE @ACTUALIZAR_SOLICITUD BIT
	DECLARE @CLASIFICACION VARCHAR(12)
	DECLARE @DESCRIPCION VARCHAR(70)
	DECLARE @POSICION INT
	 -- Declaraciones

	SET @ERROR = 0

	SELECT @PUBLICADOR = SITIO_LOCAL, @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_MODIFIED CURSOR LOCAL FOR
			SELECT CLASIFICACION, DESCRIPCION, POSICION -- Columnas
			FROM INSERTED I

		SET @ACTUALIZAR_SOLICITUD = 1

		OPEN C_MODIFIED

		FETCH NEXT FROM C_MODIFIED
		INTO @CLASIFICACION, @DESCRIPCION, @POSICION

		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			IF ( NOT UPDATE(RECORDDATE) AND ( UPDATE(CLASIFICACION) OR UPDATE(DESCRIPCION) OR UPDATE(POSICION) ) )
			BEGIN

				SELECT @COL_ROWPOINTER = ROWPOINTER 
				FROM $$Compania$$.CLASIFICACION_ADI
				WHERE CLASIFICACION = @CLASIFICACION 

				SET @PARAMETROS =
					'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<CLASIFICACION_ADI>' + 
				'<CLASIFICACION Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CLASIFICACION) + '</CLASIFICACION>' + 
				'<DESCRIPCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DESCRIPCION) + '</DESCRIPCION>' + 
				'<POSICION Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@POSICION) + '</POSICION>' + 
				'</CLASIFICACION_ADI>'


				-- inserta la solicitud correspondiente
				EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'CLASIFICACIONADIPOS600', 'MODIFICA', @PARAMETROS, @ACTUALIZAR_SOLICITUD, @COL_ROWPOINTER
			END

			FETCH NEXT FROM C_MODIFIED
			INTO @CLASIFICACION, @DESCRIPCION, @POSICION
		END

		CLOSE C_MODIFIED
		DEALLOCATE C_MODIFIED
	END

	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para modificar la tabla CLASIFICACION_ADI.',16,1 )
	END
END
;





CREATE TRIGGER $$Compania$$.CLASIFICACION_ADI_POS_DEL
ON $$Compania$$.CLASIFICACION_ADI
FOR DELETE  
AS 
BEGIN   	
                DECLARE @ERROR  int
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @CLASIFICACION VARCHAR(12)
	 -- Declaraciones	

	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM 
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_DELETED CURSOR LOCAL FOR
			SELECT CLASIFICACION
			FROM DELETED d
			WHERE 0 = (
				SELECT COUNT('n')
				FROM INSERTED i
				WHERE d.CLASIFICACION = i.CLASIFICACION
			   )

		OPEN C_DELETED
		FETCH NEXT FROM C_DELETED INTO 
		@CLASIFICACION -- VARIABLES
		
		SET @ERROR = 0
		
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS = 
								'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<CLASIFICACION_ADI>' + 
				'<CLASIFICACION Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CLASIFICACION) + '</CLASIFICACION>' + 
				'</CLASIFICACION_ADI>'
 
			
			-- inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'CLASIFICACIONADIPOS600', 'ELIMINA', @PARAMETROS, 0, ''
			
			FETCH NEXT FROM C_DELETED INTO 
			@CLASIFICACION -- VARIABLES
		END

		CLOSE C_DELETED
		DEALLOCATE C_DELETED
	END
	
	IF (@@ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para eliminar de la tabla CLASIFICACION_ADI.',16,1 )
	END
END
;



CREATE TRIGGER $$Compania$$.CLASIFICA_ADI_VALOR_POS_INS
ON $$Compania$$.CLASIFICACION_ADI_VALOR
FOR INSERT
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @CLASIFICACION VARCHAR(12)
	DECLARE @VALOR VARCHAR(12)
	DECLARE @DESCRIPCION VARCHAR(254)
	

	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM 
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_INSERTED CURSOR LOCAL FOR
		SELECT CLASIFICACION, VALOR, DESCRIPCION
		FROM INSERTED i
		WHERE 0 = (
				SELECT COUNT('n')
				FROM DELETED d
				WHERE i.CLASIFICACION = d.CLASIFICACION AND i.VALOR = d.VALOR
			   )
			
		OPEN C_INSERTED	
		FETCH NEXT FROM C_INSERTED INTO
		@CLASIFICACION, @VALOR, @DESCRIPCION

		SET @ERROR = 0
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS = 
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<CLASIFICACION_ADI_VALOR>' + 
				'<CLASIFICACION Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CLASIFICACION) + '</CLASIFICACION>' + 
				'<VALOR Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@VALOR) + '</VALOR>' + 
				'<DESCRIPCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DESCRIPCION) + '</DESCRIPCION>' + 
				'</CLASIFICACION_ADI_VALOR>'


			-- Inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'CLASIFICACIONADIVALORPOS600', 'INSERTA', @PARAMETROS, 0, ''

			FETCH NEXT FROM C_INSERTED INTO
			@CLASIFICACION, @VALOR, @DESCRIPCION
		END

		CLOSE C_INSERTED
    		DEALLOCATE C_INSERTED
	END

	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla CLASIFICACION_ADI_VALOR.',16,1 )
	END
END
;



CREATE TRIGGER $$Compania$$.CLASIFICA_ADI_VALOR_POS_MOD
ON $$Compania$$.CLASIFICACION_ADI_VALOR
FOR UPDATE
AS 
BEGIN   	
	DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @COL_ROWPOINTER VARCHAR(36)
	DECLARE @HAY_CAMPOS_PARA_POS BIT
	DECLARE @ACTUALIZAR_SOLICITUD BIT
	DECLARE @CLASIFICACION VARCHAR(12)
	DECLARE @VALOR VARCHAR(12)
	DECLARE @DESCRIPCION VARCHAR(254)
	 -- Declaraciones

	SET @ERROR = 0

	SELECT @PUBLICADOR = SITIO_LOCAL, @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_MODIFIED CURSOR LOCAL FOR
			SELECT CLASIFICACION, VALOR, DESCRIPCION -- Columnas
			FROM INSERTED I

		SET @ACTUALIZAR_SOLICITUD = 1

		OPEN C_MODIFIED

		FETCH NEXT FROM C_MODIFIED
		INTO @CLASIFICACION, @VALOR, @DESCRIPCION

		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			IF ( NOT UPDATE(RECORDDATE) AND ( UPDATE(CLASIFICACION) OR UPDATE(VALOR) OR UPDATE(DESCRIPCION) ) )
			BEGIN

				SELECT @COL_ROWPOINTER = ROWPOINTER 
				FROM $$Compania$$.CLASIFICACION_ADI_VALOR
				WHERE CLASIFICACION = @CLASIFICACION AND VALOR = @VALOR 

				SET @PARAMETROS =
					'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<CLASIFICACION_ADI_VALOR>' + 
				'<CLASIFICACION Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CLASIFICACION) + '</CLASIFICACION>' + 
				'<VALOR Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@VALOR) + '</VALOR>' + 
				'<DESCRIPCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DESCRIPCION) + '</DESCRIPCION>' + 
				'</CLASIFICACION_ADI_VALOR>'


				-- inserta la solicitud correspondiente
				EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'CLASIFICACIONADIVALORPOS600', 'MODIFICA', @PARAMETROS, @ACTUALIZAR_SOLICITUD, @COL_ROWPOINTER
			END

			FETCH NEXT FROM C_MODIFIED
			INTO @CLASIFICACION, @VALOR, @DESCRIPCION
		END

		CLOSE C_MODIFIED
		DEALLOCATE C_MODIFIED
	END

	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para modificar la tabla CLASIFICACION_ADI_VALOR.',16,1 )
	END
END
;




CREATE TRIGGER $$Compania$$.CLASIFICA_ADI_VALOR_POS_DEL
ON $$Compania$$.CLASIFICACION_ADI_VALOR
FOR DELETE  
AS 
BEGIN   	
                DECLARE @ERROR  int
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @CLASIFICACION VARCHAR(12)
	DECLARE @VALOR VARCHAR(12)
	 -- Declaraciones	

	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM 
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_DELETED CURSOR LOCAL FOR
			SELECT CLASIFICACION, VALOR
			FROM DELETED d
			WHERE 0 = (
				SELECT COUNT('n')
				FROM INSERTED i
				WHERE d.CLASIFICACION = i.CLASIFICACION AND d.VALOR = i.VALOR
			   )

		OPEN C_DELETED
		FETCH NEXT FROM C_DELETED INTO 
		@CLASIFICACION, @VALOR -- VARIABLES
		
		SET @ERROR = 0
		
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS = 
								'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<CLASIFICACION_ADI_VALOR>' + 
				'<CLASIFICACION Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CLASIFICACION) + '</CLASIFICACION>' + 
				'<VALOR Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@VALOR) + '</VALOR>' + 
				'</CLASIFICACION_ADI_VALOR>'
 
			
			-- inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'CLASIFICACIONADIVALORPOS600', 'ELIMINA', @PARAMETROS, 0, ''
			
			FETCH NEXT FROM C_DELETED INTO 
			@CLASIFICACION, @VALOR -- VARIABLES
		END

		CLOSE C_DELETED
		DEALLOCATE C_DELETED
	END
	
	IF (@@ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para eliminar de la tabla CLASIFICACION_ADI_VALOR.',16,1 )
	END
END
;


CREATE TRIGGER $$Compania$$.CLASIFIC_ADI_ARTICULO_POS_INS
ON $$Compania$$.CLASIFIC_ADI_ARTICULO
FOR INSERT
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @ARTICULO VARCHAR(20)
	DECLARE @CLASIFICACION VARCHAR(12)
	DECLARE @VALOR VARCHAR(12)
	

	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM 
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_INSERTED CURSOR LOCAL FOR
		SELECT ARTICULO, CLASIFICACION, VALOR
		FROM INSERTED i
		WHERE 0 = (
				SELECT COUNT('n')
				FROM DELETED d
				WHERE i.ARTICULO = d.ARTICULO AND i.CLASIFICACION = d.CLASIFICACION
			   )
			
		OPEN C_INSERTED	
		FETCH NEXT FROM C_INSERTED INTO
		@ARTICULO, @CLASIFICACION, @VALOR

		SET @ERROR = 0
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS = 
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<CLASIFIC_ADI_ARTICULO>' + 
				'<ARTICULO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@ARTICULO) + '</ARTICULO>' + 
				'<CLASIFICACION Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CLASIFICACION) + '</CLASIFICACION>' + 
				'<VALOR Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@VALOR) + '</VALOR>' + 
				'</CLASIFIC_ADI_ARTICULO>'


			-- Inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'CLASIFICADIARTICULOPOS600', 'INSERTA', @PARAMETROS, 0, ''

			FETCH NEXT FROM C_INSERTED INTO
			@ARTICULO, @CLASIFICACION, @VALOR
		END

		CLOSE C_INSERTED
    		DEALLOCATE C_INSERTED
	END

	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla CLASIFIC_ADI_ARTICULO.',16,1 )
	END
END
;
CREATE TRIGGER $$Compania$$.CLASIFIC_ADI_ARTICULO_POS_MOD
ON $$Compania$$.CLASIFIC_ADI_ARTICULO
FOR UPDATE
AS 
BEGIN   	
	DECLARE @ERROR  INT
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @COL_ROWPOINTER VARCHAR(36)
	DECLARE @HAY_CAMPOS_PARA_POS BIT
	DECLARE @ACTUALIZAR_SOLICITUD BIT
	DECLARE @ARTICULO VARCHAR(20)
	DECLARE @CLASIFICACION VARCHAR(12)
	DECLARE @VALOR VARCHAR(12)
	 -- Declaraciones

	SET @ERROR = 0

	SELECT @PUBLICADOR = SITIO_LOCAL, @USUARIO_POS_WSQM = USUARIO_WSQM
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_MODIFIED CURSOR LOCAL FOR
			SELECT ARTICULO, CLASIFICACION, VALOR -- Columnas
			FROM INSERTED I

		SET @ACTUALIZAR_SOLICITUD = 1

		OPEN C_MODIFIED

		FETCH NEXT FROM C_MODIFIED
		INTO @ARTICULO, @CLASIFICACION, @VALOR

		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			IF ( NOT UPDATE(RECORDDATE) AND ( UPDATE(ARTICULO) OR UPDATE(CLASIFICACION) OR UPDATE(VALOR) ) )
			BEGIN

				SELECT @COL_ROWPOINTER = ROWPOINTER 
				FROM $$Compania$$.CLASIFIC_ADI_ARTICULO
				WHERE ARTICULO = @ARTICULO AND CLASIFICACION = @CLASIFICACION 

				SET @PARAMETROS =
					'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<CLASIFIC_ADI_ARTICULO>' + 
				'<ARTICULO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@ARTICULO) + '</ARTICULO>' + 
				'<CLASIFICACION Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CLASIFICACION) + '</CLASIFICACION>' + 
				'<VALOR Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@VALOR) + '</VALOR>' + 
				'</CLASIFIC_ADI_ARTICULO>'


				-- inserta la solicitud correspondiente
				EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'CLASIFICADIARTICULOPOS600', 'MODIFICA', @PARAMETROS, @ACTUALIZAR_SOLICITUD, @COL_ROWPOINTER
			END

			FETCH NEXT FROM C_MODIFIED
			INTO @ARTICULO, @CLASIFICACION, @VALOR
		END

		CLOSE C_MODIFIED
		DEALLOCATE C_MODIFIED
	END

	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para modificar la tabla CLASIFIC_ADI_ARTICULO.',16,1 )
	END
END;



CREATE TRIGGER $$Compania$$.CLASIFIC_ADI_ARTICULO_POS_DEL
ON $$Compania$$.CLASIFIC_ADI_ARTICULO
FOR DELETE  
AS 
BEGIN   	
        DECLARE @ERROR  int
	DECLARE @PUBLICADOR VARCHAR(20)
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @ARTICULO VARCHAR(20)
	DECLARE @CLASIFICACION VARCHAR(12)
	 -- Declaraciones	

	SELECT @PUBLICADOR = SITIO_LOCAL,
	       @USUARIO_POS_WSQM = USUARIO_WSQM 
	FROM $$Compania$$.GLOBALES_POS

	-- Aquí se hace la validación del usuario de conexión para evitar ping-pong
	IF NOT (CURRENT_USER = @USUARIO_POS_WSQM)
	BEGIN
		DECLARE C_DELETED CURSOR LOCAL FOR
			SELECT ARTICULO, CLASIFICACION
			FROM DELETED d
			WHERE 0 = (
				SELECT COUNT('n')
				FROM INSERTED i
				WHERE d.ARTICULO = i.ARTICULO AND d.CLASIFICACION = i.CLASIFICACION
			   )

		OPEN C_DELETED
		FETCH NEXT FROM C_DELETED INTO 
		@ARTICULO, @CLASIFICACION -- VARIABLES
		
		SET @ERROR = 0
		
		WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
		BEGIN
			SET @PARAMETROS = 
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<CLASIFIC_ADI_ARTICULO>' + 
				'<ARTICULO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@ARTICULO) + '</ARTICULO>' + 
				'<CLASIFICACION Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CLASIFICACION) + '</CLASIFICACION>' + 
				'</CLASIFIC_ADI_ARTICULO>'
 
			
			-- inserta la solicitud correspondiente
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'CLASIFICADIARTICULOPOS600', 'ELIMINA', @PARAMETROS, 0, ''
			
			FETCH NEXT FROM C_DELETED INTO 
			@ARTICULO, @CLASIFICACION-- VARIABLES
		END

		CLOSE C_DELETED
		DEALLOCATE C_DELETED
	END
	
	IF (@@ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para eliminar de la tabla CLASIFIC_ADI_ARTICULO.',16,1 )
	END
END;



CREATE PROCEDURE $$Compania$$.REGENERA_DOCUMENTO_POS
	 @DOCUMENTOS VARCHAR(20),
	 @CAJAS VARCHAR(6),
	 @TIPOS VARCHAR(1),
	 @PUBLICADOR VARCHAR(20),
	 @INSERTA VARCHAR(1)	 
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @TIPO_SITIO_LOCAL VARCHAR(1)
	DECLARE @DOCUMENTO VARCHAR(20)
	DECLARE @CAJA VARCHAR(6)
	DECLARE @TIPO VARCHAR(1)
	DECLARE @PERFIL VARCHAR(4)
	DECLARE @VENDEDOR VARCHAR(4)
	DECLARE @CLIENTE VARCHAR(20)
	DECLARE @NOMBRE_CLIENTE VARCHAR(80)
	DECLARE @CAJERO VARCHAR(25)
	DECLARE @CAJA_COBRO VARCHAR(6)
	DECLARE @IMPUESTO1 DECIMAL(28,8)
	DECLARE @IMPUESTO2 DECIMAL(28,8)
	DECLARE @DESCUENTO DECIMAL(28,8)
	DECLARE @TOTAL_PAGAR DECIMAL(28,8)
	DECLARE @TOTAL DECIMAL(28,8)
	DECLARE @FCH_HORA_CREACION DATETIME
	DECLARE @FCH_HORA_COBRO DATETIME
	DECLARE @FCH_HORA_ANULA DATETIME
	DECLARE @EXPORTADO VARCHAR(1)
	DECLARE @ESTADO_COBRO VARCHAR(1)
	DECLARE @SALDO DECIMAL(28,8)
	DECLARE @FECHA_VENCE DATETIME
	DECLARE @LISTO_INVENTARIO VARCHAR(1)
	DECLARE @NIVEL_PRECIO VARCHAR(12)
	DECLARE @MONEDA_NIVEL VARCHAR(1)
	DECLARE @VERSION INT
	DECLARE @FECHANAC_CLIENTE DATETIME
	DECLARE @TELEFONO_CLIENTE VARCHAR(15)
	DECLARE @NIT_CLIENTE VARCHAR(20)
	DECLARE @PAIS VARCHAR(4)
	DECLARE @CLASE_DOCUMENTO VARCHAR(1)
	DECLARE @CONDICION_PAGO_APA VARCHAR(4)
	DECLARE @DOC_CC VARCHAR(20)
	DECLARE @TIPO_DOC_CC VARCHAR(3)
	DECLARE @CARGADO_CC VARCHAR(1)
	DECLARE @CARGADO_CG VARCHAR(1)
	DECLARE @DEVUELVE_DINERO VARCHAR(1)
	DECLARE @DOC_CC_ANUL VARCHAR(20)
	DECLARE @TIPO_DOC_CC_ANUL VARCHAR(3)
	DECLARE @GENERO_FACTURA_INICIO VARCHAR(1)
	DECLARE @AFECTA_CONTABIL VARCHAR(1)
	DECLARE @EFECTIVO_DEVUELTO DECIMAL(28,8)
	DECLARE @TIPO_CAMBIO DECIMAL(28,8)
	DECLARE @BENEFICIARIO VARCHAR(254)
	DECLARE @MONEDA VARCHAR(1)
	DECLARE @SUBTIPO VARCHAR(1)
	DECLARE @ID_BENEFICIARIO VARCHAR(20)
	DECLARE @USUARIO_ULT_IMPRE VARCHAR(25)
	DECLARE @FCH_HORA_ULT_IMPRE DATETIME
	DECLARE @USUARIO_APLICACION VARCHAR(25)
	DECLARE @FCH_HORA_APLICACIO DATETIME
	DECLARE @USUARIO_ANULACION VARCHAR(25)
	DECLARE @ESTADO_IMPRESION VARCHAR(1)
	DECLARE @TELEFONO_BENEFICIA VARCHAR(15)
	DECLARE @SALDO_REPORTE DECIMAL(28,8)
	DECLARE @MONEDA_DOC VARCHAR(1)
	DECLARE @NCF VARCHAR(20)
	DECLARE @TIPO_NCF VARCHAR(6)
	DECLARE @NUM_CIERRE VARCHAR(20)
	DECLARE @DIRECCION VARCHAR(4000)
	DECLARE @CORRELATIVO varchar(10)
	DECLARE @RECIBIDO_DE varchar(80)
	DECLARE @RESOLUCION VARCHAR(20)
	DECLARE @COD_CLASE_DOC VARCHAR(10)
	DECLARE @DOC_EXPRESS VARCHAR(1)
	DECLARE @MENSAJERO 	VARCHAR(10)
	DECLARE @CLIENTE_EXPRESS VARCHAR(20)
	DECLARE @ENTREGA_EXPRSS_A VARCHAR(80)
	DECLARE @ESTADO_EXPRESS VARCHAR(1)
	DECLARE @MONTO_ENTREGADO DECIMAL (28,8)
	DECLARE @MONTO_DEVUELTO DECIMAL (28,8)
	DECLARE @FCH_ENVIO 	DATETIME
	DECLARE @FCH_ENTREGA 	DATETIME
	DECLARE @MOTIV_CANCELA_EXPR VARCHAR(10)
	DECLARE @NOTA_EXPRESS 	VARCHAR(1000)
   	DECLARE @BASE_IMPUESTO1	DECIMAL(28,8)
 	DECLARE @BASE_IMPUESTO2	DECIMAL(28,8) 
	DECLARE @DOC_FISCAL 	VARCHAR(50)
	DECLARE @PREFIJO 	VARCHAR(20)
	DECLARE @PEDIDO_AUTORIZADO 	VARCHAR(50)
	DECLARE @OPERACION VARCHAR(8)	
	DECLARE @NOTAS 			VARCHAR(4000)
	DECLARE @DOC_CC_ANTICIPO 	VARCHAR(50)
	DECLARE @NOMBREMAQUINA	VARCHAR(20)
	
	IF @INSERTA = 'I'	
	BEGIN
	SET @OPERACION = 'INSERTA'
	END
	ELSE
	BEGIN
	SET @OPERACION = 'MODIFICA'
	END

	DECLARE C_INSERTED CURSOR LOCAL FOR
	SELECT DOCUMENTO, CAJA, TIPO, PERFIL, VENDEDOR, CLIENTE, NOMBRE_CLIENTE, CAJERO, CAJA_COBRO, IMPUESTO1, IMPUESTO2, DESCUENTO, TOTAL_PAGAR, TOTAL, FCH_HORA_CREACION, FCH_HORA_COBRO, FCH_HORA_ANULA, EXPORTADO, ESTADO_COBRO, SALDO, FECHA_VENCE, LISTO_INVENTARIO, NIVEL_PRECIO, MONEDA_NIVEL, VERSION, FECHANAC_CLIENTE, TELEFONO_CLIENTE, NIT_CLIENTE, PAIS, CLASE_DOCUMENTO, CONDICION_PAGO_APA, DOC_CC, TIPO_DOC_CC, CARGADO_CC, CARGADO_CG, DEVUELVE_DINERO, DOC_CC_ANUL, TIPO_DOC_CC_ANUL, GENERO_FACTURA_INICIO, AFECTA_CONTABIL, EFECTIVO_DEVUELTO, TIPO_CAMBIO, BENEFICIARIO, MONEDA, SUBTIPO, ID_BENEFICIARIO, USUARIO_ULT_IMPRE, FCH_HORA_ULT_IMPRE, USUARIO_APLICACION, FCH_HORA_APLICACIO, USUARIO_ANULACION, ESTADO_IMPRESION, TELEFONO_BENEFICIA,SALDO_REPORTE, MONEDA_DOC, NCF, TIPO_NCF, NUM_CIERRE, DIRECCION, CORRELATIVO, RECIBIDO_DE, RESOLUCION, COD_CLASE_DOC, DOC_EXPRESS, MENSAJERO, CLIENTE_EXPRESS, ENTREGA_EXPRSS_A, ESTADO_EXPRESS, MONTO_ENTREGADO, MONTO_DEVUELTO, FCH_ENVIO, FCH_ENTREGA, MOTIV_CANCELA_EXPR, NOTA_EXPRESS, BASE_IMPUESTO1, BASE_IMPUESTO2, DOC_FISCAL, PREFIJO, PEDIDO_AUTORIZADO, DOC_CC_ANTICIPO, NOMBREMAQUINA
	FROM $$Compania$$.DOCUMENTO_POS
	WHERE DOCUMENTO=@DOCUMENTOS AND CAJA = @CAJAS AND TIPO = @TIPOS
		
	OPEN C_INSERTED	
	FETCH NEXT FROM C_INSERTED INTO
	@DOCUMENTO, @CAJA, @TIPO, @PERFIL, @VENDEDOR, @CLIENTE, @NOMBRE_CLIENTE, @CAJERO, @CAJA_COBRO, @IMPUESTO1, @IMPUESTO2, @DESCUENTO, @TOTAL_PAGAR, @TOTAL, @FCH_HORA_CREACION, @FCH_HORA_COBRO, @FCH_HORA_ANULA, @EXPORTADO, @ESTADO_COBRO, @SALDO, @FECHA_VENCE, @LISTO_INVENTARIO, @NIVEL_PRECIO, @MONEDA_NIVEL, @VERSION, @FECHANAC_CLIENTE, @TELEFONO_CLIENTE, @NIT_CLIENTE, @PAIS, @CLASE_DOCUMENTO, @CONDICION_PAGO_APA, @DOC_CC, @TIPO_DOC_CC, @CARGADO_CC, @CARGADO_CG, @DEVUELVE_DINERO, @DOC_CC_ANUL, @TIPO_DOC_CC_ANUL, @GENERO_FACTURA_INICIO, @AFECTA_CONTABIL, @EFECTIVO_DEVUELTO, @TIPO_CAMBIO, @BENEFICIARIO, @MONEDA, @SUBTIPO, @ID_BENEFICIARIO, @USUARIO_ULT_IMPRE, @FCH_HORA_ULT_IMPRE, @USUARIO_APLICACION, @FCH_HORA_APLICACIO, @USUARIO_ANULACION, @ESTADO_IMPRESION, @TELEFONO_BENEFICIA,@SALDO_REPORTE,@MONEDA_DOC, @NCF, @TIPO_NCF, @NUM_CIERRE, @DIRECCION, @CORRELATIVO, @RECIBIDO_DE, @RESOLUCION, @COD_CLASE_DOC, @DOC_EXPRESS, @MENSAJERO, @CLIENTE_EXPRESS, @ENTREGA_EXPRSS_A, @ESTADO_EXPRESS, @MONTO_ENTREGADO, @MONTO_DEVUELTO, @FCH_ENVIO, @FCH_ENTREGA, @MOTIV_CANCELA_EXPR, @NOTA_EXPRESS, @BASE_IMPUESTO1, @BASE_IMPUESTO2, @DOC_FISCAL, @PREFIJO, @PEDIDO_AUTORIZADO, @DOC_CC_ANTICIPO, @NOMBREMAQUINA
	SET @ERROR = 0

	WHILE @@FETCH_STATUS = 0 AND @ERROR = 0	
	BEGIN
		
		SELECT @NOTAS = CONVERT(varchar(4000),NOTAS )
	    FROM $$Compania$$.DOCUMENTO_POS 
	    WHERE DOCUMENTO = @DOCUMENTO AND CAJA = @CAJA AND TIPO = @TIPO

		SET @PARAMETROS = 
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
				'<DOCUMENTO_POS>' + 
				'<DOCUMENTO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@DOCUMENTO) + '</DOCUMENTO>' + 
				'<CAJA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CAJA) + '</CAJA>' + 
				'<TIPO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO) + '</TIPO>' + 
				'<PERFIL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@PERFIL) + '</PERFIL>' + 
				'<VENDEDOR Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@VENDEDOR) + '</VENDEDOR>' + 
				'<CLIENTE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CLIENTE) + '</CLIENTE>' + 
				'<NOMBRE_CLIENTE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOMBRE_CLIENTE) + '</NOMBRE_CLIENTE>' + 
				'<CAJERO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CAJERO) + '</CAJERO>' + 
				'<CAJA_COBRO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CAJA_COBRO) + '</CAJA_COBRO>' + 
				'<IMPUESTO1 Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@IMPUESTO1) + '</IMPUESTO1>' + 
				'<IMPUESTO2 Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@IMPUESTO2) + '</IMPUESTO2>' + 
				'<DESCUENTO Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@DESCUENTO) + '</DESCUENTO>' + 
				'<TOTAL_PAGAR Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@TOTAL_PAGAR) + '</TOTAL_PAGAR>' + 
				'<TOTAL Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@TOTAL) + '</TOTAL>' + 
				'<FCH_HORA_CREACION Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FCH_HORA_CREACION) + '</FCH_HORA_CREACION>' + 
				'<FCH_HORA_COBRO Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FCH_HORA_COBRO) + '</FCH_HORA_COBRO>' + 
				'<FCH_HORA_ANULA Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FCH_HORA_ANULA) + '</FCH_HORA_ANULA>' +
				'<SALDO Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@SALDO) + '</SALDO>' + 
				'<FECHA_VENCE Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_VENCE) + '</FECHA_VENCE>' + 
				'<LISTO_INVENTARIO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@LISTO_INVENTARIO) + '</LISTO_INVENTARIO>' + 
				'<NIVEL_PRECIO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NIVEL_PRECIO) + '</NIVEL_PRECIO>' + 
				'<MONEDA_NIVEL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@MONEDA_NIVEL) + '</MONEDA_NIVEL>' + 
				'<VERSION Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@VERSION) + '</VERSION>' + 
				'<FECHANAC_CLIENTE Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHANAC_CLIENTE) + '</FECHANAC_CLIENTE>' + 
				'<TELEFONO_CLIENTE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TELEFONO_CLIENTE) + '</TELEFONO_CLIENTE>' + 
				'<NIT_CLIENTE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NIT_CLIENTE) + '</NIT_CLIENTE>' + 
				'<NOTAS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOTAS) + '</NOTAS>' + 
				'<PAIS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@PAIS) + '</PAIS>' + 
				'<CLASE_DOCUMENTO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CLASE_DOCUMENTO) + '</CLASE_DOCUMENTO>' + 
				'<CONDICION_PAGO_APA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CONDICION_PAGO_APA) + '</CONDICION_PAGO_APA>' +
				'<DEVUELVE_DINERO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DEVUELVE_DINERO) + '</DEVUELVE_DINERO>' + 
				'<DIRECCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DIRECCION) + '</DIRECCION>' + 
				'<EFECTIVO_DEVUELTO Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@EFECTIVO_DEVUELTO) + '</EFECTIVO_DEVUELTO>' + 
				'<TIPO_CAMBIO Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@TIPO_CAMBIO) + '</TIPO_CAMBIO>' + 
				'<BENEFICIARIO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@BENEFICIARIO) + '</BENEFICIARIO>' + 
				'<MONEDA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@MONEDA) + '</MONEDA>' + 
				'<SUBTIPO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@SUBTIPO) + '</SUBTIPO>' + 
				'<ID_BENEFICIARIO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ID_BENEFICIARIO) + '</ID_BENEFICIARIO>' + 
				'<USUARIO_ULT_IMPRE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USUARIO_ULT_IMPRE) + '</USUARIO_ULT_IMPRE>' + 
				'<FCH_HORA_ULT_IMPRE Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FCH_HORA_ULT_IMPRE) + '</FCH_HORA_ULT_IMPRE>' + 
				'<USUARIO_APLICACION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USUARIO_APLICACION) + '</USUARIO_APLICACION>' + 
				'<FCH_HORA_APLICACIO Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FCH_HORA_APLICACIO) + '</FCH_HORA_APLICACIO>' + 
				'<USUARIO_ANULACION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USUARIO_ANULACION) + '</USUARIO_ANULACION>' + 
				'<ESTADO_IMPRESION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ESTADO_IMPRESION) + '</ESTADO_IMPRESION>' + 
				'<TELEFONO_BENEFICIA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TELEFONO_BENEFICIA) + '</TELEFONO_BENEFICIA>' + 				
				'<SALDO_REPORTE Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@SALDO_REPORTE) + '</SALDO_REPORTE>' + 
				'<MONEDA_DOC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@MONEDA_DOC) + '</MONEDA_DOC>' + 
				'<NCF Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NCF) + '</NCF>' + 
				'<TIPO_NCF Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_NCF) + '</TIPO_NCF>' + 
				'<NUM_CIERRE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NUM_CIERRE) + '</NUM_CIERRE>' + 
				'<CORRELATIVO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CORRELATIVO) + '</CORRELATIVO>' +
				'<RECIBIDO_DE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@RECIBIDO_DE) + '</RECIBIDO_DE>' + 
				'<RESOLUCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@RESOLUCION) + '</RESOLUCION>' + 
				'<COD_CLASE_DOC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@COD_CLASE_DOC) + '</COD_CLASE_DOC>' + 
				'<DOC_EXPRESS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DOC_EXPRESS) + '</DOC_EXPRESS>' + 
				'<MENSAJERO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@MENSAJERO) + '</MENSAJERO>' + 
				'<CLIENTE_EXPRESS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CLIENTE_EXPRESS) + '</CLIENTE_EXPRESS>' + 
				'<ENTREGA_EXPRSS_A Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ENTREGA_EXPRSS_A) + '</ENTREGA_EXPRSS_A>' + 
				'<MONTO_ENTREGADO Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@MONTO_ENTREGADO) + '</MONTO_ENTREGADO>' + 
				'<MONTO_DEVUELTO Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@MONTO_DEVUELTO) + '</MONTO_DEVUELTO>' + 
				'<FCH_ENVIO Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FCH_ENVIO) + '</FCH_ENVIO>' + 
				'<FCH_ENTREGA Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FCH_ENTREGA) + '</FCH_ENTREGA>' + 
				'<MOTIV_CANCELA_EXPR Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@MOTIV_CANCELA_EXPR) + '</MOTIV_CANCELA_EXPR>' + 
				'<NOTA_EXPRESS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOTA_EXPRESS) + '</NOTA_EXPRESS>' + 
				'<BASE_IMPUESTO1 Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@BASE_IMPUESTO1) + '</BASE_IMPUESTO1>' + 
				'<BASE_IMPUESTO2 Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@BASE_IMPUESTO2) + '</BASE_IMPUESTO2>' +
				'<ESTADO_EXPRESS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ESTADO_EXPRESS) + '</ESTADO_EXPRESS>' + 
			    	'<ESTADO_COBRO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ESTADO_COBRO) + '</ESTADO_COBRO>' +
			    	'<GENERO_FACTURA_INICIO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@GENERO_FACTURA_INICIO) + '</GENERO_FACTURA_INICIO>' + 
			    	'<DOC_FISCAL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DOC_FISCAL) + '</DOC_FISCAL>' + 
				'<PREFIJO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@PREFIJO) + '</PREFIJO>' + 
				'<PEDIDO_AUTORIZADO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@PEDIDO_AUTORIZADO) + '</PEDIDO_AUTORIZADO>'
				IF @OPERACION = 'INSERTA'
				BEGIN
					SET @PARAMETROS = @PARAMETROS + '<EXPORTADO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@EXPORTADO) + '</EXPORTADO>' + 
					'<DOC_CC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DOC_CC) + '</DOC_CC>' +
					'<TIPO_DOC_CC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_DOC_CC) + '</TIPO_DOC_CC>' + 
					'<CARGADO_CC Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CARGADO_CC) + '</CARGADO_CC>' + 
					'<CARGADO_CG Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CARGADO_CG) + '</CARGADO_CG>' +
					'<DOC_CC_ANUL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DOC_CC_ANUL) + '</DOC_CC_ANUL>' + 
					'<TIPO_DOC_CC_ANUL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_DOC_CC_ANUL) + '</TIPO_DOC_CC_ANUL>' + 
					'<AFECTA_CONTABIL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@AFECTA_CONTABIL) + '</AFECTA_CONTABIL>' +
					'<DOC_CC_ANTICIPO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DOC_CC_ANTICIPO) + '</DOC_CC_ANTICIPO>' +
					'<NOMBREMAQUINA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOMBREMAQUINA) + '</NOMBREMAQUINA>'
				END	
				SET @PARAMETROS = @PARAMETROS + '</DOCUMENTO_POS>'
			
				EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'DOCUMENTOPOSPOS600', @OPERACION, @PARAMETROS, 0, ''	

		FETCH NEXT FROM C_INSERTED INTO
		@DOCUMENTO, @CAJA, @TIPO, @PERFIL, @VENDEDOR, @CLIENTE, @NOMBRE_CLIENTE, @CAJERO, @CAJA_COBRO, @IMPUESTO1, @IMPUESTO2, @DESCUENTO, @TOTAL_PAGAR, @TOTAL, @FCH_HORA_CREACION, @FCH_HORA_COBRO, @FCH_HORA_ANULA, @EXPORTADO, @ESTADO_COBRO, @SALDO, @FECHA_VENCE, @LISTO_INVENTARIO, @NIVEL_PRECIO, @MONEDA_NIVEL, @VERSION, @FECHANAC_CLIENTE, @TELEFONO_CLIENTE, @NIT_CLIENTE, @PAIS, @CLASE_DOCUMENTO, @CONDICION_PAGO_APA, @DOC_CC, @TIPO_DOC_CC, @CARGADO_CC, @CARGADO_CG, @DEVUELVE_DINERO, @DOC_CC_ANUL, @TIPO_DOC_CC_ANUL, @GENERO_FACTURA_INICIO, @AFECTA_CONTABIL, @EFECTIVO_DEVUELTO, @TIPO_CAMBIO, @BENEFICIARIO, @MONEDA, @SUBTIPO, @ID_BENEFICIARIO, @USUARIO_ULT_IMPRE, @FCH_HORA_ULT_IMPRE, @USUARIO_APLICACION, @FCH_HORA_APLICACIO, @USUARIO_ANULACION, @ESTADO_IMPRESION, @TELEFONO_BENEFICIA,@SALDO_REPORTE,@MONEDA_DOC, @NCF, @TIPO_NCF, @NUM_CIERRE, @DIRECCION, @CORRELATIVO, @RECIBIDO_DE, @RESOLUCION, @COD_CLASE_DOC, @DOC_EXPRESS, @MENSAJERO, @CLIENTE_EXPRESS, @ENTREGA_EXPRSS_A, @ESTADO_EXPRESS, @MONTO_ENTREGADO, @MONTO_DEVUELTO, @FCH_ENVIO, @FCH_ENTREGA, @MOTIV_CANCELA_EXPR, @NOTA_EXPRESS, @BASE_IMPUESTO1, @BASE_IMPUESTO2, @DOC_FISCAL, @PREFIJO, @PEDIDO_AUTORIZADO, @DOC_CC_ANTICIPO 
	END
	CLOSE C_INSERTED
	DEALLOCATE C_INSERTED

	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para regenerar solicitudes Offline.',16,1 )
	END
END;






CREATE PROCEDURE $$Compania$$.REGENERA_DOC_POS_LINEA
	 @DOCUMENTOS VARCHAR(20),
	 @CAJAS VARCHAR(6),
	 @TIPOS VARCHAR(1),
	 @PUBLICADOR VARCHAR(20),
	 @INSERTA VARCHAR(1)	
AS
BEGIN
	DECLARE @ERROR INT	
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @LINEA VARCHAR(4)
	DECLARE @DOCUMENTO VARCHAR(20)
	DECLARE @CAJA VARCHAR(6)
	DECLARE @TIPO VARCHAR(1)
	DECLARE @ARTICULO VARCHAR(20)
	DECLARE @LOTE VARCHAR(15)
	DECLARE @CANTIDAD DECIMAL(28,8)
	DECLARE @PRECIO_VENTA DECIMAL(28,8)
	DECLARE @DESCUENTO_LINEA DECIMAL(28,8)
	DECLARE @DESCUENTO_GENERAL DECIMAL(28,8)
	DECLARE @TOTAL_IMPUESTO1 DECIMAL(28,8)
	DECLARE @TOTAL_IMPUESTO2 DECIMAL(28,8)
	DECLARE @LEYENDA VARCHAR(256)
	DECLARE @CANT_RESERVADA_PED DECIMAL(28,8)
   	DECLARE @BODEGA VARCHAR(4)
   	DECLARE @PEDIDO VARCHAR(55)
	DECLARE @LOCALIZACION 	VARCHAR(8)
	DECLARE @BASE_IMPUESTO1	DECIMAL(28,8)
	DECLARE @BASE_IMPUESTO2	DECIMAL(28,8) 				
	DECLARE @NOTAS VARCHAR(4000)
	DECLARE @OPERACION VARCHAR(8)	

	IF @INSERTA = 'I'	
	BEGIN
	SET @OPERACION = 'INSERTA'
	END
	ELSE
	BEGIN
	SET @OPERACION = 'MODIFICA'
	END

	DECLARE C_INSERTED CURSOR LOCAL FOR
	SELECT LINEA, DOCUMENTO, CAJA, TIPO, ARTICULO, LOTE, CANTIDAD, PRECIO_VENTA, DESCUENTO_LINEA, DESCUENTO_GENERAL, TOTAL_IMPUESTO1, TOTAL_IMPUESTO2, LEYENDA, CANT_RESERVADA_PED, BODEGA, PEDIDO, LOCALIZACION, BASE_IMPUESTO1, BASE_IMPUESTO2, NOTAS
	FROM $$Compania$$.DOC_POS_LINEA
	WHERE DOCUMENTO = @DOCUMENTOS AND CAJA = @CAJAS AND TIPO = @TIPOS
		
	OPEN C_INSERTED	
	FETCH NEXT FROM C_INSERTED INTO
	@LINEA, @DOCUMENTO, @CAJA, @TIPO, @ARTICULO, @LOTE, @CANTIDAD, @PRECIO_VENTA, @DESCUENTO_LINEA, @DESCUENTO_GENERAL, @TOTAL_IMPUESTO1, @TOTAL_IMPUESTO2, @LEYENDA, @CANT_RESERVADA_PED, @BODEGA, @PEDIDO, @LOCALIZACION, @BASE_IMPUESTO1, @BASE_IMPUESTO2, @NOTAS
	SET @ERROR = 0
	WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
	BEGIN
		SET @PARAMETROS =
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<DOC_POS_LINEA>' +
				'<LINEA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@LINEA) + '</LINEA>' +
				'<DOCUMENTO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@DOCUMENTO) + '</DOCUMENTO>' +
				'<CAJA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CAJA) + '</CAJA>' +
				'<TIPO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO) + '</TIPO>' +
				'<ARTICULO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ARTICULO) + '</ARTICULO>' +
				'<LOTE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@LOTE) + '</LOTE>' +
				'<CANTIDAD Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@CANTIDAD) + '</CANTIDAD>' +
				'<PRECIO_VENTA Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@PRECIO_VENTA) + '</PRECIO_VENTA>' +
				'<DESCUENTO_LINEA Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@DESCUENTO_LINEA) + '</DESCUENTO_LINEA>' +
				'<DESCUENTO_GENERAL Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@DESCUENTO_GENERAL) + '</DESCUENTO_GENERAL>' +
				'<TOTAL_IMPUESTO1 Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@TOTAL_IMPUESTO1) + '</TOTAL_IMPUESTO1>' +
				'<TOTAL_IMPUESTO2 Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@TOTAL_IMPUESTO2) + '</TOTAL_IMPUESTO2>' +
				'<LEYENDA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@LEYENDA) + '</LEYENDA>' +
				'<CANT_RESERVADA_PED Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@CANT_RESERVADA_PED) + '</CANT_RESERVADA_PED>' +
				'<BODEGA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@BODEGA) + '</BODEGA>' +
				'<PEDIDO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@PEDIDO) + '</PEDIDO>' +
				'<LOCALIZACION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@LOCALIZACION) + '</LOCALIZACION>' +
				'<BASE_IMPUESTO1 Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@BASE_IMPUESTO1) + '</BASE_IMPUESTO1>' +
				'<BASE_IMPUESTO2 Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@BASE_IMPUESTO2) + '</BASE_IMPUESTO2>' +				
				'<NOTAS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOTAS) + '</NOTAS>' +
				'</DOC_POS_LINEA>'

				EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'DOCPOSLINEAPOS600', @OPERACION, @PARAMETROS, 0, ''
		
		FETCH NEXT FROM C_INSERTED INTO
		@LINEA, @DOCUMENTO, @CAJA, @TIPO, @ARTICULO, @LOTE, @CANTIDAD, @PRECIO_VENTA, @DESCUENTO_LINEA, @DESCUENTO_GENERAL, @TOTAL_IMPUESTO1, @TOTAL_IMPUESTO2, @LEYENDA, @CANT_RESERVADA_PED, @BODEGA, @PEDIDO, @LOCALIZACION, @BASE_IMPUESTO1, @BASE_IMPUESTO2, @NOTAS
	END
	CLOSE C_INSERTED
	DEALLOCATE C_INSERTED

	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para regenerar solicitudes Offline.',16,1 )
	END
END;





CREATE PROCEDURE $$Compania$$.REGENERA_ARTICULO_SERIE_POS
	 @DOCUMENTOS VARCHAR(20),
	 @CAJAS VARCHAR(6),
	 @TIPOS VARCHAR(1),
	 @PUBLICADOR VARCHAR(20),
	 @INSERTA VARCHAR(1)	
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @LINEA VARCHAR(4)
	DECLARE @DOCUMENTO VARCHAR(20)
	DECLARE @CAJA VARCHAR(6)
	DECLARE @TIPO VARCHAR(1)
	DECLARE @LINEA_SERIE INT
	DECLARE @ARTICULO VARCHAR(20)
	DECLARE @SERIE_INICIAL VARCHAR(20)
	DECLARE @SERIE_FINAL VARCHAR(20)
	DECLARE @CANTIDAD DECIMAL(28,8)
	DECLARE @CANT_RESERVADA_PED DECIMAL(28,8)	
	DECLARE @BODEGA VARCHAR(4) 		
	DECLARE @PEDIDO VARCHAR(20) 	
	DECLARE @OPERACION VARCHAR(8)	

	IF @INSERTA = 'I'	
	BEGIN
	SET @OPERACION = 'INSERTA'
	END
	ELSE
	BEGIN
	SET @OPERACION = 'MODIFICA'
	END

	DECLARE C_INSERTED CURSOR LOCAL FOR
	SELECT LINEA, DOCUMENTO, CAJA, TIPO, LINEA_SERIE, ARTICULO, SERIE_INICIAL, SERIE_FINAL, CANTIDAD, CANT_RESERVADA_PED, BODEGA, PEDIDO 
	FROM $$Compania$$.ARTICULO_SERIE_POS
	WHERE DOCUMENTO=@DOCUMENTOS AND CAJA = @CAJAS AND TIPO = @TIPOS
		
	OPEN C_INSERTED	
	FETCH NEXT FROM C_INSERTED INTO
	@LINEA, @DOCUMENTO, @CAJA, @TIPO, @LINEA_SERIE, @ARTICULO, @SERIE_INICIAL, @SERIE_FINAL, @CANTIDAD, @CANT_RESERVADA_PED, @BODEGA, @PEDIDO
	SET @ERROR = 0
	WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
	BEGIN
		SET @PARAMETROS =
			'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
			'<ARTICULO_SERIE_POS>' +
			'<LINEA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@LINEA) + '</LINEA>' +
			'<DOCUMENTO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@DOCUMENTO) + '</DOCUMENTO>' +
			'<CAJA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CAJA) + '</CAJA>' +
			'<TIPO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO) + '</TIPO>' +
			'<LINEA_SERIE Type="INT" PrimaryKey="True">' + ERPADMIN.POS_NumberToVarchar(@LINEA_SERIE) + '</LINEA_SERIE>' +
			'<ARTICULO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ARTICULO) + '</ARTICULO>' +
			'<SERIE_INICIAL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@SERIE_INICIAL) + '</SERIE_INICIAL>' +
			'<SERIE_FINAL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@SERIE_FINAL) + '</SERIE_FINAL>' +
			'<CANTIDAD Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@CANTIDAD) + '</CANTIDAD>' +
			'<CANT_RESERVADA_PED Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@CANT_RESERVADA_PED) + '</CANT_RESERVADA_PED>' +
			'<BODEGA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@BODEGA) + '</BODEGA>' +
			'<PEDIDO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@PEDIDO) + '</PEDIDO>' +
			'</ARTICULO_SERIE_POS>'
		
		 EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'ARTICULOSERIEPOSPOS600', @OPERACION, @PARAMETROS, 0, ''
	
		FETCH NEXT FROM C_INSERTED INTO
		@LINEA, @DOCUMENTO, @CAJA, @TIPO, @LINEA_SERIE, @ARTICULO, @SERIE_INICIAL, @SERIE_FINAL, @CANTIDAD, @CANT_RESERVADA_PED, @BODEGA, @PEDIDO
	END
	CLOSE C_INSERTED
	DEALLOCATE C_INSERTED

	END
	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla ARTICULO_SERIE_POS.',16,1 )
	
END;



CREATE PROCEDURE $$Compania$$.REGENERA_AUXILIAR_POS
	 @DOCUMENTOS VARCHAR(20),
	 @CAJAS VARCHAR(6),
	 @TIPOS VARCHAR(1),
	 @PUBLICADOR VARCHAR(20),
	 @INSERTA VARCHAR(1)
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @DOCUMENTO VARCHAR(20)
	DECLARE @CAJA VARCHAR(6)
	DECLARE @TIPO VARCHAR(1)
	DECLARE @DOCUM_APLICA VARCHAR(20)
	DECLARE @CAJA_DOCUM_APLICA VARCHAR(6)
	DECLARE @TIPO_APLICA VARCHAR(1)
	DECLARE @MONTO_APLICADO DECIMAL(28,8)
	DECLARE @CARGADO VARCHAR(1)
	DECLARE @FECHA_APLICACION DATETIME
	DECLARE @DOC_CC_APLICADO VARCHAR(50)
	DECLARE @TIPO_DOC_CC_APLICADO VARCHAR(3)
	DECLARE @CARGADO_CG VARCHAR(1)
	DECLARE @ASIENTO_APLICACION VARCHAR(10)
	DECLARE @OPERACION VARCHAR(8)	

	IF @INSERTA = 'I'	
	BEGIN
	SET @OPERACION = 'INSERTA'
	END
	ELSE
	BEGIN
	SET @OPERACION = 'MODIFICA'
	END

	DECLARE C_INSERTED CURSOR LOCAL FOR
	SELECT DOCUMENTO, CAJA, TIPO, DOCUM_APLICA, CAJA_DOCUM_APLICA, TIPO_APLICA, MONTO_APLICADO, CARGADO, FECHA_APLICACION, DOC_CC_APLICADO, TIPO_DOC_CC_APLICADO, CARGADO_CG, ASIENTO_APLICACION 
	FROM $$Compania$$.AUXILIAR_POS
	WHERE (DOCUMENTO=@DOCUMENTOS AND CAJA = @CAJAS AND TIPO = @TIPOS) OR (DOCUM_APLICA=@DOCUMENTOS AND CAJA_DOCUM_APLICA = @CAJAS AND TIPO_APLICA = @TIPOS)
		
	OPEN C_INSERTED	
	FETCH NEXT FROM C_INSERTED INTO
	@DOCUMENTO, @CAJA, @TIPO, @DOCUM_APLICA, @CAJA_DOCUM_APLICA, @TIPO_APLICA,  @MONTO_APLICADO, @CARGADO, @FECHA_APLICACION, @DOC_CC_APLICADO, @TIPO_DOC_CC_APLICADO, @CARGADO_CG, @ASIENTO_APLICACION 
	SET @ERROR = 0
	WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
	BEGIN
		SET @PARAMETROS = 
			'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
			'<AUXILIAR_POS>' +
			'<DOCUMENTO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@DOCUMENTO) + '</DOCUMENTO>' +
			'<CAJA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CAJA) + '</CAJA>' +
			'<TIPO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO) + '</TIPO>' +
			'<DOCUM_APLICA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@DOCUM_APLICA) + '</DOCUM_APLICA>' +
			'<CAJA_DOCUM_APLICA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CAJA_DOCUM_APLICA) + '</CAJA_DOCUM_APLICA>' +
			'<TIPO_APLICA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_APLICA) + '</TIPO_APLICA>' +
			'<MONTO_APLICADO Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@MONTO_APLICADO) + '</MONTO_APLICADO>' +
			'<FECHA_APLICACION Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_APLICACION) + '</FECHA_APLICACION>' 
			IF @OPERACION = 'INSERTA'
			BEGIN
				SET @PARAMETROS = @PARAMETROS +	'<CARGADO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CARGADO) + '</CARGADO>' +
				'<DOC_CC_APLICADO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DOC_CC_APLICADO) + '</DOC_CC_APLICADO>' +
				'<TIPO_DOC_CC_APLICADO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_DOC_CC_APLICADO) + '</TIPO_DOC_CC_APLICADO>' +
				'<CARGADO_CG Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CARGADO_CG) + '</CARGADO_CG>' +
				'<ASIENTO_APLICACION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ASIENTO_APLICACION) + '</ASIENTO_APLICACION>'
			END
			SET @PARAMETROS = @PARAMETROS +	'</AUXILIAR_POS>'

			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'AUXILIARPOSPOS600', @OPERACION, @PARAMETROS, 0, ''	

	FETCH NEXT FROM C_INSERTED INTO
		@DOCUMENTO, @CAJA, @TIPO, @DOCUM_APLICA, @CAJA_DOCUM_APLICA, @TIPO_APLICA,  @MONTO_APLICADO, @CARGADO, @FECHA_APLICACION, @DOC_CC_APLICADO, @TIPO_DOC_CC_APLICADO, @CARGADO_CG, @ASIENTO_APLICACION 
	END
	CLOSE C_INSERTED
	DEALLOCATE C_INSERTED

	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para regenerar solicitudes Offline.',16,1 )
	END
END;





CREATE PROCEDURE $$Compania$$.REGENERA_PAGO_POS
	 @DOCUMENTOS VARCHAR(20),
	 @CAJAS VARCHAR(6),
	 @TIPOS VARCHAR(1),
	 @PUBLICADOR VARCHAR(20),
	 @INSERTA VARCHAR(1)	
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @PAGO VARCHAR(4)
	DECLARE @CAJA VARCHAR(6)
	DECLARE @DOCUMENTO VARCHAR(20)
	DECLARE @TIPO VARCHAR(1)
	DECLARE @CONDICION_PAGO VARCHAR(4)
	DECLARE @ENTIDAD_FINANCIERA VARCHAR(8)
	DECLARE @TIPO_TARJETA VARCHAR(80)
	DECLARE @FORMA_PAGO VARCHAR(4)
	DECLARE @NUMERO VARCHAR(20)
	DECLARE @MONTO_LOCAL DECIMAL(28,8)
	DECLARE @MONTO_DOLAR DECIMAL(28,8)
	DECLARE @AUTORIZACION VARCHAR(80)
	DECLARE @FECHA_EXPIRACION VARCHAR(5)
	DECLARE @COBRO INT	
	DECLARE @CLIENTE_LIQUIDADOR VARCHAR(20)
	DECLARE @TIPO_COBRO VARCHAR(1)
	DECLARE @OPERACION VARCHAR(8)	

	IF @INSERTA = 'I'	
	BEGIN
	SET @OPERACION = 'INSERTA'
	END
	ELSE
	BEGIN
	SET @OPERACION = 'MODIFICA'
	END

	DECLARE C_INSERTED CURSOR LOCAL FOR
	SELECT PAGO, CAJA, DOCUMENTO, TIPO, CONDICION_PAGO, ENTIDAD_FINANCIERA, TIPO_TARJETA, FORMA_PAGO, NUMERO, MONTO_LOCAL, MONTO_DOLAR, AUTORIZACION, FECHA_EXPIRACION, COBRO, CLIENTE_LIQUIDADOR, TIPO_COBRO
	FROM $$Compania$$.PAGO_POS
	WHERE DOCUMENTO=@DOCUMENTOS AND CAJA = @CAJAS AND TIPO = @TIPOS
		
	OPEN C_INSERTED	
	FETCH NEXT FROM C_INSERTED INTO
	@PAGO, @CAJA, @DOCUMENTO, @TIPO, @CONDICION_PAGO, @ENTIDAD_FINANCIERA, @TIPO_TARJETA, @FORMA_PAGO, @NUMERO, @MONTO_LOCAL, @MONTO_DOLAR, @AUTORIZACION, @FECHA_EXPIRACION, @COBRO, @CLIENTE_LIQUIDADOR, @TIPO_COBRO
	SET @ERROR = 0

	WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
	BEGIN
		SET @PARAMETROS =
				'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
				'<PAGO_POS>' +
				'<PAGO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@PAGO) + '</PAGO>' +
				'<CAJA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CAJA) + '</CAJA>' +
				'<DOCUMENTO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@DOCUMENTO) + '</DOCUMENTO>' +
				'<TIPO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO) + '</TIPO>' +
				'<CONDICION_PAGO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CONDICION_PAGO) + '</CONDICION_PAGO>' +
				'<ENTIDAD_FINANCIERA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ENTIDAD_FINANCIERA) + '</ENTIDAD_FINANCIERA>' +
				'<TIPO_TARJETA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_TARJETA) + '</TIPO_TARJETA>' +
				'<FORMA_PAGO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@FORMA_PAGO) + '</FORMA_PAGO>' +
				'<NUMERO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NUMERO) + '</NUMERO>' +
				'<MONTO_LOCAL Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@MONTO_LOCAL) + '</MONTO_LOCAL>' +
				'<MONTO_DOLAR Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@MONTO_DOLAR) + '</MONTO_DOLAR>' +
				'<AUTORIZACION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@AUTORIZACION) + '</AUTORIZACION>' +
				'<FECHA_EXPIRACION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@FECHA_EXPIRACION) + '</FECHA_EXPIRACION>' +
				'<COBRO Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@COBRO) + '</COBRO>' +
				'<CLIENTE_LIQUIDADOR Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CLIENTE_LIQUIDADOR) + '</CLIENTE_LIQUIDADOR>' +
				'<TIPO_COBRO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_COBRO) + '</TIPO_COBRO>' +
				'</PAGO_POS>'

			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'PAGOPOSPOS600', @OPERACION, @PARAMETROS, 0, ''	

		FETCH NEXT FROM C_INSERTED INTO
		@PAGO, @CAJA, @DOCUMENTO, @TIPO, @CONDICION_PAGO, @ENTIDAD_FINANCIERA, @TIPO_TARJETA, @FORMA_PAGO, @NUMERO, @MONTO_LOCAL, @MONTO_DOLAR, @AUTORIZACION, @FECHA_EXPIRACION, @COBRO, @CLIENTE_LIQUIDADOR, @TIPO_COBRO
	END
	CLOSE C_INSERTED
	DEALLOCATE C_INSERTED

	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para regenerar solicitudes Offline.',16,1 )
	END
END;






CREATE PROCEDURE $$Compania$$.REGENERA_INFO_DOC_SEGURO
	 @DOCUMENTOS VARCHAR(20),
	 @CAJAS VARCHAR(6),
	 @TIPOS VARCHAR(1),
	 @PUBLICADOR VARCHAR(20),
	 @INSERTA VARCHAR(1)	
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @ASEGURADORA VARCHAR(20)
	DECLARE @AFILIADO VARCHAR(20)
	DECLARE @DOCUMENTO VARCHAR(20)
	DECLARE @CAJA VARCHAR(6)
	DECLARE @TIPO VARCHAR(1)
	DECLARE @PAGO VARCHAR(4)
	DECLARE @CENTRO_MEDICO VARCHAR(80)
	DECLARE @DIAGNOSTICO VARCHAR(254)
	DECLARE @MEDICO VARCHAR(80)
	DECLARE @ESPECIALIDAD VARCHAR(80)
	DECLARE @CONTRATO VARCHAR(80)
	DECLARE @OPERACION VARCHAR(8)	

	IF @INSERTA = 'I'	
	BEGIN
	SET @OPERACION = 'INSERTA'
	END
	ELSE
	BEGIN
	SET @OPERACION = 'MODIFICA'
	END

	DECLARE C_INSERTED CURSOR LOCAL FOR
	SELECT ASEGURADORA, AFILIADO, DOCUMENTO, CAJA, TIPO, PAGO, CENTRO_MEDICO, DIAGNOSTICO, MEDICO, ESPECIALIDAD, CONTRATO
	FROM $$Compania$$.INFO_DOC_SEGURO
	WHERE DOCUMENTO=@DOCUMENTOS AND CAJA = @CAJAS AND TIPO = @TIPOS
		
	OPEN C_INSERTED	
	FETCH NEXT FROM C_INSERTED INTO
	@ASEGURADORA, @AFILIADO, @DOCUMENTO, @CAJA, @TIPO, @PAGO, @CENTRO_MEDICO, @DIAGNOSTICO, @MEDICO, @ESPECIALIDAD, @CONTRATO

	SET @ERROR = 0
	WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
	BEGIN
		SET @PARAMETROS = 
			'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
			'<INFO_DOC_SEGURO>' + 
			'<ASEGURADORA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@ASEGURADORA) + '</ASEGURADORA>' + 
			'<AFILIADO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@AFILIADO) + '</AFILIADO>' + 
			'<DOCUMENTO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DOCUMENTO) + '</DOCUMENTO>' + 
			'<CAJA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CAJA) + '</CAJA>' + 
			'<TIPO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO) + '</TIPO>' + 
			'<PAGO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@PAGO) + '</PAGO>' + 
			'<CENTRO_MEDICO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CENTRO_MEDICO) + '</CENTRO_MEDICO>' + 
			'<DIAGNOSTICO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DIAGNOSTICO) + '</DIAGNOSTICO>' + 
			'<MEDICO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@MEDICO) + '</MEDICO>' + 
			'<ESPECIALIDAD Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ESPECIALIDAD) + '</ESPECIALIDAD>' + 
			'<CONTRATO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CONTRATO) + '</CONTRATO>' + 
			'</INFO_DOC_SEGURO>'

			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'INFODOCSEGUROPOSPOS600600', @OPERACION, @PARAMETROS, 0, ''

		FETCH NEXT FROM C_INSERTED INTO
		@ASEGURADORA, @AFILIADO, @DOCUMENTO, @CAJA, @TIPO, @PAGO, @CENTRO_MEDICO, @DIAGNOSTICO, @MEDICO, @ESPECIALIDAD, @CONTRATO
	END

	CLOSE C_INSERTED
	DEALLOCATE C_INSERTED

	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla INFO_DOC_SEGURO.',16,1 )
	END
END;





CREATE PROCEDURE  $$Compania$$.REGENERA_AFILIADO
	 @PUBLICADOR VARCHAR(20),
	 @INSERTA VARCHAR(1)	 
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @ASEGURADORA VARCHAR(20)
	DECLARE @AFILIADO VARCHAR(20)
	DECLARE @NOMBRE VARCHAR(80)
	DECLARE @CEDULA VARCHAR(6)
	DECLARE @TELEFONO VARCHAR(15)
	DECLARE @OPERACION VARCHAR(8)	

	IF @INSERTA = 'I'	
	BEGIN
	SET @OPERACION = 'INSERTA'
	END
	ELSE
	BEGIN
	SET @OPERACION = 'MODIFICA'
	END

	DECLARE C_INSERTED CURSOR LOCAL FOR
	SELECT ASEGURADORA, AFILIADO, NOMBRE, CEDULA, TELEFONO
	FROM $$Compania$$.AFILIADO
	
	OPEN C_INSERTED	
	FETCH NEXT FROM C_INSERTED INTO
	@ASEGURADORA, @AFILIADO, @NOMBRE, @CEDULA, @TELEFONO

	SET @ERROR = 0
	WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
	BEGIN
		SET @PARAMETROS = 
			'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
			'<AFILIADO>' + 
			'<ASEGURADORA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@ASEGURADORA) + '</ASEGURADORA>' + 
			'<AFILIADO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@AFILIADO) + '</AFILIADO>' + 
			'<NOMBRE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOMBRE) + '</NOMBRE>' + 
			'<CEDULA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CEDULA) + '</CEDULA>' + 
			'<TELEFONO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TELEFONO) + '</TELEFONO>' + 
			'</AFILIADO>'

		EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'AFILIADOPOS600', @OPERACION, @PARAMETROS, 0, ''

		FETCH NEXT FROM C_INSERTED INTO
		@ASEGURADORA, @AFILIADO, @NOMBRE, @CEDULA, @TELEFONO
		END

		CLOSE C_INSERTED
    	DEALLOCATE C_INSERTED
	
	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla AFILIADO.',16,1 )
	END
END;






CREATE PROCEDURE $$Compania$$.REGENERA_GRUPO
	 @PUBLICADOR VARCHAR(20)
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @GRUPO VARCHAR(6)
	DECLARE @DESCRIPCION VARCHAR(40)
	DECLARE @SUCURSAL VARCHAR(1)
	DECLARE @LINEA_SUPERIOR1 VARCHAR(254)
	DECLARE @LINEA_SUPERIOR2 VARCHAR(254)
	DECLARE @LINEA_SUPERIOR3 VARCHAR(254)
	DECLARE @LINEA_SUPERIOR4 VARCHAR(254)
	DECLARE @LINEA_INFERIOR1 VARCHAR(254)
	DECLARE @LINEA_INFERIOR2 VARCHAR(254)
	DECLARE @LINEA_INFERIOR3 VARCHAR(254)
	DECLARE @LINEA_INFERIOR4 VARCHAR(254)
	DECLARE @ULT_CIERRE INT
	DECLARE @FECHA DATETIME
	DECLARE @ABONO_APRT_VENCIDO VARCHAR(1)
	DECLARE @NIVEL_PRECIO VARCHAR(12)
	DECLARE @MONEDA_NIVEL VARCHAR(1)
	DECLARE @CADENA VARCHAR(20)
	DECLARE @CONSECUTIVO_CI VARCHAR(10)
	DECLARE @CONSEC_CIERRE VARCHAR(20)
	DECLARE @TIPO_SITIO_LOCAL VARCHAR(1)
	DECLARE @NCF_UNICO VARCHAR(20) 

	DECLARE C_INSERTED CURSOR LOCAL FOR
	SELECT GRUPO, DESCRIPCION, SUCURSAL, LINEA_SUPERIOR1, LINEA_SUPERIOR2, LINEA_SUPERIOR3, LINEA_SUPERIOR4, LINEA_INFERIOR1, LINEA_INFERIOR2, LINEA_INFERIOR3, LINEA_INFERIOR4, ULT_CIERRE, FECHA, ABONO_APRT_VENCIDO, NIVEL_PRECIO, MONEDA_NIVEL, CADENA, CONSECUTIVO_CI, CONSEC_CIERRE, NCF_UNICO
	FROM $$Compania$$.GRUPO

	OPEN C_INSERTED	
	FETCH NEXT FROM C_INSERTED INTO
	@GRUPO, @DESCRIPCION, @SUCURSAL, @LINEA_SUPERIOR1, @LINEA_SUPERIOR2, @LINEA_SUPERIOR3, @LINEA_SUPERIOR4, @LINEA_INFERIOR1, @LINEA_INFERIOR2, @LINEA_INFERIOR3, @LINEA_INFERIOR4, @ULT_CIERRE, @FECHA, @ABONO_APRT_VENCIDO, @NIVEL_PRECIO, @MONEDA_NIVEL, @CADENA, @CONSECUTIVO_CI, @CONSEC_CIERRE, @NCF_UNICO
	SET @ERROR = 0
	WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
	BEGIN
		SET @PARAMETROS = 
			'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
			'<GRUPO>' + 
			'<GRUPO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@GRUPO) + '</GRUPO>' + 
			'<DESCRIPCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DESCRIPCION) + '</DESCRIPCION>' + 
			'<SUCURSAL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@SUCURSAL) + '</SUCURSAL>' + 
			'<LINEA_SUPERIOR1 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@LINEA_SUPERIOR1) + '</LINEA_SUPERIOR1>' + 
			'<LINEA_SUPERIOR2 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@LINEA_SUPERIOR2) + '</LINEA_SUPERIOR2>' + 
			'<LINEA_SUPERIOR3 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@LINEA_SUPERIOR3) + '</LINEA_SUPERIOR3>' + 
			'<LINEA_SUPERIOR4 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@LINEA_SUPERIOR4) + '</LINEA_SUPERIOR4>' + 
			'<LINEA_INFERIOR1 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@LINEA_INFERIOR1) + '</LINEA_INFERIOR1>' + 
			'<LINEA_INFERIOR2 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@LINEA_INFERIOR2) + '</LINEA_INFERIOR2>' + 
			'<LINEA_INFERIOR3 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@LINEA_INFERIOR3) + '</LINEA_INFERIOR3>' + 
			'<LINEA_INFERIOR4 Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@LINEA_INFERIOR4) + '</LINEA_INFERIOR4>' + 
			'<ULT_CIERRE Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@ULT_CIERRE) + '</ULT_CIERRE>' + 
			'<FECHA Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA) + '</FECHA>' + 
			'<ABONO_APRT_VENCIDO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ABONO_APRT_VENCIDO) + '</ABONO_APRT_VENCIDO>' + 
			'<NIVEL_PRECIO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NIVEL_PRECIO) + '</NIVEL_PRECIO>' + 
			'<MONEDA_NIVEL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@MONEDA_NIVEL) + '</MONEDA_NIVEL>' + 
			'<CADENA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CADENA) + '</CADENA>' + 
			'<CONSECUTIVO_CI Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CONSECUTIVO_CI) + '</CONSECUTIVO_CI>' + 
			'<CONSEC_CIERRE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CONSEC_CIERRE) + '</CONSEC_CIERRE>' + 
			'<NCF_UNICO	Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NCF_UNICO) + '</NCF_UNICO>' + 
			'</GRUPO>'

			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'GRUPOPOS600', 'MODIFICA', @PARAMETROS, 0, ''

		FETCH NEXT FROM C_INSERTED INTO
		@GRUPO, @DESCRIPCION, @SUCURSAL, @LINEA_SUPERIOR1, @LINEA_SUPERIOR2, @LINEA_SUPERIOR3, @LINEA_SUPERIOR4, @LINEA_INFERIOR1, @LINEA_INFERIOR2, @LINEA_INFERIOR3, @LINEA_INFERIOR4, @ULT_CIERRE, @FECHA, @ABONO_APRT_VENCIDO, @NIVEL_PRECIO, @MONEDA_NIVEL, @CADENA, @CONSECUTIVO_CI, @CONSEC_CIERRE, @NCF_UNICO
	END
	CLOSE C_INSERTED
	DEALLOCATE C_INSERTED
	
	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla GRUPO.',16,1 )
	END
END;





CREATE PROCEDURE $$Compania$$.REGENERA_CIERRE_TIENDA
	 @PUBLICADOR VARCHAR(20),
	 @INSERTA VARCHAR(1)
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @TIPO_SITIO_LOCAL VARCHAR(1)
	DECLARE @GRUPO VARCHAR(6)
	DECLARE @NUM_CIERRE INT
	DECLARE @FECHA_INICIO DATETIME
	DECLARE @FECHA_FIN DATETIME
	DECLARE @USUARIO VARCHAR(30)
	DECLARE @DESCUENTO_LINEA DECIMAL(28,8)
	DECLARE @DESCUENTO_GENERAL DECIMAL(28,8)
	DECLARE @IMPUESTO1 DECIMAL(28,8)
	DECLARE @IMPUESTO2 DECIMAL(28,8)
	DECLARE @TOTAL DECIMAL(28,8)
	DECLARE @TOTAL_PAGAR DECIMAL(28,8)
	DECLARE @PREFIJO VARCHAR(20)
	DECLARE @NCF VARCHAR(20)
	DECLARE @OPERACION VARCHAR(8)	

	IF @INSERTA = 'I'	
	BEGIN
	SET @OPERACION = 'INSERTA'
	END
	ELSE
	BEGIN
	SET @OPERACION = 'MODIFICA'
	END
	
	DECLARE C_INSERTED CURSOR LOCAL FOR
	SELECT GRUPO, NUM_CIERRE, FECHA_INICIO, FECHA_FIN, USUARIO, DESCUENTO_LINEA, DESCUENTO_GENERAL, IMPUESTO1, IMPUESTO2, TOTAL, TOTAL_PAGAR, PREFIJO, NCF 
	FROM $$Compania$$.CIERRE_TIENDA
			
	OPEN C_INSERTED	
	FETCH NEXT FROM C_INSERTED INTO
	@GRUPO, @NUM_CIERRE, @FECHA_INICIO, @FECHA_FIN, @USUARIO, @DESCUENTO_LINEA, @DESCUENTO_GENERAL, @IMPUESTO1, @IMPUESTO2, @TOTAL, @TOTAL_PAGAR, @PREFIJO, @NCF 

	SET @ERROR = 0
	WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
	BEGIN
		SET @PARAMETROS =
			'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
			'<CIERRE_TIENDA>' +
			'<GRUPO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@GRUPO) + '</GRUPO>' +
			'<NUM_CIERRE Type="INT" PrimaryKey="True">' + ERPADMIN.POS_NumberToVarchar(@NUM_CIERRE) + '</NUM_CIERRE>' +
			'<FECHA_INICIO Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_INICIO) + '</FECHA_INICIO>' +
			'<FECHA_FIN Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_FIN) + '</FECHA_FIN>' +
			'<USUARIO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@USUARIO) + '</USUARIO>' +
			'<DESCUENTO_LINEA Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@DESCUENTO_LINEA) + '</DESCUENTO_LINEA>' +
			'<DESCUENTO_GENERAL Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@DESCUENTO_GENERAL) + '</DESCUENTO_GENERAL>' +
			'<IMPUESTO1 Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@IMPUESTO1 ) + '</IMPUESTO1>' +
			'<IMPUESTO2 Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@IMPUESTO2) + '</IMPUESTO2>' +
			'<TOTAL Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@TOTAL) + '</TOTAL>' +
			'<TOTAL_PAGAR Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@TOTAL_PAGAR) + '</TOTAL_PAGAR>' +
			'<PREFIJO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@PREFIJO) + '</PREFIJO>' +
			'<NCF Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NCF) + '</NCF>' +
			'</CIERRE_TIENDA>'

			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'CIERRETIENDAPOS600', @OPERACION, @PARAMETROS, 0, ''

		FETCH NEXT FROM C_INSERTED INTO
		@GRUPO, @NUM_CIERRE, @FECHA_INICIO, @FECHA_FIN, @USUARIO, @DESCUENTO_LINEA, @DESCUENTO_GENERAL, @IMPUESTO1, @IMPUESTO2, @TOTAL, @TOTAL_PAGAR, @PREFIJO, @NCF 
	END
	CLOSE C_INSERTED
    DEALLOCATE C_INSERTED
	
	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla CIERRE_TIENDA.',16,1 )
	END
END;




CREATE PROCEDURE $$Compania$$.REGENERA_CIERRE_CAJA
	 @PUBLICADOR VARCHAR(20),
	 @INSERTA VARCHAR(1),
	 @NUM_CIERRE_CAJA VARCHAR(20)
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)	
	DECLARE @CAJA VARCHAR(6)
	DECLARE @FECHA_APERTURA DATETIME
	DECLARE @CAJERO_CIERRE VARCHAR(25)
	DECLARE @FECHA_CIERRE DATETIME
	DECLARE @ESTADO VARCHAR(1)
	DECLARE @FECHA_ANULACION DATETIME
	DECLARE @CAJERO_APERTURA VARCHAR(25)
	DECLARE @DOC_FISCAL VARCHAR(50)
	DECLARE @OPERACION VARCHAR(8)	

	IF @INSERTA = 'I'	
	BEGIN
	SET @OPERACION = 'INSERTA'
	END
	ELSE
	BEGIN
	SET @OPERACION = 'MODIFICA'
	END

	DECLARE C_INSERTED CURSOR LOCAL FOR
	SELECT NUM_CIERRE_CAJA, CAJA, FECHA_APERTURA, CAJERO_CIERRE, FECHA_CIERRE, ESTADO, FECHA_ANULACION, CAJERO_APERTURA, DOC_FISCAL
	FROM $$Compania$$.CIERRE_CAJA
	WHERE NUM_CIERRE_CAJA = @NUM_CIERRE_CAJA
		
	OPEN C_INSERTED	
	FETCH NEXT FROM C_INSERTED INTO
	@NUM_CIERRE_CAJA, @CAJA, @FECHA_APERTURA, @CAJERO_CIERRE, @FECHA_CIERRE, @ESTADO, @FECHA_ANULACION, @CAJERO_APERTURA, @DOC_FISCAL 

	SET @ERROR = 0
	WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
	BEGIN
		SET @PARAMETROS = 
			'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
			'<CIERRE_CAJA>' + 
			'<NUM_CIERRE_CAJA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@NUM_CIERRE_CAJA) + '</NUM_CIERRE_CAJA>' + 
			'<CAJA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CAJA) + '</CAJA>' + 
			'<FECHA_APERTURA Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_APERTURA) + '</FECHA_APERTURA>' + 
			'<CAJERO_CIERRE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CAJERO_CIERRE) + '</CAJERO_CIERRE>' + 
			'<FECHA_CIERRE Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_CIERRE) + '</FECHA_CIERRE>' + 
			'<FECHA_ANULACION Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_ANULACION) + '</FECHA_ANULACION>' + 
			'<CAJERO_APERTURA  Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CAJERO_APERTURA ) + '</CAJERO_APERTURA>' + 
			'<ESTADO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ESTADO) + '</ESTADO>' +
			'<DOC_FISCAL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DOC_FISCAL) + '</DOC_FISCAL>' +
			'</CIERRE_CAJA>'

			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'CIERRECAJAPOS600', @OPERACION, @PARAMETROS, 0, ''
	
		FETCH NEXT FROM C_INSERTED INTO
		@NUM_CIERRE_CAJA, @CAJA, @FECHA_APERTURA, @CAJERO_CIERRE, @FECHA_CIERRE, @ESTADO, @FECHA_ANULACION, @CAJERO_APERTURA, @DOC_FISCAL 
	END

	CLOSE C_INSERTED
	DEALLOCATE C_INSERTED
	
	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla CIERRE_CAJA.',16,1 )
	END
END;





CREATE PROCEDURE $$Compania$$.REGENERA_CIERRE_DESG_TARJ
	 @PUBLICADOR VARCHAR(20),
	 @INSERTA VARCHAR(1), 
	 @CAJA VARCHAR(6), 
	 @NUM_CIERRE  VARCHAR(20), 
	 @CAJERO VARCHAR(25)
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @CONSECUTIVO INT
	DECLARE @TIPO_TARJETA VARCHAR(12)
	DECLARE @DOCUMENTO VARCHAR(20)
	DECLARE @TIPO VARCHAR(1)
	DECLARE @AUTORIZACION VARCHAR(16)
	DECLARE @MONTO DECIMAL(28,8)
	DECLARE @TIPO_SITIO_LOCAL VARCHAR(1)
    DECLARE @OPERACION VARCHAR(8)	
		
	IF @INSERTA = 'I'	
	BEGIN
	SET @OPERACION = 'INSERTA'
	END
	ELSE
	BEGIN
	SET @OPERACION = 'MODIFICA'
	END
	
	DECLARE C_INSERTED CURSOR LOCAL FOR
	SELECT CONSECUTIVO, CAJA, TIPO_TARJETA, DOCUMENTO, TIPO, AUTORIZACION, MONTO, NUM_CIERRE, CAJERO
	FROM $$Compania$$.CIERRE_DESG_TARJ
	WHERE NUM_CIERRE = @NUM_CIERRE
	AND CAJERO = @CAJERO
	AND CAJA = @CAJA
		
	OPEN C_INSERTED	
	FETCH NEXT FROM C_INSERTED INTO
	@CONSECUTIVO, @CAJA, @TIPO_TARJETA, @DOCUMENTO, @TIPO, @AUTORIZACION, @MONTO, @NUM_CIERRE, @CAJERO

	SET @ERROR = 0
	WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
	BEGIN
		SET @PARAMETROS = 
			'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
			'<CIERRE_DESG_TARJ>' + 
			'<CONSECUTIVO Type="INT" PrimaryKey="True">' + ERPADMIN.POS_NumberToVarchar(@CONSECUTIVO) + '</CONSECUTIVO>' + 
			'<CAJA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CAJA) + '</CAJA>' + 
			'<TIPO_TARJETA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_TARJETA) + '</TIPO_TARJETA>' + 
			'<DOCUMENTO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DOCUMENTO) + '</DOCUMENTO>' + 
			'<TIPO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO) + '</TIPO>' + 
			'<AUTORIZACION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@AUTORIZACION) + '</AUTORIZACION>' + 
			'<MONTO Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@MONTO) + '</MONTO>' + 
			'<NUM_CIERRE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NUM_CIERRE) + '</NUM_CIERRE>' + 
			'<CAJERO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CAJERO) + '</CAJERO>' + 
			'</CIERRE_DESG_TARJ>'

		-- Inserta la solicitud correspondiente
		EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'CIERREDESGTARJPOS600', @OPERACION, @PARAMETROS, 0, ''

		FETCH NEXT FROM C_INSERTED INTO
		@CONSECUTIVO, @CAJA, @TIPO_TARJETA, @DOCUMENTO, @TIPO, @AUTORIZACION, @MONTO, @NUM_CIERRE, @CAJERO
	END

	CLOSE C_INSERTED
		DEALLOCATE C_INSERTED

	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla CIERRE_DESG_TARJ.',16,1 )
	END
END;






CREATE PROCEDURE $$Compania$$.REGENERA_CIERRE_DET_PAGO
	 @PUBLICADOR VARCHAR(20),
	 @INSERTA VARCHAR(1), 
	 @CAJA VARCHAR(6), 
	 @NUM_CIERRE  VARCHAR(20), 
	 @CAJERO VARCHAR(25)
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @TIPO_PAGO VARCHAR(40)
	DECLARE @TOTAL_SISTEMA DECIMAL(28,8)
	DECLARE @TOTAL_USUARIO DECIMAL(28,8)
	DECLARE @DIFERENCIA DECIMAL(28,8)
	DECLARE @ORDEN INT
	DECLARE @TIPO_SITIO_LOCAL VARCHAR(1)
	DECLARE @OPERACION VARCHAR(8)	
	    
	IF @INSERTA = 'I'	
	BEGIN
	SET @OPERACION = 'INSERTA'
	END
	ELSE
	BEGIN
	SET @OPERACION = 'MODIFICA'
	END
	
	DECLARE C_INSERTED CURSOR LOCAL FOR
	SELECT CAJA, TIPO_PAGO, TOTAL_SISTEMA, TOTAL_USUARIO, DIFERENCIA, ORDEN, NUM_CIERRE, CAJERO
	FROM $$Compania$$.CIERRE_DET_PAGO
	WHERE NUM_CIERRE = @NUM_CIERRE
	AND CAJERO = @CAJERO
	AND CAJA = @CAJA
		
	OPEN C_INSERTED	
	FETCH NEXT FROM C_INSERTED INTO
	@CAJA, @TIPO_PAGO, @TOTAL_SISTEMA, @TOTAL_USUARIO, @DIFERENCIA, @ORDEN, @NUM_CIERRE, @CAJERO

	SET @ERROR = 0
	WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
	BEGIN
		SET @PARAMETROS = 
			'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
			'<CIERRE_DET_PAGO>' + 
			'<CAJA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CAJA) + '</CAJA>' + 
			'<TIPO_PAGO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_PAGO) + '</TIPO_PAGO>' + 
			'<TOTAL_SISTEMA Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@TOTAL_SISTEMA) + '</TOTAL_SISTEMA>' + 
			'<TOTAL_USUARIO Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@TOTAL_USUARIO) + '</TOTAL_USUARIO>' + 
			'<DIFERENCIA Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@DIFERENCIA) + '</DIFERENCIA>' + 
			'<ORDEN Type="INT" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@ORDEN) + '</ORDEN>' + 
			'<NUM_CIERRE Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@NUM_CIERRE) + '</NUM_CIERRE>' + 
			'<CAJERO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CAJERO) + '</CAJERO>' + 
			'</CIERRE_DET_PAGO>'


		-- Inserta la solicitud correspondiente
		EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'CIERREDETPAGOPOS600', @OPERACION, @PARAMETROS, 0, ''

		FETCH NEXT FROM C_INSERTED INTO
		@CAJA, @TIPO_PAGO, @TOTAL_SISTEMA, @TOTAL_USUARIO, @DIFERENCIA, @ORDEN, @NUM_CIERRE, @CAJERO
	END

	CLOSE C_INSERTED
		DEALLOCATE C_INSERTED

	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla CIERRE_DET_PAGO.',16,1 )
	END
END;






CREATE PROCEDURE $$Compania$$.REGENERA_CIERRE_POS
	 @PUBLICADOR VARCHAR(20),
	 @INSERTA VARCHAR(1), 
	 @CAJA VARCHAR(6), 
	 @NUM_CIERRE  VARCHAR(20), 
	 @CAJERO VARCHAR(25)
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @TIPO_CIERRE VARCHAR(1)
	DECLARE @NOMBRE_VENDEDOR VARCHAR(40)
	DECLARE @FECHA_HORA DATETIME
	DECLARE @TIPO_CAMBIO DECIMAL(28,8)
	DECLARE @MONTO_APERTURA DECIMAL(28,8)
	DECLARE @TOTAL_DIFERENCIA DECIMAL(28,8)
	DECLARE @DOCUMENTO_AJUSTE VARCHAR(20)
	DECLARE @TOTAL_LOCAL DECIMAL(28,8)
	DECLARE @TOTAL_DOLAR DECIMAL(28,8)
	DECLARE @VENTAS_EFECTIVO DECIMAL(28,8)
	DECLARE @ESTADO VARCHAR(1)
	DECLARE @FECHA_HORA_INICIO DATETIME
	DECLARE @NOTAS VARCHAR(4000)
	DECLARE @TIPO_SITIO_LOCAL VARCHAR(1)
	DECLARE @NUM_CIERRE_CAJA VARCHAR(20)
	DECLARE @COBRO_EFECTIVO_REP DECIMAL(28, 8) 
	DECLARE @DOC_FISCAL VARCHAR(30)
	DECLARE @OPERACION VARCHAR(8)	
	DECLARE @NUM_CIERRE_PROCESADO VARCHAR(20)

	IF @INSERTA = 'I'	
	BEGIN
	SET @OPERACION = 'INSERTA'
	END
	ELSE
	BEGIN
	SET @OPERACION = 'MODIFICA'
	END

	DECLARE C_INSERTED CURSOR LOCAL FOR
	SELECT CAJA, TIPO_CIERRE, CAJERO, NOMBRE_VENDEDOR, FECHA_HORA, TIPO_CAMBIO, MONTO_APERTURA, TOTAL_DIFERENCIA, DOCUMENTO_AJUSTE, TOTAL_LOCAL, TOTAL_DOLAR, VENTAS_EFECTIVO, ESTADO, NUM_CIERRE, FECHA_HORA_INICIO, NOTAS, NUM_CIERRE_CAJA, COBRO_EFECTIVO_REP,DOC_FISCAL
	FROM $$Compania$$.CIERRE_POS
	WHERE NUM_CIERRE = @NUM_CIERRE
	AND CAJERO = @CAJERO
	AND CAJA = @CAJA
			
	OPEN C_INSERTED	
	FETCH NEXT FROM C_INSERTED INTO
	@CAJA, @TIPO_CIERRE, @CAJERO, @NOMBRE_VENDEDOR, @FECHA_HORA, @TIPO_CAMBIO, @MONTO_APERTURA, @TOTAL_DIFERENCIA, @DOCUMENTO_AJUSTE, @TOTAL_LOCAL, @TOTAL_DOLAR, @VENTAS_EFECTIVO, @ESTADO, @NUM_CIERRE, @FECHA_HORA_INICIO, @NOTAS, @NUM_CIERRE_CAJA, @COBRO_EFECTIVO_REP,@DOC_FISCAL

	SET @ERROR = 0
	WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
	BEGIN
	
		IF ISNULL(@NUM_CIERRE_CAJA,'') <> ISNULL(@NUM_CIERRE_PROCESADO,'')
		BEGIN
			BEGIN TRAN
			EXECUTE $$Compania$$.REGENERA_CIERRE_CAJA @PUBLICADOR, @INSERTA, @NUM_CIERRE_CAJA
			COMMIT			
	
			SET @NUM_CIERRE_PROCESADO = @NUM_CIERRE_CAJA
		END
	
	
		SET @PARAMETROS = 
			'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
			'<CIERRE_POS>' + 
			'<CAJA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CAJA) + '</CAJA>' + 
			'<TIPO_CIERRE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_CIERRE) + '</TIPO_CIERRE>' + 
			'<CAJERO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CAJERO) + '</CAJERO>' + 
			'<NOMBRE_VENDEDOR Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOMBRE_VENDEDOR) + '</NOMBRE_VENDEDOR>' + 
			'<FECHA_HORA Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_HORA) + '</FECHA_HORA>' + 
			'<TIPO_CAMBIO Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@TIPO_CAMBIO) + '</TIPO_CAMBIO>' + 
			'<MONTO_APERTURA Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@MONTO_APERTURA) + '</MONTO_APERTURA>' + 
			'<TOTAL_DIFERENCIA Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@TOTAL_DIFERENCIA) + '</TOTAL_DIFERENCIA>' + 
			'<DOCUMENTO_AJUSTE Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DOCUMENTO_AJUSTE) + '</DOCUMENTO_AJUSTE>' + 
			'<TOTAL_LOCAL Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@TOTAL_LOCAL) + '</TOTAL_LOCAL>' + 
			'<TOTAL_DOLAR Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@TOTAL_DOLAR) + '</TOTAL_DOLAR>' + 
			'<VENTAS_EFECTIVO Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@VENTAS_EFECTIVO) + '</VENTAS_EFECTIVO>' + 
			'<ESTADO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ESTADO) + '</ESTADO>' + 
			'<NUM_CIERRE Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@NUM_CIERRE) + '</NUM_CIERRE>' + 
			'<FECHA_HORA_INICIO Type="DATETIME" PrimaryKey="False">' + ERPADMIN.POS_FormatoFecha(@FECHA_HORA_INICIO) + '</FECHA_HORA_INICIO>' + 
			'<NOTAS Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NOTAS) + '</NOTAS>' + 
			'<NUM_CIERRE_CAJA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@NUM_CIERRE_CAJA) + '</NUM_CIERRE_CAJA>' + 
			'<COBRO_EFECTIVO_REP Type="DECIMAL" PrimaryKey="False">' + ERPADMIN.POS_NumberToVarchar(@COBRO_EFECTIVO_REP) + '</COBRO_EFECTIVO_REP>' +
			'<DOC_FISCAL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DOC_FISCAL) + '</DOC_FISCAL>' +
			'</CIERRE_POS>'
			
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'CIERREPOSPOS600', @OPERACION, @PARAMETROS, 0, ''
			
			EXECUTE $$Compania$$.REGENERA_CIERRE_DESG_TARJ @PUBLICADOR, @INSERTA, @CAJA, @NUM_CIERRE, @CAJERO
			EXECUTE $$Compania$$.REGENERA_CIERRE_DET_PAGO @PUBLICADOR, @INSERTA, @CAJA, @NUM_CIERRE, @CAJERO
			
			EXECUTE $$Compania$$.REGENERA_CIERRE_CAJA @PUBLICADOR, @INSERTA, @NUM_CIERRE_CAJA


		FETCH NEXT FROM C_INSERTED INTO
		@CAJA, @TIPO_CIERRE, @CAJERO, @NOMBRE_VENDEDOR, @FECHA_HORA, @TIPO_CAMBIO, @MONTO_APERTURA, @TOTAL_DIFERENCIA, @DOCUMENTO_AJUSTE, @TOTAL_LOCAL, @TOTAL_DOLAR, @VENTAS_EFECTIVO, @ESTADO, @NUM_CIERRE, @FECHA_HORA_INICIO, @NOTAS, @NUM_CIERRE_CAJA, @COBRO_EFECTIVO_REP,@DOC_FISCAL
		END

		CLOSE C_INSERTED
    	DEALLOCATE C_INSERTED
	
	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla CIERRE_POS.',16,1 )
	END
END;






CREATE PROCEDURE $$Compania$$.REGENERA_CONSEC_CAJA_POS
	 @PUBLICADOR VARCHAR(20)
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @CODIGO VARCHAR(10)
	DECLARE @CAJA VARCHAR(6)
	DECLARE @DESCRIPCION VARCHAR(60)
	DECLARE @TIPO_DOCUMENTO VARCHAR(1)
	DECLARE @MASCARA VARCHAR(20)
	DECLARE @VALOR VARCHAR(20)
	DECLARE @CREDITO_FISCAL VARCHAR(1)
	DECLARE @FORMATO_IMPRESION VARCHAR(30)
	DECLARE @CONSEC_FAC_DEV VARCHAR(20)
	DECLARE @RESOLUCION VARCHAR(20)
	DECLARE @ACTIVO VARCHAR(1)
	DECLARE @CLASE_DOCUMENTO VARCHAR(10) 
	DECLARE @OPERACION VARCHAR(8)	

	DECLARE C_INSERTED CURSOR LOCAL FOR
	SELECT CODIGO, CAJA, DESCRIPCION, TIPO_DOCUMENTO, MASCARA, VALOR, CREDITO_FISCAL, FORMATO_IMPRESION, CONSEC_FAC_DEV, RESOLUCION, ACTIVO, CLASE_DOCUMENTO
	FROM $$Compania$$.CONSEC_CAJA_POS
		
	OPEN C_INSERTED	
	FETCH NEXT FROM C_INSERTED INTO
	@CODIGO, @CAJA, @DESCRIPCION, @TIPO_DOCUMENTO, @MASCARA, @VALOR, @CREDITO_FISCAL, @FORMATO_IMPRESION, @CONSEC_FAC_DEV, @RESOLUCION, @ACTIVO, @CLASE_DOCUMENTO

	SET @ERROR = 0
	WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
	BEGIN
		SET @PARAMETROS = 
			'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' + 
			'<CONSEC_CAJA_POS>' + 
			'<CODIGO Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CODIGO) + '</CODIGO>' + 
			'<CAJA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CAJA) + '</CAJA>' + 
			'<DESCRIPCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@DESCRIPCION) + '</DESCRIPCION>' + 
			'<TIPO_DOCUMENTO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@TIPO_DOCUMENTO) + '</TIPO_DOCUMENTO>' + 
			'<MASCARA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@MASCARA) + '</MASCARA>' + 
			'<VALOR Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@VALOR) + '</VALOR>' + 
			'<CREDITO_FISCAL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CREDITO_FISCAL) + '</CREDITO_FISCAL>' + 
			'<FORMATO_IMPRESION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@FORMATO_IMPRESION) + '</FORMATO_IMPRESION>' + 
			'<CONSEC_FAC_DEV Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CONSEC_FAC_DEV) + '</CONSEC_FAC_DEV>' + 
			'<RESOLUCION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@RESOLUCION) + '</RESOLUCION>' + 
			'<CLASE_DOCUMENTO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CLASE_DOCUMENTO) + '</CLASE_DOCUMENTO>' +
			'<ACTIVO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ACTIVO) + '</ACTIVO>' +
			'</CONSEC_CAJA_POS>'
			
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'CONSECCAJAPOSPOS600','MODIFICA', @PARAMETROS, 0, ''
	
		FETCH NEXT FROM C_INSERTED INTO
		@CODIGO, @CAJA, @DESCRIPCION, @TIPO_DOCUMENTO, @MASCARA, @VALOR, @CREDITO_FISCAL, @FORMATO_IMPRESION, @CONSEC_FAC_DEV,@RESOLUCION,@ACTIVO,@CLASE_DOCUMENTO
	END

	CLOSE C_INSERTED
	DEALLOCATE C_INSERTED

	IF (@@ERROR <> 0 OR @ERROR <> 0) 
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla CONSEC_CAJA_POS.',16,1 )
	END
END;






CREATE PROCEDURE $$Compania$$.REGENERA_CAJA_POS
	@PUBLICADOR VARCHAR(20)
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PARAMETROS VARCHAR(8000)
	DECLARE @USUARIO_POS_WSQM VARCHAR(100)
	DECLARE @TIPO_SITIO_LOCAL VARCHAR(1)
	DECLARE @CAJA VARCHAR(6)
	DECLARE @CODIGO_CORTO VARCHAR(2)
	DECLARE @SUCURSAL VARCHAR(6)
	DECLARE @BODEGA VARCHAR(4)
	DECLARE @UBICACION VARCHAR(40)
	DECLARE @ASIGNADO VARCHAR(1)
	DECLARE @IDENTIFICADOR VARCHAR(20)	
	DECLARE @CENTRO_COSTO VARCHAR(25)
	DECLARE @CONS_CIERRE_CAJA VARCHAR(20)
	DECLARE @CONSEC_DOC_ESPERA VARCHAR(20)	

	DECLARE C_INSERTED CURSOR LOCAL FOR
	SELECT CAJA, CODIGO_CORTO, SUCURSAL, BODEGA, UBICACION, ASIGNADO, IDENTIFICADOR, CENTRO_COSTO, CONS_CIERRE_CAJA, CONSEC_DOC_ESPERA
	FROM $$Compania$$.CAJA_POS

	OPEN C_INSERTED	
	FETCH NEXT FROM C_INSERTED INTO
	@CAJA, @CODIGO_CORTO, @SUCURSAL, @BODEGA, @UBICACION, @ASIGNADO, @IDENTIFICADOR, @CENTRO_COSTO, @CONS_CIERRE_CAJA, @CONSEC_DOC_ESPERA
	SET @ERROR = 0
	WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
	BEGIN
		SET @PARAMETROS =
			'<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>' +
			'<CAJA_POS>' +
			'<CAJA Type="VARCHAR" PrimaryKey="True">' + ERPADMIN.POS_ReemplazarCaracter(@CAJA) + '</CAJA>' +
			'<CODIGO_CORTO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CODIGO_CORTO) + '</CODIGO_CORTO>' +
			'<SUCURSAL Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@SUCURSAL) + '</SUCURSAL>' +
			'<BODEGA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@BODEGA) + '</BODEGA>' +
			'<UBICACION Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@UBICACION) + '</UBICACION>' +
			'<ASIGNADO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@ASIGNADO) + '</ASIGNADO>' +
			'<IDENTIFICADOR Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@IDENTIFICADOR) + '</IDENTIFICADOR>' +
			'<CENTRO_COSTO Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CENTRO_COSTO) + '</CENTRO_COSTO>'+
			'<CONS_CIERRE_CAJA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CONS_CIERRE_CAJA) + '</CONS_CIERRE_CAJA>'+
			'<CONSEC_DOC_ESPERA Type="VARCHAR" PrimaryKey="False">' + ERPADMIN.POS_ReemplazarCaracter(@CONSEC_DOC_ESPERA) + '</CONSEC_DOC_ESPERA>'+
			'</CAJA_POS>'
		
			EXECUTE @Error = ERPADMIN.POS_InsertarSolicitud @PUBLICADOR, 'CAJAPOSPOS600', 'MODIFICA', @PARAMETROS, 0, ''
		
		FETCH NEXT FROM C_INSERTED INTO
		@CAJA, @CODIGO_CORTO, @SUCURSAL, @BODEGA, @UBICACION, @ASIGNADO, @IDENTIFICADOR, @CENTRO_COSTO, @CONS_CIERRE_CAJA, @CONSEC_DOC_ESPERA
		END
		CLOSE C_INSERTED
    		DEALLOCATE C_INSERTED
	END
	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para insertar en la tabla CAJA_POS.',16,1 )
	
END;






CREATE PROCEDURE $$Compania$$.INFORMACION_DOCUMENTOS
	 @DOCUMENTO VARCHAR(20),
	 @CAJA VARCHAR(6),
	 @TIPO VARCHAR(1),
	 @INSERTA VARCHAR(1)
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PUBLICADOR VARCHAR(30)
	DECLARE	@NUM_CIERRE VARCHAR(20)
	DECLARE @NUM_CIERRE_PROCESADO VARCHAR(20)
	DECLARE	@CAJERO VARCHAR(25)
	
	DECLARE C_INSERTED CURSOR LOCAL FOR
	SELECT DOCUMENTO, CAJA, TIPO, NUM_CIERRE, CAJERO
	FROM $$Compania$$.DOCUMENTO_POS
	WHERE DOCUMENTO = @DOCUMENTO AND CAJA = @CAJA AND TIPO = @TIPO

	SELECT @PUBLICADOR = SITIO_LOCAL
	FROM $$Compania$$.GLOBALES_POS
		
	OPEN C_INSERTED	
	FETCH NEXT FROM C_INSERTED INTO
	@DOCUMENTO, @CAJA, @TIPO, @NUM_CIERRE, @CAJERO
	SET @ERROR = 0
	WHILE @@FETCH_STATUS = 0 AND @ERROR = 0
	BEGIN		
	
		IF ISNULL(@NUM_CIERRE,'') <> ISNULL(@NUM_CIERRE_PROCESADO,'')
		BEGIN
			BEGIN TRAN
				EXECUTE $$Compania$$.REGENERA_CIERRE_POS @PUBLICADOR, @INSERTA, @CAJA, @NUM_CIERRE, @CAJERO
			COMMIT

			SET @NUM_CIERRE_PROCESADO = @NUM_CIERRE
		END

		BEGIN TRAN
		
			EXECUTE $$Compania$$.REGENERA_DOCUMENTO_POS @DOCUMENTO, @CAJA, @TIPO, @PUBLICADOR, @INSERTA 
			EXECUTE $$Compania$$.REGENERA_DOC_POS_LINEA @DOCUMENTO, @CAJA, @TIPO, @PUBLICADOR, @INSERTA 
			EXECUTE $$Compania$$.REGENERA_ARTICULO_SERIE_POS @DOCUMENTO, @CAJA, @TIPO, @PUBLICADOR, @INSERTA 			
			EXECUTE $$Compania$$.REGENERA_PAGO_POS @DOCUMENTO, @CAJA, @TIPO, @PUBLICADOR, @INSERTA 
			EXECUTE $$Compania$$.REGENERA_INFO_DOC_SEGURO @DOCUMENTO, @CAJA, @TIPO, @PUBLICADOR, @INSERTA 	
			
		COMMIT
		
		BEGIN TRAN
		
			EXECUTE $$Compania$$.REGENERA_AUXILIAR_POS @DOCUMENTO, @CAJA, @TIPO, @PUBLICADOR, @INSERTA
			
		COMMIT
		
		FETCH NEXT FROM C_INSERTED INTO
		@DOCUMENTO, @CAJA, @TIPO, @NUM_CIERRE, @CAJERO
	END
	CLOSE C_INSERTED
	DEALLOCATE C_INSERTED

	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para regenerar solicitudes Offline.',16,1 )
	END
END;






CREATE PROCEDURE $$Compania$$.INFORMACION_CAJA
	 @INSERTA VARCHAR(1)
AS
BEGIN
	DECLARE @ERROR INT
	DECLARE @PUBLICADOR VARCHAR(30)
	
	SELECT @PUBLICADOR = SITIO_LOCAL
	FROM $$Compania$$.GLOBALES_POS		
	
	BEGIN TRAN
	
	EXECUTE $$Compania$$.REGENERA_GRUPO @PUBLICADOR
	
	COMMIT
	
	BEGIN TRAN

	EXECUTE $$Compania$$.REGENERA_CAJA_POS @PUBLICADOR
	
	COMMIT
	
	BEGIN TRAN

	EXECUTE $$Compania$$.REGENERA_CONSEC_CAJA_POS @PUBLICADOR
	
	COMMIT
	
	BEGIN TRAN

	EXECUTE $$Compania$$.REGENERA_CIERRE_TIENDA @PUBLICADOR, @INSERTA 	
	
	COMMIT
	
	BEGIN TRAN

	EXECUTE $$Compania$$.REGENERA_AFILIADO @PUBLICADOR, @INSERTA 	
	
	COMMIT
		
	IF (@@ERROR <> 0 OR @ERROR <> 0)
	BEGIN
		RAISERROR( 'Error generando la solicitud de servicio para regenerar solicitudes Offline.',16,1 )
	END
END;



IF  NOT EXISTS(Select * from sysobjects WHERE id IN (OBJECT_ID(N'[$$Compania$$].[EXPLOTA_LOTE_LOC_DISPONIBLE]'))) AND
	0 < (Select COUNT(0) from $$Compania$$.GLOBALES_POS where TIPO_SITIO_LOCAL = 'T')
BEGIN
EXEC dbo.sp_executesql @statement = N'
	CREATE PROCEDURE $$Compania$$.EXPLOTA_LOTE_LOC_DISPONIBLE
	(
		@ARTICULO_KIT VARCHAR(20),
		@BODEGA VARCHAR(4),
		@ARTICULO VARCHAR(20),
		@CANT_DISPONIBLE DECIMAL(28,8),
		@CANT_RESERVADA DECIMAL(28,8),
		@CANT_REMITIDA DECIMAL(28,8)
	)
	AS
	BEGIN
		DECLARE @MensajeError VARCHAR(1000)
		
		DECLARE @Lote VARCHAR(15)
		DECLARE @Localizacion VARCHAR(8)
		--Existencia que tiene el lote en BD
		DECLARE @CantDispEnLote DECIMAL(28,8)
		DECLARE @CantResvEnLote DECIMAL(28,8)
		DECLARE @CantRemiEnLote DECIMAL(28,8)

		--Existencia pendiente de rebajar de los lotes
		DECLARE @CantPendDisponible DECIMAL(28,8)
		DECLARE @CantPendReservada DECIMAL(28,8)
		DECLARE @CantPendRemitida DECIMAL(28,8)
		
		--Existencia a rebajar del lote
		DECLARE @CantARebajarDisp DECIMAL(28,8)
		DECLARE @CantARebajarResv DECIMAL(28,8)
		DECLARE @CantARebajarRemi DECIMAL(28,8)
		
		
		SET @CantPendDisponible = ABS(@CANT_DISPONIBLE)
		SET @CantPendReservada = ABS(@CANT_RESERVADA)
		SET @CantPendRemitida = ABS(@CANT_REMITIDA)


		DECLARE EXIST_LOTE CURSOR FOR
			SELECT EXL.LOTE, EXL.LOCALIZACION, CANT_DISPONIBLE, CANT_RESERVADA, CANT_REMITIDA
			FROM $$Compania$$.EXISTENCIA_LOTE EXL 
					INNER JOIN $$Compania$$.LOTE LT
						ON EXL.ARTICULO = LT.ARTICULO
						   AND EXL.LOTE = LT.LOTE 
			WHERE EXL.BODEGA = @BODEGA
			AND EXL.ARTICULO = @ARTICULO
			AND LT.ESTADO NOT IN (''V'',''C'')
			AND LT.FECHA_VENCIMIENTO > GETDATE()
			ORDER BY EXL.LOTE, EXL.LOCALIZACION 
		OPEN EXIST_LOTE
		FETCH NEXT FROM EXIST_LOTE INTO @Lote, @Localizacion, @CantDispEnLote, @CantResvEnLote, @CantRemiEnLote
		WHILE @@FETCH_STATUS = 0 AND (@CantPendDisponible > 0 OR @CantPendReservada > 0 OR @CantPendRemitida > 0)
		BEGIN
			SET @CantARebajarDisp = 0
			SET @CantARebajarResv = 0
			SET @CantARebajarRemi = 0

			--Disponible
			IF @CANT_DISPONIBLE <> 0
			BEGIN 
				IF @CantPendDisponible > @CantDispEnLote
					BEGIN
						SET @CantARebajarDisp = @CantDispEnLote
					END
				ELSE
					BEGIN
						SET @CantARebajarDisp = @CantPendDisponible
					END
			END		
			
			--Reservado	
			IF @CANT_RESERVADA <> 0
			BEGIN 		
				IF @CantPendReservada > @CantResvEnLote
					BEGIN
						SET @CantARebajarResv = @CantResvEnLote
					END
				ELSE
					BEGIN
						SET @CantARebajarResv = @CantPendReservada
					END
			END
			
			--Remitido	
			IF @CANT_REMITIDA <> 0
			BEGIN 		
				IF @CantPendRemitida > @CantRemiEnLote
					BEGIN
						SET @CantARebajarRemi = @CantRemiEnLote
					END
				ELSE
					BEGIN
						SET @CantARebajarRemi = @CantPendRemitida
					END
			END
			
			--Se asigna signo según signo que ingresa en el método
			IF @CANT_DISPONIBLE < 0
			BEGIN
				SET @CantARebajarDisp = @CantARebajarDisp * -1
			END
			
			IF @CANT_RESERVADA < 0
			BEGIN
				SET @CantARebajarResv = @CantARebajarResv * -1
			END
			
			IF @CANT_REMITIDA < 0
			BEGIN
				SET @CantARebajarRemi = @CantARebajarRemi * -1
			END		
		
			EXEC $$Compania$$.ACTUALIZA_EXISTENCIA_LOTE @BODEGA, @ARTICULO, @Lote, @Localizacion, @CantARebajarDisp, @CantARebajarResv, @CantARebajarRemi
			
			SET @CantPendDisponible = @CantPendDisponible + @CantARebajarDisp
			SET @CantPendReservada = @CantPendReservada + @CantARebajarResv
			SET @CantPendRemitida = @CantPendRemitida + @CantARebajarRemi		
			
			FETCH NEXT FROM EXIST_LOTE INTO @Lote, @Localizacion, @CantDispEnLote, @CantResvEnLote, @CantRemiEnLote
		END
		CLOSE EXIST_LOTE
		DEALLOCATE EXIST_LOTE
		
		IF (@CantPendDisponible > 0 OR @CantPendReservada > 0 OR @CantPendRemitida > 0)
			BEGIN
				SET @MensajeError = ''Error al validar las existencias de los componentes del Kit "'' + @ARTICULO_KIT + ''". El artículo "'' + @ARTICULO + ''" no tiene la cantidad suficiente disponible para facturar.''
				IF @CantPendDisponible > 0
				BEGIN
					SET @MensajeError = @MensajeError + '' Cantidad Disponible Faltante: '' + CONVERT (VARCHAR(30),@CantPendDisponible)
				END
				
				IF @CantPendReservada > 0
				BEGIN
					SET @MensajeError = @MensajeError + '' Cantidad Reservada Faltante: '' + CONVERT (VARCHAR(30),@CantPendReservada)
				END

				IF @CantPendRemitida > 0
				BEGIN			
					SET @MensajeError = @MensajeError + '' Cantidad Remitida Faltante: '' + CONVERT (VARCHAR(30),@CantPendRemitida)
				END
				--Error porque no había lotes con existencias suficientes para el componente del Kit
				RAISERROR(@MensajeError,16,1)
			END
		ELSE
			BEGIN
				INSERT INTO $$Compania$$.AUDIT_EXISTENCIA
				(
					CAJA,
					DOCUMENTO,
					TIPO,
					LINEA,
					BODEGA,
					ARTICULO,
					CANT_DISPONIBLE,
					CANT_RESERVADA,
					CANT_REMITIDA,
					TEXTO
				)
				VALUES
				(
					''KIT'',
					@ARTICULO_KIT,
					''K'',
					''0'',
					@BODEGA,
					@ARTICULO,
					@CANT_DISPONIBLE,
					@CANT_RESERVADA,
					@CANT_REMITIDA,
					''EXPLOTA_EXIST_COMP_KITS KIT: ''	+ @ARTICULO_KIT + '' Ensamble: '' + @ARTICULO
				)

				EXEC $$Compania$$.ACTUALIZA_EXISTENCIA_BODEGA @BODEGA, @ARTICULO, @CANT_DISPONIBLE, @CANT_RESERVADA, @CANT_REMITIDA			
			END
	END'
END
;



IF  EXISTS(Select * from sysobjects WHERE id IN (OBJECT_ID(N'[$$Compania$$].[ACTUALIZA_EXISTENCIA_LOTE]'))) AND
	0 < (Select COUNT(0) from $$Compania$$.GLOBALES_POS where TIPO_SITIO_LOCAL = 'T')
BEGIN
EXEC dbo.sp_executesql @statement = N'
ALTER PROCEDURE $$Compania$$.ACTUALIZA_EXISTENCIA_LOTE
 (
   @psBodega AS VARCHAR(4),
   @psArticulo AS VARCHAR(20),
   @psLote AS VARCHAR(15),
   @psLocalizacion AS VARCHAR(8),
   @pnCantidadDisponible as DECIMAL(28,8),
   @pnCantidadReservada as DECIMAL(28,8),
   @pnCantidadRemitida as DECIMAL(28,8)
 )
 AS
 BEGIN
	DECLARE @MensajeError VARCHAR(1000)	
    DECLARE @Porc_Rebajo_MediaUnidad DECIMAL(28,8)
    DECLARE @MediaUnidadDetalle DECIMAL(28,8)  
    DECLARE @Factor_Empaque DECIMAL(28,8)
    DECLARE @CantDipRebajada DECIMAL (28,8)
    DECLARE @CantSolicitadaDisp DECIMAL (28,8)
    DECLARE @CantSolicitadaReserv DECIMAL (28,8)
    DECLARE @ObtenerMediaUnidadDet DECIMAL (28,8)
    DECLARE @Disponible_Almacen DECIMAL (28,8)
    DECLARE @Reservada_Almacen DECIMAL (28,8)
    DECLARE @CantSolicitadaRemit DECIMAL (28,8)
    DECLARE @Remitida_Almacen DECIMAL (28,8)
 
	IF @psBodega IS NULL OR @psArticulo IS NULL
		RETURN

	IF 0 = (SELECT COUNT(BODEGA) FROM $$Compania$$.V_SITIO_BODEGA WHERE SITIO IN (SELECT SITIO_LOCAL FROM $$Compania$$.GLOBALES_POS) AND BODEGA = @psBodega)
		RETURN
	IF @pnCantidadDisponible IS NULL
		SET @pnCantidadDisponible = 0
	IF @pnCantidadReservada IS NULL
		SET @pnCantidadReservada = 0
	IF @pnCantidadRemitida IS NULL
		SET @pnCantidadRemitida = 0
  
	IF @psLocalizacion IS NULL
		SET @psLocalizacion = ''ND''  
   
	IF EXISTS( SELECT ''x'' FROM $$Compania$$.EXISTENCIA_LOTE WHERE BODEGA = @psBodega AND ARTICULO = @psArticulo AND LOTE = @psLote AND LOCALIZACION = @psLocalizacion )
	  BEGIN
	     IF @pnCantidadDisponible = 0 AND @pnCantidadReservada = 0 AND @pnCantidadRemitida = 0
	         RETURN
   
		SELECT @Disponible_Almacen = CANT_DISPONIBLE, @Reservada_Almacen = CANT_RESERVADA, @Remitida_Almacen = CANT_REMITIDA
		FROM $$Compania$$.EXISTENCIA_LOTE
		WHERE  BODEGA = @psBodega AND ARTICULO = @psArticulo AND LOTE = @psLote AND LOCALIZACION = @psLocalizacion
   
		SELECT  @Factor_Empaque  = FACTOR_EMPAQUE FROM $$Compania$$.ARTICULO WHERE  ARTICULO = @psArticulo
		
		SET @Porc_Rebajo_MediaUnidad = 0.01
   
		IF @Factor_Empaque > 0 
		BEGIN
			SET @MediaUnidadDetalle = (1 / @Factor_Empaque) / 2
			SET @ObtenerMediaUnidadDet = @MediaUnidadDetalle - (@MediaUnidadDetalle * @Porc_Rebajo_MediaUnidad)     
		END
   
		SET @CantSolicitadaDisp = ABS(@pnCantidadDisponible) * @Factor_Empaque

		IF @Disponible_Almacen + @CantSolicitadaDisp < 0
		BEGIN
			IF @Disponible_Almacen > @ObtenerMediaUnidadDet 
			BEGIN 
				SET @CantDipRebajada = @Disponible_Almacen - @CantSolicitadaDisp
				IF (Abs(@CantDipRebajada) < @ObtenerMediaUnidadDet)
				BEGIN
					SET @pnCantidadDisponible = -@Disponible_Almacen
				END
			END
		END
 
		SET @CantSolicitadaReserv = ABS(@pnCantidadReservada) * @Factor_Empaque
		IF @Reservada_Almacen + @CantSolicitadaReserv < 0
		BEGIN
			IF @Reservada_Almacen > @ObtenerMediaUnidadDet 
			BEGIN 
				SET @CantDipRebajada = @Reservada_Almacen - @CantSolicitadaReserv
				IF (Abs(@CantDipRebajada) < @ObtenerMediaUnidadDet)
				BEGIN
					SET @pnCantidadReservada = -@Reservada_Almacen
				END
			END
		END
 
		SET @CantSolicitadaRemit = ABS(@pnCantidadRemitida) * @Factor_Empaque
		IF @Remitida_Almacen + @CantSolicitadaRemit < 0
		BEGIN
			IF @Remitida_Almacen > @ObtenerMediaUnidadDet 
			BEGIN 
				SET @CantDipRebajada = @Remitida_Almacen - @CantSolicitadaRemit
				IF (Abs(@CantDipRebajada) < @ObtenerMediaUnidadDet)
				BEGIN
					SET @pnCantidadRemitida = -@Remitida_Almacen
				END
			END
		END 
   
		IF ((SELECT VALIDAR_EXISTENCIAS FROM $$Compania$$.GLOBALES_POS) = ''S'')
		BEGIN
			IF @Disponible_Almacen + @pnCantidadDisponible < 0 OR @Reservada_Almacen + @pnCantidadReservada < 0 OR @Remitida_Almacen + @pnCantidadRemitida < 0
			BEGIN
				SET @MensajeError = ''Error al validar existencias. El artículo '' + @psArticulo + '' no tiene la cantidad suficiente en la bodega '' + @psBodega + '' para facturar.''

				IF @Disponible_Almacen + @pnCantidadDisponible < 0
				BEGIN
					SET @MensajeError = @MensajeError + '' Cantidad Disponible Faltante: '' + CONVERT(VARCHAR(30), ABS(@Disponible_Almacen + @pnCantidadDisponible))
				END

				IF @Reservada_Almacen + @pnCantidadReservada < 0
				BEGIN
					SET @MensajeError = @MensajeError + '' Cantidad Reservada Faltante: '' + CONVERT(VARCHAR(30), ABS(@Reservada_Almacen + @pnCantidadReservada))
				END

				IF @Remitida_Almacen + @pnCantidadRemitida < 0
				BEGIN
					SET @MensajeError = @MensajeError + '' Cantidad Remitida Faltante: '' + CONVERT(VARCHAR(30), ABS(@Remitida_Almacen + @pnCantidadRemitida))
				END		

				RAISERROR(@MensajeError,16,1)
			END
		END   
   
		UPDATE $$Compania$$.EXISTENCIA_LOTE
		SET CANT_DISPONIBLE = CANT_DISPONIBLE + @pnCantidadDisponible,
			CANT_RESERVADA = CANT_RESERVADA + @pnCantidadReservada,
			CANT_REMITIDA = CANT_REMITIDA + @pnCantidadRemitida
		WHERE BODEGA = @psBodega 
		AND ARTICULO = @psArticulo 
		AND LOTE = @psLote
		AND LOCALIZACION = @psLocalizacion 
	END
  ELSE
	BEGIN
		INSERT INTO $$Compania$$.EXISTENCIA_LOTE 
		(
			ARTICULO, 
			BODEGA, 
			LOTE, 
			LOCALIZACION, 
			CANT_DISPONIBLE, 
			CANT_RESERVADA, 
			CANT_NO_APROBADA, 
			CANT_VENCIDA, 
			CANT_REMITIDA
		)
		VALUES
		(
			@psArticulo, 
			@psBodega, 
			@psLote, 
			@psLocalizacion, 
			@pnCantidadDisponible, 
			@pnCantidadReservada, 
			0, 
			0, 
			@pnCantidadRemitida
		)
	END
 END'
END
;
 
IF  EXISTS(Select * from sysobjects WHERE id IN (OBJECT_ID(N'[$$Compania$$].[EXPLOTA_EXIST_COMP_KITS]'))) AND
	0 < (Select COUNT(0) from $$Compania$$.GLOBALES_POS where TIPO_SITIO_LOCAL = 'T')
BEGIN
EXEC dbo.sp_executesql @statement = N'
	ALTER PROCEDURE $$Compania$$.EXPLOTA_EXIST_COMP_KITS
	(
		@BODEGA VARCHAR(4),
		@ARTICULO VARCHAR(20),
		@LOTE VARCHAR(15),
		@LOCALIZACION VARCHAR(8),
		@CANT_DISPONIBLE DECIMAL(28,8),
		@CANT_RESERVADA DECIMAL(28,8),
		@CANT_REMITIDA DECIMAL(28,8)
	)
	AS
	BEGIN
		DECLARE @ErrorMessage    NVARCHAR(4000)
		DECLARE @ArticuloHijo VARCHAR(20)
		DECLARE @CantidadEnsamble DECIMAL(28,8)
		DECLARE @CantDispEnsamble DECIMAL(28,8)
		DECLARE @CantReservEnsamble DECIMAL(28,8)
		DECLARE @CantRemitEnsamble DECIMAL(28,8)
		DECLARE ART_ENSAMBLADOS CURSOR FOR
			SELECT ARTICULO_HIJO, CANTIDAD
			FROM $$Compania$$.ARTICULO_ENSAMBLE
			WHERE ARTICULO_PADRE = @ARTICULO
		OPEN ART_ENSAMBLADOS
		FETCH NEXT FROM ART_ENSAMBLADOS INTO @ArticuloHijo, @CantidadEnsamble
		
		WHILE @@FETCH_STATUS = 0
		BEGIN
			IF $$Compania$$.MANEJA_EXISTENCIAS (@ArticuloHijo) = 1
			BEGIN
				SET @CantDispEnsamble = @CantidadEnsamble * @CANT_DISPONIBLE
				SET @CantReservEnsamble = @CantidadEnsamble * @CANT_RESERVADA
				SET @CantRemitEnsamble = @CantidadEnsamble * @CANT_REMITIDA
				
				
				--Si el artículo maneja lotes y en el POS se registran los lotes, se debe obtener el lote y localización a utilizar para el artículo
				IF ((SELECT MANEJO_LOTE FROM $$Compania$$.GLOBALES_POS) = ''S'') AND
					((SELECT USA_LOTES FROM $$Compania$$.ARTICULO WHERE  ARTICULO = @ArticuloHijo) = ''S'')
					BEGIN
						EXEC $$Compania$$.EXPLOTA_LOTE_LOC_DISPONIBLE @ARTICULO, @BODEGA, @ArticuloHijo, @CantDispEnsamble, @CantReservEnsamble, @CantRemitEnsamble
					END
				ELSE
					BEGIN
						INSERT INTO $$Compania$$.AUDIT_EXISTENCIA
						(
							CAJA,
							DOCUMENTO,
							TIPO,
							LINEA,
							BODEGA,
							ARTICULO,
							CANT_DISPONIBLE,
							CANT_RESERVADA,
							CANT_REMITIDA,
							TEXTO
						)
						VALUES
						(
							''KIT'',
							@ARTICULO,
							''K'',
							''0'',
							@BODEGA,
							@ArticuloHijo,
							@CantDispEnsamble,
							@CantReservEnsamble,
							@CantRemitEnsamble,
							''EXPLOTA_EXIST_COMP_KITS KIT: ''	+ @ARTICULO + '' Ensamble: '' + @ArticuloHijo
						)

						EXEC $$Compania$$.Actualiza_Existencia @BODEGA, @ArticuloHijo, @LOTE, @LOCALIZACION, @CantDispEnsamble, @CantReservEnsamble, @CantRemitEnsamble	
					END
			END
			FETCH NEXT FROM ART_ENSAMBLADOS INTO @ArticuloHijo, @CantidadEnsamble
		END

		CLOSE ART_ENSAMBLADOS
		DEALLOCATE ART_ENSAMBLADOS
	END'
END
;

IF  EXISTS(Select * from sysobjects WHERE id IN (OBJECT_ID(N'[$$Compania$$].[tU_DOCUMENTO_POS_EXISTENCIA]'))) AND
	0 < (Select COUNT(0) from $$Compania$$.GLOBALES_POS where TIPO_SITIO_LOCAL = 'T')
BEGIN
EXEC dbo.sp_executesql @statement = N'
	ALTER TRIGGER $$Compania$$.tU_DOCUMENTO_POS_EXISTENCIA ON $$Compania$$.DOCUMENTO_POS
	FOR UPDATE
	AS
	BEGIN
		DECLARE
			@InfoTrigger AS VARCHAR(100),
			@lsCaja AS VARCHAR(6),
			@lsDocumento AS VARCHAR(20),
			@lsTipo AS VARCHAR(1),
			@lsLinea AS VARCHAR(4),
			@ESTADO_OLD AS VARCHAR(1),
			@ESTADO_NEW AS VARCHAR(1),
			@CANTIDAD_ROWS AS INT,
			@lsBodega as VARCHAR(4),
			@lsArticulo AS VARCHAR(20),
			@lsLote AS VARCHAR(15),
			@lsLocalizacion AS VARCHAR(8),
			@lnCantidadDisponible as DECIMAL(28,8),
			@lnCantidadReservada as DECIMAL(28,8),
			@lnCantidadRemitida as DECIMAL(28,8),
			@DOCUMENTO AS VARCHAR(20), 
			@CAJA AS VARCHAR(6),
			@TIPO AS VARCHAR(1),
			@ESTADO AS VARCHAR(1),
			@error AS INT
		IF NOT UPDATE(ESTADO_COBRO)
			RETURN
		--Se declara el cursor para obtener los documentos
		DECLARE c_DOC CURSOR FOR
				SELECT DOCUMENTO, CAJA, TIPO, ESTADO_COBRO
				FROM INSERTED
				WHERE ((ESTADO_COBRO IN (''C'',''A'',''P'',''V'') AND TIPO IN (''F'',''P''))
						OR (ESTADO_COBRO = ''A'' AND TIPO IN (''D'', ''T'')) OR (ESTADO_COBRO = ''D'' AND TIPO = ''T''))		
							
		OPEN c_DOC
		FETCH c_DOC INTO @DOCUMENTO, @CAJA, @TIPO, @ESTADO
		WHILE @@FETCH_STATUS >=0 
		BEGIN
			SELECT @ESTADO_OLD = ESTADO_COBRO
			FROM DELETED D
			SELECT @ESTADO_NEW = ESTADO_COBRO
			FROM INSERTED D
			
			IF @TIPO = ''D'' AND @ESTADO_OLD = ''P'' AND @ESTADO_NEW = ''C''
			BEGIN
				SET @ESTADO = ''-1''
			END
			
			IF @ESTADO_NEW <> @ESTADO_OLD
			BEGIN
				DECLARE c_DOCPOS_DET CURSOR LOCAL FOR
					SELECT	L.CAJA,
						L.DOCUMENTO,
						L.TIPO,
						L.LINEA,
						C.BODEGA,
						L.ARTICULO,
						L.LOTE,
						L.LOCALIZACION,
						$$Compania$$.CANTIDAD_DISPONIBLE( L.TIPO, @ESTADO, L.CANTIDAD),
						$$Compania$$.CANTIDAD_RESERVADA( L.TIPO, @ESTADO, L.CANTIDAD),
						$$Compania$$.CANTIDAD_REMITIDA( L.TIPO, @ESTADO, L.CANTIDAD)
					FROM	$$Compania$$.DOC_POS_LINEA L,
						$$Compania$$.CAJA_POS C
					WHERE	L.DOCUMENTO = @DOCUMENTO
						AND   L.CAJA = @CAJA
						AND   L.TIPO = @TIPO
						AND   L.CAJA = C.CAJA
				OPEN c_DOCPOS_DET
				FETCH NEXT FROM c_DOCPOS_DET
				INTO	@lsCaja,
					@lsDocumento,
					@lsTipo,
					@lsLinea,
					@lsBodega,
					@lsArticulo,
					@lsLote,
					@lsLocalizacion,
					@lnCantidadDisponible,
					@lnCantidadReservada,
					@lnCantidadRemitida
				WHILE @@FETCH_STATUS = 0
				BEGIN
					--Se verifica que no sea una factura producto de un Ticket
					IF 0 <= (SELECT COUNT(0) 
								FROM $$Compania$$.AUXILIAR_POS 
								WHERE @lsTipo = ''F'' 
								AND @ESTADO_NEW = ''C'' 
								AND TIPO = @lsTipo
								AND CAJA = @lsCaja
								AND DOCUMENTO = @lsDocumento 
								AND TIPO_APLICA = ''T'')
					BEGIN			
						SET @InfoTrigger = ''tU_DOCUMENTO_POS_EXISTENCIA ESTADO = '' + @ESTADO_NEW

						IF  $$Compania$$.ES_ARTICULO_KIT (@lsArticulo) = 1
						BEGIN
							SET @InfoTrigger = ''tU_DOCUMENTO_POS_EXISTENCIA ESTADO = '' + @ESTADO_NEW + '' - ARTICULO KIT''
						END		
						
						--Si se aplica el ticket se cambia el Tipo de documento y Documento para reflejar la factura para efectos de bitácora auditoría
						IF @lsTipo = ''T'' AND @ESTADO_NEW = ''D'' 
						BEGIN
							SET @InfoTrigger = @InfoTrigger + '' TICKET: '' + @lsDocumento
							
							IF  $$Compania$$.ES_ARTICULO_KIT (@lsArticulo) = 1
							BEGIN
								SET @InfoTrigger = ''tU_DOCUMENTO_POS_EXISTENCIA ESTADO = '' + @ESTADO_NEW + '' TICKET: '' + @lsDocumento + '' - ARTICULO KIT''
							END		
							
							SELECT DISTINCT @lsTipo = TIPO, @lsDocumento = DOCUMENTO
							FROM $$Compania$$.AUXILIAR_POS 
							WHERE TIPO_APLICA = @lsTipo
							AND CAJA_DOCUM_APLICA = @lsCaja
							AND DOCUM_APLICA = @lsDocumento 
							AND TIPO = ''F''
						END
								
						INSERT INTO $$Compania$$.AUDIT_EXISTENCIA
						(
							CAJA,
							DOCUMENTO,
							TIPO,
							LINEA,
							BODEGA,
							ARTICULO,
							CANT_DISPONIBLE,
							CANT_RESERVADA,
							CANT_REMITIDA,
							TEXTO
						)
						VALUES
						(
							@lsCaja,
							@lsDocumento,
							@lsTipo,
							@lsLinea,
							@lsBodega,
							@lsArticulo,
							@lnCantidadDisponible,
							@lnCantidadReservada,
							@lnCantidadRemitida,
							@InfoTrigger
						)
						 Select @error = @@error
        					 If @error != 0
       						 Begin
      							 RAISERROR (''Error actualizando los documentos'', 16, 1)
        						 Rollback 
        					 End
						IF $$Compania$$.MANEJA_EXISTENCIAS (@lsArticulo) = 1
						BEGIN
							EXEC $$Compania$$.Actualiza_Existencia	@lsBodega,
												@lsArticulo,
												@lsLote,
												@lsLocalizacion,
												@lnCantidadDisponible,
												@lnCantidadReservada,
												@lnCantidadRemitida
						END
						ELSE IF $$Compania$$.ES_ARTICULO_KIT (@lsArticulo) = 1
						BEGIN
							EXEC $$Compania$$.EXPLOTA_EXIST_COMP_KITS	@lsBodega,
													@lsArticulo,
													@lsLote,
													@lsLocalizacion,
													@lnCantidadDisponible,
													@lnCantidadReservada,
													@lnCantidadRemitida
						END
						FETCH NEXT FROM c_DOCPOS_DET
						INTO	@lsCaja,
							@lsDocumento,
							@lsTipo,
							@lsLinea,
							@lsBodega,
							@lsArticulo,
							@lsLote,
							@lsLocalizacion,
							@lnCantidadDisponible,
							@lnCantidadReservada,
							@lnCantidadRemitida
						END
					END
				CLOSE c_DOCPOS_DET
				DEALLOCATE c_DOCPOS_DET
			END
		FETCH c_DOC INTO @DOCUMENTO, @CAJA, @TIPO, @ESTADO
		END
		CLOSE c_DOC
		DEALLOCATE c_DOC
	END'
END
;

IF  EXISTS(Select * from sysobjects WHERE id IN (OBJECT_ID(N'[$$Compania$$].[tI_DOC_POS_LINEA_EXISTENCIA]'))) AND
	0 < (Select COUNT(0) from $$Compania$$.GLOBALES_POS where TIPO_SITIO_LOCAL = 'T')
BEGIN
EXEC dbo.sp_executesql @statement = N'
	ALTER TRIGGER $$Compania$$.tI_DOC_POS_LINEA_EXISTENCIA ON $$Compania$$.DOC_POS_LINEA
	FOR INSERT
	AS
	BEGIN
		DECLARE
			@InfoTrigger AS VARCHAR(100),
			@CANTIDAD_ROWS AS INT,
			@lsCaja AS VARCHAR(6),
			@lsDocumento AS VARCHAR(20),
			@lsTipo AS VARCHAR(1),
			@lsLinea AS VARCHAR(4),
			@lsBodega as VARCHAR(4),
			@lsArticulo AS VARCHAR(20),
			@lsLote AS VARCHAR(15),
			@lsLocalizacion AS VARCHAR(8),
			@lnCantidadDisponible as DECIMAL(28,8),
			@lnCantidadReservada as DECIMAL(28,8),
			@lnCantidadRemitida as DECIMAL(28,8)
		DECLARE c_DOCPOS_LIN CURSOR LOCAL FOR
			SELECT	I.CAJA,
				I.DOCUMENTO,
				I.TIPO,
				L.LINEA,
				C.BODEGA,
				L.ARTICULO,
				L.LOTE,
				L.LOCALIZACION,
				$$Compania$$.CANTIDAD_DISPONIBLE( I.TIPO, I.ESTADO_COBRO, L.CANTIDAD),
				$$Compania$$.CANTIDAD_RESERVADA( I.TIPO, I.ESTADO_COBRO, L.CANTIDAD),
				$$Compania$$.CANTIDAD_REMITIDA( I.TIPO, I.ESTADO_COBRO, L.CANTIDAD)
			FROM	INSERTED L,
				$$Compania$$.DOCUMENTO_POS I,
				$$Compania$$.CAJA_POS C
			WHERE	I.ESTADO_COBRO IN (''C'',''A'',''P'')
				AND   I.TIPO IN (''F'',''P'',''D'',''T'')
				AND   L.DOCUMENTO = I.DOCUMENTO
				AND   L.CAJA = I.CAJA
				AND   L.TIPO = I.TIPO
				AND   I.CAJA = C.CAJA
		OPEN c_DOCPOS_LIN
		FETCH NEXT FROM	c_DOCPOS_LIN
		INTO	@lsCaja,
			@lsDocumento,
			@lsTipo,
			@lsLinea,
			@lsBodega,
			@lsArticulo,
			@lsLote,
			@lsLocalizacion,
			@lnCantidadDisponible,
			@lnCantidadReservada,
			@lnCantidadRemitida
		WHILE @@FETCH_STATUS = 0
		BEGIN
		
			-- Si se trata de una factura, pero viene de Ticket, se vende de lo remitido, como esto ya se dio con el cambio de estado del Ticket el efecto acá es cero 
			IF @lsTipo = ''F''
			BEGIN
				DECLARE @Fac_de_ticket INT		
				
				SELECT @Fac_de_ticket = COUNT(0) 
				FROM   $$Compania$$.auxiliar_pos 
				WHERE  documento = @lsDocumento 
					   AND caja = @lsCaja 
					   AND tipo = @lsTipo 
					   AND tipo_aplica = ''T''   
				
				IF @Fac_de_ticket > 0
				BEGIN
					SET @lnCantidadRemitida = 0		
					SET @lnCantidadDisponible = 0			
				END			
			END

			IF @lnCantidadDisponible <> 0 OR @lnCantidadReservada <> 0 OR @lnCantidadRemitida <> 0 
			BEGIN
				IF @lsCaja is not null
				BEGIN
					SET @InfoTrigger = ''tI_DOC_POS_LINEA_EXISTENCIA''
					
					IF  $$Compania$$.ES_ARTICULO_KIT (@lsArticulo) = 1
					BEGIN
						SET @InfoTrigger = ''tI_DOC_POS_LINEA_EXISTENCIA - ARTICULO KIT''
					END
					
					INSERT INTO $$Compania$$.AUDIT_EXISTENCIA
					(
						CAJA,
						DOCUMENTO,
						TIPO,
						LINEA,
						BODEGA,
						ARTICULO,
						CANT_DISPONIBLE,
						CANT_RESERVADA,
						CANT_REMITIDA,
						TEXTO
					)
					VALUES
					(
						@lsCaja,
						@lsDocumento,
						@lsTipo,
						@lsLinea,
						@lsBodega,
						@lsArticulo,
						@lnCantidadDisponible,
						@lnCantidadReservada,
						@lnCantidadRemitida,
						@InfoTrigger
					)
				END		

				IF $$Compania$$.MANEJA_EXISTENCIAS (@lsArticulo) = 1
				BEGIN
					EXEC $$Compania$$.Actualiza_Existencia	@lsBodega,
										@lsArticulo,
										@lsLote,
										@lsLocalizacion,
										@lnCantidadDisponible,
										@lnCantidadReservada,
										@lnCantidadRemitida
				END
				ELSE IF $$Compania$$.ES_ARTICULO_KIT (@lsArticulo) = 1
				BEGIN
					EXEC $$Compania$$.EXPLOTA_EXIST_COMP_KITS	@lsBodega,
											@lsArticulo,
											@lsLote,
											@lsLocalizacion,
											@lnCantidadDisponible,
											@lnCantidadReservada,
											@lnCantidadRemitida
				END
			END
			FETCH NEXT FROM c_DOCPOS_LIN
			INTO	@lsCaja,
				@lsDocumento,
				@lsTipo,
				@lsLinea,
				@lsBodega,
				@lsArticulo,
				@lsLote,
				@lsLocalizacion,
				@lnCantidadDisponible,
				@lnCantidadReservada,
				@lnCantidadRemitida
		END
	END'
END
;


IF  EXISTS(Select * from sysobjects WHERE id IN (OBJECT_ID(N'[$$Compania$$].[ACTUALIZA_EXISTENCIA]'))) AND
	0 < (Select COUNT(0) from $$Compania$$.GLOBALES_POS where TIPO_SITIO_LOCAL = 'T')
BEGIN
EXEC dbo.sp_executesql @statement = N'
	ALTER PROCEDURE $$Compania$$.ACTUALIZA_EXISTENCIA
	(
	  @psBodega AS VARCHAR(4),
	  @psArticulo AS VARCHAR(20),
	  @psLote AS VARCHAR(15),
	  @psLocalizacion AS VARCHAR(8),
	  @pnCantidadDisponible as DECIMAL(28,8),
	  @pnCantidadReservada as DECIMAL(28,8),
	  @pnCantidadRemitida as DECIMAL(28,8)
	)
	AS
	BEGIN

		EXEC $$Compania$$.ACTUALIZA_EXISTENCIA_BODEGA
							@psBodega,
							@psArticulo,
							@pnCantidadDisponible,
							@pnCantidadReservada,
							@pnCantidadRemitida
							
		IF ((SELECT MANEJO_LOTE FROM $$Compania$$.GLOBALES_POS) = ''S'') AND
			((SELECT USA_LOTES FROM $$Compania$$.ARTICULO WHERE  ARTICULO = @psArticulo) = ''S'')
		BEGIN
			EXEC $$Compania$$.ACTUALIZA_EXISTENCIA_LOTE
								@psBodega,
								@psArticulo,
								@psLote,
								@psLocalizacion,
								@pnCantidadDisponible,
								@pnCantidadReservada,
								@pnCantidadRemitida
		END
	END'
END
;

IF  EXISTS(Select * from sysobjects WHERE id IN (OBJECT_ID(N'[$$Compania$$].[ACTUALIZA_EXISTENCIA_BODEGA]'))) AND
	0 < (Select COUNT(0) from $$Compania$$.GLOBALES_POS where TIPO_SITIO_LOCAL = 'T')
BEGIN
EXEC dbo.sp_executesql @statement = N'
	ALTER PROCEDURE $$Compania$$.ACTUALIZA_EXISTENCIA_BODEGA
	(
	  @psBodega AS VARCHAR(4),
	  @psArticulo AS VARCHAR(20),
	  @pnCantidadDisponible as DECIMAL(28,8),
	  @pnCantidadReservada as DECIMAL(28,8),
	  @pnCantidadRemitida as DECIMAL(28,8)
	)
	AS
	BEGIN
		DECLARE @MensajeError VARCHAR(1000)	
		DECLARE @Porc_Rebajo_MediaUnidad DECIMAL(28,8)
		DECLARE @MediaUnidadDetalle DECIMAL(28,8)
		DECLARE @Factor_Empaque DECIMAL(28,8)
		DECLARE @CantDipRebajada DECIMAL (28,8)
		DECLARE @CantSolicitadaDisp DECIMAL (28,8)
		DECLARE @CantSolicitadaReserv DECIMAL (28,8)
		DECLARE @ObtenerMediaUnidadDet DECIMAL (28,8)
		DECLARE @Disponible_Almacen DECIMAL (28,8)
		DECLARE @Reservada_Almacen DECIMAL (28,8)
		DECLARE @CantSolicitadaRemit DECIMAL (28,8)
		DECLARE @Remitida_Almacen DECIMAL (28,8)
		
		IF @psBodega IS NULL OR @psArticulo IS NULL
			RETURN
			
		IF 0 = (SELECT COUNT(BODEGA) FROM $$Compania$$.V_SITIO_BODEGA WHERE SITIO IN (SELECT SITIO_LOCAL FROM $$Compania$$.GLOBALES_POS) AND BODEGA = @psBodega)
			RETURN
			
		IF @pnCantidadDisponible IS NULL
			SET @pnCantidadDisponible = 0
		IF @pnCantidadReservada IS NULL
			SET @pnCantidadReservada = 0
		IF @pnCantidadRemitida IS NULL
			SET @pnCantidadRemitida = 0
			
		IF EXISTS( SELECT ''x'' FROM $$Compania$$.EXISTENCIA_BODEGA WHERE BODEGA = @psBodega AND ARTICULO = @psArticulo )
			BEGIN
				IF @pnCantidadDisponible = 0 AND @pnCantidadReservada = 0 AND @pnCantidadRemitida = 0
					RETURN
				
				SELECT @Disponible_Almacen = CANT_DISPONIBLE, @Reservada_Almacen = CANT_RESERVADA, @Remitida_Almacen = CANT_REMITIDA
				FROM $$Compania$$.EXISTENCIA_BODEGA 
				WHERE  BODEGA = @psBodega AND ARTICULO  = @psArticulo 

				--Obtiene Factor de Empaque
				SELECT 	@Factor_Empaque  = FACTOR_EMPAQUE FROM $$Compania$$.ARTICULO WHERE  ARTICULO = @psArticulo
				SET @Porc_Rebajo_MediaUnidad = 0.01
				
				--Obtener Media Unidad Detalle
				IF @Factor_Empaque > 0 
				BEGIN
					SET @MediaUnidadDetalle = (1 / @Factor_Empaque) / 2
					SET @ObtenerMediaUnidadDet = @MediaUnidadDetalle - (@MediaUnidadDetalle * @Porc_Rebajo_MediaUnidad)  			
				END
				
				SET @CantSolicitadaDisp = ABS(@pnCantidadDisponible) * @Factor_Empaque			
				IF @Disponible_Almacen + @CantSolicitadaDisp < 0
				BEGIN
					--Pregunta si la cantidad disponible es mayor a la media unidad de detalle
					IF @Disponible_Almacen > @ObtenerMediaUnidadDet 
					BEGIN	
							SET @CantDipRebajada = @Disponible_Almacen - @CantSolicitadaDisp
							IF (Abs(@CantDipRebajada) < @ObtenerMediaUnidadDet)
							BEGIN
								SET @pnCantidadDisponible = -@Disponible_Almacen
							END
					END
				END

				SET @CantSolicitadaReserv = ABS(@pnCantidadReservada) * @Factor_Empaque
				IF @Reservada_Almacen + @CantSolicitadaReserv < 0
				BEGIN
					--Pregunta si la cantidad disponible es mayor a la media unidad de detalle
					IF @Reservada_Almacen > @ObtenerMediaUnidadDet 
					BEGIN	
							SET @CantDipRebajada = @Reservada_Almacen - @CantSolicitadaReserv
							IF (Abs(@CantDipRebajada) < @ObtenerMediaUnidadDet)
							BEGIN
								SET @pnCantidadReservada = -@Reservada_Almacen
							END
					END
				END

				SET @CantSolicitadaRemit = ABS(@pnCantidadRemitida) * @Factor_Empaque
				IF @Remitida_Almacen + @CantSolicitadaRemit < 0
				BEGIN
					--Pregunta si la cantidad disponible es mayor a la media unidad de detalle
					IF @Remitida_Almacen > @ObtenerMediaUnidadDet 
					BEGIN	
							SET @CantDipRebajada = @Remitida_Almacen - @CantSolicitadaRemit
							IF (Abs(@CantDipRebajada) < @ObtenerMediaUnidadDet)
							BEGIN
								SET @pnCantidadRemitida = -@Remitida_Almacen
							END
					END
				END

				--Pregunta si las cantidades disponibles y reservadas son mayores a ''0'' antes de actualizar
				IF ((SELECT VALIDAR_EXISTENCIAS FROM $$Compania$$.GLOBALES_POS) = ''S'')
				BEGIN
					IF @Disponible_Almacen + @pnCantidadDisponible < 0 OR @Reservada_Almacen + @pnCantidadReservada < 0 OR @Remitida_Almacen + @pnCantidadRemitida < 0
					BEGIN
						SET @MensajeError = ''Error al validar existencias. El artículo '' + @psArticulo + '' no tiene la cantidad suficiente en la bodega '' + @psBodega + '' para facturar.''

						IF @Disponible_Almacen + @pnCantidadDisponible < 0
						BEGIN
							SET @MensajeError = @MensajeError + '' Cantidad Disponible Faltante: '' + CONVERT(VARCHAR(30), ABS(@Disponible_Almacen + @pnCantidadDisponible))
						END

						IF @Reservada_Almacen + @pnCantidadReservada < 0
						BEGIN
							SET @MensajeError = @MensajeError + '' Cantidad Reservada Faltante: '' + CONVERT(VARCHAR(30), ABS(@Reservada_Almacen + @pnCantidadReservada))
						END

						IF @Remitida_Almacen + @pnCantidadRemitida < 0
						BEGIN
							SET @MensajeError = @MensajeError + '' Cantidad Remitida Faltante: '' + CONVERT(VARCHAR(30), ABS(@Remitida_Almacen + @pnCantidadRemitida))
						END		

						RAISERROR(@MensajeError,16,1)
					END
				END			
				
				UPDATE $$Compania$$.EXISTENCIA_BODEGA
				SET	CANT_DISPONIBLE = CANT_DISPONIBLE + @pnCantidadDisponible,
					CANT_RESERVADA = CANT_RESERVADA + @pnCantidadReservada,
					CANT_REMITIDA = CANT_REMITIDA + @pnCantidadRemitida
				WHERE BODEGA = @psBodega 
				AND ARTICULO = @psArticulo
			END
		ELSE
			BEGIN
				INSERT INTO $$Compania$$.EXISTENCIA_BODEGA (
					ARTICULO, 
					BODEGA, 
					EXISTENCIA_MINIMA, 
					EXISTENCIA_MAXIMA, 
					PUNTO_DE_REORDEN,				
					CANT_DISPONIBLE, 
					CANT_RESERVADA, 
					CANT_NO_APROBADA, 
					CANT_VENCIDA,
					CANT_TRANSITO, 
					CANT_PRODUCCION, 
					CANT_PEDIDA, 
					CANT_REMITIDA, 
					CONGELADO,
					FECHA_CONG, 
					BLOQUEA_TRANS, 
					FECHA_DESCONG
				)
				VALUES
				(
					@psArticulo, 
					@psBodega, 
					0, 
					0, 
					0,
					@pnCantidadDisponible, 
					@pnCantidadReservada, 
					0, 
					0,
					0, 
					0, 
					0, 
					@pnCantidadRemitida, 
					''N'',
					NULL, 
					''N'', 
					NULL
				)
			END
	END'
END
;

IF  EXISTS(Select * from sysobjects WHERE id IN (OBJECT_ID(N'[$$Compania$$].[tU_EXISTENCIA_BODEGA_HISTO]'))) AND
	0 < (Select COUNT(0) from $$Compania$$.GLOBALES_POS where TIPO_SITIO_LOCAL = 'T')
BEGIN
EXEC dbo.sp_executesql @statement = N'
	ALTER TRIGGER $$Compania$$.tU_EXISTENCIA_BODEGA_HISTO ON $$Compania$$.EXISTENCIA_BODEGA
	FOR UPDATE
	AS
	BEGIN
		IF (NOT UPDATE (RECORDDATE) AND (UPDATE (CANT_DISPONIBLE) OR UPDATE(CANT_RESERVADA)))
			INSERT INTO $$Compania$$.HISTO_EXISTENCIA
			(
				BODEGA,
				ARTICULO,
				CANT_DISPONIBLE,
				CANT_RESERVADA,
				CANT_REMITIDA,
				OPERACION
			)
			SELECT	BODEGA,
				ARTICULO,
				CANT_DISPONIBLE,
				CANT_RESERVADA,
				CANT_REMITIDA,
				''UPDATE''
			FROM	INSERTED
	END'
END
;



